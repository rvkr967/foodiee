define("xIe",["require","exports","Hxe","OIe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-one-up",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("Hxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="OneUp" data-bind="css:{\'OneUp--hasInfoPane\':showPane,\'OneUp--awake\':isAwake,\'OneUp--panningEnabled\':isPanningEnabled,\'OneUp--hasItems\':items().length,\'OneUp--hasCommandBar\':isCommandBarVisible,\'OneUp--slideShowOn\':isSlideShowModeEnabled,\'OneUp--darkBackground\':isDarkBackgroundEnabled}" role="presentation"><div class="OneUp-accessibleItemAnnouncement" aria-live="polite" data-bind="text:accessibleItemAnnouncementText"></div><div class="OneUp-commandBar" data-bind="hideWhenInactive,control:commandBarSpecification"></div><div class="OneUp-content" data-bind="hideWhenInactive,clientRect:{size:size}" role="presentation"><div class="OneUp-carousel" data-bind="component:{name:carouselTagName,params:{item:item,items:items,canNavigate:canNavigate,allocationRange:allocationRange,loadState:slideLoadState,isEnabled:isPanningEnabled,isRotating:isRotating}},idle:{isIdle:isIdle,isEnabled:isIdleEnabled},throttledClick:{callback:$component.onContentClicked.bind($component)},automation:\'carousel\'" role="presentation">\x3c!--ko component:{name:$component.oneUpSlideTagName,params:{slide:$host,oneUp:$component.oneUp}}--\x3e\x3c!--/ko--\x3e</div><div class="OneUp-detailsBar" data-bind="css:{\'OneUp-detailsBar--hasCaption\':showEditCaption},style:detailsBarStyle,childFocus:isDetailsFocused" role="presentation">\x3c!--ko if:showEditCaption--\x3e<div class="OneUp-caption-container">\x3c!--ko if:updateCaptionAction.isAvailable--\x3e<button class="OneUp-caption OneUp-caption--editable" data-bind="click:editCaption,css:{\'OneUp-caption--existing\':caption}"><span data-bind="text:caption()||addCaptionLabel"></span></button>\x3c!--/ko--\x3e\x3c!--ko ifnot:updateCaptionAction.isAvailable--\x3e<div class="OneUp-caption OneUp-caption--existing"><span data-bind="text:caption"></span></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:showAgent--\x3e<div class="OneUp-agent" data-bind="component:agentHost"></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:showPane--\x3e<div class="OneUp-paneHost" data-bind="hideWhenInactive,component:paneHost" role="presentation">\x3c!--ko with:$host.contexts()[0]--\x3e\x3c!--ko transclusionHost:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:$host.contexts().length--\x3e\x3c!--ko if:$component.isInfoPaneExpanded--\x3e<div class="OneUp-infoPane" data-bind="control:infoPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko component:{name:panelHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:dialogHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:overlayHostTagName}--\x3e\x3c!--/ko--\x3e</div>'});
define("OIe",["require","exports","lC","JB","px","Pxe","kxe","wxe","Oxe","Cxe","rG","tG","dG","xxe","SG","KG","tX","mG","Xz","pe","Ixe","nbe","Dxe","Mz","kz","GH","Lh","e","_e","bz","bG","q1e","Hz","Sxe","lj","Vy","wZ","Jee","yxe","MIe","kIe","LG","gG","m_e","QH","pv","LIe","AIe","rj","EIe","wIe","e$","a6e","wR","yh"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var te=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.overlayHostTagName=O.default.tagName;r.dialogHostTagName=M.default.tagName;r.panelHostTagName=_.default.tagName;r.carouselTagName=R.default.tagName;r.oneUpSlideTagName=I.default.tagName;r.addBindingHandlers({clientRect:l.default,keyboard:h.default,idle:v.default,throttledClick:p.default,control:P.default,childFocus:c.default,hideWhenInactive:$.default,transclusionHost:d.default});r._carouselEvent=new D.OneUpCarousel;r._carouselEventData={initialFileType:"",initialFileExtension:"",initialFileSize:0,pagesViewed:0,totalPages:0,isFolderShownInSession:!1};var o=n.rateLimitExtenders,u=void 0===o?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:o;r._rateLimitExtenders=u;var a=r,f=a.observables,b=a.resources;r.slideLoadState=f.create(0);var w=n.toolbarProvider;r.agentHost={name:U.default.tagName,params:{provider:w}};r.showAgent=f.pureCompute(function(){return w.contexts().length>0});var E=n.paneProvider;r.paneHost={name:U.default.tagName,params:{provider:E,useCustomTemplate:!0}};b.bind(z.shareFocusItemResourceKey);b.bind(z.copyLinkFocusItemResourceKey);b.expose(V.default,f.create(!1));b.bind(y.resourceKey);b.bind(g.resourceKey);b.bind(J.resourceKey);r.isSlideShowModeEnabled=f.create(!1);b.expose(i.slideshowState,r);r.addCaptionLabel=f.create("");r.isRotating=f.create(!1);r.isIdle=f.create(!1);r._actionMap=n.actionMap;r._initializeItem({item:n.focusItem});var S=n.currentItemSet;r._initializeItemSet({itemSet:n.focusItemSet||S});r._parent=f.pureCompute(function(){return r._itemSet().item()});b.block(i.currentSelectionModelGroup);r._selectionModel=b.expose(i.itemsSelection,new(r.managed(s.default))({indexResolver:n.indexResolver}));r.allocationRange=t.requiredRange;r.size=f.create({width:0,height:0});b.expose(m.base.infoPane.hidePreview,f.create(!0));b.bind(H.resourceKey);var x=r.isInfoPaneExpanded=b.consume(B.resourceKey);r._focusedInfoPaneSection=n.focusedInfoPaneSection;r.showPane=f.pureCompute(function(){return x()||E.contexts().length>0});var T={deferEvaluation:!0};r.isCommandBarVisible=f.create(!0);r.isAwake=f.pureCompute(r._computeIsAwake,T);r.oneUp={currentPriority:f.createCallback(q.oneUpPriorityOptions),isRotating:r.isRotating,isCommandBarVisible:r.isCommandBarVisible,isInfoPaneExpanded:x,enableSlideControls:f.create(!1),size:r.size,slide:f.create(),shareLinkId:t.shareLinkId,isAwake:r.isAwake};r.isPhotosOnly=r._exposeIfNeeded(m.base.oneUpOverlay.isPhotosOnly,f.create(!1));r.isDarkBackgroundEnabled=f.pureCompute(function(){return r.isPhotosOnly()&&r._shouldUseDarkBackground(n.identityDataSource)});r.canNavigate=f.pureCompute(r._computeCanNavigate,T);r.accessibleItemAnnouncementText=f.pureCompute(r._computeAccessibleItemAnnouncementText);r.caption=f.pureCompute(r._computeCaption,T);r.showEditCaption=f.pureCompute(r._computeIsEditCaptionEnabled,T);r._dataManagerMapper=n.dataManagerMapper;r._areFlippersPermanent=f.pureCompute(function(){return r.items().length>1});r.legend=f.pureCompute(r._computeLegend,T);r._initializeActions();r.commandBarSpecification=P.toSpecification(G.resourceKey,{commandSet:r._getCommandSet(n),isMobile:!1});r._initializeOpenParentWhenEmpty();r.isIdleEnabled=f.pureCompute(r._computeIsIdleEnabled,T);r.isDetailsFocused=f.create(!1);r.isPanningEnabled=f.pureCompute(r._computeIsPanningEnabled,T);var N=A.default.getScrollbarWidth()+"px";r.nextFlipperStyle={};r.nextFlipperStyle[L.default.safeRight]=N;r.previousFlipperStyle={};r.previousFlipperStyle[L.default.safeLeft]=N;r.detailsBarStyle=f.pureCompute(r._computeDetailsBarStyle,T);var k=f.pureCompute(function(){return r.slideLoadState()>=3});r.infoPaneSpecification=P.toSpecification(j.resourceKey,{showSections:k});t.isSlideshow&&f.compute(function(){t.isSlideshow(r.isSlideShowModeEnabled())}).extend({deferred:!0});var X=n.viewParams&&n.viewParams.peek();if(W.isFeatureEnabled(W.EnableCommentDeepLinking)&&r._shouldShowActivityFeed(X)&&!r.isInfoPaneExpanded.peek()){var K=r._focusedInfoPaneSection;K&&K(9);if(X&&X.commentId){var Q=X.commentId;r._navigation=r.resources.consume(C.navigation);var Y=r._navigation.viewParams;if(Y&&Y.commentId){delete Y.commentId;r._navigation.updateViewParams(Y)}r.deeplinkCommentId=r.resources.consume(F.resourceKey.optional);r.deeplinkCommentId&&r.deeplinkCommentId({commentId:Q})}r._showPropertiesAction.execute(null)}f.backgroundCompute(r._computeSetCaptionLabel);f.backgroundCompute(r._computeClearCaptionFocus);f.backgroundCompute(r._computeSelectItem);f.backgroundCompute(r._computeTriggerClientRectUpdate);f.backgroundCompute(r._computeCommandBarShownOnIdleFullScreen);f.backgroundCompute(r._computeIsFirstSlideOpened);f.backgroundCompute(r._computePagesViewed);return r}t.prototype.executeAction=function(e,t){if(e.isAvailable.peek()){e.execute(t);return!1}return!0};t.prototype.enterSlideshowMode=function(){S.default.enterFullScreen();if(this.isSlideShowModeEnabled.peek()){this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!0}return!1};t.prototype.exitSlideshowMode=function(){S.default.exitFullScreen();this.isSlideShowModeEnabled(!1);if(this._timeOutId){this.async.clearTimeout(this._timeOutId);return!0}return!1};t.prototype.onExitInfoPane=function(e){this.async.setTimeout(function(){k.removeNode(e)},500)};t.prototype.onContentClicked=function(e){var t=this.oneUp.slide,n=t&&t.peek();return!(!n||!n.isPanningEnabled.peek()||this.isSlideShowModeEnabled.peek())};t.prototype.toggleInfoPaneExpanded=function(e){this._showPropertiesAction.execute(e);return!1};t.prototype.editCaption=function(e){if(!this.isInfoPaneExpanded.peek()){var t=this._focusedInfoPaneSection;t&&t(1);this._showPropertiesAction.execute(e)}return!1};t.prototype.dispose=function(){var t=this.peekUnwrapObservable(this._itemSet);if(t){var n=t.content.peek();this._carouselEventData.totalPages=n.items.length}this._carouselEvent.end(this._carouselEventData);S.default.isFullScreen()&&S.default.exitFullScreen();e.prototype.dispose.call(this)};t.prototype._startSlideshow=function(){this.isInfoPaneExpanded.peek()&&this.toggleInfoPaneExpanded(null);if(!this.isSlideShowModeEnabled.peek())return!1;this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!(!this.slideLoadState.peek()||this.executeAction(this._openNext,null))||void 0};t.prototype._initializeItemSet=function(e){var t=this,n=e.itemSet;this._sourceItemSet=n;var r,s=this.observables;this.index=s.pureCompute(this._computeIndex);this._isPlaceholderItemSetRequired=s.pureCompute(function(){var e=n();return(!e.content()||e.isPlaceholder)&&-1===t.index()},{deferEvaluation:!0});var o=s.pureCompute(function(){var e;if(t._isPlaceholderItemSetRequired()){(e=new x.default).item=n.peek().item;r&&r.dispose();r=s.compute(function(){var n=new T.default;n.items=[t.item()];e.content(n)})}else e=n();return e});o.equalityComparer=N.objectStrictEquality;var u=s.pureCompute(function(){return o().item()});u.equalityComparer=N.objectStrictEquality;this.resources.expose(i.currentItem,u);this._itemSet=this.resources.expose(i.currentItemSet,o);this.items=s.createArray();s.backgroundCompute(function(){t.items(t._itemSet().content().items)})};t.prototype._initializeItem=function(e){var t=this,n=e.item,r=this.observables,i=this.item=r.create();i.equalityComparer=N.objectStrictEquality;if(n){r.backgroundCompute(function(){i(n())});r.backgroundCompute(function(){if(i()!==n.peek()){var e=t._openCurrent;e.isAvailable.peek()&&e.execute(null).done()}}).extend(this._rateLimitExtenders)}};t.prototype._computeIndex=function(){var e=this.item(),t=this._sourceItemSet().content().items;return e?t.indexOf(e):-1};t.prototype._computeAccessibleItemAnnouncementText=function(){var e=this.item(),t=e&&e().displayName;return t?b.format(w.default.accessibleItemAnnouncement,t):""};t.prototype._initializeActions=function(){var e=this,t=this.observables,r=t.pureCompute(function(){return t.unwrap(e.item())}),i=this._actionMap,s=this.managed(i.OpenAction),o={openRelation:2,focusUrl:!0,itemSet:this._itemSet,ignoreHistory:!0};this._openCurrent=new s(n.__assign(n.__assign({},o),{item:r}));this._openPrevious=new s(n.__assign(n.__assign({},o),{item:t.pureCompute(this._computePreviousItem)}));this._openNext=new s(n.__assign(n.__assign({},o),{item:t.pureCompute(this._computeNextItem)}));this.updateCaptionAction=new(this.managed(i.UpdateCaptionAction))({item:r});this._showPropertiesAction=new(this.managed(i.ShowPropertiesAction))({useToggleBehavior:!0})};t.prototype._computePreviousItem=function(){var e=this.index();if(!(e<0))for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),r=e-1;r>=0;r--){var i=this.unwrapObservable(n[r]);if(!t||i&&!i.video)return i}};t.prototype._computeNextItem=function(){var e=this.index();if(!(e<0)){for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),r=e+1,i=n.length;r<i;r++){var s=this.unwrapObservable(n[r]);if(!t||s&&!s.video)return s}t&&this.exitSlideshowMode()}};t.prototype._initializeOpenParentWhenEmpty=function(){var e=this,t=new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this._parent,ignoreHistory:!0}),n=this.observables,r=n.pureCompute(function(){var t=e._itemSet();t.content();return!t.isPlaceholder&&!t.item().isPlaceholder||t.item().error?e.items().length:r.peek()});n.backgroundCompute(function(){0===r()&&t.isAvailable.peek()&&t.execute(null)}).extend(this._rateLimitExtenders)};t.prototype._computeTriggerClientRectUpdate=function(){this.isInfoPaneExpanded();this.isCommandBarVisible();k.computedContext.isInitial()||this.async.setTimeout(function(){X.default.raise(document.body,"resize",void 0,!0)},500)};t.prototype._computeClearCaptionFocus=function(){!this.isInfoPaneExpanded()&&this._focusedInfoPaneSection&&this._focusedInfoPaneSection(null)};t.prototype._computeCommandBarShownOnIdleFullScreen=function(){S.default.isFullScreen()&&this.isCommandBarVisible(!this.isIdle())};t.prototype._computePagesViewed=function(){var e=this.oneUp.slide();if(e){this._carouselEventData.pagesViewed++;e.item&&e.item.peek()&&e.item.peek().folder&&(this._carouselEventData.isFolderShownInSession=!0)}};t.prototype._computeCanNavigate=function(){if(!W.isFeatureEnabled(W.RemoveOneUpSlideNavigation))return!0;var e=this.item.peek();if(!e){this.item();return!1}var t=e.peek();if(!t||t.isPlaceholder){e();return!1}return!!t.photo};t.prototype._computeIsFirstSlideOpened=function(){var e=this.oneUp.slide,t=e.peek();if(t){if(t.item){var n=t.item.peek();if(n){var r=this._carouselEventData;r.initialFileSize=n.size;r.initialFileType=n.iconName&&n.iconName.toLowerCase();r.initialFileExtension=n.extension&&n.extension.toLowerCase()}}t.isFirstSlideOpened(!0)}else e()};t.prototype._getCommandSet=function(e){var t=e.commandSet;return void 0===t?this._createSelectableCommandSet(e):t};t.prototype._createSelectableCommandSet=function(e){var t=this,n=e.oneUpCommandSet,r=void 0===n?new(this.managed(o.default)):n,i=e.slideshowCommandSet,s=void 0===i?new(this.managed(a.default)):i,l=this.observables,c=new(this.managed(u.default))({legend:this.legend,next:this._openNext,previous:this._openPrevious,areFlippersPermanent:this._areFlippersPermanent,canNavigate:this.canNavigate,parent:this._parent}),h=l.pureCompute(function(){var e=t.oneUp.slide();if(t.isSlideShowModeEnabled())return[s,c];var n=e&&e.commandSet();if(n)return[n,c];var i=e&&e.augmentCommandSet();return i?[r,i,c]:[r,c]});return new(this.managed(f.default))({commandSets:h})};t.prototype._computeDetailsBarStyle=function(){var e=this.oneUp.slide(),t=A.default.getScrollbarWidth(),n=e&&e.hasHorizontalScrollbar()?t:0,r=e&&e.hasVerticalScrollbar()?t:0,i={bottom:n+"px"};i[L.default.safeRight]=r+"px";return i};t.prototype._computeSetCaptionLabel=function(){var e=this.item(),t=e&&e.peek(),n=t&&t.photo?E.default.captionAddCaption:E.default.captionAddDescription;this.addCaptionLabel(n)};t.prototype._computeLegend=function(){var e=this.index(),t=this._dataManagerMapper,n=t&&t(),r=n?n.itemSet():this._itemSet(),i=n?n.getOriginalItemIndexByMappedIndex(e):e;return i>-1?b.format(w.default.legendFormat,i+1,r.content().items.length):""};t.prototype._computeCaption=function(){var e=this.unwrapObservable(this.item());return e&&e.caption};t.prototype._computeIsAwake=function(){return this.isDetailsFocused()||!this.isIdle()||!this.isIdleEnabled()};t.prototype._computeIsIdleEnabled=function(){var e=this.oneUp.slide();return!e||e.isIdleEnabled()};t.prototype._computeIsPanningEnabled=function(){if(!this.canNavigate())return!1;var e=this.oneUp.slide();return e&&e.isPanningEnabled()};t.prototype._computeIsEditCaptionEnabled=function(){var e=this.oneUp.slide();return e&&e.isEditCaptionEnabled()&&(this.updateCaptionAction.isAvailable()||!!this.caption())};t.prototype._computeSelectItem=function(){var e=this.item(),t=this._selectionModel;if(t.selection()[0]!==e){var n=t.getItemKey(e);t.setSelectedKeys([n])}};t.prototype._shouldShowActivityFeed=function(e){return e&&(e.commentId||e.Nav&&e.Nav.indexOf("commentId")>=0)};t.prototype._shouldUseDarkBackground=function(e){if(W.isFeatureEnabled(W.DarkBackgroundForPhotosOneUp))return!0;if(W.isFeatureEnabled(W.DarkBackgroundForPhotosOneUpExperiment)){if(e){var t=e.getIdentity();t&&Z.ABExperiment.init({userLoginName:t.email})}return new Z.ABExperiment({name:"DarkBackgroundForPhotosOneUpExperiment",startDate:"3/20/2020",version:Z.ABExpHash.v2},W.DarkBackgroundForPhotosOneUpExperiment_ABTrigger).isOn()}return!1};t.prototype._exposeIfNeeded=function(e,t){return this.resources.isExposed(e)?this.resources.consume(e):this.resources.expose(e,t)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{focusItem:i.focusItem.optional,focusItemSet:i.focusItemSet.optional,currentItemSet:i.currentItemSet.optional,indexResolver:i.selectionIndexResolver.optional,paneProvider:K.resourceKey,toolbarProvider:Q.resourceKey,actionMap:i.actionMap,focusedInfoPaneSection:Y.focusedInfoPaneSectionResourceKey.optional,dataManagerMapper:i.currentDataManagerMapper.optional,viewParams:i.viewParams,commandSet:void 0,oneUpCommandSet:void 0,slideshowCommandSet:void 0,rateLimitExtenders:void 0,identityDataSource:ee.identity});return t})(r.default);t.default=te});
define("kxe",["require","exports","lC","U_e","WB","W0","Vy","wZ","n$","px","S3","QH","zB","lee","VB","s_e","m_e","LIe","Mxe","rY"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=["S"],w=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var r=e.call(this,t)||this,d=r.resources;r._actionMap=d.consume(f.actionMap);r._selection=d.consume(f.itemsSelection);var w=d.consume(l.pageContext.optional),E=r.scope.attach(new(d.consume(v.typeResourceKey.local))({})),S=r.createPureComputed(r._computeOpenInOfficeOnlineText),x=r.createPureComputed(r._computeOpenInOfficeClientText),T=r.createPureComputed(r._computOpenInOfficeSuffixClass),N=r.createPureComputed(r._computeOfficeIcon),C=[new(r.managed(a.CommandViewModel))({text:S,renderLabel:2,icon:N,classSuffix:T,action:new(r.managed(r._actionMap.OpenInOfficeOnlineAction))}),new(r.managed(a.CommandViewModel))({text:x,renderLabel:2,icon:N,classSuffix:T,action:new(r.managed(r._actionMap.OpenInOfficeClientAction))})],k=[new(r.managed(a.CommandViewModel))({text:i.default.OpenInBrowser,renderLabel:2,icon:new h.default("PDF"),classSuffix:"PDF",action:new(r.managed(r._actionMap.OpenPdfInBrowserAction))}),new(r.managed(a.CommandViewModel))({text:i.default.OpenInTextEditor,renderLabel:2,icon:new h.default("Edit"),action:new(r.managed(r._actionMap.OpenInTextEditorAction))})],L=r.observables.createArray([]);r.createBackgroundComputed(function(){L.splice.apply(L,n.__spreadArrays([0,L.peek().length],C,E.openWithCommands(),k))});var A=r.createPureComputed(function(){for(var e={},t=0,n=L();t<n.length;t++){var r=n[t];if(r.isVisible()){var i=r.icon(),s=r.iconUrl(),o=r.iconSize(),u=i&&i.toString();if(u&&"Page"!==u||s){if(c.isFeatureEnabled(c.CommandBarBrandIcons)){var a=p.brandIconWhiteStrokeMap[u];e.iconSize=18;e.icon=a?new h.default(a):i;e.iconUrl=s}else{e.icon=i;e.iconUrl=s;e.iconSize=o}return e}}}e.icon=new h.default("Page");return e}),O=r.createPureComputed(function(){return A().icon}),M=r.createPureComputed(function(){return A().iconUrl}),_=r.createPureComputed(function(){return A().iconSize}),D=w?c.isFeatureEnabled(c.ShareV3)?new(r.managed(m.default))({renderLabel:2,mode:0}).command:new(r.managed(a.CommandViewModel))({text:i.default.Share,tooltip:i.default.ShareCommandTooltipV3,renderLabel:2,icon:new h.default("Share"),action:c.isFeatureEnabled(c.UseNewSharingDialog)&&"21"===w.webTemplate?new(r.managed(r._actionMap.ShareByLinkAction))({sharingMethod:2}):new(r.managed(r._actionMap.ShareAction))({activeTab:1}),keys:b}):new(r.managed(a.CommandViewModel))({text:i.default.Share,renderLabel:2,icon:new h.default("Share"),action:new(r.managed(r._actionMap.ShareByLinkAction)),keys:b}),P=d.consume(g.default),H=d.consume(o.resourceKey),B=d.consume(u.resourceKey);r.commands(n.__spreadArrays([new(r.managed(a.CommandViewModel))({text:i.default.Open,icon:O,iconUrl:M,iconSize:_,classSuffix:T,renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!1,location:3,children:L}),D,c.isFeatureEnabled(c.ShareV3)?new(r.managed(m.default))({renderLabel:2,mode:1}).command:new(r.managed(a.CommandViewModel))({text:i.default.GetLink,renderLabel:2,icon:new h.default("Link"),action:new(r.managed(r._actionMap.GetLinkAction))({useOldSharingDialog:w&&"21"!==w.webTemplate})}),new(r.managed(a.CommandViewModel))({text:i.default.print,renderLabel:2,icon:new h.default("Print"),keys:["CtrlP"],action:new(r.managed(r._actionMap.PrintPdfAction))}),new(r.managed(a.CommandViewModel))({text:i.default.addToSharedList,renderLabel:2,icon:new h.default("Add"),action:new(r.managed(r._actionMap.AddToSharedListAction))}),new(r.managed(a.CommandViewModel))({text:i.default.removeFromSharedList,renderLabel:2,icon:new h.default("Cancel"),action:new(r.managed(r._actionMap.RemoveFromSharedListAction))}),new(r.managed(a.CommandViewModel))({text:i.default.AddToAlbum,icon:new h.default("Photo2Add"),renderLabel:2,action:new(r.managed(r._actionMap.AddToAlbumAction))({})}),new(r.managed(a.CommandViewModel))({text:i.default.playSlideshow,icon:new h.default("Play"),renderLabel:2,action:new(r.managed(r._actionMap.PlaySlideShowAction))({})}),new(r.managed(a.CommandViewModel))({text:i.default.rotate,icon:new h.default("rotate"),renderLabel:2,action:new(r.managed(r._actionMap.RotateAction))({})}),new(r.managed(a.CommandViewModel))({text:i.default.applyOfficeLens,renderLabel:2,icon:new h.default("LightningBolt"),action:new(r.managed(r._actionMap.ApplyOfficeLensAction))}),new(r.managed(a.CommandViewModel))({text:i.default.removeOfficeLens,renderLabel:2,icon:new h.default("Undo"),action:new(r.managed(r._actionMap.RemoveOfficeLensAction))}),new(r.managed(a.CommandViewModel))({text:i.default.Download,icon:new h.default("Download"),renderLabel:2,action:new(r.managed(r._actionMap.DownloadAction))({}),automationId:"download"}),new(r.managed(a.CommandViewModel))({text:i.default.DeleteItem,icon:new h.default("Delete"),renderLabel:2,action:new(r.managed(r._actionMap.DeleteAction))({})}),new(r.managed(a.CommandViewModel))({text:i.default.viewOriginal,icon:new h.default("Picture"),renderLabel:2,action:new(r.managed(r._actionMap.ViewOriginalAction))({})}),new(r.managed(a.CommandViewModel))({text:i.default.viewInFolder,icon:new h.default("Folder"),action:new(r.managed(r._actionMap.ViewInFolderAction)),renderLabel:2}),new(r.managed(a.CommandViewModel))({text:i.default.OrderPrints,icon:new h.default("Print"),renderLabel:2,action:new(r.managed(r._actionMap.OrderPrintsAction))({})}),new(r.managed(a.CommandViewModel))({text:i.default.Embed,icon:new h.default("Embed"),renderLabel:2,action:new(r.managed(r._actionMap.EmbedAction))({})}),new(r.managed(a.CommandViewModel))({text:i.default.editTags,renderLabel:2,icon:new h.default("Tag"),keys:["T"],action:new(r.managed(r._actionMap.EditTagsAction))}),new(r.managed(a.CommandViewModel))({renderLabel:2,text:r.createPureComputed(function(){return P()?i.default.ViewMode:i.default.AccessibilityMode}),icon:r.createPureComputed(function(){return P()?new h.default("Page"):new h.default("EaseOfAccess")}),action:new(r.managed(y.default))({accessibilityMode:P})}),new(r.managed(a.CommandViewModel))({text:i.default.Copy,renderLabel:2,icon:new h.default("Copy"),automationId:"copy",action:new(r.managed(r._actionMap.LaunchMoveCopyPanelAction))({isMove:!1})}),new(r.managed(a.CommandViewModel))({text:s.default.ShowVersionHistory,renderLabel:2,icon:new h.default("StackIndicator"),action:new(r.managed(r._actionMap.ShowVersionHistoryAction))})],w&&w.allowInfectedDownload?[new(r.managed(a.CommandViewModel))({text:i.default.Download,renderLabel:2,icon:new h.default("Download"),action:new(r.managed(r._actionMap.ShowMalwareDetectedAction))({})})]:[],[E.actionsCommand,r.overflowHostCommand,new(r.managed(a.CommandViewModel))({tooltip:s.default.DetailsPane,icon:new h.default("Info"),location:12,action:new(r.managed(r._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:H,ariaExpanded:B,renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties"})]));return r}t.prototype._computeOpenInOfficeOnlineText=function(){return p.getOfficeOnlineStringMap(d.getSelectedItemApp(this._selection))||i.default.Open};t.prototype._computeOpenInOfficeClientText=function(){return p.getOfficeStringMap(d.getSelectedItemApp(this._selection))};t.prototype._computOpenInOfficeSuffixClass=function(){return p.getOfficeAppFriendlyName(d.getSelectedItemApp(this._selection))};t.prototype._computeOfficeIcon=function(){var e,t=d.getSelectedItemApp(this._selection);t&&(e=c.isFeatureEnabled(c.CommandBarBrandIcons)?p.getOfficeBrandIconMap(t):p.getOfficeIconMap(t));return e||new h.default("Page")};return t})(r.default);t.default=w});
define("LIe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new n.ResourceKey({name:e("module").id});t.default=r});
define("Mxe",["require","exports","lC","Fe","E","KH","lee","jB"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AccessibilityMode";r._accessibilityMode=t.accessibilityMode;r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!!e.officeBundle&&e.appMap===o.wordType};t.prototype.onExecute=function(e,t){this._accessibilityMode(!this._accessibilityMode.peek());return r.default.resolve({resultType:i.ResultTypeEnum.Success})};return t})(s.default);t.default=a});
define("wxe",["require","exports","lC","U_e","WB","n$","zB","e","I_e","_e","Lxe","Axe","Exe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._legend=t.legend;var r=n.createPureComputed(function(){return!t.canNavigate()}),p=n.createPureComputed(function(){return t.canNavigate()&&t.areFlippersPermanent()}),d=new(n.managed(c.default))({action:t.previous,condition:t.canNavigate}),v=new(n.managed(c.default))({action:t.next,condition:t.canNavigate});n.commands.push(new(n.managed(a.default))({renderLabel:2}).command,new(n.managed(s.CommandViewModel))({text:l.default.previousTooltip,icon:new o.default(f.default.isRightToLeft?"ChevronRight":"ChevronLeft"),renderLabel:2,location:12,isPermanent:p,isInvisibleWhenDisabled:!0,automationId:"previousButton",keys:[f.default.isRightToLeft?"Right":"Left"],action:d}),new(n.managed(s.CommandViewModel))({text:n._legend,location:12,automationId:"oneUpPageCount",isDisabled:u.observable(!0),isHidden:r}),new(n.managed(s.CommandViewModel))({text:l.default.nextTooltip,icon:new o.default(f.default.isRightToLeft?"ChevronLeft":"ChevronRight"),renderLabel:2,location:12,positionIconRight:!0,isPermanent:p,isInvisibleWhenDisabled:!0,automationId:"nextButton",keys:[f.default.isRightToLeft?"Left":"Right"],action:v}),new(n.managed(s.CommandViewModel))({icon:new o.default("Cancel"),text:i.default.Close,hasIconOnly:!0,renderLabel:0,action:new(n.managed(h.ClosePreviewerAction)),automationId:"close",keys:["Esc"],location:12}));return n}return t})(r.default);t.default=p});
define("Axe",["require","exports","lC","KH"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="Conditional";n.isQosLogged=!1;n._action=t.action;n._condition=t.condition;return n}t.prototype.onExecute=function(e,t){return this._action.execute(e)};t.prototype.onIsAvailable=function(){return this._condition()&&this._action.isAvailable()};return t})(r.default);t.default=i});
define("Exe",["require","exports","lC","UX","Re","QH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=!i.default.isActivated("032F039F-DB6A-48D0-AB4A-8B26E231C862","7/23/2020","Refresh the page on previewer close for non-lightspeed"),u={ignoreHistory:!0,openRelation:1},a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,u,n)||this;r.name="ClosePreviewer";return r}t.prototype.onExecute=function(t,n){if(s.isFeatureEnabled(s.RefreshOnPreviewClose)&&o){document.body.style.display="none";return e.prototype.onExecute.call(this,t,n).then(function(e){window.location.reload();return e})}return e.prototype.onExecute.call(this,t,n)};return t})(r.OpenAction);t.ClosePreviewerAction=a});
define("Oxe",["require","exports","lC","U_e","n$","zB","WB","px","e"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._actionMap=n.resources.consume(u.actionMap);n.commands=a.observableArray([new(n.managed(i.CommandViewModel))({text:o.default.pauseSlideshow,renderLabel:2,icon:new s.default("Pause"),action:new(n.managed(n._actionMap.StopSlideShowAction))({})})]);return n}return t})(r.default);t.default=f});
define("Cxe",["require","exports","lC","U_e"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.commandSets,i=void 0===r?[]:r;n._commandSets=n.wrapObservable(i);n.createComputed(n._computeUpdateCommandSet);return n}t.prototype._computeUpdateCommandSet=function(){for(var e,t,r=[],i=[],s=[],o=0,u=this._commandSets();o<u.length;o++){for(var a=u[o],f=this.observables.unwrap(a),l=[],c=0,h=f.commands();c<h.length;c++){var p=h[c];p===f.overflowHostCommand?s.push.apply(s,p.children()):4==(4&p.location)?l.push(p):r.push(p)}i.unshift.apply(i,l)}var d=this.overflowHostCommand.children.peek();(e=this.overflowHostCommand.children).splice.apply(e,n.__spreadArrays([0,d.length],s));r.push(this.overflowHostCommand);r.push.apply(r,i);(t=this.commands).splice.apply(t,n.__spreadArrays([0,this.commands.peek().length],r))};return t})(r.default);t.default=i});
define("xxe",["require","exports","lC","ZB"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||500;n.events.on(n.element,"click",n._onClick);return n}t.prototype._onClick=function(e){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}else this._timerID=this.async.setTimeout(this._onClickTimer,this._delay)};t.prototype._onClickTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t})(r.default);t.default=i});
define("KG",["require","exports","lC","ZB","x7","e","yn"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=window.navigator,a=u&&u.pointerEnabled,f=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.valueAccessor();r._isIdle=i.isIdle||s.observable(!1);r._isEnabled=i.isEnabled||s.observable(!0);r._isInIdleZone=s.observable(!1);r._idleZoneElement=i.idleZoneElement||r.element;r._shouldClicksWake=i.shouldClicksWake;r._lastTouchPosition=null;r._lastMousePosition=null;r._lastPointerExitPosition=null;r._pointerCount=0;r._pointers={};r._isMouseDown=!1;r._isSuspended=!1;r._idle=r.createComputed(r._computeIdle).extend({rateLimit:{timeout:4e3,method:"notifyWhenChangesStop"}});r.createComputed(r._computeAwakenWhenNotEnabled);r.createComputed(r._computeSuspendIdleEvents);r.events.on(r._idleZoneElement,"click",r._onClick);r.events.on(document,"mousedown",r._onMouseDown,!0);r.events.on(document,"mousemove",r._onMouseMove,!0);r.events.on(document,"mouseup",r._onMouseUp,!0);r.events.on(document,"mouseout",r._onMouseOut,!0);r.events.on(document,"mousewheel",r._onMouseWheel,!0);r.events.on(window,"blur",r._onWindowBlur,!0);r.events.on(window,"focus",r._onWindowFocus,!0);if(a){r.events.on(document,"pointerdown",r._onPointerDown,!0);r.events.on(document,"pointermove",r._onPointerMove,!0);r.events.on(document,"pointerup",r._onPointerUp,!0);r.events.on(document,"pointercancel",r._onPointerCancel,!0);r.events.on(document,"lostpointercapture",r._onLostPointerCapture,!0)}else{r.events.on(document,"touchstart",r._onTouchStart,!0);r.events.on(document,"touchmove",r._onTouchMove,!0);r.events.on(document,"touchend",r._onTouchEnd,!0);r.events.on(document,"touchcancel",r._onTouchCancel,!0)}return r}t.prototype._computeIdle=function(){var e=this._isIdle(),t=this._isInIdleZone(),n=this._isEnabled();!e&&t&&n&&this._isIdle(!0)};t.prototype._computeAwakenWhenNotEnabled=function(){this._isEnabled()||this._isIdle(!1)};t.prototype._resetPosition=function(){this._lastMousePosition=null;this._lastTouchPosition=null};t.prototype._onClick=function(e){if(0===e.button){var t=this._lastMousePosition,n=new i.default(e.clientX,e.clientY);this._resetPosition();if(!(t&&n.distance(t)>=10)){this._isInIdleZone(!0);!this._isSuspended&&this._isEnabled.peek()&&(this._shouldClicksWake?this._isIdle(!1):this._isIdle(!this._isIdle.peek()))}}};t.prototype._onMouseDown=function(e){if(0===e.button){this._isMouseDown=!0;var t=new i.default(e.clientX,e.clientY);this._lastMousePosition=t}};t.prototype._onMouseMove=function(e){var t=this._lastTouchPosition,n=this._lastMousePosition,r=new i.default(e.clientX,e.clientY);if(!(t&&r.distance(t)<10)){var s=(function(e,t){for(;e;){if(e===t)return!0;e=o.getParent(e)}return!1})(e.target,this._idleZoneElement);this._isInIdleZone(s);if(!this._isMouseDown&&!this._pointerCount&&n&&r.distance(n)>=10){this._resetPosition();!this._isSuspended&&this._isEnabled.peek()&&this._isIdle(!1)}this._lastMousePosition||(this._lastMousePosition=r)}};t.prototype._onMouseUp=function(e){0===e.button&&(this._isMouseDown=!1)};t.prototype._onMouseOut=function(e){if(!this._isMouseDown){var t=this._lastPointerExitPosition,n=new i.default(e.clientX,e.clientY);this._resetPosition();this._lastPointerExitPosition=null;if(!(t&&n.distance(t)<10)&&(function(e){var t=e.relatedTarget||e.toElement;return!t||"HTML"===t.nodeName})(e)){var r=this._isInIdleZone.peek();this._isInIdleZone(!0);r&&this._idle()}}};t.prototype._onMouseWheel=function(e){this._isIdle(!1)};t.prototype._onWindowBlur=function(e){this._isIdle(!0)};t.prototype._onWindowFocus=function(e){this._isIdle(!1)};t.prototype._onTouchStart=function(e){this._pointerCount+=e.changedTouches.length;this._trackTouch(e);this._lastMousePosition=this._lastTouchPosition};t.prototype._onTouchMove=function(e){this._trackTouch(e)};t.prototype._onTouchEnd=function(e){this._pointerCount-=e.changedTouches.length;this._trackTouch(e)};t.prototype._onTouchCancel=function(e){this._pointerCount-=e.changedTouches.length};t.prototype._trackTouch=function(e){this._lastTouchPosition=new i.default(e.changedTouches[0].clientX,e.changedTouches[0].clientY)};t.prototype._onPointerDown=function(e){if("mouse"!==e.pointerType&&!this._pointers[e.pointerId]){this._pointerCount++;this._trackPointer(e);this._lastMousePosition=this._lastTouchPosition}};t.prototype._onPointerMove=function(e){"mouse"!==e.pointerType&&this._pointers[e.pointerId]&&this._trackPointer(e)};t.prototype._onPointerUp=function(e){if("mouse"!==e.pointerType){this._trackPointer(e);this._removePointer(e)}};t.prototype._onPointerCancel=function(e){if("mouse"!==e.pointerType){this._trackPointer(e);this._removePointer(e)}};t.prototype._onLostPointerCapture=function(e){"mouse"!==e.pointerType&&this._removePointer(e)};t.prototype._trackPointer=function(e){var t=new i.default(e.clientX,e.clientY);this._pointers[e.pointerId]=t;this._lastTouchPosition=t};t.prototype._removePointer=function(e){if(this._pointers[e.pointerId]){this._lastPointerExitPosition=this._pointers[e.pointerId];delete this._pointers[e.pointerId];this._pointerCount--}};t.prototype._computeSuspendIdleEvents=function(){this._isIdle();this._isSuspended=!0;this.async.clearTimeout(this._suspendIdleEventsTimeoutId);this._suspendIdleEventsTimeoutId=this.async.setTimeout(this._onSuspensionCompleted,500)};t.prototype._onSuspensionCompleted=function(){this._isSuspended=!1};return t})(r.default);t.default=f});
define("Dxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.isFullScreen=function(){var e=window.document;return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement};e.enterFullScreen=function(){var t=window.document.body;e.isFullScreen()||(t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen())};e.exitFullScreen=function(){var e=window.document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()};e.isFullScreenAllowed=function(){var e=window.document;return e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled};return e})();t.default=n});
define("Sxe",["require","exports","$"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OneUpCarousel=n.createPairedEvent({eventName:"OneUpCarousel,",shortEventName:"OneUpCarousel"},{initialFileType:1,initialFileExtension:1,initialFileSize:2,pagesViewed:2,totalPages:2,isFolderShownInSession:3});t.default=t.OneUpCarousel});
define("yxe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("deeplinkCommentId")});
define("MIe",["require","exports","vxe","QB","TIe","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-one-up-slide",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("vxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="OneUp-slide" data-bind="control:component" role="presentation"></div>'});
define("TIe",["require","exports","lC","JB","bD","E","vh","lj","QH","gxe","lxe","dxe","ixe","axe","$Ie","ZIe","KIe","GIe","zIe","NIe","RIe","HIe","FIe","UIe","GH","dee","_D","mv","J$"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A={"3d":f.default,Audio:w.default,Error:l.default,FileHandler:c.default,Html:h.default,Other:d.default,Panorama:v.default,Image360:p.default,Pdf:g.default,Photo:m.default,TextFile:y.default,Thumbnail:b.default,Video:w.default,WAC:E.default,Wrs:S.default,Zip:x.default},O=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:u.default});r._offset=t.slide.offset;var i=r._oneUp=t.oneUp,s=t.renderOptions,o=r.observables,f=r._loadResult=o.createCallback({defaultValue:void 0,reducer:D});t.loadResult&&r.scope.attach(t.loadResult.register(f));r.slide={loadState:t.slide.loadState,offset:r._getSlideOffset(),item:t.slide.item,isIdleEnabled:o.create(!0),isEditCaptionEnabled:o.create(!1),isPanningEnabled:o.create(!s),hasHorizontalScrollbar:o.create(!1),hasVerticalScrollbar:o.create(!1),isFirstSlideOpened:o.create(!1),commandSet:o.create(),augmentCommandSet:o.create(),loadResult:f,renderOptions:s};var l=r.resources;r._fileHandlerProvider=l.consume(N.resourceKey.optional);var c=l.consume(k.platformDetection);r._enableHTML=a.isFeatureEnabled(a.UseSandboxHtmlViewer)&&(L.isIFrameSrcDocSupported()||c.isEdge);r._enablePdf=a.isFeatureEnabled(a.UseWebPdfViewer);r._enableImage360=a.isFeatureEnabled(a.Image360Viewer)&&!c.isMobile;r._enablePriority=a.isFeatureEnabled(a.SlidePriority);var h=r.priority=o.pureCompute(r._computePriority);r.scope.attach(i.currentPriority.register(h));r.name=o.pureCompute(r._computeName);r.name.equalityComparer=T.objectStrictEquality;r.key=o.pureCompute(r._computeKey);r.key.equalityComparer=T.objectStrictEquality;r.component=o.pureCompute(r._computeComponent);r._qos=o.compute(r._computeQos);o.compute(r._computeUpdateOneUpSlide);o.backgroundCompute(r._computeCompleteQos);return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0)};t.prototype._computeComponent=function(){var e=this.key(),t={slide:this.slide,oneUp:this._oneUp};return e&&u.toSpecification(e.bypass,t)};t.prototype._computeName=function(){var e=this.slide.item(),t=this._extension(e),n=(this.slide.renderOptions||{}).viewer;return!e||e.isPlaceholder?void 0:e.error?"Error":3===e.itemStatus||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected?"Other":n||(e.officeBundle?"Wrs":e.wopiFrameUrl?"WAC":this._hasFileHandler(e,t)?"FileHandler":this._enableHTML&&e.htmlConversion?"Html":this._enablePdf&&(".pdf"===t||".ai"===t||e.pdfConversion)?"Pdf":e.video?"Video":e.audio?"Audio":e.panorama?"Panorama":this._enableImage360&&e.image360?"Image360":e.model3d?"3d":e.zip?"Zip":this._useTextEditor(e)?"TextFile":e.photo?"Photo":e.thumbnail?"Thumbnail":"Other")};t.prototype._computeKey=function(){if(this._enablePriority){if(this.priority()<this._oneUp.currentPriority())return}var e=this.name();return e&&A[e]};t.prototype._computePriority=function(){var e=this.slide,t=e.loadState()>=3,n=e.offset(),r=(n>0?n:n<0?-n:0)+1;return t?r:-r};t.prototype._useTextEditor=function(e){return a.isFeatureEnabled(a.UseOneUpTextEditor)&&C.canOpenItemInMonaco(e)};t.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""};t.prototype._hasFileHandler=function(e,t){var n=this._fileHandlerProvider;return!!n&&(!!e.graph&&!!n.getDefaultPreviewHandler(t))};t.prototype._computeUpdateOneUpSlide=function(){this._offset()?this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0):this._oneUp.slide(this.slide)};t.prototype._getSlideOffset=function(){var e=this,t=this.createPureComputed(function(){var n=t.peek();return void 0!==n&&e._oneUp.isRotating()?n:e._offset()});return t};t.prototype._computeQos=function(){var e=this.slide,t=this._qosValue,r=this.name();if(r){if(t&&t.loaded.data.extraData.viewer===r)return t;if(!e.offset()&&!(e.loadState()>0||e.loadResult())){var o=e.item.peek(),u=o.size,a=e.renderOptions,f=a&&a.qosEvent,l=o.urls?o.urls[i.default.mediaBaseUrl]:"",c=n.__assign(n.__assign(n.__assign({},f&&f.data.extraData||{}),l?{mediaServiceRegion:l}:{}),{viewer:r,extension:this._extension(o),fileSize:u,fileSizeRange:M(u)});return this._qosValue={loaded:new s.Qos({name:"LoadSlide",extraData:c}),loaded2:new s.Qos({name:"ItemViewer."+r+".Load",extraData:c}),rendered:new s.Qos({name:"ItemViewer."+r+".Render",extraData:c})}}}};t.prototype._computeCompleteQos=function(){var e=this.slide;if(!e.offset()){var t=this._qos();if(t){var r=t.loaded,i=t.loaded2,u=t.rendered,a=this.name.peek(),f=e.item.peek(),l={extension:this._extension(f),fileSizeRange:M(f.size),viewer:a},c=this.key(),h=e.loadState();c&&h>=1&&u.end({resultType:s.ResultTypeEnum.Success,extraData:n.__assign(n.__assign({},u.data.extraData),l)});var p=this._loadResult();if(c&&p){var d=e.renderOptions,v=d&&d.qosEvent,m=n.__assign(n.__assign(n.__assign({},r.data.extraData),l),p.extraData||{}),g=n.__assign(n.__assign({},p),{extraData:m});r.end(g);i.end(g);v&&v.end(g);if(this._oneUp.shareLinkId){var y={};try{y.previewLoaded=Date.now();y.navigationStart=performance.timing.navigationStart;y.redirectStart=performance.timing.redirectStart;y.redirectEnd=performance.timing.redirectEnd}catch(e){}var b=n.__assign(n.__assign(n.__assign(n.__assign({},p),m),y),{slrid:this._oneUp.shareLinkId});this.resources.consume(o.resourceKey).logData({name:"ShareLinkClicked.PreviewLoaded",extraData:b})}}}}};return t})(r.default);t.default=O;function M(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return(1<<t%10)+"-"+(1<<t%10+1)+(t<10?" B":" "+"KMGTPEZY"[t/10-1|0]+"iB")}function _(e){e&&(e=(e=e.replace(/(tempauth|token|authkey)=[^&'"]+/g,"token=*")).replace(/[\w-]+:\/\/\S+/g,"*URI*"));return e}function D(e,t){return t&&n.__assign(n.__assign({},t),{error:_(t.error)})}});
define("gxe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Rxe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("lxe",["require","exports","bxe","uxe","lj"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-error",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("bxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="OneUp-error" data-bind="control:errorComponent"></div>'});
define("uxe",["require","exports","lC","E","jIe","fxe","lj"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:o.default});var i=t.slide.item.peek(),u=i&&i.error&&i.error.data,a=t.slide.renderOptions,f=t.showErrorActions,l=void 0===f||f;r.errorComponent={specification:o.toSpecification(s.resourceKey,{error:u,hideAction:!!a||!l}),afterRender:function(){return r._activate()}};return r}t.prototype._activate=function(){var e=this.slide,t=e.item.peek(),n=t&&t.error&&t.error.data,i=this.observables.create({resultType:r.ResultTypeEnum.Failure,resultCode:""+n.errorCode,error:n&&n.errorDetailedText,extraData:{CorrelationId:n&&n.correlationId}});this.scope.attach(e.loadResult.register(i));e.loadState(3)};return t})(i.default);t.default=u});
define("jIe",["require","exports","lC","JB","E"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadResultFromError=function(e){if(!e)return{resultCode:"unknown",resultType:i.ResultTypeEnum.Failure};var t=e.correlationId;return{resultCode:e.code||e.name,resultType:e.isExpected?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,error:e.message||""+e,extraData:t?{CorrelationId:t}:{}}};var s=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.slide=t.slide;r.oneUp=t.oneUp;return r}return t})(r.default);t.default=s});
define("dxe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["zxe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("ixe",["require","exports","cxe","oxe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-html",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("cxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showHtml--\x3e<div class="OneUp-html" data-bind="iframe:iframeOptions,class:className" style="-webkit-overflow-scrolling: touch;"></div>\x3c!--/ko--\x3e'});
define("oxe",["require","exports","lC","jH","Fe","E","u9","XA","jIe","sxe","Y$","lj","$Ie","yh","mv","QH"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,i){var s=e.call(this,t,i)||this;s.addBindingHandlers({control:c.default,iframe:l.default});var o=s,u=o.observables,a=o.slide,f=n.__assign(n.__assign({},a),{loadResult:u.createCallback(r.forSingleValue())}),p=i.platformDetection.isIOS;s.className=p?"iOS":"";s.showError=u.create(!1);s.showHtml=u.pureCompute(s._computeShowHtml);s.fallbackControl=c.toSpecification(h.default,{slide:f,oneUp:s.oneUp});s.iframeOptions=u.create();s._downloadDataSource=i.downloadDataSource;s._graphDataSource=i.graphDataSource;var d=s._loadResult=u.create();s.scope.attach(a.loadResult.register(d));s._populateContent(p);return s}t.prototype._computeShowHtml=function(){return!this.slide.offset()&&!!this.iframeOptions()};t.prototype._populateContent=function(e){var t=this,n=this.slide.item.peek();this.showError(!1);this.trackPromise(this._getContents(n).then(function(n){if(n){var r=v.isFeatureEnabled(v.OneUpHtmlAllowPopups)?"allow-popups":"",i=v.isFeatureEnabled(v.AllowCompatLegacyHtmlScripts)?"allow-scripts":"";t.iframeOptions({type:"content",sandbox:r+" "+i,content:n,onLoad:function(n){t.slide.loadState(3);t._loadResult({resultType:s.ResultTypeEnum.Success});var r=n.target;if(e&&r){var i=r.clientWidth,o=r.clientHeight;r.style.width=i+"px";r.style.height=o+"px"}}})}else{t._loadResult({resultType:s.ResultTypeEnum.ExpectedFailure,resultCode:"NoContent",error:"HTML is empty"});t._showError()}},function(e){t._loadResult({resultType:e&&e.isExpected?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,resultCode:e&&(e.code||e.name),error:e&&e.message});t._showError()}))};t.prototype._showError=function(){this.showError(!0);this.slide.loadState(3)};t.prototype._getContents=function(e){var t=e.extension,n=e.htmlConversion,r=t&&t.toLowerCase();if(n&&!(".htm"===r||".html"===r||".svg"===r)){var s=this._graphDataSource,a=n.url||s.getAuthenticationParams(e).then(function(t){return s.getItemUrl(e,{useDirectEndpoint:!0})+"/content?format=html&"+o.serializeQuery(t)});return i.default.resolve(a).then(function(e){return u.default.startAndPostProcess({url:e},function(e,t){return e.responseText})}).catch(function(e){if(e instanceof XMLHttpRequest){var t=new Error("HTTP "+e.status),n=e.getResponseHeader("X-ErrorCode");t.code=""+(n||e.status);t.isExpected=406===e.status;return i.default.reject(t)}return i.default.reject(e)})}return this._downloadDataSource.getItemContents(e).then(function(e){return f.quickParse(e,"text/html")}).then(function(e){return e.text})};t.dependencies=n.__assign(n.__assign({},a.default.dependencies),{downloadDataSource:p.download,graphDataSource:p.graph,platformDetection:d.platformDetection});return t})(a.default);t.default=m});
define("sxe",["require","exports","th","Fe","v"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fullParse=function(e,t,n){return r.default.all([o(e),o(e,n)]).then(function(e){var n=e[0],r=e[1],i=r.length>n.length;return{text:i?n:r,mimeType:t,isSafeText:i||s(r)}},function(e){return e.filter(function(e){return!r.default.isCanceled(e)})[0]||e[0]})};t.quickParse=function(e,t){return o(e).then(function(e){return{text:e,mimeType:t,isSafeText:!0}})};function s(e){for(var t=0;t<e.length;t++)if(!(n=e.charCodeAt(t),n<127||u[n]))return!1;var n;return!0}function o(e,t){var r=new n.default,s=new FileReader;s.onload=function(){r.complete(s.result||"")};s.onerror=function(e){var t=s.error;r.error(new i.ApiError({code:t&&(t.name||"Parse."+t.code)||"Parse",isExpected:!1,message:t&&t.message||"Parsing error"}))};s.readAsText(e,t);return r.getPromise()}var u={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}});
define("$Ie",["require","exports","nxe","exe","lj"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-other",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("nxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="OneUp-other" data-bind="activate:$component.activate.bind($component)"><div class="OneUp-other-content">\x3c!--ko if:itemMalwareDetected()--\x3e<div><img class="OneUp-other-malwareDetectedIcon" data-bind="attr:{src:malwareDetectedSvgUrl,alt:malwareDetectedIconAlt}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:itemMalwareDetected()--\x3e<div class="OneUp-other-fileIcon" data-bind="component:{name:fileTypeIconTagName,params:fileTypeIconViewModelParams}"></div>\x3c!--/ko--\x3e<div class="OneUp-other-fileName" data-bind="text:fileName"></div><div class="OneUp-other-message" data-bind="html:message"></div>\x3c!--ko if:showActions--\x3e<div class="OneUp-other-actions" data-bind="control:actionBarControl"></div>\x3c!--/ko--\x3e</div></div>'});
define("exe",["require","exports","lC","E","pe","wSe","lj","jIe","Ixe","oee","txe","Oz","Y0","d1","gD"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v='<a href="https://go.microsoft.com/fwlink/?linkid=862871" target="_blank">',m=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.strings=a.default;r.addBindingHandlers({activate:s.default,control:o.default});var u=t.slide.renderOptions,c=t.showActions,p=void 0===c?!u||!u.hideDownload:c;r._isOneDriveWinApp=h.isOneDriveWinApp();r.showActions=r._isOneDriveWinApp?r.showActionInOneDriveWinApp(t.slide.item().queryType,t.slide.item().type):p;r._allowInfectedDownload=n.allowInfectedDownload;r.malwareDetectedSvgUrl=window.require.toUrl("odsp-media/images/atp/malware_icon_208x208.svg");r.malwareDetectedIconAlt=a.default.malwareDetectedIconAriaLabel;r.itemMalwareDetected=r.createPureComputed(function(){var e=t.slide.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},{deferEvaluation:!0});r.fileTypeIconTagName=f.default.tagName;r.fileName=r.createPureComputed(function(){var e=t.slide.item();return e.displayName||e.name},{deferEvaluation:!0});r.fileTypeIconViewModelParams=r.createPureComputed(function(){var e=t.slide.item();return{iconName:e.iconName,iconUrl:e.iconUrl,extension:e.extension,desiredSize:96}},{deferEvaluation:!0});r.actionBarControl=o.toSpecification(l.resourceKey,{forceExternal:!!u,item:t.slide.item,hideOpenCommand:r.itemMalwareDetected});r.message=r.createPureComputed(function(){var e=t.slide.item();return r.itemMalwareDetected()?r._allowInfectedDownload?i.format(a.default.malwareDetectedAllowDownloadMessage,v,"</a>"):i.format(a.default.malwareDetectedMessage,v,"</a>"):3===e.itemStatus?a.default.blockedByPolicy:a.default.notPreviewAvaible});return r}t.prototype.activate=function(){var e=this.observables.create({resultType:r.ResultTypeEnum.ExpectedFailure,resultCode:"Fallback",error:"Fallback viewer loaded"}),t=this.slide;this.scope.attach(t.loadResult.register(e));t.loadState(3)};t.prototype.showActionInOneDriveWinApp=function(e,t){return e===p.default.SharedWithMe||t===d.default.Folder||t===d.default.Unknown||t===d.default.OneNote||t===d.default.File||t===d.default.Media};t.dependencies=n.__assign(n.__assign({},u.default.dependencies),{allowInfectedDownload:c.allowInfectedFileDownloadsResourceKey});return t})(u.default);t.default=m});
define("txe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["nOe"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("axe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["iCe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("ZIe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Yxe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("KIe",["require","exports","XIe","WIe","lj"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-photo",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("XIe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="OneUp-photo" data-bind="component:projector">\x3c!--ko control:getThumbnailControl($host)--\x3e\x3c!--/ko--\x3e</div>'});
define("WIe",["require","exports","lC","lj","qIe","NIe","jIe","Ee"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var s=e.call(this,t,n)||this;s.addBindingHandlers({control:r.default});s.slide.isEditCaptionEnabled(!0);var o=t.item,u=void 0===o?s.slide.item:o;s._item=u;s._isZoomed=s.createObservable(!1);var a={isEnabled:s.createPureComputed(function(){return!s.slide.offset()&&!s.oneUp.isRotating()}),isZoomed:s._isZoomed};s.projector={name:i.default.tagName,params:a};s.createBackgroundComputed(s._computeChangesOnZoom);return s}t.prototype.getThumbnailControl=function(e){var t=this,n=e.transform,i=e.isGliding,o=this.createPureComputed(function(){return n().scale}),a=this.createPureComputed(function(){var e=t.oneUp.size();return{width:e.width*n().scale,height:e.height*n().scale}});a.equalityComparer=u.deepCompare;var f=this.createPureComputed(function(){return!i()});return r.toSpecification(s.default,{slide:this.slide,oneUp:this.oneUp,size:a,scale:o,fallbackThumbnail:this.createPureComputed(this._computeFallbackThumbnail),allowLoading:f,item:this._item})};t.prototype._computeFallbackThumbnail=function(){var e=this._item().photo;if(e){var t=e.originalUrl,n=e.width,r=e.height;if(t)return{url:t,width:n,height:r}}};t.prototype._computeChangesOnZoom=function(){var e=this._isZoomed();this.slide.isPanningEnabled(!e)};return t})(o.default);t.default=a});
define("qIe",["require","exports","JIe","QB","YIe","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-projector",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("JIe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-Projector" data-bind="class:\'od-Projector--\'+mode,css:{\'od-Projector--gliding\':isGliding,\'od-Projector--panning\':isPanning},pan:{isActive:isPanning,transform:panTransform,mayStartPan:$component.mayStartPan.bind($component),constrainScale:$component.constrainPanScale.bind($component)},clientRect:{size:size},event:{dblclick:$component.toggleIsZoomed.bind($component)}"><div class="od-Projector-image" data-bind="style:imageStyle,host:{data:host}"></div></div>'});
define("YIe",["require","exports","lC","JB","Jz","PG","rG","FG","D7","I7","x7","UG"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,p=new a.default(0,0,1,1),d=p.getCenter();(function(e){e[e.live=0]="live";e[e.preview=1]="preview"})(h=t.ProjectorMode||(t.ProjectorMode={}));var v=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({host:i.default,pan:s.default,clientRect:o.default});var a=t.isZoomed,f=void 0===a?r.createObservable(!1):a,l=t.isEnabled,p=void 0===l?r.createObservable(!0):l,d=t.mode,v=void 0===d?h.live:d;r.panTransform=r.createObservable(u.default.IDENTITY);r.panTransform.equalityComparer=s.areTransformsEqual;r.contentTransform=r.createObservable(u.default.IDENTITY);r.contentTransform.equalityComparer=s.areTransformsEqual;r.imageTransform=r.createObservable(u.default.IDENTITY);r.imageTransform.equalityComparer=s.areTransformsEqual;r.isPanning=r.createObservable(!1);r.isGliding=r.createObservable(!1);r.isZoomed=f;r.isEnabled=p;r.size=r.createObservable();r._lastZoomTogglePosition=null;r._mode=v;r.mode=h[r._mode];r.createBackgroundComputed(r._computeResetGlide);r.createBackgroundComputed(r._computePreviewTransform);r.createBackgroundComputed(r._computeCommitTransform);var m=r.createBackgroundComputed(r._computeStartGlide);r.createBackgroundComputed(r._computeEndGlide).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var g=r.createBackgroundComputed(r._computeApplyTransformOnZoomed);r.createBackgroundComputed(r._computeResetZoomOnTransformed);r.imageStyle=r.createPureComputed(r._computeImageStyle,{deferEvaluation:!0});if(!n||!n.disableFrameSkip){c.skipAnimationFrame(m,r.async);c.skipAnimationFrame(g,r.async)}r.host={transform:r._mode===h.live?r.panTransform:r.contentTransform,isGliding:r.isGliding};return r}t.prototype.toggleIsZoomed=function(e,t){var n=this.size.peek(),r=n&&new l.default(t.clientX/n.width,t.clientY/n.height)||d;this._lastZoomTogglePosition=r;this.isZoomed(!this.isZoomed())};t.prototype.mayStartPan=function(e,t,n){return this.isEnabled.peek()&&(Math.abs(t)>=10&&n.length>=2||this.isZoomed.peek()&&e.translate.abs()>=10)};t.prototype.constrainPanScale=function(e){return Math.max(1,Math.min(4,e))};t.prototype._computeResetGlide=function(){if(this.isPanning()){this.isGliding(!1);this.isZoomed(!0)}};t.prototype._computePreviewTransform=function(){if(this.isPanning()){var e=this.panTransform();e=m(e,!0);this.imageTransform(this.contentTransform().invert().multiply(e))}};t.prototype._computeCommitTransform=function(){if(!this.isPanning()&&!this.isGliding.peek()){var e=this.panTransform.peek();e=e.scale<u.default.IDENTITY.scale?u.default.IDENTITY:m(e);this._applyTransform(e)}};t.prototype._computeStartGlide=function(){if(!this.isPanning()&&!u.default.areEqual(this.imageTransform(),u.default.IDENTITY)){this.isGliding(!0);this.imageTransform(u.default.IDENTITY)}};t.prototype._computeEndGlide=function(){var e=this.isPanning(),t=this.isGliding();!e&&t&&this.isGliding(!1)};t.prototype._computeApplyTransformOnZoomed=function(){var e=this.isZoomed(),t=this.isEnabled(),n=this.isPanning.peek(),r=this.contentTransform.peek();n||(e&&t?u.default.areEqual(r,u.default.IDENTITY)&&this._applyTransform(u.default.zoom(l.default.ORIGIN,this._lastZoomTogglePosition||d,3)):u.default.areEqual(r,u.default.IDENTITY)||this._applyTransform(u.default.IDENTITY));this._lastZoomTogglePosition=null};t.prototype._computeResetZoomOnTransformed=function(){var e=this.isPanning(),t=this.contentTransform();!e&&u.default.areEqual(t,u.default.IDENTITY)&&this.isZoomed(!1)};t.prototype._computeImageStyle=function(){var e=this.contentTransform(),t=this.imageTransform();if(this._mode===h.live){var n=e.multiply(t);return{left:100*n.translate.x+"%",top:100*n.translate.y+"%",width:100*n.scale+"%",height:100*n.scale+"%"}}var r="translate("+100*t.translate.x+"%, "+100*t.translate.y+"%)";return{left:100*e.translate.x+"%",top:100*e.translate.y+"%",width:100*e.scale+"%",height:100*e.scale+"%","-ms-transform":r,"-webkit-transform":r,transform:r}};t.prototype._applyTransform=function(e){var t=this.contentTransform.peek().multiply(this.imageTransform.peek());this.contentTransform(e);this.imageTransform(e.invert().multiply(t));this.panTransform(e)};return t})(r.default);t.default=v;function m(e,t){void 0===t&&(t=!1);var n=Math.max(u.default.IDENTITY.scale,e.scale),r=new a.default(e.apply(d).subtract(new l.default(n,n).scale(.5)),new f.default(n,n)),i=p,s=i.nudge(r),o=i.getCenter().subtract(s.getCenter());t&&(o=o.unit().scale(o.abs()-Math.atan(Math.PI*o.abs())/Math.PI*Math.log(e.scale/u.default.IDENTITY.scale)));return new u.default(o).multiply(e)}});
define("NIe",["require","exports","VIe","BIe","lj","f3e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-thumbnail",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("VIe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko if:hasError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!hasError()&&hasThumbnail()--\x3e\x3c!--ko component:{name:thumbnailTagName,params:thumbnailParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("BIe",["require","exports","lC","w3e","jH","kee","UG","E","lj","f3e","$Ie","jIe","v","QH","Hr"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t,r){var s=e.call(this,t,r)||this;s.addBindingHandlers({control:a.default});s.thumbnailTagName=f.default.tagName;var u=s,c=u.observables,h=u.slide,v=t.slide.renderOptions,m=t.scale,g=void 0===m?c.create(1):m,y=t.size,b=void 0===y?s.oneUp.size:y,w=t.allowLoading,E=void 0===w?c.create(!0):w,S=t.fallbackThumbnail,x=t.showErrorActions,T=void 0===x?!v||!v.hideDownload:x,N=t.allowError,C=void 0===N||N,k=t.item,L=void 0===k?h.item:k,A=t.isPreview;s._item=L;s._scale=g;s._size=b;s._fallbackThumbnail=S;s._allowError=c.wrap(C);s._isLoaded=c.create(!1);s._isRendered=c.create(!1);c.backgroundCompute(s._updateSlideLoadState);s._image=c.pureCompute(s._computeImage);s._image.equalityComparer=d.areShallowEqual;s._desiredSize=c.pureCompute(s._computeDesiredSize);s._desiredSize.equalityComparer=d.areShallowEqual;s._rotation=c.pureCompute(s._computeRotation);s._markAccess=p.isFeatureEnabled(p.ReportOneUpFileAccess)&&c.pureCompute(function(){return!A&&!h.offset()});s._error=c.create();s._fadeIn=c.pureCompute(function(){return Math.abs(s.slide.offset())<2});s._allowLoading=c.pureCompute(function(){var e=E(),t=s.oneUp.isRotating();return e&&!t});s._coverage=o.withComparer(c.pureCompute(s._computeImageFrameCoverage),d.areShallowEqual);s.hasThumbnail=c.pureCompute(s._computeHasThumbnail);s.thumbnailParams=c.pureCompute(s._computeThumbnailParams);s.hasError=c.pureCompute(s._computeHasError);var O=n.__assign(n.__assign({},t),{showActions:T,slide:n.__assign(n.__assign({},t.slide),{loadResult:c.createCallback(i.forSingleValue())})});s.fallbackControl=a.toSpecification(l.default,O);var M=s._result=c.pureCompute(s._computeResult);s.scope.attach(t.slide.loadResult.register(M));return s}t.prototype._computeImage=function(){var e=this._item(),t=(e.orientedThumbnail||e).thumbnail||this.unwrapObservable(this._fallbackThumbnail),r=this._markAccess;if(r){var i=t&&t.url;if(i&&i.indexOf("provider=spo")>=0){var s=i.replace(/&(width|height)=[^&]*/g,""),o=r()?"Access":"Preview";return n.__assign(n.__assign({},t),{action:o,getAligned:function(e){return{width:e.width,height:e.height,url:s+"&width="+(0|e.width)+"&height="+(0|e.height)+"&action="+o}}})}}return t};t.prototype._computeRotation=function(){var e=this._item().orientedThumbnail;return e?e.rotation:r.default.none};t.prototype._computeImageFrameCoverage=function(){var e,t=this._image(),n=this._size();t.width&&t.height&&(t.width>n.width||t.height>n.height)&&(e=.25);return{minimum:0,maximum:1,fallback:e}};t.prototype._computeHasThumbnail=function(){return!(!this._size().width||!this._image()||!this.slide.loadState()&&this.hasError())};t.prototype._computeResult=function(){var e=this._result.peek();if(e)return e;var t=this._error();if(t){var n=void 0,r=!1;if(t instanceof h.ApiError){n=t.code;r=t.isExpected}return{resultType:r?u.ResultTypeEnum.ExpectedFailure:u.ResultTypeEnum.Failure,resultCode:n||"LoadFailure",error:"Unable to load image"}}return this._isLoaded()?{resultType:u.ResultTypeEnum.Success}:void 0};t.prototype._computeHasError=function(){var e=this.hasError.peek();if(!e){e=this._allowError()&&!!this._error();var t=this._error();if(t&&t instanceof Array)for(var n=0;n<t.length;n++)if(t[n]&&"NeedAccessToken"===t[n].message)return!1}return e};t.prototype._computeDesiredSize=function(){var e=this._size(),t=this._image();if("Preview"!==(t&&t.action))return e;var n=Math.max(e.width,e.height),r=t&&Math.max(t.width,t.height)||0;if(r&&n>r)return m(r);for(var i=0,s=[400,960,1600,2560];i<s.length;i++){var o=s[i];if(r&&o>r)return m(r);if(o>n)return m(o)}return m(2560)};t.prototype._computeThumbnailParams=function(){var e;this.hasThumbnail()&&(e={image:this._image,rotation:this._rotation,desiredSize:this._desiredSize,scale:this._scale,error:this._error,alignment:s.AlignmentType.fit,fadeIn:this._fadeIn,isCurrent:this._isLoaded,isLoaded:this._isRendered,coverage:this._coverage,allowLoading:this._allowLoading});return e};t.prototype._updateSlideLoadState=function(){var e=this.slide.loadState;this._isLoaded()?e(3):this._isRendered()&&e(2)};return t})(c.default);t.default=v;function m(e){return{width:e,height:e}}});
define("GIe",["require","exports","X_","Ate"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.default.addConfig({map:{"*":{"../build/pdf.js":"LAe"}}});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["cCe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("zIe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["_Ce"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("RIe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Oke"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("HIe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["ACe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("FIe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["TCe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("UIe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["WCe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("kIe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.oneUpPriorityOptions={defaultValue:-1/0,reducer:function(e,t){return e>0?t:t>0?e:Math.max(e,t)}}});
define("AIe",["require","exports","lC","ZB","eG","e"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._isActive=r.observables.create(!0);new(r.managed(i.default))({element:r.element,allBindingsAccessor:r.allBindingsAccessor,bindingContext:r.bindingContext,valueAccessor:function(){return{isActive:r._isActive}}});s.applyBindingsToNode(r.element,{attr:{"aria-hidden":r.observables.pureCompute(function(){return r._isActive()?void 0:"true"})}},r.bindingContext);return r}return t})(r.default);t.default=o});
define("EIe",["require","exports","X_","Zz"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:r.factory})});
define("wIe",["require","exports","X_","Zz"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:r.factory})});
define("a6e",["require","exports","BH","X_"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.focusedInfoPaneSectionResourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(),disposable:t}}}})});
define("Rxe",["require","exports","Vxe","Bxe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-3d",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("Vxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:hasError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showViewer--\x3e<div class="OneUp-3d" touch-action="none" data-bind="element:container" role="application"></div>\x3c!--/ko--\x3e'});
define("Bxe",["require","exports","lC","jH","Fe","th","E","u9","v","lj","fG","jIe","yh","$Ie","jxe","i"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function m(e,t){return-1===t.search(/^http/)||t.lastIndexOf(":")===t.indexOf(":")&&t.indexOf("/content?format=")<0||t.indexOf(":/content?")>=0?t:(t.indexOf("/content?format=")>=0?""+t:t+":/content?")+u.serializeQuery(e)}var g=(function(e){n.__extends(t,e);function t(t,u){var h=e.call(this,t,u)||this,m=h.observables,g=t.slide;h.fallbackControl=f.toSpecification(p.default,n.__assign(n.__assign({},t),{slide:n.__assign(n.__assign({},g),{loadResult:m.createCallback(r.forSingleValue())})}));h.addBindingHandlers({control:f.default,element:l.default});h.isSlideCurrent=m.pureCompute(function(){return!h.slide.offset()},{deferEvaluation:!0}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});h.hasError=m.create(!1);h.container=m.create(null);g.loadState(1);var y=m.create();g.loadResult.register(y);h._graphDataSource=u.graphDataSource;h.showViewer=m.pureCompute(function(){return h.isSlideCurrent()&&!h.hasError()});m.backgroundCompute(function(){var e=h.container();if(e&&h.showViewer()){if(!h._viewer){var t=h._viewer=h.scope.attach(new v.DefaultViewer(e,{extends:"extended",templates:{navBar:{params:{text:{fullscreenButton:d.default.fullscreenButton,hdButton:d.default.hdButton,helpButton:d.default.helpButton,printButton:d.default.printButton,vrButton:d.default.vrButton}}},main:{}}})),n=new s.default(function(){t.dispose()});t.onInitDoneObservable.add(function(){n.complete(t)});h.trackPromise(h._viewerPromise=n.getPromise())}var r=h.slide.item.peek();h.trackPromise(h.loadItem(r).then(function(){y({resultType:o.ResultTypeEnum.Success});h.slide.loadState(3)},function(e){if(i.default.isCanceled(e)){e=new a.ApiError({isExpected:!0,code:"Canceled",message:"canceled"});console.log("Model load canceled")}else console.error("Error loading Model: ",e);y(c.loadResultFromError(e));h.slide.loadState(3);h.hasError(!0)}))}else if(e&&h._viewer){h._viewer.dispose();h._viewerPromise.cancel();h._viewer=null;h._viewerPromise=null}});return h}t.prototype.loadItem=function(e){var t=this;return i.default.resolve().then(function(){if(t.scope.isDisposed)throw new a.ApiError({code:"Disposed",message:"Viewer has already been destroyed"});var n=t._graphDataSource,r=e.extension,o=e.model3d;if(!o)throw new a.ApiError({isExpected:!0,code:"UnsupportedFormat",message:"Missing 3D facet on file with extension: "+r});var f=e.properties&&e.properties.FileLeafRef||e.name,l=".gltf"===r.toLowerCase(),c=e.parent,h=f.slice(-r.length)===r?f:""+f+r,p=c?n.getAuthenticationParams(c):void 0,d=l&&c?n.getItemUrl(e.parent,{useDirectEndpoint:!0,isPath:!0})+"/":"",g=l&&c&&p.then(function(e){v.BABYLON.Tools.PreprocessUrl=m.bind(null,e)}),b=i.default.resolve().then(function(){if(o.canRenderNative)return l?h:n.getDownloadUrl(e,{useDirectEndpoint:!0});var t=o.conversionUrl;if(t)return t.indexOf("{.authParams}")>=0?p.then(function(e){return t.replace("{.authParams}",u.serializeQuery(e))}):t;if(o.canConvert)return p.then(function(t){return n.getItemUrl(e,{useDirectEndpoint:!0})+"/content?format=glb&"+u.serializeQuery(t)});throw new a.ApiError({isExpected:!0,code:"UnsupportedFormat",message:"Invalid 3D facet on file with extension: "+r})}),w=new s.default;i.default.all([b,t._viewerPromise,g]).then(function(e){var t=e[0],n=e[1],r={url:t,title:f,root:l?d:void 0,loader:l?".gltf":".glb"},i=n.initModel(r,!0);i.onCompleteObservable.addOnce(function(){w.complete()});i.onLoadErrorObservable.add(function(e){var t=e.exception,n=t&&t.request,r=y(n,"x-errorcode")||y(n,"x-clienterrorcode"),i=n&&n.status,s=t&&t.name||"InvalidData",o=n&&(i>=400&&i<=406||412===i);w.error(new a.ApiError({isExpected:o,code:i||s,message:r||s}))})},function(e){w.error(e)});return w.getPromise()})};t.dependencies=n.__assign(n.__assign({},c.default.dependencies),{graphDataSource:h.graph});return t})(c.default);t.default=g;function y(e,t){if(e)try{return e.getResponseHeader(t)}catch(e){}}});
define("zxe",["require","exports","Qxe","Gxe","lj"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-fileHandler",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("Qxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="OneUp-fileHandler" data-bind="iframe:iframeOptions"></div>'});
define("Gxe",["require","exports","lC","qxe","E","u9","Se","Kxe","jIe","lj","Y$","nK","dee","yh","IZ","$Ie"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.fallbackControl=f.toSpecification(v.default,t);var i=t.item,s=void 0===i?r.slide.item:i;r.addBindingHandlers({control:f.default,iframe:l.default});var o=r.observables;r.hasError=o.create(!1);var u=r._loadResult=o.create();r.scope.attach(t.slide.loadResult.register(u));r._dataRequestor=n.vroomDataRequestor;r._fileHandlerProvider=n.fileHandlerProvider;r._fileHandlerHelperPromise=r.resources.consumeAsync(d.fileHandlerHelper.bypass);r._graphDataSource=n.graphDataSource;r._item=s;r.iframeOptions=o.create();o.backgroundCompute(r._computePreview);return r}t.prototype._computePreview=function(){var e=this._item();if(!this.iframeOptions.peek()&&0===this.slide.offset()){var t=this._fileHandlerProvider.getDefaultPreviewHandler(e.extension);t?t.handler.version>=3?this._loadV3(t,e):this._loadV2(t,e):this.hasError(!0)}};t.prototype._loadV2=function(e,t){var r=this;this._fileHandlerHelperPromise.then(function(n){return n.getInvocationParams({items:[t],action:e})}).then(function(e){r.iframeOptions(n.__assign(n.__assign({},e),{type:"post",className:"OneUp-fileHandler-frame",sandbox:"allow-forms allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts",onLoad:function(){r.slide.loadState(3);r._loadResult({resultType:i.ResultTypeEnum.Success})}}))},function(e){r.slide.loadState(3);r._loadResult({resultType:i.ResultTypeEnum.Failure,resultCode:"GetPostParams",error:e&&e.message||""+e})})};t.prototype._loadV3=function(e,t){var r=this,a=(function(e){var t=new Uint8Array(e);(window.crypto||window.msCrypto).getRandomValues(t);return String.fromCharCode.apply(null,t.map(function(e){return e%26+"A".charCodeAt(0)}))})(10),f=window.location,l={origin:f.protocol+"//"+f.host,channelId:a},c=e.url,h=new o.default(c).authority,p=this.scope.attach(u.createHost({channelId:a,origin:h,onCommand:this._onCommand.bind(this)})),d=c+(c.indexOf("#")>=0?"&":"#")+s.serializeQuery(l);this.iframeOptions({type:"get",className:"OneUp-fileHandler-frame",sandbox:"allow-forms allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts",url:d});var v=this._graphDataSource,m=v.getItemUrl(t,{useDirectEndpoint:!0});this._dataRequestor.send({apiName:"LoadFileHandler",path:m,accessToken:v.getAccessToken(t)}).then(function(e){var t=n.__assign(n.__assign({},e),{"@microsoft.graph.downloadUrl":e["@content.downloadUrl"]});return p.ready.then(function(){return p.sendCommand({command:"load",item:t})})}).then(function(e){r.slide.loadState(3);if("success"===e.result)r._loadResult({resultType:i.ResultTypeEnum.Success});else{r.iframeOptions(void 0);p.dispose();r._loadResult({resultType:e.isExpected?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,resultCode:e.error.code,error:e.error.message})}}).catch(function(e){r._loadResult({resultType:e.isExpected?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,resultCode:e.code||e.name,error:e.message})})};t.prototype._onCommand=function(e){var t=e.command;if("close"===t){r.pressEsc();return Promise.resolve({result:"success"})}var n={result:"error",error:{code:"unsupportedCommand",message:"Unknown command "+t},isExpected:!0};return Promise.resolve(n)};t.dependencies=n.__assign(n.__assign({},a.default.dependencies),{fileHandlerProvider:h.resourceKey,graphDataSource:p.graph,vroomDataRequestor:c.resourceKey});return t})(a.default);t.default=m});
define("qxe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Keys={enter:13,escape:27,space:32,end:35,home:36,left:37,up:38,right:39,down:40};function n(e,t){void 0===t&&(t={});var n,r=t.code||e.charCodeAt(0),i={bubbles:!0,cancelable:!0,key:e,keyCode:r,ctrlKey:t.ctrl,shiftKey:t.shift,altKey:t.alt,metaKey:t.meta,which:r};try{n=new KeyboardEvent(t.type||"keydown",i)}catch(e){}var s=t.target||document.body;if(n){if(!n.keyCode){n.charCodeVal=r;Object.defineProperty(n,"keyCode",{get:function(){return this.charCodeVal}})}if(!n.which){n.charCodeVal=r;Object.defineProperty(n,"which",{get:function(){return this.charCodeVal}})}s.dispatchEvent(n)}else{var o=document.createEvent("KeyboardEvent");if(o&&o.initKeyboardEvent){var u=[];i.ctrlKey&&u.push("Control");i.metaKey&&u.push("Meta");i.altKey&&u.push("Alt");i.shiftKey&&u.push("Shift");o.initKeyboardEvent(t.type||"keydown",i.bubbles,i.cancelable,window,e,0,u.join(" "),!1,"");s.dispatchEvent(o)}}}t.pressKey=n;t.pressEnter=function(e){void 0===e&&(e={});e.code=13;n("Enter",e)};t.pressEsc=function(e){void 0===e&&(e={});e.code=27;n("Esc",e)};t.pressKeys=function(e,t){for(var r=0,i=e;r<i.length;r++){n(i[r],t)}}});
define("Kxe",["require","exports","Qn","Wxe","x"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createHost=function(e,t){void 0===t&&(t={});var s=e.channelId,o=e.origin,u=e.receiver,a=void 0===u?window:u,f=e.source,l=e.identifyParent,c=t.eventGroupType,h=void 0===c?n.EventGroup:c,p=t.messengerType,d=void 0===p?r.Messenger:p,v=new i.Scope,m=v.attach(new h(null));return new d({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var n;if(l&&f){var r=setInterval(function(){var e={type:"identify-parent",channelId:s};f.postMessage(e,o)},100);n=v.attach({dispose:function(){clearInterval(r)}})}m.on(a,"message",function(t){var r=t.data;if(t.origin===o&&(!f||t.source===f)&&r&&"object"==typeof r&&"initialize"===r.type&&r.channelId===s){n&&n.dispose();m.dispose();var i=r.replyTo;i.postMessage({type:"activate"});e(i)}})},initResources:v,initTimeoutMs:e.initTimeoutMs})}});
define("Wxe",["require","exports","Zn","Qn","x"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=0,o=(function(){function e(e,t){var s=this;void 0===t&&(t={});var o=new Map,u={onCommand:e.onCommand,onNotification:e.onNotification},a=e.initResources,f=e.initTimeoutMs,l=void 0===f?1e4:f,c=t.asyncType,h=void 0===c?n.Async:c,p=t.eventGroupType,d=void 0===p?r.EventGroup:p,v=this._scope=new i.Scope;v.attach(a);var m,g=this._async=v.attach(new h(this)),y=v.attach(new d(this));this._invokeCommandHandler=function(e){try{var t=u.onCommand&&u.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:"handlerRejection",isExpected:!1,message:"Unknown error"}).code||e.name||"handlerRejection",message:e.message||""+e},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: "+e.name+"; Message: "+(e.message||e)}})}};this._invokeNotificationHandler=function(e){try{u.onNotification&&u.onNotification(e)}catch(e){}};var b=this._port=new Promise(function(t,n){v.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code="canceled";n(e)}});m=g.setTimeout(function(){var e=new Error("Initialization timed out after "+l+"ms");e.code="setupTimeout";n(e)},l);e.init(function(e){g.clearTimeout(m);v.attach({dispose:function(){e.close()}});y.on(e,"message",function(t){var n=t.data;if(n&&"object"==typeof n)return"acknowledge"===n.type?s._onAcknowledge(n):"command"===n.type?s._onCommand(e,n):"notification"===n.type?s._onNotification(n):"result"===n.type?s._onResult(n):void 0});e.start();t(e)},n)});this.ready=b.then(function(){},function(e){s.dispose();return Promise.reject(e)});this._signals=o}e.prototype.dispose=function(){this._scope.dispose();this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:"canceled",message:"Messenger disposed"}})});this._signals.clear()};e.prototype.sendCommand=function(e,t){var n=this;if(this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var r=++s,i=(t||{}).timeoutDelayMs,o=void 0===i?1e4:i;return this._port.then(function(t){var i=n._async,s=new Promise(function(e){n._signals.set(r,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(u(r,"acknowledgeTimeout"))},250),resultTimeout:i.setTimeout(function(){n._onResult(u(r,"resultTimeout"))},o),resolve:e})});t.postMessage({type:"command",id:r,data:e});return s})};e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})};e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)};e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n});this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})};e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)};e.prototype._onResult=function(e){var t=e.id,n=this._async,r=this._signals,i=r.get(t);if(i){n.clearTimeout(i.acknowledgeTimeout);n.clearTimeout(i.resultTimeout);i.resolve(e.data)}r.delete(t)};return e})();t.Messenger=o;function u(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}});
define("Yxe",["require","exports","aCe","nCe","lj","Jxe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-panorama",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("aCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko ifnot:showPanorama--\x3e\x3c!--ko control:thumbnailControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showPanorama--\x3e<div class="OneUp-panorama" data-bind="component:{name:\'od-panorama\',params:panoramaParams}"></div>\x3c!--/ko--\x3e'});
define("nCe",["require","exports","lC","e","E","lj","jIe","NIe","jH"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,r){var o=e.call(this,t,r)||this;o.addBindingHandlers({control:s.default});var f=o.observables;t.slide.isEditCaptionEnabled(!0);o._isInteractive=f.create(!1);o.showPanorama=f.pureCompute(function(){return!t.slide.offset()});var l=f.create(!1),c=f.pureCompute(function(){return l()?{resultType:i.ResultTypeEnum.Success}:void 0});o.scope.attach(t.slide.loadResult.register(c));f.backgroundCompute(function(){l()&&t.slide.loadState(3)});o.panoramaParams={item:t.slide.item,isLoaded:l,isInteractive:o._isInteractive};o.thumbnailControl=s.toSpecification(u.default,{slide:n.__assign(n.__assign({},t.slide),{loadResult:f.createCallback(a.forSingleValue())}),oneUp:t.oneUp,isPreview:!0});o.createComputed(o._computeChangesOnInteractive);return o}t.prototype._computeChangesOnInteractive=function(){var e=this._isInteractive();if(!r.computedContext.isInitial()){this.oneUp.isInfoPaneExpanded(!1);this.oneUp.isCommandBarVisible(!e);this.slide.isPanningEnabled(!e);this.slide.isEditCaptionEnabled(!e)}};return t})(o.default);t.default=f});
define("Jxe",["require","exports","tCe","Zxe","QB","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-panorama",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("tCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-Panorama" data-bind="css:{\'od-Panorama--isInteractive\':isInteractive}"><div class="od-Panorama-sivContainer" data-bind="immersiveViewer:{viewer:viewer,downloadUrl:downloadUrl,worldConfiguration:worldConfiguration}"></div><button class="od-Panorama-interactiveModeButton" data-bind="click:onClickInteractiveButton,style:{backgroundImage:\'url(\\\'\'+interactiveButtonUrl+\'\\\')\'},attr:{\'aria-label\':enterInteractiveModeAria}"></button><button class="od-Panorama-backButton ms-Icon ms-Icon--Cancel ms-Icon--Circle ms-Icon--m" data-bind="icon:true,click:onClickBackButton,attr:{\'aria-label\':exitInteractiveModeAria}"></button></div>'});
define("Zxe",["require","exports","lC","e","JB","yh","eCe","$xe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.enterInteractiveModeAria=u.default.EnterInteractiveModeAria;n.exitInteractiveModeAria=u.default.ExitInteractiveModeAria;n.addBindingHandlers({immersiveViewer:o.default});n.item=t.item;n._isLoaded=t.isLoaded;n._parentInteractive=t.isInteractive;n.interactiveButtonUrl=window.require.toUrl("odsp-media/images/panorama/interactivemodebuttonrest.png");n.viewer=r.observable(null);n.worldConfiguration=r.observable(null);n.downloadUrl=r.observable(null);n.isInteractive=r.observable(n._parentInteractive());n._boundHandlePanning=n._handlePanning.bind(n);n._isGoingClockwise=!0;n.loadPanorama();n.createComputed(function(){n._onInteractiveChange()});return n}t.prototype.loadPanorama=function(){var e=this,t=this.viewer();if(t){t.dispose();this.viewer(null)}var n=r.utils.unwrapObservable(this.item);n&&this.resources.consumeAsync(s.download).then(function(t){return t.getDownloadUrl(n,{downloadType:2}).then(function(t){e.downloadUrl(t)})});this._isLoaded(!0)};t.prototype.onClickInteractiveButton=function(){this.isInteractive(!0)};t.prototype.onClickBackButton=function(e,t){t.stopPropagation();this.isInteractive(!1);return!0};t.prototype._onInteractiveChange=function(){var e=this.isInteractive(),t=this.viewer();if(e){this._parentInteractive(!0);if(t){this._stopAutoPan();t.setIsInteractive(!0);t.setFocus()}}else{if(t){this._resetView();this._startAutoPan();t.setIsInteractive(!1)}this._parentInteractive(!1)}};t.prototype._resetView=function(){var e=this.viewer(),t=this.worldConfiguration();if(e&&t){var n=t.source;e.setView(n?n.startingPitch:0,n?n.startingHeading:0,Math.PI);this._isGoingClockwise=!0}};t.prototype._startAutoPan=function(){var e=this.viewer();if(e){this._handlePanning();e.viewChangeEndEvent.addEventListener(this._boundHandlePanning)}};t.prototype._stopAutoPan=function(){var e=this.viewer();if(e){e.setView(e.getPitch(),e.getHeading(),e.getVerticalFov());e.viewChangeEndEvent.removeEventListener(this._boundHandlePanning)}};t.prototype._handlePanning=function(){var e=this,t=this.viewer();if(this.isInteractive())this._stopAutoPan();else{var n=t.getBounds(),r=n.right||Math.PI,i=n.left||-Math.PI,s=n.top||Math.PI/2,o=n.bottom||-Math.PI/2,u=r-i,a=u>=s-o,f=t.getHeading(),l=t.getPitch(),c=f,h=l;if(a)if(u===2*Math.PI)if(f===r||f===i){c=0;this._isGoingClockwise=!this._isGoingClockwise}else c=this._isGoingClockwise?r:i;else c=f<r?r:i;else h=l<s?s:o;var p=1e3*(Math.abs(c-f)+Math.abs(h-l))/.05;this.async.setTimeout(function(){e.isInteractive()||t.setView(h,c,t.getVerticalFov(),!0,p)},1e3)}};return t})(i.default);t.default=a});
define("eCe",["require","exports","e","t3","Fe","S7","$xe","oc"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e,t){return e+"?psid=1&zippath="+t}var f=(function(){function t(){}t.init=function(t,f,l,c,h){var p,d,v=f(),m=v.downloadUrl.subscribe(function(t){if(t){var n=a(t,"formats/cubemap/cubemap.json");d=r.loadModule({path:"u",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["u"],t,n)}))}}).then(function(){var e=new Microsoft.ImmersiveViewer.PhotosynthSivDataSource;p=e;e.createFromJsonUri(n,g,function(){return a(t,"")},!0,!0)})}});function g(e,n){if(e){v.worldConfiguration(e);(function(){v.viewer(new Microsoft.ImmersiveViewer.SharedImmersiveViewer(t,{dataSources:[p],backgroundColor:null,width:t.offsetWidth,height:t.offsetHeight}));var e=document.getElementById("sivZoomInButton");e.textContent="";e.setAttribute("aria-label",o.default.ZoomIn);s.default.toggleClass(e,u.getIconClassName("Add"),!0);s.default.toggleClass(e,"ms-Icon--m",!0);var n=document.getElementById("sivZoomOutButton");n.setAttribute("aria-label",o.default.ZoomOut);s.default.toggleClass(n,u.getIconClassName("Remove"),!0);s.default.toggleClass(n,"ms-Icon--m",!0);n.textContent=""})()}}n.utils.domNodeDisposal.addDisposeCallback(t,function(){m.dispose();d&&d.cancel();var e=v.viewer();if(e){e.dispose();v.viewer(null)}v.worldConfiguration(null)})};return t})();t.default=f});
define("iCe",["require","exports","sCe","oCe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-image360",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("sCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:hasError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:show360Viewer--\x3e<div class="OneUp-Image360"><div class="OneUp-Image360-content"><div class="od-OneUpImage360-container">\x3c!--ko if:viewerIsLoaded()--\x3e<div class="od-OneUpImage360" role="presentation" data-bind="react:viewer360"></div>\x3c!--/ko--\x3e\x3c!--ko if:!imgIsLoaded()--\x3e<div class="OneUp-Image360-loadingContainer" data-bind="style:loadingContainerStyle"><div class="OneUp-Image360-loading"><span class="ms-font-s OneUp-Image360-loadingSpinner" data-bind="component:loadingComponent"></span></div></div>\x3c!--/ko--\x3e</div></div></div>\x3c!--/ko--\x3e'});
define("oCe",["require","exports","lC","Fe","lj","jIe","hj","yh","$Ie","jH","u9","th","E","UJ","bz","v"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(t){n.__extends(m,t);function m(u,l){var c=t.call(this,u,l)||this,p=c.observables,v=u.slide;c.fallbackControl=i.toSpecification(a.default,n.__assign(n.__assign({},u),{slide:n.__assign(n.__assign({},v),{loadResult:p.createCallback(f.forSingleValue())})}));c.addBindingHandlers({control:i.default,react:o.default});c.isSlideCurrent=p.pureCompute(function(){return!v.offset()},{deferEvaluation:!0}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});c.viewerIsLoaded=p.create(!1);c.imgIsLoaded=p.create(!1);c.hasError=p.create(!1);c.thumbnails=p.create({});c._graphDataSource=l.graphDataSource;c.show360Viewer=p.pureCompute(function(){return c.isSlideCurrent()&&!c.hasError()});c.loadingComponent=p.pureCompute(c._computeLoadingSpinner);c.loadingContainerStyle={bottom:d.default.getScrollbarWidth()+"px"};var m=p.create();c.scope.attach(v.loadResult.register(m));p.backgroundCompute(function(){var e=v.item();e&&e.thumbnail&&c.show360Viewer()&&c.trackPromise(c._loadImageUrl(e).then(function(){c.viewerIsLoaded(!0);m({resultType:h.ResultTypeEnum.Success});u.slide.loadState(3)},function(e){if(!r.default.isCanceled(e)){m(s.loadResultFromError(e));c.slide.loadState(3);console.log("Error loading thumbnail URLs: ",e);c.hasError(!0)}}))});c.viewer360={componentPath:"BEe",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["BEe"],t,n)}))},props:p.pureCompute(c._computeImage360ViewerProps)};return c}m.prototype._loadImageUrl=function(e){var t=this;return r.default.resolve().then(function(){var n=t._graphDataSource,r=n.getAuthenticationParams(e).then(function(t){var r=n.getItemUrl(e,{useDirectEndpoint:!0}),i="/content?"+l.serializeQuery(t);return{lowResUrl:r+"/thumbnails/0/c1000x500"+i,highResUrl:r+"/thumbnails/0/c2000x1000"+i,fullResUrl:""+r+i}}),i=new c.default;r.then(function(e){if(e){t.thumbnails(e);i.complete()}else i.error(new v.ApiError({code:"InvalidData",message:"Missing image URL"}))},function(e){i.error(e)});return i.getPromise()})};m.prototype._computeImage360ViewerProps=function(){var e,t,n=this,r=this.slide.item();r&&r.image360&&r.image360.posePitchDegrees&&(e=parseInt(r.image360.posePitchDegrees,10));r&&r.image360&&r.image360.poseRollDegrees&&(t=parseInt(r.image360.poseRollDegrees,10));return{thumbnails:this.thumbnails(),loadedObservable:function(){n.imgIsLoaded(!0)},pitch:e,roll:t}};m.prototype._computeLoadingSpinner=function(){return{name:p.default.tagName,params:{loadingText:this.slide.item().displayName}}};m.dependencies=n.__assign(n.__assign({},s.default.dependencies),{graphDataSource:u.graph});return m})(s.default);t.default=m});
define("cCe",["require","exports","mCe","lCe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-pdf",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("mCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:hasError--\x3e\x3c!--ko control:fallbackComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:hasError--\x3e<div class="OneUp-pdf" data-bind="css:{\'OneUp-pdf--loaded\':hasPdfLoaded()&&isSlideCurrent()}">\x3c!--ko if:loadPdf--\x3e<div class="od-OneUpPdf-content" data-bind="control:pdfViewerComponent"></div>\x3c!--/ko--\x3e<div class="od-OneUpPdf-thumbnail" data-bind="control:thumbnailComponent"></div>\x3c!--ko if:!hasPdfLoaded()&&isPdfViewerEnabled--\x3e<div class="OneUp-pdf-loadingContainer" data-bind="style:loadingContainerStyle"><div class="OneUp-pdf-loading"><span class="ms-font-s OneUp-pdf-loadingSpinner" data-bind="component:spinnerComponent"></span></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("lCe",["require","exports","lC","jH","Fe","mv","E","u9","lj","wIe","pCe","QH","$Ie","NIe","UJ","bz","yh","u3","jIe","fCe","uCe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:a.default});var i=r,s=i.observables,o=i.resources;o.expose(b.controlPanelProvider,n.toolbarProvider);r._mruRecentProvider=o.consumeAsync(g.mruRecent.optional);var u=n.platformDetection;r._isMobile=u.isMobile;r.isPdfViewerEnabled=c.isFeatureEnabled(c.UseWebPdfViewer);r.hasPdfLoaded=s.create(!1);var f=r._result=s.create();r.hasError=s.pureCompute(r._computeHasError);r._totalPages=s.create(0);r._pagesViewed=s.create(0);r.scope.attach(t.slide.loadResult.register(f));r._statsEventData={hasError:!1,fileSize:r.slide.item&&r.slide.item.peek()&&r.slide.item.peek().size,fileType:"pdf",pagesViewed:r._pagesViewed.peek(),totalPages:r._totalPages.peek(),timeToThumbnail:0,timeToDocumentLoaded:0};r.loadingContainerStyle={bottom:v.default.getScrollbarWidth()+"px"};var l={deferEvaluation:!0};r.isSlideCurrent=s.pureCompute(r._computeIsSlideCurrent,l).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});s.backgroundCompute(r._computeIsFirstSlideOpened);r.loadPdf=s.pureCompute(function(){return r.isSlideCurrent()},l);r._viewTimeoutId=0;r._hasViewed=s.create(!1);s.backgroundCompute(r._computeUpdateIsLoaded);s.backgroundCompute(r._computeUpdateStatsOnThumbnailLoad);s.backgroundCompute(r._computeUpdateStatsOnError);s.backgroundCompute(r._computeEnsureCommandBarVisible);s.backgroundCompute(r._computeHasViewed);s.backgroundCompute(r._computeRecordView);r.isPdfViewerEnabled&&(r._pdfParams=r._getPdfParams(n));r._initializeComponents();return r}t.prototype.dispose=function(){if(this._viewStartTime&&this.isPdfViewerEnabled){this._statsEventData.pagesViewed=this._pagesViewed.peek();this._statsEventData.totalPages=this._totalPages.peek();this._statsEvent.end(this._statsEventData)}};t.prototype._getPdfParams=function(e){var t=this.slide.item.peek(),n=t.pdfConversion,r=e.graphDataSource;return n?n.url?i.default.resolve(n.url):r.getAuthenticationParams(t).then(function(e){return r.getItemUrl(t,{useDirectEndpoint:!0})+"/content?format=pdf&"+u.serializeQuery(e)}):r.getDownloadUrl(t,{useDirectEndpoint:!0})};t.prototype._initializeComponents=function(){var e=this.observables,t=this.slide,i=n.__assign(n.__assign({},t),{loadState:e.compute({read:function(){return t.loadState()},write:function(e){e>t.loadState.peek()&&t.loadState(1)}}),loadResult:e.createCallback(r.forSingleValue())});this.fallbackComponent=a.toSpecification(h.default,{slide:i,oneUp:this.oneUp});this.thumbnailComponent=a.toSpecification(p.default,{allowError:!1,slide:i,oneUp:this.oneUp,isPreview:!0});this.spinnerComponent=e.pureCompute(this._computeSpinnerComponent);var s=t.renderOptions||{},o=s.autofocus,u=void 0===o||o,f=s.page,c=s.showNewWindow,d=s.zoom,v=(!this.oneUp||!this.oneUp.isInfoPaneExpanded())&&u,m=c?e.pureCompute(function(){var e=t.item(),n=e.extension,r=e.openUrl;return n&&".pdf"===n.toLowerCase()&&r||""}):void 0,g={autofocus:v,item:t.item,pdfParams:this._pdfParams,newWindowUrl:m,isLoaded:this.hasPdfLoaded,result:this._result,size:this.oneUp.size,hasHorizontalScrollbar:t.hasHorizontalScrollbar,hasVerticalScrollbar:t.hasVerticalScrollbar,isIdleEnabled:t.isIdleEnabled,isPanningEnabled:t.isPanningEnabled,initialPage:f,initialZoom:d,totalPages:this._totalPages,pagesViewed:this._pagesViewed};this.pdfViewerComponent=a.toSpecification(l.resourceKey.bypass,g)};t.prototype._computeSpinnerComponent=function(){var e={loadingText:this.slide.item().displayName};return{name:d.default.tagName,params:e}};t.prototype._computeIsSlideCurrent=function(){var e=!this.slide.offset();if(e){this._viewStartTime=Date.now();this._statsEvent=new w.OneUpDocumentStats}return e};t.prototype._computeEnsureCommandBarVisible=function(){!this.isSlideCurrent()||this.slide.isPanningEnabled()||this.oneUp.isCommandBarVisible()||this.oneUp.isCommandBarVisible(!0)};t.prototype._computeIsFirstSlideOpened=function(){var e=this.hasPdfLoaded();if(this.isSlideCurrent()&&(this.slide.isFirstSlideOpened()||this.oneUp.enableSlideControls.peek())){e&&this.oneUp.enableSlideControls(!0);this._isMobile;e&&this.slide.isPanningEnabled(!1)}};t.prototype._computeUpdateIsLoaded=function(){var e=this.hasPdfLoaded(),t=this._result();(t&&t.resultType)!==o.ResultTypeEnum.Success||this._statsEventData.timeToDocumentLoaded||(this._statsEventData.timeToDocumentLoaded=Date.now()-this._viewStartTime);var n=this.slide.loadState;t?n(3):e&&n.peek()<1&&n(1)};t.prototype._computeUpdateStatsOnThumbnailLoad=function(){this.slide.loadState()&&!this._statsEventData.timeToThumbnail&&this._viewStartTime&&(this._statsEventData.timeToThumbnail=Date.now()-this._viewStartTime)};t.prototype._computeHasError=function(){var e=this._result(),t=e&&e.resultType;return t===o.ResultTypeEnum.Failure||t===o.ResultTypeEnum.ExpectedFailure};t.prototype._computeUpdateStatsOnError=function(){this._statsEventData.hasError=this.hasError()};t.prototype._computeRecordView=function(){var e=this;this._hasViewed.peek()?this._mruRecentProvider.then(function(t){t&&t.recordDocumentView(e.slide.item.peek())}):this._hasViewed()};t.prototype._computeHasViewed=function(){var e=this,t=this.isSlideCurrent(),n=this.slide.loadState()>=3;if(t&&n)this._viewTimeoutId||(this._viewTimeoutId=this.async.setTimeout(function(){return e._hasViewed(!0)},4e3));else if(this._viewTimeoutId){this.async.clearTimeout(this._viewTimeoutId);this._viewTimeoutId=0}};t.dependencies=n.__assign(n.__assign({},y.default.dependencies),{graphDataSource:m.graph,platformDetection:s.platformDetection,toolbarProvider:f.resourceKey});return t})(y.default);t.default=E});
define("pCe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["eAe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("fCe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.current=new n.ResourceKey("pdfviewer.current");t.controlPanelProvider=new n.ResourceKey("pdfviewer.controlPanelProvider")});
define("uCe",["require","exports","$"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OneUpDocumentStats=n.createPairedEvent({eventName:"OneUpDocumentStats,",shortEventName:"OneUpDocumentStats"},{fileType:1,fileSize:2,hasError:3,pagesViewed:2,totalPages:2,timeToThumbnail:2,timeToDocumentLoaded:2});t.default=t.OneUpDocumentStats});
define("_Ce",["require","exports","ECe","bCe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-textFile",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("ECe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-OneUpTextFile" data-bind="css:{\'od-OneUpTextFile-thumbnail--load\':loadThumbnail,\'od-OneUpTextFile--compact\':isCompact,\'od-OneUpTextFile--loaded\':loadTextEditor()&&hasTextEditorLoaded()&&hasTextEditorDataLoaded()}">\x3c!--ko if:loadTextEditorFailed()--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!loadTextEditorFailed()--\x3e\x3c!--ko if:loadTextEditor()--\x3e<div class="od-OneUpTextFile-content"><div class="od-OneUpTextFile-title" data-bind="text:editorTitle"></div><div class="od-OneUpTextFile-editor od-TextFileEditor-content" data-bind="control:contentControl"></div></div>\x3c!--/ko--\x3e<div class="od-OneUpTextFile-loading" data-bind="component:{name:loadingSpinnerTagName,params:{}}"></div><div class="od-OneUpTextFile-thumbnail" data-bind="control:thumbnailControl"></div>\x3c!--/ko--\x3e</div>'});
define("bCe",["require","exports","lC","jH","E","lj","wCe","NIe","$Ie","jIe","SCe","BZ","sxe","vCe","yh","bz","_D","Fe","gCe","QH"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t,i){var f=e.call(this,t,i)||this;f.addBindingHandlers({control:s.default});f._encodingProvider=i.encodingProvider;var h=t.slide,p=f.observables,d=r.forSingleValue();f.thumbnailControl=s.toSpecification(u.default,n.__assign(n.__assign({},t),{slide:n.__assign(n.__assign({},h),{loadState:p.compute({read:function(){return h.loadState()},write:function(e){e>=1&&e>h.loadState.peek()&&h.loadState(1)}}),loadResult:p.createCallback(d)}),allowError:!1,isPreview:!0}));f.fallbackControl=s.toSpecification(a.default,n.__assign(n.__assign({},t),{slide:n.__assign(n.__assign({},h),{loadResult:p.createCallback(d)})}));f.loadingSpinnerTagName=c.default.tagName;f._isSlideCurrent=p.pureCompute(f._computeIsSlideCurrent).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var m=f._loadResult=p.create();f.scope.attach(h.loadResult.register(m));f.loadThumbnail=p.create(!1);f.async.setTimeout(function(){f.loadThumbnail(!0)},200);f.loadTextEditor=f._isSlideCurrent;f.loadTextEditorFailed=p.create(!1);f.hasTextEditorLoaded=p.create(!1);var g=f.hasTextEditorDataLoaded=p.create(!1),y=f._editorState=p.create(o.EditorState.shouldLoad),b=f._isEditorFocused=p.create(!1);f._isFirstSlideOpened=p.pureCompute(f._computeIsFirstSlideOpened);f.editorTitle=p.pureCompute(f._computeEditorTitle);var w=f._itemContent=p.create(),E=i.responsiveUI,S=i.embedMessenger;f._messenger=S;var x=f.oneUp.size,T=f.isCompact=p.pureCompute(function(){var e=x()&&x().width||0;return E.compareSize(v.default.determineWindowSize(e),"Large")<=0});f.contentControl=s.toSpecification(l.default,{content:w,editorState:y,isCompact:T,isDataLoaded:g,isEditorFocused:b,onFocusKeySequence:f.editorFocusKeySequenceCallback.bind(f)});f.slide.loadState(1);p.backgroundCompute(f._computeOnEditorStateChange);p.backgroundCompute(f._computeIsPanningEnabled);p.backgroundCompute(f._computeUpdateContent);return f}t.prototype._computeUpdateContent=function(){var e=this,t=this.slide.item(),n=m.getMimeTypeForExtension(t.extension),r=this.resources.consumeAsync(d.download).then(function(e){return e.getItemContents(t)});return this.trackPromise(r).then(function(t){if(t){var r=e._encodingProvider.getEncoding();return h.fullParse(t,n,r)}}).then(function(t){e._itemContent(t)}).catch(function(t){if(g.default.isCanceled(t))e._loadResult({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled",error:"Canceled"});else{e._loadResult({resultType:i.ResultTypeEnum.Failure,resultCode:t.code||"ReadFile",error:t&&t.message||""+t});e.slide.loadState(3)}e.loadTextEditorFailed(!0)})};t.prototype._computeEditorTitle=function(){var e=this.slide.item();return e.displayName||e.name};t.prototype._computeIsSlideCurrent=function(){return!this.slide.offset()};t.prototype._computeIsFirstSlideOpened=function(){var e=this.hasTextEditorLoaded();return!this._isSlideCurrent()||this.slide.isFirstSlideOpened()||!e};t.prototype._computeOnEditorStateChange=function(){switch(this._editorState()){case o.EditorState.loaded:this.hasTextEditorLoaded(!0);this._loadResult({resultType:i.ResultTypeEnum.Success});this.slide.loadState(3);break;case o.EditorState.error:this._loadResult({resultType:i.ResultTypeEnum.Failure,resultCode:"MonacoError"});this.loadTextEditorFailed(!0);this.slide.loadState(3)}};t.prototype._computeIsPanningEnabled=function(){var e=this._isEditorFocused(),t=this._isFirstSlideOpened();this.slide.isPanningEnabled(!t&&!e)};t.prototype.editorFocusKeySequenceCallback=function(){this._messenger&&b.isFeatureEnabled(b.EnableOneUpNotifyHostAccessibilityKeySequence)&&this._messenger.sendNotification({notification:"focusKeyInput"})};t.dependencies=n.__assign(n.__assign({},f.default.dependencies),{encodingProvider:p.resourceKey,responsiveUI:v.resourceKey,embedMessenger:y.messenger.optional});return t})(f.default);t.default=w});
define("wCe",["require","exports","e","t3","Fe","Oh","pv","Ate"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,f,l=new s.default,c=new o.default(window);(function(e){e[e.shouldLoad=0]="shouldLoad";e[e.loading=1]="loading";e[e.loaded=2]="loaded";e[e.error=3]="error"})(f=t.EditorState||(t.EditorState={}));t.initializeEnvironment=function(e){if(a)e&&e(f.loaded);else{e&&e(f.loading);u.default.addConfig({paths:{vs:"monaco-editor/vs"}});a=r.loadModule({path:"vs/editor/editor.main",getModule:function(){return new i.default(function(e,t){window.require(["vs/editor/editor.main"],e,t)})}}).then(function(){e&&e(f.loaded);var t=monaco.languages.typescript;t.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!1});t.javascriptDefaults.setCompilerOptions({target:t.ScriptTarget.Latest,allowNonTsExtensions:!0})},function(t){e&&e(f.error);a=void 0;return i.default.wrapError(t)})}return a};t.addDispose=function(e,t){n.utils.domNodeDisposal.addDisposeCallback(e,function(){try{t&&t()}catch(e){}})};t.watchForResize=function(e,t){var r=l.throttle(function(){t.layout()},500);c.on(window,"resize",r);n.utils.domNodeDisposal.addDisposeCallback(e,function(){c.off(window,"resize",r)})}});
define("SCe",["require","exports","OCe","ICe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"ms-text-viewer",template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("OCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="TextViewer-frame" data-bind="attr:{tabindex:editorFocused()?0:-1},monaco:monacoOptions,keyboard:keyboardOptions,hasFocus:setEditorFocused"></div>'});
define("ICe",["require","exports","lC","JB","mv","xCe","dG","yh"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({keyboard:o.default,monaco:s.default});var i=r.observables;r._editorLoaded=!1;var u=window.require.toUrl(""),a=n.workerDataSource.getWorkerUrl(u+"monaco-worker.js")+"#"+u+"monaco-editor/";window.MonacoEnvironment={baseUrl:window.require.toUrl("")+"monaco-editor",getWorkerUrl:function(){return a}};var f=r._editor=i.create();r.editorFocused=t.isEditorFocused||i.create(!1);var l=t.editorState;r._content=t.content;r.keyboardOptions=[{mappings:{Esc:function(){r.editorFocused(!0);return!0}}}];r._isDataLoaded=i.pureCompute(r._computeDataLoaded);t.isDataLoaded&&i.backgroundCompute(function(){return t.isDataLoaded(r._isDataLoaded())});i.compute(r._computeResize);i.compute(r._computeContent);var c=n.platformDetection;r.monacoOptions={editor:f,editorState:l,isCompact:t.isCompact,isMobile:c.isMobile,readOnly:!0,focusKeybindingCallback:t.onFocusKeySequence};return r}t.prototype.setEditorFocused=function(e){this.editorFocused(e)};t.prototype._computeResize=function(){if(this._isDataLoaded()){var e=this._editor();e&&this.async.setTimeout(function(){e.layout()},0)}};t.prototype._loadEditor=function(e){var t=this;this._editorLoaded=!0;e.onDidFocusEditorWidget(function(){t.editorFocused(!0)});e.onDidBlurEditorWidget(function(){t.editorFocused(!1)})};t.prototype._computeContent=function(){var e=this._editor();if(e){this._editorLoaded||this._loadEditor(e);var t=this._content();if(t&&t.mimeType){var n=e.getModel(),r=this._previousContent;if(n&&r&&r.mimeType===t.mimeType){n.getValue()!==t.text&&n.setValue(t.text)}else{var i=monaco.editor.createModel(t.text,t.mimeType);e.setModel(i);this._disposeModel(n)}this._previousContent=t}}};t.prototype._computeDataLoaded=function(){return!!this._content()};t.prototype._disposeModel=function(e){e&&!e.isDisposed()&&e.dispose()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{platformDetection:i.platformDetection,workerDataSource:u.worker});return t})(r.default);t.default=a});
define("xCe",["require","exports","lC","ZB","wCe","CCe","Y0"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var r,u,a=e.call(this,t)||this,f=a.valueAccessor(),l=a.element,c=!!f.readOnly,h=function(){var e=l.querySelector("textarea");e.readOnly!==c&&(e.readOnly=c)},p=a.observables,d={readOnly:c,scrollBeyondLastLine:!1,wordWrap:"on"},v={contextmenu:!f.isMobile},m=p.pureCompute(function(){var e=p.unwrap(f.isCompact);return{lineNumbersMinChars:e?3:5,minimap:{enabled:!e}}});p.backgroundCompute(function(){var e=f.editor();if(e){var t=m();e.updateOptions(t);e.layout()}});var g=function(e){e?monaco.editor.setTheme("vs-dark"):o.isOneDriveWinApp()&&monaco.editor.setTheme("vs")},y=a.resources.consume(s.resourceKey),b=y.isDarkMode.subscribe(function(e){g(e)}),w=i.initializeEnvironment(f.editorState).then(function(){g(y.isDarkMode());r=monaco.editor.create(l,n.__assign(n.__assign(n.__assign({},d),v),m.peek()));i.watchForResize(l,r);r.onKeyDown(function(e){e.ctrlKey&&e.keyCode===monaco.KeyCode.F6&&f.focusKeybindingCallback&&f.focusKeybindingCallback()});u=new MutationObserver(h);h();u.observe(l,{childList:!0,subtree:!0});f.editor(r)},function(e){});i.addDispose(l,function(){w.cancel();b.dispose();u&&u.disconnect();if(r){var e=r.getModel();r.setModel(null);e&&e.dispose();r.dispose();r=null}});return a}return t})(r.default);t.default=u});
define("CCe",["require","exports","lC","X_","BH","ta","l3","Y0"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;try{r.isDarkMode=r.observables.create("true"===window.localStorage.getItem("isDarkMode"))}catch(e){r.isDarkMode=r.observables.create(!1)}var i=function(e){e?s.loadTheme({palette:o.themeDarkMode,isInverted:!0}):u.isOneDriveWinApp()&&s.loadTheme({palette:o.themeOffice,isInverted:!0})};i(r.isDarkMode.peek());r.isDarkMode.subscribe(function(e){window.localStorage.setItem("isDarkMode",e.toString());i(e)});return r}t.dependencies=n.__assign({},i.default.dependencies);return t})(i.default);t.default=a;t.resourceKey=r.createResolvedResourceKey(e("module").id,a)});
define("vCe",["require","exports","X_","yh","yCe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._encodingDataSource=t.encodingDataSource;this._languageDataSource=t.languageDataSource}e.prototype.getEncoding=function(){var e=this._encodingDataSource.getEncoding();if(!e){var t=this._languageDataSource.getCurrentLanguageCode().toLowerCase();e=i.encodingMap[t]}e||(e=i.defaultEncoding);return e};return e})();t.default=s;t.resourceKey=n.createResolvedResourceKey(e("module").id,s,{languageDataSource:r.language,encodingDataSource:r.encoding})});
define("yCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultEncoding="windows-1252";t.encodingMap={ar:"windows-1256","ar-sa":"windows-1256","az-latn-az":"windows-1254",be:"windows-1251","be-by":"windows-1251",bg:"windows-1251","bg-bg":"windows-1251","bs-latn-ba":"windows-1250",cs:"windows-1250","cs-cz":"windows-1250",el:"windows-1253","el-gr":"windows-1253",et:"windows-1257","et-ee":"windows-1257",fa:"windows-1256","fa-ir":"windows-1256",he:"windows-1255","he-il":"windows-1255",hr:"windows-1250","hr-hr":"windows-1250",hu:"windows-1250","hu-hu":"windows-1250",ja:"Shift_JIS","ja-ja":"Shift_JIS","ja-jp":"Shift_JIS","ku-arab":"windows-1256","ku-arab-iq":"windows-1256",ky:"windows-1251","ky-kg":"windows-1251",lt:"windows-1257","lt-lt":"windows-1257",lv:"windows-1257","lv-lv":"windows-1257",mk:"windows-1251","mk-mk":"windows-1251",mn:"windows-1251","mn-mn":"windows-1251","pa-arab":"windows-1256","pa-arab-pk":"windows-1256",pl:"windows-1250","pl-pl":"windows-1250","prs-af":"windows-1256",ro:"windows-1250","ro-ro":"windows-1250",ru:"windows-1251","ru-ru":"windows-1251","sd-arab":"windows-1256","sd-arab-pk":"windows-1256",sk:"windows-1250","sk-sk":"windows-1250",sl:"windows-1250","sl-si":"windows-1250",sq:"windows-1250","sq-al":"windows-1250","sr-cyrl-ba":"windows-1251","sr-cyrl-cs":"windows-1251","sr-cyrl-rs":"windows-1251","sr-latn":"windows-1250","sr-latn-rs":"windows-1250","tg-cyrl":"windows-1251","tg-cyrl-tj":"windows-1251",th:"windows-874","th-th":"windows-874","tk-tm":"windows-1250",tr:"windows-1254","tr-tr":"windows-1254",tt:"windows-1251","tt-ru":"windows-1251","ug-cn":"windows-1256",uk:"windows-1251","uk-ua":"windows-1251",ur:"windows-1256","ur-pk":"windows-1256","uz-latn-uz":"windows-1254",vi:"windows-1258","vi-vn":"windows-1258"}});
define("gCe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.messenger=new n.ResourceKey("messenger");t.commandHandler=new n.ResourceKey("commandHandler");t.viewerContext=new n.ResourceKey("viewerContext")});
define("ACe",["require","exports","PCe","kCe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-wac",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("PCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko iframe:iframeOptions--\x3e\x3c!--/ko--\x3e"});
define("kCe",["require","exports","lC","E","Y$","MCe","jIe","yh"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,s){var o=e.call(this,t,s)||this;o.addBindingHandlers({iframe:i.default});var u=o.slide,a=o.observables,f=a.create();o.scope.attach(u.loadResult.register(f));var l={className:"OneUp-wac-frame",onLoad:function(){f({resultType:r.ResultTypeEnum.Success,resultCode:"WAC"});u.loadState(3)}},c=s.location,h=void 0===c?window.location:c,p=s.wopiFrameDataSource,d=s.wopiToken,v=h.protocol+"//"+h.host,m=a.pureCompute(function(){var e=d&&d(),t=u.item();if(t&&""!==e){var r=p.getWopiFrameUrl(t,e);if(r){if(e){return n.__assign(n.__assign({},l),{type:"post",url:r,postdata:{access_token:e,EmbeddingPageOrigin:v}})}return n.__assign(n.__assign({},l),{type:"get",url:r})}}}),g=a.pureCompute(function(){return!u.offset()},{deferEvaluation:!0}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});o.iframeOptions=a.pureCompute(function(){return g()?m():void 0});return o}t.dependencies=n.__assign(n.__assign({},o.default.dependencies),{wopiFrameDataSource:u.wopiFrame,wopiToken:s.resourceKey.optional});return t})(o.default);t.default=a});
define("MCe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("wopiToken")});
define("TCe",["require","exports","KCe","BCe","lj","SPListOneUp_IS_mini_css","UCe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-wrs",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("KCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showError--\x3e\x3c!--ko control:fallbackComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:showError--\x3e<div class="OneUp-wrs">\x3c!--ko if:showWrsViewer--\x3e\x3c!--ko control:contentControl--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isSlideCurrent()&&toolbarComponent()&&hasDocumentLoaded()&&!contentRefreshing()--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:{provider:toolbarProvider}}--\x3e<div class="OneUp-toolbarHost" data-bind="control:toolbarComponent" role="presentation"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isSlideCurrent()&&contentRefreshing()--\x3e<div class="OneUp-wrs-loadingContainer" data-bind="style:loadingContainerStyle"><div class="OneUp-wrs-loading"><span class="ms-font-s OneUp-wrs-loadingSpinner" data-bind="component:loadingComponent"></span></div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isMobileOfficeAppUpsellVisible--\x3e<div data-bind="react:mobileOfficeAppUpsell"></div>\x3c!--/ko--\x3e</div>\x3c!--ko control:wrsIntroComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("BCe",["require","exports","lC","de","Fe","XA","Iv","Dv","mv","jH","E","Lh","QH","px","lj","hj","vK","$Ie","GG","wIe","bz","UJ","u3","b5e","GCe","zCe","jIe","lee","Cz","vh","gK","uCe","jz","LIe","VCe","jCe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H){"use strict";var B;Object.defineProperty(t,"__esModule",{value:!0});var j=((B={})[k.excelType]="ODBExcelAppUpsell",B[k.wordType]="ODBWordAppUpsell",B[k.powerpointType]="ODBPowerPointAppUpsell",B),F=(function(t){n.__extends(B,t);function B(s,a){var c=t.call(this,s,a)||this;c.transclusionContentTagName=_.default.tagName;c.addBindingHandlers({control:d.default,react:v.default});var h=c.observables,p=a.responsiveUI,m=s.slide,y=a.platformDetection;c._wrsHelper=a.wrsHelper;var b=y.isAndroid,E=y.isMobile;c._isMobile=E&&!y.isIPad;c._isMobileOfficeAppUpsellDevice=E&&(b||y.isIOS);var S=b?"Android":"IOS";c._dataStore=new o.default("",u.default.local);c._enableLogging=window.log||window.DEBUG;var x=c._dataStore.getValue("OfficeDocClickTime",u.default.session),T=c._docClickTime=x?new Date(x):void 0;c._dataStore.setValue("OfficeDocClickTime","",u.default.session);var N=m.item&&m.item.peek(),C=N&&N.appMap,k=m.renderOptions;c._isFastOneUp=!x||!!k;if(T){if(Date.now()-T.getTime()>0){new l.Qos({name:"Wrs.DocClickedToWrsViewer",startTimeOverride:T.getTime()}).end({resultType:l.ResultTypeEnum.Success,extraData:{isFastOneUp:c._isFastOneUp}})}}c._mobileOfficeAppUpsellType=C?j[C]:void 0;c._mobileOfficeAppUpsellDismissed=a.mobileOfficeAppUpsellDismissedThisSession||h.create(!0);c.loadingContainerStyle={bottom:w.default.getScrollbarWidth()+"px"};c.toolbarProvider=a.toolbarProvider;c._engagement=a.engagement;c._accessibilityMode=a.accessibilityMode;c._userInfoProvider=a.userInfoProvider;var L=c._loadResult=h.create();c.scope.attach(m.loadResult.register(L));m.hasHorizontalScrollbar(!0);c.wrsIntroComponent=h.create(void 0);c.contentRefreshing=h.create(!1);c.hasDocumentLoaded=h.create(!1);c.showError=h.create(!1);c._sessionId=a.correlationId||r.default.generate();c._totalPages=h.create(0);c._pagesViewed=h.create(0);c._application=h.create();c.toolbarComponent=h.create();var A=n.__assign(n.__assign({},s),{slide:n.__assign(n.__assign({},m),{loadResult:h.createCallback(f.forSingleValue())})});c.fallbackComponent=d.toSpecification(g.default,A);m.loadState(1);var O=c.isSlideCurrent=h.pureCompute(function(){return!m.offset()},{deferEvaluation:!0}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});c.showWrsViewer=h.pureCompute(function(){return!c.showError()&&O()});c._newWindowUrl=k&&k.showNewWindow?h.pureCompute(function(){return(m.item().openUrl||"").replace("&mobileredirect=true","&mobileredirect=false").replace(/action=([^&]+)/,"action=default")}):void 0;c.loadingComponent=h.pureCompute(c._computeLoadingSpinner);c.contentControl=h.pureCompute(c._computeContentComponent);h.backgroundCompute(c._computeSetupFallbackTimer);h.backgroundCompute(c._computeHasError);h.backgroundCompute(c._computeIsFirstSlideOpened);h.backgroundCompute(c._computeGenerateBundleIfNeeded);h.backgroundCompute(c._watchForApplicationLoad);h.backgroundCompute(c._registerAppEvents);c._navigation=a.navigation;c.mobileOfficeAppUpsell={componentPath:"lz",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["lz"],t,n)}))},props:{upsellPresentationType:p.compareSize(p.formFactorSize(),"Small")>0?"Dialog":"Banner",upsellType:c._mobileOfficeAppUpsellType,upsellDeviceType:S,onClose:c._onDismissMobileWebToAppUpsellV2.bind(c),onGetAppClick:c._onMobileWebToAppUpsellGetAppClick.bind(c)}};c.isMobileOfficeAppUpsellVisible=h.pureCompute(c._computeIsOfficeUpsellVisible);c.scope.attach({dispose:function(){c._finishEvent()}});return c}B.prototype._finishEvent=function(){if(this._viewStartTime&&this._statsEventData.timeToDocumentLoaded){this._statsEventData.pagesViewed=this._pagesViewed.peek();this._statsEventData.totalPages=this._totalPages.peek();this._statsEvent.end(this._statsEventData)}};B.prototype._createNewSession=function(){this._viewStartTime=null;this._pagesViewed(0);this.toolbarComponent(null);this.hasDocumentLoaded(!1);this.showError(!1);this.contentRefreshing(!1);this._statsEvent&&this._statsEventData&&this._finishEvent();this._statsEvent=new M.OneUpDocumentStats;var e=this.slide.item&&this.slide.item.peek();this._statsEventData={hasError:!1,fileSize:e&&e.size,fileType:e&&e.extension&&e.extension.toLowerCase().substring(1),pagesViewed:0,totalPages:0,timeToThumbnail:0,timeToDocumentLoaded:0}};B.prototype._isExpectedError=function(e){return"0.5341338.13"===e||"0.5341264.13"===e||"0.5341262.13"===e||"0.5341187.13"===e||"0.5341188.13"===e||"0"===e||!window.navigator.onLine};B.prototype._computeContentComponent=function(){var e=this;this._createNewSession();var t=this.slide.item&&this.slide.item.peek(),n=!!(t&&t.appMap===k.wordType)&&this._accessibilityMode(),r={sessionId:this._sessionId,application:this._application,isSlideCurrent:this.isSlideCurrent,accessibilityMode:n,slide:this.slide,isFastOneUp:this._isFastOneUp,documentClickTime:this._docClickTime,onLoadStart:function(){e._viewStartTime=(new Date).getTime()},onLoadFailure:function(t){e._wrsTimerId&&e.async.clearTimeout(e._wrsTimerId);var n=t&&(t.code||t.name)||"Unknown",r=e._isExpectedError(n);e._loadResult({resultType:r?l.ResultTypeEnum.ExpectedFailure:l.ResultTypeEnum.Failure,resultCode:n,error:t&&t.message});e.showError(!0);e._regenerateOfficeBundle()},onRegenerateOfficeBundle:function(){e._regenerateOfficeBundle()}};return d.toSpecification(P.resourceKey.bypass,r)};B.prototype._watchForApplicationLoad=function(){var e=this._application();if(e){this._statsEventData.timeToDocumentLoaded=(new Date).getTime()-this._viewStartTime;if(!e.GetIsDisabled||e.GetIsDisabled()){this._regenerateOfficeBundle();this._loadResult({resultType:l.ResultTypeEnum.Success,resultCode:"WACFallback"})}else{var t=(this.slide.item&&this.slide.item.peek()).appMap===k.wordType?N.resourceKey:T.resourceKey;this.toolbarComponent(d.toSpecification(t,{app:e,slide:this.slide,pagesViewed:this._pagesViewed,totalPages:this._totalPages,showError:this.showError,newWindowUrl:this._newWindowUrl}));this._loadResult({resultType:l.ResultTypeEnum.Success,resultCode:"WRS"})}this.slide.loadState(3);this._wrsTimerId&&this.async.clearTimeout(this._wrsTimerId);this._statsEventData.timeToDocumentLoaded=(new Date).getTime()-this._viewStartTime;this.hasDocumentLoaded(!0);this._showFreDialog()}};B.prototype._showFreDialog=function(){var e=this;if(!this._isMobile){var t=this._userInfoProvider;if(t&&t.canPersistUserInfo){var n=this._dataStore.getValue("microsoft.odsp.wrs.used");t.getUpsellDismissedById(y.default.WrsIntroduction).then(function(r){if(n&&!r)t.markUpsellAsDismissed(y.default.WrsIntroduction);else if(!r){var i=e.slide.item.peek().appMap,s=i===k.wordType,o=i===k.powerpointType;(s||o)&&e.wrsIntroComponent(d.toSpecification(H.resourceKey,{isWord:s,onClose:function(){t.markUpsellAsDismissed(y.default.WrsIntroduction);e.wrsIntroComponent(void 0)}}))}})}}};B.prototype._onDismissMobileWebToAppUpsellV2=function(){this._mobileOfficeAppUpsellDismissed(!0)};B.prototype._onMobileWebToAppUpsellGetAppClick=function(e){this._onDismissMobileWebToAppUpsellV2();this._navigation.navigateTo(e)};B.prototype._computeSetupFallbackTimer=function(){var e=this,t=this.slide.item&&this.slide.item();if(this.isSlideCurrent()&&!this.hasDocumentLoaded()&&this.showWrsViewer()&&!this._timerStarted){this._enableLogging&&console.log("WRS: starting watchdog timer");this._timerStarted=!0;this._wrsTimerId=this.async.setTimeout(function(){var n=e._wrsHelper.getAppName(t);e._engagement.logData({name:"Wrs."+n+".TimeoutWithoutAnyCallback",extraData:{extension:t.extension,isFastOneUp:e._isFastOneUp,sessionId:e._sessionId}});e._enableLogging&&console.log("WRS: initialize timeout")},15e3)}};B.prototype._computeGenerateBundleIfNeeded=function(){var e=this.slide.offset();Math.abs(e)<=2&&!this._hasBundle()&&this._regenerateOfficeBundle()};B.prototype._computeIsFirstSlideOpened=function(){};B.prototype._hasBundle=function(){var e=this.slide.item&&this.slide.item.peek();return this._wrsHelper.hasValidBundle(e)};B.prototype._computeHasError=function(){var e=this.showError();if(e){var t=(this.slide.item&&this.slide.item.peek()).extension.toLowerCase();this._engagement.logData({name:"Wrs.Error.ShowDegradedExperience",extraData:{extension:t,isFastOneUp:this._isFastOneUp,sessionId:this._sessionId}});this._enableLogging&&console.log("WRS: error show degraded experience");this._statsEventData.hasError=e;this._statsEventData.timeToDocumentLoaded=(new Date).getTime()-this._viewStartTime;this._statsEvent.end(this._statsEventData)}};B.prototype._regenerateOfficeBundle=function(){var e=this,t=this.slide.item.peek(),n=t.extension.toLowerCase();if(t.officeBundle&&t.officeBundle.officeBundleGenerateUrl&&!t.officeBundle.hasBundleGenerationFailed){this._enableLogging&&console.log("WRS: Calling Generate Office Bundle on item: "+t.name+" offset "+this.slide.offset.peek());var r=this._engagement,o=new l.Qos({name:"OfficeBundle.GenerateUrl"});s.default.start({url:t.officeBundle.officeBundleGenerateUrl.replace("{{minVersion}}","0")}).then(function(i){o.end({resultType:l.ResultTypeEnum.Success});r.logData({name:"OfficeBundle.GenerateUrl.Success",extraData:{extension:n,isFastOneUp:e._isFastOneUp,sessionId:e._sessionId}});var s=i.getResponseHeader("X-OfficeBundleVersion");if(!e.scope.isDisposed&&s){var u=s.split(" - ");if(u.length>=2){var a={bundleVersion:u[0],bundleCTag:u[1],generationTime:new Date},f=new(e.managed(O.default));f.update([new m.default(t.key).succeed({item:{key:t.key,officeBundle:a}})]);f.flush();f.dispose();e._enableLogging&&console.log("WRS: updated local item with generate office bundle info")}}},function(s){var u="";try{var a=JSON.parse(s.responseText);a&&a.innererror&&a.innererror.code?u=a.innererror.code:a&&a.code?u=a.code:a&&a.status&&(u=a.status);e._enableLogging&&console.log("WRS: office bundle generation failed for on item: "+t.name,a)}catch(e){}var f={resultType:l.ResultTypeEnum.Failure,error:s.responseText?s.responseText:"OfficeBundle.GenerateUrl.Failed",resultCode:u};r.logData({name:"OfficeBundle.GenerateUrl.Failed",extraData:{code:u,extension:n,isFastOneUp:e._isFastOneUp,sessionId:e._sessionId}});o.end(f);return i.default.wrapError(s)})}};B.prototype._computeLoadingSpinner=function(){return{name:E.default.tagName,params:{loadingText:this.slide.item().displayName}}};B.prototype._registerAppEvents=function(){var e=this._application();if(e)try{e.RegisterEventHandler("ContentRefreshBegin",this._onContentRefreshBeginEvent.bind(this));e.RegisterEventHandler("ContentRefreshEnd",this._onContentRefreshEndEvent.bind(this))}catch(e){}};B.prototype._onContentRefreshBeginEvent=function(e){this._enableLogging&&console.log("WRS: contentrefresh begin event triggered",e);var t=this.slide.item.peek(),n=this._wrsHelper.getAppName(t);this._engagement.logData({name:"Wrs."+n+".ContentRefreshBegin.Triggered",extraData:{reason:e.reason}});this.contentRefreshing(!0)};B.prototype._onContentRefreshEndEvent=function(e){this._enableLogging&&console.log("WRS: contentrefresh end event triggered",e);var t=this.slide.item.peek(),n=this._wrsHelper.getAppName(t),r=this._application.peek(),i=!r.GetIsDisabled||r.GetIsDisabled();this._engagement.logData({name:"Wrs."+n+".ContentRefreshEnd.Triggered",extraData:{success:e.succeeded,isAppDisabled:i}});if(i){this.toolbarComponent(null);this._enableLogging&&console.log("WRS: hiding toolbar")}this._regenerateOfficeBundle();this.contentRefreshing(!1)};B.prototype._computeIsOfficeUpsellVisible=function(){return!(!(this._application()&&h.isFeatureEnabled(h.EnableMobileWebOfficeAppUpsell)&&this._isMobileOfficeAppUpsellDevice&&this._mobileOfficeAppUpsellType&&this._navigation.viewParams&&this._navigation.viewParams.nav)||this._navigation.viewParams.action||this._mobileOfficeAppUpsellDismissed())};B.dependencies=n.__assign(n.__assign({},C.default.dependencies),{accessibilityMode:D.default,correlationId:L.resourceKey.optional,engagement:A.resourceKey,platformDetection:a.platformDetection,toolbarProvider:b.resourceKey,userInfoProvider:S.userInfo.optional,wrsHelper:x.resourceKey,responsiveUI:w.resourceKey,mobileOfficeAppUpsellDismissedThisSession:p.mobileOfficeAppUpsellDismissedThisSession.optional,navigation:c.navigation});return B})(C.default);t.default=F});
define("GCe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["qAe"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("zCe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["zAe"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("VCe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["UCe"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("jCe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["NAe"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("UCe",["require","exports","RCe","HCe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-wrs-content",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("RCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="OneUp-wrs-content"><div class="OneUp-wrs-app" data-bind="element:container"></div></div>'});
define("HCe",["require","exports","lC","Fe","JB","E","fG","vh","lee","b5e","yh","v"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t,r)||this;i.addBindingHandlers({element:o.default});i._slide=t.slide;i._isSlideCurrent=t.isSlideCurrent;i._docClickTime=t.documentClickTime;var s=i._slide.renderOptions,u=s&&s.qosEvent,a=u&&u.data.extraData||{};i._clientId=a.clientId;i._qosData=n.__assign(n.__assign({},a),{sessionId:t.sessionId,isFastOneUp:t.isFastOneUp});i._application=t.application;i._onLoadFailure=t.onLoadFailure;i._onRegenerateOfficeBundle=t.onRegenerateOfficeBundle;i._onLoadStart=t.onLoadStart;i._accessibilityMode=t.accessibilityMode;i._enableLogging=window.log||window.DEBUG;i._userId=i._getUserId();i._engagement=r.engagement;i._graphDataSource=r.graphDataSource;i._wrsHelper=r.wrsHelper;i.container=i.createObservable(null);i._slide.item&&i.createBackgroundComputed(i._computeInitialize);return i}t.prototype._getUserId=function(){var e=window._spPageContextInfo,t=e&&e.systemUserKey;return e&&t&&t.substring(t.lastIndexOf("|")+1).replace("@live.com","")||""};t.prototype._hasBundle=function(){var e=this._slide.item&&this._slide.item.peek();return this._wrsHelper.hasValidBundle(e)};t.prototype._initializeContent=function(e,t){var r=this._engagement,i=this._hasBundle(),s=t.extension.toLowerCase(),o=this._qosData;o.extension=s;var u=t.officeBundle&&t.officeBundle.hasBundleGenerationFailed,f=-1;if(t.dateModifiedValue)try{var l=new Date(t.dateModifiedValue);f=Math.ceil(((new Date).getTime()-l.getTime())/1e3)}catch(e){}r.logData({name:i?"Wrs.BundleAvailable":u?"Wrs.InitWithoutBundleGerationFailed":"Wrs.InitWithoutBundle",extraData:n.__assign(n.__assign({},o),{age:f})});!i&&this._enableLogging&&console.log("WRS: initialize without a bundle");t.appMap===a.wordType?this._initializeWord(e,t,o):t.appMap===a.powerpointType?this._initializePowerPoint(e,t,o):this._initializeJSAPI(e,t,o)};t.prototype._initializeWord=function(e,t,r){var i=this;this._handleLoad("Word",n.__assign(n.__assign({},this._getCommonParams(e,t)),{accessibilityMode:this._accessibilityMode,onSuccess:this._createSuccessHandler(t,this._onWordSuccess),onFailure:function(e){i._onJSAPIFailure(t,"Word",e)}}),t,r)};t.prototype._initializePowerPoint=function(e,t,r){var i=this,s=(this._slide.renderOptions||{}).page;this._handleLoad("PowerPoint",n.__assign(n.__assign({},this._getCommonParams(e,t)),{startPage:"number"==typeof s?s:1,onSuccess:this._createSuccessHandler(t,this._onPowerPointSuccess),onFailure:function(e){i._onPowerPointFailure(t,e)}}),t,r)};t.prototype._initializeJSAPI=function(e,t,r){var i=this,s=t.appMap,o=s===a.excelType?"Excel":s===a.visioType?"Visio":void 0;if(!o)throw"Unsupported extension "+t.extension+" in oneUpWrs";this._handleLoad(o,n.__assign(n.__assign({},this._getCommonParams(e,t)),{onSuccess:this._createSuccessHandler(t,this._onInitializeSuccess),onFailure:function(e){i._onJSAPIFailure(t,o,e)}}),t,r)};t.prototype._getCommonParams=function(e,t){var n=this._slide,r=n.renderOptions;return{autofocus:r&&r.autofocus,container:e,item:t,qosData:this._qosData,engagement:this._engagement,userId:this._userId,clientId:this._clientId,fileGetUrl:this._graphDataSource.getDownloadUrlSync(t,{useDirectEndpoint:!0}),docClickTime:n.isFirstSlideOpened.peek()?this._docClickTime:null,bundleUrl:this._hasBundle()?t.officeBundle.officeBundleGetFragmentUrl:void 0}};t.prototype._handleLoad=function(e,t,n,i){var o=this;this._wrsQosEvent=new s.Qos({name:"Wrs."+e+".DocumentLoad",extraData:i});var u=this._engagement;u.logData({name:"Wrs."+e+".Initialized",extraData:i});var a=this._wrsHelper.loadWrs(e,t),f=this._wrsHelper.retrieveWopiInfo(n);this.trackPromise(a.then(function(e){return f.then(function(t){o._enableLogging&&console.log("WRS: obtained WopiInfo",t);e.Complete(t);u.logData({name:"Wrs.WopiPendingApplication.Complete",extraData:o._qosData})},function(t){e.Fail(t);o._enableLogging&&console.log("WRS: error retrieving wopiinfo");u.logData({name:"Wrs.GetWopiProperties.Error",extraData:o._qosData})})},function(e){r.default.isCanceled(e)||o._onWrsFailure(n,e)}))};t.prototype._createSuccessHandler=function(e,t){var n=this;return function(r,i){if(n.isDisposed)p(r);else{n.scope.attach({dispose:function(){p(r)}});n._application(r);t.call(n,e,i,r)}}};t.prototype._onWordSuccess=function(e,t,n){if(n.GetIsDisabled()){this._enableLogging&&console.log("WRS: Word viewer self wac fallback");this._engagement.logData({name:"Wrs.Word.SelfWacFallback",extraData:this._qosData})}else{var r=this._slide.renderOptions||{},i=r.page,o=r.zoom;n.SetCurrentPage(Math.min(Math.max(i||1,1),n.GetPageCount()));var u=Number(o);u&&n.SetZoomLevel(u)}if(t&&t.perceivedLoadTime&&n.startTime){var a=t.perceivedLoadTime.getTime()-n.startTime.getTime();if(a>0){new s.Qos({name:"Wrs.Word.PerceivedLoadTime",startTimeOverride:Date.now()-a}).end({resultType:s.ResultTypeEnum.Success,extraData:this._qosData})}}this._onInitializeSuccess(e,t)};t.prototype._onJSAPIFailure=function(e,t,r){if(!this.isDisposed){this._enableLogging&&console.log("WRS: "+t+" viewer initialization failed",r);var i=r.errorObject,s=new c.ApiError({code:r.errorType+"."+(i&&i.status||""),isExpected:!1,message:JSON.stringify(i&&(i.error||i.message))});this._engagement.logData({name:"Wrs."+t+".Failed",extraData:n.__assign(n.__assign({},this._qosData),{status:i&&i.status,category:i&&i.error,errorType:r.errorType})});this._onWrsFailure(e,s)}};t.prototype._onPowerPointSuccess=function(e,t,n){n.GetCurrentPosition();if(n.GetIsDisabled()){this._enableLogging&&console.log("WRS: PowerPoint viewer self wac fallback");this._engagement.logData({name:"Wrs.PowerPoint.SelfWacFallback",extraData:this._qosData})}this._onInitializeSuccess(e,t)};t.prototype._onPowerPointFailure=function(e,t){if(!this.isDisposed){this._enableLogging&&console.log("WRS: PowerPoint viewer intialization failed",t);var r=new c.ApiError({isExpected:!1,code:t.Category+"."+t.Code+"."+t.EventType,message:JSON.stringify(t.ExtraInfo)});this._engagement.logData({name:"Wrs.PowerPoint.Failed",extraData:n.__assign(n.__assign({},this._qosData),{category:t.Category,code:t.Code,eventType:t.EventType,extraInfo:t.ExtraInfo})});this._onWrsFailure(e,r)}};t.prototype._onInitializeSuccess=function(e,t){this._enableLogging&&console.log("WRS: initialize success on item: "+e.name);var n=t.ErrorObject||t.errorObject;n&&"CannotLoadBundleItem"===n.errorType&&this._onRegenerateOfficeBundle();this._engagement.logData({name:"Wrs.Success.Intialized",extraData:this._qosData});this._wrsQosEvent&&this._wrsQosEvent.end({resultType:s.ResultTypeEnum.Success})};t.prototype._onWrsFailure=function(e,t){this._enableLogging&&console.log("WRS: initialize failure on item: "+e.name);this._engagement.logData({name:"Wrs.WrsFailed",extraData:this._qosData});this._wrsQosEvent&&this._wrsQosEvent.end({resultType:s.ResultTypeEnum.Failure,resultCode:t&&(t.code||t.name)||""});this._onLoadFailure(t)};t.prototype._computeInitialize=function(){var e=this._isSlideCurrent.peek(),t=this._slide.item.peek(),n=this.container.peek();if(e)if(t)if(n){this._onLoadStart();this._initializeContent(n,t)}else this.container();else this._slide.item();else this._isSlideCurrent()};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{engagement:u.resourceKey,graphDataSource:l.graph,wrsHelper:f.resourceKey});return t})(i.default);t.default=h;function p(e){e.dispose?e.dispose():e.Dispose&&e.Dispose()}});
define("WCe",["require","exports","XCe","QCe","lj","SPListOneUp_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-zip",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("XCe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:showError--\x3e<section class="od-OneUpZip-container"><div class="od-OneUpZip-header" role="heading"><img class="od-OneUpZip-image" data-bind="attr:{src:svgUrl,alt:altText}"><span class="od-OneUpZip-number" data-bind="text:totalNum"></span></div><div class="od-OneUpZip" role="presentation" data-is-scrollable="true" data-bind="react:zipList"></div>\x3c!--ko if:isPartial()--\x3e<div class="od-OneUpZip-partial" role="alert"><span data-bind="text:beforeLinkText"></span><a href="javascript:;" data-bind="attr:{title:zipName},click:downloadZipFromPreview,text:linkText"></a><span data-bind="text:afterLinkText"></span></div>\x3c!--/ko--\x3e</section>\x3c!--/ko--\x3e'});
define("QCe",["require","exports","lC","jH","Fe","mv","E","lj","hj","jIe","$Ie","JCe","YCe","vh","yh","px"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(t){n.__extends(m,t);function m(s,f){var c=t.call(this,s,f)||this;c._engagement=f.engagement;c._countOnSelect=0;c._isRetinaEnabled=f.platformDetection.isRetinaSupported;c.altText=h.default.zipAltText;c._downloadAction=new(c.managed(f.actionMap.DownloadAction))({item:s.slide.item});var p=c.observables,d=h.default.downloadUrlTextLink.split("{0}"),v=d[0],m=d[1];c.beforeLinkText=v;c.afterLinkText=m;c.linkText=h.default.downloadUrlText;c.addBindingHandlers({control:u.default,react:a.default});var g=s.slide;c.fallbackControl=u.toSpecification(l.default,n.__assign(n.__assign({},s),{slide:n.__assign(n.__assign({},g),{loadResult:p.createCallback(r.forSingleValue())})}));var y=p.create();c.scope.attach(g.loadResult.register(y));c.isPartial=p.create(!1);c.showError=p.create(!1);c.totalNum=p.create("");c._selectedZipItems=p.create([]);c._downloadUrl=p.pureCompute(function(){var e=g.item();return e&&e.zip&&e.zip.downloadZipContentsUrl});c.zipName=p.pureCompute(function(){var e=g.item();return e&&e.name});c.svgUrl=window.require.toUrl("odsp-media/images/oneupzip/zipicon.svg");var b=g.item.peek(),w=c._root=p.create({children:[],date:b&&b.dateModified||"",extension:b&&b.extension||"",isFolder:!0,name:b&&b.name||"",childCount:0,parentFolder:void 0,path:"",size:0});c._onNavigate=c._onNavigate.bind(c);c._onSelect=c._onSelect.bind(c);c.zipList={componentPath:"HEe",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["HEe"],t,n)}))},props:p.pureCompute(c._computeZipListProps)};c._logZipEvent("ZipPreviewByClick",1);var E=f.zipDataSource;p.backgroundCompute(function(){var e=g.item(),t=e.zip&&e.zip.zipMetaDataUrl;E.getContents(e,t).then(function(e){w(e.root);c.totalNum(e.root.childCount);if(""!==e.error){c._logZipEvent("MoreThan1000Files",1);c.isPartial(!0)}y({resultType:o.ResultTypeEnum.Success});g.loadState(3)},function(e){y({resultType:e.isExpected?o.ResultTypeEnum.ExpectedFailure:o.ResultTypeEnum.Failure,resultCode:e.code||"GetContents",error:e&&e.message||""+e});g.loadState(3);c.showError(!0)})});return c}m.prototype.downloadZipFromPreview=function(e){this._downloadAction.execute(e)};m.prototype._computeZipListProps=function(){return{allowSelection:!this.slide.renderOptions,root:this._root(),name:this.zipName(),onNavigate:this._onNavigate,onSelect:this._onSelect,isRetinaEnabled:this._isRetinaEnabled}};m.prototype._onNavigate=function(e){this.totalNum(e.childCount);this._logZipEvent("ZipFolderNavigation",this._countOnSelect);this._countOnSelect++;this._onSelect([],e)};m.prototype._onSelect=function(e,t){this._selectedZipItems(e.length>0?e:[t]);var n=t===this._root.peek()&&t.childCount===e.length;if(0!==e.length&&!n||t&&t.path){this._zipCommandSet||this._initZipCommandSet();this.slide.commandSet(this._zipCommandSet)}else this.slide.commandSet(void 0)};m.prototype._initZipCommandSet=function(){this._zipCommandSet=new(this.managed(c.default))({actionParams:{item:this.slide.item,selection:this._selectedZipItems,url:this._downloadUrl}})};m.prototype._logZipEvent=function(e,t){0!==t&&this._engagement.logData({name:"OneUpZipPreviewer."+e})};m.dependencies=n.__assign(n.__assign({},f.default.dependencies),{actionMap:v.actionMap,engagement:p.resourceKey,platformDetection:s.platformDetection,zipDataSource:d.zip});return m})(f.default);t.default=m});
define("JCe",["require","exports","lC","U_e","n$","zB","WB","px"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(u.actionMap);n.commands.push(new(n.managed(i.CommandViewModel))({icon:new s.default("Download"),text:o.default.Download,automationId:"OneUpZipDownload",action:new(n.managed(r.DownloadZipContentsAction))(t.actionParams)}));return n}return t})(r.default);t.default=a});
define("bOe",["require","exports","vOe","gOe","QB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-spo-oneup",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("vOe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko control:controlBindingOptions--\x3e\x3c!--/ko--\x3e"});
define("gOe",["require","exports","lC","JB","X_","lj","fxe","cte","BZ","zG","k4e","NG","N5","zX","Mz","kz","px","yh","u3","W","Y","Fe","Lh"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:s.default});var x=r,T=x.observables,N=x.resources,C=N.consume(g.url),k=N.consume(p.resourceKey),L=N.consume(S.navigation).viewParams,A=C.getCurrentItemKey(L),O=C.getFocusItemKey(L);if(!O){r.controlBindingOptions={specification:s.toSpecification(o.resourceKey,{error:new Error(l.default.ItemNotFoundTitle)})};return r}var M=function(e,t){var n=C.getKeyParams(e);t&&delete n.view;return{parentKey:e,ownerId:C.getOwnerId(e),queryType:C.getQueryType(n),ignoreChildren:t}},_=M(O,!0),D=k.getItemSync(_).item,P=k.getItemSync(M(A,!1)),H=N.consume(y.bundleLoader),B=new d.default;B.item=P.item;T.compute(function(){var e=new v.default;e.items=[D];B.content(e)});b.default.mark("DataManager.GetData.Started");r.trackPromise(k.getItem(_).then(function(){b.default.mark("DataManager.GetData.Done")},function(e){e.errorTitle||E.default.isCanceled(e)||w.default.log(e)}));N.expose(g.bundle,new(r.managed(f.default)));N.exposeFactory(g.policyTip,new i.AliasResourceFactory(c.resourceKey));N.expose(m.currentItem,P.item);N.expose(m.currentItemSet,T.create(P));N.expose(m.focusItemSet,T.create(B));N.expose(m.focusItem,T.create(D));r.controlBindingOptions={specification:s.toSpecification(u.default,{}),placeholder:s.toSpecification(a.resourceKey,{}),afterRender:function(){H.pageLoaded(h.default[h.default.OneUp])}};return r}return t})(r.default);t.default=x});
define("ZCe",["require","exports","$Ce","jH","Lh","X_","E3","BG","yh","S3","QH","sX","Jy","Ie","x3","P3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(){function e(e,t){this._common=new n.default(t.pageContext);this._dataRequestor=new t.dataRequestorType({});this._graphDataSource=t.graphDataSource;this._itemParentHelper=t.itemParentHelper;this._navigation=t.navigation;this._itemUrlHelper=t.itemUrlHelper;this._identityDataSource=t.identityDataSource}e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t={});var n=r.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"subsite"));return this._common.getDownloadUrl(c.convertToISPListItem(e),c.convertToISPListItem(n),t)};e.prototype.getItemContents=function(e){var t=this;return this.getDownloadRequestParameters(e).then(function(e){var n=e.headers,r=n&&n.Authorization,i=r&&r.slice(7);return t._dataRequestor.getData({url:e.url,method:"GET",noRedirect:!0,qosName:"ItemDataSource.getItemContents",responseType:"blob",needsRequestDigest:!1,authToken:i})})};e.prototype.getDownloadRequestParameters=function(e,t){var n=this,r=this._itemUrlHelper.getItemUrlParts(e.key),i=new p.SPResourcePath(r.normalizedItemUrl);return r.isCrossDomain?this._identityDataSource.getSharePointToken(i.authority).then(function(t){var r=t.accessToken;return n.getDownloadUrl(e,{downloadType:2,authToken:r}).then(function(e){return{url:e,headers:{Authorization:"bearer "+r}}})}):this.getDownloadUrl(e,{downloadType:2}).then(function(e){return{url:e,withCredentials:!0}})};e.prototype.downloadItems=function(e){var t=this,n=e.items[0];return(l.isFeatureEnabled(l.UseVroomDownload)?this._graphDataSource.getDownloadUrl(n,{useDirectEndpoint:!0}):this.getDownloadUrl(n,{downloadType:0})).then(function(e){t._navigation.navigateTo(e)})};e.prototype.isDownloadBlocked=function(e){return!v.PermissionMask.hasPermission(e.permissions,v.PermissionMask.openItems)};return e})();t.default=m;t.resourceKey=s.createResolvedResourceKey(e("module").id,m,{dataRequestorType:o.typeResourceKey,graphDataSource:a.graph,itemParentHelper:u.resourceKey,navigation:i.navigation,pageContext:f.pageContext,itemUrlHelper:h.resourceKey,identityDataSource:d.resourceKey})});
define("$Ce",["require","exports","lC","nk","Fe","ke","Pe","u9","xP"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{},{pageContext:t})||this;n._itemUrlHelper=new s.ItemUrlHelper({},{pageContext:t});n._apiUrlHelper=new o.ApiUrlHelper({},{pageContext:t,itemUrlHelper:n._itemUrlHelper});return n}t.prototype.downloadItems=function(e){var t=e.items[0];return this.getDownloadUrl(t,null,{downloadType:0}).then(function(e){window.location.href=e})};t.prototype.getDownloadUrl=function(e,t,n){var r=this;void 0===n&&(n={});var f=n.downloadType,l=void 0===f?0:f,c=this._itemUrlHelper.getItemUrlParts(e.key);if(1===l)return i.default.resolve(c.fullItemUrl);if(3===l){var h=void 0;h=e.video?24:1;var p=this._apiUrlHelper.build().webByItemUrl(c);return a.getPreAuthorizedAccessUrl({dataRequestor:this.dataRequestor,webApiUrl:p,duration:h,serverRelativeItemUrl:c.serverRelativeItemUrl})}if(2===l)return c.isCrossDomain&&n.authToken?this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(c.fullItemUrl),method:"POST",qosName:"GetContextInfo",authToken:n.authToken}).then(function(e){var t=e.d.GetContextWebInformation.WebFullUrl,n=new o.ApiUrlHelperBasic({webAbsoluteUrl:t}).build().segment("web").methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:c.serverRelativeItemUrl}).segment("OpenBinaryStream");return i.default.resolve(n.toString())}):i.default.resolve(this.getBinaryStreamApiUrl(c).toString());var d=void 0;if(t||c.siteRelation===s.SiteRelation.sameSite){var v=void 0;if(t){v=this._itemUrlHelper.getItemUrlParts(t.key).fullItemUrl}else v=this._pageContext.webAbsoluteUrl;d=i.default.resolve(v)}else d=this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(c.fullItemUrl),method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl});return d.then(function(e){return e+"/"+r._pageContext.layoutsUrl+"/download.aspx?"+u.serializeQuery({SourceUrl:c.serverRelativeItemUrl})})};t.prototype.getBinaryStreamApiUrl=function(e){var t=this._apiUrlHelper.build().webByItemUrl(e);t=(t=t.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl})).segment("OpenBinaryStream");var n=this._pageContext.authToken;n&&(t=t.oDataParameter("access_token",n));return t};return t})(r.default);t.default=f});
define("eOe",["require","exports","X_","E3","nK","VG","yh"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){this._apiUrlHelper=t.apiUrlHelper;this._dataRequestor=new t.dataRequestorType({});this._graphDataSource=t.graphDataSource;this._vroomDataRequestor=t.vroomDataRequestor}e.prototype.getOpenWith=function(e){var t=this._graphDataSource.getItemUrl(e,{useDirectEndpoint:!0});return this._vroomDataRequestor.send({allowCookies:!0,apiName:"OpenWithWAC",path:t+"/openWith/wac?action=view"})};e.prototype.getWebApplicationUrls=function(){var e=this._apiUrlHelper.build().methodWithAliases("SP.Utilities.WopiHostUtility.GetWebApplicationUrls",{appNames:"Excel,Word,PowerPoint,Visio",actions:"0"});return this._dataRequestor.getData({url:e.toString(),qosName:"GetWebApplicationUrls",method:"GET",needsRequestDigest:!1,noRedirect:!0}).then(function(e){return e&&e.d&&e.d.GetWebApplicationUrls&&e.d.GetWebApplicationUrls.results})};e.prototype.getWopiInfo=function(e){return this.getOpenWith(e).then(function(e){return{WopiSrc:e.wopiSrc,AccessToken:e.accessToken,AccessTokenExpiry:new Date(parseInt(e.accessTokenExpiry,10))}})};return e})();t.default=u;t.resourceKey=n.createResolvedResourceKey(e("module").id,u,{apiUrlHelper:s.resourceKey,dataRequestorType:r.typeResourceKey,graphDataSource:o.graph,vroomDataRequestor:i.resourceKey})});
define("tOe",["require","exports","X_","Se","S3"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._urlCache={};var n=t.window,i=void 0===n?window:n;this._window=i;this._spDomain=new r.default(t.pageContext.webAbsoluteUrl).authority}e.prototype.getWorkerUrl=function(e){var t=new r.default(e),n=this._window,i=n.location.protocol+"//"+n.location.host;if(t.authority!==i){if(i===this._spDomain)return i+"/_layouts/15/serviceworkerproxy.aspx?serviceWorkerUrl="+encodeURIComponent(e);var s=this._urlCache;if(s[e])return s[e];var o=n.URL.createObjectURL(new Blob(["importScripts("+JSON.stringify(e)+");"],{type:"text/javascript"}));s[e]=o;return o}return e};e.prototype.dispose=function(){var e=this._urlCache;for(var t in e)this._window.URL.revokeObjectURL(e[t])};return e})();t.default=s;t.resourceKey=n.createResolvedResourceKey(e("module").id,s,{pageContext:i.pageContext})});
define("nOe",["require","exports","hOe","aOe","lj"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-item-action-bar",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("hOe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko component:component--\x3e\x3c!--/ko--\x3e"});
define("aOe",["require","exports","lC","JB","rOe","iOe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.component={name:i.default.tagName,params:{commandSet:new(r.child(s.default))({forceExternal:t.forceExternal,item:t.item,hideOpenCommand:t.hideOpenCommand})}};return r}return t})(r.default);t.default=o});
define("rOe",["require","exports","_Oe","QB","pOe","SPListOneUp_IS_mini_css","oOe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-button-bar",template:n.default,viewModel:i.ButtonBarViewModel,synchronous:!0});t.default=s});
define("_Oe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<span class="od-ButtonBar" data-bind="keyboard:keyboardOptions,element:topTab"><span class="od-ButtonBar-main" data-bind="foreach:mainCommands">\x3c!--ko component:{name:\'od-button-bar-command\',params:{command:$data,index:$index}}--\x3e\x3c!--/ko--\x3e</span><span class="od-ButtonBar-side" data-bind="foreach:sideCommands">\x3c!--ko component:{name:\'od-button-bar-command\',params:{command:$data,index:$index}}--\x3e\x3c!--/ko--\x3e</span></span>'});
define("pOe",["require","exports","lC","e","JB","dG","F1e","mOe","fG","C5e","bz","Ge"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var i=e.call(this,t,n)||this;c.flush();i._allCommands=r.observableArray();i.overflowCommands=r.observableArray();i.focusedCommand=r.observable();i.fixedCommands=[];i._overflowCommandsSubscription=null;i._commandSetCommandsReplicationSubscription=null;i.responsiveUI=i.resources.consume(l.resourceKey);i.addBindingHandlers({selection:o.default,overflow:u.default,keyboard:s.default,element:a.default});i._mainCommandsFirstTimeRendered=r.observable(!1);i.keyboardOptions=[{mappings:{Down:i.onNavigateDown,Enter:i.onEnter}},{target:document,mappings:{},allowButtonEvents:!0}];i._initializeCommandsObservables();i._initializeFocusLogic(!!t.focusOnFirstCommand||!1);i._commandSet=i.wrapObservable(t.commandSet);i._initializeCommandSet(i._commandSet.peek());i.subscribe(i._commandSet,function(e){i._initializeCommandSet(e)});return i}t.prototype.getButtonBarItemParams=function(e,t){var n=this;return{command:e,index:4&e.location?this.observables.pureCompute(function(){return t()+n.mainCommands().length}):t}};t.prototype.onNavigateDown=function(e,t){var n=this.focusedCommand();n&&n.openMenu()&&t.preventDefault();return!1};t.prototype.onEnter=function(e,t){var n=this.focusedCommand();if(!n)return!0;var r=t.target.getElementsByTagName("input");if(!r||!r.length)return n.onClick(n,t);r[0].click();t.stopPropagation();t.preventDefault()};t.prototype.animateIn=function(e,t,n){if(n.hasAnimation&&1===e.nodeType){r.utils.toggleDomNodeCssClass(e,"is-animatingIn",!0);this.async.setTimeout(function(){r.utils.toggleDomNodeCssClass(e,"is-animatingIn",!1)},1e3)}};t.prototype.animateOut=function(e,t,n){if(n.hasAnimation&&1===e.nodeType){r.utils.toggleDomNodeCssClass(e,"is-animatingOut",!0);this.async.setTimeout(function(){r.removeNode(e)},1e3)}else r.removeNode(e)};t.prototype._updateCommandKeyboardShortcuts=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.keys)for(var i=r.onClick.bind(r),s=0;s<r.keys.length;s++){var o=r.keys[s];e[o]||(e[o]=[]);e[o].push(i)}var u=r.children();u.length&&this._updateCommandKeyboardShortcuts(e,u)}};t.prototype._initializeCommandSet=function(e){var t=this;if(this._overflowCommandsSubscription){this._overflowCommandsSubscription.dispose();this._overflowCommandsSubscription=null}if(this._commandSetCommandsReplicationSubscription){this._commandSetCommandsReplicationSubscription.dispose();this._commandSetCommandsReplicationSubscription=null}this._allCommands([]);this.fixedCommands=[];this.keyboardOptions[1].mappings={};if(e){this._commandSetCommandsReplicationSubscription=f.replicateArray(e.commands,this._allCommands);this.addDisposable(this._commandSetCommandsReplicationSubscription);if(e.overflowHostCommand){this.fixedCommands.push(e.overflowHostCommand);this._overflowCommandsSubscription=this.createBackgroundComputed(function(){var n=t.overflowCommands().concat(t._overflowOnlyCommands());e.overflowHostCommand.children(n)})}this._mainCommandsFirstTimeRendered.peek()||this._mainCommandsFirstTimeRendered(!0)}};t.prototype._initializeCommandsObservables=function(){var e=this,t=this._allCommands,n=this._visibleCommands=this.addDisposable(t.filter(function(e){return e.isVisible()&&(function(e){return 0!=(7&e.location)})(e)}));this.mainCommands=this.addDisposable(n.filter(p));this._overflowOnlyCommands=this.addDisposable(t.filter(v));this.sideCommands=this.addDisposable(n.filter(d));this.selectableCommands=this.addDisposable(n.filter(function(t){return!(v(t)||e._isOverflowEnabled()&&e.overflowCommands.indexOf(t)>=0)&&!t.isDisabled()}));this.subscribe(t,function(t){var n={};e._updateCommandKeyboardShortcuts(n,t);e.keyboardOptions[1].mappings=n})};t.prototype._initializeFocusLogic=function(e){var t=this,n=this.addDisposable(this._visibleCommands.filter(function(e){return e.isOpen()})),i=this.createComputed(function(){return n().length>0});this.createComputed(function(){i()||r.computedContext.isInitial()||document.activeElement&&document.activeElement!==document.body||!t.topTab.peek()||t.topTab.peek().focus()}).extend({rateLimit:0});this.topTab=r.observable(null);this.subscribe(this._mainCommandsFirstTimeRendered,function(n){t.async.setImmediate(function(){n&&e&&t._focusOnFirstCommand()})})};t.prototype._isOverflowEnabled=function(){return!!this._commandSet.peek()&&!!this._commandSet.peek().overflowHostCommand};t.prototype._focusOnFirstCommand=function(){if(this._visibleCommands()&&this._visibleCommands().length>0){var e=this._visibleCommands()[0];e.focused(!0);this.focusedCommand(e)}};return t})(i.default);t.ButtonBarViewModel=h;function p(e){return 3==(3&e.location)}function d(e){return 4==(4&e.location)}function v(e){return 2==(3&e.location)}});
define("mOe",["require","exports","e","pv"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.init=function(t,i,s){var o=n.observable();n.computed(function(){o();var r=n.utils.unwrapObservable(i()),u=s(),a=null;a=r.data?r.data:u.foreach&&u.foreach.data||u.foreach||u.template&&u.template.foreach;var f=r.responsiveUI.formFactorSize(),l=n.utils.unwrapObservable(a),c=n.utils.unwrapObservable(r.alwaysVisibleItems);e._calculateElementVisibility(t,r,l,c,f)},null,{disposeWhenNodeIsRemoved:t}).extend({throttle:1});var u=new r.default(t);n.utils.domNodeDisposal.addDisposeCallback(t,function(){u.dispose()});u.on(t,"layoutChange",function(e){o.notifySubscribers()});u.on(window,"resize",function(e){o.notifySubscribers()});u.on(document,"transitionend",function(e){o.notifySubscribers()})};e._calculateElementVisibility=function(t,r,i,s,o){if(i&&i.length){var u=t.getBoundingClientRect(),a=u.right-u.left,f=0,l=[],c=[];if(s&&i)for(var h=0,p=s.length;h<p;h++){var d=s[h],v=n.utils.arrayIndexOf(i,d);if(v>-1&&v<t.children.length){var m=t.children[v];a-=e._measureElement(m).width}}for(h=0,p=t.children.length;h<p;h++){m=t.children[h];var g="Small"===o&&h>0,y=void 0;i&&(y=i[h]);f+=e._measureElement(m).width;var b=s&&y&&n.utils.arrayIndexOf(s,y)>-1,w=!b&&(f>a||g);y&&n.isObservable(y.isClipped)&&y.isClipped(w);if(!b){var E="none"!==m.style.display;w||E?w&&E&&(m.style.display="none"):m.style.display=""}if(w){l.push(m);y&&c.push(y)}}if(r){n.isObservable(r.overflowElements)&&r.overflowElements(l);n.isObservable(r.overflowItems)&&r.overflowItems(c)}}};e._measureElement=function(e){var t=e.style.display;e.style.display="";var n=e.getBoundingClientRect(),r=window.getComputedStyle(e),i=parseFloat(r.marginLeft),s=parseFloat(r.marginRight),o=parseFloat(r.marginTop),u=parseFloat(r.marginBottom);e.style.display=t;return{left:n.left-i,right:n.right+s,top:n.top-o,bottom:n.bottom+u,width:n.right-n.left+i+s,height:n.bottom-n.top+o+u}};return e})();t.default=i});
define("oOe",["require","exports","uOe","lOe","dOe","QB","cOe","sOe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s.registerComponent({tagName:"od-button-bar-command",template:n.default,viewModel:o.default,synchronous:!0});s.registerTemplate(u.BUTTON,r.default);s.registerTemplate(u.TEXT,i.default);t.default=a});
define("uOe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko template:templateName--\x3e\x3c!--/ko--\x3e"});
define("lOe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<button class="od-Button od-ButtonBarCommand od-ButtonBarCommand--button" data-bind="attr:{title:command.tooltip},css:{\'is-disabled\':command.isDisabled,\'is-focused\':command.focused,\'od-Button--primary\':isPrimary},hasFocus:command.isActive,disable:command.isDisabled,click:command.onClick.bind(command)">\x3c!--ko if:command.icon--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon" data-bind="component:{name:\'od-icon-glyph\',params:{icon:command.icon,badge:command.iconBadge}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon:true,style:{backgroundImage:\'url(\\\'\'+command.iconUrl()+\'\\\')\'}"></i></span>\x3c!--/ko--\x3e\x3c!--ko if:command.isLabelVisible--\x3e<span class="od-Button-label od-ButtonBarCommand-label" data-bind="text:command.label"></span>\x3c!--/ko--\x3e</button>'});
define("dOe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<span class="od-ButtonBarCommand od-ButtonBarCommand--text" data-bind="class:\'od-ButtonBarCommand--\'+state()">\x3c!--ko if:command.icon--\x3e<span class="od-ButtonBarCommand-icon" data-bind="component:{name:\'od-icon-glyph\',params:{icon:command.icon,badge:command.iconBadge}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon:true,style:{backgroundImage:\'url(\\\'\'+command.iconUrl()+\'\\\')\'}"></i></span>\x3c!--/ko--\x3e\x3c!--ko if:command.isLabelVisible--\x3e<span class="od-ButtonBarCommand-label" data-bind="text:command.label"></span>\x3c!--/ko--\x3e</span>'});
define("cOe",["require","exports","lC","JB","sOe","u$","e"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._index=t.index;n.command=t.command;n.focused=o.observable(!1);n.selected=o.observable(!1);n.templateName=n.createPureComputed(n._computeTemplateName);n.isPrimary=n.createPureComputed(n._computeIsPrimary);n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeTemplateName=function(){return!this.command.action||!this.unwrapObservable(this.command.isPermanent)&&this.command.isDisabled()?i.TEXT:i.BUTTON};t.prototype._computeIsPrimary=function(){return 0===this._index()};t.prototype._computeState=function(){return s.default[this.command.state()||s.default.initialized]};return t})(r.default);t.default=u});
define("sOe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BUTTON="od-button-bar-command-button";t.TEXT="od-button-bar-command-text"});
define("iOe",["require","exports","lC","n$","WB","px","U_e","Y0","PX","d1","gD"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(s.actionMap);n._isOneDriveWinApp=u.isOneDriveWinApp();var o=n.observables,c=t.forceExternal,h=t.item,p=t.hideOpenCommand;n._isOneDriveWinApp&&h().queryType===f.default.SharedWithMe?n.commands.push(new(n.managed(r.CommandViewModel))({text:i.default.Open,action:new(n.managed(n._actionMap.OpenInDesktopAction))({item:t.item,openRelation:2,actionType:a.DesktopActionType.DefaultClick})})):n._isOneDriveWinApp&&h().type===l.default.Unknown?n.commands.push(new(n.managed(r.CommandViewModel))({text:i.default.Open,action:new(n.managed(n._actionMap.DownloadAction))({item:t.item})})):!n._isOneDriveWinApp||h().type!==l.default.OneNote&&h().type!==l.default.File?c||n.commands.push(new(n.managed(r.CommandViewModel))({text:i.default.Open,action:new(n.managed(n._actionMap.DefaultClickAction))({sourceEngagement:"OneUpOther.Open.Click",userInvokedItem:!0,item:t.item,hideIfDefaultIsDownload:!0}),isHidden:o.pureCompute(function(){return o.unwrap(p)})})):n.commands.push(new(n.managed(r.CommandViewModel))({text:i.default.Open,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))({item:t.item,openLocal:!1,useDefaultAction:!0})}));n.commands.push(new(n.managed(r.CommandViewModel))({text:i.default.Download,action:new(n.managed(n._actionMap.DownloadAction))({item:t.item})}));return n}return t})(o.default);t.default=c});
define('SPListOneUp_IS_mini_css',["Ge","uC"],function(e){"use strict";e.loadStyles([{"rawString":".OneUp-html{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUp-html.iOS{overflow:auto}.OneUp-html iframe{width:100%;height:100%;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}"},{"rawString":".od-Projector{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}.od-Projector-image{position:absolute;left:0;top:0;width:100%;height:100%;transform-origin:0 0;touch-action:none;will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.od-Projector--gliding.od-Projector--preview .od-Projector-image{transition:transform 267ms cubic-bezier(.1,.9,.2,1)}.od-Projector--gliding.od-Projector--live .od-Projector-image{transition:left 267ms cubic-bezier(.1,.9,.2,1),top 267ms cubic-bezier(.1,.9,.2,1),width 267ms cubic-bezier(.1,.9,.2,1),height 267ms cubic-bezier(.1,.9,.2,1)}"},{"rawString":".OneUp-slide{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-slide:after,.OneUp-slide:before{display:block;position:absolute;width:2%;height:100%;content:''}html[dir=ltr] .OneUp-slide:before{right:100%}html[dir=rtl] .OneUp-slide:before{left:100%}html[dir=ltr] .OneUp-slide:after{left:100%}html[dir=rtl] .OneUp-slide:after{right:100%}.od-OneUpVideo{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-other{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.OneUp-other .OneUp-other-content{text-align:center}.OneUp-other .OneUp-other-content .OneUp-other-fileName{font-size:21px}.OneUp-other .OneUp-other-content .OneUp-other-download{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-other .OneUp-other-content .OneUp-other-message{margin-top:15px;margin-bottom:15px}.OneUp-other .OneUp-other-content .OneUp-other-actions .od-ButtonBar-main{float:none}.OneUp-other .OneUp-other-content .OneUp-other-fileIcon .FileTypeIcon{outline:0}.OneUp-other .OneUp-other-content .od-ButtonBarCommand:not(.od-Button--primary){background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.OneUp-photo .od-Projector--live .od-ImageTile-background{transition:max-width 267ms cubic-bezier(.1,.9,.2,1),max-height 267ms cubic-bezier(.1,.9,.2,1)}.OneUp-photo .od-Projector--live.od-Projector--panning .od-ImageTile-background{transition-duration:0s,0s}.OneUp-otherTile{width:240px;height:240px;margin:auto;position:relative}.OneUp-fileHandler,.OneUp-fileHandler-frame{border:0;width:100%;height:100%}.OneUp-other-malwareDetectedIcon{height:208px;width:208px}"},{"rawString":".OneUp{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;outline:0;background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.OneUp.OneUp--darkBackground{background-color:#1b1a19}.OneUp-detailsBar{visibility:hidden;opacity:0}.OneUp-detailsBar .CommandBarItem{flex:0 0 auto}html[dir=ltr] .OneUp-detailsBar .CommandBarItem{margin-right:0}html[dir=rtl] .OneUp-detailsBar .CommandBarItem{margin-left:0}.OneUp-detailsBar .CommandBarItem .CommandBarItem-icon{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.OneUp-detailsBar .CommandBarItem{background-color:"},{"theme":"menuItemBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";opacity:.9}.OneUp-detailsBar .CommandBarItem.is-toggled,.OneUp-detailsBar .CommandBarItem.is-toggled:hover,.OneUp-detailsBar .CommandBarItem:hover{background-color:"},{"theme":"menuItemBackgroundPressed","defaultValue":"#edebe9"},{"rawString":";opacity:1}.OneUp-toolbarHost{display:flex;flex-flow:column-reverse nowrap;justify-content:center;align-items:center}.OneUp-toolbar{background-color:transparent;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";height:44px;display:flex;align-items:stretch;justify-content:center;flex-flow:row nowrap}.lg .OneUp-toolbar,.xlg .OneUp-toolbar,.xxlg .OneUp-toolbar,.xxxlg .OneUp-toolbar,.xxxxlg .OneUp-toolbar{height:40px}.OneUp-commandBar{position:absolute;left:0;right:0;top:-44px;z-index:2;visibility:hidden;height:44px;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";transition:visibility 267ms linear,top 267ms linear}.isFluent .OneUp-commandBar{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.lg .OneUp-commandBar,.xlg .OneUp-commandBar,.xxlg .OneUp-commandBar,.xxxlg .OneUp-commandBar,.xxxxlg .OneUp-commandBar{height:40px;top:-40px}:not(.od-fluentCustomizationDisabled).isFluent.lg .OneUp-commandBar{top:-44px;height:44px}:not(.od-fluentCustomizationDisabled).isFluent.xlg .OneUp-commandBar{top:-44px;height:44px}:not(.od-fluentCustomizationDisabled).isFluent.xxlg .OneUp-commandBar{top:-44px;height:44px}:not(.od-fluentCustomizationDisabled).isFluent.xxxlg .OneUp-commandBar{top:-44px;height:44px}:not(.od-fluentCustomizationDisabled).isFluent.xxxxlg .OneUp-commandBar{top:-44px;height:44px}.OneUp-commandBar .CommandBarItem:hover{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--Word{background-color:"},{"theme":"wordColor","defaultValue":"#2b579a"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--Word .ms-Icon--WordLogo:before{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--Word .od-CommandBarItem-down{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--Excel{background-color:"},{"theme":"excelColor","defaultValue":"#217346"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .ms-Icon--ExcelLogo:before{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .od-CommandBarItem-down{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint{background-color:"},{"theme":"powerpointColor","defaultValue":"#d24726"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .ms-Icon--PowerPointLogo:before{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .od-CommandBarItem-down{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--PDF{background-color:#c90304;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .ms-Icon--PDF:before{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .od-CommandBarItem-down{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .CommandBarItem.od-Command--Excel.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--Excel.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--Excel:hover,.OneUp-commandBar .CommandBarItem.od-Command--PDF.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--PDF.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--PDF:hover,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint:hover,.OneUp-commandBar .CommandBarItem.od-Command--Word.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--Word.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--Word:hover{background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.OneUp-commandBar .ms-CommandBar{padding:0}.sm .OneUp-commandBar{top:-44px;height:44px}.CommandBar-center{text-align:center}.OneUp-accessibleItemAnnouncement{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.OneUp-content{position:absolute;left:0;top:0;bottom:0;right:0;transition:top 267ms linear,left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.OneUp-carousel{position:absolute;left:0;right:0;top:0;bottom:0;z-index:1;transition:top 267ms linear}.sm .OneUp--hasCommandBar .OneUp-paneHost{top:44px}.isFluent .OneUp--hasCommandBar .ms-Button--commandBar .ms-Button-menuIcon{background-color:inherit}.OneUp--hasCommandBar .OneUp-content,.OneUp--hasCommandBar .OneUp-paneHost{top:44px}.lg .OneUp--hasCommandBar .OneUp-content,.lg .OneUp--hasCommandBar .OneUp-paneHost,.xlg .OneUp--hasCommandBar .OneUp-content,.xlg .OneUp--hasCommandBar .OneUp-paneHost,.xxlg .OneUp--hasCommandBar .OneUp-content,.xxlg .OneUp--hasCommandBar .OneUp-paneHost,.xxxlg .OneUp--hasCommandBar .OneUp-content,.xxxlg .OneUp--hasCommandBar .OneUp-paneHost,.xxxxlg .OneUp--hasCommandBar .OneUp-content,.xxxxlg .OneUp--hasCommandBar .OneUp-paneHost{top:40px}.OneUp--hasCommandBar .OneUp-commandBar{visibility:visible;top:0}:not(.od-fluentCustomizationDisabled).isFluent .OneUp--hasCommandBar .OneUp-commandBar{top:0}html[dir=ltr] .isFluent .OneUp--hasCommandBar .OneUp-commandBar{padding-left:16px}html[dir=rtl] .isFluent .OneUp--hasCommandBar .OneUp-commandBar{padding-right:16px}.OneUp-detailsBar{transition:visibility 0s linear 267ms,opacity 267ms linear,bottom 267ms linear;position:absolute;left:0;right:0;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";z-index:1}[dir=ltr] .lg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .md .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxxlg .OneUp--hasInfoPane .OneUp-content{right:320px}[dir=rtl] .lg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .md .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxxlg .OneUp--hasInfoPane .OneUp-content{left:320px}[dir=ltr] .OneUp--hasInfoPane .OneUp-paneHost{right:0}[dir=rtl] .OneUp--hasInfoPane .OneUp-paneHost{left:0}.sm .OneUp--hasInfoPane .OneUp-infoPane,.sm .OneUp--hasInfoPane .OneUp-paneHost{width:100%}.OneUp--slideShowOn .OneUp-commandBar{visibility:hidden}.OneUp--slideShowOn .OneUp-content{top:0}.OneUp--awake .OneUp-detailsBar{visibility:inherit;opacity:1;transition-delay:0s,0s,0s}.OneUp--awake.OneUp--slideShowOn .OneUp-commandBar{visibility:inherit}.OneUp-caption-container{display:flex;align-items:center;justify-content:center;width:100%;background-color:rgba(255,255,255,.75)}.OneUp-caption{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";flex:1 1 auto;height:30px;border:0;padding:0;background:0 0;text-align:center;width:100%;max-width:600px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.OneUp-caption--editable{cursor:pointer}.OneUp-caption-clipper{display:table-cell;max-width:600px;height:30px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.lg .OneUp-caption-clipper{max-width:510px}.md .OneUp-caption-clipper{max-width:345px}.sm .OneUp-caption-clipper{max-width:150px}.OneUp-options{position:absolute;top:0;bottom:0;text-align:right}[dir=ltr] .OneUp-options{right:8px}[dir=rtl] .OneUp-options{left:8px}.OneUp-info{position:absolute;top:0;display:block;padding:20px 8px;height:40px}[dir=ltr] .OneUp-info{right:0}[dir=rtl] .OneUp-info{left:0}.OneUp-paneHost{position:absolute;width:320px;top:0;bottom:0;overflow:hidden;z-index:1}[dir=ltr] .OneUp-paneHost{right:-321px}[dir=rtl] .OneUp-paneHost{left:-321px}.OneUp-infoPane{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";position:absolute;top:0;bottom:0;right:0;width:320px}.od-userSelect--enabled .OneUp-infoPane{-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text}.OneUp .od-Panel,.OneUp .od-PanelOverlay{top:0}"},{"rawString":".OneUp-3d{position:absolute;top:0;left:0;right:0;bottom:0;touch-action:none}"},{"rawString":".od-Panorama-sivContainer{position:absolute;top:0;left:0;right:0;bottom:0}.od-Panorama-interactiveModeButton{position:absolute;top:50%;width:100px;height:100px;margin-top:-50px;background-repeat:no-repeat;background-color:transparent;border:none;z-index:1}[dir=ltr] .od-Panorama-interactiveModeButton{left:50%}[dir=rtl] .od-Panorama-interactiveModeButton{right:50%}[dir=ltr] .od-Panorama-interactiveModeButton{margin-left:-50px}[dir=rtl] .od-Panorama-interactiveModeButton{margin-right:-50px}.od-Panorama-interactiveModeButton:active,.od-Panorama-interactiveModeButton:hover{background-color:transparent}.od-Panorama--isInteractive .od-Panorama-interactiveModeButton{display:none}.od-Panorama .od-Panorama-backButton{display:none;position:absolute;top:20px;height:40px;width:40px;padding:0;z-index:1;cursor:pointer;background-color:#fff}[dir=ltr] .od-Panorama .od-Panorama-backButton{right:40px}[dir=rtl] .od-Panorama .od-Panorama-backButton{left:40px}.od-Panorama--isInteractive .od-Panorama-backButton{display:block}.od-Panorama .sivZoomInButton,.od-Panorama .sivZoomOutButton{display:none;right:auto;background-color:#fff;width:40px;height:40px;cursor:pointer;padding:0;top:auto}[dir=ltr] .od-Panorama .sivZoomInButton,[dir=ltr] .od-Panorama .sivZoomOutButton{right:50px}[dir=rtl] .od-Panorama .sivZoomInButton,[dir=rtl] .od-Panorama .sivZoomOutButton{left:50px}.od-Panorama--isInteractive .sivZoomInButton,.od-Panorama--isInteractive .sivZoomOutButton{display:block}.od-Panorama .od-Panorama-backButton:hover,.od-Panorama .sivZoomInButton:hover,.od-Panorama .sivZoomOutButton:hover{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.od-Panorama .od-Panorama-backButton:active,.od-Panorama .sivZoomInButton:active,.od-Panorama .sivZoomOutButton:active{background-color:#000;color:#fff}.od-Panorama .sivZoomInButton{bottom:100px}.od-Panorama .sivZoomOutButton{bottom:50px}.od-Panorama .sivHeadingLeftButton,.od-Panorama .sivHeadingRightButton,.od-Panorama .sivPitchDownButton,.od-Panorama .sivPitchUpButton{display:none}"},{"rawString":".OneUp-Image360-loadingContainer{position:absolute;width:100%}.OneUp-Image360-loadingContainer .OneUp-Image360-loading{width:300px;height:40px;background-color:rgba(0,0,0,.7);position:relative;margin:auto;bottom:0;padding:10px 15px;box-sizing:border-box}.OneUp-Image360-loadingContainer .OneUp-Image360-loading .OneUp-Image360-loadingSpinner{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";margin-top:10px}.OneUp-Image360-loadingContainer .OneUp-Image360-loading .OneUp-Image360-loadingSpinner .od-LoadingSpinner{overflow:hidden;text-overflow:ellipsis}[dir=ltr] .OneUp-Image360-loadingContainer .OneUp-Image360-loading .OneUp-Image360-loadingSpinner .od-LoadingSpinner-loadingGif{margin-right:5px}[dir=rtl] .OneUp-Image360-loadingContainer .OneUp-Image360-loading .OneUp-Image360-loadingSpinner .od-LoadingSpinner-loadingGif{margin-left:5px}.OneUp-Image360-content{position:absolute;top:0;left:0;right:0;bottom:0;touch-action:none}.OneUp-Image360-content .od-viewer360{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%}"},{"rawString":".OneUp-pdf{position:absolute;top:0;bottom:0;left:0;right:0}.OneUp-pdf-loadingContainer{position:absolute;width:100%}.OneUp-pdf-loadingContainer .OneUp-pdf-loading{width:300px;height:40px;background-color:rgba(0,0,0,.7);position:relative;margin:auto;bottom:0;padding:10px 15px;box-sizing:border-box}.OneUp-pdf-loadingContainer .OneUp-pdf-loading .OneUp-pdf-loadingSpinner{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";margin-top:10px}.OneUp-pdf-loadingContainer .OneUp-pdf-loading .OneUp-pdf-loadingSpinner .od-LoadingSpinner{overflow:hidden;text-overflow:ellipsis}[dir=ltr] .OneUp-pdf-loadingContainer .OneUp-pdf-loading .OneUp-pdf-loadingSpinner .od-LoadingSpinner-loadingGif{margin-right:5px}[dir=rtl] .OneUp-pdf-loadingContainer .OneUp-pdf-loading .OneUp-pdf-loadingSpinner .od-LoadingSpinner-loadingGif{margin-left:5px}.od-OneUpPdf-thumbnail{position:absolute;top:0;left:0;right:0;bottom:0;overflow-y:scroll;opacity:1;visibility:visible;transition:opacity 267ms linear 267ms,visibility 0s linear 534ms}.OneUp-pdf--loaded .od-OneUpPdf-thumbnail{opacity:0;visibility:hidden}.od-OneUpPdf-content{display:none;position:absolute;top:0;left:0;right:0;bottom:0}.OneUp-pdf--loaded .od-OneUpPdf-content{display:block}"},{"rawString":".TextViewer-frame{border:none;position:absolute;top:1px;left:1px;right:1px;bottom:1px}.TextViewer-frame:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}"},{"rawString":".od-OneUpTextFile-thumbnail{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;visibility:hidden}.od-OneUpTextFile-thumbnail--load .od-OneUpTextFile-thumbnail{opacity:1;visibility:inherit;transition:opacity 267ms linear 267ms}.od-OneUpTextFile--loaded .od-OneUpTextFile-thumbnail{opacity:0;visibility:hidden}.od-OneUpTextFile-loading{position:absolute;top:0;left:0;right:0;bottom:0;z-index:1;opacity:1;visibility:inherit}.od-OneUpTextFile--loaded .od-OneUpTextFile-loading{opacity:0;visibility:hidden}.od-OneUpTextFile-content{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;visibility:hidden;margin:20px;display:flex;flex-flow:column nowrap;align-items:stretch;justify-content:space-between;box-shadow:0 0 7px 2px rgba(0,0,0,.15)}.od-OneUpTextFile--compact .od-OneUpTextFile-content{margin:0 0;box-shadow:0}.od-OneUpTextFile--loaded .od-OneUpTextFile-content{opacity:1;visibility:inherit;transition:opacity 267ms linear 267ms}.od-OneUpTextFile-content .od-OneUpTextFile-title{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";flex:0 0 24px;font-size:14px;padding:6px 0 0 10px}html[dir=rtl] .od-OneUpTextFile-content .od-OneUpTextFile-title{padding:6px 10px 0 0}.od-OneUpTextFile-content .od-OneUpTextFile-editor{position:relative;flex:1 1 auto;width:100%}.od-OneUpTextFile-content .TextEditor{overflow:hidden}.od-OneUpTextFile-content .TextEditor .TextEditor-editorFrame{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";top:0;left:0;right:0;bottom:0}.od-OneUpTextFile-content .monaco-editor-background{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}"},{"rawString":".OneUp-wac-frame{height:100%;width:100%;border:0}"},{"rawString":".OneUp-wrs{height:100%}.OneUp-wrs-toolbar{position:absolute;bottom:0;transform:translate(-50%);color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}[dir=ltr] .OneUp-wrs-toolbar{left:50%}[dir=rtl] .OneUp-wrs-toolbar{right:50%}.OneUp-wrs-loadingContainer{position:absolute;width:100%}.OneUp-wrs-loadingContainer .OneUp-wrs-loading{width:300px;height:40px;background-color:rgba(0,0,0,.7);position:relative;margin:auto;bottom:0;padding:10px 15px;box-sizing:border-box}.OneUp-wrs-loadingContainer .OneUp-wrs-loading .OneUp-wrs-loadingSpinner{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";margin-top:10px}.OneUp-wrs-loadingContainer .OneUp-wrs-loading .OneUp-wrs-loadingSpinner .od-LoadingSpinner{overflow:hidden;text-overflow:ellipsis}[dir=ltr] .OneUp-wrs-loadingContainer .OneUp-wrs-loading .OneUp-wrs-loadingSpinner .od-LoadingSpinner-loadingGif{margin-right:5px}[dir=rtl] .OneUp-wrs-loadingContainer .OneUp-wrs-loading .OneUp-wrs-loadingSpinner .od-LoadingSpinner-loadingGif{margin-left:5px}"},{"rawString":".OneUp-wrs-content{position:absolute;width:100%;height:100%;top:0;left:0;right:0}.OneUp-wrs-content .OneUp-wrs-app{position:absolute;width:100%;height:100%;margin:auto}"},{"rawString":".od-OneUpZip-container{margin:auto;margin-top:20px;box-shadow:0 0 7px 2px rgba(0,0,0,.15);display:flex;flex-direction:column;max-width:780px;min-width:70%;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";height:95%}.od-OneUpZip-container .ms-Breadcrumb{margin-bottom:20px}.od-OneUpZip-header{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:130px;display:flex;min-height:130px;justify-content:center;position:relative}.od-OneUpZip-image{height:130px;width:135px}.od-OneUpZip-number{position:absolute;top:83px;font-size:medium;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";width:113px}html[dir=ltr] .od-OneUpZip-number{text-align:right}html[dir=rtl] .od-OneUpZip-number{text-align:left}.od-OneUpZip{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding:0 20px;overflow:auto}.od-OneUpZip .od-Link{cursor:pointer;text-decoration:none;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-OneUpZip .ms-DetailsRow-cell .ms-Link{font-size:12px}.od-OneUpZip .ms-DetailsRow-cell .ms-Link:hover{text-decoration:underline;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-OneUpZip-partial{height:30px;background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";text-align:center;padding:19px 0 9px;font-size:14px}"},{"rawString":".od-ButtonBar{display:block;height:30px}[dir=ltr] .od-ButtonBar .od-Button{margin-right:10px}[dir=rtl] .od-ButtonBar .od-Button{margin-left:10px}[dir=ltr] .od-ButtonBar .od-Button:last-child{margin-right:0}[dir=rtl] .od-ButtonBar .od-Button:last-child{margin-left:0}.od-ButtonBar-main{display:block;height:30px;white-space:nowrap}html[dir=ltr] .od-ButtonBar-main{float:right}html[dir=rtl] .od-ButtonBar-main{float:left}.od-ButtonBarCommand{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .od-ButtonBarCommand{padding:4px 20px 6px 20px}.od-ButtonBarCommand-icon{display:inline-block}.od-ButtonBarCommand-icon .ms-Icon{vertical-align:top}.od-ButtonBarCommand--failed{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}"}]);});