define("dVe",["require","exports","fVe","Ov","lVe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataSyncListStatus=i.DataSyncListStatus;t.DataSyncListStatusError=i.DataSyncListStatusError;t.DataSyncListStatusAttentionReason=i.DataSyncListStatusAttentionReason;var s;(function(e){e[e.Unspecified=0]="Unspecified";e[e.ListQuickEdit=1]="ListQuickEdit"})(t.DataSyncOperationType||(t.DataSyncOperationType={}));t.getDataSyncClient=function(e,t){return r.isDataSyncEnabled(t)?s||(s=new n.NucleusDataSyncClient({aadUserId:e,featureCheck:t})):void 0}});
define("fVe",["require","exports","lC","lVe","_Ve","mVe","pVe","uVe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e){this.getUserPromise=void 0;this._syncNowRequests={};this._listStatusCallbacks={};this._listStatusCallbackCount=0;this._sockets={};this._listNotificationContext={};this.storage=e&&e.storage||new o.NucleusStorage;this.discovery=e&&e.discovery||new s.NucleusDiscovery;this._wsFactory=e&&e.websocketFactory||function(e){return new WebSocket(e)};this._featureCheck=e.featureCheck;this._aadUserId=e.aadUserId}e.prototype.onRequestComplete=function(e){var t=e.httpStatus,n=e.succeeded,r=e.endpoint,i=e.resultCode,s=this._aadUserId,o=r.context;u.log("requestComplete, user "+u.Private(s)+", succeeded: "+n+", status: "+t+" ");n||(o.requestFailed=!0);if("NoConnection"===i||401===t||403===t||404===t){u.log("Forcing refresh, user "+u.Private(s)+", error "+t+" ");o&&(o.shouldRetryLocalRequest=!0);this._resetUserData({url:o.userRoot,authToken:r.authToken});return!1}return!n&&(!t||t>=500&&t<600)};e.prototype.getData=function(e,t,i){var s=n.__assign(n.__assign({},e),{siteId:r.normalizeGuid(e.siteId),listId:r.normalizeGuid(e.listId)});return this._getDataInternal(s,t,i)};e.prototype.getQosInfo=function(){return{dataSyncVersion:"0.1"}};e.prototype.addListStatusCallback=function(e,t){if(!t)throw new Error("not yet supported");this.addListStatusCallbackAsync(e,t);return this._listStatusCallbackCount};e.prototype.addListStatusCallbackAsync=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,u;return n.__generator(this,function(n){switch(n.label){case 0:t=this._normalizeIds(t);i=this._listStatusCallbackCount++;return[4,this._getUser()];case 1:if(!(s=n.sent()))throw new Error("Could not subscribe to list changes, user not found");if(!(o=r.getUserList(t,s)))throw new Error("Could not subscribe to list changes, list not found");u=this._socketIdFromList(o);this._listStatusCallbacks[i]={callback:e,listName:u};this._connectListNotifications(s,o);e([this._listNotificationContext[u]&&this._listNotificationContext[u].lastSentClientState||{id:o,state:r.DataSyncListStatus.InSync,dataRefreshNeeded:!1}]);return[2,i]}})})};e.prototype.removeListStatusCallback=function(e){this._listStatusCallbacks[e]&&delete this._listStatusCallbacks[e]};e.prototype.isListDataSyncEnabled=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:e=this._normalizeIds(e);return[4,this._getUser()];case 1:return[2,!!(t=n.sent())&&!!r.getUserList(e,t)]}})})};e.prototype._getDataInternal=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var s,o,a,f,l,c,h,p,d,v,m;return n.__generator(this,function(n){switch(n.label){case 0:s=new Date;o=e.url,a=e.siteId,f=e.listId,l=e.siteUrl;u.log("getData("+u.logTime(s)+") - Bind: "+(i.isBoundToNucleus()?"nucleus":i.isBound()?"spo":"unbound")+", user: "+u.Private(this._aadUserId)+", url: "+u.Private(o)+", siteId: "+u.Private(a)+", siteUrl: "+u.Private(l)+", listId: "+u.Private(f)+" ");if(!(c=(i.isBoundToNucleus()||!i.isBound())&&this._getOperation(e)))return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);return[4,this._tryCallingLocalEndpoint(c,e,t)];case 2:if(h=n.sent()){if(i.tryBindToNucleus()){u.log("Using local result.Total time "+(Date.now()-s.getTime())+" ms.");return[2,h.result]}u.log("Got local result, but already bound to service.")}else u.log("Could not call local endpoint, trying service.");return[3,4];case 3:p=n.sent();if(i.isBoundToNucleus()){u.logError("Failed nucleus local call");throw p}return[3,4];case 4:u.log("Calling service.");d=new Date;return[4,r()];case 5:v=n.sent();m=new Date;u.log("Service call done after "+(m.getTime()-d.getTime())+" ms.Total request time "+(m.getTime()-s.getTime())+" ms");if(c&&!i.tryBindToService())throw"Error updating service binding.";return[2,v]}})})};e.prototype._tryCallingLocalEndpoint=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,a,f;return n.__generator(this,function(l){switch(l.label){case 0:i=2;s=function(s){var a,f,l,c,h,p,d,v,m;return n.__generator(this,function(n){switch(n.label){case 0:a=new Date;return[4,o._getUserOperationEndpoint(e,t)];case 1:f=n.sent();l=new Date;u.log("Endpoint resolution time: "+(l.getTime()-a.getTime())+" ms");if(!f)return[2,"break"];c=void 0;n.label=2;case 2:n.trys.push([2,4,,5]);h=new Date;u.log("local endpoint call starting at "+u.logTime(h)+".");return[4,r(f)];case 3:p=n.sent();if(!f.context.requestFailed){d=new Date;u.log("Call redirected! elapsed: "+(d.getTime()-h.getTime())+" ms");return[2,{value:{result:p}}]}return[3,5];case 4:v=n.sent();c=v;return[3,5];case 5:m=i-(s+1);if(f.context.shouldRetryLocalRequest&&m>0){u.log("Local call failed. Retrying discovery & request. "+m+" tries remaining.");return[2,"continue"]}u.log("Local call failed, not retrying. Context: "+u.Private(function(){return JSON.stringify(f.context)})+" ");if(c)throw c;return[2,{value:void 0}]}})};o=this;a=0;l.label=1;case 1:return a<i?[5,s(a)]:[3,4];case 2:if("object"==typeof(f=l.sent()))return[2,f.value];if("break"===f)return[3,4];l.label=3;case 3:++a;return[3,1];case 4:return[2]}})})};e.prototype._getNucleusUser=function(e){var t=(e||{}).forceRefresh,n=this.storage;if(!t&&this.getUserPromise)return this.getUserPromise;t&&n.clearNucleusUserData(this._aadUserId);this.getUserPromise=this._getNucleusUserWorker(e);u.log("Started discovery for user: "+u.Private(this._aadUserId)+" ");return this.getUserPromise};e.prototype._getNucleusUserWorker=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,o,a,f,l,c,h,p,d,v,m,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:t=(e||{}).forceRefresh,r=void 0!==t&&t;s=(i=this).storage,o=i.discovery,a=i._aadUserId;u.log("Get nucleus endpoint, user: "+u.Private(a)+", forceRefresh: "+r+" ");if(f=s.getNucleusUserData(a)){if(f.syncedLists.length>0)return[2,f];u.log("Found user, but synced - lists was empty, refreshing")}n.label=1;case 1:n.trys.push([1,3,,4]);return[4,o.refreshNucleusUrl(a)];case 2:l=n.sent();return[3,4];case 3:c=n.sent();u.logError("Failed discovery: "+c);return[3,4];case 4:if(!l){u.log("No Nucleus endpoint was found for this user");return[2,void 0]}u.log("Calling synced-lists endpoint");n.label=5;case 5:n.trys.push([5,7,,8]);return[4,fetch(l.url+"/Sync/Lists",{headers:{Authorization:l.authToken,Accept:"application/json","Content-Type":"application/json"},method:"GET"})];case 6:h=n.sent();return[3,8];case 7:p=n.sent();u.logError("Error calling synced-lists endpoint: "+p);return[2,void 0];case 8:n.trys.push([8,10,,12]);return[4,h.json()];case 9:d=n.sent();u.log("synced - lists resp: "+u.Private(function(){return JSON.stringify(d)})+" ");f={syncedLists:d.d.results,endpoint:l};s.updateNucleusUserData(a,f);return[3,12];case 10:v=n.sent();m=u.logError;g="Error parsing synced - lists JSON: "+v+".";y="Payload was: ";b=u.Private;return[4,h.text()];case 11:m.apply(void 0,[g+(y+b.apply(void 0,[n.sent()])+" ")]);return[2,void 0];case 12:return[2,f]}})})};e.prototype._getOperation=function(e){var t=e.url,i=e.siteId,s=e.listId,o=e.siteUrl;if(!t){if(!o){u.logError("neither URL nor site URL were provided");return}return{operationType:e.operation,ids:{siteId:i,listId:s,siteUrl:o}}}try{var a=r.getListOperationFromUrl(t,this._featureCheck);if(!a||!a.rest)return;a.ids=n.__assign(n.__assign({},a.ids),{siteId:a.ids.siteId||i,listId:a.ids.listId||s,siteUrl:a.ids.siteUrl||o});u.log("Found operation: "+u.Private(function(){return JSON.stringify(a)})+" ");return a}catch(e){u.logError("Failed to parse url with error: "+e);return}};e.prototype._getUser=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,this._getNucleusUser()];case 1:return[2,t.sent()];case 2:e=t.sent();u.logError("Failed to get user information: "+e);return[2,Promise.resolve(void 0)];case 3:return[2]}})})};e.prototype._triggerListSyncNow=function(e,t){var n=t.siteId,r=t.listId;u.log("Sync now: "+u.Private(function(){return JSON.stringify(e.endpoint)})+", List: "+u.Private(r)+", Site: "+u.Private(n));if(r&&n)try{if(this._syncNowRequests[""+(n+r)])u.log("SyncNow already called for this list");else{var i=e.endpoint.url+"/Sync/Sites/"+n+"/Lists/"+r+"/SyncNow";this._syncNowRequests[""+(n+r)]=!0;fetch(i,{headers:{Authorization:e.endpoint.authToken,Accept:"application/json","Content-Type":"application/json"},method:"POST"}).catch(function(e){u.logError("Failed to send syncnow request: "+e)})}}catch(e){u.logError("Failed to send syncnow request: "+e)}};e.prototype._getUserOperationEndpoint=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,a,f,l,c,h;return n.__generator(this,function(n){switch(n.label){case 0:i=t.url,s=t.siteUrl;o=e.rest,a=e.ids;return[4,this._getUser()];case 1:if(!(f=n.sent()))return[2,void 0];if(!a.listId&&!a.listUrl)return[3,5];if(l=r.getUserList(a,f))return[3,4];if(!f.fromStorage)return[3,3];this._resetUserData(f.endpoint);return[4,this._getUser()];case 2:if(!(f=n.sent()))return[2,void 0];n.label=3;case 3:u.log("Found operation, but no synced list.");return[2,void 0];case 4:this._triggerListSyncNow(f,l);n.label=5;case 5:c=new URL(f.endpoint.url);if(o&&i){(h=new URL(i)).pathname=c.pathname+"/SharePoint/_api"+o.api;e.ids.siteUrl&&(h.search=h.search+"&siteUrl="+encodeURIComponent(e.ids.siteUrl))}else{if(!s)return[2,void 0];(h=new URL(s)).pathname=c.pathname+"/SharePoint"+h.pathname}h.protocol="http";h.host=c.host;return[2,{url:h.toString(),authToken:f.endpoint.authToken,context:{userRoot:f.endpoint.url},client:this}]}})})};e.prototype._resetUserData=function(e){var t=this._aadUserId,n=this.storage.getNucleusUserData(t);if(n&&n.endpoint&&n.endpoint.authToken===e.authToken&&n.endpoint.url===e.url){u.log("Resetting user "+u.Private(t)+" ");this.storage.clearNucleusUserData(t);this._shutdownNotifications();delete this.getUserPromise}};e.prototype._shutdownNotifications=function(e){var t=this;if(e)e.forEach(function(e){var n=t._socketIdFromList(e),r=t._sockets[n];if(r){r.close();delete t._sockets[n]}});else{for(var n in this._sockets)if(this._sockets.hasOwnProperty(n)){var r=this._sockets[n];r&&r.close()}this._sockets={}}};e.prototype._socketIdFromList=function(e){return e.siteId+"-"+e.listId};e.prototype._handleListStateChangeMessage=function(e,t){var n=this._socketIdFromList(e);u.log("Got list notification for "+u.Private(function(){return JSON.stringify(e)})+", name: "+n);var i=this._listNotificationContext[n];if(i){var s=JSON.parse(t.data);u.log("Notification: "+u.Private(function(){return JSON.stringify(s)}));var o=s.currentlySyncing?r.DataSyncListStatus.Syncing:s.pendingUploads?r.DataSyncListStatus.ChangesSaved:r.DataSyncListStatus.InSync,a=!i.lastSentClientState||o!==i.lastSentClientState.state;if(a){i.lastSentClientState={id:e,state:o,dataRefreshNeeded:s.refreshNeeded};this._listNotificationContext[n]=i}if(a||s.refreshNeeded){u.log("Notifying listeners of new list state");var f=[{id:e,state:o,dataRefreshNeeded:s.refreshNeeded}];for(var l in this._listStatusCallbacks)if(this._listStatusCallbacks.hasOwnProperty(l)){var c=this._listStatusCallbacks[l];if(c&&c.listName===n)try{c.callback(f)}catch(e){u.logError("Error sending list notification to callback "+n+": "+e)}}}}};e.prototype._handleListStateChangeError=function(e,t){var n=this;u.log("Hit a list websocket error");this._shutdownNotifications([t]);var r=this._socketIdFromList(t);if(this._listNotificationContext[r]&&this._listNotificationContext[r].reconnectAttempts<15){setTimeout(function(){u.log("Attempting to reconnect websocket, attempts: "+n._listNotificationContext[r].reconnectAttempts);n._connectListNotifications(e,t)},4e3)}else u.logError("Not reconnecting websocket because we hit the max reconnection attempts")};e.prototype._connectListNotifications=function(e,t){var n=this;if(!t.listId||!t.siteId)throw new Error("Cannot subscribe without list and site id");var r=this._socketIdFromList(t);if(!this._sockets[r]){u.log("Setting up notifications for "+u.Private(function(){return JSON.stringify(t)}));var i=new URL(e.endpoint.url);i.protocol="ws";i.pathname+="/WebSocket/Sites/"+t.siteId+"/Lists/"+t.listId+"/Notifications";i.search="?authToken="+encodeURIComponent(e.endpoint.webSocketToken);var s=this._wsFactory(i.toString());s.onopen=function(){n._listNotificationContext[r]&&(n._listNotificationContext[r].reconnectAttempts=0)};s.onmessage=function(e){n._handleListStateChangeMessage(t,e)};s.onerror=function(){n._handleListStateChangeError(e,t)};this._listNotificationContext[r]?this._listNotificationContext[r].reconnectAttempts++:this._listNotificationContext[r]={id:t,reconnectAttempts:1};this._sockets[r]=s}};e.prototype._normalizeIds=function(e){return n.__assign(n.__assign({},e),{listId:e.listId&&r.normalizeGuid(e.listId),siteId:e.siteId&&r.normalizeGuid(e.siteId),webId:e.webId&&r.normalizeGuid(e.webId)})};return e})();t.NucleusDataSyncClient=a});
define("lVe",["require","exports","uVe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataSyncListViewApiRedirectionFeature={ODB:1686};t.ignoreDisabledRoutesFlag="sharepoint.datasync.nucleus.ignoreDisabledRoutes";var r,i,s=function(){return!1};0;(function(e){e[e.InSync=1]="InSync";e[e.ChangesSaved=2]="ChangesSaved";e[e.Syncing=3]="Syncing";e[e.Attention=4]="Attention";e[e.SyncConflict=5]="SyncConflict";e[e.SettingUp=6]="SettingUp";e[e.Unsupported=7]="Unsupported";e[e.Removed=8]="Removed";e[e.Error=9]="Error"})(t.DataSyncListStatus||(t.DataSyncListStatus={}));(function(e){e[e.UnknownError=0]="UnknownError"})(t.DataSyncListStatusError||(t.DataSyncListStatusError={}));(function(e){e[e.SetupRequired=0]="SetupRequired";e[e.SignInRequired=1]="SignInRequired"})(t.DataSyncListStatusAttentionReason||(t.DataSyncListStatusAttentionReason={}));(function(e){e[e.List=1]="List";e[e.ListItem=2]="ListItem";e[e.ListView=3]="ListView"})(r||(r={}));(function(e){e[e.Guid=1]="Guid";e[e.Path=2]="Path"})(i||(i={}));var o={api:{recycle:{isLeaf:!0},ValidateUpdateListItem:{isLeaf:!0}}},u={api:{SetViewXml:{isLeaf:!0,flight:t.DataSyncListViewApiRedirectionFeature}}},a={api:{"%self%":{isLeaf:!0,idType:i.Guid,flight:t.DataSyncListViewApiRedirectionFeature,returns:r.ListItem,api:u.api},Add:{isLeaf:!0,flight:t.DataSyncListViewApiRedirectionFeature}}},f={api:{RenderListDataAsStream:{isLeaf:!0},RenderExtendedListFormData:{isLeaf:!0},AddValidateUpdateItemUsingPath:{isLeaf:!0},GetItemById:{returns:r.ListItem,idType:i.Guid,api:o.api},items:{idType:i.Guid,returns:r.ListItem,api:o.api},Views:{isLeaf:!0,api:a.api,flight:t.DataSyncListViewApiRedirectionFeature}}},l={api:{web:{api:{api:{GetList:{returns:r.List,idType:i.Path,api:f.api},GetListUsingPath:{returns:r.List,idType:i.Path,api:f.api},Lists:{api:{"%self%":{returns:r.List,idType:i.Guid,api:f.api},GetListUsingPath:{returns:r.List,idType:i.Path,api:f.api},GetList:{returns:r.List,idType:i.Guid,api:f.api}}}}}.api},"sp.ListHomeItemCollection.GetListHomePersonalLists":{isLeaf:!0},"SP.FavoriteLists.GetListsBy":{isLeaf:!0},"sp.RecentListCollection.GetRecentLists":{isLeaf:!0}}};t.getListOperationFromUrl=function(e,t){var o=new URL(e);n.log("getListOperationFromUrl called for url: "+n.Private(e));var u=o.pathname.indexOf("/_api");if(-1!==u){var a=o.hostname;n.log("server: "+n.Private(a));var f=o.pathname.substring(0,u);if(0!==f.length){var h=o.protocol+"//"+a+f;n.log("site: "+n.Private(h));var p=o.pathname.substring(u+"/_api".length);if(0!==p.length){n.log("api: "+p);var d,v,m,g,y=p.split("/"),b=l,w="root";if(!b.disabled||s()){for(var E=0,S=y;E<S.length;E++){var x=S[E];if(0!==x.length){if(!b.api){n.log("Node "+w+" doesn't have any api when analyzing chunk: "+x);return}var T=x.match(new RegExp("([^\\(]*)(\\((\\w+=)?(\\S*?)\\)|$)"));if(!T){n.log("Regex match failed against chunk: "+x);return}var N=T[1],C=T[4];if(!N||!b.api[N]){n.log("Node "+w+" doesn't have an api matching '"+N+"' from chunk '"+x+"'");return}b=b.api[N];w=N;C&&b.api&&b.api["%self%"]&&(b=b.api["%self%"]);if(b.flight&&!t(b.flight)||b.disabled&&!s()){n.log("Node "+w+" is marked as disabled.");return}if(b.returns===r.List){g=b.returns;if(C){if(d)throw"Found multiple list identifiers in URL";d=C;v=b.idType;n.log("Found list param '"+d+"' in chunk "+x)}}b.isLeaf&&(m?m+="/"+w:m=w)}}if(m){var k=null;if(g)if(d&&void 0!==v){if(!(k=o.searchParams.get(d))){n.log("Found a list operation but couldn't determine the ID. Param name was: "+d);return}}else if(!(k=o.searchParams.get("listFullUrl"))){n.log("Did not find a list or a list operation. This url is not supported");return}var L=v===i.Path&&k?o.protocol+"//"+o.host+decodeURIComponent(k).replace(/'/g,""):void 0;return{ids:{siteUrl:h,listId:v===i.Guid&&k?c(decodeURIComponent(k)):void 0,listUrl:L},rest:{api:p,method:m}}}n.log("Did not find a list method. This url is not supported")}else n.log("All nodes are disabled.")}else n.log("Did not find an api, this url is not supported")}else n.log("Did not find a site, this url is not supported")}else n.log("Did not find the api marker, this url is not supported")};function c(e){return e&&e.replace(/guid/,"").replace(/'/g,"").replace(/}/g,"").replace(/{/g,"").toLowerCase()}t.normalizeGuid=c;t.getUserList=function(e,t){var r=e.siteUrl,i=e.siteId,s=e.listId,o=e.listUrl,u=e.webId,a=t.syncedLists.find(function(e){var t;return(r||i)&&(!r||r===e.siteUrl)&&(!i||c(i)===c(e.siteId))&&(o||s)&&(!s||c(s)===c(e.listId))&&(!o||(null===(t=e.listUrl)||void 0===t?void 0:t.endsWith(o)))&&(!u||c(u)===c(e.webId))});if(a){n.log("Found list: "+n.Private(function(){return JSON.stringify(a)}));return a}}});
define("uVe",["require","exports","Y","be"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataSyncLogging={ODB:1495};t.log=function(e){return i(e)};t.logError=function(e){return i({msg:e,error:!0})};var i=r.default.isFeatureEnabled(t.DataSyncLogging)?function(e){"string"==typeof e?n.default.verbose(e):e.error?n.default.logError(e.msg):n.default.verbose(e.msg)}:function(e){};t.logToConsoleFlag="sharepoint.datasync.nucleus.logToConsole";var s=window.localStorage.getItem(t.logToConsoleFlag),o=!!s&&"TRUE"===s.toUpperCase();o&&(i=function(e){console.log("[nucleus] "+("string"==typeof e?e:e.msg))});t.Private=o?function(e){return e?"function"==typeof e?e().toString():e.toString():"undefined"}:function(e){return"<PRIVATE>"};t.logTime=function(e){return""+(e||new Date).toISOString()}});
define("_Ve",["require","exports","uVe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=void 0;t.canCallNucleus=function(){return!0===r||void 0===r};t.isBound=function(){return void 0!==r};t.isBoundToNucleus=function(){return!0===r};t.tryBindToService=function(){if(void 0===r){n.log("Binding to the SPO service");r=!1}return!r};t.tryBindToNucleus=function(){if(void 0===r){n.log("Binding to the local Nucleus endpoint");r=!0}return r};t.clearNucleusBindingState=function(){n.log("Clearing nucleus bind state");r=void 0}});
define("mVe",["require","exports","Qn","uVe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DiscoveryExtensionMessages={startRefresh:"NUCLEUS_FORCE_REFRESH",refreshComplete:"NUCLEUS_REFRESH_COMPLETE"};var i=(function(){function e(){}e.prototype.refreshNucleusUrl=function(e){r.log("Attempting to discover endpoint for user "+r.Private(e));if(void 0===window.sessionStorage.getItem("nucleus.installed")){r.log("Required plugin was not installed.");return Promise.resolve(void 0)}var i=new n.EventGroup(window);return new Promise(function(n,s){var o=!1,u=new Date;i.on(window,"message",function(e){if(!o&&(function(e){return(!e||e.source===window||null===e.source)&&(e&&e.data&&e.data.type===t.DiscoveryExtensionMessages.refreshComplete)})(e)){i.dispose();o=!0;var s=e.data.messageData;r.log("Got response from plugin: "+r.Private(function(){return JSON.stringify(s)})+" after "+(Date.now()-u.getTime())+"ms");n(s&&s.success&&s.user&&s.endpointData?s.endpointData:void 0)}},!1);var a={type:t.DiscoveryExtensionMessages.startRefresh,messageData:{user:e}};r.log("Posting message to plugin: "+r.Private(function(){return JSON.stringify(a)})+", time: "+(new Date).toISOString());window.postMessage(a,"*");setTimeout(function(){if(!o){o=!0;s("Timed out refreshing endpoint information after waiting 10000ms");i.dispose()}},1e4)})};return e})();t.NucleusDiscovery=i});
define("pVe",["require","exports","lC","uVe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="microsoft.sharepoint.datasync.nucleus",s=function(e){return i+"."+e};t.NUCLEUS_USER_CACHE_EXPIRATION_TIME_MS=72e5;var o=(function(){function e(){}e.prototype.clearNucleusUserData=function(e){r.log("Clearing storage at '"+i+"."+r.Private(e)+"'");sessionStorage.removeItem(s(e));localStorage.removeItem(s(e))};e.prototype.updateNucleusUserData=function(e,t){r.log("Updating storage at '"+i+"."+r.Private(e)+"'. Data: "+r.Private(function(){return JSON.stringify(t)}));var o=n.__assign(n.__assign({},t),{fromStorage:!0,lastUpdate:t.lastUpdate||Date.now()});sessionStorage.setItem(s(e),JSON.stringify(o));localStorage.setItem(s(e),JSON.stringify(o))};e.prototype.getNucleusUserData=function(e){var n=sessionStorage.getItem(s(e));n||(n=localStorage.getItem(s(e)))&&sessionStorage.setItem(s(e),n);if(n)try{var o=JSON.parse(n);r.log("Retrieved from storage at '"+i+"."+r.Private(e)+"'. Data: "+r.Private(function(){return JSON.stringify(o)}));if(!o.lastUpdate||o.lastUpdate+t.NUCLEUS_USER_CACHE_EXPIRATION_TIME_MS<Date.now()){r.log("User expired");this.clearNucleusUserData(e);return}return o}catch(t){r.log("Error: got bad json at '"+i+"."+r.Private(e)+"'. Data: "+r.Private(n));return}else r.log("Storage at '"+i+"."+r.Private(e)+"' had no user information, either session or local")};return e})();t.NucleusStorage=o});
define("VA",["require","exports","lC","Hm","ih","m1","RT","U1","Sg","d0","hp","li","_P","YM","pM","fM","uM","lM","nM","tM","$k","Xk","$1","Wk","AA","Kk","Ok","r6","Ck","yk","l0","$m","qL","my","WL","GL","TL","VS","yL","vL","hL","E1","mL","pL","lL","cL","l6","l6","l6","HS","ii","Io","CS","aL","nL","tL","B6","R6","eL","D0","ZA","J7","zA"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spProjectedUploadedItemSetAddon=ie.spProjectedUploadedItemSetAddon;t.SpAddonDeferred=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(k.removeFromOneDriveAddon);e(j.sharePointNewAndUploadAddon);e(K.sharePointSyncAddon);e(h.spDataOnlyAddonDeferred);if(e(G.readConfiguration({enablePltCommands:Q.enablePltCommandsConfigurationFacet})).enablePltCommands)e(i.registerControlHandler(c.spItemKeyFacet,Y.deferredItemsCommandBarControl)(p.deferredItemsCommandBarControlerHandler));else{e(i.registerControlHandler(c.spItemKeyFacet,a.itemsCommandBarControl)(p.itemsCommandBarControlerHandler));e(i.registerControlHandler(c.spItemKeyFacet,ne.addToOneDriveActionControl)(re.addToOneDriveActionControlHandler))}e(i.registerControlHandler(c.spItemKeyFacet,f.itemsContextMenuControl)(d.itemsContextMenuControlerHandler));e(i.registerControlHandler(c.spItemGroupKeyFacet,u.openActionControl)(v.openGroupControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,o.itemsBreadcrumbControl)(g.itemsBreadcrumbControlerHandler));e(i.registerControlHandler(c.spItemGroupKeyFacet,l.defaultDropActionControl)(y.defaultDropActionControlHandler));e(i.registerControlHandler(c.spItemGroupKeyFacet,s.uploadItemsActionControl)(b.uploadItemsToGroupActionControlHandler));e(Z.sharePointWebItemTileAddon);e(r.registerOperationHandler(c.spContentTypeCreateDocumentActionKeyFacet,S.getItemsOperation)(w.getContentTypeCreateDocumentActionItemOperationHandler));e(r.registerOperationHandler(c.spContentTypeNavigationActionKeyFacet,S.getItemsOperation)(E.getContentTypeNavigationActionItemOperationHandler));e(r.registerOperationHandler(c.spPeoplePickerDataSourceKeyFacet,S.getItemsOperation)(x.spPeoplePickerDataSourceGetItemsOperationHandler));e(r.registerOperationHandler(c.spListKeyFacet,T.saveUploadedTemplateToViewOperation)(C.saveUploadedTemplateToView));e(r.registerOperationHandler(c.spListKeyFacet,N.saveTemplatesToViewOperation)(L.saveTemplatesToView));e(i.registerControlHandler(c.spFolderItemSetKeyFacet,O.itemSetTilesListControl)(A.spFolderItemSetTilesListControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,M.sharingCalloutControl)(_.sharingCalloutControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,D.hoverCardCommandsControl)(H.hoverCardCommandsControlHandler));e(i.registerControlHandler(V.sharedByMeRootItemKeyFacet,a.itemsCommandBarControl)(F.sharedByMeCommandBarControlHandler));e(i.registerControlHandler($.sharedByMeItemSetKeyFacet,R.itemSetColumnsControl)(q.sharedByMeRootItemSetColumnsControlHandler));e(i.registerControlHandler(V.sharedByMeRootItemKeyFacet,f.itemsContextMenuControl)(I.sharedByMeContextMenuControlHandler));e(r.registerOperationHandler(V.sharedByMeRootItemKeyFacet,S.getItemsOperation)(U.sharedByMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler($.sharedByMeItemSetKeyFacet,S.getItemsOperation)(z.sharedByMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(J.sharedByMePageKeyFacet,S.getItemsOperation)(W.sharedByMePageGetItemsOperationHandler));e(r.registerOperationHandler(ue.spItemPlacesSetKeyFacet,S.getItemsOperation)(ae.spItemPlacesSetGetItemsOperationHandler));e(i.registerControlHandler(c.spWebKeyFacet,u.openActionControl)(m.webOpenActionControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,P.hoverCardLifeCycleStatusControl)(B.spHoverCardLifeCycleStatusControlHandler));e(r.registerOperationHandler(c.spProjectedUploadedItemSetKeyFacet,S.getItemsOperation)(X.spProjectedUploadedItemSetGetItemsOperationHandler));e(i.registerControlHandler(c.spFolderByIdKeyFacet,se.itemErrorControl)(oe.spFolderByIdErrorControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,ee.removeFromSharedActionListControl)(te.removeFromSharedListControlHandler));return[2]})})}})});
define("RT",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsBreadcrumbControl=new n.ControlFacet("itemsBreadcrumbControl")});
define("_P",["require","exports","lC","Hm","YS","$1","JS","li","HT","FT","zL","UT","TT","oM","oP","Gk","PT","MT","kT","ih","E4","LT","gI","zD","ET","wT","OT","CT","xT","IT","vT","gT","bT","hT","_T","mT","fT","uT","dT","cT","sT","oT","nT","tT","eT","$P","XP","QP","qP","WP","KP","GP","gA","zP","jL","jP","BP","RP","DL","HP","kL","FP","UP","TP","wM","MP","EA","jA","BA","qS","kP","LP","gP","hP"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPFilterOptionSetHandler=O.getSPFilterOptionSetHandler;t.spItemUploadItemsOperationHandler=he.spItemUploadItemsOperationHandler;t.spItemCreateFolderOperationHandler=pe.spItemCreateFolderOperationHandler;t.spItemCreateDocumentOperationHandler=de.spItemCreateDocumentOperationHandler;t.spDataOnlyAddonDeferred=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(r.registerOperationHandler(u.spNeedsAttentionItemKeyFacet,s.getItemsOperation)(A.getNeedsAttentionFlagOperationHandler));e(r.registerOperationHandler(u.spItemKeyFacet,f.updateCheckoutStateOperation)(M.updateCheckoutState));e(r.registerOperationHandler(u.spItemKeyFacet,l.updatePublishStateOperation)(_.publishItem));e(r.registerOperationHandler(u.spItemKeyFacet,c.updateItemRatingOperation)(D.updateItemRating));e(r.registerOperationHandler(u.spItemKeyFacet,h.updateItemLikesOperation)(P.updateItemLikes));e(ye.sharePointBasicActionsAddonDeferred);e(r.registerOperationHandler(u.spItemKeyFacet,o.createCustomDocumentOperation)(H.createCustomDocument));e(r.registerOperationHandler(u.spPinnedItemSetKeyFacet,a.editPinnedItemOperation)(B.editPinnedItem));e(r.registerOperationHandler(u.spItemKeyFacet,p.assignItemToGroupOperation)(K.assignItemsToGroup));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,m.createViewOperation)(j.createView));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,g.createFreshViewOperation)(F.createFreshView));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,y.updateViewOperation)(I.updateView));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,d.modifyViewOperation)(q.modifyView));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,v.saveViewCoreOperation)(U.saveViewCoreOperationHandler));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,w.modifyColumnOperation)(z.modifyColumn));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,fe.modifyColumnAggregateTypeOperation)(ae.modifyColumnAggregateType));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,E.updateColumnFormatterOperation)(W.updateColumnFormatter));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,ee.refreshItemsInSetOperation)(te.refreshItemsInSet));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,le.bulkUpdateListItemsOperation)(ce.bulkUpdateListItems));e(r.registerOperationHandler(u.spItemGroupKeyFacet,i.uploadItemsOperation)(X.uploadItemsToGroupOperationHandler));e(r.registerOperationHandler(u.likedByItemKeyFacet,s.getItemsOperation)(R.likedByPeopleOperationHandler));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,s.getItemsOperation)(V.getViewsItemOperationHandler));e(r.registerOperationHandler(u.customActionSetKeyFacet,s.getItemsOperation)($.getCustomActionsOperationHandler));e(r.registerOperationHandler(u.customActionSetWithExtensionsKeyFacet,s.getItemsOperation)($.getCustomActionSetWithExtensionsOperationHandler));e(r.registerOperationHandler(u.spWebPageContextKeyFacet,s.getItemsOperation)(J.spWebPageContextGetItemsOperationHandler));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,N.updateCustomFormatterOperation)(C.updateCustomFormatter));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,k.modifyFieldPropertiesOperation)(L.modifyFieldProperties));e(b.registerControlHandler(u.spItemKeyFacet,ie.fileHandlerActionControlFacet)(se.fileHandlerActionControlHandler));e(b.registerControlHandler(u.spItemKeyFacet,oe.getDriveItemFullUrlControlFacet)(ue.getDriveItemFullUrlControlHandler));e(be.sharePointBasicItemDataAddonDeferred);e(ve.sharePointNewAndUploadAddonDataOnly);e(S.sharePointHomeAddonDataOnly);e(x.sharePointOneDriveAddonDataOnly);e(T.sharePointTenantAddon);e(b.registerControlHandler(u.spItemKeyFacet,Q.shareLinkActionControl)(G.defaultShareLinkControlHandler));e(r.registerOperationHandler(u.spItemKeyFacet,Y.updateListItemOperation)(Z.updateListItem));e(b.registerControlHandler(u.spItemKeyFacet,ne.permissionInviteActionControl)(re.permissionInviteControlHandler));e(r.registerOperationHandler(u.spItemKeyFacet,me.removeItemsFromSharedListOperation)(ge.spItemRemoveItemsFromSharedListOperationHandler));return[2]})})}})});
define("HT",["require","exports","si","ko","jm","fi"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editPinnedItemOperation=new n.Facet("editPinnedItem");t.editPinnedItemProgressItemKeyFacet=new s.KeyFacet("editPinnedItemProgressItem",{itemKey:s.stringPart(),editType:s.numberPart()});t.editPinnedItemProgressKeyFacet=new i.ProgressKeyFacet("editPinnedItemProgress",function(e,n){var r=Object.keys(n.itemEditTypeMap)[0],i=n.itemEditTypeMap[r].editType;return t.editPinnedItemProgressItemKeyFacet.serialize({itemKey:r,editType:i})});t.editPinnedItem=r.implementOperation({operationTypeFacet:t.editPinnedItemOperation})});
define("FT",["require","exports","si","jm"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateCheckoutStateOperation=new n.Facet("updateCheckoutState");t.checkoutProgressKeyFacet=new r.ProgressKeyFacet("checkout");t.updateCheckoutState=r.implementOperationWithProgress({operationTypeFacet:t.updateCheckoutStateOperation,progressKeyFacet:t.checkoutProgressKeyFacet})});
define("zL",["require","exports","si","jm"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updatePublishStateOperation=new n.Facet("updatePublishState");t.publishProgressKeyFacet=new r.ProgressKeyFacet("publish")});
define("UT",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemRatingOperation=new n.Facet("updateItemRating");t.updateItemRating=r.implementOperation({operationTypeFacet:t.updateItemRatingOperation})});
define("TT",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemLikesOperation=new n.Facet("updateItemLikes");t.updateItemLikes=r.implementOperation({operationTypeFacet:t.updateItemLikesOperation})});
define("oM",["require","exports","si","jm"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.assignItemToGroupOperation=new n.Facet("assignItemToGroup");t.assignToGroupProgressKeyFacet=new r.ProgressKeyFacet("assignToGroup")});
define("oP",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyViewOperation=new n.Facet("modifyView");t.modifyView=r.implementOperation({operationTypeFacet:t.modifyViewOperation})});
define("PT",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createViewOperation=new n.Facet("createView");t.createView=r.implementOperation({operationTypeFacet:t.createViewOperation})});
define("MT",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFreshViewOperation=new n.Facet("createFreshView");t.createFreshView=r.implementOperation({operationTypeFacet:t.createFreshViewOperation})});
define("kT",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateViewOperation=new n.Facet("updateView");t.updateView=r.implementOperation({operationTypeFacet:t.updateViewOperation})});
define("LT",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.preview=0]="preview";e[e.save=1]="save"})(t.ColumnFormatterUpdateType||(t.ColumnFormatterUpdateType={}));t.updateColumnFormatterOperation=new n.Facet("updateColumnFormatter");t.updateColumnFormatter=r.implementOperation({operationTypeFacet:t.updateColumnFormatterOperation})});
define("gI",["require","exports","lC","Hm","$1","li","Rs","Xo","CI","xI","DI","SI","yI","t4","H8","vI","ih"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=p.forModuleExport(p.asModuleWithRetries(function(){return new Promise(function(t,n){e(["gH"],t,n)})},{chunkName:"addon-sharepointhome-deferred"}),"getSPFollowedSitesItemSet");t.sharePointHomeAddonDataOnly=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(i.supportFacets({keyFacet:s.spWebKeyFacet,facets:[o.displayNameFacet,u.defaultChildItemSetFacet]}));e(i.supportFacets({keyFacet:s.spFollowedSitesItemSetKeyFacet,facets:[s.spFollowedSitesItemSetKeyFacet,u.childItemsFacet]}));e(i.supportFacets({keyFacet:s.spFrequentSitesItemSetKeyFacet,facets:[s.spFrequentSitesItemSetKeyFacet,u.childItemsFacet]}));e(i.supportFacets({keyFacet:s.spLibrariesItemSetKeyFacet,facets:[s.spLibrariesItemSetKeyFacet,u.childItemsFacet,u.defaultChildItemSetFacet]}));e(r.registerOperationHandler(s.spHomeContextKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:4})(a.getSPHomeContext)));e(r.registerOperationHandler(s.spAllSitesKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler()(f.getSPAllSites)));e(r.registerOperationHandler(s.spFrequentSitesItemSetKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler()(l.getSPFrequentSitesItemSet)));e(r.registerOperationHandler(s.spWebKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:4})(c.getSPWeb)));e(r.registerOperationHandler(s.spLibrariesItemSetKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:8})(h.getSPLibrariesItemSet)));e(m.registerControlHandler(s.spLibrariesItemSetKeyFacet,d.filteredItemSetControl)(v.spLibrariesItemSetFilteredItemSetControlHandler));e(r.registerOperationHandler(s.spFollowedSitesItemSetKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(g)));return[2]})})}})});
define("CI",["require","exports","lC","li","ii","KD","Vm"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPHomeContext=function(e){var t=this;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,a,f,l;return n.__generator(this,function(c){switch(c.label){case 0:t=r.spHomeContextKeyFacet.deserialize(e.itemKey).tenantRootUrl;a=new o.ItemResolver;return[4,u(s.getSPHomeContextData({tenantRootUrl:t}))];case 1:f=c.sent();a.resolveItems({items:(l={},l[e.itemKey]=n.__assign(n.__assign({},i.spHomeResourceFacet.pack(f.resource)),i.spHomePayloadHeaderFacet.pack(f.payloadHeader)),l)});u(a.execute());return[2]}})})}}});
define("KD",["require","exports","lC","xv","Io","A8","Rm","X","ii","Ev","Av","WD"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function h(e){return function(t){var n=t(i.readConfiguration({spHomeDataSourceConfiguration:a.spHomeDataSourceConfigurationFacet})).spHomeDataSourceConfiguration,s=n&&n.contextAcquiresAuthToken;return t(r.getDataWithCache({webAbsoluteUrl:e.tenantRootUrl,listFullUrl:e.tenantRootUrl,method:"GET",url:d(e),qosName:"getSPHomeContext",parseResponse:function(e){var t=JSON.parse(e).d;return{payloadHeader:t.Payload,resource:t.Urls&&t.Urls.results&&t.Urls.results.length>0&&t.Urls.results[0]||"",accessToken:t.Token&&t.Token.access_token||""}},noRedirect:!0,skipAuth:s,crossSiteCollectionCall:s,needsRequestDigest:!s,ignoreDiskCacheWhenOnline:!0}))}}t.getSPHomeContextData=h;function p(e,t,r){var s=this;void 0===r&&(r=8);return function(o){return n.__awaiter(s,void 0,void 0,function(){var s,u,f,l,c,p;return n.__generator(this,function(n){switch(n.label){case 0:s=o(i.readConfiguration({spFrequentSitesConfiguration:a.spFrequentSitesExternalDataConfigurationFacet,enableFilesWeightedFrequentSitesConfiguration:a.enableFilesWeightedFrequentSitesConfigurationFacet})),u=s.spFrequentSitesConfiguration,f=s.enableFilesWeightedFrequentSitesConfiguration;return u&&u.getExternalData?[4,u.getExternalData()]:[3,2];case 1:if(l=n.sent())return[2,l];n.label=2;case 2:return!t&&u&&u.getCacheContext?[4,u.getCacheContext()]:[3,4];case 3:(c=n.sent())&&(t=JSON.stringify(c));n.label=4;case 4:return[4,o(h({tenantRootUrl:e}))];case 5:p=n.sent();return[2,o(v({path:"api/v1/sites/feed?acronyms=true&start=0&count="+r,method:"GET",qosName:"getSPHomeFrequentSites",context:p,clientType:f?"ODBWeb":void 0,cacheContext:t}))]}})})}}t.getSPHomeFrequentSitesData=p;t.getSPHomeFollowedSitesData=function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,s,o;return n.__generator(this,function(n){switch(n.label){case 0:return(t=r(i.readConfiguration({spFollowedSitesConfiguration:a.spFollowedSitesExternalDataConfigurationFacet})).spFollowedSitesConfiguration)&&t.getExternalData?[4,t.getExternalData()]:[3,2];case 1:if(s=n.sent())return[2,s];n.label=2;case 2:return[4,r(h({tenantRootUrl:e}))];case 3:o=n.sent();return[2,r(v({path:"api/v1/sites/followed?acronyms=true&fillsitedata=true&mostRecentFirst=true&start=0&count=36",method:"GET",qosName:"getSPHomeFollowedSites",context:o}))]}})})}};function d(e){var t=e.tenantRootUrl;return s.getStaticApiUrl({webAbsoluteUrl:t}).segment("sphomeservice").segment("context").oDataParameter("$expand","Token,Payload").toString()}function v(e){var t=this,i=e.method,s=e.path,a=e.context,c=e.qosName,h=e.clientType,p=e.contentType,d=void 0===p?"application/json;odata=verbose":p,v=e.body,m=e.cacheContext,g=c?"getData."+c:"getData";return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,p,y,b,w,E,S,x,T=this;return n.__generator(this,function(N){switch(N.label){case 0:t=new Headers;return(p=a.accessToken)?[3,2]:[4,e(r.getAuthToken({url:a.resource}))];case 1:p=N.sent();N.label=2;case 2:(c=p)&&t.set("Authorization","Bearer "+c);a.payloadHeader&&t.set("SPHome-ApiContext",a.payloadHeader);m&&t.set("SPHome-CacheContext",m);t.set("SPHome-ClientType",h||"ODSPDocLibsWeb");t.set("Content-Type",d);y={headers:t,credentials:"omit",method:i,mode:"cors",cache:"default",body:v};b=e(o.logQoS({name:g}));w=a.resource+"/"+s+"__"+i;return[4,e(f.getJSONResponse(w))];case 3:E=N.sent();S=fetch(a.resource+"/"+s,y).then(function(t){return n.__awaiter(T,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:if(!t.ok)return[3,2];e(b({resultType:u.ResultTypeEnum.Success}));return 204===t.status?[2,{}]:[4,t.json()];case 1:r=n.sent();e(f.setJSONResponse(w,r));return[2,r];case 2:throw new l.ApiError({code:""+t.status,message:t.statusText})}})})}).catch(function(t){e(b({resultType:u.ResultTypeEnum.Failure,resultCode:t instanceof l.ApiError?t.code:t.name,error:t&&JSON.stringify(t)}));throw t});return(x=E)?[3,5]:[4,S];case 4:x=N.sent();N.label=5;case 5:return[2,x]}})})}}t.getData=v;t.updateCachedFrequentSitesWithContext=function(e){var t=e.tenantRootUrl,n=e.cacheContext;return function(e){var r=e(i.readConfiguration({enableSitePinningConfiguration:a.enableSitePinningConfigurationFacet})).enableSitePinningConfiguration?c.MAX_PINNED_FREQUENTSITES_COUNT:c.DEFAULT_LEFT_NAV_SITE_COUNT;e(p(t,n,r))}}});
define("WD",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MAX_PINNED_FREQUENTSITES_COUNT=50;t.DEFAULT_LEFT_NAV_SITE_COUNT=8;t.MIN_NONPINNED_FREQUENT_SITE_COUNT=2});
define("xI",["require","exports","lC","Rs","Jf","II","li","ii","Xo","Vm","m2"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPAllSites=function(e){var t=this;return function(c){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,m;return n.__generator(this,function(g){t=o.spAllSitesKeyFacet.deserialize(e.itemKey).tenantRootUrl;h=new f.ItemResolver;p=o.spFrequentSitesItemSetKeyFacet.serialize({tenantRootUrl:t});d=o.spFollowedSitesItemSetKeyFacet.serialize({tenantRootUrl:t});v=[p,d];h.resolveItems({items:(m={},m[p]=n.__assign(n.__assign(n.__assign({},i.isGroupFacet.pack(!0)),r.displayNameFacet.pack(s.default.frequent)),u.parentGroupKeyFacet.pack({itemKey:e.itemKey})),m[d]=n.__assign(n.__assign(n.__assign({},i.isGroupFacet.pack(!0)),r.displayNameFacet.pack(s.default.followed)),u.parentGroupKeyFacet.pack({itemKey:e.itemKey})),m[e.itemKey]=n.__assign(n.__assign(n.__assign({},r.displayNameFacet.pack(l.default.SharedLibrariesHeader)),i.isGroupFacet.pack(!0)),a.childItemsFacet.pack({itemKeys:v})),m)});c(h.execute());return[2]})})}}});
define("DI",["require","exports","lC","Rs","li","II","Xo","KD","ii","WD","Vm","zm","Io"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPFrequentSitesItemSet=function(e){var t=this;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,f,h,d,v,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:t=i.spFrequentSitesItemSetKeyFacet.deserialize(e.itemKey).tenantRootUrl;f=new l.ItemResolver;return[4,u(p(t))];case 1:h=b.sent();d=[];v=i.spAllSitesKeyFacet.serialize({tenantRootUrl:t});m=void 0;g=void 0;h&&h.Items&&h.Items.forEach(function(t,s){var u,l=i.spWebKeyFacet.serialize({webAbsoluteUrl:t.Url}),p=i.spLibrariesItemSetKeyFacet.serialize({webAbsoluteUrl:t.Url}),y=t.ItemReference||{},b=y.SiteId,w=void 0===b?void 0:b,E=y.WebId,S=void 0===E?void 0:E,x=y.GroupId,T=void 0===x?void 0:x,N=i.pinnedItemKeyFacet.serialize({rootItemKey:v,itemKey:l});m=h.Items[s-1]&&h.Items[s-1].PinOrder;g=h.Items[s+1]&&h.Items[s+1].PinOrder;f.resolveItems({items:(u={},u[l]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},r.displayNameFacet.pack(t.Title)),a.acronymFacet.pack(t.Acronym)),a.bannerColorFacet.pack(t.BannerColor)),a.bannerImageUrlFacet.pack(t.BannerImageUrl)),a.isSiteFacet.pack(!0)),r.folderFacet.pack({})),a.siteWeightageFacet.pack(t.Weight)),i.spWebKeyFacet.pack({webAbsoluteUrl:t.Url})),a.siteIdFacet.pack(w)),a.webIdFacet.pack(S)),a.groupIdFacet.pack(T)),o.defaultChildItemSetFacet.pack({itemKey:p})),u[N]=n.__assign(n.__assign(n.__assign(n.__assign({},a.prevPinOrderFacet.pack(m)),a.pinOrderFacet.pack(t.PinOrder)),a.nextPinOrderFacet.pack(g)),c.getInvalidationFacet().forFacet(a.pinOrderFacet).thenInvalidate(e.itemKey,o.childItemsFacet).pack()),u[p]=n.__assign({},o.parentItemFacet.pack({itemKey:l})),u)});d.push(l)});f.resolveItems({items:(y={},y[e.itemKey]=n.__assign(n.__assign(n.__assign({},r.displayNameFacet.pack(s.default.frequent)),o.childItemsFacet.pack({itemKeys:d})),a.parentGroupKeyFacet.pack({itemKey:v})),y)});u(f.execute());return[2]}})})}};function p(t){var r=this;return function(i){return n.__awaiter(r,void 0,void 0,function(){var r,s,o,l;return n.__generator(this,function(n){switch(n.label){case 0:r=i(h.readConfiguration({enableSitePinningConfiguration:a.enableSitePinningConfigurationFacet,enableSPHomeServiceConfiguration:a.enableSPHomeServiceConfigurationFacet})),s=r.enableSitePinningConfiguration;return!1!==r.enableSPHomeServiceConfiguration?[3,3]:[4,new Promise(function(t,n){e(["Fz"],t,n)})];case 1:o=n.sent().getFrequentSitesData;return[4,i(o(t))];case 2:return[2,n.sent()];case 3:l=s?f.MAX_PINNED_FREQUENTSITES_COUNT:f.DEFAULT_LEFT_NAV_SITE_COUNT;return[4,i(u.getSPHomeFrequentSitesData(t,void 0,l))];case 4:return[2,n.sent()]}})})}}});
define("SI",["require","exports","lC","li","Xo","Vm"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPWeb=function(e){var t=this;return function(o){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,f;return n.__generator(this,function(l){t=r.spWebKeyFacet.deserialize(e.itemKey).webAbsoluteUrl;u=new s.ItemResolver;a=r.spLibrariesItemSetKeyFacet.serialize({webAbsoluteUrl:t});u.resolveItems({items:(f={},f[e.itemKey]=n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:a})),f)});o(u.execute());return[2]})})}}});
define("yI",["require","exports","lC","Rs","li","Xo","Vm","Me","zm","Ev","E8","Io","Se","ii","A8","xv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function m(e){var t=e.webAbsoluteUrl,n=e.isMediaQuery;return function(e){var r=e(c.readConfiguration({spHostPageWebAbsoluteUrl:p.spHostPageWebAbsoluteUrlConfigurationFacet,spSitesListsDataWebAbsoluteUrl:p.spSitesListsDataWebAbsoluteUrlConfigurationFacet})),i=r.spHostPageWebAbsoluteUrl,s=r.spSitesListsDataWebAbsoluteUrl,o=new h.default(t).authority,u=i||s,a=u&&new h.default(u).authority,f=n&&o===a,l=d.getStaticApiUrl({webAbsoluteUrl:a||o}).segment(f?"SP.Web.GetDocumentAndMediaLibaries":"SP.Web.GetDocumentLibraries").parameter("webFullUrl",t);return e(v.getDataWithCache({webAbsoluteUrl:a||o,method:"POST",url:l.toString(),qosName:f?"getDocumentAndMediaLibraries":"getDocumentLibraries",noRedirect:!0}))}}t.getSPLibrariesItemSet=function(e){var t=this;return function(c){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,g,y,b,w,E,S,x,T,N,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:t=i.spLibrariesItemSetKeyFacet.deserialize(e.itemKey),h=t.webAbsoluteUrl,p=t.types;d=i.spWebKeyFacet.serialize({webAbsoluteUrl:h});v=new o.ItemResolver;return[4,c(m({webAbsoluteUrl:h,isMediaQuery:!!p&&p.indexOf("media")>-1}))];case 1:g=A.sent();y=[];for(b=0,w=g.d.GetDocumentLibraries.results;b<w.length;b++){E=w[b];S=new u.ItemUrlHelperBasic({context:{webAbsoluteUrl:h}});x=S.getUrlParts({webUrl:h,listUrl:E.AbsoluteUrl,path:E.AbsoluteUrl});T={webAbsoluteUrl:h,listFullUrl:x.fullListUrl||"",rootFolder:""};N=i.spItemKeyFacet.serialize(T);C=i.spFolderItemSetKeyFacet.serialize({webAbsoluteUrl:h,listFullUrl:x.fullListUrl||"",rootFolder:""});v.merge(c(l.processSpFolderItemWithoutListRow({itemKey:N,spItem:T})).itemResolver);v.resolveItems({items:(k={},k[N]=n.__assign({},r.displayNameFacet.pack(E.Title)),k[C]=n.__assign({},s.parentItemFacet.pack({itemKey:N})),k)});y.push(N)}v.resolveItems({items:(L={},L[e.itemKey]=n.__assign(n.__assign(n.__assign(n.__assign({},s.childItemsFacet.pack({itemKeys:y})),a.getInvalidationFacet().forFacet(s.childItemsFacet).thenInvalidate(f.clearCacheIfNotOffline).pack()),i.spWebKeyFacet.pack({webAbsoluteUrl:h})),s.parentItemFacet.pack({itemKey:d})),L)});c(v.execute());return[2]}})})}}});
define("vI",["require","exports","lC","li","ih","U8"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spLibrariesItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var i=t.itemKey,o=t.handlers,u=e.demandItemFacet(r.spLibrariesItemSetKeyFacet,i);if(o&&u){for(var a=[],f=0,l=o;f<l.length;f++){var c=l[f];".JPEG"===s.getExtensionFilterFromFilterHandler(c)&&a.push("media")}return a.length<1?{}:{itemKey:r.spLibrariesItemSetKeyFacet.serialize(n.__assign(n.__assign({},u),{types:a}))}}return{}}}})});
define("zD",["require","exports","lC","Hm","li","$1","XD","qD","GD","i2","C8"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointOneDriveAddonDataOnly=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(l.sharePointOneDriveLibraryAddon);e(r.registerOperationHandler(i.businessNavSetKeyFacet,s.getItemsOperation)(o.getBusinessNavSet));e(r.registerOperationHandler(i.oneDriveNavSetKeyFacet,s.getItemsOperation)(u.getOneDriveNavSet));e(r.registerOperationHandler(i.spAllSitesKeyFacet,f.pinSiteOperation)(a.spAllSitesPinSiteOperationHandler));return[2]})})}})});
define("XD",["require","exports","lC","Hm","Vm","li","Xo"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getBusinessNavSet=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,u=s.businessNavSetKeyFacet.deserialize(r).tenantRootUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a;return n.__generator(this,function(f){(t=new i.ItemResolver).resolveItems({items:(a={},a[r]=n.__assign({},o.childItemsFacet.pack({itemKeys:[s.oneDriveNavSetKeyFacet.serialize({tenantRootUrl:u}),s.spAllSitesKeyFacet.serialize({tenantRootUrl:u})]})),a)});e(t.execute());return[2]})})}})});
define("qD",["require","exports","lC","YD","rs","Hm","Vm","oi","So","li","ii","Xo","Rs","QD","Y3","Q3","CD","n7","ri"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOneDriveNavSet=s.createSingleItemOperationHandler()(function(e){var t=this,s=e.itemKey,b=f.oneDriveNavSetKeyFacet.deserialize(s).tenantRootUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I;return n.__generator(this,function(q){switch(q.label){case 0:t=new o.ItemResolver;return[4,e(r.demandItems(function(e){var t=f.spOneDriveDocumentLibraryKeyFacet.serialize({tenantRootUrl:b});return e.demandItemFacet(f.spItemKeyFacet,t,{suppressGetItems:!1})}))];case 1:return(w=q.sent())?[4,e(r.demandItems(function(e){return e.demandItemFacet(l.spPageContextFacet,f.spPageContextKeyFacet.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl}))}))]:[2];case 2:E=q.sent();S=e(i.readItems(function(e){return{isSavedForLaterEnabled:e.demandItemFacet(a.enableFollowItemConfigurationFacet,a.configurationItemKey),isSharedWithMeEnabled:!!e.demandItemFacet(y.graphSharedWithMeEndpointConfigurationFacet,a.configurationItemKey)}})),x=S.isSavedForLaterEnabled,T=S.isSharedWithMeEnabled;N={};C=E&&E.userDisplayName;k=f.spItemKeyFacet.serialize(w);N[k]={icon:"FabricFolder",displayName:g.default.files};L=d.recentRootItemKeyFacet.serialize({endpoint:b+"/_api/v2.0"});N[L]={icon:"History",displayName:p.default.recentTitle};A=v.savedForLaterRootItemKeyFacet.serialize({endpoint:b+"/_api/v2.0"});N[A]={icon:"SingleBookmark",displayName:p.default.saved};O=m.sharedWithMeRootItemKeyFacet.serialize({endpoint:""+b});N[O]={icon:"People",displayName:p.default.sharedWithMe};M=n.__spreadArrays([k,L],T?[O]:[],x?[A]:[]);for(_=0,D=M;_<D.length;_++){P=D[_];H=N[P],B=H.icon,j=H.displayName;t.resolveItems({items:(F={},F[P]=n.__assign(n.__assign(n.__assign({},u.iconFacet.pack(B)),h.displayNameFacet.pack(j)),h.folderFacet.pack({})),F)})}t.resolveItems({items:(I={},I[s]=n.__assign(n.__assign({},c.childItemsFacet.pack({itemKeys:M})),h.displayNameFacet.pack(C)),I)});e(t.execute());return[2]}})})}})});
define("YD",["require","exports","lC","JD","nv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.demandItems=function e(t,s){var o=this;void 0===s&&(s={});var u=s.cancelToken,a=s.flushOperationQueue,f=s.timeout,l=void 0===f?1/0:f,c=s.contextualControlHandlers;return function(s){return n.__awaiter(o,void 0,void 0,function(){var o,f,h;return n.__generator(this,function(n){switch(n.label){case 0:f={operation:e};h=i.createTimeoutCancelSource({timeout:l,errorProps:{message:"Timeout demanding items"}},u);n.label=1;case 1:n.trys.push([1,,3,4]);return[4,s(r.observeItemsUntilResolved(t,function(e){o={result:e}},{cancelToken:h.token,flushOperationQueue:a,contextualControlHandlers:c,owner:f}))];case 2:n.sent();return[3,4];case 3:h.dispose();return[7];case 4:if(!o)throw new Error("No result.");return[2,o.result]}})})}}});
define("JD",["require","exports","lC","$1","eo","rs","ro","Dr","To","yo"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.observeItemsUntilResolved=function e(t,l,c){var h=this;void 0===c&&(c={});var p=c.cancelToken,d=c.flushOperationQueue,v=c.contextualControlHandlers,m=void 0===v?u.NO_CONTROL_HANDLERS:v,g=c.owner;return function(u,c){return n.__awaiter(h,void 0,void 0,function(){var h,v,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:h=u(i.getItemCacheEvaluator);v=u(f.getItemPreserver);y={selector:t,operation:e,owner:g};E.label=1;case 1:E.trys.push([1,,6,7]);b=function(){var e,i,f,g,b,w;return n.__generator(this,function(n){switch(n.label){case 0:e=h.evaluate({selector:t,controlHandlers:m,owner:y,state:c()}),i=e.result,f=e.demands,g=e.dependencies;return(b=l(i))?[4,b]:[3,2];case 1:n.sent();n.label=2;case 2:w={items:f,flushOperationQueue:d};v.recordLastAccesses(g,Date.now());if(!u(s.readItems(function(e){return o.hasUnresolvedDemands(e,w)})))return[2,{value:void 0}];v.registerDemands(y,g);p&&p.throwIfCanceled();return[4,a.raceWithCancel(u(r.getItems(w)),p)];case 3:n.sent();return[2]}})};E.label=2;case 2:return[5,b()];case 3:if("object"==typeof(w=E.sent()))return[2,w.value];E.label=4;case 4:return[3,2];case 5:return[3,7];case 6:v.removeDemands(y);return[7];case 7:return[2]}})})}}});
define("GD",["require","exports","lC","Hm","Vm","li","rs","KD","ii","u9"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesPinSiteOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=this,r=Object.keys(e.options),u=e.itemKey,f=r[0],h=e.options[f],p=h.type,d=h.reorderPinInfo,v=s.pinnedItemKeyFacet.serialize({itemKey:f,rootItemKey:u});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,h,m,g,y,b,w,E;return n.__generator(this,function(S){switch(S.label){case 0:t=e(o.readItems(function(e){return e.demandItem({siteId:a.siteIdFacet,webId:a.webIdFacet,groupId:a.groupIdFacet},f)})),r=t.siteId,h=t.webId,m=t.groupId;g=new i.ItemResolver;y=(function(e,t){switch(e){case"pin":return c();case"unpin":return;case"reorderPin":if(t){var n=t.nextPinOrder,r=t.prevPinOrder;if(n||r)return r?n?(r+n)/2:r/2:c()}return;default:return}})(p,d);g.resolveItems({items:(w={},w[v]=n.__assign({},a.pinOrderFacet.pack(y)),w)});e(g.execute());return(b=s.spAllSitesKeyFacet.deserialize(u).tenantRootUrl)?[4,e(l(b,{siteId:r||"",webId:h||"",groupId:m},p,d))]:[3,2];case 1:S.sent();(g=new i.ItemResolver).invalidateItems({items:(E={},E[v]=[a.pinOrderFacet],E)});e(g.execute());S.label=2;case 2:return[2]}})})}});function l(e,t,r,i){var s=this;return function(o){return n.__awaiter(s,void 0,void 0,function(){var s,a,l,c,h;return n.__generator(this,function(n){switch(n.label){case 0:if("pin"===r){s="api/v1/sites/pinned/add";a="pinSite"}else if("unpin"===r){s="api/v1/sites/pinned/remove";a="unpinSite"}else{if("reorderPin"!==r)return[2];if(!i)return[2];l=f.serializeQuery({PreviousPinOrder:i.prevPinOrder||"",NextPinOrder:i.nextPinOrder||""},void 0,!0);s="api/v1/sites/pinned/update?"+l;a="reorderSite"}return[4,o(u.getSPHomeContextData({tenantRootUrl:e}))];case 1:c=n.sent();h="";t&&(h=JSON.stringify({Title:t.title,Acronym:t.acronym,BannerColor:t.color,Url:t.url,Type:"Site",ItemReference:{Type:t.groupId?"GroupReference":"SiteReference",SiteId:t.siteId,WebId:t.webId,GroupId:t.groupId}}));return[4,o(u.getData({path:s,method:"POST",qosName:a,context:c,body:h}))];case 2:n.sent();return[2]}})})}}function c(e){void 0===e&&(e=new Date);return 621355968e9+1e4*e.getTime()}});
define("i2",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinSiteOperation=new n.Facet("pinSite");var i=r.implementOperation({operationTypeFacet:t.pinSiteOperation});t.default=i});
define("ET",["require","exports","lC","Hm","li","$1","AT"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointTenantAddon=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(r.registerOperationHandler(i.spTenantKeyFacet,s.getItemsOperation)(o.SPTenantGetItemsOperationHandler));return[2]})})}})});
define("AT",["require","exports","lC","li","ii","Hm","xv","Vm","YD","So","rs","So","u9","A8"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SPTenantGetItemsOperationHandler=s.createSingleItemOperationHandler({maxParallelOperationCount:4})(function(e){var t=this,s=e.itemKey,d=r.spTenantKeyFacet.deserialize(s).tenantRootUrl;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,v,m,g,y,b,w,E,S,x,T,N;return n.__generator(this,function(C){switch(C.label){case 0:t=r.spWebPageContextKeyFacet.serialize({webAbsoluteUrl:d});return[4,s(a.demandItems(function(e){return e.demandItemFacet(i.onPremFacet,t)}))];case 1:v=C.sent();m=s(l.readItems(function(e){return e.demandItemFacet(f.localeFacet,c.configurationItemKey)}));g=!v;b=m&&m.language||"en-US";w=h.serializeQuery({Locale:b,v:2,msajax:1,cv:2});y=g?d+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+w:p.getStaticApiUrl({webAbsoluteUrl:d}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:b});return[4,s(o.getData({url:y.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:d,noRedirect:!0}))];case 2:E=C.sent();S=g?E:JSON.parse(E.d.GetSuiteNavData);x=!(!S.NavBarData||!S.NavBarData.AdminLink)||void 0;(T=new u.ItemResolver).resolveItems({items:(N={},N[e.itemKey]=n.__assign({},i.spTenantAdminFacet.pack(x)),N)});s(T.execute());return[2]}})})}})});
define("wT",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter";e[e.saveColumnFormatter=1]="saveColumnFormatter";e[e.previewViewFormatter=2]="previewViewFormatter";e[e.saveViewFormatter=3]="saveViewFormatter"})(t.CustomFormatterUpdateType||(t.CustomFormatterUpdateType={}));t.updateCustomFormatterOperation=new n.Facet("updateFormatter");t.updateCustomFormatter=r.implementOperation({operationTypeFacet:t.updateCustomFormatterOperation})});
define("OT",["require","exports","lC","Hm","$1","ii","n5","YD","Xo","Z9","g6","v4"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1855};t.updateCustomFormatter=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.formatterMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var p,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:p=Object.keys(r)[0];d=r[p],v=d.updateType,m=d.formatter;return 0!==v?[3,1]:[2,e(i.resolveItems({items:(b={},b[p]=n.__assign({},s.customFormatterFacet.pack(m)),b)}))];case 1:return 2!==v?[3,4]:[4,e(u.demandItems(function(e){e.demandItemFacet(f.customFormatterFeatureFacet,f.customFormatterFeatureKeyFacet.serialize({}))}))];case 2:E.sent();g=!1;y={};return[4,e(u.demandItems(function(e){if(g=l.isFeatureEnabled(e,{feature:h})){var n=e.demandItem({schema:a.schemaFacet},t).schema,r=n&&n.columnKeys;r&&(y=c.getFieldFormatters(e,r))}}))];case 3:E.sent();return[2,e(i.resolveItems({items:(w={},w[p]=n.__assign({},s.viewFormatterFacet.pack(o.getViewFormatterFacetObjFromString({formatter:m,fields:y,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:g}}))),w)}))];case 4:return[2]}})})}})});
define("xT",["require","exports","lC","li","Hm","A8","xo","ii","xv","_7","$1","Rs"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyFieldProperties=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.fields;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g,y,b,w;return n.__generator(this,function(E){h=Object.keys(i)[0];p=i[h],d=p.displayName,v=p.fieldDescription,m=p.showInFiltersPane;if((g=e(o.readItem({setKey:r.spFolderItemSetKeyFacet},t)).setKey)&&h&&(y=e(o.readItem({id:u.fieldIdFacet},h)).id)){b={__metadata:{type:"SP.Field"},Title:d,SchemaXml:v,ShowInFiltersPane:m};w=s.getListApiUrl({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl}).method("Fields",y).toString();return[2,e(a.getData({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl,url:w,qosName:"modifyFieldProperties",body:JSON.stringify(b),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(l.resolveItems({items:(t={},t[h]=n.__assign(n.__assign({},void 0!==m?f.showInFiltersPaneStatusFacet.pack(m):{}),void 0!==d?c.displayNameFacet.pack(d):{}),t)}))})]}return[2]})})}})});
define("IT",["require","exports","lC","cS","Hm","Rs","li","Vm","nS"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNeedsAttentionFlagOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey,s=o.spNeedsAttentionItemKeyFacet.deserialize(i),u={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,rootFolder:"",viewKey:{viewId:o.needsAttentionViewId}};return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o;return n.__generator(this,function(n){switch(n.label){case 0:t=e(r.getContentTypes({itemSetKey:u}));return[4,e(r.constructGetItemSetContext({itemSetKey:u,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:s=n.sent();n.label=2;case 2:n.trys.push([2,5,,7]);return[4,e(a.getServerData(s))];case 3:o=n.sent();return[4,e(f(o,i))];case 4:n.sent();return[3,7];case 5:n.sent();return[4,e(f(void 0,i))];case 6:n.sent();return[3,7];case 7:return[2]}})})}});function f(e,t){var r=this;return function(i){return n.__awaiter(r,void 0,void 0,function(){var r,o,a,f;return n.__generator(this,function(l){r=!1;(o=e&&e.ListData&&e.ListData.Row)&&o.length>0&&o[0]&&(r=!0);(a=new u.ItemResolver).resolveItems({items:(f={},f[t]=n.__assign({},s.missingMetadataFacet.pack(r||void 0)),f)});i(a.execute());return[2]})})}}});
define("vT",["require","exports","lC","ii","ST","yT","li","pr","m7","Hm","xo","Vm","Io","ii","de"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPFilterOptionSetHandler=f.createSingleItemOperationHandler({maxParallelOperationCount:8})(function(e){var t=this,f=e.itemKey,v=o.spFilterOptionSetKeyFacet.deserialize(f);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,y,b;return n.__generator(this,function(w){switch(w.label){case 0:t=e((function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var i=e(h.readConfiguration({spDataSourceConfiguration:r.spDataSourceConfigurationFacet})).spDataSourceConfiguration,s=i&&i.ensureAuthToken,f=o.spItemKeyFacet.serialize(t),c=e(l.readItem({folderPath:r.folderPathFacet},f)),v=e(l.readItem({internalName:r.internalNameFacet,mappedColumnFieldType:r.mappedColumnFieldTypeFacet,isCalculated:r.isCalculatedFacet},u.spListFieldKeyFacet.serialize(n))),m=c&&c.folderPath,g=v&&v.internalName&&v.internalName,y=v&&v.mappedColumnFieldType===a.ColumnFieldType.Taxonomy,b=v&&v.isCalculated,w=o.spPageContextKeyFacet.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),E=e(l.readItem({pageContext:p.spPageContextFacet},w)).pageContext,S=t.viewKey&&t.viewKey.viewId,x=S===d.default.Empty?E&&E.viewId:S;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:m,ensureAuthToken:s,fieldInternalName:g,isCalculatedField:b,filterParams:t.filterParams,excludeFieldFilteringHtml:y,viewId:x}}})({itemSetKey:v.itemSetKey,fieldKey:v.fieldKey}));return[4,e(i.getFilterData(t))];case 1:m=w.sent();g=s.default.getFilterData(m,t.fieldInternalName||"",t.isCalculatedField);(y=new c.ItemResolver).resolveItems({items:(b={},b[f]=n.__assign({},r.filterOptionSetFacet.pack(g)),b)});e(y.execute());return[2]}})})}})});
define("ST",["require","exports","xv","DT","G7","A8"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFilterData=function(e){return function(t){return t(n.getData({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"POST",url:o(e),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}};function o(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,o=e.fieldInternalName,u=e.viewId,a=e.rootFolder,f=e.excludeFieldFilteringHtml,l=e.filterParams,c=s.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",o||"");u&&(c=c.parameter("ViewId",u));a&&(c=c.parameter("RootFolder",{raw:r.encodeURIComponent(a)}));f&&(c=c.parameter("ExcludeFieldFilteringHtml",!0));if(l){var h=i.default.getFilterParams(l,!0);c=c.rawParameter(h)}return c.toString()}});
define("DT",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t,n,r){var i="",s=0;if(!e)return"";var o=e.length;for(s=0;s<o;s++){var u=e.charCodeAt(s),a=e.charAt(s);if(t&&("#"===a||"?"===a)){i+=e.substr(s);break}if(n&&"&"===a)i+=a;else if(u<=127)r||u>=97&&u<=122||u>=65&&u<=90||u>=48&&u<=57||t&&u>=32&&u<=95&&" \"%<>'&".indexOf(a)<0?i+=a:u<=15?i+="%0"+u.toString(16).toUpperCase():u<=127&&(i+="%"+u.toString(16).toUpperCase());else if(u<=2047){i+="%"+(192|u>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}else if(55296!=(64512&u)){i+="%"+(224|u>>12).toString(16).toUpperCase();i+="%"+(128|(4032&u)>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}else if(s<e.length-1){u=(1023&u)<<10;s++;u|=1023&e.charCodeAt(s);i+="%"+(240|(u+=65536)>>18).toString(16).toUpperCase();i+="%"+(128|(258048&u)>>12).toString(16).toUpperCase();i+="%"+(128|(4032&u)>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}}return i}t.encodeURIComponent=n;t.escapeUrlForCallback=function(e){var t=e.indexOf("#"),r=e.indexOf("?");if(t>0&&(-1===r||t<r)){var i=e.substr(0,t);r>0&&(i+=e.substr(r));e=i}return n(e,!0,!1,!0)};t.encodeRestUriStringToken=function(e){e&&(e=n(e=(e=e.replace(/'/g,"''")).replace(/%27/g,"%27%27")));return e}});
define("gT",["require","exports","lC","xv","li","ii","ko","Hm","xo","P1","Rs","$1","A8","de","CA","Vm"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateCheckoutState=u.createBatchedItemsOperationHandler()(function(e){var t=e.items;return function(h){return n.__awaiter(void 0,void 0,void 0,function(){var y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U;return n.__generator(this,function(z){switch(z.label){case 0:y=void 0;b=void 0;for(w=0,E=Object.keys(t);w<E.length;w++){L=E[w];S=h(a.readItem({key:i.spItemKeyFacet,folderPath:s.folderPathFacet},L));x=e.items[L];if(S&&S.key&&S.folderPath){if(!y){b=S.key.listFullUrl;y={webAbsoluteUrl:S.key.webAbsoluteUrl,items:[],checkInOutType:x.checkInOutType,checkInText:x.checkInText,checkInVersionType:x.checkInVersionType};b=S.key.listFullUrl}y.items.push({key:L,itemFullUrl:S.folderPath})}}if(!(T=y)||!T.items.length)return[3,4];N=T.items.length>1;C=void 0;C="checkIn"===T.checkInOutType?N?"batchCheckInItems":"CheckInItem":"checkOut"===T.checkInOutType?N?"batchCheckOutItems":"CheckOutItem":N?"batchUndoCheckOutItems":"UndoCheckOutItem";k="checkOut"===T.checkInOutType;if(N)return[3,2];L=T.items[0].key;A=m(T.webAbsoluteUrl,T.items[0].itemFullUrl,T.checkInOutType,T.checkInText,T.checkInVersionType);return[4,h(r.getData({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:b,url:A,method:"POST",qosName:C}))];case 1:z.sent();h(c.resolveItems({items:(R={},R[L]=n.__assign({},l.isCheckedOutFacet.pack({byYou:!!k,byOther:void 0})),R)}));return[3,4];case 2:O=p.default.generate();M="multipart/mixed; boundary=batch_"+O;return[4,h(r.getData({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:b,url:d.default.getBatchOperationUrl(T.webAbsoluteUrl),body:g(T,O),method:"POST",additionalHeaders:void 0,contentType:M,parseResponse:function(e){return d.default.processBatchResponse(e,T.items)},qosName:"batch",telemetryHandler:function(e){var t=e.response,r=e.eventData;return t&&r.resultType===f.ResultType.success?{eventData:n.__assign(n.__assign({},r),{resultType:t.hasError?f.ResultType.failure:f.ResultType.success})}:{eventData:r}}}))];case 3:if((_=z.sent()).hasError){j={items:{}};for(F=0,I=_.items;F<I.length;F++)(q=I[F]).error&&q.key&&(j.items[q.key]=new o.ItemOperationError({message:q.error.message}));throw new u.BatchedItemsOperationHandlerError(j)}D=new v.ItemResolver;for(P=0,H=T.items;P<H.length;P++){B=H[P];D.resolveItems({items:(U={},U[B.key]=n.__assign({},l.isCheckedOutFacet.pack({byYou:!!k,byOther:void 0})),U)})}h(D.execute());z.label=4;case 4:return[2]}})})}});function m(e,t,n,r,i){var s;s="checkIn"===n?"CheckIn":"undoCheckOut"===n?"UndoCheckOut":"CheckOut";var o=h.getWebApiUrl({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===n?o.methodWithAliases("CheckIn",{comment:r,checkintype:i||0}):o.segment(s)).toString()}function g(e,t){var n=e.items,r=d.default.defaultBatchRequestPostData,i=n.map(function(t){return m(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return d.default.getBatchContentExtended(t,i,"POST",r)}t.getBatchCheckoutContent=g});
define("bT",["require","exports","lC","xv","li","ii","Hm","xo","$1","HL","RL","A8"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.publishItem=o.createBatchedItemsOperationHandler()(function(e){var t=e.items;return function(o){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return n.__generator(this,function(D){switch(D.label){case 0:h=void 0;p=void 0;d="";v=!0;for(m=0,g=Object.keys(t);m<g.length;m++){A=g[m];y=o(u.readItem({key:i.spItemKeyFacet,folderPath:s.folderPathFacet},A));b=o(u.readItem({key:i.spItemKeyFacet,uiVersion:s.uiVersionFacet,contentTypeId:s.contentTypeIdFacet},A)),w=b.uiVersion,E=b.contentTypeId;d=l.getNextPublishedVersion(w);v=l.isSitePage(E);S=e.items[A];x=o(u.readItem({listItemId:s.listItemIdFacet},A)).listItemId;if(y&&y.key&&y.folderPath){if(!h){p=y.key.listFullUrl;h={webAbsoluteUrl:y.key.webAbsoluteUrl,items:[],publishActionType:S.publishActionType,publishText:S.publishText};p=y.key.listFullUrl}h.items.push({key:A,itemFullUrl:y.folderPath,listItemId:x})}}if(!(T=h)||!T.items.length)return[3,4];N=T.publishActionType===f.PublishActionType.SchedulePublish;C=N?"ScheduleItem":"PublishItem";k=0;D.label=1;case 1:if(!(k<T.items.length))return[3,4];L=T.items[k];A=L.key;O=v&&T.publishActionType!==f.PublishActionType.CancelApproval;M=O?(function(e,t,n){return e+"/_api/sitepages/pages("+t+")/"+(n?"schedulepublish":"publish")})(T.webAbsoluteUrl,L.listItemId,N):(function(e,t,n){var r="Publish";n&&n===f.PublishActionType.CancelApproval&&(r="UnPublish");var i=c.getWebApiUrl({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=i.segment(r)).toString()})(T.webAbsoluteUrl,T.items[0].itemFullUrl,T.publishActionType);return[4,o(r.getData({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:p,url:M,body:!N&&O?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:C}))];case 2:D.sent();""!==d&&o(a.resolveItems({items:(_={},_[A]=n.__assign({},s.uiVersionFacet.pack(d)),_)}));D.label=3;case 3:k++;return[3,1];case 4:return[2]}})})}})});
define("HL",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Publish=0]="Publish";e[e.Republish=1]="Republish";e[e.PostNews=2]="PostNews";e[e.UpdateNews=3]="UpdateNews";e[e.SubmitForApproval=4]="SubmitForApproval";e[e.CancelApproval=5]="CancelApproval";e[e.SchedulePublish=6]="SchedulePublish"})(t.PublishActionType||(t.PublishActionType={}))});
define("RL",["require","exports","ii","Rs","T3","c7","ii","HL","li","NL","s7","yS"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.publish=0]="publish";e[e.schedule=1]="schedule"})(t.PublishType||(t.PublishType={}));t.canPublishOrSchedule=function(e,t){var u,l,p;if(!t)return!1;var d=e.demandItem({firstItemKey:a.spItemKeyFacet,permissions:n.permissionsFacet,checkoutInfo:r.isCheckedOutFacet,needsPublishing:n.needsPublishingFacet},t),v=d.firstItemKey,m=d.permissions,g=d.checkoutInfo,y=d.needsPublishing;if(!v)return!1;var b=e.demandItemFacet(n.listFacet,a.spListKeyFacet.serialize({webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl}));return Boolean(y&&i.PermissionMask.hasItemPermission({permissions:m},i.PermissionMask.editListItems)&&(null===(u=b)||void 0===u?void 0:u.enableMinorVersions)&&(null===(l=b)||void 0===l?void 0:l.isDocumentLibrary)&&!(null===(p=g)||void 0===p?void 0:p.byOther)&&!c.isPageScheduled(e,t)&&!(function(e,t){var n=t.itemKey,r=t.listFacets,i=e.demandItem({moderationStatusType:o.moderationStatusTypeFacet},n).moderationStatusType;if(r&&r.isModerated)return"number"==typeof i&&i!==s.ModerationStatusType.draft&&i!==s.ModerationStatusType.denied&&i!==s.ModerationStatusType.pending;var u=h(e,n);return 0===u.minor&&0!==u.major})(e,{itemKey:t,listFacets:b})&&!f.isFolder(e,{itemKey:t,includeOneNote:!0}))};t.getNextPublishedVersion=function(e){return e?""+512*(Math.floor(Number(e)/512)+1):""};t.isSitePage=function(e){return!!e&&0===e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118")};function h(e,t){var n=e.demandItem({uiVersion:o.uiVersionFacet},t).uiVersion;return l.parseUIVersionString(n)}t.getVersion=h;t.getPublishActionType=function(e,t){var r,i=e.demandItem({firstItemKey:a.spItemKeyFacet,moderationStatusType:o.moderationStatusTypeFacet},t),f=i.firstItemKey,l=i.moderationStatusType;return f?(null===(r=e.demandItemFacet(n.listFacet,a.spListKeyFacet.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl})))||void 0===r?void 0:r.isModerated)?l===s.ModerationStatusType.pending?u.PublishActionType.CancelApproval:u.PublishActionType.SubmitForApproval:c.isPublishStartDateInFuture(e,t)?u.PublishActionType.SchedulePublish:0===h(e,t).major?u.PublishActionType.Publish:u.PublishActionType.Republish:u.PublishActionType.Publish}});
define("NL",["require","exports","ii","Rs","T3","oi"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isFolder=function(e,t){var n=t.itemKey,i=t.includeOneNote,o=e.demandItem({folder:r.folderFacet,oneNote:s.oneNoteFacet},n),u=o.folder,a=o.oneNote;return i?!!u||!!a:!!u&&!a};t.isApprovalRelevant=function(e,t){var s=t.itemKey,o=t.listFacets,u=!!o&&!!o.isModerated;if(u){var a=e.demandItem({permissions:n.permissionsFacet,checkoutInfo:r.isCheckedOutFacet},s),f=a.permissions,l=a.checkoutInfo;u=!!(!l||!l.byOther&&!l.byYou)&&!!f&&i.PermissionMask.hasItemPermission({permissions:f},i.PermissionMask.editListItems)&&i.PermissionMask.hasItemPermission({permissions:f},i.PermissionMask.approveItems)}return u}});
define("hT",["require","exports","lC","xv","li","ii","Hm","zm","Rs","rs","PP","A8"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemRating=o.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,o=e.options;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(l.getSPItemInfo(t))];case 1:h=n.sent(),p=h.key,d=h.itemId;v=p.webAbsoluteUrl,m=p.listFullUrl;g=i.spListKeyFacet.serialize({webAbsoluteUrl:v,listFullUrl:m});return(y=e(f.readItems(function(e){return e.demandItemFacet(s.listFacet,g)})))&&y.id&&d?[4,e(r.getData({webAbsoluteUrl:v,listFullUrl:m,url:c.getStaticApiUrl({webAbsoluteUrl:v}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:y.id,itemID:d,rating:o.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:n.sent();e(u.invalidateItems({items:(b={},b[t]=[a.displayNameFacet],b)}));n.label=3;case 3:return[2]}})})}})});
define("PP",["require","exports","lC","li","ii","YD","rs"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPItemInfo=function(e){var t=this;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,a,f;return n.__generator(this,function(n){switch(n.label){case 0:t=u(o.readItems(function(t){return t.demandItemFacet(r.spItemKeyFacet,e)}));return[4,u(s.demandItems(function(t){return t.demandItem({listItemId:i.listItemIdFacet},e)}))];case 1:a=n.sent().listItemId;if(!t)throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(f=a||t.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:t,itemId:f}]}})})}}});
define("_T",["require","exports","lC","xv","li","ii","Hm","zm","Rs","rs","PP","A8"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemLikes=o.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,o=e.options;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(l.getSPItemInfo(t))];case 1:h=n.sent(),p=h.key,d=h.itemId;v=p.webAbsoluteUrl,m=p.listFullUrl;g=i.spListKeyFacet.serialize({webAbsoluteUrl:v,listFullUrl:m});return(y=e(f.readItems(function(e){return e.demandItemFacet(s.listFacet,g)})))&&y.id&&d?[4,e(r.getData({webAbsoluteUrl:v,listFullUrl:m,url:c.getStaticApiUrl({webAbsoluteUrl:v}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:y.id,itemID:d,like:o.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:n.sent();e(u.invalidateItems({items:(b={},b[t]=[a.displayNameFacet],b)}));n.label=3;case 3:return[2]}})})}})});
define("mT",["require","exports","lC","Hm","Xo","zm","sS","Me","$1","Rs","A8","xv","li"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createCustomDocument=r.createSingleItemOperationHandler({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,l=e.options,d=l.newDocumentKey,v=l.extension;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,l,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:t=h.spItemKeyFacet.deserialize(r);l=t.rootFolder||new o.SimpleUri(t.listFullUrl).path;m=new u.ItemUrlHelperBasic({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}});g=m.getUrlParts({path:l});y=g.fullItemUrl;return[4,e(c.getData({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:p({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:g.listRelativeItemUrl||"",extension:v}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var o,u,l=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!l)throw"Fail to create custom document";var c=y+"/"+l;e(a.resolveItems({items:(o={},o[d]=n.__assign(n.__assign({},f.displayNameFacet.pack(l)),f.canonicalUrlFacet.pack(c)),o)}));e(s.invalidateItems({items:(u={},u[r]=[i.defaultChildItemSetFacet],u)}))})];case 1:b.sent();return[2]}})})}});function p(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.extension,i=e.parentFolderPath;if(!r)throw new Error("document extension is not valid");return l.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:r}).toString()}});
define("fT",["require","exports","lC","li","pT","xv","sS","Av","Hm","Xo","$1","ii","rs","PP","jr","zm","Rs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MAX_PINNED_ITEM_COUNT=3;var g=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.resultType,i=void 0===r?8:r;n.resultType=i;return n}return t})(u.CustomError);t.EditPinnedItemError=g;t.editPinnedItem=a.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var u=e.itemKey,a=e.options.itemEditTypeMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I;return n.__generator(this,function(q){switch(q.label){case 0:y=Object.keys(a)[0];b=a[y].editType;return[4,e(p.getSPItemInfo(y))];case 1:w=q.sent(),E=w.key,S=w.itemId;x=e(h.readItems(function(e){return e.demandItem({deserializedPinnedItemSetKey:r.spPinnedItemSetKeyFacet,pinnedItems:f.childItemsFacet},u)})),T=x.deserializedPinnedItemSetKey,N=x.pinnedItems;T||(T=r.spPinnedItemSetKeyFacet.deserialize(u));if(!E||!T||!S)throw new g({resultType:5});if(!(E&&T&&S))return[3,3];C="";"";T.viewKey&&(C=T.viewKey.viewId);k=T.parentItemKey.rootFolder||new o.SimpleUri(T.parentItemKey.listFullUrl).path;L=void 0;(A=N&&N.itemKeys||[])&&(O=A.indexOf(y))>-1&&(2===b&&O>=2?L=A[O-2]:3===b&&O<A.length-1&&(L=A[O+1]));M=void 0;L&&(M=e(h.readItems(function(e){return e.demandItemFacet(c.listItemIdFacet,L)})));_={webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,itemId:S,editType:b,viewId:C,rootFolder:k,afterItemId:M};u&&(D=(function(e,t,n,r){var i=r.editType,s=[];(0===i||void 0===n&&1!==i)&&s.push(e);for(var o=0,u=t;o<u.length;o++){var a=u[o];a!==e&&s.push(a);a===n&&s.push(e)}return s})(y,A,L,_)).length<=t.MAX_PINNED_ITEM_COUNT&&e(l.resolveItems({items:n.__assign((F={},F[u]=n.__assign({},f.childItemsFacet.pack({itemKeys:D})),F),d.makeObject(D,function(){return n.__assign({},v.getInvalidationFacet().forFacet(m.deletedFacet).thenInvalidate(u,f.childItemsFacet).pack())}))}));return(P=i.getEditPinnedItemUrl(_))?[4,e(s.getData({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,url:P,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3];case 2:H=q.sent();if(0!==(B=i.parseEditPinnedItemResponse(H)).resultType){j=(function(e,t){var i=[];if(e.order)for(var s=0,o=e.order;s<o.length;s++){var u=o[s];i.push(r.spItemKeyFacet.serialize(n.__assign(n.__assign({},t),{itemId:u.toString()})))}return i})(B,E);e(l.resolveItems({items:n.__assign((I={},I[u]=n.__assign({},f.childItemsFacet.pack({itemKeys:j})),I),d.makeObject(j,function(){return n.__assign({},v.getInvalidationFacet().forFacet(m.deletedFacet).thenInvalidate(u,f.childItemsFacet).pack())}))}));throw new g({resultType:B.resultType})}q.label=3;case 3:return[2]}})})}})});
define("pT",["require","exports","A8"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.pin=0]="pin";e[e.unpin=1]="unpin";e[e.movePrevious=2]="movePrevious";e[e.moveNext=3]="moveNext"})(t.PinnedItemEditType||(t.PinnedItemEditType={}));t.getEditPinnedItemUrl=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,i=e.viewId,s=e.editType,o=e.itemId,u=e.afterItemId,a=e.rootFolder,f=n.getListApiUrl({webAbsoluteUrl:t,listFullUrl:r});i&&(f=f.methodWithAliases("GetView",{viewGuid:i}));if(1!==s){var l=u?parseInt(u,10):-1;isNaN(l)&&(l=-1);f=f.methodWithAliases("AddToSpotlight",{itemId:o,folderPath:a||"",afterItemId:l})}else f=f.methodWithAliases("RemoveFromSpotlight",{itemId:o,folderPath:a||""});return f.toString()};(function(e){e[e.success=0]="success";e[e.folderDoesNotExist=1]="folderDoesNotExist";e[e.itemDoesNotExist=2]="itemDoesNotExist";e[e.tooManyItems=3]="tooManyItems";e[e.itemNotInSpotlight=4]="itemNotInSpotlight";e[e.invalidArgument=5]="invalidArgument";e[e.serverError=6]="serverError";e[e.invalidServerJSON=7]="invalidServerJSON";e[e.unknownServerResult=8]="unknownServerResult"})(t.EditPinnedItemResultType||(t.EditPinnedItemResultType={}));t.parseEditPinnedItemResponse=function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}}});
define("uT",["require","exports","lC","li","Hm","xo","aT","lT","A8","xv","y7","oP","de","ii","Xo","zm","g7","Vm","Io"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createView=i.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,i=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;return n.__generator(this,function(R){b=r.spListViewsSetKeyFacet.deserialize(t);w=Object.keys(i)[0];E=i[w],S=E.sourceView,x=E.isPublic,T=E.itemSetKey,N=E.progressItemKey;if(S&&b){C=e(s.readItem({deserializedItemSetKey:r.spFolderItemSetKeyFacet,filterableSet:p.spFilterableSetFacet,childItems:d.childItemsFacet,parentItem:d.parentItemFacet,schema:d.schemaFacet},T)),k=C.deserializedItemSetKey,L=C.filterableSet,A=C.childItems,O=C.parentItem,M=C.schema;(_=k?o.combineItemSetInfoAndView({sourceView:S,deserializedItemSetKey:k,appliedFilters:L&&L.appliedFilters}):S).prepareForSaving();D=a.getListApiUrl({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl}).segment("Views").segment("Add");j=S.getEffectiveAggregatesFieldXml();F=S.viewType,I=S.viewData,q=S.customFormatter;return[2,e(f.getData({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl,url:D.toString(),method:"POST",body:JSON.stringify({parameters:n.__assign({__metadata:{type:"SP.ViewCreationInformation"},Title:w,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:S.getEffectiveFieldNames()},Query:_.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!x,RowLimit:S.rowLimit},F&&u.ViewTypesSecondary.indexOf(F)>=0?{ViewData:I,ViewType2:F}:{})}),qosName:"addView",noRedirect:!0})).then(function(t){var i,s,o;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var u=t.d;H={viewId:h.default.normalizeLower(u.Id,!1)};P=new l.default(t.d);m.setColumnWidthsFromViewToLocalStorage(P);var a=new g.ItemResolver;a.resolveItems({items:(i={},i[r.spViewKeyFacet.serialize(H)]=n.__assign(n.__assign(n.__assign(n.__assign({},r.spViewKeyFacet.pack(H)),p.serverViewFacet.pack(u)),p.currentDerivedViewFacet.pack(P)),p.showViewModifiedIndicatorFacet.pack(!1)),i)});if(k){B=r.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},k),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:H}));a.resolveItems({items:(s={},s[B]=n.__assign(n.__assign(n.__assign({},A?d.childItemsFacet.pack(A):{}),O?d.parentItemFacet.pack(O):{}),M?d.schemaFacet.pack(M):{}),s)})}N&&a.resolveItems({items:(o={},o[N]=n.__assign({},r.spViewKeyFacet.pack(H)),o)});return e(a.execute())}).then(function(){var r,i;if(S.scope||j||q){var s={};S.scope&&(s.scope=S.scope);e(y.readConfiguration({enableModernColumnTotalsSettings:p.enableModernColumnTotalsSettingsFacet})).enableModernColumnTotalsSettings&&j&&(s.aggregations=j);q&&(s.customFormatter=q);return e(c.modifyView({items:(r={},r[t]={views:(i={},i[P.id]=n.__assign({},s),i)},r)}))}}).then(function(){var i,s;return e(v.invalidateItems({items:n.__assign((i={},i[t]=[d.childItemsFacet],i),j?(s={},s[r.spViewKeyFacet.serialize(H)]=[p.spAggregatesFacet],s):{})}))})]}return[2]})})}})});
define("aT",["require","exports","y7","iT","g7"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.combineItemSetInfoAndView=function(e){var t=e.sourceView,s=e.deserializedItemSetKey,o=e.appliedFilters,u=new n.default(t.getEffectiveViewXml());s.sortFieldKey&&u.updateSort({fieldName:s.sortFieldKey,isAscending:s.sortAscending},{overwriteAll:!0});s.groupByFieldKey&&u.updateGroupBy({group1:{fieldName:s.groupByFieldKey,isAscending:!0}});if(o)for(var a in o)if(o.hasOwnProperty(a)){var f=o[a];r.updateFilter(u,f)}try{var l=i.getColumnWidthsFromLocalStorage(t.id,!0);if(l){u.updateColumnWidths(l);i.removeColumnWidthsFromLocalStorage(t.id)}}catch(e){}return u}});
define("lT",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.standard="HTML";e.datasheet="GRID";e.calendar="CALENDAR";e.recurrence="RECURRENCE";e.chart="CHART";e.gantt="GANTT";e.power="POWER";e.tiles="TILES";e.compactList="COMPACTLIST";e.modernCalendar="MODERNCALENDAR";e.gridFixed="GRIDFIXED"})(t.ViewType||(t.ViewType={}));t.ViewTypesSecondary=["TILES","COMPACTLIST","MODERNCALENDAR","GRIDFIXED"];(function(e){e[e.dynamicHeight=0]="dynamicHeight";e[e.fixedHeight=1]="fixedHeight"})(t.GridLayoutType||(t.GridLayoutType={}));(function(e){e[e.defaultScope=0]="defaultScope";e[e.recursive=1]="recursive";e[e.recursiveAll=2]="recursiveAll";e[e.filesOnly=3]="filesOnly"})(t.ViewScope||(t.ViewScope={}))});
define("dT",["require","exports","lC","li","Hm","xo","lT","A8","xv","y7","de","ii","Xo","zm","g7","Vm"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFreshView=i.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,i=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F;return n.__generator(this,function(I){m=r.spListViewsSetKeyFacet.deserialize(t);g=Object.keys(i)[0];y=i[g],b=y.isPublic,w=y.viewType,E=y.viewFields,S=y.viewStyles,x=y.viewData,T=y.queryXml,N=y.rowLimit,C=y.itemSetKey,k=y.progressItemKey;if(m){L=e(s.readItem({deserializedItemSetKey:r.spFolderItemSetKeyFacet,childItems:h.childItemsFacet,parentItem:h.parentItemFacet,schema:h.schemaFacet},C)),A=L.deserializedItemSetKey,O=L.childItems,M=L.parentItem,_=L.schema;D=u.getListApiUrl({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl});P=D.segment("Views").segment("Add");return[2,e(a.getData({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,url:P.toString(),method:"POST",body:JSON.stringify({parameters:n.__assign(n.__assign({__metadata:{type:"SP.ViewCreationInformation"},Title:g,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:E}},o.ViewTypesSecondary.indexOf(w)>=0?{ViewType2:w}:{}),{ViewData:x,CalendarViewStyles:S,Query:T,Paged:!0,PersonalView:!b,RowLimit:N})}),qosName:"addView",noRedirect:!0})).then(function(t){var i,s,o;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var u=t.d;B=l.default.normalizeLower(u.Id,!1);j={viewId:B};H=new f.default(u);d.setColumnWidthsFromViewToLocalStorage(H);var a=new v.ItemResolver;a.resolveItems({items:(i={},i[r.spViewKeyFacet.serialize(j)]=n.__assign(n.__assign(n.__assign(n.__assign({},r.spViewKeyFacet.pack(j)),c.serverViewFacet.pack(u)),c.currentDerivedViewFacet.pack(H)),c.showViewModifiedIndicatorFacet.pack(!1)),i)});if(A){F=r.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},A),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:j}));a.resolveItems({items:(s={},s[F]=n.__assign(n.__assign(n.__assign({},O?h.childItemsFacet.pack(O):{}),M?h.parentItemFacet.pack(M):{}),_?h.schemaFacet.pack(_):{}),s)})}k&&a.resolveItems({items:(o={},o[k]=n.__assign({},r.spViewKeyFacet.pack(j)),o)});return e(a.execute())}).then(function(){var n;return e(p.invalidateItems({items:(n={},n[t]=[h.childItemsFacet],n)}))})]}return[2]})})}})});
define("cT",["require","exports","lC","li","Hm","A8","xv"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateView=i.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,i=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var u,a,f,l,c;return n.__generator(this,function(n){u=r.spListViewsSetKeyFacet.deserialize(t);a=Object.keys(i)[0];f=i[a].viewXml;if(u){l=s.getListApiUrl({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl});c=l.method("Views",a).method("SetViewXml");return[2,e(o.getData({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,url:c.toString(),method:"POST",body:JSON.stringify({viewXml:f}),qosName:"saveViewXML"}))]}return[2]})})}})});
define("sT",["require","exports","lC","li","Hm","xo","A8","xv","Xo","ii","Vm"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyView=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.views,c=r.spListViewsSetKeyFacet.deserialize(t),h=Object.keys(i)[0];return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var p,d,v;return n.__generator(this,function(m){if(c&&h){p=i[h];d=o.getListApiUrl({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl}).method("Views",h);v={__metadata:{type:"SP.View"},DefaultView:p.isDefault,Title:p.title};"number"==typeof p.scope&&(v.Scope=p.scope);if(p.aggregations){v.Aggregations=p.aggregations;v.AggregationsStatus="On"}p.customFormatter&&(v.CustomFormatter=p.customFormatter);return[2,e(u.getData({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:d.toString(),method:"POST",body:JSON.stringify(v),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var i,o,u=e(s.readItem({childItems:a.childItemsFacet},t)).childItems;if(u){for(var c=new l.ItemResolver,d=r.spViewKeyFacet.serialize({viewId:h}),v=void 0,m=void 0,g=void 0,y=0,b=u.itemKeys;y<b.length;y++){var w=b[y],E=e(s.readItem({view:f.currentDerivedViewFacet},w)).view;if(E){if(E.isDefault){v=E;m=w}w===d&&(g=E)}}if("boolean"==typeof p.isDefault){if(p.isDefault&&v&&m){v.isDefault=!1;c.resolveItems({items:(i={},i[m]=n.__assign({},f.currentDerivedViewFacet.pack(v)),i)})}if(g&&d){g.isDefault=p.isDefault;c.resolveItems({items:(o={},o[d]=n.__assign({},f.currentDerivedViewFacet.pack(g)),o)})}}return e(c.execute())}})]}return[2]})})}})});
define("oT",["require","exports","lC","Hm","si","li","Rs","Rs","oy","Vm","A8","xv"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={key:s.spPersonKeyFacet,displayName:u.displayNameFacet,email:a.emailFacet,picture:a.pictureFacet};t.likedByPeopleOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,u=s.likedByItemKeyFacet.deserialize(r),a=u&&u.spItem,p=a.webAbsoluteUrl,d=a.listFullUrl,v=a.itemId;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,m,g,y,b;return n.__generator(this,function(w){switch(w.label){case 0:t=v&&l.getListApiUrl({webAbsoluteUrl:p,listFullUrl:d}).method("GetItemById",v).segment("likedByInformation");u=new f.ItemResolver;return(m=t)?[4,e(c.getDataWithCache({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:p,listFullUrl:d}))]:[3,2];case 1:m=w.sent();w.label=2;case 2:g=[];(y=(a=m)&&a.d&&a.d.likedBy&&a.d.likedBy.results)&&y.forEach(function(e){var t,n=e.email,r=s.spPersonKeyFacet.serialize({id:String(n)});u.resolveItems({items:(t={},t[r]=i.pack(h,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)});g.push(r)});u.resolveItems({items:(b={},b[r]=n.__assign({},o.likedByPeopleFacet.pack({personKeys:g})),b)});e(u.execute());return[2]}})})}})});
define("nT",["require","exports","lC","li","Hm","xo","ii","A8","xv","aT","ZP"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveViewCoreOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options,c=i.views,h=i.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(n){switch(n.label){case 0:i=r.spListViewsSetKeyFacet.deserialize(t);p=Object.keys(c)[0];if(!i||!p)return[3,4];d=c[p],v=d.itemSetKey,m=d.shouldSaveViewFieldsOnly,g=d.newDocumentTemplatesJsonString,y=d.shouldSaveAggregationsOnly;b=e(s.readItem({deserializedViewKey:r.spViewKeyFacet,currentDerivedView:o.currentDerivedViewFacet},p)),w=b.deserializedViewKey,E=b.currentDerivedView;S=w&&w.viewId;if(!E||!S)return[3,4];x=void 0;return m||g||y?[4,e(l.getViewById({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl,viewId:S}))]:[3,2];case 1:if((T=n.sent())&&T.view){x=T.view;m?x.replaceFields(E.getEffectiveFieldNames()):g?x.updateNewDocumentTemplates(g):y&&x.replaceAggregates(E.getEffectiveAggregatesData())}return[3,3];case 2:N=e(s.readItem({deserializedItemSetKey:r.spFolderItemSetKeyFacet,filterableSet:o.spFilterableSetFacet},v)),C=N.deserializedItemSetKey,k=N.filterableSet;if(C){x=f.combineItemSetInfoAndView({sourceView:E,deserializedItemSetKey:C,appliedFilters:k&&k.appliedFilters});(L=e(s.readItem({viewType:o.viewTypeFacet},p)).viewType)&&x.updateViewType(L)}n.label=3;case 3:if(x){x.prepareForSaving();if(E.isDirty()||x.isDirty()){A=u.getListApiUrl({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl}).method("Views",S).method("SetViewXml");return[2,e(a.getData({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl,url:A.toString(),method:"POST",body:JSON.stringify({viewXml:x.getEffectiveViewXml()}),qosName:h||"saveView"}))]}}n.label=4;case 4:return[2]}})})}})});
define("ZP",["require","exports","xv","A8","ai","y7"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getViewData=function(e){return function(t){return t(n.getDataWithCache({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:a(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){return{serverView:t,view:o(t,!1,e.listTemplate)}})},noRedirect:!0}))}};t.getViewById=function(e){return function(t){return t(n.getDataWithCache({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:a(e),qosName:"getViewDataById",parseResponse:function(e){var t=JSON.parse(e).d;return{serverView:t,view:o(t,!0)}},noRedirect:!0}))}};function o(e,t,n){if(e.ViewType&&e.Id){var r=s.default.isAppView(e),o=e.Hidden&&!r,u=n===i.ListTemplateType.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!o&&!u){var a=new s.default(e);if(a.viewType)return a}}}var u=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function a(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,i=e.viewId,s=r.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n});return(s=i?s.method("Views",i):s.segment("Views")).oDataParameter("$select",u).toString()}});
define("tT",["require","exports","lC","li","Hm","xo","ii","Xo","Vm","g6","rs","Gk","Y","hr"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumn=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.columnModifyTypeMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H;return n.__generator(this,function(B){switch(B.label){case 0:if(!(d=e(s.readItem({setKey:r.spFolderItemSetKeyFacet},t)).setKey))return[3,3];v=Object.keys(i)[0];m=i[v],g=m.modifyType,y=m.targetIndex;if(!(b=d.viewKey?r.spViewKeyFacet.serialize(d.viewKey):void 0))return[3,3];if(!(w=e(s.readItem({currentDerivedView:o.currentDerivedViewFacet},b)).currentDerivedView))return[3,3];E=w.getEffectiveFieldNames();if(!(S=e(s.readItem({internalName:o.internalNameFacet},v)).internalName))return[3,3];if((x=E.indexOf(S))<0||1===g&&0===x||2===g&&x===E.length-1)return[2];T=w.isDirty();switch(g){case 0:w.updateField(S);break;case 1:w.updateField(S,x-1);break;case 2:w.updateField(S,x+1);break;case 3:w.updateField(S,y)}N={ODB:1318};C=e(l.readItems(function(e){return e.demandItemFacet(o.spPageContextFacet,r.spPageContextKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}))}));k=e(l.readItems(function(e){return{isAutoSaveEnabled:f.isFeatureEnabled(e,{feature:N,pageContext:C}),list:e.demandItemFacet(o.listFacet,p.spListKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}))}})),L=k.isAutoSaveEnabled,A=k.list;O=!1;return L&&A&&A.permissions&&A.permissions.manageLists?[4,e(c.saveViewCore({items:(_={},_[r.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})]={views:(D={},D[b]={shouldSaveViewFieldsOnly:!0},D),qosName:"autoSaveModifyColumn"},_)})).then(function(){T||(w.baseViewXml=w.getEffectiveViewXml());O=!0},function(e){h.default.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:S,modifyType:g,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:B.sent();B.label=2;case 2:M=new a.ItemResolver;L&&O||M.resolveItems({items:(P={},P[b]=n.__assign({},o.showViewModifiedIndicatorFacet.pack(!0)),P)});M.invalidateItems({items:(H={},H[t]=[u.childItemsFacet],H[b]=[o.currentDerivedViewFacet],H)});e(M.execute());B.label=3;case 3:return[2]}})})}})});
define("eT",["require","exports","lC","Hm","$1","ii"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateColumnFormatter=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,o,u,a,f;return n.__generator(this,function(l){r=Object.keys(t)[0];o=t[r],u=o.updateType,a=o.formatter;return 0===u?[2,e(i.resolveItems({items:(f={},f[r]=n.__assign({},s.customFormatterFacet.pack(a)),f)}))]:[2]})})}})});
define("$P",["require","exports","lC","li","rM","LA","Hm","xo","LO","zm","Xo","$1","Gm","si","Io","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadItemsToGroupOperationHandler=o.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,o=e.itemKey,m=e.options.sourceEntries,g=r.spItemGroupKeyFacet.deserialize(o),y=g&&g.itemSetKey,b=y.webAbsoluteUrl,w=y.listFullUrl,E=y.rootFolder,S=r.spItemKeyFacet.serialize({webAbsoluteUrl:b,listFullUrl:w,rootFolder:E}),x=Object.keys(m)[0],T=m[x].progressItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,g,y,b,w,E;return n.__generator(this,function(N){switch(N.label){case 0:t=e(u.readItem({sourceFile:a.sourceFileFacet},x)).sourceFile;r=e(d.readConfiguration({listItemUploader:v.listItemUploaderConfigurationFacet})).listItemUploader,g=void 0===r?s.uploadListItem:r;return[4,e(g({itemKey:S,options:{sourceEntries:m}}))];case 1:y=N.sent().itemKey;N.label=2;case 2:N.trys.push([2,4,,5]);return[4,e(i.assignItemToGroup({items:(b={},b[y]={groupKey:o},b)}))];case 3:N.sent();return[3,5];case 4:N.sent();return[3,5];case 5:e(f.invalidateItems({items:(w={},w[S]=[l.defaultChildItemSetFacet],w)}));T&&t&&e(c.resolveItems({items:(E={},E[T]=n.__assign(n.__assign({},h.createdItemFacet.pack({itemKey:y})),p.pack({progressSize:h.progressSizeFacet},{progressSize:{current:t.size}})),E)}));return[2]}})})}})});
define("rM",["require","exports","ko","jm","sM","oM"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.assignItemToGroup=n.implementOperation({operationTypeFacet:s.assignItemToGroupOperation});t.assignItemToGroupWithProgress=r.implementOperationWithProgress({operationTypeFacet:s.assignItemToGroupOperation,progressKeyFacet:s.assignToGroupProgressKeyFacet,initializeBatch:function(){return i.assignToGroupProgressAddon}})});
define("sM",["require","exports","lC","me","cM","oM","Hm","ih","Fm","Um","jm","Xo","Gm","Rs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0});var v=((d={})[h.ProgressPhase.started]=function(e,t){return r.format(r.getLocalizedCountValue(i.default.assignToGroupStartedItemsTitle,i.default.assignToGroupTitleIntervals,e)||"",e,t)},d[h.ProgressPhase.completed]=function(e,t){return r.format(r.getLocalizedCountValue(i.default.assignToGroupCompletedItemsTitle,i.default.assignToGroupTitleIntervals,e)||"",e,t)},d[h.ProgressPhase.failed]=function(e,t){return r.format(r.getLocalizedCountValue(i.default.assignToGroupFailedItemsTitle,i.default.assignToGroupTitleIntervals,e)||"",e,t)},d[h.ProgressPhase.canceled]=function(e,t){return r.format(r.getLocalizedCountValue(i.default.assignToGroupFailedItemsTitle,i.default.assignToGroupTitleIntervals,e)||"",e,t)},d);t.assignToGroupProgressAddon=o.createAddon(function(){return function(e){e(u.registerControlHandler(s.assignToGroupProgressKeyFacet,a.progressControl)(u.createControlHandler()(g)));e(u.registerControlHandler(s.assignToGroupProgressKeyFacet,f.progressCommandSummaryControl)(u.createControlHandler()(m)))}});function m(){return function(e){return function(e,t){return{reportMode:f.ProgressSummaryReportMode.pin}}}}function g(){return function(e){return y}}function y(e,t){var r=t.itemKey,i=l.getOverallSimpleProgressBreakdown(e,t),o=i.phase,u=i.count,a=v,f=e.demandItemFacet(c.childItemsFacet,r),h=f&&f.itemKeys,d="",m="";if(h&&h.length>0){var g=e.demandItemFacet(s.assignItemToGroupOperation,h[0]),y=g&&g.groupKey;y&&(d=e.demandItemFacet(p.displayNameFacet,y)||"");m=a[o](u,d)}else{var b=e.demandItemFacet(s.assignToGroupProgressKeyFacet,r);if(b){var w=b.taskKey,E=w&&e.demandItemFacet(p.displayNameFacet,w);E&&(m=E)}}return n.__assign({},m&&"item"!==t.format?{title:m}:{})}});
define("LA",["require","exports","lC","li","UA","xv","ii","Zn","xo","LO","$1","si","Gm","A8","rs","Rs","ai","kA"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadListItem=function(e){var t=this,y=e.itemKey,b=e.options.sourceEntries,w=r.spItemKeyFacet.deserialize(y),E=w.webAbsoluteUrl,S=w.listFullUrl,x=Object.keys(b)[0],T=b[x],N=T.progressItemKey,C=T.conflictResolution;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,b,T,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J;return n.__generator(this,function(K){switch(K.label){case 0:t=e(s.getDataRequestor({webAbsoluteUrl:E,listFullUrl:S})),b=t.dataRequestor,T=t.hasDigest;if(!t.hasTokenProvider)return[3,1];L=void 0;return[3,3];case 1:return[4,e(s.getAuthToken({url:E||S,disallowCookies:!T}))];case 2:L=K.sent();K.label=3;case 3:k=L;A=e(a.readItem({sourceFile:f.sourceFileFacet},x)).sourceFile;O=e(a.readItem({folderPath:o.folderPathFacet},y)).folderPath,M=void 0===O?w.rootFolder:O;if(!A)throw new Error("No source file for upload.");if(!M)throw new Error("No path information for target folder.");_=p.getWebApiUrl({webAbsoluteUrl:E,listOrItemFullUrl:S});D=new u.Async(void 0);P=D.debounce(function(t){var n;N&&e(l.resolveItems({items:(n={},n[N]=c.pack({progressSize:h.progressSizeFacet},{progressSize:{current:t}}),n)}))},300,{leading:!1});H=e(d.readItems(function(e){return e.demandItemFacet(o.listFacet,r.spListKeyFacet.serialize({webAbsoluteUrl:E,listFullUrl:S}))}));B=H&&H.contentTypesEnabled&&H.templateType!==m.ListTemplateType.mySiteDocumentLibrary;(j=new i.ItemUploader({authToken:k,dataRequestor:b,parentItemKey:"",targetItemKey:"",fileUpload:A,iconName:"",serverRelativeItemUrl:M,webApiUrl:_,onProgress:P,expandAllItemFields:B})).nameConflictBehavior="replace"===C?1:0;N&&e(l.resolveItems({items:($={},$[N]=n.__assign({},h.progressSizeFacet.pack({total:A.size,current:0})),$)}));F=j.start();I=e(d.readItems(function(e){return e.demandItemFacet(h.cancelSourceFacet,N)}));q=I?I.token.subscribe(function(){j.abort()}):void 0;K.label=4;case 4:K.trys.push([4,6,7,8]);return[4,F];case 5:K.sent();return[3,8];case 6:R=K.sent();j.abort();g.handleUploadError(R);throw R;case 7:q&&q();j.dispose();return[7];case 8:U=j.item;z=U.properties;W=z&&z.ID||U.id;X=z&&z.uniqueId;V=r.spItemKeyFacet.serialize({webAbsoluteUrl:E,listFullUrl:S,itemId:W});e(l.resolveItems({items:(J={},J[V]=n.__assign(n.__assign(n.__assign(n.__assign({},v.displayNameFacet.pack(U.displayName)),U.id?o.folderPathFacet.pack(U.id):{}),X?o.uniqueIdFacet.pack(X):{}),v.parentFolderItemFacet.pack({itemKey:y})),J)}));return[2,{itemKey:V}]}})})}}});
define("UA",["require","exports","lC","Fe","Oh","NA","th","de","Le","RA","A2","TA","PA","FA"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=new s.default(3),v=(function(e){n.__extends(t,e);function t(t){var n=this,r=t.fileUpload;(n=e.call(this)||this)._fileUpload=r;n._authToken=t.authToken;n._uploadId=null;n._chunkNumber=0;n._streamingChunkNumber=0;n._currentChunkSize=8388608;n._currentStreamingChunkSize=262144e3;n._onProgress=t.onProgress;n._dataRequestor=t.dataRequestor;n._async=n.scope.attach(new i.default(n));n.totalBytes=r.size;n.uploadedBytes=0;n.fileName=r.name;n.iconName=t.iconName;n.state=0;n.error=null;n.nameConflictBehavior=0;n.allowRename=!1;n.supportsVersioning=!0;n._expandAllItemFields=t.expandAllItemFields;n._uniqueId=t.uniqueId;n._parentItemKey=t.parentItemKey;n._targetItemKey=t.targetItemKey;n._serverRelativeItemUrl=t.serverRelativeItemUrl;n._webApiUrl=t.webApiUrl;return n}t.prototype.start=function(){var e=this;this.updateState(0);var t=d.enqueue(function(){e.error=void 0;e.updateState(1);return e._upload().then(function(){e.updateState(2)},function(t){var n;n=t instanceof h.UploadError?t:new h.UploadError({message:t&&t.message||"",errorType:c.UploadErrorType.general});e.error=n;e.updateState(4);return r.default.reject(t)})});this._uploadPromise=t;return t};t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null;this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0;if(t){t.cancel();t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()})}}};t.prototype.restart=function(){var e,t=this,n=this._uploadPromise;this._uploadPromise=void 0;if(n){n.cancel();e=n.catch(function(){return t._cancelChunkUpload().catch(function(){})})}else e=r.default.resolve();e.done(function(){t.start()})};t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var n=this._fileUpload.size;if(n<=25165824)e=this._sendSingleRequestUpload();else{this._maxUploadRequestDuration=15e4;e=this._sendStreamingUpload()}return e.then(function(e){t.uploadedBytes=n;t.item=e})};t.prototype._createUploadError=function(e){var t,n,r,i;if("string"==typeof e)r=String(e);else{t=this._getErrorCode(e);n=e.status;r="string"==typeof e.message?String(e.message):e.message.value}switch(t){case-2130575257:i=c.UploadErrorType.conflict;break;case-1:i=c.UploadErrorType.disconnected;break;case-2130575245:i=c.UploadErrorType.invalidName;break;case-2130246326:i=c.UploadErrorType.versionMismatch;break;case-2147023080:case-2130575282:i=c.UploadErrorType.overQuota;break;default:switch(n){case 401:i=c.UploadErrorType.authFailure;break;case 404:i=c.UploadErrorType.targetFolderMissing;break;case 403:case 429:i=c.UploadErrorType.accessDenied;break;case 409:i=c.UploadErrorType.conflict;break;case 412:i=c.UploadErrorType.versionMismatch;break;case 415:i=c.UploadErrorType.emptyFileOrFolder;break;case 423:i=c.UploadErrorType.lockMismatch;break;case 507:i=c.UploadErrorType.overQuota;break;default:r?i||(i=c.UploadErrorType.other):i=c.UploadErrorType.general}}return new h.UploadError({message:r,errorType:i,allowRename:this.allowRename,supportsVersioning:this.supportsVersioning})};t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]};t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,n=this._webApiUrl;n=e?n.method("GetFolderById",e):m(n,{serverRelativeItemUrl:t,isFolder:!0});var r=this._fileUpload.name,i=1===this.nameConflictBehavior;n=n.segment("Files").methodWithAliases("AddUsingPath",{DecodedUrl:r,overwrite:i,AutoCheckoutOnInvalidData:!0});var s="ListItemAllFields";this._expandAllItemFields&&(s+="/ContentType/Fields");s&&(n=n.oDataParameter("$Expand",s));return n.toString()};t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return r.default.resolve(!1);var t=this._serverRelativeItemUrl,n=this._webApiUrl;n=(n=m(n,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+a.default.encodeRestUriStringToken(this._fileUpload.name)+"'");return this._dataRequestor.getData({noRedirect:!0,url:n.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var n=JSON.parse(t);return!!(n&&n.d&&n.d.results&&n.d.results.length>0)&&!(n.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!r.default.isCanceled(e)&&r.default.reject(e)})};t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)};t.prototype._getItemFromResponse=function(e){var t;try{var n=JSON.parse(e).d,r=this._targetItemKey,i=void 0;n.ListItemAllFields&&n.ListItemAllFields.Id&&(i=String(n.ListItemAllFields.Id));var s=!1;if(n.ListItemAllFields&&n.ListItemAllFields.ContentType&&n.ListItemAllFields.ContentType.Fields&&n.ListItemAllFields.ContentType.Fields.results){var o=n.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(o.length>0)for(var a=0,c=o;a<c.length;a++){var h=c[a];if(!n.ListItemAllFields[h.InternalName]){s=!0;break}}}var p=void 0;n.UniqueId&&(p=u.default.normalizeLower(n.UniqueId));var d=n.Name,v=l.getFileExtension(d);t={key:r,parentKey:this._parentItemKey,type:f.default.File,id:n.ServerRelativeUrl,name:d,displayName:d,extension:v,properties:{ID:i,uniqueId:p},itemFromServer:n,hasMissingMetadata:s}}catch(e){}return t};t.prototype._generateChunkPostUrl=function(e,t){var r,i=this._fileUpload,s=this._uniqueId,o=i.size<=t,u=this._serverRelativeItemUrl,a=this._webApiUrl,f={uploadId:{guid:this._uploadId}};if(0===this._chunkNumber&&0===this._streamingChunkNumber){r="StartUpload";a=(a=s?a.method("GetFolderById",s):m(a,{serverRelativeItemUrl:u,isFolder:!0})).segment("Files");a=1===this.nameConflictBehavior?a.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:i.name}):a.methodWithAliases("AddStubUsingPath",{DecodedUrl:i.name})}else{r=o?"FinishUpload":"ContinueUpload";a=m(a,{serverRelativeItemUrl:u+"/"+i.name,isFolder:!1});f=n.__assign(n.__assign({},f),{fileOffset:e})}return(a=a.methodWithAliases(r,f)).toString()};t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,n=this._serverRelativeItemUrl,i=this._webApiUrl;i=i.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:n+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}});return this._dataRequestor.getData({noRedirect:!0,url:i.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){if(e.d&&e.d.ExpectedContentRange){return parseInt(e.d.ExpectedContentRange.split("-")[0],10)}return r.default.reject(new Error("No expected range from server response."))})};t.prototype._uploadFragment=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);var i=this._fileUpload.size,s=Math.min(this._currentChunkSize+e,i);this._uploadId||(this._uploadId=u.default.generate());var a=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,s),offset:e,length:s-e}).then(function(e){n.uploadedBytes=s;if(s<i){n._chunkNumber++;Date.now()-a<6e4&&(n._currentChunkSize=Math.min(Math.floor(n._currentChunkSize*Math.pow(2,1/4)),62914560));return n._uploadFragment(s)}return n._processUploadCompleteResponse(e)},function(i){if(r.default.isCanceled(i))return r.default.reject(i);if(-2===n._getErrorCode(i)){if(n._currentChunkSize>262144){n._currentChunkSize=Math.max(Math.floor(n._currentChunkSize/2),262144);var s=void 0;0===n._chunkNumber&&(s=n._cancelChunkUpload());return r.default.resolve(s).then(function(){return n._uploadFragment(e)})}}else if(t>0&&n._canRetry(i)){var u,a=new o.default(function(){u&&n._async.clearTimeout(u)});u=n._async.setTimeout(function(){return a.complete()},1e3);return a.getPromise().then(function(){return n._uploadFragment(e,t-1)})}return r.default.reject(n._createUploadError(i))})};t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var n=new h.UploadError({message:"",errorType:c.UploadErrorType.conflict});return r.default.reject(n)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){if(r.default.isCanceled(t))return r.default.reject(t);if(-2===e._getErrorCode(t)){e.nameConflictBehavior=1;return e._uploadFragment()}return r.default.reject(e._createUploadError(t))})})};t.prototype._sendStreamingUpload=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._uploadId||(this._uploadId=u.default.generate());var i=this._fileUpload.size,s=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,i):0;return this._isConflictFile().then(function(t){if(t){var i=new h.UploadError({message:"",errorType:c.UploadErrorType.conflict});return r.default.reject(i)}return n._fileUpload.slice(e,s)}).then(function(u){return n._sendFileData({url:n._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:u,offset:e,length:u.size}).then(function(e){n.uploadedBytes=s;if(s<i){n._streamingChunkNumber++;return n._sendStreamingUpload(s,t)}return n._processUploadCompleteResponse(e)},function(e){if(r.default.isCanceled(e))return r.default.reject(e);if(-2===n._getErrorCode(e)){if(n._currentStreamingChunkSize<=1048576)return r.default.reject(n._createUploadError(e));n._currentStreamingChunkSize=n._currentStreamingChunkSize/2}return n._getUploadStatus().then(function(e){return n._sendStreamingUpload(e,3)},function(i){if(t>0&&n._canRetry(e)){var s,u=new o.default(function(){s&&n._async.clearTimeout(s)});s=n._async.setTimeout(function(){return u.complete()},1e3);return u.getPromise().then(function(){return n._sendStreamingUpload(0,t-1)})}return r.default.reject(n._createUploadError(e))})})})};t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t};t.prototype._cancelChunkUpload=function(){var e=this._uploadId;this._uploadId=void 0;this._chunkNumber=0;if(e){var t=this._fileUpload,n=this._serverRelativeItemUrl,i=this._webApiUrl;i=(i=m(i,{serverRelativeItemUrl:n+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}});return this._dataRequestor.getData({noRedirect:!0,url:i.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return r.default.resolve()};t.prototype._sendFileData=function(e){var t,n,r,i=this,s=e.url,u=e.qosName,a=e.data,f=e.offset,l=e.length,c=new o.default(function(){t.cancel()}),h=function(e){var t=i._chunkNumber>0&&f+l>=i._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&i._async.clearTimeout(n);e&&(n=i._async.setTimeout(function(){c.error({code:"-1",message:""})},r))},p=Date.now(),d=Date.now(),v=0,m=0,g=0,y=this._async.debounce(function(e){if(e>i.uploadedBytes){i.uploadedBytes=e;i._onProgress&&i._onProgress(e)}},100,{leading:!1});t=this._dataRequestor.getData({url:s,noRedirect:!0,authToken:this._authToken,qosName:u,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:a,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();m+=(e.loaded-v)/(t-d);g++;r=e.loaded/(t-p);d=t;v=e.loaded;y(f+e.loaded);h(l-e.loaded)}}});h(l);var b=this._async.setInterval(function(){if(g){Date.now()-p+(l-v)/((m+r)/(g+1))>i._maxUploadRequestDuration&&v<l&&c.error({code:"-2",message:""})}},1e4);t.done(function(e){c.complete(e)},function(e){c.error(e)});c.getPromise().done(function(){n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)},function(){t.cancel();n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)});return c.getPromise()};return t})(p.BaseUploader);t.ItemUploader=v;function m(e,t){var n=t.serverRelativeItemUrl,r=t.isFolder;return e=e.methodWithAliases(r?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:n})}});
define("PA",["require","exports","lC","TA","v"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,n.__assign(n.__assign({},t),{isExpected:o(t.errorType)}))||this;i.message=t.message;i.errorType=t.errorType||r.UploadErrorType.other;i.maxSizeInBytes=t.maxSizeInBytes;i.allowRename=t.allowRename||!1;i.allowMerge=t.allowMerge||!1;i.supportsVersioning=t.supportsVersioning||!1;i.extraData=t.extraData;i.libraryName=t.libraryName;i.isFolder=t.isFolder;i.fixItUrl=t.fixItUrl;return i}return t})(i.ApiError);t.UploadError=s;function o(e){switch(e){case r.UploadErrorType.conflict:case r.UploadErrorType.emptyFileOrFolder:case r.UploadErrorType.emptyFileOrFolderForDocLib:case r.UploadErrorType.fileSize:case r.UploadErrorType.folderUploadNotSupported:case r.UploadErrorType.insufficientVaultQuota:case r.UploadErrorType.invalidName:case r.UploadErrorType.lockMismatch:case r.UploadErrorType.malwareDetected:case r.UploadErrorType.overQuota:case r.UploadErrorType.overQuotaSharedFolder:case r.UploadErrorType.pathTooLong:case r.UploadErrorType.targetFolderMissing:case r.UploadErrorType.throttled:case r.UploadErrorType.unlockRequired:case r.UploadErrorType.versionMismatch:return!0;case r.UploadErrorType.accessDenied:case r.UploadErrorType.itemNotFound:case r.UploadErrorType.disconnected:case r.UploadErrorType.authFailure:case r.UploadErrorType.general:return!1;case r.UploadErrorType.none:case r.UploadErrorType.other:return}}t.default=s});
define("FA",["require","exports","HA","pv","eh"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){var e=this.scope=new i.default;this._events=e.attach(new r.default(this))}e.prototype.start=function(){};e.prototype.abort=function(){};e.prototype.dispose=function(){this.scope.dispose()};e.prototype.updateState=function(e){if(e!==this.state){this.state=e;this._events.raise(n.UPLOADSTATE_CHANGE,e)}};return e})();t.BaseUploader=s;t.default=s});
define("HA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UPLOADSTATE_CHANGE="upload_state_change"});
define("LO",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.entryBatchFacet=new n.Facet("entryBatch");t.sourceFileFacet=new n.Facet("sourceFile")});
define("kA",["require","exports","lC","Fe","S0","TA","To","PA","YS","ii","MA"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.handleUploadError=function(e){if(r.default.isCanceled(e))throw new o.CancelError;if(e instanceof u.UploadError)throw new a.UploadItemOperationError({facets:c(e),innerError:e});if(l.isErrorData(e))throw new a.UploadItemOperationError({facets:n.__assign(n.__assign({},"-2130575257"===e.code?n.__assign({},i.conflictErrorFacet.pack({supportsRename:!1})):n.__assign({},i.retryErrorFacet.pack({}))),f.spErrorDataFacet.pack(e)),message:l.getErrorMessage(e)})};function c(e){switch(e.errorType){case s.UploadErrorType.conflict:return n.__assign({},i.conflictErrorFacet.pack({supportsRename:!1}));case s.UploadErrorType.accessDenied:return n.__assign({},i.accessDeniedErrorFacet.pack({}));case s.UploadErrorType.disconnected:return n.__assign({},i.offlineErrorFacet.pack({}));case s.UploadErrorType.emptyFileOrFolder:case s.UploadErrorType.emptyFileOrFolderForDocLib:return n.__assign({},i.emptyFolderUnsupportedFacet.pack({}));case s.UploadErrorType.folderUploadNotSupported:return n.__assign({},i.folderUploadUnsupportedFacet.pack({}));case s.UploadErrorType.invalidName:return n.__assign({},i.invalidNameErrorFacet.pack({}));case s.UploadErrorType.lockMismatch:return n.__assign({},i.lockMismatchErrorFacet.pack({}));case s.UploadErrorType.malwareDetected:return n.__assign({},i.malwareErrorFacet.pack({}));case s.UploadErrorType.overQuota:return n.__assign({},i.overQuotaErrorFacet.pack({}));case s.UploadErrorType.targetFolderMissing:return n.__assign({},i.targetFolderErrorFacet.pack({}));case s.UploadErrorType.throttled:return n.__assign({},i.throttleErrorFacet.pack({}));case s.UploadErrorType.versionMismatch:return n.__assign({},i.versionMismatchFacet.pack({}))}return n.__assign({},i.retryErrorFacet.pack({}))}});
define("MA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isErrorData=function(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))};t.getErrorMessage=function(e){return e&&e.message&&("object"==typeof e.message?e.message.value:e.message.toString())||""}});
define("XP",["require","exports","lC","ZP","ii","li","Hm","Xo","xo","Io","So","g7","Vm","ce","rs","r7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getViewsItemOperationHandler=o.createSingleItemOperationHandler({maxParallelOperationCount:8})(function(e){var t=this,o=e.itemKey,m=s.spListViewsSetKeyFacet.deserialize(o),g=m.webAbsoluteUrl,y=m.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:t=[];b=new h.ItemResolver;w=e(a.readItem({pageContext:i.spPageContextFacet},s.spPageContextKeyFacet.serialize({webAbsoluteUrl:g,listFullUrl:y}))).pageContext;E=s.spListKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl});S=e(a.readItem({list:i.listFacet},E));x=e(f.readConfiguration({localeConfiguration:l.localeFacet})).localeConfiguration;return[4,e(r.getViewData({webAbsoluteUrl:g,listFullUrl:y,listTemplate:S.list&&S.list.templateType,preferredLanguage:x&&x.language}))];case 1:T=O.sent();N={};C=void 0;k=w&&p.getKillSwitch(w);T.filter(function(e){return!!e.view}).map(function(r){var o,u=r.serverView,a=r.view,f={viewId:a.id},l=s.spViewKeyFacet.serialize(f);if(a.isDefault){C=l;var h=a.getDomParts().newDocumentTemplates;h&&h.textContent&&b.merge(v.processNewDocumentTemplates({webAbsoluteUrl:g,listFullUrl:y,newDocumentTemplatesString:h.textContent}).itemResolver)}N[l]=a;c.setColumnWidthsFromViewToLocalStorage(a);var p=e(d.readItems(function(e){if(e.isItemFacetResolved(i.currentDerivedViewFacet,l))return e.demandItemFacet(i.currentDerivedViewFacet,l)})),m=!!k&&!k.isActivated("E9B1A0B8-5A6E-4292-8EF8-68446FEF4A7D","4/20/2020","Skip resolve currentDerived when it is not changed")&&!!p&&p.getEffectiveViewXml().replace(/ \/>/g,"/>")===a.getEffectiveViewXml().replace(/ \/>/g,"/>");b.resolveItems({items:(o={},o[l]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},s.spViewKeyFacet.pack(f)),i.serverViewFacet.pack(u)),m?{}:i.currentDerivedViewFacet.pack(a)),i.showViewModifiedIndicatorFacet.pack(!1)),i.viewTypeFacet.pack(a.viewType)),o)});t.push(l)});t.sort(function(e,t){return N[e].compareTo(N[t])});b.resolveItems({items:(L={},L[o]=n.__assign(n.__assign({},s.spListViewsSetKeyFacet.pack(m)),u.childItemsFacet.pack({itemKeys:t})),L)});C&&b.resolveItems({items:(A={},A[E]=n.__assign({},i.defaultViewFacet.pack({viewKey:C})),A)});e(b.execute());return[2]}})})}})});
define("QP",["require","exports","lC","li","ur","ii","Ny","SM","b7","Jf","Xo","Rs","Hm","xo","vM","JP","ai","de","Vm","YD","rs","i5","ii","Ro","YP"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCustomActionsOperationHandler=h.createSingleItemOperationHandler()(function(e){var t=e.itemKey,i=r.customActionSetKeyFacet.deserialize(t),s=i.webAbsoluteUrl,o=i.listFullUrl;return function(e){var r,i=e(v.getParseCustomActionsContext({webAbsoluteUrl:s,listFullUrl:o}));if(i.listTemplate===m.ListTemplateType.mySiteDocumentLibrary){var u=new y.ItemResolver;u.resolveItems({items:(r={},r[t]=n.__assign({},l.childItemsFacet.pack(void 0)),r)});e(u.execute());return Promise.resolve()}return e(v.getLegacyCustomActionsData(s,o,i)).then(function(n){return e(T.resolveCustomActions({customActionSetKey:t,customActions:n,context:i}))}).then(function(t){return e(t.execute())})}});t.getCustomActionSetWithExtensionsOperationHandler=h.createSingleItemOperationHandler()(L);function N(e){return n.__awaiter(this,void 0,void 0,function(){var t,i,s,o,u,a,c,h,p,v,m;return n.__generator(this,function(g){switch(g.label){case 0:t=e.setKey,i=e.actions,s=e.listViewAdapter;o=new y.ItemResolver;u=[];a=0;c=function(e){var t,i,f,l,c,h,p,v,m,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:t=[];if(!d.isGroup(e))return[3,5];i=e.children;f=0;l=0,c=i;n.label=1;case 1:if(!(l<c.length))return[3,5];h=c[l];p=h.id?h.id:h.text+a+"."+f;v=r.customActionKeyFacet.serialize({actionId:p});return k(h)&&s?[4,C({action:h,listViewAdapter:s})]:[3,3];case 2:m=n.sent(),b=m.actionKeys,y=m.itemResolver;o.merge(y);b.forEach(function(e){t.push(e)});n.label=3;case 3:t.push(v);f++;n.label=4;case 4:l++;return[3,1];case 5:return!d.isGroup(e)&&k(e)&&s?[4,C({action:e,listViewAdapter:s})]:[3,7];case 6:g=n.sent(),y=g.itemResolver,b=g.actionKeys;o.merge(y);u=u.concat(b);n.label=7;case 7:a++;return[2]}})};h=0,p=i;g.label=1;case 1:if(!(h<p.length))return[3,4];v=p[h];return[5,c(v)];case 2:g.sent();g.label=3;case 3:h++;return[3,1];case 4:o.resolveItems({items:(m={},m[t]=n.__assign(n.__assign({},f.isGroupFacet.pack(!0)),l.childItemsFacet.pack(0===u.length?void 0:{itemKeys:u})),m)});return[2,{itemResolver:o}]}})})}t.addCustomActionSetToCacheWhenSpfxLoaded=N;function C(e){return n.__awaiter(this,void 0,void 0,function(){var t,i,s,o,f,l,h;return n.__generator(this,function(p){switch(p.label){case 0:t=e.action,i=e.listViewAdapter;s=new y.ItemResolver;o=[];f=t.clientSideComponentId&&t.clientSideComponentId.toString()||"";l=t.clientSideComponentProperties||"";return f&&f!==g.default.Empty?[4,i.loadCommandSet(f,l).catch(function(){})]:[2,{itemResolver:s,actionKeys:[]}];case 1:(h=p.sent())&&h.commandAdapters&&h.commandAdapters.forEach(function(e){var i,f=t.clientSideComponentId+"."+e.commandId,l=r.customActionKeyFacet.serialize({actionId:f});s.resolveItems({items:(i={},i[l]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(e.title)),c.openUrlFacet.pack(t.action)),u.enabledForMultipleItemsFacet.pack(t.allowMultiSelect)),u.isEnabledFunctionFacet.pack(t.isEnabled||!1)),u.iconUrlFacet.pack(e.iconUrl||t.iconUrl)),a.commandAdapterFacet.pack(e)),i)});o.push(l)});return[2,{itemResolver:s,actionKeys:o}]}})})}function k(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==g.default.Empty)||!1}function L(e){var t=this,u=e.itemKey,f=r.customActionSetWithExtensionsKeyFacet.deserialize(u),h=f.webAbsoluteUrl,d=f.listFullUrl,v=f.isSPFXandCustomActionsAvailable,m=f.targetCustomActionSetKey,T=f.itemsScopeItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,C,k,L,A,O,M,_,D,P;return n.__generator(this,function(H){switch(H.label){case 0:t=new y.ItemResolver;f=r.spListKeyFacet.serialize({webAbsoluteUrl:h,listFullUrl:d});C=e(w.readItems(E.getLoadSpfxAdapterFunction));k=function(){var n;t.resolveItems({items:(n={},n[f]=a.listViewAdapterFacet.pack(void 0),n)});e(t.execute())};if(!v&&!C){k();return[2]}return(A=C)?[4,C()]:[3,2];case 1:A=H.sent();H.label=2;case 2:O=!1;if(!(L=A))return[3,7];M=L.createListViewAdapter();t.resolveItems({items:(P={},P[f]=n.__assign({},M?a.listViewAdapterFacet.pack(M):{}),P)});_=e(p.readItem({rawCustomActions:s.rawCustomActionsFacet},m)).rawCustomActions;return[4,N({setKey:u,actions:_||[],listViewAdapter:M})];case 3:D=H.sent().itemResolver;t.merge(D);return[4,e(b.demandItems(function(e){var u=x.getCurrentItemSetKey(e,T);if(u&&M){var f=e.demandItemFacet(l.childItemsFacet,u),p=f&&f.itemKeys,v=function(i){var s,o=e.isItemFacetResolved(S.rowDataFacet,i)?e.demandItemFacet(S.rowDataFacet,i):void 0;if(o&&M){var u=M.createRowAdapter({values:o});t.resolveItems({items:(s={},s[i]=n.__assign({},u?a.rowAdapterFacet.pack(u):{}),s)})}else if(e.demandItemFacet(r.spItemGroupKeyFacet,i)){var f=e.isItemFacetResolved(l.childItemsFacet,i)?e.demandItemFacet(l.childItemsFacet,i):void 0;if(f)for(var c=0,h=f.itemKeys;c<h.length;c++){var p=h[c];v(p)}}};if(p)for(var m=0,y=p;m<y.length;m++){var b=y[m];v(b)}var w=e.demandItemFacet(l.schemaFacet,u),E=w&&w.columnKeys||[];if(E&&M)for(var N=function(n){var r,u=e.demandItem({fieldId:s.fieldIdFacet,internalName:s.internalNameFacet,realFieldName:s.realFieldNameFacet,fieldType:s.fieldFieldTypeFacet,isRequired:o.isRequiredFacet,displayName:c.displayNameFacet,clientSideComponentId:a.clientSideComponentIdFacet,clientSideComponentProperties:a.clientSideComponentPropertiesFacet},n),f=u.fieldId,l=u.internalName,p=u.realFieldName,v=u.fieldType,m=u.isRequired,y=u.displayName,b=u.clientSideComponentId,w=u.clientSideComponentProperties;if(f&&l){O=!0;var E={listKey:{webAbsoluteUrl:h,listFullUrl:d},internalName:l},S={id:f,internalName:p||l,fieldType:v||"Text",isRequired:m||!1,isVisible:!0,displayName:y||"",clientSideComponentId:b||g.default.Empty,clientSideComponentProperties:w||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+l+",\n                      componentId: "+b+", error: "+e.message)}},x=M.addColumnAdapter(S);if(b&&b!==g.default.Empty){var T=i.spListColumnAdapterKeyFacet.serialize(E);t.resolveItems({items:(r={},r[T]=a.columnAdapterFacet.pack(x),r[n]=a.columnAdapterKeyFacet.pack(T),r)})}}},C=0,k=E;C<k.length;C++){N(k[C])}}}))];case 4:H.sent();return O?[4,M.loadFieldCustomizers()]:[3,6];case 5:H.sent();H.label=6;case 6:return[3,8];case 7:k();H.label=8;case 8:e(t.execute());return[2]}})})}}t.getCustomActionSetWithExtensions=L});
define("qP",["require","exports","lC","li","Hm","xv","Vm","ii","A8"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spWebPageContextGetItemsOperationHandler=i.createSingleItemOperationHandler({maxParallelOperationCount:4})(function(e){var t=this,i=e.itemKey,f=r.spWebPageContextKeyFacet.deserialize(i).webAbsoluteUrl;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,c,h,p,d;return n.__generator(this,function(v){switch(v.label){case 0:t=a.getStaticApiUrl({webAbsoluteUrl:f}).segments("ComponentContextInfo");return[4,r(s.getData({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:f,noRedirect:!0}))];case 1:i=v.sent();l=JSON.parse(i.d.SerializedData);c=l.isSPO,h=void 0===c||c;(p=new o.ItemResolver).resolveItems({items:(d={},d[e.itemKey]=n.__assign(n.__assign({},u.onPremFacet.pack(h?void 0:{})),u.spPageContextFacet.pack(l)),d)});r(p.execute());return[2]}})})}})});
define("WP",["require","exports","lC","Hm","xo","zm","rs","Jf","Xo","li","pr","G7","wM","ii","jL"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.assignItemsToGroup=r.createBatchedItemsOperationHandler()(function(e){var t=e.items,r=Object.keys(t),v=t[r[0]].groupKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P;return n.__generator(this,function(n){switch(n.label){case 0:t=e(o.readItems(function(e){return e.demandItemFacet(f.spItemGroupKeyFacet,v)}));if(!(m=t&&t.itemSetKey&&f.spFolderItemSetKeyFacet.serialize(t.itemSetKey))||r.length<1||!v)return[2];g=e(i.readItem({spGroupField:p.spGroupFieldFacet,groupValue:p.groupValueFacet,parentGroupKey:p.parentGroupKeyFacet,defaultCollapsed:u.defaultCollapsedFacet},v)),y=g.spGroupField,b=g.groupValue,w=g.parentGroupKey,E=g.defaultCollapsed;S=[];y&&y.internalName&&b&&S.push({FieldName:y.internalName,FieldValue:b});if(w&&w.itemKey){x=e(i.readItem({parentGroupField:p.spGroupFieldFacet,parentGroupValue:p.groupValueFacet},w.itemKey)),T=x.parentGroupField,N=x.parentGroupValue;T&&T.internalName&&N&&S.push({FieldName:T.internalName,FieldValue:N})}if(t&&t.itemSetKey&&t.itemSetKey.filterParams&&(C=c.default.getFilterList(t.itemSetKey.filterParams,void 0,!0)).length>0)for(k=0;k<C.length;k++){L=C[k];A=e(i.readItem({isReadOnly:p.isReadOnlyFacet},l.spListFieldKeyFacet.serialize({listKey:t.itemSetKey,internalName:L.fieldName}))).isReadOnly;1===L.values.length&&!1===A&&S.push({FieldName:L.fieldName,FieldValue:L.values[0]})}return[4,e(h.bulkUpdateListItems({items:(M={},M[m]={itemKeys:r,formValues:S,qosName:"AssignItemsToGroup"},M)}))];case 1:n.sent();O={};r.forEach(function(e){O[e]={}});return[4,e(d.refreshItemsInSet({items:(_={},_[m]=O,_)}))];case 2:n.sent();e(E?s.invalidateItems({items:(D={},D[v]=[a.childItemsFacet],D)}):s.invalidateItems({items:(P={},P[m]=[a.childItemsFacet],P)}));return[2]}})})}})});
define("wM",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.bulkUpdateListItemsOperation=new n.Facet("bulkUpdateListItems");t.bulkUpdateListItems=r.implementOperation({operationTypeFacet:t.bulkUpdateListItemsOperation})});
define("jL",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.refreshItemsInSetOperation=new n.Facet("refreshItemsInSet");t.refreshItemsInSet=r.implementOperation({operationTypeFacet:t.refreshItemsInSetOperation})});
define("KP",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shareLinkActionControl=new n.ControlFacet("getDefaultShareLinkActionControl")});
define("GP",["require","exports","lC","ih","li","xv","Rs","NP","De"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultShareLinkControlHandler=r.createControlHandler()(f);function f(){return function(e){return l}}t.getDefaultShareLinkActionControlHandler=f;function l(e,t){var r=t.itemKey,f=e.demandItem({driveItem:i.spItemKeyFacet,canonicalLinkUrl:o.canonicalUrlFacet},r),l=f.driveItem,c=f.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,f,l,c,h,p,d,v,m;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.canonicalLinkUrl;if(t&&i)return[3,1];throw new Error("Unable to obtain default share URL");case 1:o=void 0;if(i){f=new a.SPResourcePath(i);l=f.authority;for(c=0,h=f.segments;c<h.length;c++)""!==(p=h[c])&&(l=l+"/"+encodeURIComponent(p));d=u.btoa(l.toString());o="u!"+d.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}v=new a.SPResourcePath(t.webAbsoluteUrl).authority;return[4,r(s.getData({webAbsoluteUrl:v,listFullUrl:void 0,url:v+"/_api/v2.0/shares/"+o+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(m=n.sent()).value[0].link.webUrl,scope:m.value[0].link.scope}]}})})}})({driveItem:l,canonicalLinkUrl:c})}}}});
define("NP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.endsWith=function(e,t){var n=e.length,r=t.length,i=!0;if(n>=r)for(var s=0;s<r&&i;s++)e.charAt(n-(s+1))!==t.charAt(r-(s+1))&&(i=!1);else i=!1;return i};t.btoa=function(e){for(var t=e,n="",r=0,i=void 0,s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=3/4))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}});
define("gA",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateListItemOperation=new n.Facet("updateItem")});
define("zP",["require","exports","lC","Hm","xv","A8","PP"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateListItem=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,u=r.bNewDocumentUpdate,a=r.checkInComment,f=r.formValues,l=r.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,c,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:return f.length>0?[4,e(o.getSPItemInfo(t))]:[3,3];case 1:r=n.sent(),c=r.key,h=r.itemId;p=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return s.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).method("ValidateUpdateListItem").toString()})({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,itemId:h||c.itemId||""});(d={}).formValues=f;d.bNewDocumentUpdate=u;d.checkInComment=a;return[4,e(i.getData({body:JSON.stringify(d),listFullUrl:c.listFullUrl,method:"POST",qosName:l,url:p,webAbsoluteUrl:c.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:n.sent();n.label=3;case 3:return[2]}})})}})});
define("jP",["require","exports","lC","li","Hm","VP","nS","a7","cS","q6"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.refreshItemsInSet=i.createSingleItemOperationHandler()(function(e){var t=e.itemKey;return function(i){return n.__awaiter(void 0,void 0,void 0,function(){var l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:l=r.spFolderItemSetKeyFacet.deserialize(t);c=i(a.getContentTypes({itemSetKey:l}));h=Object.keys(e.options);return[4,i(s.constructRefreshItemsInSetContext({itemSetKey:t,itemKeys:h}))];case 1:p=n.sent();return[4,i(o.getServerData(p))];case 2:d=n.sent();v=i(u.processResponse({serverData:d,itemSetKey:l,currentPageContext:p.currentPageContext,contentTypes:c,isItemSetRequest:!0})).itemResolver;i(v.execute());i(f.invokeHostResponseCallback({itemSetKey:t,serverData:d,isItemSetRequest:!0}));return[2]}})})}})});
define("VP",["require","exports","lC","xo","ii","re","li","Ik","rs","Xy"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spDataSourceConfigurationFacet=i.spDataSourceConfigurationFacet;t.spPrefetchDataConfigurationFacet=i.spPrefetchDataConfigurationFacet;t.constructRefreshItemsInSetContext=function(e){return function(t){for(var l=e.itemSetKey,c=e.itemKeys,h=t(a.readItems(function(e){var t=e.demandItemFacet(o.spFolderItemSetKeyFacet,l)||o.spFolderItemSetKeyFacet.deserialize(l);return n.__assign(n.__assign({},t),{pageContext:f.getPageContextFromItemCache(e,o.spItemKeyFacet.serialize(t))})})),p=h.webAbsoluteUrl,d=h.listFullUrl,v=h.pageContext,m=[],g=0,y=c;g<y.length;g++){var b=y[g],w=o.spItemKeyFacet.deserialize(b).itemId;if(!w){w=t(r.readItem({listItemId:i.listItemIdFacet},b)).listItemId}w&&m.push(w)}var E=t(u.readItemSetSchema({internalName:i.internalNameFacet},l)),S=["Modified"];if(E)for(var x=0,T=E;x<T.length;x++){var N=T[x];N.internalName&&"Modified"!==N.internalName&&S.push(N.internalName)}return{webAbsoluteUrl:p,listFullUrl:d,currentPageContext:v,qosName:"refreshItemsInSet",viewXml:s.getViewXml({itemIds:m,recurseInFolders:!0,pageSize:c.length,fieldNames:S.length>0?S:void 0}),postDataContext:{needsSchema:!0}}}}});
define("Ik",["require","exports","Xo","xo"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.readItemSetSchema=function(e,t){return function(i){var s=i(r.readItem({schema:n.schemaFacet},t)).schema,o=s&&s.columnKeys,u=[];if(o)for(var a=0,f=o;a<f.length;a++){var l=f[a],c=i(r.readItem(e,l));u.push(c)}return u}};t.readItemSetSchemaFromItemCache=function(e,t){var r=t.mapping,i=t.itemSetKey,s=e.demandItemFacet(n.schemaFacet,i),o=s&&s.columnKeys,u=[];if(o)for(var a=0,f=o;a<f.length;a++){var l=f[a],c=e.demandItem(r,l);u.push(c)}return u}});
define("BP",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.permissionInviteActionControl=new n.ControlFacet("permissionInviteActionControl")});
define("RP",["require","exports","lC","ih","li","xv","NP","De"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.permissionInviteControlHandler=r.createControlHandler()(a);function a(){return function(e){return f}}t.getPermissionInviteActionControlHandler=a;function f(e,t){var r=t.itemKey,a=t.link,f=t.recipients,l=e.demandItem({driveItem:i.spItemKeyFacet},r).driveItem;return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,a,f,l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.link,a=e.recipients;if(!t)return[3,2];void 0;l=o.btoa(i);f="u!"+l.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");c=a.map(function(e){return{email:e}});h={recipients:c,roles:["read"]};p=new u.SPResourcePath(t.webAbsoluteUrl).authority;return[4,r(s.getData({webAbsoluteUrl:p,listFullUrl:void 0,url:p+"/_api/v2.0/shares/"+f+"/permission/invite",body:JSON.stringify(h),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))];case 1:d=n.sent();v=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:v}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}})({driveItem:l,link:a,recipients:f})}}}});
define("DL",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileHandlerActionControlFacet=new n.ControlFacet("fileHandlerActionControl");t.fileHandlerCustomActionControlFacet=new n.ControlFacet("fileHandlerCustomActionControl");t.fileHandlerOpenActionControlFacet=new n.ControlFacet("fileHandlerOpenActionControl")});
define("HP",["require","exports","li","ii","ih","ai"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileHandlerActionControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var i=t.itemKey,o=e.demandItemFacet(n.spItemKeyFacet,i);if(!o)return{};var u={webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl},a=e.demandItemFacet(r.listFacet,n.spListKeyFacet.serialize(u)),f=e.demandItemFacet(r.spPageContextFacet,n.spPageContextKeyFacet.serialize(u));if(!f)return{};var l=a&&a.templateType===s.ListTemplateType.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:f.currentUICultureName||f.currentCultureName||"en-US",client:l?"OneDrive":"SharePoint",domainHint:"organizations",userId:f.userLoginName}}}}})});
define("kL",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveItemFullUrlControlFacet=new n.ControlFacet("getDriveItemFullUrlControl")});
define("FP",["require","exports","li","ih","ph","GA","v7","Me"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveItemFullUrlControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemKey,a=void 0,f=e.demandItem({key:n.spItemKeyFacet,driveItemKey:i.driveItemKeyFacet},r),l=f.key,c=f.driveItemKey;if(c)return{driveItemFullUrl:s.getDriveItemUrl(c)};if(l){var h={webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl},p=e.demandItem({listMediaFacets:o.listMediaTransformFacet},n.spListKeyFacet.serialize(h)).listMediaFacets;if(p&&p[".driveUrl"]){var d=p[".driveUrl"],v=l.rootFolder||"",m="";if(v){var g=new u.ItemUrlHelperBasic({context:{webAbsoluteUrl:l.webAbsoluteUrl,listUrl:l.listFullUrl}}).getUrlParts();g.serverRelativeListUrl&&"/"!==(m=v.replace(g.serverRelativeListUrl,"")).charAt(0)&&(m="/"+m)}return{driveItemFullUrl:a=d+"/items/root"+(m?":":"")+m}}}return{driveItemFullUrl:a}}}})});
define("GA",["require","exports","lC","oo","QA","qA","Ev","Gs","X","Io","WA","ri","Fe","KA","w8"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveItemUrl=d.getDriveItemUrl;t.getSpecialDriveItemUrl=d.getSpecialDriveItemUrl;t.getSharesItemUrl=d.getSharesItemUrl;t.getCommandsUrlFromDriveItem=d.getCommandsUrlFromDriveItem;t.getDriveUrl=d.getDriveUrl;t.getDataRequestor=r.asOnceOnly(function(e){var t=e(u.getTelemetryManager),n=e(f.readConfiguration({graphDataRequestorConfiguration:l.graphDataRequestorConfigurationFacet,graphTokenProvider:p.graphTokenProviderConfigurationFacet})),r=n.graphDataRequestorConfiguration,s=n.graphTokenProvider,c=r&&r.alwaysSendContentType;return{dataRequestor:new i.DataRequestor({alwaysSendContentType:c},{apiEvent:a.Api.withManager(t),sessionManagementProvider:s,isOffline:function(){return new h.default(function(t,n){try{var r=e(o.isOffline()),i=void 0!==window.navigator.onLine&&!window.navigator.onLine;t(r||i)}catch(e){n(e)}})}}),hasTokenProvider:!!s&&!!s.getSessionToken}});t.getOrderByQueryParamString=function(e,t){return"&orderby=folder,"+e+" "+(t?"asc":"desc")};function v(e){var r=this,i=e.url,o=e.method,u=void 0===o?"GET":o,a=e.body,l=e.qosName,h=e.endpoint,p=e.headers,d=e.timeout,v=e.expectedErrors,m=e.driveUrl,g=e.parseResponse;return function(e){return n.__awaiter(r,void 0,void 0,function(){var r,o,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:r=e(t.getDataRequestor),o=r.dataRequestor,y=r.hasTokenProvider;b=void 0!==typeof a?JSON.stringify(a):void 0;return y?[3,2]:[4,e(s.getSessionToken(h,m))];case 1:E=x.sent();return[3,3];case 2:E=void 0;x.label=3;case 3:w=E;S=e(f.readConfiguration({clientName:c.clientNameFacet})).clientName;return[4,o.send({path:i,endpoint:h,driveUrl:m,requestType:u,apiName:l,accessToken:w,useAuthorizationHeaders:!0,postData:b,headers:S?n.__assign({"X-ClientService-ClientTag":S},p||{}):p,expectedErrors:v,timeout:d,parseResponse:g})];case 4:return[2,x.sent()]}})})}}t.getRawData=v;t.getRawDataWithCache=function(e){var t=this,r=e.url,i=e.method,s=void 0===i?"GET":i,u=e.body,a=e.qosName,f=e.timeout,l=e.endpoint,c=e.headers,h=e.expectedErrors,p=e.driveUrl,d=e.parseResponse;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,m,g,y,b,w,E;return n.__generator(this,function(n){switch(n.label){case 0:t=void 0!==typeof u?JSON.stringify(u):"";i=(function(e,t,n){var r=void 0!==n?n:"";return e+"__"+t+"__"+r})(r,s,t);m=e(o.isOffline());g=void 0!==window.navigator.onLine&&!window.navigator.onLine;y=m||g;return[4,e(o.getJSONResponse(i))];case 1:b=n.sent();if(y&&b)return[2,b];w=v({url:r,method:s,body:u,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:p,parseResponse:d});if(!b)return[3,2];e(w).then(function(t){e(o.setJSONResponse(i,t))});return[2,b];case 2:return[4,e(w)];case 3:E=n.sent();return[4,e(o.setJSONResponse(i,E))];case 4:n.sent();return[2,E]}})})}};t.isConsumerDirectEndpoint=function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){return[2,!!(t=r(f.readConfiguration({isODCEndpoint:c.isConsumerDirectEndpointFacet})).isODCEndpoint)&&t(e)]})})}};t.supportsDriveItemSetRandomAccess=function(e,t){return function(n){var r=n(f.readConfiguration({supportsRandomAccess:c.supportsDriveItemSetRandomAccessFacet})).supportsRandomAccess;return!!r&&r(e,t)}}});
define("qA",["require","exports","lC","LI","Io","Rm","E","Av","KA"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function f(e,t,f){var l=this;return function(c){return n.__awaiter(l,void 0,void 0,function(){var l,h,p,d,v,m,g,y,b,w,E,S,x=this;return n.__generator(this,function(T){switch(T.label){case 0:l=c(i.readConfiguration({graphDataSourceConfiguration:r.graphDataSourceConfigurationFacet,graphTokenProviderConfiguration:a.graphTokenProviderConfigurationFacet})),h=l.graphDataSourceConfiguration,p=l.graphTokenProviderConfiguration;d=h&&h.ensureAuthToken;v=f&&h&&h.ensureAuthTokenWithAction;m=p&&p.getSessionToken;if(!(y=m?function(){return n.__awaiter(x,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,m({endpoint:t,driveUrl:f,path:f||t})];case 1:return[2,e.sent().accessToken]}})})}:v?function(){return n.__awaiter(x,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,c(v(e,t,f))];case 1:return[2,n.sent()]}})})}:d?function(){return n.__awaiter(x,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,d(e,t)];case 1:return[2,n.sent()]}})})}:void 0))return[3,4];b=c(s.logQoS({name:"graphDataSource.getAuthToken"}));T.label=1;case 1:T.trys.push([1,3,,4]);return[4,y()];case 2:g=T.sent();c(b({resultType:o.ResultTypeEnum.Success}));return[3,4];case 3:w=T.sent();E=o.ResultTypeEnum.Failure;S=void 0;if(w instanceof u.ApiError){w.isExpected&&(E=o.ResultTypeEnum.ExpectedFailure);S=w.code}else S=w instanceof Error?w.name+"("+w.message+")":"UnknownAuthError";c(b({resultType:E,resultCode:S,error:w&&JSON.stringify(w)}));throw w;case 4:return[2,g]}})})}}t.getAuthToken=f;t.getSessionToken=function(e,t){var r=this;return function(i){return n.__awaiter(r,void 0,void 0,function(){var r,s;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i(f(["Files.ReadWrite.All"],e,t))];case 1:(r=n.sent())&&(s={accessToken:r});return[2,s]}})})}}});
define("KA",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphTokenProviderConfigurationFacet=new n.Facet("graphTokenProvider")});
define("WA",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphDataRequestorConfigurationFacet=new n.Facet("graphDataRequestorConfiguration")});
define("UP",["require","exports","lC","li","Hm","xo","ii","Xo","Vm","Gk","d7","Y","y7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumnAggregateType=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options,p=i.aggregateType,d=i.columnKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,v,m,g,y,b,w,E,S,x,T,N,C;return n.__generator(this,function(n){switch(n.label){case 0:if(!(i=e(s.readItem({setKey:r.spFolderItemSetKeyFacet},t)).setKey))return[3,2];if(!(v=i.viewKey?r.spViewKeyFacet.serialize(i.viewKey):void 0))return[3,2];if(!(m=e(s.readItem({currentDerivedView:o.currentDerivedViewFacet},v)).currentDerivedView))return[3,2];g=e(s.readItem({internalName:o.internalNameFacet,fieldType:o.fieldTypeFacet,fieldFieldType:o.fieldFieldTypeFacet},d)),y=g.internalName,b=g.fieldType,w=g.fieldFieldType;if(!y)return[3,2];E=e(s.readItem({spFolderAggregates:o.columnTotalsFacet},t)).spFolderAggregates;S=m.isDirty();if(!(x=E&&E[d]?E[d].aggregateFunctionType:void 0)&&0===p||x===l.ColumnAggregateTypeName[p])return[2];T=0===p?void 0:l.ColumnAggregateTypeName[p];m.updateColumnAggregateType(y,T);return[4,e(f.saveViewCore({items:(N={},N[r.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})]={views:(C={},C[v]={shouldSaveAggregationsOnly:!0},C),qosName:"SaveModifyColumnAggregateType"},N)})).then(function(){var n,r=m.getEffectiveViewXml(),i=new h.default(m.baseViewXml||"");i.replaceAggregates(m.getEffectiveAggregatesData());m.baseViewXml=i.getEffectiveViewXml();m.setDom(r);m.setIsDirty(S);var s=new a.ItemResolver;s.invalidateItems({items:(n={},n[t]=[u.childItemsFacet],n[v]=[o.spAggregatesFacet],n)});e(s.execute())},function(e){c.default.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:b,fieldFieldType:w,currentAggregateType:x||"None",newAggregateType:T||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});m.updateColumnAggregateType(y,x);m.setIsDirty(S);throw e})];case 1:n.sent();n.label=2;case 2:return[2]}})})}})});
define("TP",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumnAggregateTypeOperation=new n.Facet("modifyColumnAggregateType");t.modifyColumnAggregateType=r.implementOperation({operationTypeFacet:t.modifyColumnAggregateTypeOperation})});
define("MP",["require","exports","lC","li","Hm","xo","ii","PP","A8","xv","jL"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.bulkUpdateListItems=i.createSingleItemOperationHandler()(function(e){var t=e.itemKey,i=e.options,c=i.itemKeys,h=i.bNewDocumentUpdate,p=i.checkInComment,d=i.formValues,v=i.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(n){switch(n.label){case 0:if(!(d&&d.length&&c&&c.length))return[2];i=r.spFolderItemSetKeyFacet.deserialize(t),m=i.viewKey,g=i.rootFolder,y=i.webAbsoluteUrl,b=i.listFullUrl;w=g||"";m&&(!(E=e(s.readItem({currentDerivedView:o.currentDerivedViewFacet},r.spViewKeyFacet.serialize(m))).currentDerivedView)||1!==E.scope&&2!==E.scope||(w=""));S=[];x={};T=0,N=c;n.label=1;case 1:if(!(T<N.length))return[3,4];C=N[T];return[4,e(u.getSPItemInfo(C))];case 2:k=n.sent().itemId;S.push(parseInt(k,10));x[k]=C;n.label=3;case 3:T++;return[3,1];case 4:L=a.getListApiUrl({webAbsoluteUrl:y,listFullUrl:b}).method("BulkValidateUpdateListItems").toString();A={itemIds:S,formValues:d,folderPath:w,bNewDocumentUpdate:h,checkInComment:p};return[4,e(f.getData({body:JSON.stringify(A),listFullUrl:b,method:"POST",qosName:v,url:L,webAbsoluteUrl:y,noRedirect:!0})).then(function(n){for(var r,i="",s={},o=0,u=n.d.BulkValidateUpdateListItems.results;o<u.length;o++){var a=u[o];if(a.HasException)i=a.ErrorMessage+"\n"+i;else{x[a.ItemId]&&(s[x[a.ItemId]]={})}}Object.keys(s).length>0&&e(l.refreshItemsInSet({items:(r={},r[t]=s,r)}));if(i)throw new Error(i)})];case 5:n.sent();return[2]}})})}})});
define("EA",["require","exports","lC","li","LA","Hm","xo","LO","si","Gm","Xo","Vm","AA","sS","Io","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemUploadItemsOperationHandler=s.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,s=e.itemKey,m=e.options.sourceEntries,g=r.spItemKeyFacet.deserialize(s),y=g.webAbsoluteUrl,b=g.listFullUrl,w=Object.keys(m)[0],E=m[w].progressItemKey;return function(m){return n.__awaiter(t,void 0,void 0,function(){var t,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:t=m(o.readItem({sourceFile:u.sourceFileFacet},w)).sourceFile;S=m(d.readConfiguration({listItemUploader:v.listItemUploaderConfigurationFacet})).listItemUploader,x=void 0===S?i.uploadListItem:S;return[4,m(x(e))];case 1:T=M.sent().itemKey;N=new c.ItemResolver;E&&t&&N.resolveItems({items:(L={},L[E]=n.__assign(n.__assign({},f.createdItemFacet.pack({itemKey:T})),a.pack({progressSize:f.progressSizeFacet},{progressSize:{current:t.size}})),L)});N.invalidateItems({items:(A={},A[s]=[l.defaultChildItemSetFacet],A)});if(g.listFullUrl){C=new p.SimpleUri(g.listFullUrl+"/Forms").path;if(g.rootFolder&&(g.rootFolder+"/").slice(0,C.length+1)===C+"/"){k=r.spListKeyFacet.serialize({webAbsoluteUrl:y,listFullUrl:b});m(h.saveUploadedTemplateToView({items:(O={},O[k]={childItemKey:T},O)}))}}m(N.execute());return[2]}})})}})});
define("AA",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveUploadedTemplateToViewOperation=new n.Facet("saveUploadedTemplateToView");t.saveUploadedTemplateToView=r.implementOperation({operationTypeFacet:t.saveUploadedTemplateToViewOperation})});
define("jA",["require","exports","lC","sS","li","ii","xv","ko","xo","$1","zm","Hm","Gm","Xo","Rs","A8","S0","P1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemCreateFolderOperationHandler=c.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,c=e.itemKey,v=e.options.folders;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,w,E,S,x,T,N,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:t=Object.keys(v)[0];m=i.spItemKeyFacet.deserialize(c);w=m.rootFolder||new r.SimpleUri(m.listFullUrl).path;E=i.spListKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl});S=e(a.readItem({list:s.listFacet},E));x=y({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,parentFolderPath:w,isDocLib:!!S&&!!S.list&&S.list.isDocumentLibrary,folderName:t});return[4,e(o.getData({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,url:x,method:"POST",qosName:"createFolder",telemetryHandler:function(e){var t=e.errorData,r=e.eventData;if(t){var i=t.code,s=i&&(i.indexOf("-2130575257")>-1||i.indexOf("-2130575245")>-1||i.indexOf("-2130247139")>-1)?g.ResultType.expectedFailure:g.ResultType.failure;return{eventData:n.__assign(n.__assign({},r),{resultType:s})}}return{eventData:r}}})).catch(function(e){if(e instanceof o.GetDataError&&e.message&&w){var t=w;"/"===t[0]&&(t=t.substr(1));"/"!==t[t.length-1]&&(t+="/");e.message=e.message.replace(t,"")}throw new u.ItemOperationError({innerError:e,facets:b(e)})})];case 1:A.sent();if(T=v[t].progressItemKey){N=w+"/"+t;C=i.spItemKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,rootFolder:N});e(f.resolveItems({items:(k={},k[T]=n.__assign({},h.createdItemFacet.pack({itemKey:C})),k[C]=n.__assign(n.__assign({},s.folderPathFacet.pack(N)),d.parentFolderItemFacet.pack({itemKey:c})),k)}))}e(l.invalidateItems({items:(L={},L[c]=[p.defaultChildItemSetFacet],L)}));return[2]}})})}});function y(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.parentFolderPath,i=e.isDocLib,s=void 0===i||i,o=e.folderName,u=v.getWebApiUrl({webAbsoluteUrl:t,listOrItemFullUrl:n}),a=o?o.trim():"";return(u=s?(u=u.segment("folders")).methodWithAliases("AddUsingPath",{DecodedUrl:r+"/"+a,overwrite:!1}).oDataParameter("$Expand","ListItemAllFields/PermMask"):u.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:r}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:a||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}t.getCreateFolderUrl=y;function b(e){if(e instanceof o.GetDataError){switch((function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]})(e)){case-2147023080:case-2130575282:return m.overQuotaErrorFacet.pack({})}}}});
define("BA",["require","exports","lC","Hm","mA"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCreateDocumentUrl=i.getCreateDocumentUrl;t.getRedirectUrlFromResponse=i.getRedirectUrlFromResponse;t.spItemCreateDocumentOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(t){var r=this;return function(i){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["pA"],t,n)})];case 1:return[4,(0,n.sent().createDocumentsCore)(i,t)];case 2:n.sent();return[2]}})})}})});
define("mA",["require","exports","_A","_g","eA","A8"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRedirectUrlFromResponse=function(e){var t=e.responseText,r=e.documentType,i=e.fileName,s="",o="";if(null!=t){var u=JSON.parse(t);if(null!==u&&null!==u.d&&null!==u.d.CreateDocumentAndGetEditLink){o=u.d.CreateDocumentAndGetEditLink;s=n.getRedirectToEditNewDocument(o,r,i||"",!1)}else try{o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"";s=n.getRedirectToEditNewDocument(o,r,i||"",!1)}catch(e){}}return{originalEditLink:o,redirectUrl:s}};t.getCreateDocumentUrl=function(e){var t=r.DocumentType.Visio,n=e.webAbsoluteUrl,o=e.listFullUrl,u=e.parentFolderPath,a=e.templateUrl,f=e.docName,l=e.docType;if(null!==l&&l>=r.DocumentType.Word&&l<=t&&l!==r.DocumentType.Text){if(l!==r.DocumentType.OneNote||f){if(f){f+=i.getDocExtension(l)}}else f="Notebook"+Math.floor(100*Math.random())+1;f||(f="");l===r.DocumentType.ExcelForm&&(l=r.DocumentType.ExcelSurvey);return s.getListApiUrl({webAbsoluteUrl:n,listFullUrl:o}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:f,folderPath:u,documentTemplateType:l,templateUrl:a||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}});
define("_A",["require","exports","e4","pe","hA"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkFilename=function(e,t,n){var i=void 0;"string"==typeof e?0===(e=e.trim()).length?i=t.emptyNameError:/["\*:<>\?\/\\\|]/.test(e)&&(i=r.format(n?t.invalidNameError2:t.invalidNameError,e)):i=t.emptyNameError;return i};t.getRedirectToEditNewDocument=function(e,t,r,s){var o="";null!==e&&""!==e&&(o=t===n.DocumentType.ExcelSurvey?e.replace("action=edit","action=formedit"):t===n.DocumentType.ExcelForm?i.getCreateFormUrlCore(e,r,s):e.replace("action=edit","action=editnew"));return o}});
define("hA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GetCreateFormUrl=function(e,t,r){return n(t,r,"edog"===e.env.toLowerCase())};function n(e,t,n){var r=e.replace("&action=edit",""),i=n?"forms.officeppe.com":"forms.office.com",s="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(r)+"&Title="+encodeURIComponent(t);return"https://"+i+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(s)}t.getCreateFormUrlCore=n});
define("kP",["require","exports","si","jm"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeItemsFromSharedListOperation=new n.Facet("removeItemsFromSharedList");t.removeFromSharedListProgressKeyFacet=new r.ProgressKeyFacet("removeItemsFromSharedList");t.removeItemsFromSharedList=r.implementOperationWithProgress({operationTypeFacet:t.removeItemsFromSharedListOperation,progressKeyFacet:t.removeFromSharedListProgressKeyFacet})});
define("LP",["require","exports","lC","ko","rs","Rs","Hm","Vm","Xo","Nm","A8","xv","li","sA","lh","sS"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemRemoveItemsFromSharedListOperationHandler=o.createBatchedItemsOperationHandler()(function(e){var t=e.items,o=t[Object.keys(t)[0]].itemSetKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,g,y,b,w,E,S,x,T,N;return n.__generator(this,function(n){switch(n.label){case 0:h=[];return[4,e(m({itemSetKey:o}))];case 1:d=n.sent();v=function(t){var n=e(i.readItems(function(e){return e.demandItemFacet(s.canonicalUrlFacet,t)}))||"",r={DecodedUrl:decodeURIComponent(n)};r&&h.push(r)};for(g=0,y=Object.keys(t);g<y.length;g++){b=y[g];v(b)}p=JSON.stringify({itemPaths:h});w="RemoveItemsFromSharedWithMeViewByPath";E=l.getStaticApiUrl({webAbsoluteUrl:d}).segment("SP.Sharing.DocumentSharingManager."+w);return[4,e(c.getData({url:E.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:d,body:p,noRedirect:!0}))];case 2:if((S=n.sent())&&S.d&&S.d[w]&&S.d[w].results){if((x=S.d[w].results).length<1)throw new r.ItemOperationError({message:f.default.DefaultTitle});x.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new r.ItemOperationError({message:e.ErrorMessage||void 0})})}(T=new u.ItemResolver).invalidateItems({items:(N={},N[o]=[a.childItemsFacet],N)});e(T.execute());return[2]}})})}});function m(e){var t=this,r=e.itemSetKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o;return n.__generator(this,function(n){switch(n.label){case 0:"";t=e(i.readItems(function(e){return e.demandItemFacet(d.sharedWithMeItemSetKeyFacet,r)}));s=t&&t.driveItemKey.endpoint||"";return[4,e(p.demandItems(function(e){return e.demandItemFacet(h.spItemKeyFacet,h.spOneDriveDocumentLibraryKeyFacet.serialize({tenantRootUrl:new v.default(s).authority}))}))];case 1:o=n.sent();return[2,o&&o.webAbsoluteUrl||""]}})})}}});
define("sA",["require","exports","lC","AO","cA","YD"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("AO",["require","exports","lC","$1","Jr","X1","kb","fi","Nr","si","Hm","Xo","Rs","rs","Vm","h7","LO","$f","oo","Uo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=y.asOnceOnly(function(e){var t,n=[];return function(r){var i=new b.Signal,s=i.resolve,o=i.promise;n.push({resolve:s,itemResolver:r});t||(t=setTimeout(function(){(function(){var r=n;n=[];t=void 0;var i=[];e(g.asBatch(function(){for(var t=0,n=r;t<n.length;t++){var s=n[t],o=s.resolve,u=s.itemResolver;i.push(o);e(u.execute())}}));for(var s=0,o=i;s<o.length;s++){(0,o[s])()}})()},500));return o}}),E=new a.AutoKeyFacet("batch");var S=new u.KeyFacet("batchChildren",{batch:u.subKeyPart(E)}),x=new u.KeyFacet("fileEntry",{batch:u.subKeyPart(E),index:u.numberPart(),path:u.stringPart()}),T=new u.KeyFacet("fileEntryChildren",{fileEntry:u.subKeyPart(x)}),N=new u.KeyFacet("fileEntryDirectoryPage",{fileEntryChildren:u.subKeyPart(T),startIndex:u.numberPart()}),C=new f.Facet("entry"),k=new f.Facet("rootEntries"),L=new f.Facet("directoryPage");t.fileEntryAddon=l.createAddon(function(){return function(e){e(g.asBatch(function(){e(i.supportFacets({keyFacet:E,facets:[c.defaultChildItemSetFacet]}));e(i.supportFacets({keyFacet:S,facets:[c.childItemsFacet]}));e(i.supportFacets({keyFacet:x,facets:[h.displayNameFacet,c.defaultChildItemSetFacet,m.sourceFileFacet,h.fileSizeFacet,h.fileNameFacet,h.folderFacet,h.parentFolderItemFacet,h.dateModifiedFacet]}));e(i.supportFacets({keyFacet:T,facets:[c.childItemsFacet]}));e(i.supportFacets({keyFacet:N,facets:[c.childItemsFacet]}));e(l.registerOperationHandler(E,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:8})(A)));e(l.registerOperationHandler(S,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:8})(O)));e(l.registerOperationHandler(x,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:128})(M)));e(l.registerOperationHandler(T,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:32})(_)));e(l.registerOperationHandler(N,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:32})(D)));e(l.registerOperationHandler(E,o.deleteItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:8})(P)))}))}});t.createEntryBatch=function(e){return function(r){var i;r(t.fileEntryAddon);var s=E.serializeNext(),o=new d.ItemResolver;o.resolveItems({items:(i={},i[s]=n.__assign(n.__assign({},m.entryBatchFacet.pack({})),k.pack(e.entries)),i)});r(o.execute());return{itemKey:s}}};function A(e){var t=this,r=e.itemKey,i=E.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s;return n.__generator(this,function(o){switch(o.label){case 0:if(!e(p.readItems(function(e){return e.demandItemFacet(k,r)})))return[3,2];(t=new d.ItemResolver).resolveItems({items:(s={},s[r]=n.__assign(n.__assign({},m.entryBatchFacet.pack({})),c.defaultChildItemSetFacet.pack({itemKey:S.serialize({batch:i})})),s)});return[4,e(w)(t)];case 1:o.sent();o.label=2;case 2:return[2]}})})}}function O(e){var t=this,r=e.itemKey,i=S.deserialize(r).batch,s=E.serialize(i);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,u,a,f,l,h,v,m,g;return n.__generator(this,function(y){switch(y.label){case 0:if(!(t=e(p.readItems(function(e){return e.demandItemFacet(k,s)}))))return[3,2];o=new d.ItemResolver;u=[];a=0;for(f=0,l=t;f<l.length;f++){h=l[f];v=x.serialize({batch:i,index:a,path:h.name});o.resolveItems({items:(m={},m[v]=n.__assign({},C.pack(h)),m)});u.push(v);a++}o.resolveItems({items:(g={},g[r]=n.__assign({},c.childItemsFacet.pack({itemKeys:u})),g)});return[4,e(w)(o)];case 1:y.sent();y.label=2;case 2:return[2]}})})}}function M(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u;return n.__generator(this,function(a){switch(a.label){case 0:if(!(t=e(p.readItems(function(e){return e.demandItemFacet(C,r)}))))return[2];(i=new d.ItemResolver).resolveItems({items:(o={},o[r]=n.__assign(n.__assign(n.__assign({},h.displayNameFacet.pack(t.name)),2===t.type?n.__assign(n.__assign(n.__assign({},h.folderFacet.pack({})),h.fileNameFacet.pack({name:t.name,extension:""})),c.defaultChildItemSetFacet.pack({itemKey:T.serialize({fileEntry:x.deserialize(r)})})):n.__assign(n.__assign({},c.defaultChildItemSetFacet.pack(void 0)),h.folderFacet.pack(void 0))),1===t.type?n.__assign({},h.fileNameFacet.pack(H(t.name))):{}),o)});return 1!==t.type&&0!==t.type?[3,2]:[4,t.getFile()];case 1:s=a.sent();i.resolveItems({items:(u={},u[r]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},h.fileNameFacet.pack(H(s.name))),h.folderFacet.pack(void 0)),h.fileSizeFacet.pack(s.size)),h.dateModifiedFacet.pack(s.lastModified)),m.sourceFileFacet.pack(s)),u)});a.label=2;case 2:return[4,e(w)(i)];case 3:a.sent();return[2]}})})}}function _(e){var t=this,r=e.itemKey,i=T.deserialize(r),s=i.fileEntry,o=x.serialize(s);return function(e){return n.__awaiter(t,void 0,void 0,function(){function t(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,u,c,p;return n.__generator(this,function(d){switch(d.label){case 0:e=a.entries,t=a.getEntries;for(r=0,i=e;r<i.length;r++){u=i[r];c=x.serialize(n.__assign(n.__assign({},s),{index:l,path:s.path+"/"+u.name}));m.resolveItems({items:(p={},p[c]=n.__assign(n.__assign({},C.pack(u)),h.parentFolderItemFacet.pack({itemKey:o})),p)});f.push(c);l++}return t?[4,t()]:[3,2];case 1:a=d.sent();d.label=2;case 2:return[2,!!t]}})})}var u,a,f,l,m,g,y,b,E;return n.__generator(this,function(h){switch(h.label){case 0:return(u=e(p.readItems(function(e){return e.demandItemFacet(C,x.serialize(s))})))&&2===u.type?[4,u.getEntries()]:[2];case 1:a=h.sent();f=[];l=0;m=new d.ItemResolver;return[4,t()];case 2:return(g=h.sent())?[4,t()]:[3,4];case 3:g=h.sent();h.label=4;case 4:if(g){y=N.serialize({fileEntryChildren:i,startIndex:l});m.merge(v.resolveNewPage({itemKey:y}).itemResolver);m.resolveItems({items:(b={},b[y]=n.__assign({},L.pack(a)),b)});f.push(y)}m.resolveItems({items:(E={},E[r]=n.__assign(n.__assign({},c.childItemsFacet.pack({itemKeys:f})),c.parentItemFacet.pack({itemKey:o})),E)});return[4,e(w)(m)];case 5:h.sent();return[2]}})})}}function D(e){var t=this,r=e.itemKey,i=N.deserialize(r),s=i.fileEntryChildren,o=i.startIndex,u=s.fileEntry,a=x.serialize(u);return function(e){return n.__awaiter(t,void 0,void 0,function(){function t(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,s,o,p;return n.__generator(this,function(d){switch(d.label){case 0:e=f.entries,t=f.getEntries;for(r=0,i=e;r<i.length;r++){s=i[r];o=x.serialize(n.__assign(n.__assign({},u),{index:l,path:u.path+"/"+s.name}));m.resolveItems({items:(p={},p[o]=n.__assign(n.__assign({},C.pack(s)),h.parentFolderItemFacet.pack({itemKey:a})),p)});c.push(o);l++}return t?[4,t()]:[3,2];case 1:f=d.sent();d.label=2;case 2:return[2,!!t]}})})}var i,f,l,c,m,g,y,b;return n.__generator(this,function(u){switch(u.label){case 0:return(i=e(p.readItems(function(e){return e.demandItemFacet(L,r)})))&&i.getEntries?[4,i.getEntries()]:[2];case 1:f=u.sent();l=o;c=[];m=new d.ItemResolver;return[4,t()];case 2:return(g=u.sent())?[4,t()]:[3,4];case 3:g=u.sent();u.label=4;case 4:if(g){y=N.serialize({fileEntryChildren:s,startIndex:l});m.merge(v.resolveNewPage({itemKey:y}).itemResolver);m.resolveItems({items:(b={},b[y]=n.__assign({},L.pack(f)),b)});c.push(y)}m.merge(v.resolveExistingPage({itemKey:r,itemSetKey:T.serialize(s),childItemKeys:c}).itemResolver);return[4,e(w)(m)];case 5:u.sent();return[2]}})})}}function P(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){e(s.clearItems({items:e(p.readItems(function(e){for(var t,n={},i=[r];t=i.pop();){n[t]=!0;var s=e.demandItemFacet(c.defaultChildItemSetFacet,t),o=s&&s.itemKey;o&&(n[o]=!0);var u=e.demandItemFacet(c.childItemsFacet,o),a=u&&u.itemKeys;a&&i.push.apply(i,a)}return n}))}));return[2]})})}}function H(e){var t=e.lastIndexOf(".");return t>-1?{name:e.slice(0,t),extension:e.slice(t)}:{name:e,extension:""}}});
define("cA",["require","exports","lC","ko","VD","ho","jm","Vm","Gm","si","Xo","qr","Jf","Po","dA"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveCopyItems=s.createAsyncActionCreator(function(e){return function(t){return n.__awaiter(void 0,void 0,void 0,function(){var s,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F;return n.__generator(this,function(I){switch(I.label){case 0:s=[];t(d.moveCopyProgressAddon);for(v=0,m=Object.keys(e.items);v<m.length;v++){g=m[v];y=e.items[g];b=o.progressBatchKeyFacet.serializeNext();w=i.moveCopyItemsProgressKeyFacet.serializeBatchKey(b);E=[];S=new u.ItemResolver;for(x=0,T=Object.keys(y);x<T.length;x++){k=T[x];L=((D={})[k]=y[k],D);A=i.moveCopyItemsProgressKeyFacet.serializeTaskKey(b,k,L);S.resolveItems({items:(P={},P[A]=n.__assign(n.__assign(n.__assign(n.__assign({},a.sourceItemFacet.pack({itemKey:k})),a.destinationItemFacet.pack({itemKey:g})),f.pack({options:i.moveCopyItemsOperation},{options:L})),a.progressPhaseFacet.pack(a.ProgressPhase.created)),P)});E.push(A)}S.resolveItems({items:(H={},H[o.progressRootItemKey]=f.pack({childItems:l.childItemsFacet},{childItems:{itemKeys:new c.ArrayConcatIfNotMatchKeyPatch([w],function(e){return e})}}),H[w]=n.__assign(n.__assign({},f.pack({childItems:l.childItemsFacet},{childItems:{itemKeys:new c.ArrayConcatIfNotMatchKeyPatch(E,function(e){return e})}})),h.isGroupFacet.pack(!0)),H)});t(S.execute());for(N=0,C=Object.keys(y);N<C.length;N++){k=C[N];L=((B={})[k]=y[k],B);A=i.moveCopyItemsProgressKeyFacet.serializeTaskKey(b,k,L);O=t(r.startOperation({operationTypeFacet:i.moveCopyItemsOperation,items:(j={},j[g]=(F={},F[k]=n.__assign(n.__assign({},y[k]),{progressItemKey:A}),F),j)})),M=O.completed,_=O.items;t(o.trackItemProgress(n.__assign({progressItemKey:A,progressSize:1},_[g])));s.push(M)}}return[4,p.waitForAll(s)];case 1:I.sent();return[2]}})})}})});
define("VD",["require","exports","lC","si","ko","jm"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveCopyItemsOperation=new r.Facet("moveCopyItems");t.moveCopyItemsProgressKeyFacet=new s.ProgressKeyFacet("moveCopyItems");var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(i.ItemOperationError);t.MoveCopyItemOperationError=o});
define("dA",["require","exports","lC","Hm","ih","Fm","VD","Rs","jm","lA","Gm","Xo","me"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";var p,d;Object.defineProperty(t,"__esModule",{value:!0});var v=((p={})[l.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveStartedItemsTitle,f.default.moveCompletedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveCompletedItemsTitle,f.default.moveCompletedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveFailedItemsTitle,f.default.moveFailedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveFailedItemsTitle,f.default.moveFailedItemsTitleIntervals,e)||"",e)},p),m=((d={})[l.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyStartedItemsTitle,f.default.copyCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyCompletedItemsTitle,f.default.copyCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyFailedItemsTitle,f.default.copyFailedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyFailedItemsTitle,f.default.copyFailedItemsTitleIntervals,e)||"",e)},d);t.moveCopyProgressAddon=r.createAddon(function(){return function(e){e(i.registerControlHandler(o.moveCopyItemsProgressKeyFacet,s.progressControl)(i.createControlHandler()(g)))}});function g(){return function(e){return y}}function y(e,t){var r,i=t.itemKey;if("item"===t.format){(l=e.demandItemFacet(o.moveCopyItemsOperation,i))&&(r=e.demandItemFacet(u.displayNameFacet,i))}else{var s=e.demandItemFacet(c.childItemsFacet,i),f=s&&s.itemKeys;if(f&&f[0]){var l;if(l=e.demandItemFacet(o.moveCopyItemsOperation,f[0])){var h=l[Object.keys(l)[0]].isMove,p=a.getOverallSimpleProgressBreakdown(e,t),d=p.phase,g=p.count;r=h?v[d](g):m[d](g)}}}return n.__assign({},r?{title:r}:{})}});
define("gP",["require","exports","lC","Hm","ih","Ab","li","kb","Nb","AP","Rb","CP","f1","IP","Lb","yP","vP"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointBasicActionsAddonDeferred=r.createAddon(function(){return function(t){t(r.registerOperationHandler(o.spItemKeyFacet,u.deleteItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["DA"],t,n)})];case 1:return[2,t.sent().spItemDeleteItemsOperationHandler]}})})})));t(r.registerOperationHandler(o.spItemKeyFacet,a.renameItemOperation)(f.renameItem));t(i.registerControlHandler(o.spItemKeyFacet,l.renameActionControl)(c.renameActionControlHandler));t(i.registerControlHandler(o.spItemKeyFacet,h.downloadItemsActionControlFacet)(p.downloadItemsActionControlHandler));t(i.registerControlHandler(o.spItemKeyFacet,d.deleteActionControler)(v.deleteActionControlerHandler));t(i.registerControlHandler(o.spItemKeyFacet,s.deleteItemsActionControl)(m.deleteItemsActionControlerHandler))}})});
define("Nb",["require","exports","si","jm","fi"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameItemOperation=new n.Facet("renameItem");var s=new i.KeyFacet("renameItemProgressItem",{itemKey:i.stringPart(),oldName:i.stringPart()});t.renameProgressKeyFacet=new r.ProgressKeyFacet("renameItems",function(e,t){var n=Object.keys(t.names)[0];return s.serialize({itemKey:e,oldName:n})});t.renameItem=r.implementOperationWithProgress({operationTypeFacet:t.renameItemOperation,progressKeyFacet:t.renameProgressKeyFacet})});
define("AP",["require","exports","lC","Hm"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameItem=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(t){return function(r){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["fA"],t,n)})];case 1:return[4,(0,n.sent().renameItemCore)(r,t)];case 2:n.sent();return[2]}})})}})});
define("Rb",["require","exports","Dr","ec"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameActionControl=new n.ControlFacet("renameActionControl",{renameWizard:r.defaultRenderComponentOption()})});
define("CP",["require","exports","lC","li","ii","T3","EP","ih","Rs","OP","Rs","SP"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameActionControlHandler=u.createControlHandler()(function(){return function(e){return function(e,t){var u,h=t.itemKey,p=e.demandItem({key:r.spItemKeyFacet,permissions:i.permissionsFacet,isCheckedOut:a.isCheckedOutFacet,isFolder:l.folderFacet,rowData:i.rowDataFacet},h),d=p.key,v=p.permissions,m=p.isCheckedOut,g=p.isFolder,y=p.rowData,b=d&&e.demandItemFacet(i.spPageContextFacet,r.spPageContextKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})),w=void 0,E=!1,S=f.nameValidator;if(b){w=y&&m&&!!m.byOther;var x=e.demandItemFacet(i.mountPointFacet,h,{suppressGetItems:!0}),T=c.isProgIdTeamChannelFolder(null===(u=y)||void 0===u?void 0:u.ProgId);E=!(x||b.isAnonymousGuestUser||T)&&s.PermissionMask.hasItemPermission({permissions:v},s.PermissionMask.deleteListItems)&&s.PermissionMask.hasItemPermission({permissions:v},s.PermissionMask.editListItems);b.supportPercentStorePath&&b.supportPoundStorePath||(S=f.nameValidatorWithoutPoundPercent)}var N={},C=d&&e.demandItemFacet(i.listFacet,r.spListKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));if(w){N.lockedWarningMessage=o.default.FileCheckedoutOrLockedWarning;N.title=o.default.FileCheckedoutOrLockedWarningTitle}else if(C&&C.isForceCheckout&&m&&!m.byYou&&!g){N.lockedWarningMessage=o.default.CheckoutRequired;N.title=o.default.Error}return n.__assign({isAvailable:E,validator:S,isFolder:!!g},N)}}})});
define("OP",["require","exports","me","wP"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e[e.InvalidStart=0]="InvalidStart";e[e.InvalidEnd=1]="InvalidEnd";e[e.InvalidCharacters=2]="InvalidCharacters";e[e.Empty=3]="Empty"})(i=t.ValidatorErrorType||(t.ValidatorErrorType={}));function s(e,t){var n=e.trim();return 0===n.length?i.Empty:t.invalidCharactersRegex.test(n)?i.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?i.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?i.InvalidEnd:void 0}t.isNameValid=s;function o(e,t){switch(e){case i.InvalidCharacters:return n.format(r.default.invalidNameError,t.invalidCharacters);case i.InvalidStart:return n.format(r.default.invalidNameStartError,t.cannotStartWith);case i.InvalidEnd:return n.format(r.default.invalidNameEndError,t.cannotEndWith);case i.Empty:return r.default.emptyNameError;case void 0:return}}t.getErrorString=o;function u(e){return function(t){return o(s(t,e),e)}}t.createNameValidator=u;t.nameValidator=u({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'});t.nameValidatorWithoutPoundPercent=u({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})});
define("SP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isProgIdTeamChannelFolder=function(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}});
define("IP",["require","exports","lC","r","ii","li","xv","$8","ai","T3","xP","de","ih","Rs","t5","A8","jS","oi","A1","sS","u9","Rf"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function S(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(t,n.__assign({},i,{preferOpenInBrowser:!0})):null}function x(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(t,n.__assign({},i,{preferSameWindow:!0})):null}t.downloadItemsActionControlHandler=h.createControlHandler()(function(){return function(e){var t=new E.PlatformDetection;return function(e,r){var h=r.itemKeys,E=h[0],C=e.demandItemFacet(p.folderFacet,E),k=e.demandItemFacet(g.oneNoteFacet,E);return 1!==h.length||C||k?h.length>0?(function(e,t){var r=t.itemKeys,l=e.demandItemFacet(s.spItemKeyFacet,r[0]);if(!l||!l.webAbsoluteUrl||!l.listFullUrl)return{};var h=l.webAbsoluteUrl,v=l.listFullUrl,w=s.spListKeyFacet.serialize({webAbsoluteUrl:h,listFullUrl:v}),E=e.demandItem({listFacets:i.listFacet,downloadZipApiUrl:d.downloadAsZipApiUrlFacet},w),S=E.listFacets,x=E.downloadZipApiUrl;if(!S||!x||S.templateType===a.ListTemplateType.webPageLibrary)return{};for(var N=[],C=y.getConfiguration(e,{enableOAuthTokenInDownload:i.enableOAuthTokenInDownloadConfigurationFacet}).enableOAuthTokenInDownload,k=void 0!==C&&C,L=!1,A=0,O=r;A<O.length;A++){var M=O[A],_=e.demandItem({name:p.displayNameFacet,size:p.fileSizeFacet,itemUrl:p.vroomUrlFacet,folder:p.folderFacet,permissions:i.permissionsFacet,itemComplianceStatus:m.itemComplianceStatusFacet,isOneNote:g.oneNoteFacet},M),D=_.name,P=_.size,H=_.itemUrl,B=_.folder,j=_.permissions,F=_.itemComplianceStatus;if(_.isOneNote)return{isAvailable:!1};var I=void 0,q=void 0,R=e.demandItemFacet(i.mountPointFacet,M,{suppressGetItems:!0});if(R){I=void 0;q=new b.SimpleUri(R.siteUrl).authority+"/_api/v2.1/drives/"+R.driveId+"/items/"+R.itemId;L=!0}else{if(!H)return{};I=e.demandItemFacet(d.driveAccessTokenFacet,w);q=u.getItemUrlWithToken(H,(I?I.accessToken:void 0)||"")}if(q){var U=!!B;3!==F&&4!==F&&f.PermissionMask.hasItemPermission({permissions:j},f.PermissionMask.openItems)&&N.push({name:D||"",size:P||0,docId:q,isFolder:U})}}if(0===N.length)return{};return{isAvailable:!0,getDownloadData:function(){return(function(e){var t=this,r=e.zipApiUrl,i=e.itemsData,s=e.useOAuthToken;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a;return n.__generator(this,function(n){switch(n.label){case 0:t=void 0;return s?[4,e(o.getAuthToken({url:new b.SimpleUri(r).authority}))]:[3,2];case 1:t=n.sent();n.label=2;case 2:u=i&&1===i.length?i[0].name+".zip":"OneDrive_"+ ++T+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";a=c.default.generate();return[2,{url:r,method:"POST",postData:{zipFileName:u,guid:a,provider:"spo",files:JSON.stringify({items:i}),oAuthToken:t||""}}]}})})}})({zipApiUrl:x,itemsData:N,useOAuthToken:k||L})}}})(e,{itemKeys:h}):{}:(function(e,t){var r=t.itemKey,u=t.platformDetection,c=e.demandItem({spItem:s.spItemKeyFacet,permissions:i.permissionsFacet,folderPath:i.folderPathFacet,uniqueId:i.uniqueIdFacet,itemComplianceStatus:m.itemComplianceStatusFacet,isBFile:i.isBFileFacet},t.itemKey),h=c.spItem,d=c.permissions,g=c.folderPath,E=c.uniqueId,T=c.itemComplianceStatus,C=c.isBFile,k=e.demandItemFacet(p.malwareDetectedFacet,t.itemKey),L=h&&s.spPageContextKeyFacet.serialize(h),A=e.demandItemFacet(i.spPageContextFacet,L);if(!A||!h||C)return{};var O=h.webAbsoluteUrl,M=h.listFullUrl,_=s.spListKeyFacet.serialize(h),D=e.demandItemFacet(i.listFacet,_);if(D&&D.templateType===a.ListTemplateType.webPageLibrary)return{};if(3===T||4===T||!f.PermissionMask.hasItemPermission({permissions:d},f.PermissionMask.openItems))return{};var P=y.getConfiguration(e,{spCookieDomainConfiguration:i.spCookieDomainConfigurationFacet,enableMalwareDownloadInNewWindow:i.enableMalwareDownloadInNewWindowConfigurationFacet}),H=P.spCookieDomainConfiguration,B=P.enableMalwareDownloadInNewWindow;if(k){if(!A.allowInfectedDownload)return{};var j=e.demandItemFacet(p.canonicalUrlFacet,r);return j?B?{isAvailable:!0,downloader:S,getDownloadData:function(){return N({canconicalUrl:j})}}:H?new b.SimpleUri(H).authority!==new b.SimpleUri(j).authority?{}:n.__assign(n.__assign({isAvailable:!0},u.isIE?{downloader:x}:{}),{getDownloadData:function(){return N({canconicalUrl:j})}}):{}:{}}if(!g)return{};var F=A.layoutsUrl;if(!F)return{};var I=!H||new b.SimpleUri(H).authority!==new b.SimpleUri(O).authority;return n.__assign(n.__assign({isAvailable:!0},u.isIE?{downloader:x}:{}),{getDownloadData:function(){return H&&E&&!I?(function(e){var t=this,r=e.webAbsoluteUrl,i=e.layoutsUrl,s=e.uniqueId;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,{url:r+"/"+i+"/download.aspx?"+w.serializeQuery({UniqueId:s}),method:"GET"}]})})}})({webAbsoluteUrl:O,uniqueId:E,layoutsUrl:F}):(function(e){var t=this,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.folderPath;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,f,c,h;return n.__generator(this,function(n){switch(n.label){case 0:t=e(o.getDataRequestor({webAbsoluteUrl:r,listFullUrl:i})),u=t.dataRequestor,a=t.hasDigest;if(!t.hasTokenProvider)return[3,1];c=void 0;return[3,3];case 1:return[4,e(o.getAuthToken({url:r||i,disallowCookies:!a}))];case 2:c=n.sent();n.label=3;case 3:f=c;h=v.getWebApiUrl({webAbsoluteUrl:r,listOrItemFullUrl:i});return[4,l.getPreAuthorizedAccessUrl({dataRequestor:u,authToken:f,serverRelativeItemUrl:s,webApiUrl:h})];case 4:return[2,{url:n.sent(),method:"GET"}]}})})}})({webAbsoluteUrl:O,listFullUrl:M,folderPath:g,layoutsUrl:F})}})})(e,{itemKey:E,platformDetection:t})}}});var T=0;function N(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1");return[2,{url:t,method:"GET"}]})})}}});
define("xP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPreAuthorizedAccessUrl=function(e){var t=e.serverRelativeItemUrl,n=e.dataRequestor,r=e.webApiUrl,i=e.duration,s=void 0===i?1:i,o=e.authToken,u=r;u=(u=u.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",s);return n.getData({url:u.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}});
define("yP",["require","exports","lC","r","ii","T3","me","ih","C1","A1","DP","SP"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.deleteActionControlerHandler=u.createControlHandler()(function(){return function(e){return function(e,t){var n,r=t.itemKey,o=t.isBatchDelete,u=e.demandItemFacet(i.mountPointFacet,r,{suppressGetItems:!0}),a=e.demandItemFacet(i.permissionsFacet,r,{suppressGetItems:!0}),l=e.demandItemFacet(i.rowDataFacet,r,{suppressGetItems:!0}),p=c.isProgIdTeamChannelFolder(null===(n=l)||void 0===n?void 0:n.ProgId),d=s.PermissionMask.hasItemPermission({permissions:a},s.PermissionMask.deleteListItems)&&!p;if(d&&u){d=!!f.getConfiguration(e,{enableDeleteCommandForMountPointConfiguration:i.enableDeleteCommandForMountPointConfigurationFacet}).enableDeleteCommandForMountPointConfiguration&&o}return{isAvailable:d,deleteWizard:h}}}});var h=a.createItemCacheComponent(function(e,t){var s,u,a,c,h,p,d=t.itemKeys,v=t.defaultRender,m=n.__rest(t,["itemKeys","defaultRender"]),g=void 0,y=f.getConfiguration(e,{enableDeleteCommandForMountPointConfiguration:i.enableDeleteCommandForMountPointConfigurationFacet}).enableDeleteCommandForMountPointConfiguration;if(1===d.length){var b=e.demandItemFacet(i.mountShortcutCountFacet,d[0]);if(b){var w=b&&o.formatToArray(o.getLocalizedCountValue(l.default.deleteItemThatIsMountedDescription,l.default.deleteItemThatIsMountedIntervals,b)||"",b),E=m.deleteWizardStrings.confirmText;g=n.__assign(n.__assign({},m),{deleteWizardStrings:n.__assign(n.__assign({},m.deleteWizardStrings),{confirmTitle:l.default.deleteItemThatIsMountedTitle,confirmText:[w," ",E]})})}}else if(y){s=0;d.forEach(function(t){e.demandItemFacet(i.mountPointFacet,t,{suppressGetItems:!0})&&s++});if(s>0){var S=d.length-s;g=n.__assign(n.__assign({},m),{deleteWizardStrings:n.__assign(n.__assign({},m.deleteWizardStrings),{confirmTitle:l.default.deleteItems,confirmText:(u=s,a=S,c=o.format(o.getLocalizedCountValue(l.default.deleteShortcutsFormat,l.default.deleteShortcutsIntervals,u)||"",u),h=o.format(o.getLocalizedCountValue(l.default.deleteOtherItemsFormat,l.default.deleteOtherItemsIntervals,a)||"",a),p=o.format(l.default.deleteItemsAndMountPointsFormat,c,h),p)})})}}var x=g||m;return v?r.createElement(v,n.__assign({itemKeys:d},x)):null})});
define("vP",["require","exports","ii","ih","A1"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.deleteItemsActionControlerHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemKeys;if(!i.getConfiguration(e,{enableDeleteCommandForMountPointConfiguration:n.enableDeleteCommandForMountPointConfigurationFacet}).enableDeleteCommandForMountPointConfiguration)return{};for(var s=0,o=r;s<o.length;s++){var u=o[s];if(!e.demandItemFacet(n.mountPointFacet,u,{suppressGetItems:!0}))return{}}return{isAvailable:!1}}}})});
define("hP",["require","exports","Hm","bP"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointBasicItemDataAddonDeferred=n.createAddon(function(){return function(e){e(r.sharePointItemByFullUrlAddon)}})});
define("bP",["require","exports","lC","Hm","Vm","sS","Co","B8","J8","ce","li","$1","E2","li","ii","Rs","Xo","nS","a7","re","xo","v7","Z6","q6"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointItemByFullUrlAddon=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(c.supportFacets({keyFacet:l.spItemFullUrlKeyFacet,facets:[p.spItemKeyFacet,v.displayNameFacet,v.fileNameFacet,d.uniqueIdFacet,v.folderFacet,d.folderPathFacet,m.defaultChildItemSetFacet,d.missingMetadataFieldsFacet,E.itemMediaTransformFacet,E.listMediaTransformFacet,d.permissionsFacet,v.canonicalUrlFacet]}));e(r.registerOperationHandler(l.spItemFullUrlKeyFacet,c.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:8})(T)));return[2]})})}});function T(e){var t=this,r=e.itemKey,c=l.spItemFullUrlKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,v,E,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;return n.__generator(this,function(R){switch(R.label){case 0:t=new i.ItemResolver;v=!1;E=new s.SimpleUri(c.itemFullUrl);T=e((function(e,t,n){return function(r){var i,o,u=e.itemFullUrl,a=new s.SimpleUri(u);o=f.Killswitch.isActivated("ca2adcfe-ec7f-4e6b-a8ca-7023c151d026","1/8/2020","Adding more fields to GetListDataAsStream")?["File_x0020_Type","FileRef","FileLeafRef"]:["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"];i=[a.path];var c=r(w.readItem({contentTypeId:d.contentTypeIdFacet},l.spItemFullUrlKeyFacet.serialize(e)));if(t&&t.length>0&&c&&c.contentTypeId)for(var h=0,p=t;h<p.length;h++){var v=p[h];if(v.contentTypeId===c.contentTypeId&&v.Fields)for(var m=0,g=v.Fields.split(",");m<g.length;m++){var y=g[m];"Modified_x0020_By"===y?o.push("Editor"):"Created_x0020_By"===y?o.push("Author"):o.push(y)}}var E=b.getViewXml({itemRefs:i,recurseInFolders:!0,pageSize:1,fieldNames:o});return{webAbsoluteUrl:"",listFullUrl:u,currentPageContext:void 0,qosName:n,viewXml:E,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}})(c,void 0,"getSPItemByFullUrl"));return[4,e(g.getServerData(T))];case 1:N=R.sent();C=N.WebUrl||h.getSharePointPath(decodeURIComponent(N.HttpRoot||""))||E.authority;k=""+new s.SimpleUri(C).authority+(N.ListUrl||decodeURIComponent(N.listUrlDir||""));L={webAbsoluteUrl:C,listFullUrl:k,rootFolder:""};A=e(y.processResponse({serverData:N,itemSetKey:L,currentPageContext:T.currentPageContext,contentTypes:void 0,isItemSetRequest:v})),O=A.itemResolver,M=A.childKeys,_=A.pageContext;D=M[0];P=p.spFolderItemSetKeyFacet.serialize(L);D&&t.mapKeys({mappings:(I={},I[D]=l.spItemFullUrlKeyFacet.serialize(c),I)});if(_){H=p.spPageContextKeyFacet.serialize({webAbsoluteUrl:C,listFullUrl:k});e(w.readItem({pageContext:d.spPageContextFacet},H)).pageContext||e(u.updatePageContext({itemKey:H,options:{pageContext:_}}))}t.merge(O);if(p.spItemKeyFacet.matches(D)){B=p.spItemKeyFacet.deserialize(D);(j=S.getParentItemKey(B))&&t.merge(e(S.getAllAncestorItems({parentKey:j,serverData:N})).itemResolver)}F=l.spListKeyFacet.serialize({webAbsoluteUrl:C,listFullUrl:k});t.resolveItems({items:(q={},q[p.spItemKeyFacet.serialize(L)]=n.__assign({},m.defaultChildItemSetFacet.pack({itemKey:P})),q[r]=n.__assign({},o.preferredKeyFacetFacet.pack(p.spItemKeyFacet)),q[F]=n.__assign({},a.buildListFacets(N,_)),q)});e(t.execute());e(x.invokeHostResponseCallback({itemSetKey:P,serverData:N,isItemSetRequest:v}));return[2]}})})}}});
define("YM",["require","exports","lC","li","ii","zM","xy","PM","iP","AM","aP","DM","OS","ES","tP","ih","Xo","de","cg","gb","mM","Jb","Cb","ai","ZM","dE","JM","SL","QS","Pk","Ek","Ak","g6","y6","F1","A1","Xy","CM","ce","Zb","Go"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R={ODB:1544},U=[c.CheckOutItemCommand,c.CheckInItemCommand,c.UndoCheckoutItemCommand],z=[T.showKeymapShortcut,N.navigateUpShortcut,C.getNPSSurveyFocusShortcut],W={ODB:1231};t.SHOW_FILEHANDLER_COMMANDS_FIRST="658D384B-C862-48CC-986B-F1CD32B00BFE";t.SHOW_PUBLISH_ITEM_COMMAND="9cf4436a-b8a9-4b05-a921-e34436841ba3";t.deferredItemsCommandBarControlerHandler=v.createControlHandler()(V);t.itemsCommandBarControlerHandler=v.createControlHandler()(V);t.getOpenFileCommandWithHandler=function(e,t){var r=n.__rest(u.openFileCommand,[]);if(e&&e.open&&e.open.length>0){r.subMenuProps=r.subMenuProps||{};r.subMenuProps.items=k.mergeFileHandlerCommands(r.subMenuProps&&r.subMenuProps.items||[],e.open,t);!F.Killswitch.isActivated("BC85A80B-0AA5-41F5-98B6-C875D1773EE5","12/9/2019","Log engagement for open menu for promoted file handler")&&e.open.some(function(e){return e.isPromoted||!1})&&(r.engagement={name:"OpenCommand",isIntentional:!0,extraData:{hasPromotedFileHandler:!0}})}return r};function X(e,c){var v,T,N=c.itemKey,X=c.itemSetKey,V=c.commands,$=c.overflowCommands,J=c.farCommands,K=c.shortcutCommands,Q=e.demandItemFacet(r.spItemKeyFacet,N),G=e.demandItemFacet(r.spFolderItemSetKeyFacet,X),Y=$?n.__spreadArrays($):[],Z=!0,ee=!1,te=void 0,ne=void 0,re=void 0,ie=V?n.__spreadArrays(V):[],se=J,oe=[],ue="",ae=Q&&r.spListKeyFacet.serialize(Q),fe=e.demandItemFacet(r.spListKeyFacet,ae);G&&G.viewKey&&(ue=G.viewKey.viewId);var le,ce,he,pe=[],de=!1;if(Q&&fe){de=L.getIsAvailable(e,N,Q);var ve=e.demandItemFacet(i.listFacet,ae);Z=!!ve&&!!ve.isDocumentLibrary;le=B.getPageContextFromItemCache(e,N);if(Z)oe=K?n.__spreadArrays(K,z):n.__spreadArrays(z);else{ie=s.getDefaultListCommands(le);oe.push(C.getNPSSurveyFocusShortcut)}if(!(ee=!!ve&&ve.templateType===x.ListTemplateType.mySiteDocumentLibrary)){Z&&Y.push.apply(Y,U);Y&&Y.push(j.getApproveRejectCommand({listFacets:ve}));var me={webAbsoluteUrl:fe.webAbsoluteUrl,listFullUrl:fe.listFullUrl},ge=r.spListViewsSetKeyFacet.serialize(me),ye=e.demandItemFacet(m.childItemsFacet,ge);if(ye&&ye.itemKeys&&J){!ue&&le&&le.viewId&&(ue=g.default.normalizeLower(le.viewId,!1));T=e.demandItemFacet(i.newDocumentTemplatesFacet,ae);se=(ce=J,he=a.getViewsCommands(e,{viewKeys:ye.itemKeys,webAbsoluteUrl:Q.webAbsoluteUrl,listViewSetKey:me,itemSetKey:X,currentViewKey:r.spViewKeyFacet.serialize({viewId:ue})}),ce.map(function(e){return e.key===b.switchLayoutCommand.key?he:e}))}}ve&&fe&&(pe=(v=M.processContentTypeCommands(e,{key:Q,listFacets:ve,listKey:fe,pageContext:le})).contentTypes,te=v.contentTypeCommands);ne=w.getCustomActionCommands(e,Q);le&&ve&&(re=O.processFileHandlerCommands(e,{isODB:ee,key:Q,listFacets:ve,pageContext:le}).fileHandlerCommands)}var be=H.getConfiguration(e,{enableQuickEdit:i.enableQuickEditFacet}).enableQuickEdit,we=!!le&&!!be&&_.isFeatureEnabled(e,{feature:W,pageContext:le});if(we){var Ee=P.getItemsScope(e).itemsScopeItemKey;if(q.getCurrentLayout(e,{itemsScopeItemKey:Ee})===D.quickEditLayoutType)return{commands:[d.getExitQuickEditCommand(le)],overflowCommands:[],farCommands:[],shortcutCommands:[]}}var Se=(function(e,n){for(var r=n.quickEditEnabled,i=n.defaultCommands,s=n.isDocumentLibrary,a=n.isODB,c=n.contentTypeCommands,d=n.customActionCommands,v=n.fileHandlerCommands,m=n.newDocumentTemplates,g=n.contentTypes,b=n.isCreateFolderAvailable,w=n.listKey,x=n.pageContext,T=[],N=!F.Killswitch.isActivated(t.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands"),C=!F.Killswitch.isActivated(t.SHOW_PUBLISH_ITEM_COMMAND,"3/9/2020","Show publish command"),L=p.getQuickEditCommand(x),O={},M=0,D=i;M<D.length;M++){var P=D[M];O[P.key]=P}for(var H=0,B=i;H<B.length;H++){if((P=B[H]).key===y.newCommand.key){var j=A.getNewCommand(e,{contentTypes:g,newCommandMenu:P,fileHandlerCommands:v,isCreateFolderAvailable:b,newDocumentTemplates:m,contentTypeCommands:c,listKey:w}).visibleNewCommands;T.push(j)}else if(P.key===I.uploadCommand.key&&r&&!O[L.key])T.push(P,L);else if(P.key===u.openFileCommand.key){var q=t.getOpenFileCommandWithHandler(v,N);T.push(q)}else if(P.key===E.copyLinkCommand.key&&s&&!O[h.syncCommand.key])T.push(P,h.syncCommand);else if(P.key===S.deleteCommand.key&&s){T.push(P);a||O[o.exportListCommand.key]||T.push(o.exportListCommand);T.push(f.pinItemCommand,f.editPinnedItemCommand)}else if(P.key===E.shareCommand.key){!s&&_.isFeatureEnabled(e,{feature:R,pageContext:x})?T.push(E.addPeopleCommand):T.push(P);C&&T.push(l.publishItemCommand,l.scheduleItemCommand)}else T.push(P)}d&&d.length>0&&T.push.apply(T,d);v&&v.custom&&v.custom.length>0&&(T=k.mergeFileHandlerCommands(T,v.custom));return{overrideDefaultCommands:T}})(e,{defaultCommands:ie,isDocumentLibrary:Z,isODB:ee,contentTypeCommands:te,customActionCommands:ne,fileHandlerCommands:re,newDocumentTemplates:T,contentTypes:pe,isCreateFolderAvailable:de,quickEditEnabled:we,listKey:Q,pageContext:le});return{commands:ie=Se.overrideDefaultCommands,overflowCommands:Y,farCommands:se,shortcutCommands:oe}}t.baseItemsCommandBarControlHandler=X;function V(){return function(e){return function(e,t){return X(e,t)}}}});
define("zM",["require","exports","r","wy","si","Cb","Jb","Or","QM","IM","xy","KM","GM","ES"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.exportListCommand=l.exportListCommand;t.exportListCommandBrandIcon=l.exportListCommandBrandIcon;t.createListItemCommand=c.createListItemCommand;t.listNewCommands=h.listNewCommand;t.viewItemCommand={key:new i.Facet("ViewItem").id,name:u.default.Open,action:n.createElement(a.OpenItemFormUrlAction,null)};t.editItemCommand={key:new i.Facet("EditItem").id,name:r.default.Edit,action:n.createElement(f.EditItemAction,null),iconProps:{iconName:"Edit"}};t.getDefaultListCommands=function(e){return[h.listNewCommand,p.getQuickEditCommand(e),t.editItemCommand,o.shareCommand,o.copyLinkCommand,s.deleteCommand,l.exportListCommand]}});
define("QM",["require","exports","lC","_s","C1","ks","li","ii","ai","w7","sS","T3","Es","A1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};t.OpenItemFormUrlAction=r.withSelectedItems()(r.withExactlyOneItem()(i.connectToItemCache(function(e,t){var r=t.itemKey,i=t.isEditForm,s=!1,v=d;if(p.getConfiguration(e,{enableEditOrViewItemCommandConfiguration:u.enableEditOrViewItemCommandConfigurationFacet}).enableEditOrViewItemCommandConfiguration){var m=e.demandItem({key:o.spItemKeyFacet,itemId:u.listItemIdFacet,contentTypeId:u.contentTypeIdFacet,permissions:u.permissionsFacet},r),g=m.key,y=m.itemId,b=m.contentTypeId,w=m.permissions;if(g&&y&&(!i||w&&c.default.hasItemPermission({permissions:w},c.default.editListItems))){var E=g&&e.demandItemFacet(u.spPageContextFacet,o.spPageContextKeyFacet.serialize({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl}));if(E&&!E.isAnonymousGuestUser){var S=e.demandItem({list:u.listFacet,listFormUrls:u.listFormUrlsFacet},o.spListKeyFacet.serialize({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl})),x=S.list,T=S.listFormUrls,N=T?i?T.editFormUrl:T.displayFormUrl:void 0;if(x&&T&&x.templateType&&x.templateType!==a.default.mySiteDocumentLibrary&&N){var C=f.getListItemFormUrl(N,g.rootFolder||new l.default(g.listFullUrl).path,y,b);s=!0;v=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){(e=window.open(C,"_blank"))&&e.focus();return[2]})})}}}}}return n.__assign({isAvailable:s,onExecute:v},h.getItemActionEngagement(e,{itemKey:r,engagement:{name:i?"OpenItemEditForm":"OpenItemDisplayForm",isIntentional:!0}}))})(s.Action)))});
define("IM",["require","exports","lC","r","T3","tv","xM","g6","C1","Ps","Yo","ii","Xy","Es","ks","li","ai"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g={ODB:1568},y=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./EditItemWizard"],t,n)})];case 1:return[2,t.sent().EditItemWizard]}})})});t.EditItemAction=a.createItemCacheComponent(function(e,t){var s=l.getSelectedItemKeys(e),a=1===s.length?s[0]:void 0,b=e.demandItemFacet(o.itemPropertiesFormControl,a),w=o.itemPropertiesFormControl.evaluate(b)(e,{itemKey:a}).getPropertiesForm,E=e.demandItemFacet(c.permissionsFacet,a),S=a&&h.getPageContextFromItemCache(e,a),x=e.demandItemFacet(v.spItemKeyFacet,a),T=x&&e.demandItemFacet(c.listFacet,v.spListKeyFacet.serialize(x)),N=T&&T.templateType===m.ListTemplateType.mySiteDocumentLibrary,C=!!S&&u.isFeatureEnabled(e,{feature:g,pageContext:S})&&!!w&&!!E&&!N&&i.default.hasItemPermission({permissions:E},i.default.editListItems),k=a&&w?f.renderComponentOnExecute(function(e){return r.createElement(y,n.__assign({},e,{itemKey:a,interactiveSave:t.interactiveSave,getPropertiesForm:w}))}):void 0;return r.createElement(d.Action,n.__assign({isAvailable:C,onExecute:k},p.getItemActionEngagement(e,{itemKey:a,engagement:{name:"EditItem",isIntentional:!0}})))})});
define("xM",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemPropertiesFormControl=new n.ControlFacet("itemPropertiesFormControl")});
define("KM",["require","exports","r","qM","si","ug","pb","WM"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createListItemCommand={key:new i.Facet("createListItem").id,automationId:"createListItemCommand",name:r.default.listItem,action:n.createElement(o.HideWithSelection,null,n.createElement(u.CreateListItemAction,null)),iconProps:s.getCommandIconProps({size:16,type:4})}});
define("ug",["require","exports","lC","G_","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";i=i.Commands_0;Object.defineProperty(t,"__esModule",{value:!0});t.getCommandIconProps=function(e){return n.__assign(n.__assign({},r.getFileTypeIconProps(e)),{className:i.newDocumentCommandIcon})}});
define("WM",["require","exports","lC","ii","T3","Oy","_s"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e,t){var n=t.itemKey,s=e.demandItemFacet(r.permissionsFacet,n);return i.PermissionMask.hasItemPermission({permissions:s},i.PermissionMask.insertListItems)}var a=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["SVe"],t,n)})];case 1:return[2,t.sent().CreateListItemExecutor]}})})};t.CreateListItemAction=o.withOnlyCurrentItem()(s.createDeferredOnExecuteAction(a,u));t.CreateListItemIgnoreSelectionAction=o.withCurrentItem()(s.createDeferredOnExecuteAction(a,u))});
define("GM",["require","exports","cg","bg","KM"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.listNewCommand={key:n.newCommand.key,automationId:n.newCommand.automationId,name:n.newCommand.name,iconProps:n.newCommand.iconProps,subMenuProps:{items:[r.createFolderCommand,i.createListItemCommand]}}});
define("cg",["require","exports","bg","sf","Or","lg","dg"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.newCommand={key:o.newCommandKey,automationId:"newCommand",name:i.default.Create,title:i.default.CreateCommandAriaLabel,engagement:{name:"newCommand",isIntentional:!0},iconProps:{iconName:"CalculatorAddition"},subMenuProps:{items:[n.createFolderCommand,{name:"-",key:"divider_1",itemType:r.ContextualMenuItemType.Divider},s.createWordCommand,s.createExcelCommand,s.createPowerPointCommand,s.createOneNoteCommand,s.createExcelSurveyCommand,s.createFormForExcelCommand,s.createVisioCommand]}}});
define("bg",["require","exports","r","si","gg","ug","hg","pb"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderCommand={key:new r.Facet("createFolder").id,automationId:"createFolderCommand",name:o.default.CreateFolder,ariaLabel:o.default.CreateFolder,action:n.createElement(u.HideWithSelection,null,n.createElement(i.CreateFolderAction,null)),iconProps:s.getCommandIconProps({size:16,type:2})}});
define("gg",["require","exports","lC","vg","C1","tv"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["nA"],t,n)})];case 1:return[2,t.sent().CreateFolderWizard]}})})});t.ItemCreateFolderAction=i.connectToItemCache(function(){return{createFolderWizard:o}})(r.ItemCreateFolderAction);t.CreateFolderAction=i.connectToItemCache(function(){return{createFolderWizard:o}})(r.CreateFolderAction);t.CreatePersistentFolderAction=i.connectToItemCache(function(){return{createFolderWizard:o}})(r.PersistentCreateFolderAction)});
define("vg",["require","exports","lC","r","_s","yg","Rs","Es","C1","Ps","ks","tv"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=c.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["tA"],t,n)})];case 1:return[2,t.sent().CreateFolderDialog]}})})});t.ItemCreateFolderAction=a.createItemCacheComponent(function(e,t){var i=t.itemKey,a=t.createFolderWizard;if(!i)return null;var c=!0,p=e.demandItemFacet(o.folderFacet,i),d=e.demandItemFacet(s.createFolderActionControl,i),v=s.createFolderActionControl.evaluate(d)(e,{itemKey:i,isAvailable:!1,createFolderWizard:a}),m=v.isAvailable,g=v.createFolderWizard;m||(c=!1);var y=f.renderComponentOnExecute(function(e){return r.createElement(h,n.__assign({},e,{isAvailable:c&&!!p,itemKey:i,createFolderWizard:g}))});return r.createElement(l.Action,n.__assign({isAvailable:c,onExecute:y},u.getItemActionEngagement(e,{itemKey:i,engagement:{name:"CreateFolder",isIntentional:!0}})))});t.CreateFolderAction=i.withOnlyCurrentItem()(t.ItemCreateFolderAction);t.PersistentCreateFolderAction=i.withCurrentItem()(t.ItemCreateFolderAction)});
define("lg",["require","exports","r","hg","si","_g","pg","ug","pb"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createWordCommand={key:new i.Facet("createWord").id,automationId:"createWordCommand",name:r.default.CreateWord,ariaLabel:r.default.CreateWord,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Word})),iconProps:u.getCommandIconProps({extension:"docx",size:16})};t.createExcelCommand={key:new i.Facet("createExcel").id,automationId:"createExcelCommand",name:r.default.CreateExcel,ariaLabel:r.default.CreateExcel,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Excel})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createPowerPointCommand={key:new i.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:r.default.CreatePowerPoint,ariaLabel:r.default.CreatePowerPoint,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.PowerPoint})),iconProps:u.getCommandIconProps({extension:"pptx",size:16})};t.createOneNoteCommand={key:new i.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:r.default.CreateOneNote,ariaLabel:r.default.CreateOneNote,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.OneNote})),iconProps:u.getCommandIconProps({extension:"onetoc",size:16})};t.createExcelSurveyCommand={key:new i.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:r.default.CreateExcelSurvey,ariaLabel:r.default.CreateExcelSurvey,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.ExcelSurvey})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createFormForExcelCommand={key:new i.Facet("createFormForExcel").id,automationId:"createFormForExcelCommand",name:r.default.CreateFormForExcel,ariaLabel:r.default.CreateFormForExcel,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.ExcelForm})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createVisioCommand={key:new i.Facet("createVisio").id,automationId:"createVisioCommand",name:r.default.CreateVisio,ariaLabel:r.default.CreateVisio,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Visio})),iconProps:u.getCommandIconProps({extension:"vsdx",size:16})}});
define("pg",["require","exports","lC","r","_g","Rs","mg","_s","C1","ks","Es","Ps","tv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=h.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["ZE"],t,n)})];case 1:return[2,t.sent().DocumentCreator]}})})});t.ItemCreateDocumentAction=a.createItemCacheComponent(function(e,t){var u=t.itemKey,a=t.documentType,h=u&&e.demandItemFacet(s.folderFacet,u),d=e.demandItemFacet(o.createDocumentActionControl,u),v=o.createDocumentActionControl.evaluate(d)(e,{itemKey:u,documentType:a,isAvailable:!1}).isAvailable,m=c.renderComponentOnExecute(function(e){return r.createElement(p,n.__assign({},e,t))});return r.createElement(f.Action,n.__assign({isAvailable:v&&!!h,onExecute:m},l.getItemActionEngagement(e,{itemKey:u,engagement:{name:"CreateDocument",isIntentional:!0,extraData:{documentType:i.DocumentType[a]}}})))});t.CreateDocumentAction=u.withOnlyCurrentItem()(t.ItemCreateDocumentAction);t.CreatePersistentDocumentAction=u.withCurrentItem()(t.ItemCreateDocumentAction)});
define("dg",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.newCommandKey=n.getNextId("newCommand")});
define("PM",["require","exports","lC","r","RM","si","Vb","og","HM","FM","UM","TM"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeClientCommand=f.openInOfficeClientCommand;t.openInOfficeOnlineCommand=l.openInOfficeOnlineCommand;t.openFileCommand=c.openFileCommand;t.openFileCommandForContextMenu={key:u.openCommand.key,automationId:u.openCommand.automationId,name:u.openCommand.name,subMenuProps:{items:[l.openInOfficeOnlineCommand,f.openInOfficeClientCommand],contextualMenuItemAs:i.OpenCommandSubMenuItemForContextMenu},facets:n.__assign({},o.isReadonlyFacet.pack(!0))};t.fallbackOpenCommand={key:new s.Facet("fallbackOpen").id,automationId:"fallbackOpen",name:u.openCommand.name,action:r.createElement(a.FallbackOpenAction,null),facets:n.__assign({},o.isReadonlyFacet.pack(!0))}});
define("RM",["require","exports","lC","r","nc","vm","ii","jM","SPListItemsScopeDeferred_IS_mini_css","_s","C1","Rs","FM","UM","si","NM","g6","Xy"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";a=a.OpenCommandButton_4;Object.defineProperty(t,"__esModule",{value:!0});var y=new d.Facet("fileHandlerOpenCommand").id,b={ODB:625,ODC:"CommandBarBrandIcons",Fallback:!1};t.OpenCommandSubMenuItemForContextMenu=f.withSelectedItems()(f.withExactlyOneItem()(l.connectToItemCache(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:o.officeAppFacet},n).appMap,s=r.name;r.key===h.openInOfficeClientCommand.key?s=s||(i?u.getOfficeStringMap(i,!0):u.OpenFileStrings.Open):r.key===p.openInOfficeOnlineCommand.key&&(s=s||(i?u.getOfficeOnlineStringMap(i,!0):u.OpenFileStrings.OpenInBrowser));return{name:s}})(function(e){return r.createElement("div",{className:a.contextualMenuItemLinkContent},r.createElement("span",{dir:"auto",className:a.contextualMenuItemTextLabel},e.name))})));t.OpenCommandButton=f.withSelectedItems()(f.withExactlyOneItem()(l.connectToItemCache(function(e,t){var r=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:o.officeAppFacet,fileName:c.fileNameFacet},r),a=s.appMap,f=s.fileName,l={};if(i&&i.items){var d=i.items[0];d&&-1!==d.key.indexOf(y)&&d.iconProps&&(l=d.iconProps)}var v=!!f&&!!f.extension&&".pdf"===f.extension.toLowerCase(),E={iconName:a?u.getOfficeAppIconNameMap(a):v?"PDF":"OpenFile"},S=g.getPageContextFromItemCache(e,r),x=m.isFeatureEnabled(e,{feature:b,pageContext:S}),T=void 0;i&&i.items&&(T=i.items.map(function(e){return e.key===h.openInOfficeClientCommand.key?n.__assign(n.__assign({},e),{iconProps:E,name:e.name||a&&u.getOfficeStringMap(a,!0)||u.OpenFileStrings.Open,onRenderIcon:a?w.bind(void 0,a,!0,x):void 0}):e.key===p.openInOfficeOnlineCommand.key?n.__assign(n.__assign({},e),{iconProps:E,name:e.name||a&&u.getOfficeOnlineStringMap(a,!0)||(v?u.OpenFileStrings.OpenInBrowser:u.OpenFileStrings.Open),onRenderIcon:a?w.bind(void 0,a,!0,x):void 0}):e}));return{iconProps:l||E,onRenderIcon:a?w.bind(void 0,a,!1,x):void 0,text:u.OpenFileStrings.Open,menuProps:T?n.__assign(n.__assign({},i),{items:T}):i}})(s.CommandBarButton)));function w(e,t,n){var s=e&&u.getOfficeAppLogosMap(e),o=e&&u.getOfficeAppName(e);return o&&n?r.createElement(v.BrandIcon,{size:16,extension:"",brand:o.toLowerCase(),className:t?a.menuItemBrandIcon:a.brandIcon}):s?r.createElement("span",{className:t?a.menuItemIconContainer:a.iconContainer},r.createElement(i.Icon,{iconName:s.logoFill16,className:a.logoFillIcon}),r.createElement(i.Icon,{iconName:s.logo16,className:a.logoIcon})):null}});
define("jM",["require","exports","VM"],function(e,t,n){"use strict";var r,i,s,o,u;Object.defineProperty(t,"__esModule",{value:!0});var a="ms-word",f="onenote|UsePlain",l="ms-powerpoint",c="ms-excel",h="ms-visio",p="ms-publisher",d="ms-project";t.OpenFileStrings=n.default;var v=((r={})[a]=n.default.OpenInWordOnline,r[f]=n.default.OpenInOneNoteOnline,r[l]=n.default.OpenInPowerPointOnline,r[c]=n.default.OpenInExcelOnline,r[h]=n.default.OpenInVisioOnline,r);t.getOfficeOnlineStringMap=function(e,t){return v[e]?t?n.default.OpenInBrowser:v[e]:""};var m=((i={})[a]=n.default.OpenInWord,i[f]=n.default.OpenInOneNote,i[l]=n.default.OpenInPowerPoint,i[c]=n.default.OpenInExcel,i[h]=n.default.OpenInVisio,i[p]=n.default.OpenInPublisher,i[d]=n.default.OpenInProject,i["ms-infopath"]=n.default.OpenInInfoPath,i);t.getOfficeStringMap=function(e,t){return t&&(function(e){return v.hasOwnProperty(e)})(e)?n.default.OpenInApp:m[e]};var g=((s={})[a]="Word",s[f]="OneNote",s[l]="PowerPoint",s[d]="Project",s[h]="Visio",s[c]="Excel",s);t.getOfficeAppName=function(e){return g[e]};var y=((o={})[a]="WordLogo",o[f]="OneNoteLogo",o[l]="PowerPointLogo",o[c]="ExcelLogo",o[h]="VisioLogo",o[p]="Page",o),b=((u={})[a]={logo:"WordLogo",logo16:"WordLogo16",logoFill:"WordLogoFill",logoFill16:"WordLogoFill16",logoInverse:"WordLogoInverse",logoInverse16:"WordLogoInverse16"},u[f]={logo:"OneNoteLogo",logo16:"OneNoteLogo16",logoFill:"OneNoteLogoFill",logoFill16:"OneNoteLogoFill16",logoInverse:"OneNoteLogoInverse",logoInverse16:"OneNoteLogoInverse16"},u[l]={logo:"PowerPointLogo",logo16:"PowerPointLogo16",logoFill:"PowerPointLogoFill",logoFill16:"PowerPointLogoFill16",logoInverse:"PowerPointLogoInverse",logoInverse16:"PowerPointLogoInverse16"},u[c]={logo:"ExcelLogo",logo16:"ExcelLogo16",logoFill:"ExcelLogoFill",logoFill16:"ExcelLogoFill16",logoInverse:"ExcelLogoInverse",logoInverse16:"ExcelLogoInverse16"},u[h]={logo:"VisioLogo",logo16:"VisioLogo16",logoFill:"VisioLogoFill",logoFill16:"VisioLogoFill16",logoInverse:"VisioLogoInverse",logoInverse16:"VisioLogoInverse16"},u);t.getOfficeAppIconNameMap=function(e){return y[e]};t.getOfficeAppLogosMap=function(e){return b[e]}});
define("FM",["require","exports","lC","r","si","Vb","b8"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeClientCommand={key:new i.Facet("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:r.createElement(o.OpenInOfficeClientAction,null),facets:n.__assign({},s.isReadonlyFacet.pack(!0))}});
define("UM",["require","exports","lC","r","si","Vb","c8"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeOnlineCommand={key:new i.Facet("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:r.createElement(o.OpenInOfficeOnlineAction,null),facets:n.__assign({},s.isReadonlyFacet.pack(!0))}});
define("NM",["require","exports","lC","r","nc","Qe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BrandIcon=function(e){var t=e.extension,o=e.className,u=e.isOneNote,a=e.size,f=e.brand,l=s.getBrandTypeIconProps({size:a,extension:u?"one":t,brand:f});return l?r.createElement(i.Icon,n.__assign({className:o},l)):null}});
define("og",["require","exports","lC","r","qf","Or","pb","Vb","sg"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openCommand={key:a.openCommandKey,automationId:"openCommand",name:s.default.Open,action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(i.OpenUrlAction,null)),iconProps:{iconName:"OpenFile"},facets:n.__assign({},u.isReadonlyFacet.pack(!0))}});
define("sg",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openCommandKey=n.getNextId("open")});
define("HM",["require","exports","lC","r","_s","ks","qf","C1","ii"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.canOpenInOffice?r.createElement(s.Action,null):r.createElement(o.OpenUrlAction,null)};return t})(r.PureComponent);var l=u.connectToItemCache(function(e,t){var n=t.itemKey;return{canOpenInOffice:!!e.demandItem({appMap:a.officeAppFacet},n).appMap}})(f);t.FallbackOpenAction=i.withSelectedItems()(i.withExactlyOneItem()(l))});
define("TM",["require","exports","lC","r","Vb","og","RM","UM","FM"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openFileCommand={key:s.openCommand.key,automationId:s.openCommand.automationId,subMenuProps:{items:[u.openInOfficeOnlineCommand,a.openInOfficeClientCommand]},onRender:function(e){return r.createElement(o.OpenCommandButton,n.__assign({},e,{menuProps:e.subMenuProps}))},facets:n.__assign({},i.isReadonlyFacet.pack(!0))}});
define("iP",["require","exports","lC","r","sf","li","ii","Rs","de","si","tv","ai","SPListItemsScopeDeferred_IS_mini_css","wy","me","gb","g6","Xh","pP","fP","$h","lP","dP","sP","rP"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";h=h.ViewCommands_5;Object.defineProperty(t,"__esModule",{value:!0});var N=[{ODB:1776}],C={ODB:1484},k={iconName:void 0,styles:{root:{display:"none!important"}}},L=new f.Facet("switchView").id,A=new f.Facet("needsAttentionView").id,O=new f.Facet("setDefaultView").id,M=new f.Facet("customizeView").id,_=l.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["IVe"],t,n)})];case 1:return[2,t.sent().CreateViewAction]}})})}),D={key:new f.Facet("switchToFixedGridLayoutCommand").id,automationId:"switchToFixedGridLayoutCommand",name:p.default.fixedHeight,action:r.createElement(b.SwitchGridLayoutAction,{viewType:"GRIDFIXED"}),iconProps:{iconName:"ViewList"}},P={key:new f.Facet("switchToDynamicGridLayoutCommand").id,automationId:"switchToDynamicGridLayoutCommand",name:p.default.dynamicHeight,action:r.createElement(b.SwitchGridLayoutAction,{viewType:"GRID"}),iconProps:{iconName:"DynamicList"}};t.getViewsCommands=function(e,t){var l=t.viewKeys,b=t.webAbsoluteUrl,L=t.listViewSetKey,F=t.itemSetKey,I=t.currentViewKey,q=s.spListKeyFacet.serialize({webAbsoluteUrl:L.webAbsoluteUrl,listFullUrl:L.listFullUrl}),R=m.isFeatureEnabled(e,{feature:C})&&N.some(function(t){return m.isFeatureEnabled(e,{feature:t})}),U=e.demandItemFacet(o.listFacet,q),z=!!U&&!!U.templateType&&c.isGenericList(U.templateType),W=!!U&&!!U.templateType&&U.templateType===c.default.webPageLibrary,X=!1,V=p.default.Views,$=e.demandItem({showViewModifiedIndicator:o.showViewModifiedIndicatorFacet,currentDerivedView:o.currentDerivedViewFacet,currentViewBasicInfo:o.viewBasicInfoFacet},I),J=$.showViewModifiedIndicator,K=$.currentDerivedView,Q=$.currentViewBasicInfo;U&&K&&"POWER"!==K.viewType&&U.permissions&&K.canUserEdit(U.permissions)&&(X=!0);K&&K.title?V=K.title:Q&&Q.Title&&(V=Q.Title);X&&(J||K&&K.isDirty())&&(V=d.format(p.default.ViewModifiedIndicator,V));var G=l.map(function(t){var n=e.demandItemFacet(o.serverViewFacet,t),r=e.demandItemFacet(o.viewBasicInfoFacet,t);return n&&!n.Hidden?H(n,b,F,K):r?H(r,b,F,K):void 0}).filter(function(e){return!!e}),Y=(function(e,t){var n=e.demandItemFacet(o.needsAttentionItemFacet,t);return!(!n||!e.demandItemFacet(u.missingMetadataFacet,n))})(e,F),Z=(function(e,t){var n,i=t.isPagesLib,o=t.isList,u=t.itemsNeedAttention,a=t.currentDerivedView,f=t.itemSetKey,l=s.needsAttentionViewId;n=i&&m.isFeatureEnabled(e,{feature:{ODB:1743}})?p.default.PagesThatNeedAttention:o?p.default.ItemsThatNeedAttention:p.default.FilesThatNeedAttention;return{key:A,automationId:"needsAttentionViewCommand",name:n,iconProps:u?{iconName:"error",styles:{root:h.needsAttentionIcon}}:k,action:r.createElement(S.SwitchViewAction,{viewId:l,currentDerivedView:a,itemSetKey:f})}})(e,{isList:z,isPagesLib:W,itemsNeedAttention:Y,itemSetKey:F,currentDerivedView:K}),ee=(function(e,t,n){var r=s.spListKeyFacet.serialize({webAbsoluteUrl:t,listFullUrl:n}),i=e.demandItemFacet(o.contentTypeKeysFacet,r),u=[];i&&i.length&&i.forEach(function(t){var n=e.demandItemFacet(o.spListContentTypeFacet,t),r=n&&n.requiredFields&&n.requiredFields.split(",");r&&r.length>0&&(u=u.concat(r))});return u.length>0})(e,b,L.listFullUrl),te=K?(function(e){var t=e.isCreateNewViewEnabled,i=e.currentDerivedView,o=e.listViewSetKey,u=e.itemSetKey,a=e.allowEditCurrentView,f=s.spViewKeyFacet.serialize({viewId:i.id}),l=s.spListViewsSetKeyFacet.serialize(o),c=a||t&&"MODERNCALENDAR"===i.viewType;return n.__spreadArrays(t?[{key:j,automationId:"createViewCommand",name:p.default.CreateNewView,iconProps:k,action:r.createElement(_,{listViewSetKey:l,currentViewKey:f,isEditing:!1})}]:[],[{key:B,automationId:"saveCommand",name:p.default.SaveViewAs,iconProps:k,action:r.createElement(x.SaveViewAction,{listViewSetKey:l,currentViewKey:f})},{key:O,automationId:"setDefaultViewCommand",name:p.default.SetDefaultView,iconProps:k,action:r.createElement(T.SetDefaultViewAction,{currentDerivedView:i,listViewSetKey:o})}],c?[{key:M,automationId:"customizeViewCommand",name:p.default.CustomizeView,iconProps:k,action:"MODERNCALENDAR"===i.viewType?r.createElement(_,{listViewSetKey:l,currentViewKey:f,isEditing:!0}):r.createElement(E.CustomizeViewActionn,{viewKey:f,itemSetKey:u})}]:[])})({listViewSetKey:L,isCreateNewViewEnabled:R,currentDerivedView:K,itemSetKey:F,allowEditCurrentView:X}):[],ne="MODERNCALENDAR"===e.demandItemFacet(o.viewTypeFacet,I)?[{key:new f.Facet("calendarMonth").id,isPermanent:!1,automationId:"calendarMonthCommand",name:p.default.calendarMonthTitle,title:p.default.calendarMonthDesc,action:r.createElement(g.SwitchLayoutAction,{layoutType:y.calendarMonthType}),iconProps:{iconName:"calendar"}}]:[],re=[];if(v.switchLayoutCommand.subMenuProps){var ie=e.demandItemFacet(o.viewFormatterFacet,I),se=ie&&ie.viewFormatter,oe=se&&se.isTileDesignerTemplateApplied(),ue=se&&se.getTileProps(),ae=!!(ue&&ue.formatter&&ue.formatter);if(z&&(oe||m.isFeatureEnabled(e,{feature:{ODB:1396}})&&!ae))for(var fe=0,le=v.switchLayoutCommand.subMenuProps.items;fe<le.length;fe++){var ce=le[fe];ce.key!==w.tilesListCommandKey?re.push(ce):re.push(n.__assign(n.__assign({},ce),{name:p.default.GalleryLayout,title:p.default.GalleryLayoutCommandTooltip}))}else re=v.switchLayoutCommand.subMenuProps.items}var he=n.__spreadArrays(re,ne,[{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}],ee?[Z,{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}]:[],[D,P,{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}],G,[{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}],te,[{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}]),pe={name:V,key:v.switchLayoutCommand.key,automationId:v.switchLayoutCommand.automationId,iconProps:v.switchLayoutCommand.iconProps,title:p.default.SwitchViewsCommandTitle,ariaLabel:d.format(p.default.SwitchViewsCommandAriaLabel,V),postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,r=t&&t.filter(function(e){return e.checked})[0];return n.__assign(n.__assign(n.__assign({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),r?{iconProps:n.__assign(n.__assign({},r.iconProps),Y?{styles:{root:h.needsAttentionIconOverlay}}:{})}:{})},subMenuProps:{items:he}},de=K?a.default.normalizeLower(K.id,!1):"";pe.cacheKey=v.switchLayoutCommand.key+"_viewId_"+de;return pe};function H(e,t,n,i){var s=a.default.normalizeLower(e.Id,!1);return{key:L+"-"+s,automationId:"switchViewCommand_"+s,name:e.Title,iconProps:k,action:r.createElement(S.SwitchViewAction,{viewId:s,currentDerivedView:i,itemSetKey:n})}}var B=new f.Facet("saveView").id,j=new f.Facet("createView").id});
define("pP",["require","exports","Pr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.calendarMonthType=new n.LayoutTypeFacet("calendarMonth")});
define("fP",["require","exports","lC","_s","ii","A1","Oy","g6","Go","F1","y6","li"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1725},p={ODB:1553};function d(e,t){var n=s.getConfiguration(e,{enableQuickEdit:i.enableQuickEditFacet}).enableQuickEdit,r=f.getItemsScope(e).itemsScopeItemKey,o=r&&a.getCurrentLayout(e,{itemsScopeItemKey:r}),c=o&&o.id===l.quickEditLayoutType.id;return!!(n&&!!c&&u.isFeatureEnabled(e,{feature:h})&&u.isFeatureEnabled(e,{feature:p}))}t.SwitchGridLayoutAction=r.withCurrentItemSet()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./SwitchGridLayoutActionExecutor"],t,n)})];case 1:return[2,t.sent().SwitchGridLayoutActionExecutor]}})})},d,function(e,t){var n=t.itemKey,r=t.viewType,s=e.demandItem({deserizalizedKey:c.spFolderItemSetKeyFacet},n).deserizalizedKey,o=s&&s.viewKey&&c.spViewKeyFacet.serialize(s.viewKey),u=o&&e.demandItemFacet(i.viewTypeFacet,o);return d(e)&&u===r}))});
define("lP",["require","exports","lC","r","C1","li","ii","Es","ks","uP"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CustomizeViewActionn=i.createItemCacheComponent(function(e,t){var i=t.viewKey,l=t.itemSetKey,c=void 0,h=l&&e.demandItemFacet(s.spFolderItemSetKeyFacet,l),p=e.demandItemFacet(o.currentDerivedViewFacet,i);if(h&&p){var d=s.spListKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl}),v=e.demandItemFacet(o.listFacet,d),m=e.demandItemFacet(o.spPageContextFacet,s.spPageContextKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl}));m&&v&&v.id&&p&&"POWER"!==p.viewType&&v.permissions&&p.canUserEdit(v.permissions)&&(c=f.getClassicEditViewPageUrl({webAbsoluteUrl:h.webAbsoluteUrl,layoutsUrl:m.layoutsUrl,viewId:p.id,listId:v.id,sourceUrl:p.serverRelativeUrl||""}))}var g=!!c;return r.createElement(a.Action,n.__assign({isAvailable:g,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(c);return[2]})})}},u.getItemActionEngagement(e,{itemKey:l,engagement:{name:"CustomizeView",isIntentional:!0}})))})});
define("uP",["require","exports","u9","de"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassicEditViewPageUrl=function(e){var t=e.webAbsoluteUrl,i=e.layoutsUrl,s=e.viewId,o=e.listId,u=e.sourceUrl;return t+"/"+i+"/ViewEdit.aspx?"+n.serializeQuery({View:r.default.normalizeUpper(s,!0),List:r.default.normalizeUpper(o,!0),Source:u})}});
define("dP",["require","exports","lC","Oy"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SwitchViewAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["pU"],t,n)})];case 1:return[2,t.sent().SwitchViewExecutor]}})})},function(e,t){return!0},function(e,t){var n=t.currentDerivedView,r=t.viewId;return n?r===n.id:""===r})});
define("sP",["require","exports","lC","r","C1","li","ii","_s","cP","Es","Ps","ks","F1","R1","tv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=d.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["VT"],t,n)})];case 1:return[2,t.sent().ViewCreator]}})})});t.SaveViewAction=i.createItemCacheComponent(function(e,t){var i=t.currentViewKey,d=u.getCurrentItemSetKey(e),m=h.getItemsScope(e).itemsScopeItemKey,g=!1,y=e.demandItemFacet(s.spFolderItemSetKeyFacet,d),b=e.demandItemFacet(o.currentDerivedViewFacet,i),w=e.demandItemFacet(a.saveViewActionControl,d),E=a.saveViewActionControl.evaluate(w)(e,{viewKey:i}).onViewSaved;if(y&&b){var S=s.spListKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl}),x=e.demandItemFacet(o.listFacet,S);g=!!(x&&b&&"POWER"!==b.viewType&&x.permissions&&(x.permissions.managePersonalViews||x.permissions.manageLists))}if(!b||!d||!m)return null;var T=l.renderComponentOnExecute(function(e){return r.createElement(p.ItemsScope,{itemsScopeItemKey:m},r.createElement(v,n.__assign({},e,t,{itemSetKey:d,viewTitle:b.title,isPublicView:!b.isPersonal,onViewSaved:E})))},{scope:"global"});return r.createElement(c.Action,n.__assign({isAvailable:g,onExecute:T},f.getItemActionEngagement(e,{itemKey:d,engagement:{name:"SaveView",isIntentional:!0}})))})});
define("cP",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveViewActionControl=new n.ControlFacet("saveViewActionControl")});
define("rP",["require","exports","lC","C1","ks","li","ii","oP","Es"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetDefaultViewAction=r.connectToItemCache(function(e,t){var r=t.currentDerivedView,i=t.listViewSetKey,u=!1,f=i&&s.spListKeyFacet.serialize(i);if(i&&r){var l=e.demandItemFacet(o.listFacet,f);u=!(!(l&&l.permissions&&l.permissions.manageLists&&r&&r.id)||r.isPersonal||r.isDefault)}return n.__assign({isAvailable:u},a.getItemActionEngagement(e,{itemKey:f,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var r=t.currentDerivedView,i=t.listViewSetKey;return{onExecute:r?function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,o;return n.__generator(this,function(n){e(u.modifyView({items:(t={},t[s.spListViewsSetKeyFacet.serialize(i)]={views:(o={},o[r.id]={isDefault:!0},o)},t)}));return[2]})})}:void 0}})(i.Action)});
define("AM",["require","exports","r","MM","wp","kM","LM"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinItemCommand={key:o.pinItemCommandKey,automationId:"pinItemCommand",name:s.default.pinToTop,iconProps:{iconName:"Pin"},action:n.createElement(r.EditPinnedItemAction,{editType:0})};t.moveLeftPinnedItemCommand={key:o.moveLeftPinnedItemCommandKey,automationId:"moveLeftPinnedItemCommand",name:s.default.moveLeftPinnedItem,iconProps:{iconName:i.Locale.isRightToLeft?"Forward":"Back"},action:n.createElement(r.EditPinnedItemAction,{editType:2})};t.moveRightPinnedItemCommand={key:o.moveRightPinnedItemCommandKey,automationId:"moveRightPinnedItemCommand",name:s.default.moveRightPinnedItem,iconProps:{iconName:i.Locale.isRightToLeft?"Back":"Forward"},action:n.createElement(r.EditPinnedItemAction,{editType:3})};t.removePinnedItemCommand={key:o.removePinnedItemCommandKey,automationId:"removePinnedItemCommand",name:s.default.unpinFromTop,iconProps:{iconName:"UnPin"},action:n.createElement(r.EditPinnedItemAction,{editType:1})};t.editPinnedItemCommand={key:o.editPinnedItemCommandKey,automationId:"editPinnedItemCommand",name:s.default.editPin,iconProps:{iconName:"Pinned"},subMenuProps:{items:[t.moveLeftPinnedItemCommand,t.moveRightPinnedItemCommand,t.removePinnedItemCommand]}}});
define("MM",["require","exports","lC","r","li","_s","Ro","C1","Xo","k6","Rs","ii","T3","Es","tv","bs","Ps","ks"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=u.connectToItemCache()(d.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["CVe"],t,n)})];case 1:return[2,t.sent().EditPinnedItemExecutor]}})})})),b=u.createItemCacheComponent(function(e,t){var s=t.itemKey,u=t.editType,d=v.getItemsScope(e).itemsScopeItemKey,b=(function(e,t){var n=o.getCurrentItemSetKey(e),r=e.demandItemFacet(i.spPinnedItemSetKeyFacet,n);if(r)return i.spPinnedItemSetKeyFacet.serialize(r);return})(e),w=e.demandItem({isMalwareDetected:l.malwareDetectedFacet,permissions:c.permissionsFacet},s),E=w.isMalwareDetected,S=w.permissions,x=!E&&!!s&&f.doesListSupportPinnedItems(e,t)&&!!b&&!!S&&h.PermissionMask.hasItemPermission({permissions:S},h.PermissionMask.manageLists)&&(function(e,t){var n=t.pinnedItemSetKey,r=t.editType,i=e.demandItemFacet(a.childItemsFacet,n),s=i?i.itemKeys:[],o=s.indexOf(t.itemKey),u=o>-1?0!==r:0===r;u&&(2===r?u=0!==o:3===r&&(u=o!==s.length-1));return u})(e,{itemKey:t.itemKey,pinnedItemSetKey:b,editType:u}),T=d?m.renderComponentOnExecute(function(e){return r.createElement(y,n.__assign({},e,t,{itemsScopeItemKey:d,pinnedItemSetKey:b}))}):void 0;return r.createElement(g.Action,n.__assign({isAvailable:x,onExecute:T},p.getItemActionEngagement(e,{itemKey:s,engagement:{name:"EditPinnedItem",isIntentional:!0}})))});t.EditPinnedItemAction=s.withSelectedItems()(s.withExactlyOneItem()(b))});
define("LM",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinItemCommandKey=n.getNextId("pinItem");t.moveLeftPinnedItemCommandKey=n.getNextId("moveLeftPinnedItem");t.moveRightPinnedItemCommandKey=n.getNextId("moveRightPinnedItem");t.removePinnedItemCommandKey=n.getNextId("removePinnedItem");t.editPinnedItemCommandKey=n.getNextId("editPinnedItem")});
define("aP",["require","exports","lC","r","si","wy","FL","Ec","RL","_s","HL"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PublishCommandKey=new i.Facet("Publish").id;t.ScheduleCommandKey=new i.Facet("Schedule").id;var c=new Map([[l.PublishActionType.Publish,s.default.Publish],[l.PublishActionType.CancelApproval,s.default.CancelApproval],[l.PublishActionType.SubmitForApproval,s.default.SubmitForApproval],[l.PublishActionType.SchedulePublish,s.default.Schedule],[l.PublishActionType.Republish,s.default.Republish]]),h=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=e.itemKeys,o=n.__rest(e,["defaultRender","itemKeys"]),f=i[0];return r.createElement(u.WithItemCache,null,function(e){var i=e.itemCache,u=a.getPublishActionType(i,f),l=c.get(u)||s.default.Publish;return t?r.createElement(t,n.__assign({},o,{text:l})):null})};return t})(r.PureComponent);t.publishItemCommand={key:t.PublishCommandKey,automationId:"PublishCommand",iconProps:{iconName:"ReadingMode"},name:s.default.Publish,action:r.createElement(o.PublishItemAction,{publishType:0,source:"Command"}),commandBarButtonAs:f.withSelectedItems()(h)};t.scheduleItemCommand={key:t.ScheduleCommandKey,automationId:"ScheduleCommand",iconProps:{iconName:"DateTime2"},name:s.default.Schedule,action:r.createElement(o.PublishItemAction,{publishType:1,source:"Command"}),commandBarButtonAs:f.withSelectedItems()(h)}});
define("FL",["require","exports","lC","r","BL","ii","UL","_s","C1","To","Es","Rs","bE","Ps","ks","Ro","ce","ai","li","RL","yS","HL"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=a.connectToItemCache()(i.PublishItemExecutor),x=a.connectToItemCache(function(e,t){var r=t.onCancel,i=t.reject;return{onCancel:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){i(new f.CancelError);r&&r();return[2]})})},title:o.default.MissingMetadataDialogTitle,prompt:o.default.MissingMetadataDialogText,cancelText:o.default.MissingMetadataDialogButton}})(h.WarningDialog);t.ItemPublishAction=a.createItemCacheComponent(function(e,t){var i,o=t.itemKeys,u=t.publishType,a=t.source;if(!o||!o.length)return null;var f=v.getCurrentItemSetKey(e),h=e.demandItem({firstItemKey:y.spItemKeyFacet,hasMissingMetadata:c.missingMetadataFacet,contentTypeId:s.contentTypeIdFacet},o[0]),T=h.firstItemKey,N=h.hasMissingMetadata,C=h.contentTypeId;if(!T)return null;var k=T&&e.demandItemFacet(s.spPageContextFacet,y.spPageContextKeyFacet.serialize({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:T.listFullUrl}));if(k&&(k.isAnonymousGuestUser||k.isEmailAuthenticationGuestUser))return null;var L=!1,A=!!k&&m.getKillSwitch(k).isActivated("f307ef95-b7d3-4b5a-af39-d71f6f4eaaf1","06/09/2020","Dont show submit for approval button when multiple items are selected"),O=b.getPublishActionType(e,o[0]);if(!(!A&&o.length>1&&((null===(i=k)||void 0===i?void 0:i.listBaseTemplate)!==g.default.webPageLibrary||!(O===E.PublishActionType.Publish||O===E.PublishActionType.Republish||O===E.PublishActionType.PostNews||O===E.PublishActionType.UpdateNews))))for(var M=0,_=o;M<_.length;M++){var D=_[M];if(!(L=!!b.canPublishOrSchedule(e,D)&&(!(!A&&o.length>1&&!b.isSitePage(C))&&(w.isPublishStartDateInFuture(e,D)?1===u:0===u))))break}var P=p.renderComponentOnExecute(function(e){if(N){return r.createElement(x,n.__assign({},e,{onCancel:function(e){}}))}return r.createElement(S,n.__assign({},e,{itemKeys:o,itemSetKey:f}))});return r.createElement(d.Action,n.__assign({isAvailable:L,onExecute:P},l.getItemActionEngagement(e,{itemKey:o[0],engagement:{name:"PublishItem",isIntentional:!0,extraData:{publishSource:a}}})))});t.PublishItemAction=u.withSelectedItems()(t.ItemPublishAction)});
define("BL",["require","exports","lC","r","zL","jr","HL","li","Rs","ii","rs","zm","RL","ai","VL","jm","ce","jL","Se"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updatePublishState=m.Killswitch.isActivated("991d2b61-3537-434c-8a72-45623f632435","1/13/2020","Use progress addon for publish")?v.implementOperationWithProgress({operationTypeFacet:i.updatePublishStateOperation,progressKeyFacet:i.publishProgressKeyFacet}):v.implementOperationWithProgress({operationTypeFacet:i.updatePublishStateOperation,progressKeyFacet:i.publishProgressKeyFacet,initializeBatch:function(){return d.publishProgressAddon}});var b=(function(e){n.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.state={publishItemError:void 0};return n}r.prototype.componentDidMount=function(){var e=this.props,n=e.itemCacheDispatch,r=e.itemKeys,i=e.itemSetKey,d=e.resolve,v=e.reject,b=r[0],w=n(l.readItems(function(e){return e.demandItem({firstItemKey:u.spItemKeyFacet,displayName:a.displayNameFacet},r[0])})),E=w.firstItemKey,S=w.displayName,x=n(l.readItems(function(e){return h.getPublishActionType(e,b)})),T={publishActionType:x},N=!1;if(E){var C=n(l.readItems(function(e){return e.demandItemFacet(f.listFacet,u.spListKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl}))}));N=!!C&&C.templateType===p.ListTemplateType.webPageLibrary}if(E&&N&&x===o.PublishActionType.SubmitForApproval){var k=m.Killswitch.isActivated("bb2acf46-d145-4ac4-9aed-542d0b2c2e0b","6/2/2020","FixPageUrlInLibSubFolder2"),L=k?"":new y.SimpleUri(E.webAbsoluteUrl).authority,A=k?"":n(l.readItems(function(e){return e.demandItemFacet(f.folderPathFacet,r[0])})),O=k?E.listFullUrl+"/"+S:""+L+A;window.location.href=O}else n(t.updatePublishState({items:s.makeObject(r,function(){return T})})).then(function(){var e,t;n(c.invalidateItems({items:(e={},e[b]=[f.uiVersionFacet],e[b]=[f.needsPublishingFacet],e)}));i&&n(g.refreshItemsInSet({items:(t={},t[i]=s.makeObject(r,function(){return{}}),t)}));d()}).catch(function(e){v(e)})};r.prototype.render=function(){return null};return r})(r.PureComponent);t.PublishItemExecutor=b});
define("VL",["require","exports","lC","r","Hm","ih","Fm","me","jm","Gm","GO","zL","Xo","Rs","UL","HL"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";var m,g;Object.defineProperty(t,"__esModule",{value:!0});var y=((m={})[f.ProgressPhase.started]=function(e){var t=e.count,n=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(n?d.default.schedulePublishStartedItemsTitle:d.default.publishStartedItemsTitle,d.default.publishCompletedItemsTitleIntervals,t)||"",t)},m[f.ProgressPhase.completed]=function(e){var t=e.count,n=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(n?d.default.schedulePublishCompletedItemsTitle:d.default.publishCompletedItemsTitle,d.default.publishCompletedItemsTitleIntervals,t)||"",t)},m[f.ProgressPhase.failed]=function(e){var t=e.count,n=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(n?d.default.schedulePublishFailedItemsTitle:d.default.publishFailedItemsTitle,d.default.publishFailedItemsTitleIntervals,t)||"",t)},m[f.ProgressPhase.canceled]=function(e){var t=e.count,n=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(n?d.default.schedulePublishFailedItemsTitle:d.default.publishFailedItemsTitle,d.default.publishFailedItemsTitleIntervals,t)||"",t)},m),b=((g={})[f.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey,i=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(i?d.default.schedulePublishStartedItemsTitle:d.default.publishStartedItemsTitle,d.default.publishStartedItemsDestinationTitleIntervals,t)||"",t,r.createElement(l.ItemLink,{key:"link",itemKey:n}))},g[f.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey,i=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(i?d.default.schedulePublishCompletedItemsDestinationTitle:d.default.publishCompletedItemsDestinationTitle,d.default.publishCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(l.ItemLink,{key:"link",itemKey:n}))},g[f.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey,i=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(i?d.default.schedulePublishFailedItemsDestinationTitle:d.default.publishFailedItemsDestinationTitle,d.default.publishFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(l.ItemLink,{key:"link",itemKey:n}))},g[f.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey,i=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(i?d.default.schedulePublishFailedItemsDestinationTitle:d.default.publishFailedItemsDestinationTitle,d.default.publishFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(l.ItemLink,{key:"link",itemKey:n}))},g);t.publishProgressAddon=i.createAddon(function(){return function(e){e(s.registerControlHandler(c.publishProgressKeyFacet,o.progressControl)(s.createControlHandler()(w)))}});function w(){return function(e){return E}}function E(e,t){var r,i,s=a.getOverallSimpleProgressBreakdown(e,t),o=s.phase,u=s.count,l=(function(e,t){var n=void 0,r=e.demandItemFacet(h.childItemsFacet,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(f.sourceItemFacet,o),a=u&&u.itemKey,l=e.demandItemFacet(p.parentFolderItemFacet,a),c=l&&l.itemKey;if(c)if(n){if(c!==n)break}else n=c}return n})(e,t),d=e.demandItemFacet(h.childItemsFacet,t.itemKey),m=d&&d.itemKeys;m&&m.length>0&&(i=e.demandItemFacet(c.updatePublishStateOperation,m[0]));var g=!!i&&i.publishActionType===v.PublishActionType.SchedulePublish;r="group"===t.format&&l?b[o]({count:u,itemKey:l,isScheduled:g}):y[o]({count:u,isScheduled:g});return n.__assign(n.__assign({},r&&"item"!==t.format?{title:r}:{}),{})}});
define("GO",["require","exports","r","Ec","Ps","pd","Kf","Rs","hs","KO"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemLink=function(e){var t=e.itemKey,l=e.action;return n.createElement(r.WithItemCache,null,function(r){var c,h=r.itemCache;if(e.children)c=e.children;else{var p=h.demandItemFacet(u.displayNameFacet,t);c=p}var d=a.getCurrentItemKey(h),v=(l||!f.haveSameParentItem(h,{itemKey1:t,itemKey2:d}))&&t?n.createElement(o.ItemDefaultClickAction,{itemKey:t}):null;return n.createElement(i.WithAction,{action:v},function(e){var t=e.isAvailable,r=e.execute,i=t?function(){r().catch(function(){})}:void 0;return i?n.createElement(s.Link,{onClick:i},c):n.createElement("span",null,c)})})}});
define("KO",["require","exports","Bo","qo"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.haveSameParentItem=function(e,t){var i=n.getItemKey(e,{itemKey:t.itemKey1}),s=n.getItemKey(e,{itemKey:t.itemKey2});return r.getPreferredItemKey(e,{itemKey:i})===r.getPreferredItemKey(e,{itemKey:s})}});
define("bE",["require","exports","r","kw","am","Xw"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WarningDialog=function(e){var t=e.title,o=e.prompt,u=e.cancelText,a=e.onCancel;return n.createElement(r.Dialog,{onDismiss:a,hidden:!1,title:t,maxWidth:e.maxWidth},n.createElement(s.Label,null,o),n.createElement(r.DialogFooter,null,n.createElement(i.PrimaryButton,{onClick:a,componentRef:function(e){e&&e.focus()}},u)))}});
define("DM",["require","exports","r","KL","EM","si","wy","CM","IM"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moreCommandsKey=new s.Facet("moreCommands").id;t.CheckOutItemCommand={key:new s.Facet("CheckOutItem").id,automationId:"checkOutItemCommand",name:i.default.CheckOut,iconProps:{iconName:"ArrowDownRight8"},action:n.createElement(r.CheckOutItemAction,{checkInOutType:"checkOut"})};t.CheckInItemCommand={key:new s.Facet("CheckInItem").id,automationId:"checkInItemCommand",name:i.default.CheckIn,iconProps:{iconName:"ArrowDownRight8"},action:n.createElement(r.CheckOutItemAction,{checkInOutType:"checkIn"})};t.UndoCheckoutItemCommand={key:new s.Facet("UndoCheckOutItem").id,automationId:"undoCheckoutItemCommand",name:i.default.UndoCheckOut,iconProps:{iconName:"ArrowDownRight8"},action:n.createElement(r.CheckOutItemAction,{checkInOutType:"undoCheckOut"})};t.viewDocumentPropertyCommand={key:new s.Facet("ViewDocumentProperties").id,name:o.default.ViewProperties,action:n.createElement(a.EditItemAction,{interactiveSave:!0})};t.MoreCommands={key:t.moreCommandsKey,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:[t.viewDocumentPropertyCommand,t.CheckOutItemCommand,t.CheckInItemCommand,t.UndoCheckoutItemCommand]}};t.getMoreCommands=function(e){var n=e.listFacets,r=u.getApproveRejectCommand({listFacets:n}),i=!!n&&!n.isDocumentLibrary;return{key:t.moreCommandsKey,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:i?[r]:[t.viewDocumentPropertyCommand,t.CheckOutItemCommand,t.CheckInItemCommand,t.UndoCheckoutItemCommand,r]}}}});
define("KL",["require","exports","lC","r","ii","T3","Rs","oi","C1","li","ai","tv","Ps","Yo","Es","Ro","ks"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=c.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["vVe"],t,n)})];case 1:return[2,t.sent().CheckOutItemWizard]}})})});t.CheckOutItemAction=a.createItemCacheComponent(function(e,t){var a=t.checkInOutType,c=v.getCurrentItemSetKey(e),y=p.getSelectedItemKeys(e);if(!y.length)return null;var b=e.demandItem({firstItemKey:f.spItemKeyFacet},y[0]).firstItemKey;if(!b)return null;var w=b&&e.demandItemFacet(i.spPageContextFacet,f.spPageContextKeyFacet.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl}));if(w&&(w.isAnonymousGuestUser||w.isEmailAuthenticationGuestUser))return null;for(var E=e.demandItemFacet(i.listFacet,f.spListKeyFacet.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl})),S=!!E&&E.templateType===l.ListTemplateType.mySiteDocumentLibrary,x=!!E&&!!E.enableMinorVersions,T=!1,N=0,C=y;N<C.length;N++){var k=C[N],L=e.demandItemFacet(o.folderFacet,k),A=e.demandItemFacet(u.oneNoteFacet,k);if(k&&!L&&!A){var O=e.demandItem({isCheckedOut:o.isCheckedOutFacet,isBFile:i.isBFileFacet},k),M=O.isCheckedOut,_=O.isBFile,D=e.demandItemFacet(i.permissionsFacet,k),P=s.PermissionMask.hasItemPermission({permissions:D},s.PermissionMask.editListItems),H=s.PermissionMask.hasItemPermission({permissions:D},s.PermissionMask.cancelCheckout);"checkOut"===a?T=!_&&!S&&!(M&&(M.byYou||M.byOther))&&P:"checkIn"!==a&&"undoCheckOut"!==a||!M||(T=P&&(!!M.byYou||H&&!!M.byOther))}if(!T)break}var B=y?h.renderComponentOnExecute(function(e){return r.createElement(g,n.__assign({},e,{itemSetKey:c,itemKeys:y,checkInOutType:a,enableMinorVersions:x}))}):void 0;return r.createElement(m.Action,n.__assign({isAvailable:T,onExecute:B},d.getItemActionEngagement(e,{itemKey:y[0],engagement:{name:a,isIntentional:!0,extraData:{isBulk:y.length>1}}})))})});
define("CM",["require","exports","r","si","wy","OM","ai"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.approveRejectCommandKey=new r.Facet("ApproveReject").id;t.getApproveRejectCommand=function(e){var r=e.listFacets,u=r&&r.templateType===o.default.webPageLibrary&&r.isModerated?i.default.ReviewApprovals:i.default.ApproveReject;return{key:t.approveRejectCommandKey,automationId:"approveRejectCommand",iconProps:{iconName:"DocumentApproval"},name:u,action:n.createElement(s.ApproveRejectAction,null)}}});
define("OM",["require","exports","lC","r","C1","ks","_s","To","li","ii","Es","wM","NL","T3","c7","A1","g6","Xy","ai","qf","Rs","Ps","tv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x={ODB:1499},T=S.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["WF"],t,n)})];case 1:return[2,t.sent().ApproveRejectDialog]}})})}),N=i.createItemCacheComponent(function(e,t){var i=t.onContinue,s=t.onCancel,o=t.resolve,a=t.reject,f=n.__rest(t,["onContinue","onCancel","resolve","reject"]);return r.createElement(T,n.__assign({},f,{onContinue:function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return i?[4,i(e)]:[3,2];case 1:t.sent();t.label=2;case 2:o();return[2]}})})},onCancel:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return s?[4,s()]:[3,2];case 1:e.sent();e.label=2;case 2:a(new u.CancelError);return[2]}})})}}))}),C=i.createItemCacheComponent(function(e,t){var i=t.itemKeys,u=o.getCurrentItemSetKey(e);if(!u)return null;var S=e.demandItem({setKey:a.spFolderItemSetKeyFacet},u).setKey;if(!S||!i||!i.length)return null;var T=v.getConfiguration(e,{enbableApproveRejectConfiguration:f.enableApproveRejectCommandConfigurationFacet}).enbableApproveRejectConfiguration,C=g.getPageContextFromItemCache(e,i[0]);if(!T||!m.isFeatureEnabled(e,{feature:x,pageContext:C}))return null;var k=!0,L=e.demandItemFacet(f.listFacet,a.spListKeyFacet.serialize({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl}));if(L&&L.templateType===y.default.webPageLibrary&&i.length>1)return null;for(var A,O,M=!0,_=!0,D=!1,P={},H=0,B=i;H<B.length;H++){var j=B[H];if(!h.isApprovalRelevant(e,{itemKey:j,listFacets:L}))return null;var F=e.demandItem({permissions:f.permissionsFacet,moderationStatusType:f.moderationStatusTypeFacet,moderationComments:f.moderationCommentsFacet},j),I=F.permissions,q=F.moderationStatusType,R=F.moderationComments;if(L&&!L.isDocumentLibrary&&!p.default.hasItemPermission({permissions:I},p.default.layoutsPage))return null;if(void 0!==q){var U=P[d.ModerationStatusType[q]];P[d.ModerationStatusType[q]]=U?U+1:1}void 0===A?A=R:A!==R&&(M=!1);void 0===O?O=q:O!==q&&(_=!1);q===d.ModerationStatusType.draft&&(D=!0);if(!(k=h.isFolder(e,{itemKey:j,includeOneNote:!0})||q===d.ModerationStatusType.pending||!!L&&!L.enableMinorVersions))return null}if(L&&L.templateType===y.default.webPageLibrary){if(k){return(j=t.itemKeys?t.itemKeys[0]:void 0)?r.createElement(b.ItemOpenUrlAction,{itemKey:t.itemKeys?t.itemKeys[0]:"",engagement:{name:"ApproveReject",isIntentional:!0}}):null}return null}var z,W=_&&O===d.ModerationStatusType.draft&&!!L&&!!L.enableMinorVersions,X=D,V=e.dispatch,$=function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){t=[{FieldName:"_ModerationStatus",FieldValue:e.status.toString()}];void 0!==e.comment&&t.push({FieldName:"_ModerationComments",FieldValue:e.comment});return[2,V(c.bulkUpdateListItems({items:(r={},r[u]={itemKeys:i,formValues:t,qosName:"BulkApproveReject"},r)}))]})})},J=i.length,K=J>1?"BulkApproveReject":"ApproveReject";1===J&&(z=e.demandItemFacet(w.displayNameFacet,i[0]));var Q=E.renderComponentOnExecute(function(e){return r.createElement(N,n.__assign({},e,{onContinue:$,hideApproveRejectOptions:W,showDraftOption:X,initialComment:M?A:void 0,initialStatus:_?O:void 0,itemCount:i.length,itemName:z,initialStatusMapForBulkEdit:P}))});return r.createElement(s.Action,n.__assign({isAvailable:k,onExecute:Q},l.getItemActionEngagement(e,{itemKey:i[0],engagement:{name:K,isIntentional:!0}})))});t.ApproveRejectAction=o.withSelectedItems()(C)});
define("tP",["require","exports","lC","r","si","wy","nP","a1"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.exitQuickEditCommand={key:new i.Facet("exitQuickEdit").id,automationId:"exitQuickEditCommand",name:s.default.ExitQuickEditTitle,action:r.createElement(o.ExitQuickEditAction,null),iconProps:{iconName:"CheckMark"}};t.getExitQuickEditCommand=function(e){return e&&1===u.getVariantAndLogExposure(90016,e)?n.__assign(n.__assign({},t.exitQuickEditCommand),{name:s.default.ExitGridView,iconProps:{iconName:"ViewList"}}):t.exitQuickEditCommand}});
define("nP",["require","exports","lC","_s","ii","A1","Oy","Go","y6"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExitQuickEditAction=r.withCurrentItemSet()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["EVe"],t,n)})];case 1:return[2,t.sent().ExitQuickEditActionExecutor]}})})},function(e,t){var n=s.getConfiguration(e,{enableQuickEdit:i.enableQuickEditFacet}).enableQuickEdit,r=!!n;if(n){r=u.getCurrentLayout(e)===a.quickEditLayoutType}return r}))});
define("mM",["require","exports","r","si","Rs","Xo","b7","li","ii","SM","bM","hM","fc","lc","SPListItemsScopeDeferred_IS_mini_css","bs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";d=d.CustomActionCommands_5;Object.defineProperty(t,"__esModule",{value:!0});var m=new r.Facet("customActionNavigationCommand").id;function g(e){var t=e.key,r=e.name,i=e.url,s=e.iconUrl,o=e.enabledForMultipleItems,u=e.isEnabledFunc,a=e.commandAdapter;return{key:m+"-"+t,automationId:"customactionNavigation",name:r,iconProps:{iconType:h.IconType.image,className:d.customActionCommandIcon,imageProps:{src:s||"",imageFit:p.ImageFit.contain,className:d.customActionCommandIcon}},action:a?n.createElement(c.ClientSideCommandSetAction,{enabledForMultipleItems:o,isEnabledFunc:u,commandAdapter:a}):i?n.createElement(l.CustomActionNavigationAction,{url:i,enabledForMultipleItems:o,isEnabledFunc:u}):void 0}}t.getCustomActionNavigationCommand=g;var y=new r.Facet("customActionGroupCommand").id;function b(e){var t=e.key,n=e.name,r=e.subCommands;return{key:y+"-"+t,automationId:"customActionGroupCommand",name:n,subMenuProps:{items:r}}}t.getCustomActionGroupCommand=b;t.getCustomActionCommands=function(e,t){var n=t.webAbsoluteUrl,r=t.listFullUrl,i=u.customActionSetKeyFacet.serialize({webAbsoluteUrl:n,listFullUrl:r}),s=E({itemCache:e,targetCustomActionSetKey:i,keys:{webAbsoluteUrl:n,listFullUrl:r}}),o=w(e,i);s&&(o=o.concat(w(e,s)));return o};function w(e,t){var n=[],r=e.demandItemFacet(s.childItemsFacet,t);r&&r.itemKeys&&r.itemKeys.forEach(function(t){var r=e.demandItem({displayName:i.displayNameFacet,openUrl:i.openUrlFacet,iconUrl:f.iconUrlFacet,childItemKeys:s.childItemsFacet,enabledForMultipleItems:f.enabledForMultipleItemsFacet,isEnabledFunc:f.isEnabledFunctionFacet,commandAdapter:o.commandAdapterFacet},t);if(r&&r.displayName){var u=r.displayName,a=r.openUrl,l=r.iconUrl,c=r.enabledForMultipleItems,h=r.isEnabledFunc,p=r.childItemKeys,d=r.commandAdapter;if(p&&p.itemKeys&&p.itemKeys.length>0){var v=[];p.itemKeys.forEach(function(n,r,s){var u=e.demandItem({subMenuDisplayName:i.displayNameFacet,openUrl:i.openUrlFacet,iconUrl:f.iconUrlFacet,enabledForMultipleItems:f.enabledForMultipleItemsFacet,isEnabledFunc:f.isEnabledFunctionFacet,commandAdapter:o.commandAdapterFacet},n);u&&u.subMenuDisplayName&&v.push(g({key:t+"-"+n,name:u&&u.subMenuDisplayName,url:u&&u.openUrl,iconUrl:u&&u.iconUrl,enabledForMultipleItems:u&&u.enabledForMultipleItems,isEnabledFunc:u&&u.isEnabledFunc,commandAdapter:u&&u.commandAdapter}))});n.push(b({key:t,name:u,subCommands:v}))}else u&&n.push(g({key:t,name:u,url:a,iconUrl:l,enabledForMultipleItems:c,isEnabledFunc:h,commandAdapter:d}))}});return n}t.getCustomActionSetCommands=w;function E(e){var t=e.keys,n=t.webAbsoluteUrl,r=t.listFullUrl,i=e.itemCache,f=e.targetCustomActionSetKey,l=void 0,c=u.spListKeyFacet.serialize({webAbsoluteUrl:n,listFullUrl:r}),h=i.demandItemFacet(o.isSpfxLoadedFacet,c),p=i.demandItemFacet(a.rawCustomActionsFacet,f),d=!!h&&!!p,m=v.getItemsScope(i).itemsScopeItemKey;if(d&&m){var g=u.customActionSetWithExtensionsKeyFacet.serialize({webAbsoluteUrl:n,listFullUrl:r,isSPFXandCustomActionsAvailable:d,targetCustomActionSetKey:f,itemsScopeItemKey:m});i.demandItemFacet(s.childItemsFacet,g)&&(l=g)}return l}t.demandCustomActionSetWithExtensions=E});
define("bM",["require","exports","lC","ks","_s","C1","ii","li","vM","gM","Es"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};t.CustomActionNavigationAction=i.withCurrentItem()(i.withSelectedItems()(s.connectToItemCache(function(e,t){var r,i,s,h=t.itemKey,p=t.itemKeys,d=t.enabledForMultipleItems,v=void 0===d?t.enabledForMultipleItems||!1:d,m=t.isEnabledFunc,g=t.url,y=!!v||1===p.length,b=void 0,w=void 0;if(y&&p[0]){var E=e.demandItem({key:u.spItemKeyFacet,permissions:o.permissionsFacet,rowData:o.rowDataFacet},p[0])||void 0;if(E){w=E.key;b=E.rowData;s=E.permissions}}else if(y&&h){var S=e.demandItem({key:u.spItemKeyFacet,permissions:o.permissionsFacet},h);if(S){w=S.key;s=S.permissions}}r=w&&w.webAbsoluteUrl;i=w&&w.listFullUrl;var x=r&&i&&e.demandItemFacet(o.spPageContextFacet,u.spPageContextKeyFacet.serialize({webAbsoluteUrl:r,listFullUrl:i}))||void 0;if(y&&!v)if("boolean"==typeof m)y=m;else if("function"==typeof m){var T="",N="",C="";if(b){var k=b;T=k.File_x0020_Type||"";N=k.ContentTypeId||"";C=k.ProgId||""}else y=!1;y=m({permissions:s||0,extension:T,contentTypeId:N,progId:C})}if(y&&g){var L=[];p.forEach(function(t){var n=e.demandItem({itemId:o.listItemIdFacet,itemUrl:o.folderPathFacet},t);n&&L.push({id:n.itemId||"",url:n.itemUrl||""})});x&&(g=a.prepareAction(g,L,x))}var A=c;A=g&&"javascript:LaunchApp("===g.substring(0,21)&&");"===g.substring(g.length-2)?function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){g&&x&&f.invokeLaunchAppFunction(g,x);return[2]})})}:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){(e=window.open(g,"_blank"))&&e.focus();return[2]})})};return n.__assign({isAvailable:y,onExecute:A},l.getItemActionEngagement(e,{itemKey:p[0],engagement:{name:"CustomActionNavigation",isIntentional:!0}}))})(r.Action)))});
define("hM",["require","exports","lC","r","ks","_s","C1","ii","b7","li","Es","ce","xo","Jr"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})},v=o.createItemCacheComponent(function(e,t){var s=t.itemKeys,o=t.enabledForMultipleItems,h=void 0===o?t.enabledForMultipleItems||!1:o,p=t.isEnabledFunc,v=t.commandAdapter,g=e.dispatch,y=!!h||1===s.length;if(y&&1===s.length&&"function"==typeof p){var b=e.demandItem({key:f.spItemKeyFacet,permissions:u.permissionsFacet,rowData:u.rowDataFacet},s[0]),w="",E="",S="";if(b&&b.rowData){var x=b.rowData;w=x.File_x0020_Type||"";E=x.ContentTypeId||"";S=x.ProgId||""}else y=!1;y=y&&p({permissions:b&&b.permissions||0,extension:w,contentTypeId:E,progId:S})}if(y&&v){var T=[];s.forEach(function(t){var n=e.demandItemFacet(a.rowAdapterFacet,t);n&&T.push(n)});v.refresh(T);y=y&&v.visible}var N=d;v&&(N=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2,v.execute()]})})});var C=!c.Killswitch.isActivated("416CBFAD-51CE-4EFF-8231-D4EFCAC3DB3C","12/13/2019","Generate rowAdapter if not available");return r.createElement(r.Fragment,null,C?r.createElement(m,{dispatch:g,itemKeys:s}):null,r.createElement(i.Action,n.__assign({isAvailable:y,onExecute:N},l.getItemActionEngagement(e,{itemKey:s[0],engagement:{name:"ClientSideCommandSet",isIntentional:!0}}))))}),m=function(e){var t=e.dispatch,r=e.itemKeys;if(r.length<1)return null;var i=r[0],s=void 0;if(f.spItemKeyFacet.matches(i)){var o=f.spItemKeyFacet.deserialize(i);if(o){var l=f.spListKeyFacet.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});s=t(h.readItem({listViewAdapter:a.listViewAdapterFacet},l)).listViewAdapter}}var c={};if(s){r.forEach(function(e){var r=t(h.readItem({rowData:u.rowDataFacet,rowAdapter:a.rowAdapterFacet},e)),i=r.rowData;if(!r.rowAdapter&&i&&s){var o=s.createRowAdapter({values:i});o&&(c[e]=n.__assign({},a.rowAdapterFacet.pack(o)))}});Object.keys(c).length>0&&t(p.resolveItems({items:c}))}return null};t.ClientSideCommandSetAction=s.withSelectedItems()(v)});
define("ZM",["require","exports","r","es","si","$M"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.showKeymapShortcut={key:new i.Facet("ShowKeymapShortcut").id,automationId:"ShowKeymapShortcut",shortcutProps:{keySequences:["Shift/"],content:r.default.showKeymapDesc},action:n.createElement(s.ShowKeyboardMapAction,null)}});
define("$M",["require","exports","r","am","kw","es","ks","SPListItemsScopeDeferred_IS_mini_css","hE","C1","Ps","Ar"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";u=u.ShowKeyboardMap_4;Object.defineProperty(t,"__esModule",{value:!0});var h=[{keys:"Ctrl + a",desc:s.default.selectAllDesc},{keys:"Ctrl + d",desc:s.default.deselectAllDesc},{keys:"esc",desc:s.default.escDesc},{keys:"space",desc:s.default.spaceDesc},{keys:"enter",desc:s.default.enterDesc}],p=[{keys:"F2",desc:s.default.renameDesc},{keys:"Delete",desc:s.default.deleteDesc},{keys:"s",desc:s.default.showShareDesc},{keys:"alt + up",desc:s.default.altUpDesc},{keys:"?",desc:s.default.showKeymapDesc},{keys:"g",desc:s.default.showActionDetailsDesc},{keys:"i",desc:s.default.toggleInfoDesc}];function d(e){var t=e.resolve,o=c.useEventHandler(function(){t()}),f=[h,p],l=-1,d=-1;return n.createElement(a.KeyboardZone,null,n.createElement(i.Dialog,{onDismiss:o,hidden:!1,dialogContentProps:{type:i.DialogType.close,title:s.default.KeyboardMapTitle},styles:v},f.map(function(e){return n.createElement("div",{className:u.keyboardMapGroup,key:"keyMap"+ ++l},n.createElement("ul",{className:u.keyboardMapTable,key:""+l},e.map(function(e){return n.createElement("li",{className:u.keyboardMapRow,key:""+ ++d},n.createElement("span",{className:u.keyboardMapKey,key:l+"."+d+".0.0"},e.keys),n.createElement("span",{className:u.keyboardMapVal,key:l+"."+d+".1.1"},e.desc))})))}),n.createElement(i.DialogFooter,null,n.createElement(r.PrimaryButton,{onClick:o},s.default.okButtonText))))}t.KeyboardMapDialog=d;t.ShowKeyboardMapAction=f.createItemCacheComponent(function(e){var t=l.renderComponentOnExecute(d);return n.createElement(o.Action,{onExecute:t})});function v(){return{main:{maxWidth:"700px !important"}}}});
define("hE",["require","exports","r","ns","Vr","Qn"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=0;t.KeyboardZone=function(e){var t=e.isDefault,s=void 0!==t&&t,u=n.useState(""+ ++o)[0],f=n.useContext(r.KEYBOARD_CONTEXT),l=n.useRef(),c=l.current||s&&f.keyboardManager||(l.current=new r.KeyboardManager({isDefault:!1,id:u,parent:f.keyboardManager})),h=a(c),p=h.isActive,d=h.isChildActive;n.useEffect(function(){return function(){if(!s){c.setIsActive(!1);c.dispose()}}},[]);var v=n.useMemo(function(){return{keyboardManager:c}},[c]);return n.createElement("div",{"data-keyboard-zone-id":u},n.createElement(r.KEYBOARD_CONTEXT.Provider,{value:v},i.renderChildrenWithProps(e.children,{isActive:p,isChildActive:d})))};t.WithKeyboardZone=function(e){var t=u(),n=t.isActive,r=t.isChildActive;return i.renderChildrenWithProps(e.children,{isActive:n,isChildActive:r})};function u(){return a(n.useContext(r.KEYBOARD_CONTEXT).keyboardManager)}t.useKeyboardZone=u;function a(e){var t=n.useState(function(){return e.getIsActive()}),r=t[0],i=t[1],o=n.useState(function(){return e.hasActiveChildren()}),u=o[0],a=o[1];n.useEffect(function(){var t=new s.EventGroup(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:r,isChildActive:u}}});
define("dE",["require","exports","r","es","si","lE"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.navigateUpShortcut={key:new i.Facet("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:r.default.altUpDesc},action:n.createElement(s.NavigateUpAction,null)}});
define("lE",["require","exports","r","Rs","Xf","_s","C1"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.createItemCacheComponent(function(e,t){var s=t.itemKey,o=e.demandItemFacet(r.parentFolderItemFacet,s),u=o&&o.itemKey;return n.createElement(i.ItemOpenAction,{itemKey:u})});t.NavigateUpAction=s.withOnlyCurrentItem()(u)});
define("JM",["require","exports","r","es","si","XM"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNPSSurveyFocusShortcut={key:new i.Facet("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:r.default.getNPSSurveyFocusShortcut},action:n.createElement(s.SetFocusAction,{elementId:"obf-TPromptContainer"})}});
define("XM",["require","exports","lC","r","ks","C1"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetFocusAction=s.createItemCacheComponent(function(e,t){return r.createElement(i.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})});
define("SL",["require","exports","lC","r","si","fc","lc","ML","LL","CL","xL","me","Xo","Rs","pb","mS","SPListItemsScopeDeferred_IS_mini_css","o8","DL"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";m=m.FileHandlerCommands_8;Object.defineProperty(t,"__esModule",{value:!0});var b=new i.Facet("fileHandlerOpenCommand").id,w=new i.Facet("fileHandlerCreateCommand").id,E=new i.Facet("fileHandlerCustomCommand").id,S=new i.Facet("fileHandlerAppCommand").id,x=new i.Facet("fileHandlerActionsCommand").id;t.getFileHandlerCommands=function(e,t){var n=t.itemKey,r=t.collapseCustomCommands,i=e.demandItem({actions:v.fileHandlerActionsFacet,version:v.fileHandlerVersionFacet},n),s=i.actions,o=i.version;if(o&&4===o&&s){var u=function(t){var n=s&&s[t],r=e.demandItemFacet(h.childItemsFacet,n);return r&&r.itemKeys||[]};return{new:N(e,{actionKeys:u("create"),type:"create"})||[],open:N(e,{actionKeys:u("open"),type:"open"})||[],custom:N(e,{actionKeys:u("custom"),type:"custom",collapseCustomCommands:r})||[]}}};t.mergeFileHandlerCommands=function(e,t,n){var r=n?t:e,i=n?e:t,s=r,o={};r.forEach(function(e){o[e.key]=!0});i.forEach(function(e){o[e.key]||s.push(e)});return s};function T(e,t){var n,i,h,y,x,T=t.itemKey,N=t.type,C=t.CustomAction,k=void 0,L=void 0;if("app"===N){k=T;if(!(j=T&&e.demandItem({displayName:p.displayNameFacet,appIcon:v.fileHandlerAppIconFacet},T)))return;h=S+"-"+T;y="itemsScopefileHandlerAppCommand";n=j.displayName;j.appIcon&&j.appIcon.url&&(i={iconType:s.IconType.Image,className:m.fileHandlerCommandIcon,imageProps:{src:j.appIcon&&j.appIcon.url||"",title:j.displayName||"",imageFit:o.ImageFit.contain,className:m.fileHandlerCommandIcon}})}else{var A=e.demandItem({displayName:p.displayNameFacet,handlerKey:v.fileHandlerKeyFacetFacet,availableOn:v.fileHandlerActionAvailableOnFacet,icon:v.fileHandlerFileTypeIconFacet,isPromoted:v.fileHandlerIsPromotedFacet},T),O=A.displayName,M=A.handlerKey,_=A.availableOn,D=A.icon;L=A.isPromoted;var P=M&&e.demandItemFacet(v.fileHandlerAppIconFacet,M),H="open"===N&&P||D;H&&H.url&&(i={iconType:s.IconType.Image,className:m.fileHandlerCommandIcon,imageProps:{src:H&&H.url,title:H&&H.displayName,imageFit:o.ImageFit.contain,className:m.fileHandlerCommandIcon}});var B=g.getFileHandlerActionProp(e,{itemKey:T});n=O;switch(N){case"open":if(!n&&M){var j;n=(j=T&&e.demandItem({displayName:p.displayNameFacet},M))&&j.displayName&&c.format(l.default.openWithCommand,j.displayName)}h=b;y="itemsScopefileHandlerOpenCommand";x=C?r.createElement(C,{action:B}):r.createElement(u.FileHandlerOpenAction,{action:B});break;case"create":n||(n=D&&D.displayName||_&&_.file&&_.file.extensions&&c.format(l.default.createFileWithExtension,_.file.extensions[0])||"");h=w;y="itemsScopefileHandlerCreateCommand";x=r.createElement(d.HideWithSelection,null,r.createElement(a.FileHandlerCreateAction,{action:B}));break;case"custom":h=E;y="itemsScopefileHandlerCustomCommand";O&&(y=O.toLowerCase().replace(/\s+(.)/g,function(e,t){return t.toUpperCase()})+"Command");x=C?r.createElement(C,{action:B}):r.createElement(f.FileHandlerCustomAction,{action:B})}h+="-"+T;k=M}if(h&&n)return{key:h,automationId:y,name:n,iconProps:i,action:x,handlerKey:k,isPromoted:L,fileHandlerType:N}}function N(e,t){var r=t.actionKeys,i=t.type,s=t.collapseCustomCommands,o=void 0===s||s,a=[];if("open"===i){var c=e.demandItemFacet(y.fileHandlerOpenActionControlFacet,r[0]),h=y.fileHandlerOpenActionControlFacet.evaluate(c)(e,{openActionAs:u.FileHandlerOpenAction}).openActionAs;r.forEach(function(t){var n=T(e,{itemKey:t,type:i,CustomAction:h});n&&a.push(n)})}else if("create"===i)r.forEach(function(t){var n=T(e,{itemKey:t,type:i});n&&a.push(n)});else if("custom"===i){c=e.demandItemFacet(y.fileHandlerCustomActionControlFacet,r[0]);var p=y.fileHandlerCustomActionControlFacet.evaluate(c)(e,{customActionAs:f.FileHandlerCustomAction}).customActionAs,d=(function(e,t){var r=t.actionKeys,i=t.collapseCustomCommands,s=t.CustomAction,o=void 0,u=[],a={},f=function(t){return T(e,{itemKey:t,type:"custom",CustomAction:s})},c=function(t,n){var r=T(e,{itemKey:t,type:"app"});r&&n&&n.length>0&&(r.subMenuProps={items:n});return r};if(i){for(var h=0,p=r;h<p.length;h++){var d=p[h],v=f(d);if(v){var g=v.handlerKey||"";if(o){if(!o.subMenuProps){var y=n.__assign({},o),b=Object.keys(a)[0];if(N=c(b)){o=N;if(g===b){N.subMenuProps={items:[y,v]};continue}}}var w=Object.keys(a).length;if(void 0!==a[g]){var E=o.subMenuProps;if(1===w)E&&E.items.push(v);else{var S=a[g];if(E){var N;(N=E.items[S]).subMenuProps&&N.subMenuProps.items.push(v)}}}else{var C=c(g,[v]);if(!C)continue;if(1===w){var k=n.__assign({},o);o={key:""+x,automationId:"itemsScopefileHandlerActionsCommand",name:l.default.fileHandlerRootActionsMenu,iconProps:{iconName:"SetAction",ariaLabel:l.default.fileHandlerRootActionsMenuAriaLabel,className:m.fileHandlerCommandIcon},subMenuProps:{items:[k,C]}};a[g]=1}else{o.subMenuProps&&o.subMenuProps.items.push(C);a[g]=w}}}else{o=v;a[g]=0}}}o&&(u=[o])}else for(var L=0,A=function(e){var t=f(e);if(!t)return"continue";var r=t.handlerKey||"",i=c(r,[t]),s=!1;if(i){Object.keys(a).forEach(function(e){if(r===e){s=!0;var i=u[a[e]];i.subMenuProps&&(i.subMenuProps={items:n.__spreadArrays(i.subMenuProps.items,[t])})}});if(!s){a[r]=L;L++;u.push(i)}}else{a[r]=L;L++;u.push(t)}},O=0,M=r;O<M.length;O++){d=M[O];A(d)}return u})(e,{actionKeys:r,collapseCustomCommands:o,CustomAction:p});d&&a.push.apply(a,d)}return a}});
define("ML",["require","exports","lC","C1","OL","_s","Rs","Es","OL"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemFileHandlerOpenAction=r.connectToItemCache(function(e,t){var r=t.itemKey,i=t.action,s=!1;if(r){var f=e.demandItem({fileName:o.fileNameFacet,isFolder:o.folderFacet},r),l=f&&f.fileName,c=l&&l.extension||"",h=f&&f.isFolder||!1;s=a.isActionAvailable(i.availableOn,c,Boolean(h))}var p=i.handler,d=p.appId,v=p.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",m={appId:d};return n.__assign({isAvailable:s,itemKeys:r?[r]:[]},u.getItemActionEngagement(e,{itemKey:r,engagement:{name:v,isIntentional:!0,extraData:m}}))})(i.FileHandlerInvokeAction);t.FileHandlerOpenAction=s.withSelectedItems()(s.withExactlyOneItem()(t.ItemFileHandlerOpenAction))});
define("OL",["require","exports","lC","r","C1","_s","ks","kw","am","Yb","DL","EL","To","wL","ph","GA","Ps"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=i.createItemCacheComponent(function(e,t){var i,s=t.itemKeys,g=t.action,y=t.isAvailable,b=t.itemKey,w=g.handler,E=w.appId,S=w.isPromoted,x="",T=b||(1===s.length?s[0]:""),N=e.demandItem({controlHandler:l.fileHandlerActionControlFacet,driveItemKey:d.driveItemKeyFacet},T),C=N.controlHandler,k=N.driveItemKey;(x=k&&v.getDriveUrl(k)||"").indexOf("/v2.1")>-1&&(x=x.replace("/v2.1","/v2.0"));var L=l.fileHandlerActionControlFacet.evaluate(C)(e,{itemKey:T}).sharedPostData;i=L;var A=e.dispatch;if(!(y&&g.url&&i&&x))return null;var O=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(o){switch(o.label){case 0:e=window.open("","_blank");return[4,A(c.getItemUrls({appId:E,itemKeys:s,getPreAuthUrl:!S,driveUrl:x})).catch(function(){})];case 1:if((t=o.sent())&&t.length>0&&e&&e.document){e.opener=null;r=JSON.stringify(t||[]);f.navigateViaPost({url:g.url,postdata:n.__assign(n.__assign({},i),{appId:E,items:r}),document:e.document})}else e&&e.close();return[2]}})})},M=S?m.renderComponentOnExecute(function(e){var t=e.resolve,i=e.reject,s=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){i(new h.CancelError);return[2]})})};return r.createElement(u.Dialog,{dialogContentProps:{title:p.default.consentDialogTitle,onDismiss:s},hidden:!1},r.createElement("p",null,p.default.consentDialogMessage),r.createElement(u.DialogFooter,null,r.createElement(a.PrimaryButton,{onClick:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:t();return[4,O()];case 1:e.sent();return[2]}})})}},p.default.consentDialogContinueButton),r.createElement(a.Button,{onClick:s},p.default.consentDialogCancelButton)))}):O;return r.createElement(o.Action,n.__assign({isAvailable:y,onExecute:M},t))});t.FileHandlerInvokeAction=s.withCurrentItem()(g);t.isActionAvailable=function(e,t,n){var r=e.file,i=e.folder,s=e.file&&e.file.extensions||void 0;return!0===n?!!i:!(!r||!t)&&(!s||-1!==s.indexOf(t.toLowerCase())||-1!==s.indexOf("*")||-1!==s.indexOf(".*"))}});
define("EL",["require","exports","lC","xo","Rs","AL","GA","qA"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemUrls=function(e){var t=this;return function(a){return n.__awaiter(t,void 0,void 0,function(){var t,f,l,c,h,p;return n.__generator(this,function(n){switch(n.label){case 0:t=e.appId,f=e.itemKeys,l=e.getPreAuthUrl,c=e.driveUrl;if(!l)return[2,f.map(function(e){return a(r.readItem({vroomUrl:i.vroomUrlFacet},e)).vroomUrl||""})];h=f.map(function(e){return a(r.readItem({fullUrl:i.canonicalUrlFacet},e)).fullUrl||""});return[4,a(u.getSessionToken(c,c))];case 1:p=n.sent();return[2,new s.default({},{dataRequestor:a(o.getDataRequestor).dataRequestor}).getPreAuthUrls({appId:t,items:h,accessToken:p,driveUrl:c})]}})})}}});
define("AL",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.getPreAuthUrls=function(e){var t=e.items,n=e.accessToken,r=void 0===n?void 0:n,i=e.driveUrl,s=void 0===i?"":i,o=e.appId,u={items:t};return this._dataRequestor.send({path:(s||"/drive")+"/getPreAuthorizedUrls"+(o?"?appId="+o:""),apiName:"GetPreAuthorizedUrls",postData:JSON.stringify(u),requestType:"POST",accessToken:r,useAuthorizationHeaders:!!r}).then(function(e){return e.value})};return e})();t.default=n});
define("LL",["require","exports","lC","r","C1","ks","_s","Es","JS","Nr","OL","Rs","xo","C_","kL","$1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=new f.AutoKeyFacet("newDocument"),g=p.asAutoAction()(l.FileHandlerInvokeAction),y=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onItemOpened=function(){n.setState({fileCreated:!1,isItemOpened:!0})};n.state={newDocumentKey:m.serializeNext()};return n}t.prototype.render=function(){var e=this,t=this.state,i=t.newDocumentKey,o=t.fileCreated,u=t.isItemOpened,f=this.props,l=f.itemCacheDispatch,p=f.itemKey,d=f.parentFolderDriveItemUrl,m=f.action,y=n.__rest(f,["itemCacheDispatch","itemKey","parentFolderDriveItemUrl","action"]),b=m.availableOn,w=b&&b.file&&b.file.extensions&&b.file.extensions[0]&&b.file.extensions[0].replace(".",""),E=!!w&&!!m.handler,S=void 0;if(E&&w){var x=!m.handler.isPromoted;x&&!d||(S=function(){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,l(a.createCustomDocument({items:(e={},e[p]={newDocumentKey:i,extension:w},e)}))];case 1:t.sent();x&&d&&l((r={newDocumentKey:i,parentFolderDriveItemUrl:d},function(e){var t,i=r.newDocumentKey,s=r.parentFolderDriveItemUrl,o=e(h.readItem({fileName:c.displayNameFacet},i));if(!o||!o.fileName)throw"FileHandler create action: fail to get file name of the new document";var u=s+":/"+o.fileName+":";e(v.resolveItems({items:(t={},t[i]=n.__assign({},c.vroomUrlFacet.pack(u)),t)}))}));this.setState({fileCreated:!0,isItemOpened:!1});return[2]}var r})})})}return o?u?null:r.createElement(g,n.__assign({},y,{onComplete:this._onItemOpened,isAvailable:!0,itemKeys:[i],action:m})):r.createElement(s.Action,n.__assign({},y,{isAvailable:E,onExecute:S}))};return t})(r.Component);t.FileHandlerCreateAction=o.withOnlyCurrentItem()(i.connectToItemCache(function(e,t){var r=t.itemKey,i=t.action,s=e.demandItemFacet(d.getDriveItemFullUrlControlFacet,r),o=d.getDriveItemFullUrlControlFacet.evaluate(s)(e,{itemKey:r}).driveItemFullUrl,a=i.handler,f=a.appId,l=a.isPromoted?"PromotedFileHandlerCreate":"FileHandlerCreate",c={appId:f};return n.__assign(n.__assign({},u.getItemActionEngagement(e,{itemKey:r,engagement:{name:l,isIntentional:!0,extraData:c}})),{parentFolderDriveItemUrl:o||""})})(y))});
define("CL",["require","exports","lC","C1","OL","_s","Rs","Es","OL"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function f(e,t){var r=t.itemKeys,i=t.action,s=i.availableOn,f=s.allowMultiSelect,l=void 0!==f&&f,c=r.length,h=l&&c>0||1===c;h&&(h=r.every(function(t){var n=e.demandItem({fileName:o.fileNameFacet,isFolder:o.folderFacet},t),r=n&&n.fileName,i=r&&r.extension||"",u=n&&n.isFolder||!1;return a.isActionAvailable(s,i,Boolean(u))}));var p=i.handler,d=p.appId,v=p.isPromoted?"PromotedFileHandlerCustom":"FileHandlerCustom",m={appId:d};return n.__assign({isAvailable:h},u.getItemActionEngagement(e,{itemKey:r[0],engagement:{name:v,isIntentional:!0,extraData:m}}))}t.mapSelectedItemsToActionProps=f;t.FileHandlerCustomAction=s.withSelectedItems()(r.connectToItemCache(f)(i.FileHandlerInvokeAction))});
define("Pk",["require","exports","lC","zk","ce","bg","Nk","sf","Tk","SL","cg"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNewCommand=function(e,t){var c=t.contentTypes,h=t.newCommandMenu,p=t.fileHandlerCommands,d=t.isCreateFolderAvailable,v=t.newDocumentTemplates,m=t.contentTypeCommands,g=t.listKey,y={},b={},w=r.initDefaultCommands(),E={},S=[],x=[];if(!i.Killswitch.isActivated("7FE1672F-3DCA-41A7-8CAF-C5B376315694","11/19/2018","Build New menu with newDocumentTemplates")&&v&&v.length){if(m)for(var T=0,N=m;T<N.length;T++){(L=N[T]).name&&(y[L.name]=L)}if(c)for(var C=0,k=c;C<k.length;C++){var L;y[(L=k[C]).displayName]&&L.contentTypeId&&(b[L.contentTypeId]=y[L.displayName])}var A=h.subMenuProps&&h.subMenuProps.items;if(A)for(var O=0,M=A;O<M.length;O++){(B=M[O]).name&&(w[B.name]=B);B.automationId&&(w[B.automationId]=B)}for(var _=void 0,D=0,P=v;D<P.length;D++){var H=P[D];H.isContentType&&H.contentTypeId&&(E[H.contentTypeId]=!0);var B=void 0;H.isUpload&&g?B=a.createDocumentFromTemplate({template:H,listKey:g}):H.isContentType&&H.contentTypeId&&b[H.contentTypeId]?B=b[H.contentTypeId]:w[H.title]?B=w[H.title]:H.templateId&&w[H.templateId]&&(B=w[H.templateId]);if(B){var j=H.templateId||r.commandKeyToTemplateId[B.key];j===r.commandNames.Folder&&(_=!0);x.push(n.__assign(n.__assign({},H),{templateId:j,command:B}));if(H.visible){S.push(B);w[H.title]&&w[H.title].key===s.createFolderCommand.key&&S.push({name:"-",key:"divider_1",itemType:u.ContextualMenuItemType.Divider})}}}!_&&d&&s.createFolderCommand.name&&x.unshift({command:s.createFolderCommand,templateId:r.commandKeyToTemplateId[s.createFolderCommand.key],title:s.createFolderCommand.name,visible:!1});for(var F in b)if(b.hasOwnProperty(F)&&!E[F]){var I=b[F];I.name&&x.push({command:I,contentTypeId:F,isContentType:!0,templateId:F,title:I.name,visible:!0});S.push(I)}}else{x=o.getAllNewCommands(e,{isCreateFolderAvailable:d,contentTypeCommands:m,contentTypes:c});m&&m.length?S.push.apply(S,n.__spreadArrays([s.createFolderCommand,{name:"-",key:"divider_1",itemType:u.ContextualMenuItemType.Divider}],m)):S=h.subMenuProps?n.__spreadArrays(h.subMenuProps.items):[]}p&&p.new&&(S=f.mergeFileHandlerCommands(S,p.new));return{visibleNewCommands:n.__assign(n.__assign({},l.newCommand),{subMenuProps:{items:S}}),allCommands:x}}});
define("zk",["require","exports","bg","lg"],function(e,t,n,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0});t.commandNames={Folder:"NewFolder",Word:"NewDOC",Excel:"NewXSL",PowerPoint:"NewPPT",OneNote:"NewONE",ExcelSurvey:"NewXSLSurvey",FormForExcel:"NewXSLForm",Visio:"NewVSDX"};t.commandKeyToTemplateId=((i={})[n.createFolderCommand.key]=t.commandNames.Folder,i[r.createWordCommand.key]=t.commandNames.Word,i[r.createExcelCommand.key]=t.commandNames.Excel,i[r.createPowerPointCommand.key]=t.commandNames.PowerPoint,i[r.createOneNoteCommand.key]=t.commandNames.OneNote,i[r.createExcelSurveyCommand.key]=t.commandNames.ExcelSurvey,i[r.createFormForExcelCommand.key]=t.commandNames.FormForExcel,i[r.createVisioCommand.key]=t.commandNames.Visio,i);t.initDefaultCommands=function(){var e;return(e={})[t.commandNames.Folder]=n.createFolderCommand,e[t.commandNames.Word]=r.createWordCommand,e[t.commandNames.Excel]=r.createExcelCommand,e[t.commandNames.PowerPoint]=r.createPowerPointCommand,e[t.commandNames.OneNote]=r.createOneNoteCommand,e[t.commandNames.ExcelSurvey]=r.createExcelSurveyCommand,e[t.commandNames.FormForExcel]=r.createFormForExcelCommand,e[t.commandNames.Visio]=r.createVisioCommand,e}});
define("Nk",["require","exports","bg","zk","cg","jk","Bk"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAllNewCommands=function(e,t){var u=t.isCreateFolderAvailable,a=t.contentTypeCommands,f=void 0===a?[]:a,l=t.contentTypes,c=[];u&&n.createFolderCommand.name&&c.push({command:n.createFolderCommand,templateId:r.commandKeyToTemplateId[n.createFolderCommand.key],title:n.createFolderCommand.name,visible:!0});var h=!(!f||!f.length),p={};if(l)for(var d=0,v=l;d<v.length;d++){var m=v[d];m.contentTypeId&&(p[m.displayName]=m.contentTypeId)}if(h)for(var g=0,y=f;g<y.length;g++){if((x=y[g]).name){var b=p[x.name];c.push({command:x,contentTypeId:b,isContentType:!0,templateId:b,title:x.name||"",visible:!0})}}var w=i.newCommand.subMenuProps&&i.newCommand.subMenuProps.items;if(w)for(var E=0,S=w;E<S.length;E++){var x;(x=S[E]).name&&-1===[n.createFolderCommand.key,"divider_1","divider_2",s.AddTemplateCommand.key,o.editNewMenuKey].indexOf(x.key)&&c.push({command:x,templateId:r.commandKeyToTemplateId[x.key],title:x.name,visible:!h})}return c}});
define("jk",["require","exports","r","pb","si","wy","Vk"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadTemplateCommandKey=new i.Facet("UploadTemplate").id;t.UploadTemplateCommand={key:t.uploadTemplateCommandKey,automationId:"UploadTemplate",name:s.default.UploadTemplate,action:n.createElement(r.HideWithSelection,null,n.createElement(o.UploadTemplateAction,{engagement:{name:"UploadTemplate"}}))};t.addTemplateCommandKey=new i.Facet("AddTemplate").id;t.AddTemplateCommand={key:t.addTemplateCommandKey,automationId:"AddTemplate",name:s.default.AddTemplate,iconProps:{iconName:"Add"},action:n.createElement(r.HideWithSelection,null,n.createElement(o.UploadTemplateAction,{engagement:{name:"AddTemplate"}}))}});
define("Vk",["require","exports","lC","r","ng","Pp","vp","hs","qr","li","O1","m1","ii","ai","T3","sS","C1","ce"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=g.Killswitch.isActivated("EADE19B8-AD86-4CA2-9B13-E049A2AD37AA","07/28/2020","Use currentItemKey to check permissions"),b=s.injectInitialProps(function(){return{type:"file"}})(i.FileSystemDialog),w=m.connectToItemCache(function(){return{fileSelector:b}})(o.ItemUploadAction);t.UploadTemplateAction=m.createItemCacheComponent(function(e,t){var i=t.engagement,s=u.getCurrentItemKey(e);return s?r.createElement(l.ControlHandlerProvider,{controlHandlers:n.__assign({},c.uploadItemsActionControl.pack(E))},r.createElement(w,{itemKey:s,engagement:a.graft({name:"UploadTemplate",isIntentional:!0},i)})):null});function E(e,t){var r=u.getCurrentItemKey(e),i=e.demandItemFacet(f.spItemKeyFacet,r);if(!i)return{isAvailable:!1};var s=i.listFullUrl;if(!s)return{isAvailable:!1};var o=new v.default(s+"/Forms").path,a=f.spItemKeyFacet.serialize(n.__assign(n.__assign({},i),{rootFolder:""})),l=f.spItemKeyFacet.serialize(n.__assign(n.__assign({},i),{rootFolder:o})),c=y?a:r,p=e.demandItemFacet(h.permissionsFacet,c);return{targetItemKey:l,isAvailable:d.default.hasItemPermission({permissions:p},d.default.manageLists)&&S(e,i)}}function S(e,t){var n=t&&e.demandItemFacet(h.listFacet,f.spListKeyFacet.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}));return!!n&&!!n.isDocumentLibrary&&n.templateType!==p.ListTemplateType.webPageLibrary}});
define("Bk",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editNewMenuKey=new n.Facet("editNewMenu").id});
define("Tk",["require","exports","r","pg","si","ug","A2","Uk","pb","$k","li"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDocumentFromTemplate=function(e){var t=e.template,c=e.listKey;if(!t.url)throw new Error("Cannot create a command for a template without a URL.");var h,p,d=t.url,v=l.spNewDocumentTemplateKeyFacet.serialize({listKey:c,templateUrl:d});return{key:new i.Facet("createDocumentFromTemplate").id,automationId:"createDocumentFromTemplate",name:t.title,action:n.createElement(a.HideWithSelection,null,n.createElement(r.CreateDocumentAction,{documentType:f.getDocumentTypeFromTemplate(d),templateItemKey:v})),iconProps:s.getCommandIconProps({extension:(h=d,p=o.getFileExtension(h,!0),u.getIconNameFromExtension(p)),size:16})}}});
define("$k",["require","exports","lC","r","li","ii","eM","$1","Hm","pg","_g"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getContentTypeCreateDocumentActionItemOperationHandler=a.createSingleItemOperationHandler()(function(e){var t=this,o=e.itemKey,a=i.spContentTypeCreateDocumentActionKeyFacet.deserialize(o);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(l){e(u.resolveItems({items:(t={},t[o]=n.__assign({},s.actionFacet.pack(function(){return r.createElement(f.CreateDocumentAction,{documentType:c(a.templateUrl),templateItemKey:i.spNewDocumentTemplateKeyFacet.serialize({listKey:a.listKey,templateUrl:a.templateUrl})})})),t)}));return[2]})})}});function c(e){var t=l.DocumentType.Word;if(e){var n=e.lastIndexOf(".");if(n){var r=e.substr(n+1).toLowerCase();switch(o.OfficeIconFileTypeMap[r]){case o.onenoteType:t=l.DocumentType.OneNote;break;case o.powerpointType:t=l.DocumentType.PowerPoint;break;case o.excelType:t=l.DocumentType.Excel;break;case o.visioType:t=l.DocumentType.Visio}}}return t}t.getDocumentTypeFromTemplate=c});
define("Ek",["require","exports","ai","sS","_S","SL"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processFileHandlerCommands=function(e,t){var o,u=t.pageContext,a=t.listFacets,f=t.isODB,l=t.key;if(u&&(a&&a.templateType===n.ListTemplateType.documentLibrary||f)){var c=new r.SimpleUri(l.webAbsoluteUrl||l.listFullUrl).authority+"/_api/v2.0",h=i.driveAppsKeyFacet.serialize({endpoint:c});o=s.getFileHandlerCommands(e,{itemKey:h})}return{fileHandlerCommands:o}}});
define("Ak",["require","exports","li","ii","kk","Me","Lk"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processContentTypeCommands=function(e,t){var u,a=t.key,f=t.listKey,l=t.listFacets,c=t.pageContext,h=[],p=n.spItemKeyFacet.serialize(a),d=e.demandItemFacet(r.contentTypeKeysFacet,p);if(d&&d.length){d.forEach(function(t){var n=e.demandItemFacet(r.spFolderContentTypeFacet,t);n&&h.push(n)});if(!i.isCustomContentTypesDisabled(h,l)&&c){var v=new s.ItemUrlHelperBasic({context:{webAbsoluteUrl:a.webAbsoluteUrl,listUrl:a.listFullUrl}}).getUrlParts({path:a.rootFolder});u=o.getContentTypeCommands(h,c,v,function(t){return a&&e.demandItemFacet(r.actionFacet,n.spContentTypeCreateDocumentActionKeyFacet.serialize({listKey:f,templateUrl:t}))},function(t){return a&&e.demandItemFacet(r.actionFacet,n.spContentTypeNavigationActionKeyFacet.serialize({listKey:f,contentTypeId:t}))},l)}}return{contentTypes:h,contentTypeCommands:u}}});
define("kk",["require","exports","we","Mk"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isCustomContentTypesDisabled=r.getIsCustomContentTypesDisabled;t.getContentTypeCommandsCore=function(e,t,r,i,s,o){if(!o)return[];var u=o.openInClient,a=o.newWOPIDocumentEnabled;return e.map(function(e){var o,f=e.templateUrl,l=e.cTypeId,c=f?f.indexOf("CreateNewDocument.aspx?id="):0,h=e.iconUrl;if(h)-1===h.indexOf("/")&&(h="/"+t.layoutsUrl+"/images/"+h);else{o=""===e.templateUrl&&e.docSetUrl?"DocumentSet":"Page"}if(c>0&&!u&&a)return r("NewDOC",e.displayName,h,o,f.substring(c+"CreateNewDocument.aspx?id=".length));if(!f)if(f=e.docSetUrl){var p=new n.default(f),d=s.serverRelativeItemUrl;p.setQueryParameter("RootFolder",d);f=p.toString()}else l&&(f=l);return i("NewCustomType",e,h,o,f,l)})}});
define("Mk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getIsCustomContentTypesDisabled=function(e,t){var n=e&&e.length;if(!n)return!0;var r=e[0],i=r.templateUrl,s=i&&i.indexOf("/Forms/template.do")>-1;return!(1!==n||(i||r.docSetUrl)&&!s)||(!t||!t.contentTypesEnabled)&&(!i||s)}});
define("Lk",["require","exports","kk"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t,n,r,i,o,u){return{key:n+r,name:r,action:t(u),iconProps:s(e,o,i)}}function i(e,t,n,r,i,o,u,a){return{key:n+r.displayName,name:r.displayName,action:t(r.contentTypeId||""),iconProps:s(e,o,i)}}function s(e,t,n){return t?{iconName:t}:{iconName:"CustomIcon",style:{backgroundImage:"url("+(n?e+n:n)+")",width:"16px",height:"16px",backgroundRepeat:"no-repeat"}}}t.getContentTypeCommands=function(e,t,s,o,u,a){return n.getContentTypeCommandsCore(e,t,r.bind(void 0,t.webAbsoluteUrl,o),i.bind(void 0,t.webAbsoluteUrl,u),s,a)}});
define("pM",["require","exports","lC","li","ii","zM","PM","AM","DM","ih","mM","sS","_S","US","MS","SL","g6","ai","ce","YM","Cb","Bb","Jb","r5","Io","P1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C={ODB:1544};t.itemsContextMenuControlerHandler=f.createControlHandler()(function(){return function(e){return function(t,o){var f,p=o.itemKey,d=o.commands,w=t.demandItemFacet(r.spItemKeyFacet,p);if(w){var E=r.spListKeyFacet.serialize(w);f=t.demandItemFacet(i.listFacet,E)}var L=d?n.__spreadArrays(d):[];L.push(u.pinItemCommand,u.editPinnedItemCommand);var A=void 0;if(w){var O=w.listFullUrl,M=w.webAbsoluteUrl,_=a.getMoreCommands({listFacets:f}),D=t.demandItemFacet(i.spPageContextFacet,r.spPageContextKeyFacet.serialize({webAbsoluteUrl:M,listFullUrl:O}));if(f&&!f.isDocumentLibrary){L=[s.viewItemCommand];for(var P=0,H=s.getDefaultListCommands(D);P<H.length;P++){var B=H[P];B.key===S.shareCommand.key&&m.isFeatureEnabled(t,{feature:C,pageContext:D})?L.push(S.addPeopleCommand):B.key!==s.exportListCommand.key&&L.push(B)}}L.push(_);var j=r.contextMenuCustomActionSetKeyFacet.serialize({webAbsoluteUrl:M,listFullUrl:O}),F=l.demandCustomActionSetWithExtensions({itemCache:t,targetCustomActionSetKey:j,keys:{webAbsoluteUrl:M,listFullUrl:O}});L=L.concat(l.getCustomActionSetCommands(t,j));F&&(L=L.concat(l.getCustomActionSetCommands(t,F)));if(D&&f&&(f.templateType===g.ListTemplateType.documentLibrary||f.templateType===g.ListTemplateType.mySiteDocumentLibrary)){var I=new c.SimpleUri(M||O).authority+"/_api/v2.0",q=h.driveAppsKeyFacet.serialize({endpoint:I});A=v.getFileHandlerCommands(t,{itemKey:q})}}var R=!y.Killswitch.isActivated(b.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands");return{commands:k(L,A,f&&f.templateType===g.ListTemplateType.mySiteDocumentLibrary,R),onMenuOpened:function(){e(function(e){var t=(e(T.readConfiguration({spLoggerConfiguration:N.loggerFacet})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e(x.logRUMOneForContextMenu(n))})}}}}});function k(e,t,n,r){for(var i=[],s=0,u=e;s<u.length;s++){var a=u[s],f=a.key;if(f===o.openFileCommand.key){var l=t&&t.open||[];l.length>0&&o.openFileCommandForContextMenu.subMenuProps&&(o.openFileCommandForContextMenu.subMenuProps.items=v.mergeFileHandlerCommands(o.openFileCommandForContextMenu.subMenuProps.items,l,r));i.push(o.openFileCommandForContextMenu)}else{i.push(a);f===w.deleteCommand.key?i.push(d.removeShortcutFromFilesCommand):f===E.downloadCommand.key&&i.push(p.addShortcutFromTeamSiteCommand)}}return t&&t.custom&&t.custom.length>0?v.mergeFileHandlerCommands(i,t.custom):i}t.getOverrideDefaultCommands=k});
define("fM",["require","exports","lC","li","ii","ih","Ro","Xo","ho","$1","u7"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openGroupControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var s=o.getCurrentItemSetKey(e),c=(function e(t,s,o){var u=s,a=o;if(s&&o){var f=t.demandItem({spGroupField:i.spGroupFieldFacet,groupValue:i.groupValueFacet,parentGroupKey:i.parentGroupKeyFacet,groupFilterByValue:i.groupFilterByValueFacet},s),c=f.spGroupField,h=f.groupValue,p=f.parentGroupKey,d=f.groupFilterByValue;p&&(a=e(t,p.itemKey,o));var v=t.demandItemFacet(r.spFolderItemSetKeyFacet,a);if(v){var m=t.demandItemFacet(r.spItemGroupKeyFacet,s),g=l.getFilteredItemSetKey(n.__assign(n.__assign({},v),m?{viewKey:m.viewKey}:{})),y=d||h;void 0!==y&&c&&c.internalName&&c.fieldType&&(u=g({filterField:c.internalName,filterValues:[y],filterType:c.fieldType,useLookupId:!1}))}}return u})(e,t.itemKey,s),h=e.demandItem({parentItem:u.parentItemFacet},s).parentItem,p=(function(e){var t=this,r=e.stageItem,i=e.parentItemKey;return r?a.createAsyncActionCreator(function(e){var s=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(a){switch(a.label){case 0:i&&e(f.resolveItems({items:(t={},t[o]=n.__assign({},u.parentItemFacet.pack({itemKey:i})),t)}));return[4,e(r({currentItemKey:o,itemsScopeItemKey:s}))];case 1:a.sent();return[2]}})})}}):void 0})({parentItemKey:h&&h.itemKey,stageItem:t.stageItem});return c?n.__assign({itemKey:c},p?{stageItem:p}:{}):{}}}})});
define("uM",["require","exports","lC","ih","Xo","do"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new s.ComputedItemFacet("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(i.defaultChildItemSetFacet,n),s=r&&r.itemKey,o=e.demandItemFacet(i.childItemsFacet,s),u=o&&o.itemKeys;if(u&&1===u.length)return{itemKey:u[0]}});t.webOpenActionControlHandler=r.createControlHandler()(function(){var t=this;return function(){return function(r,i){var s=i.itemKey,u=i.stageItem,a=r.demandItemFacet(o,s,{suppressGetItems:!0});return n.__assign({},a?{itemKey:a.itemKey}:{stageItem:function(r){return function(i){return n.__awaiter(t,void 0,void 0,function(){var t,s,a,f,l,c;return n.__generator(this,function(h){switch(h.label){case 0:a=[n.__assign({},r)];return(f=u)?[4,i(u(r))]:[3,2];case 1:f=h.sent();h.label=2;case 2:t=n.__assign.apply(void 0,a.concat([f||{}])).currentItemKey,s=void 0===t?r.currentItemKey:t;return[4,new Promise(function(t,n){e(["YD"],t,n)})];case 3:l=h.sent().demandItems;return[4,i(l(function(e){return e.demandItemFacet(o,s)}))];case 4:return(c=h.sent())?[2,{currentItemKey:c.itemKey}]:[2]}})})}}})}}})});
define("lM",["require","exports","li","G7","p5","n7","ih","Ro","Rs","ii"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsBreadcrumbControlerHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var o=t.createOpenItem,c=t.rootItemKey,h=t.itemKey,p=u.getCurrentItemSetKey(e),d=void 0;if(c){var v=e.demandItemFacet(n.spItemKeyFacet,c);v&&(d=n.spItemKeyFacet.serialize(v))}return{getBreadcrumbItems:function(){var t=[],u={},v=e.demandItemFacet(n.spFolderItemSetKeyFacet,p),m=v&&v.filterParams,g=e.demandItemFacet(f.spFilterableSetFacet,p),y=g&&g.filterList;!g&&m&&(y=r.default.getFilterList(m,void 0,!0));if(y&&y.length&&m)for(var b=y.length-1;b>=0;b--){var w=y[b],E=(w.displays&&w.displays.length?w.displays:w.values).map(function(e){return e||s.default.EmptyFilterOptionLabel}),S=r.default.formatBreadcrumbFilterValues(E,w.type||"",{booleanFalse:s.default.booleanFalse,booleanTrue:s.default.booleanTrue}),x=l(m,y,b+1),T=(N=i.getOverrideItemSetKeyForFolder(e,{folderItemKey:h,currentItemSetKey:p,newFilterParams:x}))?n.spFolderItemSetKeyFacet.serialize(N):h;t.unshift({key:w.fieldName,text:S,onClick:o&&T?o(T):void 0})}for(;h&&!u[h];){u[h]=!0;var N,C=e.demandItem({displayName:a.displayNameFacet,parentFolder:a.parentFolderItemFacet},h),k=C.displayName,L=C.parentFolder;T=(N=i.getOverrideItemSetKeyForFolder(e,{folderItemKey:h,currentItemSetKey:p,newFilterParams:""}))?n.spFolderItemSetKeyFacet.serialize(N):h;t.unshift({key:h,text:k||"",onClick:o&&T?o(T):void 0});if(c&&(c===h||d===h))break;h=L&&L.itemKey||""}return t}}}}});function l(e,t,n){for(var i=n=n||0;i<t.length;i++){var s=t[i];e=r.default.addFilterInfo(e,s.fieldName,"",!0)}return e}t.clearFilterInfo=l});
define("nM",["require","exports","lC","dM","aM","ih"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultDropActionControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var s=t.handlers;return{handlers:n.__spreadArrays([r.uploadToGroupDefaultDropActionHandler,i.moveToGroupDefaultDropActionHandler],s||[])}}}})});
define("dM",["require","exports","r","Jf","gp","rp","si","mp","fp"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=u.dragDropKeyFacet.serialize({}),l=new o.Facet("uploadToGroupDefaultDropActionHandler").id;t.uploadToGroupDefaultDropActionHandler={key:l,evaluate:function(e,t){var s=t.itemKey,o=e.demandItemFacet(u.draggedItemFacet,f),l=o&&o.draggedItem,c=!l||l.type===a.FILE_DRAG_TYPE,h=e.demandItemFacet(r.isGroupFacet,s);return{action:c&&h?n.createElement(i.ItemUploadEntriesAction,{itemKey:s}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&s.isFileDropEvent(e.event)||!1}}}});
define("aM",["require","exports","r","Jf","si","iM","mp","fp"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.dragDropKeyFacet.serialize({}),f=new i.Facet("moveToGroupDefaultDropActionHandler").id;t.moveToGroupDefaultDropActionHandler={key:f,evaluate:function(e,t){var i=t.itemKey,f=e.demandItemFacet(r.isGroupFacet,i),l=e.demandItemFacet(o.draggedItemFacet,a),c=l&&l.draggedItem;return{action:(!c||c.type===u.DOCUMENT_DRAG_TYPE)&&f?n.createElement(s.MoveToGroupAction,{itemKeys:c&&c.itemKeys||[],groupKey:i}):void 0}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer;return n&&n.type===u.DOCUMENT_DRAG_TYPE||!1}return!1}}}});
define("iM",["require","exports","lC","C1","ks","Es","Xo","jr","li","rM"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={isAvailable:!1,onExecute:void 0};t.MoveToGroupAction=r.connectToItemCache(function(e,t){var r=t.itemKeys,i=t.groupKey;if(!(!!e.demandItemFacet(a.spItemGroupKeyFacet,i)&&r&&r.length>0))return l;var c=e.demandItem({childItems:o.childItemsFacet},i).childItems,h=c&&c.itemKeys||[],p=!!e.demandItemFacet(a.spItemGroupKeyFacet,h[0]);if(0===h.length||p)return l;var d=r.filter(function(e){return!h.some(function(t){return t===e})});if(0===d.length)return l;var v=d[0],m=e.dispatch;return n.__assign({isAvailable:!0,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){e={groupKey:i};return[2,m(f.assignItemToGroupWithProgress({items:u.makeObject(r,function(){return e})}))]})})}},s.getItemActionEngagement(e,{itemKey:v,engagement:{name:"Move",isIntentional:!0}}))})(i.Action)});
define("tM",["require","exports","T3","li","ii","ai","ih","Jf"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadItemsToGroupActionControlHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var o=t.itemKey,a=e.demandItem({key:r.spItemGroupKeyFacet,isDropEnabled:u.isDropEnabledFacet},o),f=a.key,l=a.isDropEnabled,c=f&&f.itemSetKey&&r.spItemKeyFacet.serialize(f.itemSetKey),h=c&&e.demandItemFacet(i.permissionsFacet,c),p=n.PermissionMask.hasItemPermission({permissions:h},n.PermissionMask.insertListItems);if(p){var d=f&&f.itemSetKey&&e.demandItemFacet(i.listFacet,r.spListKeyFacet.serialize({webAbsoluteUrl:f.itemSetKey.webAbsoluteUrl,listFullUrl:f.itemSetKey.listFullUrl}));p=!!l&&!!d&&!!d.isDocumentLibrary&&d.templateType!==s.ListTemplateType.webPageLibrary}return{isAvailable:p}}}})});
define("Xk",["require","exports","lC","r","li","ii","Zk","$1","Hm","xo"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getContentTypeNavigationActionItemOperationHandler=a.createSingleItemOperationHandler()(function(e){var t=this,a=e.itemKey,l=i.spContentTypeNavigationActionKeyFacet.deserialize(a);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,h,p;return n.__generator(this,function(d){t=e(f.readItem({listFacets:s.listFacet},i.spListKeyFacet.serialize(l.listKey))).listFacets;c=i.spListContentTypeKeyFacet.serialize({listKey:{webAbsoluteUrl:l.listKey.webAbsoluteUrl,listFullUrl:l.listKey.listFullUrl},contentTypeId:l.contentTypeId});h=!!t&&t.openInClient;e(u.resolveItems({items:(p={},p[a]=n.__assign({},s.actionFacet.pack(function(){return r.createElement(o.ContentTypeNavigationAction,{contentTypeId:l.contentTypeId,openInClient:h,contentTypeKey:c})})),p)}));return[2]})})}})});
define("Zk",["require","exports","lC","r","li","ii","T3","_s","C1","ks","Es","tv","Ps"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=a.connectToItemCache()(c.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["xVe"],t,n)})];case 1:return[2,t.sent().ContentTypeNavigationCreator]}})})})),d=a.createItemCacheComponent(function(e,t){var u,a=t.itemKey,c=e.demandItemFacet(i.spItemKeyFacet,a),d=!1;if(c&&(u=e.demandItemFacet(s.spPageContextFacet,i.spPageContextKeyFacet.serialize({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl})))&&!u.isAnonymousGuestUser){var v=e.demandItemFacet(s.permissionsFacet,a);d=o.PermissionMask.hasItemPermission({permissions:v},o.PermissionMask.insertListItems)}var m=h.renderComponentOnExecute(function(e){return r.createElement(p,n.__assign({},e,t,{pageContext:u}))});return r.createElement(f.Action,n.__assign({isAvailable:d,onExecute:m},l.getItemActionEngagement(e,{itemKey:a,engagement:{name:"ContentTypeNavigation",isIntentional:!0}})))});t.ContentTypeNavigationAction=u.withOnlyCurrentItem()(d)});
define("Wk",["require","exports","lC","xo","ii","li","xv","qk","Hm","Vm"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spPeoplePickerDataSourceGetItemsOperationHandler=a.createSingleItemOperationHandler()(function(e){var t=this,a=s.spPeoplePickerDataSourceKeyFacet.deserialize(e.itemKey),l=a.webAbsoluteUrl,c=a.listFullUrl;return function(a){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,m;return n.__generator(this,function(g){t=a(r.readItem({pageContext:i.spPageContextFacet},s.spPageContextKeyFacet.serialize({webAbsoluteUrl:l,listFullUrl:c}))).pageContext;h=a(o.getDataRequestor({webAbsoluteUrl:l,listFullUrl:c})).hasTokenProvider;if(t){p=h?void 0:function(e){return a(o.getAuthToken({url:e}))};d=new u.PeoplePickerDataSource({},{pageContext:t,getAuthToken:p});(v=new f.ItemResolver).resolveItems({items:(m={},m[e.itemKey]=n.__assign({},i.spPeoplePickerDataSourceFacet.pack(d)),m)});a(v.execute())}return[2]})})}})});
define("Kk",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveTemplatesToViewOperation=new n.Facet("saveTemplatesToView");t.saveTemplatesToView=r.implementOperation({operationTypeFacet:t.saveTemplatesToViewOperation})});
define("Ok",["require","exports","lC","Hm","Rs","xo","$1","ii","li","Gk","wk"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveUploadedTemplateToView=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.childItemKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){c=e(s.readItem({deserializedItemKey:a.spItemKeyFacet,displayName:i.displayNameFacet},r)),h=c.deserializedItemKey,p=c.displayName;if(h&&p){d=e(s.readItem({contentTypeKeys:u.contentTypeKeysFacet},t)).contentTypeKeys;v=[];d&&d.length&&d.forEach(function(t){var n=e(s.readItem({contentType:u.spListContentTypeFacet},t)).contentType;n&&v.push(n)});m=v.length?v[0].contentTypeId:void 0;g=p.replace(/\.[^.]+$/,"");if(!(y={contentTypeId:m,isUpload:!0,templateId:g,title:g,url:h.itemId,visible:!0}).url)throw new Error("No template URL to save.");if((b=e(s.readItem({defaultView:u.defaultViewFacet},t)).defaultView)&&b.viewKey){w=b.viewKey;E=e(s.readItem({existingTemplates:u.newDocumentTemplatesFacet},t)).existingTemplates,S=void 0===E?[]:E;(x=n.__spreadArrays(S)).length||(T=e(s.readItem({newCommands:l.newDocumentTemplateCommandsFacet},t)).newCommands)&&T.forEach(function(e){var t=e.contentTypeId,n=e.isContentType,r=e.templateId,i=e.title,s=e.visible;x.push({contentTypeId:t,isContentType:n,templateId:r,title:i,visible:s})});x.filter(function(e){return e.url===y.url}).length>0||x.push(n.__assign({},y));N=a.spListKeyFacet.deserialize(t);C=a.spNewDocumentTemplateKeyFacet.serialize({templateUrl:y.url,listKey:N});e(o.resolveItems({items:(k={},k[t]=n.__assign({},u.newDocumentTemplatesFacet.pack(x)),k[C]=n.__assign({},u.newDocumentTemplateFacet.pack(y)),k)}));return[2,e(f.saveViewCore({items:(L={},L[a.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl})]={views:(A={},A[w]={newDocumentTemplatesJsonString:JSON.stringify(x)},A),qosName:"saveNewTemplatesToDefaultView"},L)}))]}}return[2]})})}})});
define("wk",["require","exports","lC","do","Pk","cg","li","Xy","QS","ii","ai","Ak","Ek"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.newDocumentTemplateCommandsFacet=new r.ComputedItemFacet("newCommands",function(e,t){var r=t.itemKey,p=e.demandItemFacet(o.spListKeyFacet,r);if(p){var d=o.spItemKeyFacet.serialize(n.__assign(n.__assign({},p),{rootFolder:""})),v=e.demandItemFacet(o.spItemKeyFacet,d);if(v){var m=u.getPageContextFromItemCache(e,d),g=e.demandItemFacet(f.listFacet,r);if(m&&g){var y=g.templateType===l.ListTemplateType.mySiteDocumentLibrary,b=e.demandItemFacet(f.newDocumentTemplatesFacet,r),w=a.getIsAvailable(e,d,v),E=c.processContentTypeCommands(e,{key:v,listFacets:g,listKey:p,pageContext:m}),S=E.contentTypes,x=E.contentTypeCommands,T=h.processFileHandlerCommands(e,{isODB:y,key:v,listFacets:g,pageContext:m}).fileHandlerCommands,N=s.newCommand;return i.getNewCommand(e,{contentTypes:S,newCommandMenu:N,fileHandlerCommands:T,isCreateFolderAvailable:w,newDocumentTemplates:b,contentTypeCommands:x,listKey:p}).allCommands}}}})});
define("r6",["require","exports","lC","ih","Hm","d6","c6","li","o6"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveAddon=i.createAddon(function(){return function(t){t(r.registerControlHandler(u.spItemKeyFacet,s.removeFromOneDriveActionControl)(a.removeFromOneDriveActionControlHandler));t(i.registerOperationHandler(u.spItemKeyFacet,o.removeFromOneDriveOperation)(i.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["pH"],t,n)})];case 1:return[2,t.sent().removeFromOneDriveOperationHandler]}})})})))}})});
define("c6",["require","exports","si","jm","ko"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveOperation=new n.Facet("removeFromOneDrive");t.removeFromOneDriveProgressKeyFacet=new r.ProgressKeyFacet("removeFromOneDrive");t.removeFromOneDrive=i.implementOperation({operationTypeFacet:t.removeFromOneDriveOperation})});
define("o6",["require","exports","ih","ii","s6"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,s=e.demandItemFacet(r.mountPointFacet,n,{suppressGetItems:!0}),o=e.demandItemFacet(i.localItemFacet,n);return{isAvailable:!!s||!!o}}}})});
define("Ck",["require","exports","lC","Hm","$1","ii"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveTemplatesToView=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.templates;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var o;return n.__generator(this,function(u){e(i.resolveItems({items:(o={},o[t]=n.__assign({},s.newDocumentTemplatesFacet.pack(r)),o)}));return[2]})})}})});
define("yk",["require","exports","ih","ii","Sk","g6","f4","A1"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spFolderItemSetTilesListControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemSetKey;return n&&s.isFeatureEnabled(e,{feature:{ODB:1294}})?i.getCustomFormatterItemTileOverrides(e,n):u.getConfiguration(e,{enableMediaTilesInDocumentGroup:r.enableMediaTilesInDocumentGroupConfigurationFacet}).enableMediaTilesInDocumentGroup?{tileControlHandler:o.mediaTileControlHandler}:{}}}})});
define("Sk",["require","exports","lC","r","n5","C1","ii","Z9","f7","xk","g6","r","O1","bI","do","Ik","Z9","Xo","li","u4","ai","SPListItemsScopeDeferred_IS_mini_css","Un","F5","us","v4","Uc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";E=E.CustomFormatterItemTile_6;Object.defineProperty(t,"__esModule",{value:!0});function k(e,t){return{enableItemHoverCard:!1}}var L=s.connectToItemCache(function(e,t){var n=O(e,t.itemSetKey),r=n.viewFormatter,i=n.isGenerated,s=n.isTileDesignerTemplateApplied;return{customFormatterFeature:r&&e.demandItemFacet(u.customTileFormatterFeatureFacet,u.customFormatterFeatureKeyFacet.serialize({})),viewFormatter:r,isGenerated:i,isTileDesignerTemplateApplied:s,dispatch:e.dispatch,isDefaultCardEnabled:l.isFeatureEnabled(e,{feature:{ODB:1615}}),cardDesignerFeatureEnabled:b.cardDesignerFeatureFlightEnabled(e)}})(function(e){c.useEffect(function(){if(y&&y.isTileFormatterAvailable()&&0===A){x||N.isTileDesignerTemplateApplied?e.dispatch(a.logEngagement({name:"GalleryViewRender",isIntentional:!0})):e.dispatch(a.logEngagement({name:"CustomFormatterTileLoad",isIntentional:!0}));y.hasFormatterReferences()&&e.dispatch(a.logEngagement({name:"FormatterReferenceTile",isIntentional:!0}))}},[]);var t=r.useState(!1),i=t[0],s=t[1],o=r.useState([]),u=o[0],f=o[1],l=r.useState(-1),d=l[0],v=l[1],m=e.defaultRender,g=e.customFormatterFeature,y=e.viewFormatter,b=e.isDefaultCardEnabled,w=e.cardDesignerFeatureEnabled,x=e.isGenerated,N=n.__rest(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","cardDesignerFeatureEnabled","isGenerated"]);if(!m)return null;var L=g&&g.tileRenderer,A=N.selectionIndex,O=N.itemKey,M=N.itemSetKey,_=void 0===M?"":M;if(y&&y.isTileFormatterAvailable()&&L){var D=y.shouldHideSelectionInTiles(),P=y.getTileFormatter(),H=r.createElement(m,n.__assign({},N,w?{href:void 0,invokeSelection:!1}:{},{className:S.css(N.className,E.customTile),itemName:null,itemActivity:null,foreground:null,isSelectable:!D,selection:D?void 0:N.selection,selectionIndex:D?-1:N.selectionIndex,background:r.createElement(C.FocusZone,{handleTabKey:C.FocusZoneTabbableElements.all,direction:C.FocusZoneDirection.domOrder,tabIndex:i?0:-1,onKeyDown:function(e){if(e.which===T.KeyCodes.tab){var t=d+1;if(t<u.length&&u[t]){u[t].focus();v(t);e.stopPropagation();e.preventDefault()}}else v(-1)},className:E.customTileFocusZone},r.createElement(L,{rowIndex:A,itemKey:O,itemSetKey:_,formatter:P})),onFocus:function(e){s(!0);var t=e.currentTarget.querySelectorAll(".sp-card-keyboard-focusable");f(t)},onBlur:function(e){s(!1);f([]);v(-1)}}));return b&&P?r.createElement(h.ControlHandlerProvider,{controlHandlers:p.itemTileControl.pack(k)},H):H}return r.createElement(m,n.__assign({},N))}),A=new d.ComputedItemFacet("generatedViewFormatter",function(e,t){var n=t.itemKey;if(e.isItemFacetResolved(o.listSchemaFacet,n)&&n){var r=f.getKeyForViewFormatter(e,{itemSetKey:n}),s=e.demandItemFacet(m.customTileFormatterFeatureFacet,m.customFormatterFeatureKeyFacet.serialize({})),u=e.demandItemFacet(y.spFolderItemSetKeyFacet,n);if(u&&r&&s){var a=e.demandItemFacet(o.listFacet,y.spListKeyFacet.serialize(u)),c=v.readItemSetSchemaFromItemCache(e,{mapping:{fieldData:o.fieldDataFacet},itemSetKey:n}),h=l.isFeatureEnabled(e,{feature:{ODB:522}}),p=l.isFeatureEnabled(e,{feature:{ODB:1822}}),d=c.map(function(e){return e.fieldData}),b={};if(p){var E=e.demandItem({schema:g.schemaFacet},n).schema,S=E&&E.columnKeys;S&&(b=N.getFieldFormatters(e,S))}var x=a&&a.templateType||w.default.invalidType,T=d&&d.length>0&&x===w.default.genericList,C=i.getViewFormatterFacetObjFromString({formatter:void 0,fields:b,generatedTileProps:T?s.tileDesigner.createDefaultTileProps(d,h):void 0,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:p}});if(C)return C.viewFormatter}}});function O(e,t){var n=!1;if(!t)return{viewFormatter:void 0,isGenerated:n,isTileDesignerTemplateApplied:!1};var r=e.demandItemFacet(o.viewFormatterFacet,f.getKeyForViewFormatter(e,{itemSetKey:t})),i=r&&r.viewFormatter,s=i&&i.getTileProps(),u=Boolean(i&&i.isTileDesignerTemplateApplied());u&&(i=e.demandItemFacet(M,t));if(!(s&&s.formatter&&s.formatter)&&b.cardDesignerFeatureFlightEnabled(e)){i=e.demandItemFacet(A,t);n=!0}return{viewFormatter:i,isGenerated:n,isTileDesignerTemplateApplied:u}}var M=new d.ComputedItemFacet("postColumnDeleteViewFormatterFacet",function(e,t){var n=t.itemKey,r=e.demandItemFacet(o.viewFormatterFacet,f.getKeyForViewFormatter(e,{itemSetKey:n})),s=r&&r.viewFormatter;if(n){for(var u=v.readItemSetSchemaFromItemCache(e,{mapping:{fieldData:o.fieldDataFacet},itemSetKey:n}),a=[],l={},c=0;c<u.length;c++){var h=u[c],p=h.fieldData?h.fieldData.StaticName:"";if(p){a.push(h.fieldData);l[p]=h.fieldData}}var d=s&&s.getTileFormatterDesignerConfig(),g=e.demandItemFacet(m.customTileFormatterFeatureFacet,m.customFormatterFeatureKeyFacet.serialize({})),b=e.demandItemFacet(y.spFolderItemSetKeyFacet,n),E=b&&e.demandItemFacet(o.listFacet,y.spListKeyFacet.serialize(b)),S=E&&E.templateType||w.default.invalidType;if(g){var x=g.tileDesigner,T=x.encodeTileDesignerConfig,N=x.decodeTileDesignerConfig,C=x.createJSONFromConfig,k=x.shouldExcludeColumnInCards,L=x.encodeTileDesignerConfigForDocLib,A=d&&N(d),O=[];if(A){var M=!1;for(c=0;c<A.columns.length;c++){k(l[A.columns[c].id])?M=!0:O.push(A.columns[c])}A.columns=O;var _=S===w.default.documentLibrary?L(A):T(A);if(M){var D=C(a,_,!1,S),P=i.getViewFormatterFacetObjFromString({formatter:JSON.stringify({tileProps:D})});return P&&P.viewFormatter}}}}return s});t.getCustomFormatterItemTileOverrides=function(e,t){var n=O(e,t).viewFormatter;if(!(n&&n.isTileFormatterAvailable()))return{};var r=(function(e){var t=254,n=340,r=e&&e.getTileProps(),i=r&&r.width&&r.width>=0?r.width:t;return{height:r&&r.height&&r.height>=0?r.height:n,width:i,disableMarqueeSelection:r&&r.hideSelection}})(n),i=r.height,s=r.width,o=r.disableMarqueeSelection,u=x.isCustomGroupHeaderFormatterFlightEnabled(e)?x.getCustomGroupHeader(t,"TILES"):void 0,a=n&&n.fillCardsHorizontally()?3:1;return{tileRenderer:L,grid:{minRowHeight:i,mode:a},disableMarqueeSelection:o,tileControlHandler:function(){return{desiredSize:{width:s,height:i}}},groupControlHandler:function(){return{headerRenderer:u,maxItemCount:30}}}}});
define("xk",["require","exports","li"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getKeyForViewFormatter=function(e,t){var r=t.itemSetKey,i=e.demandItemFacet(n.spFolderItemSetKeyFacet,r);return i&&i.viewKey&&n.spViewKeyFacet.serialize(i.viewKey)}});
define("bI",["require","exports","Dr","ec"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemTileFolderCoverControl=new n.ControlFacet("itemTileFolderCoverControl",{folderCoverAs:r.defaultRenderComponentOption()});t.itemTileControl=new n.ControlFacet("itemTileControl",{tileAs:r.defaultRenderComponentOption(),folderCoverControlHandler:n.childControlOption(t.itemTileFolderCoverControl)})});
define("qL",["require","exports","lC","ih","Xy","So","M8","QL","oc","sS","KA","ii","A1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharingCalloutControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemKey,p=h.getConfiguration(e,{graphTokenProvider:l.graphTokenProviderConfigurationFacet,spRestTokenProvider:c.spRestTokenProviderConfigurationFacet}),d=p.graphTokenProvider,v=p.spRestTokenProvider,m=i.getPageContextFromItemCache(e,r),g=m&&(m.env2||m.env);return{initializeShareFrame:function(e){var t=e.parentElement,r=e.calloutProps,i=e.sharingInformation,l=e.onError,c=r.defaultRecipients,h=r.itemName,p=r.locale,m=r.mode,y=r.openManageAccess,b=r.theme,w=r.getClientId,E=i.authToken,S=i.isListSharing,x=i.listId,T=i.serverRelativeItemUrl,N=i.shareItemKey,C=i.webAbsoluteUrl,k={authToken:E||"",clientId:w(),defaultRecipients:c,itemName:h,mode:Number(m),theme:b||a.getTheme(),webAbsoluteUrl:C||""},L={};if(N&&o.shareItemByUniqueIdKeyFacet.matches(N)){var A=o.shareItemByUniqueIdKeyFacet.deserialize(N);L={listId:A.listId,uniqueId:A.uniqueId,webAbsoluteUrl:A.webAbsoluteUrl}}else{L={isListSharing:S,itemUrl:""+new f.default(C).authority+T,listId:x}}new u.SharePrefetch({element:t,environment:g||s.Environment.prod,locale:p,context:n.__assign(n.__assign({},k),L),options:{onError:l,openManageAccess:y,graphTokenProvider:d,spRestTokenProvider:v}}).initializeUI()}}}}})});
define("QL",["require","exports","lC","vk","QA","Fe","th","ak","ek","$L","YL","B","X","Mv","JA","A"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(){function e(e){this._iframe=document.createElement("iframe");this._form=document.createElement("form");this._formInput=document.createElement("input");this._signal=new o.default;this._context=e.context;this._iframeWidth=0;this._iframeHeight=0;this._timeoutId=-1;this._isShareReady=!1;this._iframeUrl="";this._iframeBaseUrl="";this._messagesReceived={};this._props=e;this._receiveMessageBound=this._receiveMessage.bind(this);this._elementWindow=this._props.elementWindow||window;this._manager=c.createManager();this._sessionQos=new(v.Qos.withManager(this._manager))({name:"SharingSession."+u.Mode[e.context.mode||u.Mode.share]});if(!this._context.authToken)throw new Error("An access token is required for SharePrefetch optimization");new l.WebSharedAriaTelemetryHandler({clientName:this._context.clientId,userAuthToken:this._context.authToken}).attach(this._manager);switch(e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com";this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}var t=this._props.isConsumer;if(!this._iframeUrl){var n=t?"&consumer=true":"";this._iframeUrl=this._iframeBaseUrl+"/share?smkt="+e.locale+n}this._iframeStartTime=new Date;this._initializeIframe();e.element.appendChild(this._iframe);if(t){this._initializeForm();e.element.appendChild(this._form)}}e.prototype.initializeUI=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,o,a,f,l=this;return n.__generator(this,function(c){e=this._context&&this._context.correlationId;t=this._props.isConsumer;r=this._context.mode===u.Mode.copy&&"teams"===this._context.clientId&&!this._context.shareId;i=r?this._getDefaultLink():Promise.resolve(void 0);o=t?Promise.resolve(void 0):this._getSharingInformation();a=t?Promise.resolve(void 0):this._signal.getPromise();this._isShareReady=!1;Promise.all([this._toTuple(i),this._toTuple(o),this._toTuple(a)]).then(function(r){var i=r[0],o=r[1];r[2];try{var u=!1;if(!t){var a=l._props.options.onError;if(l._isError(i)){u=!0;a&&a({name:"SharePrefetchError",message:"",error:i.error,resultCode:s.default.isCanceled(i.error)?"Canceled":d.getResultCodeFromError(i.error)})}if(l._isError(o)){u=!0;var f=o.error,c={code:f.code,status:f.status};a&&a({name:"SharePrefetchError",message:"",error:f,resultCode:s.default.isCanceled(o.error)?"Canceled":"["+c.status.toString()+"] "+(c.code||"Unknown")})}}var h=l._iframe.contentWindow;if(h&&!t){var p=l._props.options.spRestTokenProvider,m=n.__assign(n.__assign({},l._context),{rawInvite:i.value,sharingInformation:o.value,hasTokenProvider:!!p&&!!p.getAuthToken});h.postMessage(m,l._iframeUrl)}else if(t){l._formInput.value=JSON.stringify(l._context);l._form.submit()}else u||l._sessionQos.end({resultType:v.ResultTypeEnum.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:l._elementWindow.document.body.contains(l._iframe),messagesReceived:Object.keys(l._messagesReceived).join(","),mode:l._context.mode,correlationId:e}})}catch(t){l._sessionQos.end({resultType:v.ResultTypeEnum.Failure,extraData:{unhandledError:t.toString(),correlationId:e}})}});this._props.disableIframeDomainCheck||setTimeout(function(){if(!l._scriptsLoadedTime){var t=new Image;t.onerror=function(){var t="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),n=l._props.options&&l._props.options.onError;n&&n({name:"SharePrefetchError",message:t,error:new Error(t),debugErrorMessage:"Unable to reach "+l._iframeBaseUrl+" domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges",resultCode:t});l._sessionQos.end({resultType:v.ResultTypeEnum.ExpectedFailure,resultCode:t,extraData:{mode:l._context.mode,iframeBaseUrl:l._iframeBaseUrl,correlationId:e}});clearTimeout(l._timeoutId)};t.src=l._iframeUrl+"/favicon.ico?"+Math.random()}},8e3);f=this._props.timeout||45e3;this._timeoutId=setTimeout(function(){return n.__awaiter(l,void 0,void 0,function(){var t,r,s,u,a,l,c,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:r=!1;n.label=1;case 1:n.trys.push([1,3,,4]);return[4,o];case 2:s=n.sent();r=!!s;return[3,4];case 3:u=n.sent();t=u;return[3,4];case 4:l=!1;n.label=5;case 5:n.trys.push([5,7,,8]);return[4,i];case 6:c=n.sent();l=!(!c||!c);return[3,8];case 7:h=n.sent();a=h;return[3,8];case 8:p={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:r,getSharingError:t,inviteHasData:l,inviteError:a,timeout:f,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:e};this._showShareUX();(d=this._props.options&&this._props.options.onTimeout)&&d();this._sessionQos.end({resultType:v.ResultTypeEnum.Failure,resultCode:"timeout",extraData:p});return[2]}})})},f);return[2]})})};e.prototype.dispose=function(){var e=this._context&&this._context.correlationId;clearTimeout(this._timeoutId);this._messagesReceived.sharePrefetch_dispose=!0;this._elementWindow.removeEventListener("message",this._receiveMessageBound);this._props.element.removeChild(this._iframe);this._sessionQos.end({resultType:v.ResultTypeEnum.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:e,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})};e.prototype._getDefaultLink=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,o,u=this;return n.__generator(this,function(n){switch(n.label){case 0:e=new i.default({},{urlDataSource:{getApiBaseUrl:function(){return u._context.webAbsoluteUrl+"/_api/v2.0"}},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:function(){return s.default.resolve({accessToken:u._context.authToken})}},apiEvent:h.Api.withManager(this._manager)});t=new r.default({},{dataRequestor:e});o=[];this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(o=this._context.defaultRecipients.map(function(e){return{email:e}}));return[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",o,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",o,!this._props.disableUseMultiPart)];case 1:return[2,{value:n.sent()}]}})})};e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._props.options.spRestTokenProvider,r=this._manager,i=new a.SharingDataSource({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:(function(i){n.__extends(s,i);function s(n){return i.call(this,n,{pageContext:e,apiEvent:h.Api.withManager(r),tokenProvider:t})||this}return s})(p.DataRequestor),tokenProvider:t}),s=new f.SharingProvider({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:i}),o=this._context.mode===u.Mode.copy||this._context.mode===u.Mode.linkSettings;return s.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o,!0)};e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._receiveMessageBound,!1);this._iframe.name="shareFrame";this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()};this._iframe.src=this._iframeUrl;this._iframe.style.width="0px";this._iframe.style.height="0px";this._iframe.style.visibility="hidden";var t=this._props.styles;t&&t.border?this._iframe.style.border=t.border:this._iframe.style.border="0";if(t){t.margin&&(this._iframe.style.margin=t.margin);t.minWidth&&(this._iframe.style.minWidth=t.minWidth);t.minHeight&&(this._iframe.style.minHeight=t.minHeight)}};e.prototype._initializeForm=function(){this._form.target="shareFrame";this._form.method="POST";this._form.action=this._iframeUrl;this._form.style.display="none";this._formInput.type="text";this._formInput.name="context";this._form.appendChild(this._formInput);var e=document.createElement("input");e.type="submit";this._form.appendChild(e)};e.prototype._showShareUX=function(){this._isShareReady=!0;this._iframe.style.visibility="visible";this._iframe.style.height=(this._iframeHeight||400)+"px";this._iframe.style.width=(this._iframeWidth||320)+"px";clearTimeout(this._timeoutId)};e.prototype._receiveMessage=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,o,u,a,f,l,c,h,p,d,m,g,y,b,w,E;return n.__generator(this,function(n){switch(n.label){case 0:t=this._context&&this._context.correlationId;try{r=e&&e.data&&JSON.parse(e.data)}catch(e){return[2]}try{if(!this._elementWindow.document.body.contains(this._props.element)){this._messagesReceived.sharePrefetch_selfDispose=!0;this.dispose();return[2]}}catch(e){}i=r.name;this._messagesReceived[i||""]=!0;switch(i){case"share_scriptsLoaded":return[3,1];case"share_resize":return[3,2];case"share_started":return[3,3];case"share_ready":return[3,4];case"share_error":return[3,5];case"share_completed":return[3,6];case"share_dismiss":return[3,7];case"share_manageAccessClicked":return[3,8];case"share_linkSettingsCompleted":return[3,9];case"share_grantAccessCompleted":return[3,10];case"share_getToken":return[3,11]}return[3,18];case 1:this._scriptsLoadedTime=new Date;this._signal.complete();return[3,18];case 2:(s=this._props.options&&this._props.options.onResize)&&r.width&&r.height&&s(r.width,r.height);this._iframeWidth=r.width||320;this._iframeHeight=r.height||400;if(this._isShareReady){this._iframe.style.height=this._iframeHeight+"px";this._iframe.style.width=this._iframeWidth+"px"}return[3,18];case 3:(o=this._props.options&&this._props.options.onStarted)&&o();return[3,18];case 4:this._showShareUX();u={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:t};this._sessionQos.end({resultType:v.ResultTypeEnum.Success,extraData:u});(a=this._props.options&&this._props.options.onReady)&&a();return[3,18];case 5:this._showShareUX();f=this._props.options&&this._props.options.onError;l=JSON.parse(r.debugErrorMessage||"{}");c=l.code||l.status||"ShareError: ["+r.error+"]";this._sessionQos.end({resultType:v.ResultTypeEnum.Failure,resultCode:c,extraData:{correlationId:t}});f&&f({name:"SharePrefetchError",message:r.errorMessage||"",error:r.error,debugErrorMessage:r.debugErrorMessage,errorMessage:r.errorMessage,resultCode:c});return[3,18];case 6:(h=this._props.options&&this._props.options.onCompleted)&&h({scope:r.scope||""});return[3,18];case 7:(p=this._props.options&&this._props.options.onDismiss)&&p();return[3,18];case 8:(d=this._props.options&&this._props.options.openManageAccess)&&d();return[3,18];case 9:(m=this._props.options&&this._props.options.onLinkSettingsComplete)&&m(r);return[3,18];case 10:g=this._props.options&&this._props.options.onGrantAccessComplete;r.successful&&g&&g();return[3,18];case 11:y=new v.Qos({name:"SharingSession.GetToken"});if(!(b=this._iframe.contentWindow)){y.end({resultType:v.ResultTypeEnum.Failure,error:"no_window"});return[3,18]}if(!this._props.options.spRestTokenProvider||!this._props.options.spRestTokenProvider.getAuthToken)return[3,16];n.label=12;case 12:n.trys.push([12,14,,15]);return[4,this._props.options.spRestTokenProvider.getAuthToken(r)];case 13:if(w=n.sent()){b.postMessage(JSON.stringify({name:"share_newToken",token:w}),this._iframeUrl);y.end({resultType:v.ResultTypeEnum.Success})}else{b.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),this._iframeUrl);y.end({resultType:v.ResultTypeEnum.Failure,error:"no_token"})}return[3,15];case 14:E=n.sent();b.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:E}),this._iframeUrl);y.end({resultType:v.ResultTypeEnum.Failure,error:String(E)});return[3,15];case 15:return[3,17];case 16:b.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl);y.end({resultType:v.ResultTypeEnum.Failure,error:"no_handler"});n.label=17;case 17:return[3,18];case 18:return[2]}})})};e.prototype._getParentListId=function(e){return""};e.prototype._toTuple=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);t={};return[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})};e.prototype._isError=function(e){return!!e.error};return e})();t.SharePrefetch=m});
define("vk",["require","exports","Fe","ce","be"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},o=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.createBundle=function(e,t){var n=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});n=n.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}';return this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:n,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})};e.prototype.getFamily=function(){var e={};i.default.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only");return this._dataRequestor.send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:s}).then(function(e){return e})};e.prototype.getFamilyMembers=function(){var e={};i.default.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only");return this._dataRequestor.send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:s}).then(function(e){return e})};e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})};e.prototype.createLink=function(e){var t=this,n=e.itemIds,r=e.type,i=e.scope,s=e.preventDownload,o=e.password,u=e.expiration,a=e.bundleName;return 1===n.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(n[0]),type:r,scope:i,preventDownload:s,password:o,expiration:u}):this.createBundle(n,a).then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:r,scope:i,preventDownload:s,password:o,expiration:u})})};e.prototype.createLinkFromItemUrl=function(e){var t=e.itemUrl,n=e.type,r=e.scope,i=e.preventDownload,s=e.password,o=e.expiration;return this.createLinkSingleItem({itemUrl:this.getSharesPathFromItemUrl(t),type:n,scope:r,preventDownload:i,password:s,expiration:o})};e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.id})};e.prototype.getItemInfo=function(e){var t=""+this.getDrivesPathFromItemId(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})};e.prototype.getItemInfoFromItemUrl=function(e){var t=""+this.getSharesPathFromItemUrl(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})};e.prototype.getPermissions=function(e){var t=this.getDrivesPathFromItemId(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})};e.prototype.getPermissionsFromItemUrl=function(e){var t=this.getSharesPathFromItemUrl(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})};e.prototype.invite=function(e){var t=this,n=e.itemIds,r=e.recipients,i=e.message,s=e.requireSignIn,o=e.sendInvitation,u=e.roles,a=e.password,f=e.expiration,l=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),r,i,s,o,u,a,f):this.createBundle(n,l).then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),r,i,s,o,u,a,f)})};e.prototype.inviteFromItemUrl=function(e){var t=e.itemUrl,n=e.recipients,r=e.message,i=e.requireSignIn,s=e.sendInvitation,o=e.roles,u=e.password,a=e.expiration;return this.inviteSingleItem(this.getSharesPathFromItemUrl(t),n,r,i,s,o,u,a)};e.prototype.getDefaultLink=function(e,t,i){var s={prefer:"getDefaultLink"};r.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(s.prefer+=",ReturnSpecificErrorCode");return t.length>0?this.inviteSingleItem(this.getSharesPathFromItemUrl(e),t,"",!0,!1,[],"",void 0,s,i):this.createLinkSingleItem({itemUrl:this.getSharesPathFromItemUrl(e),useMultiPart:i}).then(function(e){return n.default.wrap([e])})};e.prototype.getDefaultLinkByUniqueId=function(e,t,i){var s={prefer:"getDefaultLink"};r.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(s.prefer+=",ReturnSpecificErrorCode");return t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,s,i):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:i}).then(function(e){return n.default.wrap([e])})};e.prototype.updatePermissions=function(e,t,n){var r=this.getDrivesPathFromItemId(e)+"/permissions/"+t,i={roles:[n]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(i),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})};e.prototype.updatePermissionsFromItemUrl=function(e,t,n){var r=this.getSharesPathFromItemUrl(e)+"/permissions/"+t,i={roles:[n]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(i),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})};e.prototype.unshareLink=function(e,t){var n=this.getDrivesPathFromItemId(e)+"/permissions/"+t;return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(){return!0})};e.prototype.unshareLinkFromItemUrl=function(e,t){var n=this.getSharesPathFromItemUrl(e)+"/permissions/"+t;return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(){return!0})};e.prototype.createLinkSingleItem=function(e){var t=e.type,n=e.itemUrl,r=e.scope,i=e.preventDownload,o=e.password,u=e.useMultiPart,a=e.expiration,f=n+"/createLink",l=t&&r?{type:t,scope:r,preventDownload:i}:void 0;(o||""===o)&&(l.password=o);a&&(l.expirationDateTime=a);return this._dataRequestor.send({path:f,apiName:"createLink",requestType:"POST",useMultiPart:u,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{}),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})};e.prototype.getSharesPathFromItemUrl=function(e){return"/shares/u!"+btoa(unescape(encodeURIComponent(e))).replace(/=+$/,"").replace("/","_").replace("+","-")+"/driveItem"};e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/"+e+"/driveItem"};e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/"+t[0]+"/items/"+e:"/drive/items/"+e};e.prototype.inviteSingleItem=function(e,t,n,r,i,o,u,a,f,l){var c=e+"/invite",h={recipients:t,message:n,requireSignIn:r,sendInvitation:i,roles:o};u&&(h.password=u);a&&(h.expirationDateTime=a);return this._dataRequestor.send({path:c,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(h),useMultiPart:l,headers:f,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})};return e})();t.default=o});
define("YL",["require","exports","lC","JL","NI"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}return t})(i.fromWebPlatform()(r.SharedAriaTelemetryHandler));t.WebSharedAriaTelemetryHandler=s});
define("JL",["require","exports","lC","K8","ZL","BI","XL"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}return t})(i.fromUserAuthToken()(s.forSharedControls()(o.withAriaLoader()(r.AriaTelemetryHandler))));t.SharedAriaTelemetryHandler=u});
define("ZL",["require","exports","lC"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fromUserAuthToken=function(){return function(e){return(function(e){n.__extends(t,e);function t(t){var r=t.context,i=void 0===r?{}:r,s=t.userAuthToken,o=t.userId,u=(t.context,n.__rest(t,["userAuthToken","userId","context"])),a=s&&(function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}})(s),f=a&&a.puid?"Business":"Unknown",l=a&&a.app_displayname||"Unknown",c=a&&a.appid||"Unknown",h=(function(e,t,n){return e?"Unknown"===n?"":e:"Business"===n&&t&&t.puid||""})(o,a,f),p=h?1:0,d=a&&a.tid||"Unknown";return e.call(this,n.__assign({context:n.__assign({AccountType:f,AppName:l,AppId:c,IsAuthenticated:p,SiteSubscriptionId:d,UserId:h},i)},u))||this}return t})(e)}}});
define("XL",["require","exports","lC"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withAriaLoader=function(){return function(t){return(function(t){n.__extends(r,t);function r(r){var i=this,s=r.context,o=void 0===s?{}:s,u=r.ariaLoader,a=void 0===u?function(){return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["OO"],t,n)})];case 1:return[2,t.sent().aria]}})})}:u,f=(r.context,n.__rest(r,["ariaLoader","context"]));return i=t.call(this,n.__assign({ariaLoader:a,context:n.__assign({},o)},f))||this}return r})(t)}}});
define("WL",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hoverCardLifeCycleStatusControl=new n.ControlFacet("hoverCardLifeCycleStatusControl")});
define("GL",["require","exports","ih","Rs","we","r","KL","ii","xv","li"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hoverCardCommandsControlHandler=n.createControlHandler()(function(){return function(e){return function(t,n){var l=n.itemKey,c=t.demandItemFacet(f.spItemKeyFacet,l),h=c&&f.spPageContextKeyFacet.serialize(c),p=t.demandItemFacet(u.spPageContextFacet,h),d=t.demandItemFacet(u.uniqueIdFacet,l),v=t.demandItemFacet(r.canonicalUrlFacet,l),m=c&&c.listFullUrl,g=c&&c.webAbsoluteUrl,y=t.demandItemFacet(r.fileNameFacet,l);return{checkInAction:s.createElement(o.CheckOutItemAction,{checkInOutType:"checkIn"}),undoCheckOutAction:s.createElement(o.CheckOutItemAction,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(a.getDataRequestor({webAbsoluteUrl:g||"",listFullUrl:m})).dataRequestor,s={ListId:p&&p.listId,ListItemUniqueId:d,Operation:"RecommendationActedOn",AffectedResourceUrl:v,ItemType:"File",json:JSON.stringify({FileName:y&&y.name,Scenario:"RecommendedActions",SourceRelativeUrl:m,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:p&&p.webId,SiteId:p&&p.siteId,SiteUrl:p&&p.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:y&&y.name,SourceFileExtension:y&&y.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},o=new i.default(g+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:o.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(s),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}})});
define("TL",["require","exports","lC","r","li","ih","a1","ai","Ps","FL","ii","DS","UL","ce","yS"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spHoverCardLifeCycleStatusControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var s=t.signalData,v=t.itemKey;if(s&&v&&s.key===c.needsPublishingSignal.key){var m=e.demandItemFacet(l.needsPublishingFacet,v),g=e.demandItemFacet(i.spItemKeyFacet,v),y=g&&i.spPageContextKeyFacet.serialize(g),b=e.demandItemFacet(l.spPageContextFacet,y);if(!m||!b||b.listBaseTemplate!==u.default.webPageLibrary)return{};if(1===o.getVariantAndLogExposure(90021,b)){var w=e.demandItemFacet(l.uiVersionFacet,v),E=e.demandItemFacet(l.moderationStatusTypeFacet,v),S=d.isPublishStartDateInFuture(e,v),x=b&&p.getKillSwitch(b),T=!!x&&x.isActivated("0b95f189-dff4-441e-a8e1-e860c9d15392","4/9/2020","add schedule action to hoverCard"),N=h.default.publishNowAction,C=0,k=c.needsPublishingSignal.signal,L=h.default.pageNeedsRepublishing;if(E)N=h.default.submitNowAction;else if(!T&&S){N=h.default.scheduleAction;C=1;k=c.itemScheduledSignal.signal;L=h.default.pageNeedsScheduling}else if(w){var A=Math.floor(Number(w)/512);N=0===A?h.default.publishNowAction:h.default.republishNowAction}return{onRenderLifeCycleSignal:function(e,t){return t?r.createElement(a.WithAction,{action:r.createElement(f.ItemPublishAction,{itemKeys:[v],publishType:C,source:"FileCard"})},function(r){var i=r.isAvailable,s=r.execute,o=i?function(){s()}:void 0,u=n.__assign(n.__assign({},e),{actionName:N,action:o,content:L,signal:k});return t(u)}):null}}}return{}}return{}}}})});
define("yL",["require","exports","ih","og","Jb","o4","PL","YM","ce","sS","_S","SL"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=!a.Killswitch.isActivated(u.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands");t.sharedByMeCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return d}});t.default=t.sharedByMeCommandBarControlHandler;var p=[r.openCommand,i.shareCommand,i.copyLinkCommand,o.manageAccessCommand];function d(e,t){var n=v(e,t.itemKey);return{commands:m(p,n)}}t.itemsCommandBarControlHandler=d;function v(e,t){var n,r=e.demandItemFacet(s.sharedByMeRootItemKeyFacet,t);if(r){var i=new f.SimpleUri(r.tenantRootUrl).authority+"/_api/v2.0",o=l.driveAppsKeyFacet.serialize({endpoint:i});n=c.getFileHandlerCommands(e,{itemKey:o})}return n}t.getSharedByMeFileHandlerCommands=v;function m(e,t){return e.map(function(e){return e.key===r.openCommand.key?u.getOpenFileCommandWithHandler(t,h):e})}t.extendOpenFileCommands=m});
define("PL",["require","exports","lC","r","si","Xm","Or","pb","Vb"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAccessCommand={key:new i.Facet("manageAccess").id,automationId:"manageAccessCommand",name:o.default.ManageAccess,title:o.default.ManageAccessCommandTooltipV3,action:r.createElement(u.ShowOnlyWithSelection,null,r.createElement(s.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"},facets:n.__assign({},a.isShareFacet.pack(!0))}});
define("vL",["require","exports","ih","og","Jb","yL","pM","YM","ce"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=!a.Killswitch.isActivated(u.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands"),l=[r.openCommand,i.shareCommand,i.copyLinkCommand];t.sharedByMeContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return c}});function c(e,t){var n=t.itemKey,r=s.getSharedByMeFileHandlerCommands(e,n);return{commands:o.getOverrideDefaultCommands(l,r,!0,f)}}t.itemsContextMenuControlHandler=c});
define("hL",["require","exports","ih","B_","bL","J4"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,i.nameAndPathColumn,s.modifiedByColumn];function u(e,t){return{columns:o}}});
define("bL",["require","exports","N_","gL","v_","A_","y_","L_","g_","m_","Xp"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameAndPathColumn=o.createRenderHandlerColumn({key:i.NAME_AND_PATH_COLUMN_KEY,name:n.default.Name,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:s.TEXT_COLUMN_SORT_PROPS},[u.displayNameColumnRenderHandler,l.signalsColumnRenderHandler,r.pathColumnRenderHandler,a.heroColumnRenderHandler,f.itemHoverCardColumnRenderHandler])});
define("gL",["require","exports","r","A9","Rs","Ps","Kf","sS","C1"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pathColumnRenderHandler=function(e,t){var f=t.itemKey,l=t.renderer,c=e.demandItemFacet(i.parentFolderItemFacet,f),h=c&&e.demandItemFacet(i.openUrlFacet,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new u.SimpleUri(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?a.evaluateItemCacheComponent(e,n.createElement(o.ItemDefaultClickAction,{itemKey:c.itemKey})):null;return{renderer:function(e,t,i){var o=l?l(e,t,i):null;return n.createElement(n.Fragment,null,o?n.createElement(n.Fragment,{key:"content"},o):null,d?n.createElement(s.WithAction,{key:"path",action:d},function(e){var t=e.execute,i=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return n.createElement(r.PathField,{displayPathSegments:p,parentLink:h,onClick:i})}):null)}}}});
define("mL",["require","exports","lC","Hm","ko","Xo","Rs","Vm","r4","o4","_L","A8","xv","S0"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,d=f.sharedByMeRootItemKeyFacet.deserialize(r).tenantRootUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,v,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:t=c.getStaticApiUrl({webAbsoluteUrl:d}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,e(h.getData({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:d,noRedirect:!0}))];case 1:if(!((f=b.sent())&&f.d&&f.d.mySite))throw new i.ItemOperationError({facets:n.__assign({},p.itemNotFoundErrorFacet.pack({}))});v=f.d.mySite.replace(/\/$/,"");m=a.sharedByMeItemSetKeyFacet.serialize({webAbsoluteUrl:v||d});(g=new u.ItemResolver).resolveItems({items:(y={},y[r]=n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:m})),o.displayNameFacet.pack(l.default.sharedByYou)),o.folderFacet.pack({})),y)});e(g.execute());return[2]}})})}})});
define("pL",["require","exports","lC","Hm","xv","uL","r4","i4","Vm","h7","Xo","A8","o4","ye","zm"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,v=o.sharedByMeItemSetKeyFacet.deserialize(r).webAbsoluteUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,y,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:t=(t=c.getWebApiUrl({webAbsoluteUrl:v,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"});m=t.toString();return[4,e(i.getData({url:m,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:v}))];case 1:g=T.sent();y=new a.ItemResolver;b=s.getAndProcessSharedByMeItemData(g,y);w=""+new p.SimpleUri(v).authority;E=h.sharedByMeRootItemKeyFacet.serialize({tenantRootUrl:w});if(g.d.__next){S=u.sharedByMePageKeyFacet.serialize({itemSet:o.sharedByMeItemSetKeyFacet.deserialize(r),after:g.d.__next});b.push(S);y.merge(f.resolveNewPage({itemKey:S}).itemResolver)}y.resolveItems({items:(x={},x[r]=n.__assign(n.__assign({},l.childItemsFacet.pack({itemKeys:b})),l.parentItemFacet.pack({itemKey:E})),x[E]=n.__assign({},d.getInvalidationFacet().forFacet(l.defaultChildItemSetFacet).thenInvalidate(r,l.childItemsFacet).pack()),x)});e(y.execute());return[2]}})})}})});
define("uL",["require","exports","lC","De","L7","zm","Xo","Rs","oy","oi","fL","li","G_","X7","eS","$7","Z7","ph"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAndProcessSharedByMeItemData=function(e,t){var y=[];e.d.results.forEach(function(e){var b,w,E,S,x=""+new r.SPResourcePath(e.SiteUrl).authority+e.UrlPath,T=c.spItemFullUrlKeyFacet.serialize({itemFullUrl:x});y.push(T);var N=i.iso8601DateTimeToJsDate(e.Modified),C=(function(e){var t=l.getParentItemUrl(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:c.spItemFullUrlKeyFacet.serialize(n)}})(x),k=C.parentItemKey,L=C.parentItemUrl;t.mapKeys({mappings:(b={},b[c.spItemFullUrlKeyFacet.serialize({itemFullUrl:L})]=k,b)});var A=(function(e,t){var n=void 0!==t?t:3,r=!1,i=!1;if(e.IsContainer){n=h.FileIconType.folder;i=!0}"OneNote.Notebook"===e.ProgId&&(r=!0);return{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}})(e),O=e.SpItemUrl?d.getDriveItemKey(e.SpItemUrl):void 0;if(O)for(var M=0,_=d.getEndpointVersionKeyAliases(O);M<_.length;M++){var D=_[M];t.mapKeys({mappings:(w={},w[D]=T,w)})}var P=e.Editor,H=c.spPersonKeyFacet.serialize({id:P.email}),B={itemKey:H,displayValue:P.name};t.resolveItems({items:(E={},E[H]=n.__assign(n.__assign({},u.displayNameFacet.pack(P.name)),a.emailFacet.pack(P.email)),E)});t.resolveItems({items:(S={},S[T]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},u.displayNameFacet.pack(e.FileLeafRef)),u.isSharedFacet.pack(!0)),u.fileNameFacet.pack({name:e.FileLeafRef,extension:e.Extension})),f.fileIconTypeFacet.pack(A.fileIconType)),u.dateModifiedFacet.pack(N.getTime())),u.canonicalUrlFacet.pack(x)),u.parentFolderItemFacet.pack({itemKey:k})),u.modifiedByPersonFacet.pack(B)),f.oneNoteFacet.pack(A.isOneNote?{}:void 0)),u.folderFacet.pack(A.isFolder?{}:void 0)),u.openUrlFacet.pack(x)),g.driveItemKeyFacet.pack(O)),O?n.__assign(n.__assign(n.__assign({},u.analyticsItemFacet.pack({itemKey:v.driveAnalyticsItemKeyFacet.serialize({driveItemKey:O})})),u.followedItemFacet.pack({itemKey:m.driveFollowedItemKeyFacet.serialize({driveItemKey:O})})),u.activityItemFacet.pack({itemKey:p.driveActivityItemKeyFacet.serialize({driveItemKey:O})})):{}),s.getInvalidationFacet().forFacet(u.displayNameFacet).thenInvalidate(T,o.childItemsFacet).pack()),S[k]=n.__assign(n.__assign(n.__assign({},u.folderFacet.pack({})),u.canonicalUrlFacet.pack(L)),u.openUrlFacet.pack(L)),S)})});return y}});
define("fL",["require","exports","li","Se"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mapParentItemKey=function(e,t){var i,s=""+new r.SimpleUri(e.webAbsoluteUrl).authority+e.rootFolder;e.rootFolder||(s=e.listFullUrl);t.mapKeys({mappings:(i={},i[n.spItemKeyFacet.serialize(e)]=n.spItemFullUrlKeyFacet.serialize({itemFullUrl:s}),i)})};t.getParentItemUrl=function(e){return""+(""+new r.SimpleUri(e).authority)+new r.SimpleUri(e).segments.slice(0,-1).join("/")}});
define("lL",["require","exports","lC","Hm","i4","Vm","xv","h7","r4","uL"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMePageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedByMePageKeyFacet.deserialize(r).after,c=i.sharedByMePageKeyFacet.deserialize(r).itemSet;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(o.getData({url:l,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:c.webAbsoluteUrl}))];case 1:t=n.sent();h=a.sharedByMeItemSetKeyFacet.serialize(c);p=new s.ItemResolver;d=f.getAndProcessSharedByMeItemData(t,p);if(t.d.__next){v=i.sharedByMePageKeyFacet.serialize({itemSet:c,after:t.d.__next});d.push(v);p.merge(u.resolveNewPage({itemKey:v}).itemResolver)}p.merge(u.resolveExistingPage({itemKey:r,itemSetKey:h,childItemKeys:d}).itemResolver);e(p.execute());return[2]}})})}})});
define("cL",["require","exports","lC","li","Hm","Vm","zm","si","Xo","dL"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.projectionFacet=new u.Facet("projection");t.spProjectedUploadedItemSetGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var i=this,u=r.spProjectedUploadedItemSetKeyFacet.deserialize(e.itemKey).itemSetKey;return function(l){return n.__awaiter(i,void 0,void 0,function(){var i,c,h;return n.__generator(this,function(p){i=r.spFolderItemSetKeyFacet.serialize(u);(c=new s.ItemResolver).resolveItems({items:(h={},h[e.itemKey]=n.__assign(n.__assign({},t.projectionFacet.pack({})),o.getInvalidationFacet().forFacet(t.projectionFacet).thenInvalidate(function(){return function(){l(f.clearProjection({itemSetKey:i}))}}).pack()),h[i]=o.getInvalidationFacet().forFacet(a.childItemsFacet).thenInvalidate(e.itemKey,t.projectionFacet).pack(),h)});l(c.execute());return[2]})})}})});
define("dL",["require","exports","lC","rs","li","Xo","jm","A1","UO","Gm","$1","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clearProjection=function(e){var t=this,h=e.itemSetKey,p=i.spFolderItemSetKeyFacet.deserialize(h),d=i.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:p});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(h){e(r.readItems(function(e){var t=u.getConfiguration(e,{isProjectedUploadedItemSetEnabled:c.enableProjectedUploadedItemSetConfigurationFacet}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=i.spItemKeyFacet.serialize(p),r=e.demandItemFacet(c.activeUploadProjectionFoldersFacet,n);if(r&&Object.keys(r).length>0)return!1;for(var l=e.demandItemFacet(s.childItemsFacet,o.progressRootItemKey),h=0,d=l&&l.itemKeys||[];h<d.length;h++){var v=d[h];if(e.demandItemFacet(a.uploadProgressKeyFacet,v)){var m=e.demandItemFacet(f.destinationItemFacet,v),g=e.demandItemFacet(i.spItemKeyFacet,m&&m.itemKey);if(g&&g.rootFolder===p.rootFolder)return!1}}}return!0}))&&e(l.resolveItems({items:(t={},t[d]=n.__assign({},s.childItemsFacet.pack({itemKeys:[]})),t)}));return[2]})})}}});
define("UO",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressKeyFacet=new n.KeyFacet("uploadProgress",{sourceEntryKey:n.stringPart()});t.getUploadProgressKey=function(e){return t.uploadProgressKeyFacet.serialize({sourceEntryKey:e})}});
define("aL",["require","exports","Hm","ih","li","bI","sL","py","oL","U9","Ao","iL","G6"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointWebItemTileAddon=n.createAddon(function(){return function(e){e(r.registerControlHandler(i.spItemKeyFacet,s.itemTileControl)(o.spItemTileControlHandler));e(r.registerControlHandler(i.spItemKeyFacet,u.itemThumbnailControl)(a.spItemThumbnailControlHandler));e(n.registerOperationHandler(f.spItemThumbnailKeyFacet,l.getItemsOperation)(c.spItemThumbnailGetItemsOperationHandler));e(h.sharePointWebBasicItemDataAddon)}})});
define("sL",["require","exports","lC","r","ii","ih","ii","n9","qv","A1","C1"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemTileControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){return c(e,t)}}});function c(e,t){var s=t.itemKey,c=f.getConfiguration(e,{enableItemActivityField:o.enableItemActivityFieldFacet}).enableItemActivityField,p=e.demandItemFacet(o.friendlyDateModifiedFacet,s),d=c&&l.evaluateItemCacheComponent(e,r.createElement(a.ItemActivityField,{itemKey:s,isCompact:!0,hideDate:!0}))||p&&r.createElement(u.DateField,{text:p}),v=e.demandItemFacet(i.mountPointFacet,s);return n.__assign(n.__assign({},d?{itemActivity:d}:{}),{folderCoverControlHandler:function(e,t){return v?{folderCoverAs:h}:{}}})}t.itemTileControlHandler=c;function h(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(t,n.__assign({},i,{folderCoverType:"linked"})):null}});
define("oL",["require","exports","ih","li","T9","ii","ai","A1","Se","ph","GA","Rs","u9","g6","Xy","ce"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemThumbnailControlHandler=n.createControlHandler()(function(){return function(e){return g}});var m={ODB:1928};function g(e,t){var n=t.itemKey,g=t.desiredSize,y=e.demandItemFacet(r.spItemKeyFacet,n);if(!y)return{};var b=(function(e,t){var n=t.itemKey,r=t.spItem,i=t.desiredSize,o=u.getConfiguration(e,{enableSharePointDirectThumbnails:s.enableSharePointDirectThumbnailsFacet,spCookieDomainConfiguration:s.spCookieDomainConfigurationFacet}),g=o.enableSharePointDirectThumbnails,y=void 0===g||g,b=o.spCookieDomainConfiguration,w=d.getPageContextFromItemCache(e,n);if(y&&p.isFeatureEnabled(e,{pageContext:w,feature:m})&&w&&!v.getKillSwitch(w).isActivated("C5892D55-79FA-4399-8941-95AD020ABB93","3/30/2020","Support direct SharePoint thumbnails")){var E=r.webAbsoluteUrl,S=r.listFullUrl,x=new a.SimpleUri(E||S).authority;if(b&&b===x){var T=x+"/_api/v2.1",N=e.demandItemFacet(f.driveItemKeyFacet,n),C=e.demandItemFacet(c.eTagFacet,n)||"";if(N){var k=N.driveId,L=N.itemId,A=l.getDriveItemUrl({endpoint:T,driveId:k,itemId:L}),O=Math.ceil(i.width),M=Math.ceil(i.height);return{url:A+"/thumbnails/0/c"+O+"x"+M+"/content?"+h.serializeQuery({prefer:"noredirect,closestavailablesize",cb:C}),width:0,height:0}}}}})(e,{itemKey:n,spItem:y,desiredSize:g})||(function(e,t){var n=t.itemKey,r=t.desiredSize,s=e.demandItemFacet(i.thumbnailUrlGeneratorFacet,n),o=s&&s(r.width,r.height);if(o)return{url:o,width:0,height:0}})(e,{itemKey:n,desiredSize:g})||(function(e,t){var n=t.spItem,u=t.itemKey,a=r.spListKeyFacet.serialize(n),f=e.demandItemFacet(s.listFacet,a);if(!f)return;var l=f.templateType===o.default.publishingAsset;if(f.isPromotedLinks||l){var c=e.demandItemFacet(s.rowDataFacet,u),h=void 0;f.isPromotedLinks?h=c&&c.BackgroundImageLocation:l&&c&&c.AlternateThumbnailUrl&&(h=e.demandItemFacet(i.alternateThumbnailFullUrlFacet,u));if(h)return{url:h,width:0,height:0}}})(e,{spItem:y,itemKey:n});return b?{thumbnail:b}:{}}});
define("iL",["require","exports","lC","U9","YD","Vm","v7","Hm","li","v7","rL","zm"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemThumbnailGetItemsOperationHandler=u.createSingleItemOperationHandler({maxParallelOperationCount:16})(function(e){var t=this,u=r.spItemThumbnailKeyFacet.deserialize(e.itemKey).itemKey;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d;return n.__generator(this,function(v){switch(v.label){case 0:return[4,r(i.demandItems(function(e){var t=e.demandItemFacet(a.spItemKeyFacet,u),n=t&&a.spListKeyFacet.serialize(t),r=e.demandItemFacet(f.listMediaTransformFacet,n),i=e.demandItemFacet(f.itemMediaTransformFacet,u);return{generator:l.createThumbnailUrlGenerator({listMediaTransformSchema:r,itemMediaTransformSchema:i})}}))];case 1:t=v.sent().generator;(h=new s.ItemResolver).resolveItems(((p={items:(d={},d[e.itemKey]=n.__assign({},o.mediaTransformThumbnailUrlGeneratorFacet.pack(t)),d)})[u]=n.__assign({},c.getInvalidationFacet().forFacet(f.itemMediaTransformFacet).thenInvalidate(e.itemKey,o.mediaTransformThumbnailUrlGeneratorFacet).pack()),p));r(h.execute());return[2]}})})}})});
define("rL",["require","exports","lC","u9","l9"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createThumbnailUrlGenerator=function(e){var t=e.listMediaTransformSchema,s=e.itemMediaTransformSchema;if(t&&s){var o=t[".transformUrl"],u=s[".hasThumbnail"],a=n.__assign(n.__assign(n.__assign({},t),s),{".method":"thumbnail"});if("True"===u&&o)return function(e,t){var n=t?{width:e,height:t}:{width:e};return i.buildUrl(o,a)+"&"+r.serializeQuery(n)}}}});
define("nL",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedActionListControl=new n.ControlFacet("removeFromShardListActionControl")});
define("tL",["require","exports","li","ih"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedListControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemKey;return{isAvailable:!!e.demandItemFacet(n.spItemKeyFacet,r)}}}})});
define("eL",["require","exports","ih","A1","li","Xo","li","Rs","ii","cL","GS","Hm"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,l=t.itemKeys,c=r.getConfiguration(e,{isProjectedUploadedItemSetEnabled:a.enableProjectedUploadedItemSetConfigurationFacet}).isProjectedUploadedItemSetEnabled;if(void 0!==c&&c){var h=e.demandItemFacet(i.spFolderItemSetKeyFacet,n);if(h){var p=(function(e,t,n){var r=[],a=o.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:t}),l=e.demandItemFacet(s.childItemsFacet,a);e.demandItemFacet(f.projectionFacet,o.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:t}));if(!l||l.itemKeys&&0===l.itemKeys.length)return;for(var c={},h={},p=0,d=l.itemKeys;p<d.length;p++){var v=d[p];r.push(v);var m=e.demandItemFacet(i.spItemKeyFacet,v);if(m){m.itemId&&(c[m.itemId]=!0);m.rootFolder&&(h[m.rootFolder]=!0)}c[v]=!0}if(n)for(var g=0,y=n;g<y.length;g++){var b=y[g],w=e.demandItemFacet(i.spItemKeyFacet,b);if(w){if(e.demandItemFacet(u.folderFacet,b)){if(w.rootFolder&&w.rootFolder in h)continue}else if(w.itemId&&w.itemId in c)continue}r.push(b)}return r})(e,h,l);return p?{itemKeys:p}:{}}}return{}}}});t.spProjectedUploadedItemSetAddon=c.createAddon(function(){return function(e){e(n.registerControlHandler(i.spFolderItemSetKeyFacet,l.projectedUploadedItemSetControl)(n.createControlHandler()(h)))}})});
define("ZA",["require","exports","lC","r","ih","li","PS","$A","Ps","am","C1","bs","os","v","Rs","me"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spFolderByIdErrorControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){return{errorRenderer:m}}}});var m=l.createItemCacheComponent(function(e,t){var i=t.defaultRender,l=(t.itemKey,t.title,n.__rest(t,["defaultRender","itemKey","title"])),m=l.error;if(m instanceof p.ApiError&&m.extraData&&404===m.extraData.status){var g=c.getItemsScope(e).itemsScopeItemKey,y=e.demandItemFacet(h.currentItemFacet,g),b=e.demandItemFacet(s.remoteItemKeyFacet,y&&y.itemKey),w=b&&s.spItemKeyFacet.serialize(b.mountPointItem),E=void 0,S=u.default.mountPointNotFoundDefaultErrorMessage;if(w){var x=e.demandItemFacet(d.displayNameFacet,w);x&&(S=v.format(u.default.mountPointNotFoundErrorMessage,x));E=r.createElement("div",null,r.createElement(a.WithAction,{action:r.createElement(o.ItemRemoveFromOneDriveAction,{itemKeys:[w]})},function(e){var t=e.execute;return r.createElement(f.DefaultButton,{onClick:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,t().then(function(){window.location.href="#"}).catch()];case 1:e.sent();return[2]}})})}},u.default.removeThisShortcut)}))}return r.createElement(r.Fragment,null,i?r.createElement(i,n.__assign({key:"error"},l,{title:u.default.mountPointNotFoundErrorTitle,subText:S,actions:E})):null)}return i?r.createElement(i,n.__assign({},t)):null})});
define("zA",["require","exports","lC","si","Rs","Hm","ii","li","J7","Vm","GA","oy"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={key:u.spPersonKeyFacet,displayName:i.displayNameFacet,email:c.emailFacet};t.spItemPlacesSetGetItemsOperationHandler=s.createSingleItemOperationHandler()(function(e){var t=e.itemKey,s=a.spItemPlacesSetKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,c,p,d,v,m,g,y,b;return n.__generator(this,function(w){switch(w.label){case 0:a=s.siteUrl||"";c=s.listId||"";p=s.uniqueId||"";d=a+"/_api/web/Lists('"+c+"')/GetPlacesInformation('"+p+"')?$expand=places";w.label=1;case 1:w.trys.push([1,3,,4]);return[4,e(l.getRawData({url:d,qosName:"GetPlacesInformation",method:"GET",endpoint:a}))];case 2:v=w.sent();m=new f.ItemResolver;g=[];(y=v&&v.places)&&y.forEach(function(e){var t,n=e.userEntity.email,i=u.spPersonKeyFacet.serialize({id:String(n)});m.resolveItems({items:(t={},t[i]=r.pack(h,{key:{id:String(n)},displayName:e.userEntity.name,email:n}),t)});g.push(i)});m.resolveItems({items:(b={},b[t]=n.__assign(n.__assign(n.__assign({},o.placeMountedLocationsFacet.pack({locationKeys:g})),o.itemSourcePathFacet.pack(v.itemSourcePath)),i.displayNameFacet.pack(v.itemSourceSiteTitle)),b)});e(m.execute());return[3,4];case 3:throw w.sent();case 4:return[2]}})})}})});
define("hVe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TEMP={}});
define("wO",["require","exports","lC","Ew","ZO","XO","QO","EO"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t)});
define("Ew",["require","exports","lC","r","me","Xw","kw","am","To","Lw","Aw","oc","Ps","Wb","Ar"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MalwareDetectedDialog=function(e){var t=this,m=e.itemKey,g=e.resolve,y=e.reject,b=r.useState(!1),w=b[0],E=b[1],S=d.useEventHandler(function(){y(new a.CancelError)}),x=c.getTheme();return r.createElement(h.WithAction,{action:r.createElement(p.ItemDownloadAction,{itemKeys:[m]})},function(e){var a=e.isAvailable,c=e.execute,h=a?function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);E(!0);return[4,c()];case 1:t.sent();g();return[3,3];case 2:e=t.sent();y(e);return[3,3];case 3:return[2]}})})}:void 0,p=a?f.default.malwareDetectedAllowDownloadMessage:f.default.malwareDetectedMessage;return w?null:r.createElement(o.Dialog,{hidden:!1,onDismiss:S,title:f.default.malwareDetectedDialogHeader,closeButtonAriaLabel:f.default.closeButtonAriaLabel,type:o.DialogType.close,styles:v,dialogContentProps:{styles:function(){return{title:{color:x.semanticColors.errorText,fontWeight:"500"}}}}},r.createElement(s.Label,null,i.formatToArray(p,r.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},f.default.malwareDetectedLearnMore))),r.createElement(o.DialogFooter,null,h?r.createElement(u.DefaultButton,{onClick:h},f.default.malwareDialogDownload):null,r.createElement(u.DefaultButton,{onClick:S,primary:!0},l.default.cancelActionText)))})};function v(){return{main:{maxWidth:"450px !important"}}}});
define("ZO",["require","exports","r","bw","jm","Sb","ew","Ec","jr","Xo","Gm","Er","$O"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=[];t.ProgressPanel=function(e){var t=e.resolve,d=n.useState(!0),v=d[0],m=d[1],g=c.useEventHandler(function(){m(!1)}),y=n.useCallback(function(e){var u=e.itemCache,c=e.dispatch,d=u.demandItemFacet(f.childItemsFacet,i.progressRootItemKey),m=d&&d.itemKeys||p,y=m.filter(function(e){var t=i.getOverallProgressPhase(u,{itemKey:e});return t===l.ProgressPhase.completed||t===l.ProgressPhase.canceled}),b=u.demandItemFacet(h.progressPanelControl,i.progressRootItemKey),w=h.progressPanelControl.evaluate(b)(u,{itemKeys:m,panelAs:r.Panel}).panelAs;return n.createElement(w,{isOpen:v,headerText:s.default.progressTitle,isLightDismiss:!0,onDismiss:g,onDismissed:function(){c(i.expireProgressItems({items:a.makeObject(y,function(){return!0})}));t()},closeButtonAriaLabel:s.default.progressCloseActionText},n.createElement(o.ProgressList,{itemKeys:m}))},[v,t]);return n.createElement(u.WithItemCache,null,y)}});
define("ew",["require","exports","r","KC","aw","SPListItemsScopeDeferred_IS_mini_css","Sb","Un","Gm","Xo","jm","tw","C1","ZC"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";s=s.ProgressList_3;Object.defineProperty(t,"__esModule",{value:!0});var d=n.createContext(void 0),v=function(){var e=n.createRef();n.useEffect(function(){e&&e.current&&e.current.focus()});return n.createElement("p",{ref:e,tabIndex:-1},o.default.progressNoItemsMessage)};t.ProgressList=h.createItemCacheComponent(function(e,t){for(var i=t.itemKeys,o=t.groupsOnly,u=t.role,h=[],g=e.demandItemFacet(c.progressListControl,void 0),b=c.progressListControl.evaluate(g)(e,{}).groupControlHandler,w=function(t){if(l.getOverallProgressPhase(e,{itemKey:t})===a.ProgressPhase.expired)return"continue";var n=function(r,i){h.push({key:r,content:{itemKey:r,index:h.length},onRender:0===i?m:y});if(!(o&&i>=1)){var s,u=e.demandItemFacet(c.progressListGroupControl,t),l=e.demandItemFacet(f.childItemsFacet,r),p=l&&l.itemKeys;p&&(s=p.filter(function(t){return!e.demandItemFacet(a.progressAggregationOnlyFacet,t)}));var d=c.progressListGroupControl.evaluate(u,b)(e,{itemKey:r,childItemKeys:s,maxChildItemCount:void 0}).maxChildItemCount;if(s)for(var v=0,g="number"==typeof d?s.slice(0,d):s;v<g.length;v++){var w=g[v];n(w,i+1)}}};n(t,0)},E=0,S=i;E<S.length;E++){w(S[E])}return h.length>0?n.createElement(p.SET_SIZE_CONTEXT.Provider,{value:h.length},n.createElement(d.Provider,{value:u},n.createElement(r.TilesList,{className:s.root,items:h,role:u}))):n.createElement(v,null)});function m(e){var t=e.itemKey,r=e.index;return n.createElement(g,{itemKey:t,index:r})}function g(e){var t=e.itemKey,r=e.index,o=n.useContext(p.SET_SIZE_CONTEXT),a=n.useContext(d);return n.createElement("div",{className:u.css(s.group),role:a?"presentation":"listitem","aria-posinset":a?void 0:r+1,"aria-setsize":a?void 0:o},n.createElement(i.ProgressItemTile,{itemKey:t,format:"group"}))}function y(e){var t=e.itemKey,r=e.index;return n.createElement(b,{itemKey:t,index:r})}function b(e){var t=e.itemKey,r=e.index,o=n.useContext(p.SET_SIZE_CONTEXT),a=n.useContext(d);return n.createElement("div",{className:u.css(s.item),role:a?"presentation":"listitem","aria-posinset":a?void 0:r+1,"aria-setsize":a?void 0:o},n.createElement(i.ProgressItemTile,{itemKey:t,format:"item"}))}});
define("KC",["require","exports","lC","WC"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("WC",["require","exports","lC","QC","qC"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("QC",["require","exports","lC","r","sd","Uc","us","SPListItemsScopeDeferred_IS_mini_css","Rl"],function(e,t,n,r,i,s,o,u,a){"use strict";u=u.TilesList_5;Object.defineProperty(t,"__esModule",{value:!0});var f=u,l=(function(e){n.__extends(t,e);function t(t,i){var s=e.call(this,t,i)||this;s._onRenderListRoot=function(e,t){var r=s.props.onRenderRoot;if(!t)return null;for(var i=0,u=0,a=0,f=e.pages;a<f.length;a++){var l=f[a].data;if(l)for(var c=0,h=Object.keys(l.rows);c<h.length;c++){var p=h[c],d=l.rows[Number(p)];i++;u=Math.max(u,d.cellCount)}}var v=function(r){return t(n.__assign(n.__assign({},e),{divProps:n.__assign(n.__assign({},e.divProps),r.divProps),surfaceElement:r.surfaceElement}))};return(r?o.composeRenderFunction(r,v):v)({surfaceElement:e.surfaceElement,divProps:e.divProps,rowCount:i,columnCount:u})};s._onRenderPage=function(e,t){if(!e)return null;for(var i,u,l=s.props,c=l.role,h=l.onRenderRow,p=h?o.composeRenderFunction(h,s._renderRow):s._renderRow,d=e.page,v=e.className,m=n.__rest(e,["page","className"]),g=d.items,y=d.data,b=g||[],w=[],E=s.state.cells[d.startIndex-1],S=s.state.cells[d.startIndex+d.itemCount],x=b.length,T=[],N=0,C=function(e){for(var t,l,h=b[e].grid,v=h.isPlaceholder,m=h.maxRowCount,g=[],C=y.pageWidths[d.startIndex+e],k=0,L=!1,A=0,O=function(){var t=b[e],u=d.startIndex+e,a=y.rows[u];if(a){if(T.length>0){g.push(p({cellElements:T,divProps:{className:f.row,role:"presentation"}}));T=[]}a!==i&&k++;if("number"==typeof m&&k>m){L=!0;return"break"}i=a;A=0}var l=y.cellSizes[u];if(i){var v=i.scaleFactor,w=i.isLastRow,E=i.maxScaleFactor;if(E){var S=Math.min(E,h.maxScaleFactor);l={width:l.width*S,height:2===h.mode?l.height*S:h.minRowHeight}}else if((2===h.mode||3===h.mode)&&(!w||v<=h.maxScaleFactor)){S=Math.min(h.maxScaleFactor,v);l={width:l.width*S,height:2===h.mode?l.height*S:h.minRowHeight}}}var x=function(e){var p;void 0===e&&(e=0);return r.createElement("div",{key:h.key+"-item-"+t.key+(e?"-"+e:""),"data-list-index":u,role:c?"presentation":"listitem",className:o.css("ms-List-cell",s._onGetCellClassName(),(p={},p["ms-TilesList-cell--firstInRow "+f.cellFirstInRow]=!!a,p)),"data-automationid":"ListCell",style:n.__assign({},s._onGetCellStyle(t,i))},s._onRenderCell(t,l,A+e))};if(t.isPlaceholder&&0!==h.mode){var O=Math.floor(C/(h.spacing+l.width)),M=3*O;N=O*l.width+h.spacing*(O-1);for(var _=0;_<M;_++)T.push(x(_))}else{N=l.width/3;T.push(x())}A++};e<x&&b[e].grid===h;e++){if("break"===O())break}if(L)for(;e<x&&b[e].grid===h;e++);var M=E&&E.grid===h,_=S&&S.grid===h,D=h.spacing/2;if(T.length>0){g.push(p({cellElements:T,divProps:{className:o.css(f.row,(t={},t[f.headerRow]=0===h.mode,t)),role:"presentation"}}));T=[]}var P=r.createElement("div",{key:h.key,className:o.css("ms-TilesList-grid",(l={},l[""+f.grid]=0!==h.mode,l[""+f.shimmeredList]=v,l)),style:{width:C+"px",margin:-D+"px",marginTop:M?"0":h.marginTop-D+"px",marginBottom:_?"0":h.marginBottom-D+"px"}},g);w.push(v?r.createElement(a.Shimmer,{key:e,customElementsGroup:P,width:N}):P);u=e},k=0;k<x;){C(k);k=u}return r.createElement("div",n.__assign({},m,{className:o.css(v,s._onGetPageClassName())}),w)};s._getPageSpecification=function(e,t){s._pageSpecificationCache&&s._pageSpecificationCache.width!==t.width&&(s._pageSpecificationCache=void 0);s._pageSpecificationCache||(s._pageSpecificationCache={width:t.width,byIndex:{}});var n=s._pageSpecificationCache;if(n.byIndex[e])return n.byIndex[e];for(var r,i=s.state.cells,o=s.props.cellsPerPage,u=void 0===o?100:o,a=Math.min(i.length,e+u),f=0,l=0,c=e,h=!0,p={},d={},v={};c<a;){var m=i[c].grid,g=m.maxRowCount;f=0;l=c;var y=t.width+m.spacing;v[c]=y;var b=p[c]={scaleFactor:1,cellCount:0};if(0!==m.mode){for(var w=0,E=!1;c<a&&i[c].grid===m;c++){if("number"==typeof g&&w>=g){E=!0;break}var S=i[c].aspectRatio;if(f+(T=S*m.minRowHeight+m.spacing)>y){var x=m.spacing*(c-l);b.scaleFactor=(y-x)/(f-x)}f+=T;d[c]={width:S*m.minRowHeight,height:m.minRowHeight};if(f>y){f=T;l=c;b=p[c]={scaleFactor:1,cellCount:0};w++}b.cellCount++}!i[c]||i[c].grid!==m||E?b.isLastRow=!0:h=!1;if(f<y){x=m.spacing*(c-l);b.scaleFactor=(y-x)/(f-x);if((2===m.mode||3===m.mode)&&b.isLastRow&&c-l>0)for(var T=(f-x)/(c-l)+m.spacing,N=f,C=c;;C++){if(N+T>y){var k=m.spacing*(C-l);b.maxScaleFactor=(y-k)/(N-k);break}N+=T}}!h&&b.scaleFactor>(2===m.mode||3===m.mode?m.maxScaleFactor:1)&&(r=i.slice(l,c));if(E)for(;c<i.length&&i[c].grid===m;)c++}else{h=!0;d[c]={width:t.width,height:0};b.cellCount++;c++}}var L={itemCount:c-(r?r.length:0)-e,data:{pageWidths:v,rows:p,extraCells:r,cellSizes:d}};n.byIndex[e]=L;return L};s._renderRow=function(e){var t=e.cellElements,i=e.divProps;return r.createElement("div",n.__assign({},i),t)};s._onGetCellClassName=function(){return f.listCell};s._onGetPageClassName=function(){return f.listPage};s._onGetCellStyle=function(e,t){var n=e.grid,r=n.mode,i=n.maxScaleFactor,s=e.grid;if(0===r)return{};var o=e.aspectRatio||1,u=s.spacing/2,a=2===r||3===r,f=o*s.minRowHeight;return{flex:a?o+" "+o+" "+f+"px":"0 0 "+f+"px",maxWidth:(t&&t.maxScaleFactor?f*Math.min(t.maxScaleFactor,i):a&&(!t||!t.isLastRow||t.scaleFactor<=i)?f*i:f)+"px",margin:e.isPlaceholder?0:u+"px",borderStyle:e.isPlaceholder?"solid":"none",borderWidth:e.isPlaceholder?u+"px":0}};s.listRef=r.createRef();s.state={cells:s._getCells(t.items)};return s}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.items!==this.props.items&&this.setState({cells:this._getCells(e.items)})};t.prototype.UNSAFE_componentWillUpdate=function(e,t){t.cells!==this.state.cells&&(this._pageSpecificationCache=void 0)};t.prototype.render=function(){var e=this.state.cells,t=this.props,u=t.className,a=(t.onActiveElementChanged,t.items,t.cellsPerPage,t.ref),f=t.role,l=t.focusZoneComponentRef,c=t.listProps,h=void 0===c?{}:c,p=n.__rest(t,["className","onActiveElementChanged","items","cellsPerPage","ref","role","focusZoneComponentRef","listProps"]),d=h.onRenderRoot,v=h.onRenderPage,m=n.__rest(h,["onRenderRoot","onRenderPage"]),g=d?o.composeRenderFunction(d,this._onRenderListRoot):this._onRenderListRoot,y=v?o.composeRenderFunction(v,this._onRenderPage):this._onRenderPage;return r.createElement(s.FocusZone,n.__assign({},p,{ref:a,componentRef:l,className:o.css("ms-TilesList",u),direction:s.FocusZoneDirection.bidirectional,onActiveElementChanged:this.props.onActiveElementChanged}),r.createElement(o.FocusRects,null),r.createElement(i.List,n.__assign({items:e,role:f,onRenderRoot:g,getPageSpecification:this._getPageSpecification,onRenderPage:y,ref:this.listRef,usePageCache:!0},m)))};t.prototype.scrollToIndex=function(e,t){var n=this;void 0===t&&(t=i.ScrollToMode.auto);this.listRef&&this.listRef.current&&(0===this.state.cells[e].grid.mode?this.listRef.current.scrollToIndex(e,function(t){var r=n.state.cells[e];return r&&void 0!==r.desiredHeight?r.desiredHeight:0},t):this.listRef.current.scrollToIndex(e,void 0,t))};t.prototype.getTotalListHeight=function(){return this.listRef&&this.listRef.current&&this.listRef.current.getTotalListHeight?this.listRef.current.getTotalListHeight():0};t.prototype._onRenderCell=function(e,t,n){if(0===e.grid.mode)return r.createElement("div",{className:o.css(f.header)},e.onRender({item:e.content,finalSize:{width:0,height:0},position:{column:n}}));var i=1/e.aspectRatio;return r.createElement("div",{role:"presentation",className:o.css(f.cell),style:3===e.grid.mode?{height:e.grid.minRowHeight+"px"}:{paddingTop:(100*i).toFixed(2)+"%"}},r.createElement("div",{role:"presentation",className:o.css(f.cellContent)},e.onRender({item:e.content,finalSize:t,position:{column:n}})))};t.prototype._getCells=function(e){for(var t=[],n=function(e){if((function(e){return!!e.items})(e))for(var n=e.spacing,r=void 0===n?0:n,i=e.maxScaleFactor,s=void 0===i?1.5:i,o=e.marginBottom,u=void 0===o?0:o,a=e.marginTop,f=void 0===a?0:a,l=e.minAspectRatio,c=void 0===l?.5:l,h=e.maxAspectRatio,p=void 0===h?3:h,d={minRowHeight:e.minRowHeight,spacing:r,mode:e.mode,key:"grid-"+e.key,maxScaleFactor:s,marginTop:e.isPlaceholder?0:f,marginBottom:e.isPlaceholder?0:u,isPlaceholder:e.isPlaceholder,maxRowCount:e.maxRowCount},v=function(e){var n=e.desiredSize,r=e.onRender,i=e.onRenderCell,s=Math.min(p,Math.max(c,n&&n.width/n.height||1)),o=i||function(e){return r?r(e.item,e.finalSize):null};t.push({aspectRatio:s,content:e.content,onRender:o,grid:d,key:e.key,isPlaceholder:e.isPlaceholder,desiredHeight:n?n.height:void 0})},m=0,g=e.items;m<g.length;m++){v(g[m])}else{var y=e.onRenderCell,b=e.onRender,w=y||function(e){return b?b(e.item,e.finalSize):null};t.push({aspectRatio:1,content:e.content,onRender:w,grid:{minRowHeight:0,spacing:0,mode:0,key:"grid-header-"+e.key,maxScaleFactor:1,marginBottom:0,marginTop:0,isPlaceholder:e.isPlaceholder},key:"header-"+e.key,isPlaceholder:e.isPlaceholder})}},r=0,i=e;r<i.length;r++){n(i[r])}return t};return t})(r.Component);t.TilesList=l});
define("qC",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.none=0]="none";e[e.stack=1]="stack";e[e.fill=2]="fill";e[e.fillHorizontal=3]="fillHorizontal"})(t.TilesGridMode||(t.TilesGridMode={}))});
define("aw",["require","exports","lC","r","Un","SPListItemsScopeDeferred_IS_mini_css","uw","Ec","Fm","V_","jm","om","me","Sb","Gm","Rs","wo","Ps","lw","dw","To","iw","O1","Jo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";s=s.ProgressItemTile_3;var T,N;Object.defineProperty(t,"__esModule",{value:!0});var C=[],k=((T={})[d.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericStartedItemsTitle,p.default.genericCompletedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericCompletedItemsTitle,p.default.genericCompletedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericFailedItemsTitle,p.default.genericFailedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericFailedItemsTitle,p.default.genericFailedItemsTitleIntervals,e)||"",e)},T),L=((N={})[d.ProgressPhase.created]=p.default.genericCreatedDescription,N[d.ProgressPhase.canceled]=p.default.genericCanceledDescription,N[d.ProgressPhase.completed]=p.default.genericCompletedDescription,N),A=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t,n=this.props,u=n.icon,a=n.actions,f=n.cancel,l=n.description,c=n.title,h=c?r.createElement("div",{className:i.css(s.title)},c):c,p=l?r.createElement("div",{className:i.css(s.description)},l):l;return r.createElement("div",{className:i.css(s.tile,(e={},e[s.hasIcon]=!!u,e[s.error]=!!this.props.error,e))},u?r.createElement("span",{className:i.css(s.icon,(t={},t[s.hasProgress]=!this.props.progressHidden,t))},this.props.icon):null,r.createElement("div",{className:i.css(s.progress)},r.createElement(o.ProgressIndicator,{label:h,description:p,percentComplete:this.props.percentComplete,progressHidden:this.props.progressHidden})),a?r.createElement("div",{className:i.css(s.actions)},a):null,f?r.createElement("span",{className:i.css(s.cancel)},f):null)};return t})(r.PureComponent);t.ProgressTile=A;var O=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.itemKey,s=t.format;return r.createElement(u.WithItemCache,null,function(t){var o=t.itemCache,u=(t.dispatch,o.demandItemFacet(d.sourceItemFacet,i)),h=u&&u.itemKey,T=o.demandItemFacet(v.displayNameFacet,i)||o.demandItemFacet(v.displayNameFacet,h),N=o.demandItemFacet(m.errorFacet,i),O=o.demandItemFacet(a.progressControl,i),M=l.getItemCountsByProgressPhase(o,{itemKey:i}),_=l.getOverallSimpleProgressBreakdown(o,{itemKey:i}),D=_.phase,P=_.count,H=l.getOverallProgressPhase(o,{itemKey:i}),B=o.demandItemFacet(d.overallProgressSizeFacet,i),j=B?0!==B.total?B.current/B.total:void 0:D!==d.ProgressPhase.started?1:void 0,F=a.progressControl.evaluate(O)(o,n.__assign(n.__assign({itemKey:e.props.itemKey,title:T||k[D](P),description:N&&!w.isCancel(N)?N.message:L[H]},j?{percentComplete:j}:{}),{itemCountsByPhase:M,format:s,commands:C})),I=F.title,q=F.description,R=F.percentComplete,U=F.commands,z="started"===D?r.createElement(y.CancelProgressAction,null):"failed"===D?r.createElement(b.ExpireProgressAction,null):null,W="started"===D||"failed"===D&&"number"==typeof R&&R<1;return r.createElement(S.ControlHandlerProvider,{controlHandlers:x.selectedItemsControl.pack(function(e,t){return{itemKeys:[i]}})},r.createElement(g.WithAction,{action:z},function(e){var t=e.execute,n=e.isAvailable?function(){t().catch(function(){})}:void 0;return r.createElement(A,{title:I,description:q,percentComplete:R,error:N&&!w.isCancel(N)?N:void 0,progressHidden:!W,icon:"item"===s?r.createElement(f.ItemFileTypeIcon,{itemKey:h,size:48}):void 0,cancel:n?r.createElement(c.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:"started"===D?p.default.progresslistCancelButtonAriaLabel:p.default.progresslistRemoveButtonAriaLabel,onClick:n}):void 0,actions:U.length>0?r.createElement(E.ActionCommandButtonStrip,{commands:U}):void 0})}))})};return t})(r.PureComponent);t.ProgressItemTile=O});
define("uw",["require","exports","lC","fw"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("fw",["require","exports","lC","mw","pw"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("mw",["require","exports","us","pw","_w"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ProgressIndicator=n.styled(r.ProgressIndicatorBase,i.getStyles,void 0,{scope:"ProgressIndicator"})});
define("pw",["require","exports","lC","r","us"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.classNamesFunction(),o=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderProgress=function(e){var n=t.props,i=n.ariaValueText,o=n.barHeight,u=n.className,a=n.styles,f=n.theme,l="number"==typeof t.props.percentComplete?Math.min(100,Math.max(0,100*t.props.percentComplete)):void 0,c=s(a,{theme:f,className:u,barHeight:o,indeterminate:void 0===l}),h={width:void 0!==l?l+"%":void 0,transition:void 0!==l&&l<.01?"none":void 0},p=void 0!==l?0:void 0,d=void 0!==l?100:void 0,v=void 0!==l?Math.floor(l):void 0;return r.createElement("div",{className:c.itemProgress},r.createElement("div",{className:c.progressTrack}),r.createElement("div",{className:c.progressBar,style:h,role:"progressbar","aria-valuemin":p,"aria-valuemax":d,"aria-valuenow":v,"aria-valuetext":i}))};return t}t.prototype.render=function(){var e=this.props,t=e.barHeight,i=e.className,o=e.label,u=void 0===o?this.props.title:o,a=e.description,f=e.styles,l=e.theme,c=e.progressHidden,h=e.onRenderProgress,p=void 0===h?this._onRenderProgress:h,d="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,v=s(f,{theme:l,className:i,barHeight:t,indeterminate:void 0===d});return r.createElement("div",{className:v.root},u?r.createElement("div",{className:v.itemName},u):null,c?null:p(n.__assign(n.__assign({},this.props),{percentComplete:d}),this._onRenderProgress),a?r.createElement("div",{className:v.itemDescription},a):null)};t.defaultProps={label:"",description:"",width:180};return t})(r.Component);t.ProgressIndicatorBase=o});
define("_w",["require","exports","lC","oc","us"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},o=i.memoizeFunction(function(){return r.keyframes({"0%":{left:"-30%"},"100%":{left:"100%"}})}),u=i.memoizeFunction(function(){return r.keyframes({"100%":{right:"-30%"},"0%":{right:"100%"}})});t.getStyles=function(e){var t,a,f,l=i.getRTL(e.theme),c=e.className,h=e.indeterminate,p=e.theme,d=e.barHeight,v=void 0===d?2:d,m=p.palette,g=p.semanticColors,y=p.fonts,b=r.getGlobalClassNames(s,p),w=m.neutralLight;return{root:[b.root,y.medium,c],itemName:[b.itemName,r.noWrap,{color:g.bodyText,paddingTop:4,lineHeight:20}],itemDescription:[b.itemDescription,{color:g.bodySubtext,fontSize:y.small.fontSize,lineHeight:18}],itemProgress:[b.itemProgress,{position:"relative",overflow:"hidden",height:v,padding:"8px 0"}],progressTrack:[b.progressTrack,{position:"absolute",width:"100%",height:v,backgroundColor:w,selectors:(t={},t[r.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:m.themePrimary,height:v,position:"absolute",transition:"width .3s ease",width:0,selectors:n.__assign((a={},a[r.HighContrastSelector]={backgroundColor:"highlight"},a),r.getEdgeChromiumNoHighContrastAdjustSelector())},h?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+w+" 0%, "+m.themePrimary+" 50%, "+w+" 100%)",animation:(l?u():o())+" 3s infinite",selectors:(f={},f[r.HighContrastSelector]={background:"highlight"},f)}:{transition:"width .15s linear"},b.progressBar]}}});
define("lw",["require","exports","lC","r","zO","jr","ks","jm","_s","C1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemCancelProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){return"started"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(i.cancelProgressItems({items:s.makeObject(a,function(){return{}})}));return[2]})})},isAvailable:a.length>0})});t.CancelProgressAction=a.withSelectedItems()(t.ItemCancelProgressAction)});
define("zO",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelProgressItemsOperation=new n.Facet("cancelProgressItemsOperation");t.cancelProgressItems=r.implementOperation({operationTypeFacet:t.cancelProgressItemsOperation})});
define("dw",["require","exports","lC","r","jr","ks","jm","Jf","_s","C1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemExpireProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){var n=e.demandItemFacet(u.isGroupFacet,t),r=o.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase;return n&&"failed"===r}),f=e.dispatch;return r.createElement(s.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(o.expireProgressItems({items:i.makeObject(a,function(){return!0})}));return[2]})})},isAvailable:a.length>0})});t.ExpireProgressAction=a.withSelectedItems()(t.ItemExpireProgressAction)});
define("iw",["require","exports","r","am","ow","Hn","wm","SPListItemsScopeDeferred_IS_mini_css","C1"],function(e,t,n,r,i,s,o,u,a){"use strict";u=u.CommandButton_8;Object.defineProperty(t,"__esModule",{value:!0});t.ActionCommandButtonStrip=a.createItemCacheComponent(function(e,t){var f=t.commands;return a.evaluateItemCacheComponent(e,n.createElement(o.CommandSet,{commands:f},function(e){var t=e.menuItems;return n.createElement(i.LayoutGroup,{direction:"horizontal"},t.map(function(e){var t=e.onClick,i=t?function(){t()}:void 0,o=e.commandBarButtonAs,a=o?s.composeComponentAs(o,r.DefaultButton):r.DefaultButton;return n.createElement(a,{className:u.commandButton,key:e.key,onClick:i},e.name)}))}))})});
define("ow",["require","exports","lC","sw"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("sw",["require","exports","lC","cw"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("cw",["require","exports","lC","r","oc","us"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._getJustify=function(e){return"end"===e?"flex-end":"center"===e?"center":"flex-start"};return t}t.prototype.render=function(){var e=this.props,t=e.children,o=e.direction,u=e.layoutGap,a=e.justify,f=s.getNativeProps(this.props,s.divProperties),l=r.Children.count(t),c=r.Children.map(t,function(e,t){var n=t===l-1;return r.createElement("div",{className:i.mergeStyles("ms-LayoutGroup-item","horizontal"===o&&!n&&{marginRight:u+"px"},"vertical"===o&&!n&&{marginBottom:u+"px"},"fill"===a&&{flexBasis:"0",flexGrow:1})},e)});return r.createElement("div",n.__assign({},f,{className:i.mergeStyles("ms-LayoutGroup",{display:"flex",flexDirection:"horizontal"===o?"row":"column",justifyContent:this._getJustify(a)})}),c)};t.defaultProps={layoutGap:8,direction:"vertical",justify:"start"};return t})(r.Component);t.LayoutGroup=o});
define("tw",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressListGroupControl=new n.ControlFacet("progressListGroupControl",{});t.progressListControl=new n.ControlFacet("progressListControl",{groupControlHandler:n.childControlOption(t.progressListGroupControl)})});
define("ZC",["require","exports","r"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CONTEXT=n.createContext(void 0);t.SET_SIZE_CONTEXT=n.createContext(0)});
define("$O",["require","exports","Dr","ec"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressPanelControl=new n.ControlFacet("progressPanelControl",{panelAs:r.defaultRenderComponentOption()})});
define("XO",["require","exports","lC","r","_s","C1","QO","d0","cg","og","Zb","Jb","Bb","Pb","Cb","Vs","Pp","hs","sb","db","Lr"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=[a.newCommand,f.openCommand,l.uploadCommand,c.shareCommand,c.copyLinkCommand,y.followCommand,h.downloadCommand,d.deleteCommand,p.renameCommand],S=v.createTelemetryProvider({withContext:{component:"ContextMenu"}});t.ItemsContextMenu=m.wrapWithParent(S)(s.createItemCacheComponent(function(e,t){t.isOpen&&w.mark("ItemsContextMenu.render");var s=g.getCurrentItemKey(e),a=i.getCurrentItemSetKey(e),f=t.commands,l=void 0===f?[]:f,c=e.demandItemFacet(u.itemsContextMenuControl,s),h=u.itemsContextMenuControl.evaluate(c)(e,{itemKey:s||"",itemSetKey:a,commands:E,preserveIcons:t.preserveIcons}),p=h.commands,d=h.onMenuOpened,v=h.contextMenuAs,m=h.preserveIcons;return r.createElement(o.ActionContextMenu,n.__assign({},t,{commands:b.concat(p,l),onMenuOpened:d,contextMenuAs:v,preserveIcons:m}))}));t.ItemsContextMenu.displayName="ItemsContextMenu"});
define("QO",["require","exports","lC","r","sf","wm","db","YO","C1","Hn"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NO_ITEMS=[];t.ActionContextMenu=a.createItemCacheComponent(function(e,a){var l=a.items,c=void 0===l?t.NO_ITEMS:l,h=a.directionalHint,p=void 0===h?i.DirectionalHint.rightTopEdge:h,d=a.isBeakVisible,v=void 0!==d&&d,m=a.isOpen,g=a.contextMenuAs,y=n.__rest(a,["items","directionalHint","isBeakVisible","isOpen","contextMenuAs"]),b=g?f.composeComponentAs(g,i.ContextualMenu):i.ContextualMenu;return r.createElement(s.CommandSet,{commands:a.commands},function(e){var t=e.menuItems,i=o.concat(c,u.cleanContextMenuItems(t,a));return m?r.createElement(b,n.__assign({},y,{items:i,directionalHint:p,isBeakVisible:v})):null})})});
define("db",["require","exports","lC"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EMPTY_ARRAY=[];function r(e,t){return e.indexOf(t)>-1?e:n.__spreadArrays(e,[t])}t.add=r;t.remove=function(e,t){return i(e,t)||[]};t.addOrCreate=function(e,t){return e?r(e,t):[t]};function i(e,t){var r=e.indexOf(t);return r>-1?1===e.length?void 0:n.__spreadArrays(e.slice(0,r),e.slice(r+1)):e}t.removeOrDelete=i;t.concat=function(e,r){return e.length>0&&r.length>0?n.__spreadArrays(e,r):e.length>0?e:r.length>0?r:t.EMPTY_ARRAY};t.findMatch=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return{value:r,index:n}}}});
define("YO",["require","exports","lC","JO"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cleanContextMenuItems=function e(t,i){var s=i.target,o=i.preserveIcons,u=void 0!==o&&o;return t.map(function(t){var o=t.subMenuProps,a=t.onClick,f=t.hasLaunchTarget,l=n.__rest(t,["subMenuProps","onClick","hasLaunchTarget"]);return n.__assign(n.__assign({},l),{name:t.iconProps&&"More"===t.iconProps.iconName?r.default.More:t.name,icon:void 0,iconProps:u?t.iconProps:void 0,subMenuProps:o?n.__assign(n.__assign({},o),{items:e(o.items,i)}):void 0,onClick:f&&a?function(e){e&&s&&(s instanceof Event?e.target=s.target:s instanceof Element&&(e.target=s));a(e)}:a})})}});
define("Pb",["require","exports","r","Ub","Or","pb","es","Tb"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameCommand={key:u.renameCommandKey,automationId:"renameCommand",name:i.default.Rename,ariaLabel:i.default.Rename,action:n.createElement(s.ShowOnlyWithSelection,null,n.createElement(r.RenameAction,null)),iconProps:{iconName:"rename"},shortcutProps:{content:o.default.renameDesc,keySequences:["F2"]}}});
define("Ub",["require","exports","lC","Fb","tv","ho","C1"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["nE"],t,n)})];case 1:return[2,t.sent().RenameWizard]}})})}),a=s.createAsyncActionCreator(function(t){return function(r){return n.__awaiter(void 0,void 0,void 0,function(){var i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["nE"],t,n)})];case 1:i=n.sent().renameItemWithProgress;return[4,r(i(t))];case 2:return[2,n.sent()]}})})}});function f(){return{renameWizard:u,renameItem:a}}t.ItemRenameAction=o.connectToItemCache(f)(r.ItemRenameAction);t.RenameAction=o.connectToItemCache(f)(r.RenameAction)});
define("Fb",["require","exports","lC","r","Nb","_s","Rb","Rs","Es","C1","Ps","ks","Hb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRenameAction=f.createItemCacheComponent(function(e,t){var s=t.itemKey,f=t.renameWizard,p=t.renameItem,d=void 0===p?i.renameItem:p;if(!s)return null;var v,m=!e.demandItemFacet(u.malwareDetectedFacet,s),g=e.demandItemFacet(u.fileNameFacet,s),y=g&&g.name||"",b=e.demandItemFacet(o.renameActionControl,s),w=o.renameActionControl.evaluate(b)(e,{itemKey:s,isAvailable:!1,renameWizard:f}),E=w.isAvailable,S=w.renameWizard,x=w.validator,T=w.lockedWarningMessage,N=w.title,C=w.isFolder;E||(m=!1);v=S;var k=e.dispatch,L=C?h.default.folderNameLabel:h.default.fileNameLabel,A=function(e){var t=e.name;return n.__awaiter(void 0,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,k(d({items:(e={},e[s]={names:(r={},r[y]={newName:t},r)},e)}))];case 1:n.sent();return[2]}})})},O=l.renderComponentOnExecute(function(e){return r.createElement(v,n.__assign({},e,{isAvailable:m&&!!s&&!!g,itemKey:s,onRename:A,oldName:y,lockedWarningMessage:T,fileExtensionText:g&&g.extension,title:N,validator:x,nameFieldAriaLabel:L}))});return r.createElement(c.Action,n.__assign({isAvailable:m,onExecute:O},a.getItemActionEngagement(e,{itemKey:s,engagement:{name:"Rename",isIntentional:!0,privacyClassification:"requiredService"}})))});t.RenameAction=s.withSelectedItems()(s.withExactlyOneItem()(t.ItemRenameAction))});
define("Tb",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameCommandKey=n.getNextId("rename")});
define("sb",["require","exports","lC","r","Am","Or","cb"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){return e?s.default.RemoveFromSaved:s.default.SaveForLater};t.followCommand={key:o.followCommandKey,automationId:"followCommand",action:r.createElement(i.FollowAction,null),name:s.default.SaveForLater,postProcess:function(e){return n.__assign(n.__assign({},e),{name:e.iconOnly?void 0:u(e.actionState.isToggled)})},commandBarButtonAs:function(e){var t=e.defaultRender,i=e.actionState&&e.actionState.isToggled,s="boolean"==typeof i&&u(i)||void 0;return t?r.createElement(t,n.__assign({},e,{iconProps:{iconName:i?"SingleBookmarkSolid":"SingleBookmark"},name:e.iconOnly?void 0:s,text:e.iconOnly?void 0:s,title:s,ariaLabel:s})):null}}});
define("cb",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.followCommandKey=n.getNextId("follow")});
define("EO",["require","exports","lC","r","To","qO","kO","AO","Fo","Er","k1"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Uploader=function(e){var t=this,c=e.resolve,h=e.reject,p=e.entries,d=e.itemKey,v=e.onUploadStarted,m=e.onUploadCompleted,g=e.onUploadFailed,y=e.onItemQueued,b=e.onItemUploaded,w=e.onItemFailed,E=r.useState(!1),S=E[0],x=E[1],T=r.useState(!1),N=T[0],C=T[1],k=r.useState(),L=k[0],A=k[1],O=r.useState(!1),M=O[0],_=O[1],D=r.useRef(),P=D.current||(D.current=new i.CancelSource);r.useLayoutEffect(function(){return function(){P.dispose();D.current=void 0}},[]);var H=a.usePreviousValue(N),B=a.usePreviousValue(L),j=a.usePreviousValue(M),F=l.useItemCacheDispatch(),I=f.useEventHandler(function(e){v&&v(e)}),q=f.useEventHandler(function(e){m&&m(e)}),R=f.useEventHandler(function(e){g&&g(e)}),U=f.useEventHandler(function(e){y&&y(e)}),z=f.useEventHandler(function(e){b&&b(e)}),W=f.useEventHandler(function(e){w&&w(e)}),X=f.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:x(!0);n.label=1;case 1:n.trys.push([1,3,,4]);F(o.uploadProgressAddon);e=F(u.createEntryBatch({entries:p})).itemKey;return[4,F(s.uploadEntryBatch({parentItemKey:d,sourceEntryKey:e,callbacks:{onEntryBatchCreated:I,onEntryBatchFailed:R,onEntryBatchUploaded:q,onItemFailed:W,onItemUploaded:z,onItemQueued:U},cancelToken:P.token}))];case 2:n.sent();if(P.token.isCanceled())return[2];_(!0);return[3,4];case 3:t=n.sent();if(P.token.isCanceled())return[2];i.isCancel(t)?C(!0):A(t);return[3,4];case 4:return[2]}})})});r.useLayoutEffect(function(){M&&!j?c():L&&!B?h(L):N&&!H?h(new i.CancelError):S||X()},[S,N,L,M]);return null}});
define("qO",["require","exports","lC","YD","JD","Xo","ho","Rs","YS","XS","Gm","ko","jm","$1","qr","si","Jf","To","Po","rs","LO","wo","UO","vo","Rm","PO","As","Ms","N1","Vm"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var O=0;var M=function(){},_={onItemQueued:M,onItemUploaded:M,onItemFailed:M,onEntryBatchCreated:M,onEntryBatchUploaded:M,onEntryBatchFailed:M};t.uploadEntryBatch=function e(t){var r=this,i=t.parentItemKey,s=t.sourceEntryKey,o=t.callbacks,u=void 0===o?_:o,a=t.options,f=void 0===a?{}:a;return function(o){return n.__awaiter(r,void 0,void 0,function(){var r,a,l,c,p,d;return n.__generator(this,function(n){switch(n.label){case 0:o(h.progressAddon);r=++O;a={operation:e};o(x.registerItemDemands({owner:a,items:(d={},d[s]={},d)}));l=new g.CancelSource;t.cancelToken&&t.cancelToken.subscribe(l.cancel);return[4,o(H({sourceEntryKey:s}))];case 1:c=n.sent();return[4,o(c({parentItemKey:i,cancelToken:l.token,callbacks:u,options:f,uploadId:r}))];case 2:p=n.sent().completed;n.label=3;case 3:n.trys.push([3,,5,6]);return[4,p];case 4:n.sent();return[3,6];case 5:l.dispose();o(x.removeItemDemands({owner:a}));return[7];case 6:return[2]}})})}};function D(e){var t=this,r=e.sourceEntryKey,i=e.cancelToken,o=e.onReceiveChildUploader,u=S.getUploadProgressKey(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,f,l=this;return n.__generator(this,function(c){switch(c.label){case 0:t={operation:D};e(x.registerItemDemands({owner:t,items:(a={},a[u]={},a)}));c.label=1;case 1:c.trys.push([1,,3,4]);e(p.resolveItems({items:(f={},f[u]=n.__assign({},s.childItemsFacet.pack({itemKeys:[]})),f)}));return[4,e(P({itemKey:r,cancelToken:i,onReceiveChildKeys:function(t){return n.__awaiter(l,void 0,void 0,function(){var r,a,f,l,c,h,p=this;return n.__generator(this,function(m){switch(m.label){case 0:i.throwIfCanceled();r=new A.ItemResolver;for(a=0,f=t;a<f.length;a++){l=f[a];c=S.getUploadProgressKey(l);r.resolveItems({items:(h={},h[c]=n.__assign({},s.parentItemFacet.pack({itemKey:u})),h[u]=v.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new d.ArrayConcatIfNotMatchKeyPatch([c],function(e){return e})}}),h)})}e(r.execute());return[4,y.waitForAll(t.map(function(t){return n.__awaiter(p,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:r=o;return[4,e(H({sourceEntryKey:t}))];case 1:r.apply(void 0,[n.sent()]);return[2]}})})}))];case 1:m.sent();return[2]}})})}}))];case 2:c.sent();return[3,4];case 3:e(x.removeItemDemands({owner:t}));return[7];case 4:return[2]}})})}}function P(e){var t=this,o=e.itemKey,u=e.cancelToken,a=e.onReceiveChildKeys;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,l=this;return n.__generator(this,function(c){switch(c.label){case 0:t={};return[4,e(r.demandItems(function(e){var t=e.demandItemFacet(s.defaultChildItemSetFacet,o);return t&&t.itemKey}))];case 1:return(f=c.sent())?[4,e(i.observeItemsUntilResolved(function(e){u&&u.throwIfCanceled();var t=e.demandItemFacet(s.childItemsFacet,f),n=[];if(t)for(var r=0,i=t.itemKeys;r<i.length;r++){var o=i[r];e.isItemFacetResolved(s.pageFacet,o)?e.demandItemFacet(s.childItemsFacet,o):n.push(o)}return n},function(e){return n.__awaiter(l,void 0,void 0,function(){var r,i,s,o;return n.__generator(this,function(n){switch(n.label){case 0:r=[];for(i=0,s=e;i<s.length;i++)if(!((o=s[i])in t)){r.push(o);t[o]=!0}return[4,a(r)];case 1:n.sent();return[2]}})})}))]:[2];case 2:c.sent();return[2]}})})}}function H(e){var t=this,i=e.sourceEntryKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(r.demandItems(function(e){return e.demandItemFacet(w.entryBatchFacet,i)}))];case 1:return t.sent()?[2,B(i)]:[4,e(r.demandItems(function(e){return e.demandItemFacet(u.folderFacet,i)}))];case 2:return t.sent()?[2,j(i)]:[2,F(i)]}})})}}function B(e){var t=this;return o.createAsyncActionCreator(function(r){var i=r.parentItemKey,o=r.callbacks,u=r.options,a=r.uploadId,f=S.getUploadProgressKey(e);return function(c){var b,w,E=new g.CancelSource;r.cancelToken.subscribe(E.cancel);var S={operation:B};c(x.registerItemDemands({owner:{},items:(b={},b[f]={},b)}));c(p.resolveItems({items:(w={},w[h.progressRootItemKey]=v.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new d.ArrayConcatIfNotMatchKeyPatch([f],function(e){return e})}}),w[f]=n.__assign(n.__assign(n.__assign(n.__assign({},m.isGroupFacet.pack(!0)),l.cancelSourceFacet.pack(E)),l.sourceItemFacet.pack({itemKey:e})),l.destinationItemFacet.pack({itemKey:i})),w)}));var T=n.__awaiter(t,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:t=[];r=[];return[4,c(D({sourceEntryKey:e,cancelToken:E.token,onReceiveChildUploader:function(e){E.token.throwIfCanceled();var n=c(e({parentItemKey:i,cancelToken:E.token,callbacks:o,options:u,uploadId:a})),s=n.started,f=n.completed;t.push(s);r.push(f)}}))];case 1:n.sent();return[2,{startedWork:t,completedWork:r}]}})}),N=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=Promise).race;return[4,T];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:n.sent();return[2]}})}),C=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=y.waitForAll;return[4,T];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:t.sent();return[2]}})}),k=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e=c(I({uploadProgressKey:f,uploadId:a,qosName:"Uploader.uploadBatch"}));o.onEntryBatchCreated({progressItemKey:f});n.label=1;case 1:n.trys.push([1,,3,4]);return[4,c(h.trackItemProgress({progressItemKey:f,started:N,completed:C,onStarted:function(e){},onCompleted:function(t){o.onEntryBatchUploaded({progressItemKey:f});c(e({error:t.error}))},onFailed:function(t){o.onEntryBatchFailed({error:t.error||new Error("No error reported from batch upload."),progressItemKey:f});c(e({error:t.error}))}}))];case 2:n.sent();return[3,4];case 3:c(p.resolveItems({items:(t={},t[f]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),t)}));c(x.removeItemDemands({owner:S}));return[7];case 4:return[2]}})});return{started:N,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([C,k])];case 1:e.sent();return[2]}})})}}})}function j(e){var t=this;return o.createAsyncActionCreator(function(i){var s=i.parentItemKey,o=i.callbacks,a=i.options,w=i.uploadId,T=S.getUploadProgressKey(e);return function(N){var C,k,L=new g.CancelSource;i.cancelToken.subscribe(L.cancel);var O={operation:j};N(x.registerItemDemands({owner:O,items:(C={},C[T]={},C[e]={},C)}));N(p.resolveItems({items:(k={},k[T]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},E.errorFacet.pack(void 0)),l.progressPhaseFacet.pack(l.ProgressPhase.created)),m.isGroupFacet.pack(!0)),l.destinationItemFacet.pack({itemKey:s})),l.sourceItemFacet.pack({itemKey:e})),l.cancelSourceFacet.pack(L)),k)}));var M=N((function(e){var t=this;return function(i){var s=e.sourceEntryKey,o=e.parentItemKey,a=e.cancelToken,h=S.getUploadProgressKey(s),d=n.__awaiter(t,void 0,void 0,function(){var e,t,d,v,m,g,y,w,E,S=this;return n.__generator(this,function(x){switch(x.label){case 0:return[4,i(r.demandItems(function(e){return e.demandItemFacet(u.fileNameFacet,s)}))];case 1:if(!(e=x.sent()))throw new Error("Invalid folder name.");t={folders:(y={},y[e.name]={progressItemKey:h},y)};i(p.resolveItems({items:(w={},w[h]=n.__assign({},f.createFolderOperation.pack(t)),w)}));d=i(c.startOperation({operationTypeFacet:f.createFolderOperation,items:(E={},E[o]=t,E)})),v=d.started,m=d.completed;g=a.subscribe(function(){var e;i(c.cancelOperation({operationTypeFacet:f.createFolderOperation,items:(e={},e[o]=t,e)}))});n.__awaiter(S,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,v];case 1:e.sent();g();return[2]}})});return[2,{started:v,itemCreated:n.__awaiter(S,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,m];case 1:n.sent();e=i(b.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,h)}));if(!(t=e&&e.itemKey))throw new Error("No folder created.");return[2,t]}})})}]}})});return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,d];case 1:return[4,e.sent().started];case 2:e.sent();return[2]}})}),itemCreated:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,d];case 1:return[4,e.sent().itemCreated];case 2:return[2,e.sent()]}})})}}})({sourceEntryKey:e,parentItemKey:s,cancelToken:L.token})),_=M.started,P=M.itemCreated,H=n.__awaiter(t,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,P];case 1:t=n.sent();r=[_];i=[];return[4,N(D({sourceEntryKey:e,cancelToken:L.token,onReceiveChildUploader:function(e){var n=N(e({parentItemKey:t,cancelToken:L.token,callbacks:o,options:a,uploadId:w})),s=n.started,u=n.completed;r.push(s);i.push(u)}}))];case 2:n.sent();return[2,{startedWork:r,completedWork:i}]}})}),B=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=Promise).race;return[4,H];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:n.sent();return[2]}})}),F=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=y.waitForAll;return[4,H];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:t.sent();return[2]}})}),q=n.__awaiter(t,void 0,void 0,function(){var e,t,r=this;return n.__generator(this,function(i){switch(i.label){case 0:e=N(I({uploadProgressKey:T,uploadId:w,qosName:"Uploader.createFolder"}));o.onItemQueued({progressItemKey:T});i.label=1;case 1:i.trys.push([1,,3,4]);return[4,N(h.trackItemProgress({progressItemKey:T,started:B,completed:n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,P];case 1:e.sent();return[2]}})}),onStarted:function(e,t){t&&t(e)},onCompleted:function(t,n){n&&n(t);o.onItemUploaded({progressItemKey:T});N(e({error:t.error}))},onFailed:function(t,n){n&&n(t);o.onItemFailed({progressItemKey:T});N(e({error:t.error}))}}))];case 2:i.sent();return[3,4];case 3:N(p.resolveItems({items:(t={},t[T]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),t)}));L.dispose();N(x.removeItemDemands({owner:O}));return[7];case 4:return[2]}})}),R=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=N(I({uploadProgressKey:T,uploadId:w,qosName:"Uploader.uploadFolder"}));return[4,N(h.trackItemProgress({progressItemKey:T,started:B,completed:F,onStarted:function(e,t){},onCompleted:function(t,r){var i,s=N(b.readItems(function(e){return{overallProgressCounts:e.demandItemFacet(l.overallProgressCountsFacet,T),overallProgressSize:e.demandItemFacet(l.overallProgressSizeFacet,T)}})),o=s.overallProgressCounts,u=s.overallProgressSize,a=new A.ItemResolver;a.resolveItems({items:(i={},i[T]=n.__assign(n.__assign({},l.progressCountsFacet.pack(o)),l.progressSizeFacet.pack(u)),i)});N(a.execute());N(e({error:t.error}))},onFailed:function(t,n){N(e({error:t.error}))}}))];case 1:t.sent();return[2]}})});return{started:B,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([F,q,R])];case 1:e.sent();return[2]}})})}}})}function F(e){var t=this;return o.createAsyncActionCreator(function(i){var s=i.parentItemKey,o=i.callbacks,f=i.options,w=i.uploadId,T=S.getUploadProgressKey(e);return function(N){var C,k,L=new g.CancelSource;i.cancelToken.subscribe(L.cancel);var A=N(I({uploadProgressKey:T,uploadId:w,qosName:"Uploader.uploadFile"}));if(N(b.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,T)})))return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})}),completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};var O={operation:F};N(x.registerItemDemands({owner:O,items:(C={},C[T]={},C[e]={},C)}));N(p.resolveItems({items:(k={},k[T]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},E.errorFacet.pack(void 0)),l.progressPhaseFacet.pack(l.ProgressPhase.created)),m.isGroupFacet.pack(!1)),l.destinationItemFacet.pack({itemKey:s})),l.sourceItemFacet.pack({itemKey:e})),l.cancelSourceFacet.pack(L)),k)}));var M=N((function(e){var t=this,i=e.sourceEntryKey,s=e.parentItemKey,o=e.cancelToken,f=e.options,h=S.getUploadProgressKey(i);return function(e){var d,v,m={sourceEntries:(d={},d[i]=n.__assign({progressItemKey:h},f),d)};e(p.resolveItems({items:(v={},v[h]=n.__assign({},a.uploadItemsOperation.pack(m)),v)}));var g=n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(r.demandItems(function(e){return{fileSize:e.demandItemFacet(u.fileSizeFacet,i),fileName:e.demandItemFacet(u.fileNameFacet,i)}}))];case 1:return[2,t.sent()]}})}),y=n.__awaiter(t,void 0,void 0,function(){var t,r,i,u,f,d,v,y=this;return n.__generator(this,function(b){switch(b.label){case 0:return[4,g];case 1:void 0!==(t=b.sent().fileSize)&&e(p.resolveItems({items:(d={},d[h]=n.__assign({},l.progressSizeFacet.pack({total:t,current:0})),d)}));r=e(c.startOperation({operationTypeFacet:a.uploadItemsOperation,items:(v={},v[s]=m,v)})),i=r.started,u=r.completed;f=o.subscribe(function(){var t;e(c.cancelOperation({operationTypeFacet:a.uploadItemsOperation,items:(t={},t[s]=m,t)}))});n.__awaiter(y,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,i];case 1:e.sent();f();return[2]}})});return[2,{started:i,completed:u}]}})});return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y];case 1:return[4,e.sent().started];case 2:e.sent();return[2]}})}),completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y];case 1:return[4,e.sent().completed];case 2:e.sent();return[2]}})})}}})({sourceEntryKey:e,parentItemKey:s,cancelToken:L.token,options:f})),_=M.started,D=M.completed,P=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:o.onItemQueued({progressItemKey:T});t.label=1;case 1:t.trys.push([1,,3,4]);return[4,N(h.trackItemProgress({progressItemKey:T,started:_,completed:D,onStarted:function(e,t){t&&t(e)},onCompleted:function(e,t){t&&t(e);o.onItemUploaded({progressItemKey:T});N(A({error:e.error}))},onFailed:function(e,t){t&&t(e);o.onItemFailed({progressItemKey:T});N(A({error:e.error}))}}))];case 2:t.sent();return[3,4];case 3:N(p.resolveItems({items:(e={},e[T]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),e)}));L.dispose();N(x.removeItemDemands({owner:O}));return[7];case 4:return[2]}})});return{started:_,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([D,P])];case 1:e.sent();return[2]}})})}}})}function I(e){var t=e.qosName,r=e.uploadProgressKey,i=e.uploadId;return function(e){var s=e(T.logQoS({name:t}));return function(t){var o=t.error;return function(){var t=e(b.readItems(function(e){var t=e.demandItemFacet(l.sourceItemFacet,r),n=t&&t.itemKey,i=e.demandItemFacet(u.folderFacet,n),s=e.demandItemFacet(w.entryBatchFacet,n);return{entryBatch:s,folder:i,fileName:e.demandItemFacet(u.fileNameFacet,n),uploadStats:i||s?e.demandItemFacet(N.uploadStatsProgressFacet,r):void 0,progressSize:e.demandItemFacet(N.overallUploadProgressSizeFacet,r)}})),a=t.entryBatch,f=t.folder,c=t.fileName,h=t.uploadStats,p=t.progressSize,d=C.getTelemetrySafeFileExtension(c&&c.extension),v=a?"Batch":f?"Folder":"File",m=p?p.total:0,g=p?p.current:0;e(s(L.mergeQosEndSchema(k.getQosEndSchemaFromError(o),{extraData:n.__assign(n.__assign({uploadId:i,totalBytes:m,uploadedBytes:g,objectType:v},a?{}:{extension:d}),h?{"count.file.started":h.file.started,"count.file.completed":h.file.completed,"count.file.failed":h.file.failed,"count.file.canceled":h.file.canceled,"count.folder.started":h.folder.started,"count.folder.completed":h.folder.completed,"count.folder.failed":h.folder.failed,"count.folder.canceled":h.folder.canceled}:{})})))}}}}});
define("PO",["require","exports","lC","Gm","Xo","Rs","do","LO"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadStatsProgressFacet=new o.ComputedItemFacet("uploadStats",function(e,n){var o,c={file:a(),folder:a(),extensions:{}},h=e.demandItemFacet(i.childItemsFacet,n.itemKey);if(h)for(var p=0,d=h.itemKeys;p<d.length;p++){var v=d[p],m=e.demandItemFacet(t.uploadStatsProgressFacet,v);if(m){f(c.file,m.file);f(c.folder,m.folder);l(c.extensions,m.extensions)}}var g=e.demandItemFacet(r.sourceItemFacet,n.itemKey),y=g&&g.itemKey;if(y){var b=e.demandItemFacet(s.folderFacet,y),w=e.demandItemFacet(r.progressPhaseFacet,n.itemKey),E=r.getSimpleProgessPhase(w||r.ProgressPhase.expired),S=r.getItemCountsBySimpleProgressPhase(E);if(e.demandItemFacet(u.entryBatchFacet,y));else if(b)f(c.folder,S);else{f(c.file,S);var x=e.demandItemFacet(s.fileNameFacet,y),T=x&&x.extension||"unknown";l(c.extensions,((o={})[T]=S,o))}}return c});t.overallUploadProgressSizeFacet=new o.ComputedItemFacet("overallUploadProgressSize",function(e,n){var o=e.demandItemFacet(r.progressSizeFacet,n.itemKey);if(o)return o;var u=e.demandItemFacet(i.childItemsFacet,n.itemKey);if(u){for(var a={total:0,current:0},f=0,l=u.itemKeys;f<l.length;f++){var c=l[f],h=e.demandItemFacet(t.overallUploadProgressSizeFacet,c);if(!h)return;a.total+=h.total;a.current+=h.current}return a}var p=e.demandItemFacet(r.sourceItemFacet,n.itemKey);if(p){var d=e.demandItemFacet(s.fileSizeFacet,p.itemKey);if("number"!=typeof d)return;return{total:d,current:e.demandItemFacet(r.createdItemFacet,n.itemKey)?d:0}}});function a(e){var t={started:0,completed:0,canceled:0,failed:0};if(e){t.started+=e.started;t.completed+=e.completed;t.failed+=e.failed;t.canceled+=e.canceled}return t}function f(e,t){e.started+=t.started;e.completed+=t.completed;e.failed+=t.failed;e.canceled+=t.canceled}function l(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var s=i[r],o=t[s];s in e?f(e[s],o):e[s]=n.__assign({},o)}}});
define("kO",["require","exports","lC","r","Hm","ko","ih","Fm","me","WO","Sb","Op","jm","Gm","Rs","LO","rs","GO","zO","jO","BO","NO","HO","FO","si","S0","wo","UO","qO","TO","So","A1","PO","MO","L1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){"use strict";var H,B;Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressKeyFacet=k.uploadProgressKeyFacet;t.getUploadProgressKey=k.getUploadProgressKey;var j=((H={})[p.ProgressPhase.started]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadStartedItemsTitle,f.default.uploadCompletedItemsTitleIntervals,t)||"",t)},H[p.ProgressPhase.completed]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadCompletedItemsTitle,f.default.uploadCompletedItemsTitleIntervals,t)||"",t)},H[p.ProgressPhase.failed]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsTitle,f.default.uploadFailedItemsTitleIntervals,t)||"",t)},H[p.ProgressPhase.canceled]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsTitle,f.default.uploadFailedItemsTitleIntervals,t)||"",t)},H),F=((B={})[p.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadStartedItemsDestinationTitle,f.default.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(g.ItemLink,{key:"link",itemKey:n}))},B[p.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadCompletedItemsDestinationTitle,f.default.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(g.ItemLink,{key:"link",itemKey:n}))},B[p.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsDestinationTitle,f.default.uploadFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(g.ItemLink,{key:"link",itemKey:n}))},B[p.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsDestinationTitle,f.default.uploadFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(g.ItemLink,{key:"link",itemKey:n}))},B);t.uploadProgressAddon=i.createAddon(function(){return function(e){e(o.registerControlHandler(k.uploadProgressKeyFacet,u.progressControl)(o.createControlHandler()(I)));e(i.registerOperationHandler(k.uploadProgressKeyFacet,y.cancelProgressItemsOperation)(D.createCancelProgressItemsOperationHandler(k.uploadProgressKeyFacet)));e(i.registerOperationHandler(k.uploadProgressKeyFacet,w.retryProgressItemsOperation)(i.createSingleItemOperationHandler()(R)));e(i.registerOperationHandler(k.uploadProgressKeyFacet,x.resolveProgressItemsOperation)(i.createSingleItemOperationHandler()(U)))}});function I(){return function(e){return q}}function q(e,t){var r,i=e.demandItemFacet(p.sourceItemFacet,t.itemKey),o=e.demandItemFacet(v.entryBatchFacet,i&&i.itemKey);r=i&&!o?(function(e,t){var r,i=M.getConfiguration(e,{enableNewConflictUploadErrorStrings:O.enableNewConflictUploadErrorStringsConfigurationFacet}).enableNewConflictUploadErrorStrings,o=e.demandItemFacet(_.overallUploadProgressSizeFacet,t.itemKey),u=o?o.total>0?o.current/o.total:1:void 0,a=h.getOverallProgressPhase(e,t),v=e.demandItemFacet(d.folderFacet,t.sourceItemKey);a===p.ProgressPhase.completed&&o?r=c.default.getDisplayString(o.total):v?a!==p.ProgressPhase.created&&a!==p.ProgressPhase.started||(r=z(o)||l.default.genericStartedIndeterminateDescription):a===p.ProgressPhase.started?r=z(o):a===p.ProgressPhase.created&&(r=l.default.genericCreatedDescription);var m,g=e.demandItemFacet(C.errorFacet,t.itemKey),y=[];if(g)if(g instanceof s.ItemOperationError){var w=T.unpack({conflict:N.conflictErrorFacet,retry:N.retryErrorFacet,offline:N.offlineErrorFacet,accessDenied:N.accessDeniedErrorFacet,invalidName:N.invalidNameErrorFacet,emptyFolder:N.emptyFolderUnsupportedFacet,overQuota:N.overQuotaErrorFacet,lockMismatch:N.lockMismatchErrorFacet,authFailure:N.authFailureErrorFacet,folderUpload:N.folderUploadUnsupportedFacet,targetFolder:N.targetFolderErrorFacet,malware:N.malwareErrorFacet,throttle:N.throttleErrorFacet},g.facets),x=w.conflict,k=w.retry,L=w.offline,D=w.accessDenied,P=w.invalidName,H=w.emptyFolder,B=w.overQuota,j=w.lockMismatch,F=w.authFailure,I=w.folderUpload,q=w.targetFolder,R=w.malware,U=w.throttle;if(x){r=i?f.default.newConflictUploadWithoutRenameErrorText:f.default.conflictUploadWithoutRenameErrorText;y.push(i?E.addNewVersionProgressCommand:E.replaceProgressCommand);if(x.supportsRename){r=i?f.default.newConflictUploadErrorText:f.default.conflictUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"conflict+rename"});y.push(S.renameProgressCommand)}else m=A.uploadProgressErrorKeyFacet.serialize({type:"conflict"})}else if(D){r=f.default.accessDeniedUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"accessDenied"})}else if(P){r=f.default.invalidNameUploadErrorText;y.push(S.renameProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"invalidName"})}else if(H||I){r=f.default.folderUploadNotSupported;m=A.uploadProgressErrorKeyFacet.serialize({type:"folderUpload"})}else if(B){r=f.default.overQuotaSharedFolderUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"overQuota"})}else if(j){r=f.default.lockMismatchUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"lockMismatch"})}else if(F){r=f.default.authFailureUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"authFailure"})}else if(q){r=f.default.targetFolderMissingUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"targetFolder"})}else if(R){r=f.default.malwareDetectedUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"malware"})}else if(U){r=f.default.throttledUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"throttle"})}else if(L){r=f.default.disconnectedUploadText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"offline"})}else if(!k){r=g.message||f.default.generalUploadNoRetryErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"noRetry"})}if(k){r=f.default.generalUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"retry"})}}else{r=g.message||f.default.generalUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"unknown"})}return n.__assign(n.__assign(n.__assign({percentComplete:u},m?{errorKey:m}:{}),r?{description:r}:{}),{commands:y})})(e,{itemKey:t.itemKey,sourceItemKey:i.itemKey}):(function(e,t){var r,i,s=e.demandItemFacet(_.overallUploadProgressSizeFacet,t.itemKey),o=s?s.total>0?s.current/s.total:1:void 0,u=e.demandItemFacet(p.destinationItemFacet,t.itemKey),a=u&&u.itemKey,f=h.getOverallSimpleProgressBreakdown(e,t),d=f.phase,v=f.count;d===p.ProgressPhase.completed&&s?r=c.default.getDisplayString(s.total):d===p.ProgressPhase.started&&(r=z(s)||l.default.genericStartedIndeterminateDescription);i="group"===t.format&&a?F[d]({count:v,itemKey:a}):j[d]({count:v});return n.__assign(n.__assign(n.__assign({},i&&"item"!==t.format?{title:i}:{}),r?{description:r}:{}),{percentComplete:o})})(e,t);var u=e.demandItemFacet(P.uploadProgressControl,t.itemKey),a=P.uploadProgressControl.evaluate(u)(e,{itemKey:t.itemKey,commands:r.commands,description:r.description}),m=a.description,g=a.commands,y=void 0===g?[]:g;return n.__assign(n.__assign(n.__assign({},r),{commands:y}),m?{description:m}:{})}function R(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u;return n.__generator(this,function(n){switch(n.label){case 0:t=e(m.readItems(function(e){return{sourceItem:e.demandItemFacet(p.sourceItemFacet,r),destinationItem:e.demandItemFacet(p.destinationItemFacet,r)}})),i=t.sourceItem,s=t.destinationItem;o=i&&i.itemKey;u=s&&s.itemKey;if(!o)throw new Error("No source entry to retry.");if(!u)throw new Error("No parent item to retry.");return[4,e(L.uploadEntryBatch({sourceEntryKey:o,parentItemKey:u}))];case 1:n.sent();return[2]}})})}}function U(e){var t=this,r=e.itemKey,i=e.options;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o,u,a;return n.__generator(this,function(n){switch(n.label){case 0:t=e(m.readItems(function(e){return{sourceItem:e.demandItemFacet(p.sourceItemFacet,r),destinationItem:e.demandItemFacet(p.destinationItemFacet,r)}})),s=t.sourceItem,o=t.destinationItem;u=s&&s.itemKey;a=o&&o.itemKey;if(!u)throw new Error("No source entry to retry.");if(!a)throw new Error("No parent item to retry.");return[4,e(L.uploadEntryBatch({sourceEntryKey:u,parentItemKey:a,options:i}))];case 1:n.sent();return[2]}})})}}function z(e){return e&&e.total>0?a.format(l.default.genericStartedByteProgressDescription,c.default.getDisplayString(e.current),c.default.getDisplayString(e.total)):void 0}});
define("jO",["require","exports","r","VO","si","Sb"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryProgressCommand={key:new i.Facet("retryProgressCommand").id,name:s.default.progressRetryActionText,action:n.createElement(r.RetryProgressAction,null)}});
define("VO",["require","exports","lC","r","BO","jr","ks","jm","_s","C1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRetryProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(i.retryProgressItems({items:s.makeObject(a,function(){return{}})}));return[2]})})},isAvailable:a.length>0})});t.RetryProgressAction=a.withSelectedItems()(t.ItemRetryProgressAction)});
define("BO",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryProgressItemsOperation=new n.Facet("retryProgressItemsOperation");t.retryProgressItems=r.implementOperation({operationTypeFacet:t.retryProgressItemsOperation})});
define("NO",["require","exports","r","RO","si","Sb"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.replaceProgressCommand={key:new i.Facet("renameProgressCommand").id,name:s.default.progressReplaceActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"replace"})};t.addNewVersionProgressCommand={key:new i.Facet("addNewVersionProgressCommand").id,name:s.default.progressAddNewVersionActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"replace"})}});
define("RO",["require","exports","lC","r","FO","jr","ks","jm","_s","C1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemResolveProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys,f=t.conflictResolution,l=a.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),c=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){c(i.resolveProgressItems({items:s.makeObject(l,function(){return{conflictResolution:f}})}));return[2]})})},isAvailable:l.length>0})});t.ResolveProgressAction=a.withSelectedItems()(t.ItemResolveProgressAction)});
define("FO",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveProgressItemsOperation=new n.Facet("resolveProgressItemsOperation");t.resolveProgressItems=r.implementOperation({operationTypeFacet:t.resolveProgressItemsOperation})});
define("HO",["require","exports","r","RO","si","Sb"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameProgressCommand={key:new i.Facet("renameProgressCommand").id,name:s.default.progressRenameActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"rename"})}});
define("TO",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressErrorKeyFacet=new n.KeyFacet("uploadProgress",{type:n.stringPart()})});
define("MO",["require","exports","lC","Hm","rs","Vm","Gm","si","wo","qr","Xo"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createCancelProgressItemsOperationHandler=function(e){return r.createBatchedItemsOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,c,h;return n.__generator(this,function(p){t=r(i.readItems(function(t){var r=new s.ItemResolver,i=[];function c(e){var s,h=t.demandItemFacet(o.cancelSourceFacet,e);h&&i.push(h);r.resolveItems({items:(s={},s[e]=n.__assign(n.__assign({},h?{}:n.__assign({},o.progressPhaseFacet.pack(o.ProgressPhase.canceled))),u.pack({error:a.errorFacet},{error:new f.Delete})),s)});var p=t.demandItemFacet(l.childItemsFacet,e);if(p)for(var d=0,v=p.itemKeys;d<v.length;d++){c(v[d])}}for(var h in e.items)Object.prototype.hasOwnProperty.call(e.items,h)&&c(h);return{itemResolver:r,sourcesToCancel:i}}));r(t.itemResolver.execute());for(c=0,h=t.sourcesToCancel;c<h.length;c++)h[c].cancel();return[2]})})}})}});
define("nE",["require","exports","lC","iA","nA","tA","ZE","AE","fE","aE"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t)});
define("iA",["require","exports","lC","r","Ru","Hn","ju","SPListItemsScopeDeferred_IS_mini_css","jr","O1","tw","ew","Dm","Sb","jm","C1","Gm","k1","Er","Fo","rA"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";u=u.ProgressCallout_7;Object.defineProperty(t,"__esModule",{value:!0});function E(e){var t=r.useState(!0),i=t[0],s=t[1];r.useEffect(function(){var e=setTimeout(function(){s(!1)},0);return function(){clearTimeout(e)}},[]);return r.createElement(o.FocusTrapZone,n.__assign({},e,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disabled:i}),e.children)}function S(e){return r.createElement(r.Fragment,null,r.createElement("div",{className:u.progressList,role:"presentation"},r.createElement(f.ControlHandlerProvider,{controlHandlers:l.progressListControl.pack(x)},r.createElement(c.ProgressList,{itemKeys:e.itemKeys,role:"presentation"}))),e.showViewAll?r.createElement("div",{className:u.viewAllButton,role:"presentation"},r.createElement(h.ActionButton,{onClick:e.onViewAllClick},p.default.progressViewAllActionText)):null)}t.ProgressCallout=v.connectToItemCache(function(e,t){var n=t.finishedItemKeys.filter(function(t){var n=d.getOverallProgressPhase(e,{itemKey:t});return n===m.ProgressPhase.completed||n===m.ProgressPhase.canceled}),r=e.demandItemFacet(w.progressCalloutControl,d.progressRootItemKey);return{contentAs:w.progressCalloutControl.evaluate(r)(e,{contentAs:S}).contentAs,itemKeysToExpire:n}})(function(e){var t=e.isExecuting,n=e.finishedItemKeys,o=e.target,f=e.doNotExpire,l=e.onDismiss,c=e.onViewAll,h=e.itemKeysToExpire,p=r.useState(!0),v=p[0],m=p[1],w=g.useItemCacheDispatch(),x=r.useMemo(function(){return a.makeObject(n||[],function(){return!0})},[n]),T=b.usePreviousValue(x);r.useEffect(function(){if(!t){for(var e=T||{},r=!1,i=0,s=n;i<s.length;i++){s[i]in e||(r=!0)}r&&m(!1)}},[t,n]);var N=r.useMemo(function(){return n.slice(-1)},[n]),C=b.usePreviousValue(N);r.useEffect(function(){if(C){var e=C[0];e&&(e in x||m(!0))}},[x]);r.useEffect(function(){if(v){f||w(d.expireProgressItems({items:a.makeObject(h,function(){return!0})}));l()}},[v,l]);var k=y.useEventHandler(function(e){e&&e.stopPropagation();c&&c(e)}),L=function(){m(!0)};if(t||v||!n.length)return null;var A=e.contentAs!==S?s.composeComponentAs(e.contentAs,S):S;return r.createElement(i.Callout,{target:o,role:"alert","aria-live":"assertive",directionalHint:i.DirectionalHint.bottomCenter,onDismiss:L,isBeakVisible:!1},r.createElement(E,{className:u.callout,role:"presentation"},r.createElement(A,{itemKeys:N,onViewAllClick:k,onCalloutDismiss:L,showViewAll:n.length>1})))});function x(e,t){return{groupControlHandler:T}}function T(e,t){return(t.childItemKeys?t.childItemKeys.length:0)>3?{maxChildItemCount:0}:{}}});
define("nA",["require","exports","lC","r","To","gE","$E","aA","me","x_","Er"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateFolderWizard=function(e){var t=this,c=e.resolve,h=e.reject,p=e.onCreateFolder,d=e.maxLength,v=e.title,m=e.validator,g=r.useState(),y=g[0],b=g[1],w=l.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return p?[4,p(e)]:[3,2];case 1:t.sent();t.label=2;case 2:b(e.name);return[2]}})})}),E=l.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){h(new i.CancelError);return[2]})})});return y?r.createElement(f.Alert,{onStart:c},a.format(u.default.createFolderCompletedFormat,y)):r.createElement(s.NameDialog,{nameFieldAriaLabel:o.default.FolderNamePlaceholder,onContinue:w,onCancel:E,title:v||o.default.CreateFolder,maxLength:d,continueText:o.default.CreateCommit,name:"",placeHolder:o.default.FolderNamePlaceholder,validator:m})}});
define("gE",["require","exports","lC","r","Zd","kw","SE","am","SPListItemsScopeDeferred_IS_mini_css","vE"],function(e,t,n,r,i,s,o,u,a,f){"use strict";a=a.NameDialog_8;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onNameRef=function(e){r._textField=e;r._focusOnTextfield()};r._onNameChanged=function(e,t){void 0===t&&(t="");var n=r.props.validator;r.setState({name:t,errorMessage:n?n(t):void 0})};r._onClickAction=function(){return n.__awaiter(r,void 0,void 0,function(){var e,t,r=this;return n.__generator(this,function(n){switch(n.label){case 0:this.setState({showSpinner:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,this.props.onContinue({name:this.state.name})];case 2:n.sent();return[3,5];case 3:t=n.sent();e=t;this._isDisposed||this.setState({errorMessage:e&&e.message});return[3,5];case 4:this._isDisposed||this.setState({showSpinner:!1},function(){e&&r._focusOnTextfield()});return[7];case 5:return[2]}})})};r._onKeyPress=function(e){if(13===e.which){e.preventDefault();e.stopPropagation();r._onClickAction()}};r.state={name:r.props.name};return r}t.prototype.render=function(){var e=this.state,t=e.name,n=e.errorMessage,l=e.showSpinner,c=this.props,h=c.continueText,p=void 0===h?f.default.continue:h,d=c.cancelText,v=c.onCancel,m=c.placeHolder,g=c.maxLength,y=c.fileExtensionText,b=c.isMultiline,w=c.cols;return r.createElement(s.Dialog,{dialogContentProps:{type:s.DialogType.close},hidden:!1,title:this.props.title,onDismiss:v},r.createElement("div",{className:a.nameDialogContent},r.createElement(o.TextField,{ariaLabel:m,componentRef:this._onNameRef,value:t,onChange:this._onNameChanged,errorMessage:n,placeholder:m,maxLength:g,onKeyPress:this._onKeyPress,multiline:b,cols:w}),y&&r.createElement("span",{className:a.nameDialogContentFileExtension},y)),r.createElement(s.DialogFooter,null,r.createElement(u.PrimaryButton,{disabled:!t||!!n||l,onClick:this._onClickAction,"data-automation-id":p},p),d&&r.createElement(u.DefaultButton,{onClick:v},d),l&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium,className:a.nameDialogSpinner})))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0};t.prototype._focusOnTextfield=function(){if(this._textField){this._textField.focus();this._textField.select()}};return t})(r.PureComponent);t.NameDialog=function(e){return r.createElement(l,n.__assign({},e))}});
define("tA",["require","exports","lC","r","WS","XS","C1"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateFolderDialog=o.createItemCacheComponent(function(e,t){var o=t.createFolderWizard,u=n.__rest(t,["createFolderWizard"]),a=u.itemKey,f=e.demandItemFacet(i.createFolderDialogControl,a),l=i.createFolderDialogControl.evaluate(f)(e,{itemKey:a,validator:void 0}),c=l.validator,h=l.maxLength,p=l.title,d=e.dispatch;return r.createElement(o,n.__assign({},u,{onCreateFolder:function(e){var t=e.name;return n.__awaiter(void 0,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,d(s.createFolder({items:(e={},e[a]={folders:(r={},r[t]={},r)},e)}))];case 1:n.sent();return[2]}})})},validator:c,maxLength:h,title:p}))})});
define("ZE",["require","exports","lC","r","eA","_g","$E","Nr","C_","Kf","gE","To","JS","Qf","O1","C1","KS","mg","Ar","k1","So","Rf","A1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=new u.AutoKeyFacet("newDocument"),T=new E.PlatformDetection;function N(){return x.serializeNext()}var C=a.asAutoAction()(f.ItemDefaultClickAction);function k(e){var t=this,s=e.itemKey,u=e.resolve,a=e.reject,f=e.askForFileName,v=e.documentType,m=e.openWindow,g=e.templateItemKey,w=e.validator,E=r.useState(null),S=E[0],x=E[1],T=r.useState(f),k=T[0],L=T[1],A=r.useState(N)[0],O=r.useState(!1),M=O[0],_=O[1],D=b.useItemCacheDispatch(),P=r.useCallback(function(e,t){return!t.targetWindow&&S?{targetWindow:S}:{}},[S]),H=y.useEventHandler(function(){_(!0);u()}),B=y.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:t=e.name;r=m({});x(r);return!f||f&&t?[4,D(h.createDocument({items:(i={},i[s]={documentType:v,newDocumentKey:A,targetWindow:r,fileName:t,templateItemKey:g},i)}))]:[3,2];case 1:n.sent();n.label=2;case 2:L(!1);return[2]}})})}),j=y.useEventHandler(function(){a(new c.CancelError)});r.useLayoutEffect(function(){k||B({name:void 0})},[]);return k?r.createElement(l.NameDialog,{title:i.getDialogTitle(v,o.default)||"",name:"",placeHolder:o.default.NewNamePlaceholder,fileExtensionText:i.getDocExtension(v),onContinue:B,onCancel:j,continueText:o.default.CreateCommit,validator:w}):M?null:r.createElement(d.ControlHandlerProvider,{controlHandlers:p.targetWindowControl.pack(P)},r.createElement(C,{onComplete:H,itemKey:A}))}t.createDocumentExecutor=function(e,t,n,r){var i,s=t.itemCacheDispatch,o=t.itemKey,u=t.documentType,a=t.askForFileName,f=t.templateItemKey,l=e.newDocumentKey;return!a||a&&n?s(h.createDocument({items:(i={},i[o]={documentType:u,newDocumentKey:l,targetWindow:r,fileName:n,templateItemKey:f},i)})):Promise.resolve()};t.DocumentCreator=v.createItemCacheComponent(function(e,t){var i=t.itemKey,o=t.documentType,u=o===s.DocumentType.OneNote||o===s.DocumentType.ExcelSurvey||o===s.DocumentType.ExcelForm,a=S.getConfiguration(e,{enableOpenNewOfficeOnlineDocsInPWA:w.enableOpenNewOfficeOnlineDocsInPWAFacet}).enableOpenNewOfficeOnlineDocsInPWA,f=void 0!==a&&a,l=e.demandItemFacet(m.documentCreatorControl,i),c=m.documentCreatorControl.evaluate(l)(e,{itemKey:i,documentType:o,openWindow:f&&T.isPWA?A:L}),h=e.demandItemFacet(g.createDocumentActionControl,i),p=g.createDocumentActionControl.evaluate(h)(e,{itemKey:i,documentType:o,openWindow:f&&T.isPWA?A:L});return r.createElement(k,n.__assign({},t,{validator:p.validator||c.validator,askForFileName:u||p.askForFileName||c.askForFileName,openWindow:p.openWindow||c.openWindow}))});function L(e){return window.open(e.url||"","_blank")}function A(e){return window.open(e.url||"","_self")}});
define("AE",["require","exports","lC","r","b","Ec","Aw","xp","A1","So","Rs","bE","TE","kb","jm","LE","Ar"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DeleteWizard=function(e){var t=this,p=e.resolve,d=e.reject,v=e.onDelete,g=e.defaultToDelete,y=void 0===g||g,b=e.deleteWizardStrings,w=e.itemKeys,E=m.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:p();return[4,v()];case 1:e.sent();return[2]}})})}),S=m.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){d(new i.CancelError);return[2]})})}),x=r.useCallback(function(e){var t=e.itemCache,n=a.getConfiguration(t,{enableDeleteCancelConfirmationStrings:f.enableDeleteCancelConfirmationStringsConfigurationFacet}).enableDeleteCancelConfirmationStrings,i=void 0===n||n,s=1===w.length&&w.some(function(e){var n=t.demandItemFacet(l.isCheckedOutFacet,e);return!!(n&&n.byOther)}),p=w.length>=1&&w.some(function(e){return!!t.demandItemFacet(l.isSharedFacet,e)&&!1})?o.default.deleteSharedConfirmPrefixText+" ":"";return s?r.createElement(c.WarningDialog,{onCancel:S,cancelText:o.default.cancelActionText,title:u.default.checkedOutOrLockedWarningTitle,prompt:u.default.checkedOutOrLockedWarning}):r.createElement(h.ConfirmationDialog,{onCancel:S,onConfirm:E,yesText:i?b.confirmButtonText:void 0,noText:i?o.default.cancelActionText:void 0,defaultToYes:y,title:b.confirmTitle,prompt:[p,p?" ":"",b.confirmText]})},[w,b,y]);return r.createElement(s.WithItemCache,null,x)};t.deleteItemsWithProgress=d.implementOperationWithProgress({operationTypeFacet:p.deleteItemsOperation,progressKeyFacet:p.deleteProgressKeyFacet,initializeBatch:function(){return v.deleteProgressAddon}})});
define("TE",["require","exports","r","kw","am","HE","FE","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";u=u.ConfirmationDialog_2;Object.defineProperty(t,"__esModule",{value:!0});t.ConfirmationDialog=function(e){var t=e.onConfirm,a=e.onCancel,f=e.defaultToYes,l=void 0!==f&&f,c=e.yesText,h=void 0===c?o.default.yes:c,p=e.noText,d=void 0===p?o.default.no:p,v=l?i.PrimaryButton:i.DefaultButton,m=l?i.DefaultButton:i.PrimaryButton;return n.createElement(r.Dialog,{dialogContentProps:{type:r.DialogType.close},onDismiss:a,hidden:!1,title:e.title,maxWidth:e.maxWidth},n.createElement(s.Text,{className:u.confirmTextLabel},e.prompt),n.createElement(r.DialogFooter,null,n.createElement(v,{"data-automationid":"confirmbutton",onClick:t},h),n.createElement(m,{"data-automationid":"cancelbutton",onClick:a,componentRef:function(e){e&&e.focus()}},d)))}});
define("LE",["require","exports","lC","r","Hm","ih","Fm","me","jm","Mb","Gm","GO","kb","Xo","Rs","BO","PE","ko","S0","si","wo","A1","So","kE"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";var T,N;Object.defineProperty(t,"__esModule",{value:!0});var C=((T={})[l.ProgressPhase.started]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteStartedItemsTitle,f.default.deleteCompletedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.completed]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteCompletedItemsTitle,f.default.deleteCompletedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.failed]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsTitle,f.default.deleteFailedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.canceled]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsTitle,f.default.deleteFailedItemsTitleIntervals,t)||"",t)},T),k=((N={})[l.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteStartedItemsDestinationTitle,f.default.deleteStartedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteCompletedItemsDestinationTitle,f.default.deleteCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsDestinationTitle,f.default.deleteFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsDestinationTitle,f.default.deleteFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N);t.deleteProgressAddon=i.createAddon(function(){return function(e){e(s.registerControlHandler(h.deleteProgressKeyFacet,o.progressControl)(s.createControlHandler()(L)));e(i.registerOperationHandler(h.deleteProgressKeyFacet,v.retryProgressItemsOperation)(m.createRetryProgressItemsOperationHandler(h.deleteProgressKeyFacet,h.deleteItemsOperation)))}});function L(){return function(e){return A}}function A(e,t){var r,i,s,o=a.getOverallSimpleProgressBreakdown(e,t),u=o.phase,c=o.count,h=(function(e,t){var n=void 0,r=e.demandItemFacet(p.childItemsFacet,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(l.sourceItemFacet,o),a=u&&u.itemKey,f=e.demandItemFacet(d.parentFolderItemFacet,a),c=f&&f.itemKey;if(c)if(n){if(c!==n)break}else n=c}return n})(e,t),v=e.demandItemFacet(w.errorFacet,t.itemKey),m=E.getConfiguration(e,{enableOverrideDeleteFileLocks:S.enableOverrideDeleteFileLocksFacet}).enableOverrideDeleteFileLocks;v&&v instanceof g.ItemOperationError&&(r=b.unpack({fileLocked:y.fileLockedErrorFacet},v.facets));var T=[];if("group"===t.format&&h)i=k[u]({count:c,itemKey:h});else{i=C[u]({count:c});if(m&&u===l.ProgressPhase.failed&&r){s=f.default.fileLockedConfirmDeleteText;T.push(x.retryForceDeleteCommand)}}return n.__assign(n.__assign(n.__assign({},i&&"item"!==t.format?{title:i}:{}),s&&"summary"!==t.format?{description:s}:{}),{commands:T})}});
define("PE",["require","exports","lC","ko","Hm","rs","Vm","si","wo","qr","Gm","jm","Xo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createRetryProgressItemsOperationHandler=function(e,t){return i.createBatchedItemsOperationHandler()(function(e){var i=this;return function(p){return n.__awaiter(i,void 0,void 0,function(){var i,d,v,m,g,y,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:i=p(s.readItems(function(r){var i={operationTypeFacet:t,items:{}},s=new o.ItemResolver;function p(e){var o,d=r.demandItemFacet(l.sourceItemFacet,e),v=d&&d.itemKey,m=r.demandItemFacet(t,e),g=c.getOverallSimpleProgressBreakdown(r,{itemKey:e}).phase;if(v&&m&&"failed"===g){i.items[v]=n.__assign(n.__assign({},m),{progressItemKey:e});s.resolveItems({items:(o={},o[e]=n.__assign({},u.pack({error:a.errorFacet},{error:new f.Delete})),o)})}var y=r.demandItemFacet(h.childItemsFacet,e);if(y)for(var b=0,w=y.itemKeys;b<w.length;b++){p(w[b])}}for(var d=0,v=Object.keys(e.items);d<v.length;d++){p(v[d])}return{itemResolver:s,operationPayload:i}}));p(i.itemResolver.execute());d=p(r.startOperation(i.operationPayload)),v=d.completed,m=d.items;for(g=0,y=Object.keys(m);g<y.length;g++){b=y[g];w=m[b],E=w.started,S=w.completed;(x=i.operationPayload.items[b].progressItemKey)&&p(c.trackItemProgress({progressItemKey:x,started:E,completed:S}))}return[4,v];case 1:T.sent();return[2]}})})}})}});
define("kE",["require","exports","r","si","ME","Mb"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryForceDeleteCommand={key:new r.Facet("forceDeleteCommand").id,name:s.default.deleteConfirmButtonText,action:n.createElement(i.RetryDeleteWithBreakLockProgressAction,null)}});
define("ME",["require","exports","lC","r","BO","jr","ks","jm","_s","Jr","kb","Es","C1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRetryDeleteWithBreakLockProgressAction=h.createItemCacheComponent(function(e,t){var a=t.itemKeys,h=a.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),p=e.dispatch;return r.createElement(o.Action,n.__assign({onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){p(f.resolveItems({items:s.makeObject(h,function(){return l.deleteItemsOperation.pack({breakLock:!0})})}));p(i.retryProgressItems({items:s.makeObject(h,function(){return{}})}));return[2]})})},isAvailable:h.length>0},c.getItemActionEngagement(e,{itemKey:a[0],engagement:{name:"ForceDeleteWithBreakLock",isIntentional:!0}})))});t.RetryDeleteWithBreakLockProgressAction=a.withSelectedItems()(t.ItemRetryDeleteWithBreakLockProgressAction)});
define("fE",["require","exports","lC","r","b","Aw","EE","_E","Nb","jm","pE","Ar"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameWizard=function(e){var t=this,a=e.resolve,f=e.reject,l=e.onRename,h=e.lockedWarningMessage,p=e.title,d=e.validator,v=e.fileExtensionText,m=e.oldName,g=e.nameFieldAriaLabel,y=c.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:a();return l?[4,l(e)]:[3,2];case 1:t.sent();t.label=2;case 2:return[2]}})})}),b=c.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){f(new i.CancelError);return[2]})})}),w=p||s.default.Rename;return r.createElement(u.RenameDialog,{onContinue:y,onCancel:b,placeHolder:o.default.newNamePlaceholder,title:w,continueText:s.default.RenameCommit,name:m,validator:d,fileExtensionText:v,lockedWarningMessage:h,warningDialogCancelText:s.default.cancelActionText,cancelText:s.default.cancelActionText,nameFieldAriaLabel:g})};t.renameItemWithProgress=f.implementOperationWithProgress({operationTypeFacet:a.renameItemOperation,progressKeyFacet:a.renameProgressKeyFacet,initializeBatch:function(){return l.renameProgressAddon}})});
define("_E",["require","exports","lC","r","gE","bE","hE"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameDialog=function(e){var t=e.lockedWarningMessage,u=e.warningDialogCancelText,a=e.onCancel,f=e.title;return t?r.createElement(s.WarningDialog,{cancelText:u,title:f,prompt:t,onCancel:a}):r.createElement(o.KeyboardZone,null,r.createElement(i.NameDialog,n.__assign({},e)))}});
define("pE",["require","exports","lC","Hm","ih","Fm","me","jm","mE","Gm","Nb"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[f.ProgressPhase.started]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameStartedItemsTitle,a.default.renameCompletedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.completed]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameCompletedItemsTitle,a.default.renameCompletedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.failed]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameFailedItemsTitle,a.default.renameFailedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.canceled]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameFailedItemsTitle,a.default.renameFailedItemsTitleIntervals,e)||"",e)},c);t.renameProgressAddon=r.createAddon(function(){return function(e){e(i.registerControlHandler(l.renameProgressKeyFacet,s.progressControl)(i.createControlHandler()(p)))}});function p(){return function(e){return d}}function d(e,t){var r=u.getOverallSimpleProgressBreakdown(e,t),i=r.phase,s=r.count,o=h[i](s);return n.__assign({},o&&"item"!==t.format?{title:o}:{})}});
define("aE",["require","exports","lC","r","bw","am","R1","cE","$g","w0","M0","To","ks","Ps","ow","sE","rE","_p","ho","iE","me","E1","B_","Jp","O1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPickerWizard=function(e){var t=this,S=e.resolve,x=e.reject,C=e.itemKey,k=e.itemKeys,L=e.isMove,A=r.useState(!0),O=A[0],M=A[1],_=r.useMemo(function(){return o.createInitializer(function(){},C)},[C]),D=r.useCallback(function(e){var i=e.itemKeys;if(1!==i.length)return null;var s=i[0];return r.createElement(p.WithAction,{action:r.createElement(g.ItemMoveCopyAction,{itemKeys:k,itemKey:s,isMove:L})},function(e){var i=e.isAvailable,s=e.execute;return r.createElement(h.Action,{isAvailable:i,onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);M(!1);return[4,s(e)];case 1:n.sent();S();return[3,3];case 2:t=n.sent();x(t);return[3,3];case 3:return[2]}})})}})})},[]),P=r.useMemo(function(){return u.createPickerFailAction(y.createAsyncActionCreator(function(e){return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){x(e.error);return[2]})})}}))},[]),H=w.format(w.getLocalizedCountValue(L?b.default.MovePanelTitleFormat:b.default.CopyPanelTitleFormat,L?b.default.MovePanelTitleIntervals:b.default.CopyPanelTitleIntervals,k.length)||"",k.length),B=r.useCallback(function(){return r.createElement(d.LayoutGroup,{direction:"horizontal"},r.createElement(p.WithAction,{action:r.createElement(v.PickerCompleteAction,null)},function(e){var t=e.isAvailable,n=e.execute;return r.createElement(s.PrimaryButton,{disabled:!t,onClick:function(){n()}},L?b.default.MovePanelSelectActionText:b.default.CopyPanelSelectActionText)}),r.createElement(p.WithAction,{action:r.createElement(m.PickerCancelAction,null)},function(e){var t=e.isAvailable,n=e.execute;return r.createElement(s.DefaultButton,{disabled:!t,onClick:function(){n()}},b.default.MoveCopyPanelCancelActionText)}))},[]),j=r.useMemo(function(){return n.__assign({},E.itemSetColumnsControl.pack(N))},[]);return r.createElement(o.ItemsScope,{initializer:_},r.createElement(u.ItemsPicker,{itemMode:"folders",selectionMode:"pick",commandMode:"none",completeAction:D,failAction:P},r.createElement(i.Panel,{headerText:H,isOpen:O,onDismiss:function(){return x(new c.CancelError)},isLightDismiss:!0,onRenderFooterContent:B},r.createElement(a.ItemsBreadcrumbBeta,null),r.createElement(T.ControlHandlerProvider,{controlHandlers:j},r.createElement(f.ItemsLayoutGroup,null,r.createElement(l.DetailsLayout,null))))))};function N(e,t){return{columns:[S.fileTypeIconColumn,x.displayNameColumn]}}});
define("cE",["require","exports","lC","r","O1","oE","ks","Ec","T1","Yf","is","H8","F8","Vo","uE","cg","bg","Zb","vb","gb","Sg","d0","t_","C1","_b","dE","ob"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=[],L=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(o.Action,null)};return t})(r.PureComponent),A=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(o.Action,null)};return t})(r.PureComponent);t.createPickerCompleteAction=function(e){var t=this;return x.connectToItemCache(function(r,i){var s=i.itemKeys;return{onExecute:(function(r){return function(i){return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,r(e({itemKeys:i}))];case 1:t.sent();return[2]}})})}}})(r.dispatch)(s)}})(o.Action)};t.createPickerFailAction=function(e){var t=this;return x.connectToItemCache(function(r,i){var s=i.error;return{onExecute:(function(r){return function(i){return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,r(e({error:i}))];case 1:t.sent();return[2]}})})}}})(r.dispatch)(s)}})(o.Action)};t.ItemsPicker=function(e){var t=e.filters,o=void 0===t?k:t,v=e.selectionMode,m=void 0===v?"single":v,g=e.itemMode,y=void 0===g?"files":g,b=e.commandMode,x=void 0===b?"safe-write":b,T=e.completeAction,N=void 0===T?L:T,C=e.failAction,_=void 0===C?A:C,D=e.children,P=r.useCallback(function(e,t){return{handlers:n.__spreadArrays([f.openDefaultClickActionHandler],"pick"===m?[d.completePickerDefaultClickActionHandler]:[])}},[m]),H=r.useCallback(function(e,t){var r=t.itemKey;if(o.length<=0||!r)return{};var i=e.demandItemFacet(c.filteredItemSetControl,r);return{itemKey:c.filteredItemSetControl.evaluate(i)(e,{itemKey:r,handlers:n.__spreadArrays(o,[h.itemFolderTypeFilterHandler])}).itemKey}},[o]),B=r.useCallback(function(e,t){return"pick"===m?{selectionMode:"none",canSelectItem:function(){return!1}}:{selectionMode:m,canSelectItem:function(e,t){return O(e,n.__assign(n.__assign({},t),{itemMode:y,filters:o}))}}},[m,y,o]),j=r.useCallback(function(e,t){var r=t.commands,i=t.farCommands,s=t.overflowCommands,o=t.shortcutCommands;return"all"===x?{}:n.__assign(n.__assign(n.__assign(n.__assign({},r?{commands:M(r,x)}:{}),i?{farCommands:M(i,x)}:{}),s?{overflowCommands:M(s,x)}:{}),o?{shortcutCommands:M(o,x)}:{})},[x]),F=r.useCallback(function(e,t){var r=t.commands;return"all"===x?{}:n.__assign({},r?{commands:M(r,x)}:{})},[x]),I=r.useCallback(function(e,t){var r=t.commands;return"all"===x?{}:n.__assign({},r?{commands:M(r,x)}:{})},[x]),q=r.useCallback((function(e,t,i){return function(s){var o=s.itemKeys,a=r.useCallback(function(u){for(var a=u.itemCache,f=0,l=o;f<l.length;f++){if(!O(a,{itemKey:l[f],filters:e,itemMode:t}))return null}return r.createElement(i,n.__assign({},s))},[o]);return r.createElement(u.WithItemCache,null,a)}})(o,y,N),[o,y,N]),R=r.useCallback((function(e){return function(t){return r.createElement(e,n.__assign({},t))}})(_),[_]),U=r.useMemo(function(){return n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},a.defaultClickActionControl.pack(P)),l.itemSetSelectionControl.pack(B)),p.currentItemSetControl.pack(H)),w.itemsCommandBarControl.pack(j)),E.itemsContextMenuControl.pack(F)),S.itemHeroCommandsControl.pack(I))},[P,B,H,j,F,I]);return r.useMemo(function(){return r.createElement(s.PICKER_CONTEXT.Provider,{value:{completeAction:q,failAction:R}},r.createElement(i.ControlHandlerProvider,{controlHandlers:U},D))},[q,R,U,D])};function O(e,t){var n=t.filters,r=t.itemMode;if("folders"===r){if(!h.itemFolderTypeFilterHandler.filter(e,t))return!1}else if("files"===r&&!h.itemNonFolderTypeFilterHandler.filter(e,t))return!1;if(!n||0===n.length)return!0;for(var i=0,s=n;i<s.length;i++){if(s[i].filter(e,t))return!0}return!1}function M(e,t){if("all"===t)return e;for(var r=[],i=0,s=e;i<s.length;i++){var o=s[i];if(o.key===v.newCommand.key){var u=o.subMenuProps&&o.subMenuProps.items;u&&r.push(n.__assign(n.__assign({},o),{subMenuProps:n.__assign(n.__assign({},o.subMenuProps),{items:M(u,t)})}))}else o.key===m.createFolderCommand.key||o.key===g.uploadCommand.key?"safe-write"===t&&r.push(o):o.key!==y.showProgressCommand.key&&o.key!==b.switchLayoutCommand.key&&o.key!==T.clearSelectionCommand.key&&o.key!==N.navigateUpShortcut.key&&o.key!==C.sortCommandKey||r.push(o)}return r}});
define("oE",["require","exports","r"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PICKER_CONTEXT=n.createContext(void 0)});
define("uE",["require","exports","r","si","Rs","sE"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.completePickerDefaultClickActionHandler={key:new r.Facet("completePickerDefaultClickActionHandler").id,evaluate:function(e,t){return{action:e.demandItemFacet(i.folderFacet,t.itemKey)?void 0:n.createElement(s.ItemPickerCompleteAction,{itemKeys:[t.itemKey]})}}}});
define("sE",["require","exports","lC","r","oE","_s"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKeys;return r.createElement(i.PICKER_CONTEXT.Consumer,null,function(t){if(!t)return null;var n=t.completeAction;return r.createElement(n,{itemKeys:e})})};return t})(r.PureComponent);t.ItemPickerCompleteAction=o;t.PickerCompleteAction=s.withSelectedItems()(s.withCurrentItemAsFallback()(o))});
define("vb",["require","exports","r","si","Ib","yb","Or","es"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.showProgressCommand={key:new r.Facet("progress").id,automationId:"showProgressCommand",action:n.createElement(i.ShowProgressAction,null),shortcutProps:{keySequences:["G"],content:u.default.showActionDetailsDesc},title:o.default.ShowProgressCommandAriaLabel,ariaLabel:o.default.ShowProgressCommandAriaLabel,commandBarButtonAs:s.ProgressCommandButton}});
define("Ib",["require","exports","lC","r","ks","jm","Xo","Gm","tv","ev","xb","Ps","C1","do"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=f.afterPageLoad()(a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["wO"],t,n)})];case 1:return[2,t.sent().ProgressPanel]}})})})),v=l.createItemCacheInitializer(function(){return s.progressAddon}),m=new p.ComputedItemFacet("progressAction",function(e){var t=c.renderComponentOnExecute(d);return r.createElement(i.Action,{onExecute:t})});t.ShowProgressAction=h.createItemCacheComponent(function(e,t){var n=e.demandItemFacet(o.childItemsFacet,s.progressRootItemKey),i=!1,a=n&&n.itemKeys;if(a)for(var f=0,l=a;f<l.length;f++){var c=l[f];if(s.getOverallProgressPhase(e,{itemKey:c})!==u.ProgressPhase.expired){i=!0;break}}var p=e.demandItemFacet(m,void 0)||null;return r.createElement(v,null,i?h.evaluateItemCacheComponent(e,p):null)})});
define("xb",["require","exports","r","Vr","Kr","k1","Fo","Er"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemCacheInitializer=function(e,t){return function(a){var f=i.useShallowMemo(function(){return a},a),l=o.usePreviousValue(f),c=s.useItemCacheDispatch(),h=u.useEventHandler(function(){t&&c(t({props:a}))});n.useEffect(function(){e&&c(e({props:f,previousProps:l}))},[f]);n.useEffect(function(){return h},[]);return r.renderChildrenWithProps(a.children,{})}}});
define("yb",["require","exports","lC","r","o","Fm","jm","Un","Sl","SPListItemsScopeDeferred_IS_mini_css","Sb","me","jr","C1","Gm","Xo","Zn","Um","Ec","ev","tv","tb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";f=f.ProgressCommandButton_7;var S;Object.defineProperty(t,"__esModule",{value:!0});var x=b.afterPageLoad()(w.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["nE"],t,n)})];case 1:return[2,t.sent().ProgressCallout]}})})})),T={started:"Sync",completed:"CheckMark",failed:"StatusErrorFull",canceled:"Sync"},N=((S={})[d.ProgressPhase.started]=function(e){return c.format(c.getLocalizedCountValue(l.default.genericStartedItemsTitle,l.default.genericCompletedItemsTitleIntervals,e)||"",e)},S[d.ProgressPhase.completed]=function(e){return c.format(c.getLocalizedCountValue(l.default.genericCompletedItemsTitle,l.default.genericCompletedItemsTitleIntervals,e)||"",e)},S[d.ProgressPhase.failed]=function(e){return c.format(c.getLocalizedCountValue(l.default.genericFailedItemsTitle,l.default.genericFailedItemsTitleIntervals,e)||"",e)},S[d.ProgressPhase.canceled]=function(e){return c.format(c.getLocalizedCountValue(l.default.genericFailedItemsTitle,l.default.genericFailedItemsTitleIntervals,e)||"",e)},S),C=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={status:t.status,percentComplete:t.percentComplete};n._async=new m.Async(n);n._updateStatus=n._async.throttle(function(){n.setState({status:n.props.status,percentComplete:n.props.percentComplete})},500,{leading:!1,trailing:!0});n._updatePercentComplete=n._async.throttle(function(){n.setState({status:n.props.status,percentComplete:n.props.percentComplete})},1e4,{leading:!1,trailing:!0});return n}t.prototype.render=function(){var e=this.state,t=e.status,n=e.percentComplete;return r.createElement(a.Layer,null,r.createElement("span",{className:f.accessibleStatus,role:"status","aria-live":"polite","aria-atomic":"true"},t," ",(function(e){if("number"==typeof e)return c.formatWithLocalizedCountValue(l.default.percentCompletedDescription,l.default.percentCompletedDescriptionIntervals,Math.round(100*e));return l.default.genericStartedIndeterminateDescription})(n)))};t.prototype.componentDidUpdate=function(e){e.status!==this.props.status?this._updateStatus():e.percentComplete!==this.props.percentComplete&&this._updatePercentComplete()};t.prototype.componentWillUnmount=function(){this._async.dispose()};return t})(r.PureComponent);var k=p.connectToItemCache()(function(e){var t=e.finishedPinnedItemKeys,n=e.finishedHiddenItemKeys,i=e.itemCacheDispatch,u=(function(e,t){var n=r.useRef(),i=n.current;n.current=e;var s=r.useRef(),o=r.useState({})[1];e!==i&&e&&(s.current=e);r.useEffect(function(){if(e){var n=setTimeout(function(){s.current=void 0;o({})},t);return function(){clearTimeout(n)}}},[e]);return s.current})((function(e){var t=r.useRef(),n=t.current;t.current=e;var i=r.useRef(),s=i.current||(i.current={}),o=r.useRef(),u=o.current;if(e!==n){for(var a=void 0,f={},l=0,c=e;l<c.length;l++){var h=c[l];f[h]=!0;s[h]||(a=h)}i.current=f;(a||u&&!f[u])&&(o.current=a)}return o.current})(t),3e3),a=r.useRef();a.current=e.doNotExpire;var f=u||e.currentItemKey,l=r.useRef(),c=l.current;l.current=u;r.useEffect(function(){var e;c&&!a.current&&i(o.expireProgressItems({items:(e={},e[c]=!0,e)}))},[u]);r.useEffect(function(){n.length>0&&!a.current&&i(o.expireProgressItems({items:h.makeObject(n,function(){return!0})}))},[n]);var p=r.useCallback(function(t){var n,i,u,a=t.itemCache;if(f){var l=a.demandItemFacet(s.progressControl,f),c=o.getItemCountsByProgressPhase(a,{itemKey:f}),h=o.getOverallSimpleProgressBreakdown(a,{itemKey:f}),p=h.phase,d=h.count,v=s.progressControl.evaluate(l)(a,{itemKey:f,itemCountsByPhase:c,title:N[p](d),percentComplete:(n=c,i=n.created+n.started+n.completed+n.failed,u=n.completed+n.failed,i>0?u/i:void 0),showTitle:!0,format:"summary"}),m=v.title,g=v.percentComplete,y=v.showTitle;return r.createElement(r.Fragment,null,y?r.createElement("div",null,m):null,e.isMeasured?null:r.createElement(C,{status:m,percentComplete:g}))}return null},[f]);return r.createElement(y.WithItemCache,null,p)}),L=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onDismiss=function(){n.setState({doNotExpire:!1})};n._onClick=function(e){n.setState({doNotExpire:!0});var t=n.props.onClick;t&&t(e)};n.state={root:null,doNotExpire:!1};return n}t.prototype.render=function(){var e,t=this.props,i=t.iconName,s=t.isStarted,o=t.finishedCalloutProgressItemKeys,a=t.finishedPinnedProgressItemKeys,l=t.finishedHiddenProgressItemKeys,c=(t.children,t.defaultRender),h=(t.progressTitle,t.progressPercentComplete,n.__rest(t,["iconName","isStarted","finishedCalloutProgressItemKeys","finishedPinnedProgressItemKeys","finishedHiddenProgressItemKeys","children","defaultRender","progressTitle","progressPercentComplete"])),p=this.state.root;return c?r.createElement(c,n.__assign({},h,{onClick:this._onClick,iconProps:{iconName:i,className:u.css((e={},e[f.created]=s,e))}}),r.createElement(k,{isMeasured:this.context.isMeasured,currentItemKey:this.props.currentItemKey,doNotExpire:this.state.doNotExpire,finishedPinnedItemKeys:a,finishedHiddenItemKeys:l}),p?r.createElement(x,{target:p,onViewAll:this._onClick,onDismiss:this._onDismiss,isExecuting:this.props.isExecuting,doNotExpire:this.state.doNotExpire,finishedItemKeys:o}):null):null};t.prototype.componentDidMount=function(){this.context.isMeasured||this.setState({root:i.findDOMNode(this)})};t.contextType=E.MeasuredContext;return t})(r.PureComponent);t.ProgressCommandButton=p.connectToItemCache(function(e,t){for(var n=t.actionState,r=e.demandItemFacet(v.childItemsFacet,o.progressRootItemKey),i=r&&r.itemKeys||[],s=void 0,u=[],a=[],f=[],l=e.demandItemFacet(g.progressCommandControl,void 0),c=g.progressCommandControl.evaluate(l)(e,{}).summaryControlHandler,h=0,p=i;h<p.length;h++){var m=p[h],y=o.getOverallProgressPhase(e,{itemKey:m}),b=e.demandItemFacet(g.progressCommandSummaryControl,m),w=g.progressCommandSummaryControl.evaluate(b,c)(e,{itemKey:m,reportMode:g.ProgressSummaryReportMode.callout}).reportMode;switch(y){case d.ProgressPhase.created:case d.ProgressPhase.started:s=m;break;case d.ProgressPhase.completed:w===g.ProgressSummaryReportMode.callout?a.push(m):w===g.ProgressSummaryReportMode.pin?f.push(m):u.push(m);break;case d.ProgressPhase.failed:a.push(m);break;case d.ProgressPhase.canceled:case d.ProgressPhase.expired:}}var E=o.getOverallSimpleProgressBreakdown(e,{itemKey:o.progressRootItemKey}).phase;return{iconName:T[E]||"Sync",isStarted:"started"===E,currentItemKey:s,finishedCalloutProgressItemKeys:a,finishedPinnedProgressItemKeys:f,finishedHiddenProgressItemKeys:u,isExecuting:!!n&&n.executingCount>0}})(L)});
define("_b",["require","exports","lC","r","si","bb","pb","hb","me","Yo","C1"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=l.createItemCacheComponent(function(e,t){var i=t.defaultRender,s=n.__rest(t,["defaultRender"]),o=f.getSelectedItemKeys(e);return i?r.createElement(i,n.__assign({},s,{text:a.formatWithLocalizedCountValue(u.default.ClearSelectionCommandText,u.default.ClearSelectionCommandTextIntervals,o.length),ariaLabel:a.formatWithLocalizedCountValue(u.default.ClearSelectionCommandAriaLabel,u.default.ClearSelectionCommandAriaLabelIntervals,o.length)})):null});t.clearSelectionCommand={key:new i.Facet("clearSelectionCommand").id,iconProps:{iconName:"Clear"},shortcutProps:{content:u.default.ClearSelectionShortcutDesc,keySequences:["CtrlD"]},action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(s.ClearSelectionAction,null)),commandBarButtonAs:c}});
define("bb",["require","exports","lC","r","ks","ss","bs","C1","Yo","$1","os"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ClearSelectionAction=u.createItemCacheComponent(function(e,t){var u=o.getItemsScope(e).itemsScopeItemKey;if(!u)return null;var c=e.demandItemFacet(l.isSelectionModalFacet,u);if(0===a.getSelectedItemKeys(e).length&&!c)return null;var h=e.dispatch;return r.createElement(i.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){c&&h(f.resolveItems({items:(e={},e[u]=n.__assign({},l.isSelectionModalFacet.pack(void 0)),e)}));h(s.clearSelection({itemsScopeItemKey:u}));return[2]})})},engagement:{name:"ClearSelection",isIntentional:!0}})})});
define("ob",["require","exports","r","sf","Or","_s","I_","Wp","Qp","do","si"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sortCommandKey=l.getNextId("sortCommand");var c=new f.ComputedItemFacet("sortedColumn",function(e,t){for(var n=t.itemKey,r=u.getItemSetColumnOverrides(e,{itemKey:n}).columns,i=void 0===r?u.DEFAULT_COLUMNS:r,s=e.demandItemFacet(a.sortedItemSetControl,n),o=0,f=i;o<f.length;o++){var l=f[o];if(n===a.sortedItemSetControl.evaluate(s)(e,{itemSetKey:n,handler:{columnKey:l.key,isAscending:!0}}).newItemSetKey)return{columnKey:l.key,isAscending:!0,name:l.name};if(n===a.sortedItemSetControl.evaluate(s)(e,{itemSetKey:n,handler:{columnKey:l.key,isAscending:!1}}).newItemSetKey)return{columnKey:l.key,isAscending:!1,name:l.name}}}),h=function(e,t){var n=t?i.default.SortAscending:i.default.SortDescending;return i.default.SortedBy+" "+e+", "+n};t.buildSortCommand=function(e,f){void 0===f&&(f={});var l=i.default.Sort;f.hasOwnProperty("name")&&(l=f.name);var p=[],d=s.getCurrentItemSetKey(e);if(d){var v=u.getItemSetColumnOverrides(e,{itemKey:d}).columns,m=void 0===v?u.DEFAULT_COLUMNS:v,g=e.demandItemFacet(c,d);if(g){for(var y=e.demandItemFacet(a.sortedItemSetControl,d),b=0,w=m;b<w.length;b++){var E=w[b];a.sortedItemSetControl.evaluate(y)(e,{itemSetKey:d,handler:{columnKey:E.key,isAscending:g.isAscending}}).newItemSetKey&&p.push({key:"sort"+E.key,automationId:"sort"+E.key,name:E.name,ariaLabel:E.name,action:n.createElement(o.ItemSortAction,{itemKey:d,columnKey:E.key,isAscending:g.isAscending,ariaLabel:h(E.name,g.isAscending)})})}p.push({name:"-",key:"divider_1",itemType:r.ContextualMenuItemType.Divider});p.push({key:"sortAsc",automationId:"sortAsc",name:i.default.SortAscending,ariaLabel:i.default.SortAscending,title:i.default.SortAscendingCommandTooltip,action:n.createElement(o.ItemSortAction,{itemKey:d,columnKey:g.columnKey,isAscending:!0,ariaLabel:h(g.name,!0)})});p.push({key:"sortDesc",automationId:"sortDesc",name:i.default.SortDescending,ariaLabel:i.default.SortDescending,title:i.default.SortDescendingCommandTooltip,action:n.createElement(o.ItemSortAction,{itemKey:d,columnKey:g.columnKey,isAscending:!1,ariaLabel:h(g.name,!1)})})}}return{key:t.sortCommandKey,automationId:"sortCommand",name:l,ariaLabel:i.default.SortCommandTooltip,title:i.default.SortCommandTooltip,iconProps:{iconName:"SortLines"},subMenuProps:{items:p}}}});
define("rE",["require","exports","r","oE","To"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e){var t=e.error,i=n.useContext(r.PICKER_CONTEXT);if(!i)return null;var s=i.failAction;return n.createElement(s,{error:t})}t.PickerFailAction=s;t.PickerCancelAction=function(e){var t=new i.CancelError({message:"The picker was canceled by the user."});return n.createElement(s,{error:t})}});
define("GC",["require","exports","lC","r","qh","eO","JC","KC"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return r.createElement(u.TilesList,n.__assign({},e))};t.ItemSetTilesList=i.withResponsiveMode()(function(e){var t=s.useItemSetTileCells(e);return r.createElement(o.InjectableItemSetTilesList,n.__assign({},e,t,{onRenderTilesList:a}))});t.ItemSetTilesList.displayName="ItemSetTilesList"});
define("eO",["require","exports","lC","r","mO","Vp","Bp","Xo","Jf","wo","Rs","Ef","l0","ey","jr","ZC","aO","nO","tO","ao","k1","Np","cs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SIZES={small:{tileDefaultHeight:135,tileDefaultWidth:138,documentGroupTileMargin:12,photoGroupTileMargin:8,groupMargin:40},large:{tileDefaultHeight:171,tileDefaultWidth:176,documentGroupTileMargin:8,photoGroupTileMargin:8,groupMargin:40}};t.useItemSetTileCells=function(e){var t=e.itemKey,n=e.doNotRenderShimmerTile,r=e.responsiveMode,i=e.layoutSupportsRandomAccess;return w.useItemCacheSelector(b.bindItemCacheSelectorToProps(x,e),[t,n,r,i])};function x(e,r){var i=r.itemKey,s=r.doNotRenderShimmerTile,p=void 0!==s&&s,d=r.responsiveMode,v=void 0===d?c.ResponsiveMode.large:d,b=r.layoutSupportsRandomAccess,w=e.demandItemFacet(E.itemSetPagingControl,r.itemKey),S=E.itemSetPagingControl.evaluate(w)(e,{setItemKey:r.itemKey}),x=S.totalItemCount,M=S.getPageKey,_=S.pageSize,D=b&&!!x&&void 0!==M,P=e.demandItemFacet(u.childItemsFacet,i),H=e.demandItemFacet(a.mediaGroupFacet,i),B=e.demandItemFacet(o.childItemsControl,i),j=o.childItemsControl.evaluate(B)(e,{itemKey:i,itemKeys:P&&P.itemKeys}).itemKeys,F=v>c.ResponsiveMode.large?"large":"small",I=t.SIZES[F],q=L(F),R=e.demandItemFacet(h.itemSetTilesListControl,i),U={mode:2,spacing:I.photoGroupTileMargin},z={mode:"large"===F?1:3,marginBottom:I.groupMargin,spacing:I.documentGroupTileMargin,minRowHeight:I.tileDefaultHeight},W=h.itemSetTilesListControl.evaluate(R)(e,{itemSetKey:i,itemKeys:j,responsiveMode:v,tileRenderer:m.ItemTileCell,disableMarqueeSelection:!1,grid:n.__assign(n.__assign({},z),H?U:{})}),X=W.tileRenderer,V=W.groupControlHandler,$=W.tileControlHandler,J=W.grid,K=W.disableMarqueeSelection,Q=[],G=[],Y=[],Z=!0,ee=0,te=!0;if(j){for(var ne=0,re=j;ne<re.length;ne++){var ie=re[ne],se=D&&void 0===ie;if(se||e.demandItemFacet(u.pageFacet,ie,{suppressGetItems:!0})){Y.push({key:se?ee.toString():ie,content:{key:ie,setKey:i,index:-1,tileSize:F,tileMode:"document",enableRandomAccess:D},desiredSize:q,onRenderCell:C});se&&ee++}else if(e.demandItemFacet(a.isGroupFacet,ie,{suppressGetItems:!0})){if(Y.length>0){Q.push(n.__assign({key:"",items:Y},J));Y=[]}var oe=O(e,{itemKey:ie}),ue=oe.itemKeys;oe.isResolved||(te=!1);oe.hasContent||(Z=!1);var ae=e.demandItemFacet(a.mediaGroupFacet,ie)||H,fe=h.itemSetTilesListGroupControl.evaluate(V)(e,{groupKey:ie,itemKeys:ue,tileRenderer:X,headerRenderer:g.HeaderTileCell,tileControlHandler:$,showHeader:!!e.demandItemFacet(l.displayNameFacet,ie),maxItemCount:ue.length,grid:n.__assign(n.__assign({},J),ae?U:{})}),le=fe.tileRenderer,ce=fe.headerRenderer,he=fe.tileControlHandler,pe=fe.showHeader,de=fe.maxItemCount,ve=fe.grid,me=!1;pe&&ce&&Q.push({key:ie,content:{key:ie,index:-1,setKey:i,tileSize:F,tileMode:"document",headerRenderer:ce},onRenderCell:N});for(var ge=[],ye=0,be=ue;ye<be.length;ye++){var we=be[ye];G.push({key:we});var Ee=h.itemSetTilesListTileControl.evaluate(he)(e,{itemKey:we,desiredSize:ae&&A(e,{itemKey:we})||q,tileMode:ae?"media":"document"}),Se=Ee.desiredSize,xe=Ee.tileMode;e.demandItemFacet(u.pageFacet,we,{suppressGetItems:!0})?ge.push({key:ie,content:{key:ie,setKey:i,index:-1,tileSize:F,tileMode:"document"},desiredSize:Se,onRenderCell:C}):ge.push({key:we,content:{key:we,index:ee,tileSize:F,tileMode:xe,setKey:i,tileRenderer:le},desiredSize:Se,onRenderCell:T});ee++;if(ge.length===de&&ue.length>de){me=!0;break}}var Te=n.__assign({key:ie,items:ge},ve);Q.push(Te);me&&Q.push({key:"ShowAll -"+ie,content:{key:ie,index:-1,setKey:i,tileSize:F,tileMode:"document",headerRenderer:y.ShowAllTileCell},onRenderCell:N})}else{G.push({key:ie});var Ne=h.itemSetTilesListTileControl.evaluate($)(e,{itemKey:ie,desiredSize:H&&A(e,{itemKey:ie})||q,tileMode:H?"media":"document"}),Ce=(Se=Ne.desiredSize,Ne.tileMode);Y.push({key:ie,content:{key:ie,index:ee,tileSize:F,tileMode:Ce,setKey:i,tileRenderer:X},desiredSize:Se,onRenderCell:T});ee++}}Y.length>0&&Q.push(n.__assign({key:"",items:Y},J))}var ke=[],Le=e.isItemFacetResolved(u.childItemsFacet,i)&&te||!!e.demandItemFacet(f.errorFacet,i,{suppressGetItems:!0});!(Le||j&&0!==j.length&&Z)&&ke.push(n.__assign(n.__assign({key:"",items:[{key:"",content:{key:"",setKey:i,index:ee,tileSize:F,tileMode:H?"media":"document"},desiredSize:L(F),onRenderCell:k,isPlaceholder:!0}]},z),{isPlaceholder:!0}));return{setKey:i||"",items:ke.length>0?p?[]:ke:Q,selectionItems:G,isDataReadyForLayout:Le,getPageKey:M,pageSize:_,disableMarqueeSelection:K}}function T(e){var t=e.item,n=t.tileRenderer,i=t.key,s=t.setKey,o=t.index,u=t.tileMode,a=t.tileSize,f=e.item,l=e.finalSize,c=e.position.column;return n?r.createElement(v.SELECTION_CONTEXT.Consumer,null,function(e){return r.createElement(n,{role:"gridcell","aria-colindex":c+1,contentSize:l,itemKey:i,itemSetKey:s,tileSize:a,itemTileMode:u,isSelectable:e&&e.mode!==S.SelectionMode.none&&e.canSelectItem(f),selectionIndex:o,selection:e})}):null}function N(e){var t=e.item,n=t.headerRenderer,i=t.key;return n?r.createElement(v.SELECTION_CONTEXT.Consumer,null,function(e){return r.createElement(n,{itemKey:i,selection:e})}):null}function C(e){var t=e.item,n=e.finalSize;return t.enableRandomAccess?null:r.createElement(s.ItemPage,{itemKey:t.key,layout:"tile",contentSize:n})}function k(e){var t=e.finalSize;return r.createElement(i.ShimmerTile,{contentSize:t,itemName:!0,itemActivity:!0,itemThumbnail:!0,role:"presentation"})}function L(e){var n=t.SIZES[e];return{width:n.tileDefaultWidth,height:n.tileDefaultHeight}}function A(e,t){var n=e.demandItemFacet(p.thumbnailFacet,t.itemKey)||e.demandItemFacet(p.dimensionsFacet,t.itemKey);return n&&d.pickObject(n,["width","height"])}function O(e,t){var n=!0,r=!0,i=e.demandItemFacet(u.childItemsFacet,t.itemKey),s=e.demandItemFacet(f.errorFacet,t.itemKey,{suppressGetItems:!0});if(!e.isItemFacetResolved(u.childItemsFacet,t.itemKey)&&!s){i||(r=!1);n=!1}for(var l=i&&i.itemKeys||[],c=e.demandItemFacet(o.childItemsControl,t.itemKey),h=[],p=0,d=o.childItemsControl.evaluate(c)(e,{itemKeys:l,itemKey:t.itemKey}).itemKeys;p<d.length;p++){var v=d[p];if(e.demandItemFacet(a.isGroupFacet,v,{suppressGetItems:!0})){var m=O(e,{itemKey:v}),g=m.itemKeys,y=m.isResolved,b=m.hasContent;h.push.apply(h,g);b||(r=!1);y||(n=!1)}else h.push(v)}return{itemKeys:h,isResolved:n,hasContent:r}}});
define("mO",["require","exports","lC","_O"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("_O",["require","exports","lC","vO","hO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("vO",["require","exports","lC","r","Zc","cs","d_","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";var a=u.Signal_4,f=u.Check_8;u=u.Tile_1;Object.defineProperty(t,"__esModule",{value:!0});var l=u,c=a,h=f;t.TileLayoutValues={nameplatePadding:12,largeNameplateNameHeight:15,smallNameplateNameHeight:12,nameplateMargin:0,largeNameplateActivityHeight:20,smallNameplateActivityHeight:20,foregroundMargin:16};t.TileLayoutSizes={small:{nameplatePadding:t.TileLayoutValues.nameplatePadding,nameplateNameHeight:t.TileLayoutValues.smallNameplateNameHeight,nameplateMargin:t.TileLayoutValues.nameplateMargin,nameplateActivityHeight:t.TileLayoutValues.smallNameplateActivityHeight,foregroundMargin:t.TileLayoutValues.foregroundMargin},large:{nameplatePadding:t.TileLayoutValues.nameplatePadding,nameplateNameHeight:t.TileLayoutValues.largeNameplateNameHeight,nameplateMargin:t.TileLayoutValues.nameplateMargin,nameplateActivityHeight:t.TileLayoutValues.largeNameplateActivityHeight,foregroundMargin:t.TileLayoutValues.foregroundMargin}};var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onSelectionChange=function(){var e=r.props,t=e.selection,n=e.selectionIndex,i=void 0===n?-1:n,s=i>-1&&!!t&&t.isIndexSelected(i),o=!!t&&!!t.isModal&&t.isModal();r.setState({isSelected:s,isModal:o})};o.initializeComponentRef(r);r._nameId=o.getId("Tile-name");r._activityId=o.getId("Tile-activity");r._labelId=o.getId("Tile-label");r._descriptionId=o.getId("Tile-description");var i=t.selectionIndex,s=void 0===i?-1:i,u=t.selection,a=!!u&&s>-1&&u.isIndexSelected(s),f=!!u&&!!u.isModal&&u.isModal();r.state={isSelected:a,isModal:f};r._events=new o.EventGroup(r);return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.props,n=t.selection,r=t.selectionIndex,i=e.selection,s=e.selectionIndex,o=void 0===s?-1:s;if(n!==i||r!==o){var u=!!i&&o>-1&&i.isIndexSelected(o),a=!!i&&i.isModal&&i.isModal();this.setState({isSelected:u,isModal:a})}};t.prototype.componentDidMount=function(){var e=this.props.selection;e&&this._events.on(e,s.SELECTION_CHANGE,this._onSelectionChange)};t.prototype.componentDidUpdate=function(e){var t=this.props.selection,n=e.selection;if(t!==n){n&&this._events.off(n);t&&this._events.on(t,s.SELECTION_CHANGE,this._onSelectionChange)}};t.prototype.componentWillUnmount=function(){this._events.dispose()};t.prototype.render=function(){var e,t=this.props,i=(t.children,t.selectionIndex),s=void 0===i?-1:i,a=t.invokeSelection,f=void 0!==a&&a,h=t.selection,p=t.background,d=t.foreground,v=t.showBackgroundFrame,m=void 0!==v&&v,g=t.showForegroundFrame,y=void 0!==g&&g,b=t.hideBackground,w=void 0!==b&&b,E=t.hideForeground,S=void 0!==E&&E,x=t.itemName,T=t.itemActivity,N=(t.componentRef,t.className),C=t.tileSize,k=void 0===C?"large":C,L=(t.contentSize,t.ariaLabel),A=t.descriptionAriaLabel,O=t.href,M=t.onClick,_=t.download,D=t.hrefLang,P=t.media,H=t.rel,B=t.target,j=t.isFluentStyling,F=t.ariaLabelSelected,I=t.nameplateOnlyOnHover,q=n.__rest(t,["children","selectionIndex","invokeSelection","selection","background","foreground","showBackgroundFrame","showForegroundFrame","hideBackground","hideForeground","itemName","itemActivity","componentRef","className","tileSize","contentSize","ariaLabel","descriptionAriaLabel","href","onClick","download","hrefLang","media","rel","target","isFluentStyling","ariaLabelSelected","nameplateOnlyOnHover"]),R=this.state,U=R.isSelected,z=void 0!==U&&U,W=R.isModal,X=void 0!==W&&W,V=this.props.isSelectable,$=void 0===V?!!h&&s>-1:V,J=!(!O&&!M&&!f||X),K=z&&F?L+", "+F:L,Q=r.createElement(r.Fragment,null,L?r.createElement("span",{key:"label",id:this._labelId,className:o.css("ms-Tile-label",u.label)},K):null,p?this._onRenderBackground({background:p,hideBackground:w}):null,d?this._onRenderForeground({foreground:d,hideForeground:S}):null,x||T?this._onRenderNameplate({name:x,activity:T,onlyOnHover:!!I}):null),G=O?"a":M?"button":"span",Y=r.createElement(G,{href:O,onClick:M,download:_,hrefLang:D,media:P,target:B,rel:void 0===H?O&&B?"noopener":void 0:H,ref:this.props.linkRef,"data-selection-invoke":!!(J&&s>-1)||void 0,className:o.css("ms-Tile-link",l.link)},Q);return r.createElement("div",n.__assign({"aria-selected":z},o.getNativeProps(q,o.divProperties),{"aria-labelledby":L?this._labelId:this._nameId,"aria-describedby":K?this._descriptionId:this._activityId,className:o.css("ms-Tile",N,l.tile,(e={},e["ms-Tile--isSmall "+l.isSmall]="small"===k,e["ms-Tile--isLarge "+l.isLarge]="large"===k,e["ms-Tile--hasBackgroundFrame "+l.hasBackgroundFrame]=m,e["ms-Tile--hasForegroundFrame "+l.hasForegroundFrame]=y,e["ms-Tile--isSelected "+l.selected+" "+c.selected]=z,e["ms-Tile--isSelectable "+l.selectable]=$,e["ms-Tile--hasBackground "+l.hasBackground]=!!p,e[c.dark]=!!p&&!w,e["ms-Tile--showBackground "+l.showBackground]=!w,e["ms-Tile--invokable "+l.invokable]=J,e["ms-Tile--uninvokable "+l.uninvokable]=!J,e["ms-Tile--isDisabled "+l.disabled]=!$&&!J,e["ms-Tile--showCheck "+l.showCheck]=X,e["ms-Tile--isFluentStyling "+l.isFluentStyling]=j,e)),"data-is-focusable":!0,"data-is-sub-focuszone":!0,"data-disable-click-on-enter":!0,"data-selection-index":s>-1?s:void 0,"data-selection-touch-invoke":!!(J&&s>-1)||void 0}),Y,A?r.createElement("span",{key:"description",id:this._descriptionId,className:o.css("ms-Tile-description",u.description)},A):null,$?this._onRenderCheck({isSelected:z}):null)};t.prototype._onRenderBackground=function(e){var t,n=e.background,i=e.hideBackground,s="function"==typeof n?n(d(this.props)):n;return s?r.createElement("span",{key:"background",className:o.css("ms-Tile-background",l.background,(t={},t["ms-Tile-background--hide "+l.backgroundHide]=i,t))},s):null};t.prototype._onRenderForeground=function(e){var t,n=e.foreground,i=e.hideForeground,s="function"==typeof n?n(d(this.props)):n;return s?r.createElement("span",{key:"foreground",role:"presentation",className:o.css("ms-Tile-aboveNameplate",l.aboveNameplate)},r.createElement("span",{role:"presentation",className:o.css("ms-Tile-content",l.content)},r.createElement("span",{role:"presentation",className:o.css("ms-Tile-foreground",l.foreground,(t={},t["ms-Tile-foreground--hide "+l.foregroundHide]=i,t))},s))):null};t.prototype._onRenderNameplate=function(e){var t,n,i,s=e.name,u=e.activity,a=e.onlyOnHover;return r.createElement("span",{key:"nameplate",className:o.css("ms-Tile-nameplate",l.nameplate,(t={},t[l.onlyOnHover]=a,t))},s?r.createElement("span",{id:this._nameId,className:o.css("ms-Tile-name",l.name,(n={},n[l.onlyOnHover]=a,n))},s):null,u?r.createElement("span",{id:this._activityId,className:o.css("ms-Tile-activity",l.activity,(i={},i[l.onlyOnHover]=a,i))},u):null)};t.prototype._onRenderCheck=function(e){var t,n=e.isSelected,s=this.props.toggleSelectionAriaLabel;return r.createElement("span",{key:"check",role:"checkbox","aria-label":s,className:o.css("ms-Tile-check",l.check,h.checkHost,(t={},t[h.hostShowCheck]=this.state.isModal,t)),"data-selection-toggle":!0,"aria-checked":n},r.createElement(i.Check,{checked:n}))};return t})(r.Component);t.Tile=p;t.getTileLayout=function(e){return d(e.props)};function d(e){var n=e.contentSize,r=e.tileSize,i=void 0===r?"large":r;if(!n)return{};var s=n.width,o=t.TileLayoutSizes[i],u=o.nameplatePadding,a=o.nameplateMargin,f=o.nameplateActivityHeight,l=o.nameplateNameHeight,c=o.foregroundMargin,h=0;if(e.itemName||e.itemActivity){h+=2*u;e.itemName&&(h+=l);e.itemActivity&&(h+=f+a)}return{foregroundSize:{width:s-2*c,height:n.height-c-h},backgroundSize:n}}t.renderTileWithLayout=function(e,t){var i=e.type;return r.createElement(i,n.__assign({},e.props,t))}});
define("hO",["require","exports","d_","gO","bO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmerTile=n.styled(r.ShimmerTileBase,i.getStyles)});
define("gO",["require","exports","lC","r","d_","vO","Rl"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={small:{squareWidth:62,squareHeight:61,nameWidth:106,nameHeight:5,activityWidth:62,activityHeight:5},large:{squareWidth:96,squareHeight:96,nameWidth:144,nameHeight:7,activityWidth:96,activityHeight:7}},a=i.classNamesFunction(),f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;i.initializeComponentRef(n);return n}t.prototype.render=function(){var e=this.props,t=e.styles,n=e.contentSize,i=void 0===n?{width:176,height:171}:n,f=e.itemActivity,l=void 0===f||f,c=e.itemName,h=void 0===c||c,p=e.itemThumbnail,d=void 0===p||p,v=e.tileSize,m=void 0===v?"large":v,g=s.TileLayoutSizes[m],y=g.nameplatePadding,b=g.nameplateMargin,w=g.nameplateActivityHeight,E=g.nameplateNameHeight,S=u[m],x=S.squareWidth,T=S.squareHeight,N=S.nameWidth,C=S.nameHeight,k=S.activityWidth,L=S.activityHeight,A=0;if(h||l){A+=2*y;h&&(A+=E);l&&(A+=w+b)}this._classNames=a(t,{});return r.createElement("div",{className:this._classNames.root},r.createElement(o.ShimmerGap,{width:i.width,height:i.height-T-A}),r.createElement(o.ShimmerElementsGroup,{shimmerElements:[{type:o.ShimmerElementType.gap,width:(i.width-x)/2,height:T},d?{type:o.ShimmerElementType.line,width:x,height:T}:{type:o.ShimmerElementType.gap,width:x,height:T},{type:o.ShimmerElementType.gap,width:(i.width-x)/2,height:T}]}),l||h?r.createElement("div",null,r.createElement(o.ShimmerGap,{width:i.width,height:y}),h?r.createElement(o.ShimmerElementsGroup,{shimmerElements:[{type:o.ShimmerElementType.gap,width:(i.width-N)/2,height:E},{type:o.ShimmerElementType.line,width:N,height:C},{type:o.ShimmerElementType.gap,width:(i.width-N)/2,height:E}]}):null,l?r.createElement(o.ShimmerElementsGroup,{shimmerElements:[{type:o.ShimmerElementType.gap,width:(i.width-k)/2,height:w},{type:o.ShimmerElementType.line,width:k,height:L},{type:o.ShimmerElementType.gap,width:(i.width-k)/2,height:w}]}):null,r.createElement(o.ShimmerGap,{width:i.width,height:y})):null)};return t})(r.Component);t.ShimmerTileBase=f});
define("bO",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){return{root:["ms-ShimmerTile-root",{width:"100%",height:"100%",display:"flex",flexDirection:"column"}]}}});
define("aO",["require","exports","lC","r","iO","ap","Ps","Kf","$o","C1","Kr","fi","do"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=new c.KeyFacet("itemTile",{itemKey:c.stringPart(),itemIndex:c.numberPart()}),d={defaultClickActionElement:null,dragDropElement:null};function v(e){var t=e.performanceData,u=n.__rest(e,["performanceData"]),f=l.useShallowMemo(function(){return u},u),c=l.useShallowMemo(function(){return t},t),h=c.defaultClickActionElement;return o.useAction(h,r.useCallback(function(e){return(function(e){var t=e.invokeActionStateProps,o=e.performanceData,u=e.tileProps,f=o.dragDropElement,l=u.itemKey,c=u.selectionIndex,h=t.isAvailable;a.useInvokeAction(n.__assign(n.__assign({},t),{itemKey:l,index:c}));var p=r.useMemo(function(){return r.createElement(i.ItemTile,n.__assign({role:"listitem",invokeSelection:h,href:h?"javascript:;":void 0},u))},[u,h]);return r.useMemo(function(){return s.renderChildrenWithDropZoneElement(p,f)},[p,f])})({invokeActionStateProps:e,performanceData:c,tileProps:f})},[c,f]))[1]}var m=new h.ComputedItemFacet("itemTileData",function(e,t){var n=e.demandItemFacet(p,t.itemKey);if(n){var i=n.itemIndex,a=n.itemKey;return{defaultClickActionElement:o.evaluateAction(e,r.createElement(u.ItemDefaultClickAction,{itemKey:a})),dragDropElement:f.evaluateItemCacheComponent(e,r.createElement(s.ItemDefaultDropZone,{itemKey:a,layoutMode:"absolute",enableDrag:!0,itemIndex:i}))}}});t.ItemTileCell=f.createItemCacheComponent(function(e,t){var i=t.itemKey,s=t.selectionIndex,o=e.demandItemFacet(m,p.serialize({itemIndex:s,itemKey:i}))||d;return r.createElement(v,n.__assign({},t,{performanceData:o}))});t.ItemTileCell.displayName="ItemTileCell"});
define("iO",["require","exports","lC","r","mO","lO","c_","F_","SPListItemsScopeDeferred_IS_mini_css","V_","i_","np","Dp","rO","Ec","Un","wp","Rs","Jf","ey","h_","bI","So","t9","oi","C1","Lr","Lr","XC","Vf"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";a=a.ItemTile_8;Object.defineProperty(t,"__esModule",{value:!0});var O={small:{iconSize:48},large:{iconSize:64}},M=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=(e.itemKey,e.className),s=n.__rest(e,["itemKey","className"]);return r.createElement(i.Tile,n.__assign({},s,{className:v.css(a.defaultTile,t)}))};return t})(r.PureComponent),_=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onThumbnailLoad=function(){n.setState({thumbnailLoaded:!0})};n._onThumbnailError=function(){n.setState({thumbnailFailed:!0})};n.state={};return n}t.prototype.render=function(){var e=this,t=this.props,_=t.itemKey,D=t.className,P=t.itemTileMode,H=void 0===P?"document":P,B=t.background,j=t.foreground,F=n.__rest(t,["itemKey","className","itemTileMode","background","foreground"]),I=this.props,q=I.tileSize,R=void 0===q?"large":q,U=I.selectionIndex,z=this.state,W=z.thumbnailLoaded,X=z.thumbnailFailed;return r.createElement(d.WithItemCache,null,function(t){var d,P=t.itemCache;C.mark("ItemTile.render("+U+")");var I=k.now(),q=P.demandItem({displayName:g.displayNameFacet,dateModified:g.dateModifiedFacet,folder:g.folderFacet,oneNote:T.oneNoteFacet,isGroup:y.isGroupFacet,count:y.countFacet,isShared:g.isSharedFacet},_),z=q.displayName,V=q.folder,$=q.oneNote,J=q.isGroup,K=q.count,Q=q.isShared,G=P.demandItemFacet(E.itemTileControl,_),Y=E.itemTileControl.evaluate(G)(P,{itemKey:_,itemName:r.createElement(u.BaseText,{className:a.name,"data-automationid":"name",text:z||"",title:z||""}),itemActivity:r.createElement(x.DateRenderer,{itemKey:_}),tileAs:M,enableItemHoverCard:!0}),Z=Y.tileAs,ee=Y.itemName,te=Y.itemActivity,ne=Y.enableItemHoverCard,re=Y.folderCoverControlHandler,ie=l.getLifeCycleSignals(P,_,1,!0),se=ie&&ie.map(function(e){return e.signal}),oe=P.isItemFacetResolved(b.thumbnailFacet,_),ue=oe?P.demandItemFacet(b.thumbnailFacet,_):void 0,ae=P.demandItemFacet(c.itemAriaLabelControl,_),fe=h.getRowAriaLabel(P,{itemKey:_}),le=c.itemAriaLabelControl.evaluate(ae)(P,{itemKey:_,itemAriaLabel:fe}).itemAriaLabel,ce=P.demandItemFacet(S.enableFluentIconsFacet,S.configurationItemKey),he=h.getRowCheckboxAriaLabel(P,{itemKey:_}),pe=N.evaluateItemCacheComponent(P,ee),de=N.evaluateItemCacheComponent(P,te),ve=r.createElement(Z,n.__assign({itemKey:_,className:v.css(a.tile,D,(d={},d[a.hideThumbnail]=!W||!!X,d[a.hideFileTypeIcon]=!!W||!!ue&&!X,d)),itemName:pe?r.createElement(o.SignalField,{signalsFieldMode:"compact",before:se},pe):null,ariaLabel:le,toggleSelectionAriaLabel:he,"data-automationid":"ItemTile",itemActivity:de?r.createElement(o.SignalField,null,de):null},F,{showForegroundFrame:!("document"!==H||V&&!$),showBackgroundFrame:"media"===H,hideForeground:!!ue&&!W&&!X,hideBackground:!!ue&&!W,foreground:r.createElement("div",null)})),me=i.getTileLayout(ve),ge=me.foregroundSize,ye=void 0===ge?{width:0,height:0}:ge,be=me.backgroundSize,we=void 0===be?{width:0,height:0}:be,Ee=[],Se=[];if(V&&!$||J){var xe=E.itemTileFolderCoverControl.evaluate(re)(P,{itemKey:_,signalData:e._getFolderCoverSignalData(Q),folderCoverAs:s.FolderCover}),Te=xe.signalData,Ne=xe.folderCoverAs,Ce=Te&&Te.signal,ke=r.createElement(Ne,{key:"folder",itemKey:_,className:a.folderCover,folderCoverSize:e.props.tileSize,folderCoverType:"default",metadata:K?K.toLocaleString(m.Locale.language):K,signal:Ce,isFluent:ce}),Le=s.getFolderCoverLayout(ke).contentSize;Ee.push(s.renderFolderCoverWithLayout(ke,{children:K?r.createElement("span",{className:a.blankFolderCover,style:{width:Le.width+"px",height:Le.height+"px"}}):null}))}else if(X||oe&&!W&&!ue)oe&&W||Ee.push(N.evaluateItemCacheComponent(P,r.createElement(f.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:_,className:a.fileTypeIcon,preferAppIcon:!1,size:O[R].iconSize})));else{"media"===H?Se.push(N.evaluateItemCacheComponent(P,r.createElement(p.ItemThumbnail,{key:"thumbnail",itemKey:_,className:a.thumbnail,desiredSize:we,onError:e._onThumbnailError,onLoad:e._onThumbnailLoad}))):Ee.push(N.evaluateItemCacheComponent(P,r.createElement(p.ItemThumbnail,{key:"thumbnail",itemKey:_,className:a.thumbnail,desiredSize:ye,onError:e._onThumbnailError,onLoad:e._onThumbnailLoad})));Ee.push(N.evaluateItemCacheComponent(P,r.createElement(f.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:_,className:W?a.tileAppIcon:a.fileTypeIcon,size:W?16:O[R].iconSize,preferAppIcon:!!W})))}var Ae=N.evaluateItemCacheComponent(P,i.renderTileWithLayout(ve,{foreground:j||null===j?j:Ee.length>0?Ee:null,background:B||null===B?B:Se.length>0?Se:null})),Oe=ne&&w.getItemHoverCard(P,{itemKey:_}),Me=k.now()-I;L.tilesSelectorTime.add(Me);return r.createElement(A.RenderPerformanceMeasurer,{renderPerformanceCounter:L.tilesRenderTime},Oe?N.evaluateItemCacheComponent(P,r.createElement(Oe,{itemKey:_},Ae)):Ae)})};t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.itemKey!==this.props.itemKey&&this.setState({thumbnailLoaded:!1,thumbnailFailed:!1})};t.prototype._getFolderCoverSignalData=function(e){return{signal:e?r.createElement(o.SharedSignal,null):null,key:e?"shared":""}};return t})(r.PureComponent);t.ItemTile=_});
define("lO",["require","exports","lC","uO"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("uO",["require","exports","lC","fO","ea"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("fO",["require","exports","lC","r","d_","SPListItemsScopeDeferred_IS_mini_css","nc"],function(e,t,n,r,i,s,u){"use strict";var o=s.Signal_4;s=s.FolderCover_5;Object.defineProperty(t,"__esModule",{value:!0});var a=s,f=o,l=4,c={small:{width:72-2*l,height:44-2*l},large:{width:112-2*l,height:72-2*l}},h={small:{default:{back:"folderCoverSmallDefaultBack",front:"folderCoverSmallDefaultFront"},linked:{back:"folderCoverSmallLinkedBack",front:"folderCoverSmallLinkedFront"},media:{back:"folderCoverSmallMediaBack",front:"folderCoverSmallMediaFront"}},large:{default:{back:"folderCoverLargeDefaultBack",front:"folderCoverLargeDefaultFront"},linked:{back:"folderCoverLargeLinkedBack",front:"folderCoverLargeLinkedFront"},media:{back:"folderCoverLargeMediaBack",front:"folderCoverLargeMediaFront"}}},p=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,s=t.folderCoverSize,o=void 0===s?"large":s,l=t.folderCoverType,c=void 0===l?"default":l,p=t.hideContent,d=void 0!==p&&p,v=t.metadata,m=t.signal,g=t.children,y=(t.isFluent,n.__rest(t,["folderCoverSize","folderCoverType","hideContent","metadata","signal","children","isFluent"])),b=h[o][c],w=r.createElement("span",{className:i.css("ms-FolderCover-metadata",a.metadata)},v),E=r.createElement("span",{className:i.css("ms-FolderCover-signal",a.signal,f.isFluent)},m);return r.createElement("div",n.__assign({},y,{className:i.css(a.root,(e={},e["ms-FolderCover--isSmall "+a.isSmall]="small"===o,e["ms-FolderCover--isLarge "+a.isLarge]="large"===o,e["ms-FolderCover--isDefault "+a.isDefault]="default"===c,e["ms-FolderCover--isMedia "+a.isMedia]="media"===c,e["ms-FolderCover--isLinked "+a.isLinked]="linked"===c,e["ms-FolderCover--hideContent "+a.hideContent]=d,e["ms-FolderCover--isFluent "+a.isFluent]=!0,e))}),r.createElement(u.Icon,{"aria-hidden":!0,className:i.css("ms-FolderCover-back",a.back),iconName:b.back}),this._renderChildren({children:g}),r.createElement(u.Icon,{"aria-hidden":!0,className:i.css("ms-FolderCover-front",a.front),iconName:b.front}),r.createElement(r.Fragment,null,w,E))};t.prototype._renderChildren=function(e){var t=e.children,n="function"==typeof t?t(d(this.props)):t;return n?r.createElement("span",{className:i.css("ms-FolderCover-content",a.content)},r.createElement("span",{className:i.css("ms-FolderCover-frame",a.frame)},n)):null};return t})(r.Component);t.FolderCover=p;t.getFolderCoverLayout=function(e){return d(e.props)};function d(e){var t=e.folderCoverSize,r=void 0===t?"large":t;return{contentSize:n.__assign({},c[r])}}t.renderFolderCoverWithLayout=function(e,t){var i=e.type;return r.createElement(i,n.__assign({},e.props,t))}});
define("rO",["require","exports","lC","r","py","Un","en","SPListItemsScopeDeferred_IS_mini_css","ey","sO","Rs","oO","C1","xb","wo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";u=u.ItemThumbnail_6;Object.defineProperty(t,"__esModule",{value:!0});var v=p.createItemCacheInitializer(function(e){return function(t){e.previousProps||t(c.imageAddon)}});function m(e){var t=e.error,n=e.onError;r.useEffect(function(){n&&n({})},[t,n]);return null}t.ItemThumbnail=h.createItemCacheComponent(function(e,t){var c,h,p,y,b=t.itemKey,w=t.desiredSize,E=t.className,S=t.onError,x=t.onLoad,T=t.fitMode,N=void 0===T?"contain":T,C=e.isItemFacetResolved(a.thumbnailFacet,b),k=C?e.demandItemFacet(a.thumbnailFacet,b):void 0;if(!C||k){var L=e.demandItemFacet(i.itemThumbnailControl,b),A=i.itemThumbnailControl.evaluate(L)(e,{itemKey:b,originalImage:k,desiredSize:w,thumbnail:k}).thumbnail;if(A&&A.url){var O=f.imageByUrlKeyFacet.serialize({url:A.url});c=e.demandItemFacet(l.openUrlFacet,O);h=e.demandItemFacet(a.dimensionsFacet,O);p=e.demandItemFacet(d.errorFacet,O,{suppressGetItems:!0});if(!c&&!p)return r.createElement(v,null)}}if(!c&&!p)return null;if(p)return r.createElement(m,{error:p,onError:S});g(h)&&g(w)&&(y=o.fitContentToBounds({boundsSize:w,contentSize:h,mode:N}));return r.createElement(r.Fragment,null,r.createElement(v,null),r.createElement("img",n.__assign({alt:"",className:s.css(u.image,E),src:c,onLoad:x,onError:S},y?{style:{width:y.width+"px",height:y.height+"px"}}:{})))});t.ItemThumbnail.displayName="ItemThumbnail";function g(e){return!!e&&e.width>0&&e.height>0}});
define("sO",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.imageByUrlKeyFacet=new n.KeyFacet("imageByUrl",{url:n.stringPart()})});
define("oO",["require","exports","lC","Hm","sO","$1","Uo","Qn","Zn","Rs","Io","So","To","nv","ey"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function v(e){var t=this,r=i.imageByUrlKeyFacet.deserialize(e.itemKey).url;return function(i){return n.__awaiter(t,void 0,void 0,function(){var t,l,c,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:t=new o.Signal,l=t.resolve,c=t.reject,v=t.promise;(m=new Image).src=r;g=!!m.complete;y=new u.EventGroup(null);(b=new a.Async(void 0)).setTimeout(function(){c(new h.CancelError)},3e4);y.on(m,"load",function(){l()});y.on(m,"error",function(){c(new Error("Image failed to load."))});E.label=1;case 1:E.trys.push([1,,5,6]);return[4,v];case 2:E.sent();return!m.complete||g?[3,4]:[4,p.wait(30)];case 3:E.sent();E.label=4;case 4:i(s.resolveItems({items:(w={},w[e.itemKey]=n.__assign(n.__assign({},f.openUrlFacet.pack(r)),d.dimensionsFacet.pack({width:m.naturalWidth||m.width||0,height:m.naturalHeight||m.height||0})),w)}));return[3,6];case 5:b.dispose();y.dispose();return[7];case 6:return[2]}})})}}t.imageAddon=r.createAddon(function(){return function(e){var t=e(l.readConfiguration({maxParallelImageLoadCount:c.maxParallelImageLoadCountFacet})).maxParallelImageLoadCount,n=void 0===t?16:t;e(r.registerOperationHandler(i.imageByUrlKeyFacet,s.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:n})(v)))}})});
define("XC",["require","exports","Ff"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tilesRenderCount=n.createPerformanceCounter("itemTiles.render.count");t.tilesRenderTime=n.createPerformanceCounter("itemTiles.render",{dependentCounter:t.tilesRenderCount});t.tilesSelectorCount=n.createPerformanceCounter("itemTiles.selectStoreData.count");t.tilesSelectorTime=n.createPerformanceCounter("itemTiles.selectStoreData",{dependentCounter:t.tilesSelectorCount})});
define("nO",["require","exports","r","C1","Rs"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HeaderTileCell=r.connectToItemCache(function(e,t){return{text:e.demandItemFacet(i.displayNameFacet,t.itemKey)||""}})(function(e){return n.createElement("div",null,n.createElement("h3",null,e.text))})});
define("tO",["require","exports","r","C1","Ps","Kf","Kp","SPListItemsScopeDeferred_IS_mini_css","pd"],function(e,t,n,r,i,s,o,u,a){"use strict";u=u.ItemSetTilesList_2;Object.defineProperty(t,"__esModule",{value:!0});t.ShowAllTileCell=r.connectToItemCache(function(e,t){var r=t.itemKey,o=void 0===r?"":r;return{defaultClickAction:i.evaluateAction(e,n.createElement(s.ItemDefaultClickAction,{itemKey:o}))}})(function(e){var t=e.defaultClickAction;return n.createElement(i.WithAction,{action:t},function(e){return n.createElement("div",{className:u.showAllCell},n.createElement(a.Link,{onClick:function(){return e.execute({})}},o.default.ShowAll))})})});
define("JC",["require","exports","lC","r","Ap","Bs","SPListItemsScopeDeferred_IS_mini_css","gn","ZC","XC"],function(e,t,n,r,i,s,o,u,a,f){"use strict";o=o.ItemSetTilesList_2;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.props,i=r.selection,s=r.selectionItems;i&&i.setItems(s,!0);n._initPerfCounterRef=!1;return n}t.prototype.render=function(){var e=this.props,t=e.selection,s=e.selectionMode,u=(e.ref,e.disableMarqueeSelection),l=e.ariaLabel,d=(e.selectionItems,e.onRenderTilesList),v=e.enterModalSelectionOnTouch,m=n.__rest(e,["selection","selectionMode","ref","disableMarqueeSelection","ariaLabel","selectionItems","onRenderTilesList","enterModalSelectionOnTouch"]);if(!this._initPerfCounterRef){if(void 0===f.tilesSelectorCount.read()){f.tilesSelectorCount.reset();f.tilesSelectorTime.reset();f.tilesRenderCount.reset();f.tilesRenderTime.reset()}this._initPerfCounterRef=!0}var g=d(n.__assign({className:o.root,"aria-label":l,role:"grid",onRenderRoot:h,onRenderRow:p},m)),y=t?r.createElement(i.SelectionZone,{selection:t,selectionMode:s,onItemInvoked:this.props.onItemInvoked,onItemContextMenu:this.props.onItemContextMenu,disableAutoSelectOnInputElements:!0,enterModalOnTouch:v,enableTouchInvocationTarget:!0},r.createElement(a.SELECTION_CONTEXT.Provider,{value:t},g)):g;return t?u?y:r.createElement(i.MarqueeSelection,{selection:t,onShouldStartSelection:c},y):g};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.selection,n=e.selectionItems;t&&t.setItems(n,e.setKey!==this.props.setKey||!e.setKey)};return t})(r.PureComponent);t.InjectableItemSetTilesList=s.withLayoutRenderComplete({qosName:"Tiles"})(l);function c(e){return!u.findElementRecursive(e.target,function(e){return null!==e.getAttribute("data-selection-index")})}function h(e,t){return e&&t?t(n.__assign(n.__assign({},e),{divProps:n.__assign(n.__assign({},e.divProps),{"aria-colcount":e.columnCount,"aria-rowcount":e.rowCount})})):null}function p(e,t){return e&&t?t(n.__assign(n.__assign({},e),{divProps:n.__assign(n.__assign({},e.divProps),{role:"row"})})):null}});
define("vH",["require","exports","lC","r","Sl","LH","AH","wH","IH","yH"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DropTargetHook=function(e){return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(o.DropTargetHookWrapper,n.__assign({},e)))};t.DragSourceHook=function(e){var t=e.dragSourceKey,i=e.type;return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(u.DragSourceHookWrapper,n.__assign({},e)),e.showDefaultDragPreview?null:r.createElement(u.DragLayerHookWrapper,{dragSourceKey:t,type:i},r.createElement(a.DragLayerPreview,null)))};t.DragDropHook=r.memo(function(e){var t=e.dragDropKey,i=e.dragType;return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(f.DragDropHookWrapper,n.__assign({},e)),e.showDefaultDragPreview?null:r.createElement(u.DragLayerHookWrapper,{dragSourceKey:t,type:i,as:l,getItemStyles:c},r.createElement(a.DragLayerPreview,null)))});var l=r.forwardRef(function(e,t){return r.createElement(i.Layer,null,r.createElement("div",{className:e.className,ref:t},e.children))});function c(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y,l="translate("+a+"px, "+(f-=s.top)+"px)";return{transform:l,WebkitTransform:l}}});
define("IH",["require","exports","r","me","G_","OH","SPListItemsScopeDeferred_IS_mini_css","V_","xH","Ec"],function(e,t,n,r,i,s,o,u,a,f){"use strict";o=o.DragLayerPreview_5;Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){var t=e.draggedItem,a=t.dragSourceKey,f=t.itemKeys,l=void 0===f?[]:f,c=l[0]||a,h=l.length>0?l.length:a?1:0,p="",d=null;if(h<1)return null;p=r.format(r.getLocalizedCountValue(s.default.dragMoveItemsPreviewText,s.default.dragMoveItemsPreviewTextIntervals,h)||"",h);d=1===h?n.createElement(u.ItemFileTypeIcon,{itemKey:c,size:20,className:o.dragPreviewIcon}):n.createElement(u.FileTypeIcon,{type:i.FileIconType.genericFile,size:20,className:o.dragPreviewIcon});return p?n.createElement("div",{className:o.dragPreviewRoot},d||null,n.createElement("span",{className:o.dragPreviewText},p)):null};t.DragLayerPreview=n.memo(function(e){var t=e.draggedItem,r=n.useCallback(function(e){var r=e.itemCache;if(!t)return null;var i=t.dragSourceKey,s=t.itemKeys,o=s||[i],u=r.demandItemFacet(a.dragLayerPreviewControl,i),f=a.dragLayerPreviewControl.evaluate(u)(r,{itemKeys:o,dragLayerPreviewRenderer:l}).dragLayerPreviewRenderer;return n.createElement(f,{draggedItem:t})},[t?t.dragSourceKey:void 0]);return n.createElement(f.WithItemCache,null,r)})});
define("xH",["require","exports","Dr","ec"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dragLayerPreviewControl=new n.ControlFacet("dragLayerPreviewControl",{dragLayerPreviewRenderer:r.defaultRenderComponentOption()})});
define("yH",["require","exports","r","r","DH","wH","AH","SH"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DragDropHookWrapper=function(e){var t=e.dragDropKey,a=e.dragType,f=e.acceptType,l=e.showDefaultDragPreview,c=e.hookCallback,h=e.handlers,p=!!h.canDragHandler,d=s.useDragSpec({dragSourceKey:t,type:a,handlers:h,collectDragAvailability:!1}),v=i.useDrag(d),m=v[0],g=v[1],y=v[2];r.useEffect(function(){p&&y&&!l&&y(u.getEmptyImage(),{captureDraggingState:!0})},[p,y,l]);var b=o.useDropSpec({acceptType:f,dropTargetKey:t,handlers:h}),w=i.useDrop(b),E=w[0],S=w[1];r.useEffect(function(){c({collectedDragProps:m,collectedDropProps:E,connectDragSource:g,connectDropTarget:S})},[m,E,g,y,S]);return e.children?n.createElement(n.Fragment,null,e.children):null}});
define("bVe",["require","exports","r","Uc","gR","Un","Rs","p_","sd","bw","Ec","_y","Rs","oy","me","gVe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";m=m.SocialBar_2;Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=n.useState(!0),i=t[0],c=t[1],h=function(){return c(!1)};return n.createElement(l.WithItemCache,null,function(t){var c,p=t.itemCache,y=p.demandItemFacet(o.analyticsItemFacet,e.itemKey),b=y&&y.itemKey,w=p.demandItemFacet(u.likeCountFacet,b);return n.createElement(f.Panel,{className:m.socialBarPanel,closeButtonAriaLabel:v.default.panelCloseAriaLabel,customWidth:"320px",isOpen:i,onDismiss:h,isBlocking:!0,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},type:f.PanelType.custom,onDismissed:e.resolve,headerText:""+(c=Number(w),d.format(d.getLocalizedCountValue(v.default.panelLikesHeaderText,v.default.panelLikesHeaderTextInterval,c)||"",c))},(function(e){return n.createElement(l.WithItemCache,null,function(t){var i=t.itemCache,u=i.demandItemFacet(o.likedByItemFacet,e.itemKey),f=i.demandItemFacet(o.likedByPeopleFacet,u&&u.likedByItemKey),l=f&&f.personKeys;return n.createElement("div",{className:s.css(m.socialBarPanelContent)},l&&l.length>0&&(function(e){return n.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical},n.createElement(a.List,{className:m.socialBarList,items:e&&e.map(function(e){return{key:e}}),onRenderCell:g}))})(l))})})(e))})};function g(e,t,r){return e&&n.createElement(l.WithItemCache,null,function(r){var s=r.itemCache,o=e&&e.key,u=s.demandItemFacet(c.userHoverCardControl,o),a=s.demandItemFacet(h.displayNameFacet,o),f=s.demandItemFacet(p.emailFacet,o),l=c.userHoverCardControl.evaluate(u)(s,{personKey:o}).userHoverCard,d=n.createElement(i.ActivityItem,{className:m.socialBarPanelPersona,activityPersonas:[{imageUrl:f,imageAlt:a}],activityDescription:n.createElement("div",{className:m.socialBarPanelPersonaDescription},a)});return l?n.createElement(l,{personKey:o,key:t},d):d})}});
define("gR",["require","exports","lC","vR"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("vR",["require","exports","lC","r","SR","yR","MU"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._onRenderIcon=function(e){return e.activityPersonas?i._onRenderPersonaArray(e):i.props.activityIcon};i._onRenderActivityDescription=function(e){var t=i._getClassNames(e),n=e.activityDescription||e.activityDescriptionText;return n?r.createElement("span",{className:t.activityText},n):null};i._onRenderComments=function(e){var t=i._getClassNames(e),n=e.comments||e.commentText;return!e.isCompact&&n?r.createElement("div",{className:t.commentText},n):null};i._onRenderTimeStamp=function(e){var t=i._getClassNames(e);return!e.isCompact&&e.timeStamp?r.createElement("div",{className:t.timeStamp},e.timeStamp):null};i._onRenderPersonaArray=function(e){var t=i._getClassNames(e),s=null,u=e.activityPersonas;if(u[0].imageUrl||u[0].imageInitials){var a=[],f=u.length>1||e.isCompact,l=e.isCompact?3:4,c=void 0;e.isCompact&&(c={display:"inline-block",width:"10px",minWidth:"10px",overflow:"visible"});u.filter(function(e,t){return t<l}).forEach(function(e,i){a.push(r.createElement(o.PersonaCoin,n.__assign({},e,{key:e.key||i,className:t.activityPersona,size:f?o.PersonaSize.size16:o.PersonaSize.size32,style:c})))});s=r.createElement("div",{className:t.personaContainer},a)}return s};return i}t.prototype.render=function(){var e=this.props,t=e.onRenderIcon,n=void 0===t?this._onRenderIcon:t,i=e.onRenderActivityDescription,s=void 0===i?this._onRenderActivityDescription:i,o=e.onRenderComments,u=void 0===o?this._onRenderComments:o,a=e.onRenderTimeStamp,f=void 0===a?this._onRenderTimeStamp:a,l=e.animateBeaconSignal,c=e.isCompact,h=this._getClassNames(this.props);return r.createElement("div",{className:h.root,style:this.props.style},(this.props.activityPersonas||this.props.activityIcon||this.props.onRenderIcon)&&r.createElement("div",{className:h.activityTypeIcon},l&&c&&r.createElement("div",{className:h.pulsingBeacon}),n(this.props)),r.createElement("div",{className:h.activityContent},s(this.props,this._onRenderActivityDescription),u(this.props,this._onRenderComments),f(this.props,this._onRenderTimeStamp)))};t.prototype._getClassNames=function(e){return i.getClassNames(s.getStyles(void 0,e.styles,e.animateBeaconSignal,e.beaconColorOne,e.beaconColorTwo,e.isCompact),e.className,e.activityPersonas,e.isCompact)};return t})(r.Component);t.ActivityItem=u});
define("SR",["require","exports","oc","us"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassNames=r.memoizeFunction(function(e,t,r,i){return{root:n.mergeStyles("ms-ActivityItem",t,e.root,i&&e.isCompactRoot),pulsingBeacon:n.mergeStyles("ms-ActivityItem-pulsingBeacon",e.pulsingBeacon),personaContainer:n.mergeStyles("ms-ActivityItem-personaContainer",e.personaContainer,i&&e.isCompactPersonaContainer),activityPersona:n.mergeStyles("ms-ActivityItem-activityPersona",e.activityPersona,i&&e.isCompactPersona,!i&&r&&2===r.length&&e.doublePersona),activityTypeIcon:n.mergeStyles("ms-ActivityItem-activityTypeIcon",e.activityTypeIcon,i&&e.isCompactIcon),activityContent:n.mergeStyles("ms-ActivityItem-activityContent",e.activityContent,i&&e.isCompactContent),activityText:n.mergeStyles("ms-ActivityItem-activityText",e.activityText),commentText:n.mergeStyles("ms-ActivityItem-commentText",e.commentText),timeStamp:n.mergeStyles("ms-ActivityItem-timeStamp",e.timeStamp,i&&e.isCompactTimeStamp)}})});
define("yR",["require","exports","oc","us"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.memoizeFunction(function(){return n.keyframes({from:{opacity:0},to:{opacity:1}})}),s=r.memoizeFunction(function(){return n.keyframes({from:{transform:"translateX(-10px)"},to:{transform:"translateX(0)"}})});t.getStyles=r.memoizeFunction(function(e,t,r,o,u,a){var f;void 0===e&&(e=n.getTheme());var l={animationName:n.PulsingBeaconAnimationStyles.continuousPulseAnimationSingle(o||e.palette.themePrimary,u||e.palette.themeTertiary,"4px","28px","4px"),animationIterationCount:"1",animationDuration:".8s",zIndex:1},c={animationName:s(),animationIterationCount:"1",animationDuration:".5s"},h={animationName:i(),animationIterationCount:"1",animationDuration:".5s"},p={root:[e.fonts.small,{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",boxSizing:"border-box",color:e.palette.neutralSecondary},a&&r&&h],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:0},a&&r&&l],isCompactRoot:{alignItems:"center"},personaContainer:{display:"flex",flexWrap:"wrap",minWidth:"32px",width:"32px",height:"32px"},isCompactPersonaContainer:{display:"inline-flex",flexWrap:"nowrap",flexBasis:"auto",height:"16px",width:"auto",minWidth:"0",paddingRight:"6px"},activityTypeIcon:{height:"32px",fontSize:"16px",lineHeight:"16px",marginTop:"3px"},isCompactIcon:{height:"16px",minWidth:"16px",fontSize:"13px",lineHeight:"13px",color:e.palette.themePrimary,marginTop:"1px",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",selectors:{".ms-Persona-imageArea":{margin:"-2px 0 0 -2px",border:"2px solid"+e.palette.white,borderRadius:"50%",selectors:(f={},f[n.HighContrastSelector]={border:"none",margin:"0"},f)}}},activityPersona:{display:"block"},doublePersona:{selectors:{":first-child":{alignSelf:"flex-end"}}},isCompactPersona:{display:"inline-block",width:"8px",minWidth:"8px",overflow:"visible"},activityContent:[{padding:"0 8px"},a&&r&&c],activityText:{display:"inline"},isCompactContent:{flex:"1",padding:"0 4px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden"},commentText:{color:e.palette.neutralPrimary},timeStamp:[e.fonts.tiny,{fontWeight:400,color:e.palette.neutralSecondary}],isCompactTimeStamp:{display:"inline-block",paddingLeft:"0.3em",fontSize:"1em"}};return n.concatStyleSets(p,t)})});
define("wV",["require","exports","lC","r","Un","Zc","am","Qn","sf","cs","us","Hs","tv","oi","ev","Dp","Jo","np","h_","V_","Ps","Vs","Kf","Ec","Rs","O1","LV","SPListItemsScopeDeferred_IS_mini_css","EV"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";k=k.ItemCard_8;Object.defineProperty(t,"__esModule",{value:!0});var A=d.afterPageLoad()(h.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["wO"],t,n)})];case 1:return[2,t.sent().ItemsContextMenu]}})})})),O=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._checkElementRef=r.createRef();n._onCardClick=function(e){if(!n._isSelectionCheckElement(e.target)){var t=e;if(!t||t.which===l.KeyCodes.enter||"click"===t.type){n.props.onItemInvoked(e);e.preventDefault();e.stopPropagation()}}};n._isSelectionCheckElement=function(e){return!!(e===n._checkElementRef.current||e&&e.parentElement===n._checkElementRef.current||e.parentElement&&e.parentElement.parentElement===n._checkElementRef.current)};n._onCardHover=function(e){n.props.telemetry(c.Engagement).logData({name:"ItemCard.Hover",isIntentional:!0})};n._openMenu=function(e){n.setState({isMenuOpen:!0});e.preventDefault();e.stopPropagation()};n._closeMenu=function(){n.setState({isMenuOpen:!1})};n._emptyRender=function(){return null};n._onSelectionChange=function(){var e=n.props,t=e.selection,r=e.selectionIndex,i=void 0===r?-1:r,s=i>-1&&!!t&&t.isIndexSelected(i);n.setState({isSelected:s})};n._events=new u.EventGroup(n);var i=t.selectionIndex,s=void 0===i?-1:i,o=t.selection,a=!!o&&s>-1&&o.isIndexSelected(s);n.state={isMenuOpen:!1,isSelected:a};return n}t.prototype.componentDidMount=function(){var e=this.props.selection;e&&this._events&&this._events.on(e,f.SELECTION_CHANGE,this._onSelectionChange)};t.prototype.componentWillUnmount=function(){this._events&&this._events.dispose()};t.prototype.componentDidUpdate=function(e){var t=this.props.selection,n=e.selection;if(t!==n){n&&this._events&&this._events.off(n);t&&this._events&&this._events.on(t,f.SELECTION_CHANGE,this._onSelectionChange)}};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.props,n=t.selection,r=t.selectionIndex,i=e.selection,s=e.selectionIndex,o=void 0===s?-1:s;if(n!==i||r!==o){var u=!!i&&o>-1&&i.isIndexSelected(o);this.setState({isSelected:u})}};t.prototype.render=function(){var e=this.props,t=e.itemKey,i=e.headerElement,s=e.cardIndex,o=e.hideThumbnail,u=e.isSelectable,f=e.selectionIndex,l=void 0===f?-1:f,c=e.ariaLabel,h=n.__assign({},m.selectedItemsControl.pack(function(){return{itemKeys:[t]}})),p=this.state.isSelected,d=p?c+", "+C.default.isSelected:c;return r.createElement("div",{className:k.itemCard,onClick:this._onCardClick,onKeyDown:this._onCardClick,"data-is-focusable":!0,onMouseEnter:this._onCardHover,onContextMenu:this._openMenu,"aria-label":d,key:s,role:"listitem","data-selection-index":l>-1?l:void 0,"aria-selected":u?p:void 0,"data-is-sub-focuszone":!0,"data-automationid":"itemCard","data-disable-click-on-enter":!0},i?r.createElement(i,{itemKey:t,cardIndex:s}):null,o?null:r.createElement(L.ItemCardThumbnail,n.__assign({},this.props)),this._renderFooter(),r.createElement(N.ControlHandlerProvider,{controlHandlers:h},r.createElement(A,{target:this._menuTarget,isOpen:this.state.isMenuOpen,directionalHint:a.DirectionalHint.bottomRightEdge,onDismiss:this._closeMenu})),u?this._renderCheck({isSelected:p}):null)};t.prototype._renderFooter=function(){var e=this,t=this.props,n=t.displayName,i=t.itemKey,s=t.fileHoverCard,u=t.itemActivityElement,a=t.folder,f=t.inlineFileIcon,l=f?k.bottomSectionWithIcon:k.bottomSection,c=f?k.fileNameWithIconContainer:k.fileNameContainer;l=u?k.bottomSectionWithActivity:l;c=u?k.fileNameContainerWithActivity:c;var h=r.createElement("div",{className:k.fileIcon},r.createElement(b.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:i,className:k.fileTypeIcon,size:32})),p=r.createElement("div",{dir:"auto",className:c},r.createElement("div",{dir:"auto",className:k.fileName},n)),d=r.createElement("div",{className:k.commandButtonContainer},r.createElement(o.IconButton,{onRenderMenuIcon:this._emptyRender,className:k.commandButton,iconProps:{iconName:"MoreVertical"},onClick:this._openMenu})),v=r.createElement("div",{className:k.menuTarget,ref:function(t){return e._menuTarget=t}}),m=u&&r.createElement("div",{className:k.activityContainer},u),g=r.createElement("div",{className:l},f?h:null,p,d,v),y=r.createElement("div",{className:l},r.createElement("div",{className:k.bottomSectionNamePlate},f?h:null,p,d,v),m);return a&&!s?u?y:g:s?r.createElement(s,{itemKey:i},u?y:g):g};t.prototype._renderCheck=function(e){var t=e.isSelected;return r.createElement("span",{key:"check",role:"checkbox",ref:this._checkElementRef,"aria-label":C.default.toggleCheckArialLabel,className:t?i.css(k.check,k.selected):i.css(k.check,k.unselected),"data-selection-toggle":!0,"data-selection-index":this.props.selectionIndex,"aria-checked":t},r.createElement(s.Check,{checked:t}))};return t})(r.PureComponent),M=E.withTelemetry()(O);t.ItemCard=function(e){return r.createElement(x.WithItemCache,null,function(t){var i=t.itemCache,s=e.itemKey,o=e.qosElement,u=i.demandItem({displayName:T.displayNameFacet,fileName:T.fileNameFacet,folder:T.folderFacet,oneNote:p.oneNoteFacet,openUrl:T.openUrlFacet},s),a=i.demandItemFacet(g.itemAriaLabelControl,s),f=g.itemAriaLabelControl.evaluate(a)(i,{itemKey:s,itemAriaLabel:v.getRowAriaLabel(i,{itemKey:s})}).itemAriaLabel,l=y.getItemHoverCard(i,{itemKey:s});return r.createElement(r.Fragment,null,o?r.createElement(o,n.__assign({},e)):null,r.createElement(w.WithAction,{action:r.createElement(S.ItemDefaultClickAction,{itemKey:s})},function(t){var i=n.__assign(n.__assign(n.__assign({},e),u),{ariaLabel:f,onItemInvoked:function(e){return t.execute({event:e}).catch(function(){})},fileHoverCard:l});return r.createElement(M,n.__assign({},i))}))})}});
define("EV",["require","exports","lC","r","P1","NM","A","rO","V_","Vs","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";l=l.ItemCard_8;Object.defineProperty(t,"__esModule",{value:!0});var c={".doc":!0,".docm":!0,".docx":!0,".dot":!0,".dotm":!0,".dotx":!0,".odt":!0},h={width:296,height:0},p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onThumbnailLoad=function(){if(n._qos){n._qos.end({resultType:i.ResultType.success});n._qos=void 0}n.setState({thumbnailLoaded:!0})};n._onThumbnailFailed=function(){if(n._qos){n._qos.end({resultType:i.ResultType.failure});n._qos=void 0}n.setState({thumbnailFailed:!0})};n.state={thumbnailLoaded:!1,thumbnailFailed:!1};return n}t.prototype.componentDidMount=function(){var e=this.props,t=e.telemetry,n=e.telemetryPrefix;this._qos=new(t(o.Qos))({name:n+".itemCard.thumbnail"})};t.prototype.render=function(){var e=this.props,t=e.itemKey,n=e.fileName,i=e.folderCoverElement,o=e.folder,f=e.oneNote,p=n?n.extension:void 0,d=c[p||""]?l.previewVertical:l.previewHorizontal;return this.state.thumbnailLoaded?r.createElement("div",{className:l.previewContainer},r.createElement("div",{className:l.thumbnailOverlay}),r.createElement(u.ItemThumbnail,{key:"thumbnail",itemKey:t,className:d,desiredSize:h}),r.createElement(s.BrandIcon,{className:l.appIcon,extension:p||"",size:32,isOneNote:!!f})):this.state.thumbnailFailed?r.createElement("div",{className:l.previewContainer},r.createElement(a.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:t,className:l.fileTypeIcon,size:64})):r.createElement("div",{className:l.previewContainer},r.createElement("div",{className:l.previewHidden},r.createElement(u.ItemThumbnail,{key:"thumbnail",itemKey:t,desiredSize:h,onLoad:this._onThumbnailLoad,onError:this._onThumbnailFailed})),o&&i?r.createElement("div",{className:l.fileTypeIcon},i):r.createElement(a.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:t,className:l.fileTypeIcon,size:64}))};return t})(r.PureComponent);t.ItemCardThumbnail=f.withTelemetry()(p)});
define("IN",["require","exports","lC","y7","dS","ai","wy","xo","ii","li","be","yr"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNeedsAttentionView=function(e,t,h){var p=f.spListKeyFacet.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),d=h(u.readItem({list:a.listFacet},p)),v=d&&d.list&&d.list.templateType&&s.isGenericList(d.list.templateType),m=v?"LinkTitle":"LinkFilename",g={},y=[];if(e)for(var b=0,w=e;b<w.length;b++){var E=w[b];if(E.contentTypeId&&E.requiredFields&&E.requiredLookups){for(var S={fieldName:"ContentTypeId",operator:"Eq",values:[E.contentTypeId]},x=i.filterToCaml(S),T=[],N=E.requiredFields.split(","),C=E.requiredLookups.split(","),k=0;k<N.length;k++){var L=N[k],A="True"===C[k];void 0===g[L]&&(g[L]=A);var O={fieldName:L,lookupId:!!A||void 0,operator:"Eq",values:[""]};T.push(O)}var M=i.filtersToCaml(T,"Or");if(M){var _=i.filtersToCaml([x,M],"And");y.push(_)}}}0===y.length&&y.push(i.filterToCaml({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var D=Object.keys(g),P=D.map(function(e){return g[e]}),H=n.__spreadArrays(["DocIcon",m,"Editor","Modified"],D,["FileDirRef"]),B=n.__spreadArrays([void 0,void 0,void 0,void 0],P,[void 0]),j=!!d&&!!d.list&&!!d.list.templateType&&d.list.templateType===s.default.webPageLibrary,F=new r.default("<View Scope='Recursive'/>");j&&l.default.isFeatureEnabled({ODB:1743})?F.title=o.default.PagesThatNeedAttention:F.title=v?o.default.ItemsThatNeedAttention:o.default.FilesThatNeedAttention;F.isReadOnly=!0;F.id=c.needsAttentionViewId;F.replaceFields(H,B);F.updateSort({fieldName:"ID",isAscending:!0});F.updateRowLimit({rowLimit:30,isPerPage:!0});var I=i.filtersToCaml(y,"Or");F.addFilters([I]);return F}});
define("uA",["require","exports","lC","jA","BA","EA","DA","pA","fA"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t)});
define("DA",["require","exports","lC","li","Hm","wA","li","ii","xv","OA","CA","de","ko","Hm","Rs","S0","rs","oi","Vm","P1","So","Io","f7","Xo","ce","xA","Qn","IA","Jf","c6","jr"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDeleteSingleItemUrl=s.getDeleteSingleItemUrl;t.spItemDeleteItemsOperationHandler=i.createBatchedItemsOperationHandler()(M);function M(e){var t=this;return function(M){return n.__awaiter(t,void 0,void 0,function(){var t,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge;return n.__generator(this,function(ye){switch(ye.label){case 0:t=e.items;_=void 0;D=void 0;P=void 0;H=void 0;B=M(N.getSharePointDataEventSource);j={};F=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n],s=j[i];s&&s.id&&t.push(s.id)}t.length&&C.EventGroup.raise(B,k.SPGridEvents.deleteCompletedEventName,{itemIds:t})};I=[];q=M(E.readConfiguration({enableOverrideDeleteFileLocks:w.enableOverrideDeleteFileLocksFacet,enableDeleteCommandForMountPointConfiguration:u.enableDeleteCommandForMountPointConfigurationFacet})),R=q.enableOverrideDeleteFileLocks,U=q.enableDeleteCommandForMountPointConfiguration;z=function(e){H=t[e].currentItemSetKey;var n=M(m.readItems(function(t){return t.demandItem({key:r.spItemKeyFacet,folder:d.folderFacet,uniqueId:u.uniqueIdFacet,folderPath:u.folderPathFacet,oneNote:g.oneNoteFacet,itemId:u.listItemIdFacet,mountPoint:u.mountPointFacet},e)}));if(n)if(U&&n.mountPoint)I.push(e);else if(n.key&&n.folderPath){D=n.key.webAbsoluteUrl;P=n.key.listFullUrl;if(!_){var i=o.spListKeyFacet.serialize({webAbsoluteUrl:D,listFullUrl:P}),s=M(m.readItems(function(e){return e.demandItemFacet(u.listFacet,i)}));_={webAbsoluteUrl:D,listFullUrl:P,items:[],deletionType:f.default.Recycle,listId:s&&s.id}}var a={key:e,serverRelativeItemUrl:n.folderPath,id:n.itemId,uniqueId:n.uniqueId,isFolder:!!n.folder||!!n.oneNote};_.items.push(a);j[a.key]=a}};for(W=0,X=Object.keys(t);W<X.length;W++){V=X[W];z(V)}if(!(I&&I.length>0))return[3,2];$={currentItemSetKey:H};J={items:O.makeObject(I,function(){return $})};return[4,M(A.removeFromOneDrive(J))];case 1:ye.sent();ye.label=2;case 2:K=_;Q=[];G=M(m.readItems(function(e){return D&&P?e.demandItemFacet(u.spPageContextFacet,o.spPageContextKeyFacet.serialize({webAbsoluteUrl:D,listFullUrl:P})):void 0}));if(!K||!K.items.length)return[3,7];if(1!==K.items.length)return[3,4];Y=K.items[0];Z=s.getDeleteSingleItemUrl({webAbsoluteUrl:K.webAbsoluteUrl,listFullUrl:K.listFullUrl,deletionType:K.deletionType,listId:K.listId,serverRelativeItemUrl:Y.serverRelativeItemUrl,uniqueId:Y.uniqueId,isFolder:!!Y.isFolder,itemId:Y.id});ee={};K.deletionType===f.default.PermanantDelete&&(ee["X-HTTP-Method"]="DELETE");ue=t[Object.keys(t)[0]];(te=!!ue.breakLock)&&(ee.Prefer="bypass-shared-lock");return[4,M(a.getData({webAbsoluteUrl:K.webAbsoluteUrl,listFullUrl:P||"",url:Z,body:void 0,method:"POST",additionalHeaders:ee,qosName:"deleteSingleItem",telemetryHandler:function(e){var t=e.errorData,r=e.eventData;if(t){var i=t.status===h.STATUS_CODE_ZERO||R&&t.code&&t.code.indexOf("-2130575306")>-1?b.ResultType.expectedFailure:b.ResultType.failure;return{eventData:n.__assign(n.__assign({},r),{resultType:i})}}return{eventData:r}}})).then(function(){Q.push(Y.key);F(Q)}).catch(function(e){if(e instanceof a.GetDataError){if(e.code&&e.code.indexOf("-2130575306")>-1){R&&M(S.logEngagement({name:"DeleteOperationFileLockedWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:e.code,overrideFileLocksEnabled:R,isBatch:!1}}));throw new h.ItemOperationError({innerError:e,facets:n.__assign({},v.fileLockedErrorFacet.pack({}))})}te&&M(S.logEngagement({name:"DeleteOperationOverrideFilelockedFailed",isIntentional:!1,extraData:{errorCode:e.code,overrideFileLocksEnabled:R,isBatch:!1}}));if(e.errorData.status===h.STATUS_CODE_ZERO)throw new h.ItemOperationError({innerError:e,facets:n.__assign({},v.offlineErrorFacet.pack({}))})}throw e})];case 3:ye.sent();return[3,6];case 4:if(!(K.items.length>1))return[3,6];ne=c.default.generate();re="multipart/mixed; boundary=batch_"+ne;return[4,M(a.getData({webAbsoluteUrl:K.webAbsoluteUrl,listFullUrl:P||"",url:l.DataBatchOperationHelper.getBatchOperationUrl(K.webAbsoluteUrl),body:i(K,ne),method:"POST",additionalHeaders:void 0,contentType:re,parseResponse:function(e){return l.DataBatchOperationHelper.processBatchResponse(e,K.items)},qosName:"deleteMultipleItems"})).then(function(e){for(var t=0,r=e.items;t<r.length;t++){!(u=r[t]).error&&u.key&&Q.push(u.key)}F(Q);if(e.hasError){for(var i={items:{}},s=0,o=e.items;s<o.length;s++){var u;if((u=o[s]).error&&u.key){var a=u.error.code&&"-2130575306"===u.error.code.toString();R&&M(S.logEngagement({name:"DeleteOperationFileLockedInBatchWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:u.error.code,overrideFileLocksEnabled:R,isBatch:!0}}));i.items[u.key]=new h.ItemOperationError({message:u.error.message,facets:a?n.__assign({},v.fileLockedErrorFacet.pack({})):void 0})}}throw new p.BatchedItemsOperationHandlerError(i)}return Promise.resolve({data:e})})];case 5:ye.sent();ye.label=6;case 6:ie=new y.ItemResolver;for(se=0,oe=K.items;se<oe.length;se++){ue=oe[se];ie.invalidateItems({items:(ve={},ve[ue.key]=[d.deletedFacet],ve)});ie.resolveItems({items:(me={},me[ue.key]=d.deletedFacet.pack({}),me)})}ae=!G||!T.getKillSwitch(G).isActivated("C5C6F559-B975-4336-BEFB-0483A5A24929","02/14/2020","Resolve remaining items for current itemSet after delete to avoid going back to first page for current itemSet.");fe=!G||!T.getKillSwitch(G).isActivated("53BF5F56-AF6E-4509-AB0C-6E6F3923C492","08/07/2020","Do not resolve remaining items for current itemSet after delete for group by view");ae&&H&&Q.length&&(le=M(m.readItems(function(e){var t=e.demandItemFacet(x.childItemsFacet,H);if(t&&t.itemKeys){for(var n=[],i=0,s=t.itemKeys;i<s.length;i++){var u=s[i];if(fe&&o.spItemGroupKeyFacet.matches(u))return;var a=e.demandItemFacet(r.spItemKeyFacet,u),f=a&&r.spItemKeyFacet.serialize(a)||u;Q.indexOf(f)<0&&n.push(u)}return n}})))&&ie.resolveItems({items:(ge={},ge[H]=x.childItemsFacet.pack({itemKeys:le}),ge)});if(!G||!T.getKillSwitch(G).isActivated("126A8F89-8146-4B38-A8DE-6F115DCF594C","03/26/2020","Invalidate parent folder countFacet of the deleted items")){ce=function(e){var t,n=M(m.readItems(function(t){return t.demandItemFacet(d.parentFolderItemFacet,e)}));n&&n.itemKey&&ie.invalidateItems({items:(t={},t[n.itemKey]=[L.countFacet],t)})};for(he=0,pe=Q;he<pe.length;he++){de=pe[he];ce(de)}}M(ie.execute());ye.label=7;case 7:return[2]}})})};function i(e,t){var n=e.items,r=e.deletionType===f.default.PermanantDelete?"DELETE":"POST",i=e.deletionType===f.default.PermanantDelete?"If-Match: *":l.DataBatchOperationHelper.defaultBatchRequestPostData,o=n.map(function(t){return s.getDeleteSingleItemUrl({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,deletionType:e.deletionType,serverRelativeItemUrl:t.serverRelativeItemUrl,uniqueId:t.uniqueId,isFolder:t.isFolder,listId:e.listId,itemId:t.id})});return l.DataBatchOperationHelper.getBatchContentExtended(t,o,r,i)}}t.deleteItemsCore=M});
define("wA",["require","exports","A8","OA"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDeleteSingleItemUrl=function(e){var t=e.webAbsoluteUrl,i=e.listFullUrl,s=e.serverRelativeItemUrl,o=e.deletionType,u=e.uniqueId,a=e.isFolder,f=e.listId,l=e.itemId,c=n.getWebApiUrl({webAbsoluteUrl:t,listOrItemFullUrl:i});c=a?u?c.method("GetFolderById",u):c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:s}):f&&l?c.method("Lists",f).method("GetItemById",l):c.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:s});o===r.default.Recycle&&(c=c.segment("recycle"));return c.toString()}});
define("OA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"})(n||(n={}));t.default=n});
define("IA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.startExitingQuickEditEventName="startExitingQuickEdit";e.quickEditWriteChangesToListEventName="quickEditWriteChangesToList";e.deleteCompletedEventName="quickEditDeleteCompleted";e.switchGridLayout="switchGridLayout";e.undoChangeEventName="quickEditUndoChange";e.redoChangeEventName="quickEditRedoChange";e.undoRealCmdCountChangeEventName="quickEditUndoRealCmdCountChange";e.redoRealCmdCountChangeEventName="quickEditRedoRealCmdCountChange";e.gridGlobalsInitialized="gridGlobalsInitialized";return e})();t.SPGridEvents=n;t.default=n});
define("pA",["require","exports","lC","xv","Me","sS","_g","$1","Rs","zm","Xo","oi","w","ii","J6","eA","A8","vA","Oh","xo","So","li","bA","g6","rs","mA"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C={ODB:1561},k={ODB:1234},L=!1;t.createDocumentsCore=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de;return n.__generator(this,function(ve){switch(ve.label){case 0:O=t.itemKey,M=t.options,_=M.documentType,D=M.fileName,P=M.newDocumentKey,H=M.templateItemKey,B=M.targetWindow;j=E.spItemKeyFacet.deserialize(O);F=j.rootFolder||new s.SimpleUri(j.listFullUrl).path;I=new i.ItemUrlHelperBasic({context:{webAbsoluteUrl:j.webAbsoluteUrl,listUrl:j.listFullUrl}});q=I.getUrlParts({path:F});R=new y.default(null);U=e(b.readItem({createDocumentFormDigest:p.spCreateDocumentFormDigestFacet,spCookieDomainConfiguration:p.spCookieDomainConfigurationFacet},w.configurationItemKey)),z=U.createDocumentFormDigest,W=U.spCookieDomainConfiguration;X=!W||new s.SimpleUri(W).authority!==new s.SimpleUri(j.webAbsoluteUrl).authority;L=e(T.readItems(function(e){return x.isFeatureEnabled(e,{feature:k})}));if(H||!z||X||!(_===o.DocumentType.Word||_===o.DocumentType.PowerPoint||_===o.DocumentType.Bohemia||_===o.DocumentType.Prague||_===o.DocumentType.Visio&&L))return[3,5];"_layouts/15";V=_===o.DocumentType.Prague?"prague":"doc";$=j.webAbsoluteUrl+"/_layouts/15/"+V+".aspx";if(!e(T.readItems(function(e){return x.isFeatureEnabled(e,{feature:C})})))return[3,2];J=e(b.readItem({folderUniqueId:p.uniqueIdFacet},O)).folderUniqueId;return[4,g.createDocumentByDocAspxWithItemUrlParts(_,$,j.webAbsoluteUrl,R,B,D,q,void 0,J)];case 1:ve.sent();return[3,4];case 2:return[4,g.createDocumentByDocAspxWithItemUrlParts(_,$,j.webAbsoluteUrl,R,B,D,q)];case 3:ve.sent();ve.label=4;case 4:e(f.invalidateItems({items:(ce={},ce[O]=[l.defaultChildItemSetFacet],ce)}));return[3,11];case 5:K="";Q=void 0;if(G=e(T.readItems(function(e){return e.demandItemFacet(E.spNewDocumentTemplateKeyFacet,H)})))if((Y=e(b.readItem({documentTemplate:p.newDocumentTemplateFacet},H)).documentTemplate)&&Y.url){Q=Y;K=Y.url}else K=G.templateUrl;Z=N.getCreateDocumentUrl({webAbsoluteUrl:j.webAbsoluteUrl,listFullUrl:j.listFullUrl,parentFolderPath:q.listRelativeItemUrl||"",docType:_,docName:D,templateUrl:K});return[4,e(r.getData({webAbsoluteUrl:j.webAbsoluteUrl,listFullUrl:j.listFullUrl,url:Z,method:"POST",parseResponse:function(e){return e},qosName:"createDocument",noRedirect:!0}))];case 6:ee=ve.sent();te=N.getRedirectUrlFromResponse({responseText:ee,documentType:_,fileName:D}),ne=te.redirectUrl;if(!(re=te.originalEditLink))return[3,10];ie=h.deserializeQuery(h.getQueryStringFromUrl(re.toLowerCase()));se=ie.sourcedoc;oe=se&&d.normalizeLower(se);ue=v.getDocExtension(_);if(!(ae=Q)||!ae.url)return[3,9];fe=(function(e){var t=e.listFullUrl,n=e.uniqueId,r=e.webAbsoluteUrl;return m.getListApiUrl({webAbsoluteUrl:r,listFullUrl:t}).methodWithAliases("GetItemByUniqueId",{uniqueId:n}).toString()})({listFullUrl:j.listFullUrl,webAbsoluteUrl:j.webAbsoluteUrl,uniqueId:oe});return[4,e(r.getData({listFullUrl:j.listFullUrl,webAbsoluteUrl:j.webAbsoluteUrl,url:fe,method:"POST",parseResponse:A,qosName:"getItemByUniqueId",noRedirect:!0}))];case 7:return(le=ve.sent())?[4,e(S.updateListItem({items:(he={},he[E.spItemKeyFacet.serialize({itemId:le,listFullUrl:j.listFullUrl,webAbsoluteUrl:j.webAbsoluteUrl})]={formValues:[{FieldName:"ContentTypeId",FieldValue:ae.contentTypeId||""}],qosName:"updateTemplateDocContentType"},he)}))]:[3,9];case 8:ve.sent();ve.label=9;case 9:e(u.resolveItems({items:(pe={},pe[P]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},ne?a.openUrlFacet.pack(ne):{}),a.fileNameFacet.pack({name:D||"",extension:ue})),oe?p.uniqueIdFacet.pack(oe):{}),c.oneNoteFacet.pack(_===o.DocumentType.OneNote?{}:void 0)),l.parentItemFacet.pack({itemKey:O})),pe)}));ve.label=10;case 10:e(f.invalidateItems({items:(de={},de[O]=[l.defaultChildItemSetFacet],de)}));ve.label=11;case 11:return[2]}})})};function A(e){if(e)try{var t=JSON.parse(e);if(t&&t.d&&t.d.Id)return t.d.Id}catch(e){}return""}});
define("bA",["require","exports","ko","gA"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateListItem=n.implementOperation({operationTypeFacet:r.updateListItemOperation})});
define("fA",["require","exports","lC","xv","li","Me","sS","V7","ko","P1","zm","Rs","S0","$1","rs","A8","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameItemCore=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;return n.__generator(this,function(R){switch(R.label){case 0:g=t.itemKey,y=t.options.names;b=Object.keys(y)[0];w=y[b].newName;E=e(d.readItems(function(e){return e.demandItem({existingFileName:c.fileNameFacet,spItemKey:i.spItemKeyFacet,listItemId:m.listItemIdFacet,isFolder:c.folderFacet},g)})),S=E.existingFileName,x=E.spItemKey,T=E.listItemId,N=E.isFolder;C=x||i.spItemKeyFacet.deserialize(g);if(!(k=T||C.itemId))throw new Error("Cannot find itemId for itemKey: "+g);L=C.rootFolder||new o.SimpleUri(C.listFullUrl).path;A=new s.ItemUrlHelperBasic({context:{webAbsoluteUrl:C.webAbsoluteUrl,listUrl:C.listFullUrl}});O=A.getUrlParts({path:L});M=A.getUrlParts({path:C.webAbsoluteUrl});_=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return v.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).toString()})({webAbsoluteUrl:C.webAbsoluteUrl,listFullUrl:C.listFullUrl,itemId:k});D={};return(P=M.serverRelativeItemUrl)?[3,2]:[4,e(r.getData({webAbsoluteUrl:C.webAbsoluteUrl,listFullUrl:C.listFullUrl,url:(U={webAbsoluteUrl:C.webAbsoluteUrl,listFullUrl:C.listFullUrl},z=U.webAbsoluteUrl,W=U.listFullUrl,X=v.getListApiUrl({webAbsoluteUrl:z,listFullUrl:W}).segment("ParentWeb").segment("ServerRelativeUrl"),X.toString()),method:"POST",qosName:"GetWebUrl",noRedirect:!0})).then(function(e){P=e.d.ServerRelativeUrl})];case 1:R.sent();R.label=2;case 2:if(!P&&O.serverRelativeListUrl){(H=O.serverRelativeListUrl.indexOf("/lists/"))<0&&(H=O.serverRelativeListUrl.lastIndexOf("/"));H>=0&&(P=O.serverRelativeListUrl.substring(0,H))}(B=O.serverRelativeListUrl)&&(D.__metadata={type:u.getListEntityTypeName(B,P)});j=(j=S&&S.extension?w+S.extension:w).trim();D.FileLeafRef=j;N&&(D.Title=j);(F={})["X-HTTP-Method"]="MERGE";F["If-Match"]="*";F.Prefer="bypass-shared-lock";return[4,e(r.getData({webAbsoluteUrl:C.webAbsoluteUrl,listFullUrl:C.listFullUrl,url:_,method:"POST",body:JSON.stringify(D),additionalHeaders:F,qosName:"renameItem",telemetryHandler:function(e){var t=e.errorData,r=e.eventData;if(t){var i=!1;(t.status===a.STATUS_CODE_ZERO||t.code&&(t.code.indexOf("-2130575257")>-1||t.code.indexOf("-2147024894")>-1||t.code.indexOf("-2147024891")>-1))&&(i=!0);var s=i?f.ResultType.expectedFailure:f.ResultType.failure;return{eventData:n.__assign(n.__assign({},r),{resultType:s})}}return{eventData:r}}})).catch(function(e){if(e instanceof r.GetDataError&&e.errorData.status===a.STATUS_CODE_ZERO)throw new a.ItemOperationError({facets:n.__assign({},h.offlineErrorFacet.pack({})),innerError:e});throw e})];case 3:R.sent();e(l.invalidateItems({items:(I={},I[g]=[c.displayNameFacet],I)}));e(p.resolveItems({items:(q={},q[g]=n.__assign(n.__assign({},c.displayNameFacet.pack(S&&S.extension?w+S.extension:w)),c.fileNameFacet.pack({name:w,extension:S&&S.extension||""})),q)}));return[2]}var U,z,W,X})})}});
define("VT",["require","exports","lC","hU","_U","b8","c8","mU","pU","rP","uU","$T","Fy","JT","YT","GT","zT","OM","ML"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t);n.__exportStar(d,t);n.__exportStar(v,t);n.__exportStar(m,t);n.__exportStar(g,t);n.__exportStar(y,t)});
define("hU",["require","exports","lC","r","bU"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,s=e.launchBehaviorType;if(n&&void 0!==s){if("dialog"===s)return r.createElement(i.IFrameDialog,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===s?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(r.PureComponent);t.OpenAsHyperLinkExecutor=s});
define("bU",["require","exports","lC","r","Uc","kw","Zd","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";u=u.IFrameDialog_9;Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,a=t.url,f=(t.heightOffset,n.__rest(t,["url","heightOffset"])),l=this.state.isIFrameLoaded;return r.createElement(s.Dialog,n.__assign({className:u.IFrameDialog,hidden:!this.state.isOpen,type:s.DialogType.close},f),r.createElement(i.FocusZone,null,!l&&r.createElement(o.Spinner,{size:o.SpinnerSize.large}),r.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:a,style:{display:l?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(r.Component);t.IFrameDialog=a});
define("_U",["require","exports","lC","r"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(r.PureComponent);t.OpenAsShortcutExecutor=i});
define("mU",["require","exports","lC","C1","ks","Es","li","ii","eS","Rs","Rs","NP","g6"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={ODB:670};t.OpenInBFileAction=r.connectToItemCache(function(e,t){var r=t.itemKey,i=e.demandItem({key:o.spItemKeyFacet,itemUrl:l.vroomUrlFacet},r),d=i.key,v=i.itemUrl,m="",g="",y="",b=!1,w=!1;if(d&&v){var E=e.demandItemFacet(u.spPageContextFacet,o.spPageContextKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));h.isFeatureEnabled(e,{feature:p,pageContext:E})&&(w=!0);var S=o.spListKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}),x=e.demandItem({driveUrl:u.driveUrlFacet},S).driveUrl;if(x){var T=a.getDriveItemKey(x);if(T){m=T.driveId||"";var N=e.demandItemFacet(f.fileNameFacet,r);if(N){y=N.name;(T=a.getDriveItemKey(v))&&(b=!!(g=T.itemId||""))}}}}var C,k=d?c.btoa("spo:"+d.webAbsoluteUrl):void 0;if(w){var L=e.demandItemFacet(f.canonicalUrlFacet,r)||"",A=d?d.webAbsoluteUrl:"";C="https://www.office.com/launch/fluid/content?drive="+m+"&item="+g+"&file="+encodeURIComponent(L)+"&siteUrl="+encodeURIComponent(A)}else C="https://fluidpreview.office.net/p/"+k+"/"+m+"/"+g+"/"+encodeURIComponent(y);return n.__assign({isAvailable:b,onExecute:b?function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(C);return[2]})})}:void 0},s.getItemActionEngagement(e,{itemKey:r,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(i.Action)});
define("pU",["require","exports","lC","r","_s","ks","$1","Xo","li","ii","y7","Ps","Xf","zm","Es","C1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemSwitchViewAction=v.createItemCacheComponent(function(e,t){var i=t.itemKey,v=t.itemSetKey,m=t.viewId,g=t.currentDerivedView,y=e.demandItemFacet(a.spItemKeyFacet,i);if(!y)return null;var b=y.webAbsoluteUrl,w=y.listFullUrl,E=e.demandItemFacet(a.spFolderItemSetKeyFacet,v),S=a.spFolderItemSetKeyFacet.serialize({webAbsoluteUrl:b,listFullUrl:w,rootFolder:E&&E.rootFolder||"",viewKey:{viewId:m}}),x=g&&a.spViewKeyFacet.serialize({viewId:g.id}),T=e.isItemFacetResolved(f.serverViewFacet,x)?e.demandItemFacet(f.serverViewFacet,x):void 0,N=d.getItemActionEngagement(e,{itemKey:i,engagement:{name:"SwitchView",isIntentional:!0}}),C=e.dispatch,k=c.evaluateAction(e,r.createElement(h.ItemOpenAction,{itemKey:S}));return r.createElement(c.WithAction,{action:k},function(e){var t=e.isAvailable,a=e.execute;return r.createElement(s.Action,n.__assign({isAvailable:t,isToggled:g?m===g.id:""===m,onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,s;return n.__generator(this,function(c){switch(c.label){case 0:C(o.resolveItems({items:n.__assign(n.__assign({},x?(t={},t[x]=n.__assign(n.__assign({},f.showViewModifiedIndicatorFacet.pack(!1)),T&&g&&g.isDirty()?n.__assign({},f.currentDerivedViewFacet.pack(new l.default(T))):{}),t):{}),i?(r={},r[S]=n.__assign({},u.parentItemFacet.pack({itemKey:i})),r):{})}));x&&g&&g.isDirty()&&C(p.invalidateItems({items:(s={},s[x]=[f.serverViewFacet,f.currentDerivedViewFacet],s)}));return[4,a(e)];case 1:c.sent();return[2]}})})}},N))})});t.SwitchViewExecutor=i.withCurrentItem()(t.ItemSwitchViewAction)});
define("uU",["require","exports","lC","r","ii","PT","To","ZP","fU","me","Nr","xo","pU","C_","li","tv","Ar","k1","C1","F1","Xo","Gk","X1","Vm","zm","ce","Zf"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=N.Killswitch.isActivated("93C218F9-D649-4531-939E-C60EAEA4509C","06/08/2020","Use switchViewAction after save existing view"),L=new l.AutoKeyFacet("saveViewProgressBatch"),A=v.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["tH"],t,n)})];case 1:return[2,t.sent().SaveViewDialog]}})})});function O(){return L.serializeNext()}var M=p.asAutoAction()(h.SwitchViewExecutor);function _(e){var t=this,l=e.viewTitle,h=e.isPublicView,p=e.onViewSaved,v=e.currentViewKey,y=e.itemSetKey,b=e.itemsScopeItemKey,N=e.listViewSetKey,L=e.reject,_=e.resolve,D=r.useState(!0),P=D[0],H=D[1],B=r.useState(O)[0],j=r.useState(),F=j[0],I=j[1],q=r.useState(),R=q[0],U=q[1],z=g.useItemCacheDispatch(),W=m.useEventHandler(function(){U(!0);p&&p();_()}),X=z(c.readItem({currentDerivedView:i.currentDerivedViewFacet},v)).currentDerivedView,V=m.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,o,l,h,m,g,A;return n.__generator(this,function(O){switch(O.label){case 0:t=e.viewTitle,r=e.isPublicView;o=X&&X.title!==t;l=z(c.readItem({deserializedSetKey:d.spFolderItemSetKeyFacet},y)).deserializedSetKey;return o&&l&&X?[4,z(u.getViewData({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}))]:[3,3];case 1:if(O.sent().some(function(e){return e.serverView.Title===t}))throw new Error(f.format(a.default.SaveViewErrorCannotOverwrite,t));return[4,z(s.createView({items:(g={},g[N]={views:(A={},A[t]={itemSetKey:y,isPublic:r,sourceView:X,progressItemKey:B},A)},g)}))];case 2:O.sent();if(h=z(c.readItem({createdViewKey:d.spViewKeyFacet},B)).createdViewKey){I(h.viewId);H(!1)}return[3,5];case 3:if(!b){L(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,z((M={itemsScopeItemKey:b,listViewSetKey:N,itemSetKey:y,currentViewKey:v},function(e){var t,r,s=M.itemsScopeItemKey,o=M.listViewSetKey,u=M.itemSetKey,a=M.currentViewKey,f=e(c.readItem({childItems:w.childItemsFacet,parentItem:w.parentItemFacet,deserializedItemSetKey:d.spFolderItemSetKeyFacet},u)),l=f.childItems,h=f.parentItem,p=f.deserializedItemSetKey;return e(E.saveViewCore({items:(t={},t[o]={views:(r={},r[a]={itemSetKey:u},r)},t)})).then(function(){var t,r;if(p){var o=d.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},p),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),u=e(c.readItem({filterOptionSets:w.filterOptionSetsFacet},o)).filterOptionSets;if(u&&p.filterParams){var f={};for(var v in u)u.hasOwnProperty(v)&&(f[u[v]]=!0);e(S.clearItems({items:f}))}var m=new x.ItemResolver;m.resolveItems({items:(t={},t[o]=n.__assign(n.__assign({},l?w.childItemsFacet.pack(l):{}),h?w.parentItemFacet.pack(h):{}),t[a]=n.__assign({},i.showViewModifiedIndicatorFacet.pack(!1)),t)});e(m.execute());e(T.invalidateItems({items:(r={},r[a]=[i.serverViewFacet,i.currentDerivedViewFacet],r[o]=[w.childItemsFacet],r)}));k&&e(C.openItem({itemsScopeItemKey:s,currentItemKey:o}))}})}))];case 4:O.sent();if(k){p&&p();_()}else if(m=z(c.readItem({savedViewKey:d.spViewKeyFacet},v)).savedViewKey){I(m.viewId);H(!1)}O.label=5;case 5:return[2]}var M})})}),$=m.useEventHandler(function(){L(new o.CancelError)});return P?r.createElement(A,{viewTitle:l,isPublicView:h,onContinue:V,onCancel:$}):!R&&F?r.createElement(M,{viewId:F,currentDerivedView:X,onComplete:W,itemSetKey:y}):null}t.ViewCreator=y.createItemCacheComponent(function(e,t){var i=b.getItemsScope(e).itemsScopeItemKey;return r.createElement(_,n.__assign({},t,{itemsScopeItemKey:i}))})});
define("$T",["require","exports","lC","r","ii","li","C1","Xo","$1","To","Rs","ks","Ec","Ps","Xf","Es","g6","lU","m7","eU","nS","ce","tv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x={ODB:1352},T=S.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["yU"],t,n)})];case 1:return[2,t.sent().FilterPanel]}})})}),N=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,o=t.itemSetKey,f=t.filterableSet,l=t.internalName,y=t.filterOptionSet,b=t.fieldType,w=t.checkedFilterKeys;return r.createElement(h.WithItemCache,null,function(t){var h=t.itemCache,S=t.dispatch;if(!(l&&f&&y&&b))return r.createElement(p.WithAction,null);var T,N=h.demandItemFacet(u.parentItemFacet,o),C=h.demandItemFacet(s.spFolderItemSetKeyFacet,o),k=C&&C.viewKey&&s.spViewKeyFacet.serialize(C.viewKey);C&&(T=h.demandItemFacet(i.spPageContextFacet,s.spPageContextKeyFacet.serialize({webAbsoluteUrl:C.webAbsoluteUrl,listFullUrl:C.listFullUrl})));for(var L=!(T&&E.getKillSwitch(T).isActivated("8E2ACEEF-1A9C-46FC-9D2D-9E95937355D1","07/07/2020","Include filter display value in filter params for datetime column")||"DateTime"!==b),A=[],O=[],M={},_=0,D=y;_<D.length;_++){var P=D[_];M[P.value]=P}for(var H=0,B=w;H<B.length;H++){var j=B[H];if(M[j]){A.push(M[j].value);O.push(M[j].display)}}var F,I=f.getFilteredItemSetKey({filterField:l,filterValues:A,filterType:b,useLookupId:!1,filterDisplays:L?O:void 0}),q=h.demandItemFacet(s.spFolderItemSetKeyFacet,I),R=m.isFeatureEnabled(h,{feature:x,pageContext:T});if(R){var U=h.demandItemFacet(g.filterActionControl,o),z=g.filterActionControl.evaluate(U)(h,{viewKey:k}).onFilter;F=z}var W=v.getItemActionEngagement(h,{itemKey:o,engagement:{name:"ApplyFilters",isIntentional:!0}});return r.createElement(p.WithAction,{action:r.createElement(d.ItemOpenAction,{itemKey:I})},function(t){var s=t.isAvailable,o=t.execute;return r.createElement(c.Action,n.__assign({isAvailable:s,onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r,s;return n.__generator(this,function(f){switch(f.label){case 0:if(R&&F){e=q&&q.filterParams;S(F({filterParams:e}))}S(a.resolveItems({items:n.__assign((r={},r[I]=n.__assign({},u.parentItemFacet.pack(N)),r),k?(s={},s[k]=n.__assign({},i.showViewModifiedIndicatorFacet.pack(!0)),s):{})}));return[4,o(t)];case 1:f.sent();return[2]}})})}},W))})})};return t})(r.PureComponent),C=o.connectToItemCache(function(e,t){var o=t.columnKey,a=t.itemSetKey,f=e.demandItem({fieldType:i.fieldTypeFacet,mappedColumnFieldType:i.mappedColumnFieldTypeFacet,internalName:i.internalNameFacet},o),l=f.fieldType,c=f.mappedColumnFieldType,h=f.internalName,p=e.demandItem({deserializedSetKey:s.spFolderItemSetKeyFacet,filterableSet:i.spFilterableSetFacet,filterOptionSets:u.filterOptionSetsFacet},a),d=p.deserializedSetKey,v=p.filterableSet,m=p.filterOptionSets,g=d&&e.demandItemFacet(i.spPageContextFacet,s.spPageContextKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})),E=d&&e.demandItemFacet(i.spPeoplePickerDataSourceFacet,s.spPeoplePickerDataSourceKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})),S=e.demandItemFacet(i.filterOptionSetFacet,m&&m[o]),x=e.isItemFacetResolved(i.filterOptionSetFacet,m&&m[o]),T=v&&S&&v.appliedFilters&&h&&v.appliedFilters[h]?v.appliedFilters[h].values:[],C=d&&d.viewKey&&s.spViewKeyFacet.serialize(d.viewKey),k=C&&e.demandItemFacet(i.currentDerivedViewFacet,C),L=e.dispatch,A="User"===l||"UserMulti"===l||c===y.ColumnFieldType.Text||c===y.ColumnFieldType.Title?{pageContextForPicker:g,peoplePickerDataSource:E,getFilterSuggestions:function(e,t,r){return n.__awaiter(void 0,void 0,void 0,function(){var i,s;return n.__generator(this,function(n){i=[];if(k&&d){s=b.getViewXmlWithContainsFilter(k.getEffectiveViewXml(),e,t,r);return[2,L(w.getServerData({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl,currentPageContext:g,qosName:"FilterPanel.GetFilterSuggesitons",viewXml:s,rootFolder:d.rootFolder})).then(function(t){if(t.ListData&&t.ListData.Row){var n={};t.ListData.Row.forEach(function(t){var r=t[e],s={display:r,value:r};if(!n.hasOwnProperty(s.value)){n[s.value]=s;i.push(s)}})}return i})]}return[2,i]})})}}:void 0;return{filterOptionSet:S||[],mappedColumnFieldType:void 0!==c?c:y.ColumnFieldType.Text,fieldInternalName:h||"",applyFiltersAction:function(e){return r.createElement(N,n.__assign({},e,{itemSetKey:a,filterableSet:v,fieldType:l,internalName:h}))},isLoading:!x,checkedFilterValues:T,filterPickerProps:A}})(T);t.LaunchFilterPanelAction=o.createItemCacheComponent(function(e,t){var i=t.columnKey,o=t.itemSetKey,u=t.isToggled,a=e.demandItemFacet(l.displayNameFacet,i),h=e.demandItemFacet(g.filterActionControl,o),d=e.demandItemFacet(s.spFolderItemSetKeyFacet,o),m=d&&d.viewKey&&s.spViewKeyFacet.serialize(d.viewKey),y=g.filterActionControl.evaluate(h)(e,{viewKey:m,isAvailable:!0}).isAvailable,b=p.renderComponentOnExecute(function(e){return r.createElement(C,{onClose:function(){e.reject(new f.CancelError)},onComplete:function(){e.resolve()},columnName:a||"",columnKey:i,itemSetKey:o})});return r.createElement(c.Action,n.__assign({isAvailable:y,isToggled:u,onExecute:b},v.getItemActionEngagement(e,{itemKey:o,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})});
define("lU",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterActionControl=new n.ControlFacet("filterActionControl")});
define("Fy",["require","exports","lC","Hy"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("Hy",["require","exports","lC","Oy","Xo","li","pr","F1","U1","os"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SortAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["MVe"],t,n)})];case 1:return[2,t.sent().SortActionExecutor]}})})},function(e,t){var r=t.sortFieldKey,i=t.itemSetKey,o=t.isAscending,l=e.demandItemFacet(s.spFolderItemSetKeyFacet,i);if(!l)return!1;var c=u.getItemsScope(e).itemsScopeItemKey;if(!c)return!1;var h=s.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},l),{sortFieldKey:r,sortAscending:o})),p=e.demandItemFacet(a.openActionControl,h),d=a.openActionControl.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(f.currentItemFacet,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,u=t.isAscending,a=e.demandItemFacet(s.spFolderItemSetKeyFacet,r);if(!a)return!1;var f=e.demandItemFacet(i.sortFacet,r),l=f&&e.demandItemFacet(o.spListFieldKeyFacet,f.columnKey),c=l&&l.internalName||a.sortFieldKey,h=f?f.isAscending:a.sortAscending;return c===n&&h===u})});
define("JT",["require","exports","lC","XT"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("XT",["require","exports","lC","Oy","li","ii","ZT","ai","A1","lr","hr"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupByAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["YT"],t,n)})];case 1:return[2,t.sent().GroupByActionExecutor]}})})},function(e,t){var r=t.groupByFieldKey,c=t.itemSetKey,h=e.demandItemFacet(i.spFolderItemSetKeyFacet,c);if(!h)return!1;var p=l.spListKeyFacet.serialize(h),d=e.demandItemFacet(s.listFacet,p),v=d&&d.templateType===u.default.mySiteDocumentLibrary,m=a.getConfiguration(e,{enableGroupByInOneDrive:s.enableGroupByInOneDriveFacet}).enableGroupByInOneDrive,g=e.demandItemFacet(s.defaultGroupByFieldsFacet,c),y=h.groupByFieldKey===r||!!g&&-1!==g.indexOf(r),b=i.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},h),{groupByFieldKey:y?void 0:r})),w=h.viewKey&&f.spViewKeyFacet.serialize(h.viewKey),E=e.demandItemFacet(o.groupByActionControl,c);return o.groupByActionControl.evaluate(E)(e,{itemSetKey:c,viewKey:w,groupedItemSetKey:b,isAvailable:!v||!!m}).isAvailable},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,o=e.demandItemFacet(i.spFolderItemSetKeyFacet,r);if(!o)return!1;var u=e.demandItemFacet(s.defaultGroupByFieldsFacet,r);return o.groupByFieldKey===n||!!u&&-1!==u.indexOf(n)})});
define("ZT",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupByActionControl=new n.ControlFacet("groupByActionControl")});
define("YT",["require","exports","lC","r","li","ks","Xo","ii","Xo","Xf","Ps","Es","C1","Vm","rT"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupByActionExecutor=h.createItemCacheComponent(function(e,t){var v=t.groupByFieldKey,m=t.itemSetKey,g=e.demandItemFacet(i.spFolderItemSetKeyFacet,m);if(!g)return r.createElement(l.WithAction,null);var y=e.demandItemFacet(u.defaultGroupByFieldsFacet,m),b=!g.groupByFieldKey&&!!y&&-1!==y.indexOf(v),w=g.groupByFieldKey===v||b,E=i.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},g),{groupByFieldKey:w?void 0:v})),S=i.spItemKeyFacet.serialize(g),x=g.viewKey&&i.spViewKeyFacet.serialize(g.viewKey),T=e.demandItemFacet(u.currentDerivedViewFacet,x),N=c.getItemActionEngagement(e,{itemKey:m,engagement:{name:"GroupBy",isIntentional:!0}}),C=e.dispatch,k=h.evaluateItemCacheComponent(e,r.createElement(f.ItemOpenAction,{itemKey:E}));return r.createElement(l.WithAction,{action:k},function(e){var t=e.execute;return r.createElement(s.Action,n.__assign({onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,i,s,f,l,c,h,m;return n.__generator(this,function(g){switch(g.label){case 0:r=new p.ItemResolver;if(x&&b&&T&&(i=T.getDomParts())&&i.groupBy){s=d.parseGroupBy(i.groupBy);f=void 0;s.group1.fieldName===v?s.group2&&(f={isCollapsed:s.isCollapsed,group1:s.group2}):(null===(m=s.group2)||void 0===m?void 0:m.fieldName)===v&&(f={isCollapsed:s.isCollapsed,group1:s.group1});T.updateGroupBy(f);r.invalidateItems({items:(l={},l[E]=[a.childItemsFacet],l[x]=[u.currentDerivedViewFacet],l)})}r.resolveItems({items:n.__assign((c={},c[E]=n.__assign({},o.parentItemFacet.pack({itemKey:S})),c),x?(h={},h[x]=n.__assign({},u.showViewModifiedIndicatorFacet.pack(!0)),h):{})});C(r.execute());return[4,t(e)];case 1:g.sent();return[2]}})})}},N))})})});
define("GT",["require","exports","lC","C1","ks","li","ii","E4","KT","g6","li","ii","Es"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={ODB:1318},d=!1;t.ModifyColumnAction=r.connectToItemCache(function(e,t){var r=t.itemSetKey,i=t.modifyType,u=t.columnKey,a=!1,v=e.demandItem({setKey:s.spFolderItemSetKeyFacet,canModifySchema:o.canModifySchemaFacet},r),m=v.setKey,g=v.canModifySchema,y=m&&m.viewKey?s.spViewKeyFacet.serialize(m.viewKey):void 0,b=e.demandItem({currentDerivedView:o.currentDerivedViewFacet},y).currentDerivedView,w=e.demandItemFacet(o.internalNameFacet,u);if(m&&g&&b&&b.baseViewXml&&w)if(1===i||2===i){var E=b.getEffectiveFieldNames();if(E&&E.length){var S=E.indexOf(w),x=m.groupByFieldKey?1:0;a=1===i?S>x+1:S>=x&&S<E.length-1}}else a=!0;if(m){var T=e.demandItemFacet(c.spPageContextFacet,l.spPageContextKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl})),N=e.demandItemFacet(o.listFacet,s.spListKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}));d=f.isFeatureEnabled(e,{feature:p,pageContext:T})&&!!(N&&N.permissions&&N.permissions.manageLists)}return n.__assign({isAvailable:a},h.getItemActionEngagement(e,{itemKey:r,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var r=t.itemSetKey,i=t.modifyType,s=t.columnKey,o=d?a.modifyColumnWithProgress:u.modifyColumn;return{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,u;return n.__generator(this,function(n){e(o({items:(t={},t[r]={columnModifyTypeMap:(u={},u[s]={modifyType:i},u)},t)}));return[2]})})}}})(i.Action)});
define("KT",["require","exports","E4","jm","qT","WT"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumnWithProgress=r.implementOperationWithProgress({operationTypeFacet:n.modifyColumnOperation,progressKeyFacet:s.modifyColumnProgressKeyFacet,initializeBatch:function(){return i.modifyColumnProgressAddon}})});
define("qT",["require","exports","lC","QT","Hm","ih","Fm","Um","tw","jm","Xo","Gm","WT","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0});var v=((d={})[c.ProgressPhase.started]=r.default.columnOperationStarted,d[c.ProgressPhase.completed]=r.default.columnOperationCompleted,d[c.ProgressPhase.failed]=r.default.columnOperationFailed,d);t.modifyColumnProgressAddon=i.createAddon(function(){return function(e){e(s.registerControlHandler(h.modifyColumnProgressKeyFacet,o.progressControl)(s.createControlHandler()(m)));e(s.registerControlHandler(h.modifyColumnProgressKeyFacet,u.progressCommandSummaryControl)(s.createControlHandler()(g)));e(s.registerControlHandler(h.modifyColumnProgressKeyFacet,a.progressListGroupControl)(s.createControlHandler()(y)))}});function m(){return function(e){return function(e,t){var r,i=t.itemKey,s=t.format,o=f.getOverallSimpleProgressBreakdown(e,t).phase,u=void 0,a=e.demandItemFacet(l.childItemsFacet,i),c=a&&a.itemKeys;if(c&&c.length>0)r=(u=v)&&u[o];else if("item"===s){var d=e.demandItemFacet(h.modifyColumnProgressKeyFacet,i),m=d&&d.taskKey;if(m){var g=e.demandItemFacet(h.modifyColumnProgressItemKeyFacet,m),y=g&&g.columnKey;if(y){r=e.demandItemFacet(p.internalNameFacet,y)}}}return n.__assign({},r?{title:r}:{})}}}function g(){return function(e){return function(e,t){return{reportMode:u.ProgressSummaryReportMode.pin}}}}function y(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}});
define("WT",["require","exports","jm","fi"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumnProgressItemKeyFacet=new r.KeyFacet("modifyColumnProgressItem",{columnKey:r.stringPart(),modifyType:r.numberPart(),targetIndex:r.numberPart()});t.modifyColumnProgressKeyFacet=new n.ProgressKeyFacet("modifyColumnProgress",function(e,n){var r=Object.keys(n.columnModifyTypeMap)[0],i=n.columnModifyTypeMap[r].modifyType,s=n.columnModifyTypeMap[r].targetIndex;return t.modifyColumnProgressItemKeyFacet.serialize({columnKey:r,modifyType:i,targetIndex:s})})});
define("zT",["require","exports","lC","C1","ks","TP","d7","Es","ii"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ModifyColumnAggregateTypeAction=r.connectToItemCache(function(e,t){var r=t.itemSetKey,i=t.columnKey,s=t.aggregateType,f=e.demandItemFacet(a.columnTotalsFacet,r),l=f&&f[i]&&f[i].aggregateFunctionType||o.ColumnAggregateTypeName[0],c=l===o.ColumnAggregateTypeName[s]?void 0:o.ColumnAggregateTypeName[s];return n.__assign({isAvailable:!0,isToggled:l===o.ColumnAggregateTypeName[s]},c?u.getItemActionEngagement(e,{itemKey:r,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:c||"AggregateTypeNone",extraData:{PreviousAggregateType:l||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var r=t.itemSetKey,i=t.columnKey,o=t.aggregateType;return{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t;return n.__generator(this,function(n){e(s.modifyColumnAggregateType({items:(t={},t[r]={aggregateType:o,columnKey:i},t)}));return[2]})})}}})(i.Action)});
define("aH",["require","exports","lC","sH","iH"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("sH",["require","exports","cH","H6","jm"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveWithProgress=i.implementOperationWithProgress({operationTypeFacet:r.addToOneDriveOperation,progressKeyFacet:r.addToOneDriveProgressKeyFacet,initializeBatch:function(){return n.addToOneDriveProgressAddon}})});
define("cH",["require","exports","lC","me","r","Gm","Fm","A1","jm","fH","Hm","ih","H6","wo","ko","ks","Hm","PE","BO","uH","ri","lH","GO","Xo","ph","dH","Rs","lh","Ro"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveProgressAddon=l.createAddon(function(){return function(e){e(c.registerControlHandler(h.addToOneDriveProgressKeyFacet,o.progressControl)(c.createControlHandler()(A)));e(m.registerOperationHandler(h.addToOneDriveProgressKeyFacet,y.retryProgressItemsOperation)(g.createRetryProgressItemsOperationHandler(h.addToOneDriveProgressKeyFacet,h.addToOneDriveOperation)))}});function A(){return function(e){return O}}function O(e,t){var o,l,c,h,m,g=a.getOverallSimpleProgressBreakdown(e,t),y=g.phase,A=g.count,O=e.demandItemFacet(p.errorFacet,t.itemKey),M=(u.getConfiguration(e,{addToOneDriveConfgiuration:w.addToOneDriveConfgiurationFacet}).addToOneDriveConfgiuration||{}).hostAppIsOneDrive;if(O&&O instanceof d.ItemOperationError){o=b.shortcutExistedAlreadyFacet.unpack(O.facets);l=b.nestedAscendantShortcutExistsFacet.unpack(O.facets);c=b.nestedDescendantShortcutExistsFacet.unpack(O.facets)}var _=[],D=(function(e){var t;return(t={})[s.ProgressPhase.started]=function(t){var n=t.count;return r.formatToArray(r.getLocalizedCountValue(e?f.default.addToOneDriveStartedItemsTitle:f.default.addToOneDriveHostOutOfODStartedItemsTitle,f.default.addToOneDriveCompletedItemsTitleIntervals,n)||"",n)},t[s.ProgressPhase.completed]=function(t){var n=t.count,i=t.itemLink;return r.formatToArray(r.getLocalizedCountValue(e?f.default.addToOneDriveCompletedItemsTitle:f.default.addToOneDriveHostOutOfODCompletedItemsTitle,f.default.addToOneDriveCompletedItemsTitleIntervals,n)||"",n,i)},t[s.ProgressPhase.failed]=function(e){var t=e.count;return r.formatToArray(r.getLocalizedCountValue(f.default.addToOneDriveFailedItemsTitle,f.default.addToOneDriveFailedItemsTitleIntervals,t)||"",t)},t[s.ProgressPhase.canceled]=function(e){var t=e.count;return r.formatToArray(r.getLocalizedCountValue(f.default.addToOneDriveFailedItemsTitle,f.default.addToOneDriveFailedItemsTitleIntervals,t)||"",t)},t})(M);if("completed"===y){var P=(function(e,t){var n=(function(e,t){var n=void 0,r=void 0,i=e.demandItemFacet(x.childItemsFacet,t.itemKey);if(i)for(var o=0,u=i.itemKeys;o<u.length;o++){var a=u[o],f=e.demandItemFacet(s.sourceItemFacet,a);n=f&&f.itemKey;var l=e.demandItemFacet(C.parentFolderItemFacet,n),c=l&&l.itemKey;if(c)if(r){if(c!==r)break}else r=c}return{sourceItemKey:n,parentItemKey:r}})(e,{itemKey:t.itemKey}),r=n.sourceItemKey,o=n.parentItemKey,u=(function(e,t){var n=L.getCurrentItemSetKey(e),r=e.demandItemFacet(k.sharedWithMeItemSetKeyFacet,n),i=r&&r.driveItemKey.endpoint,s=void 0;i&&(s=T.driveItemKeyFacet.serialize({endpoint:i,driveId:"me",itemId:"root"}));return s})(e),a=e.demandItemFacet(N.addToOneDriveCalloutNavigationControl,o),l=N.addToOneDriveCalloutNavigationControl.evaluate(a)(e,{itemKey:r}).action;return i.createElement(S.ItemLink,{key:"link",itemKey:u,action:l},f.default.addToOneDriveMyFiles)})(e,{itemKey:t.itemKey});h=D[y]({count:A,itemLink:P})}else h=D[y]({count:A});if(y===s.ProgressPhase.failed){var H,B=void 0,j=void 0;if(o){m=f.default.a2odErrorMessageAlreadyExisted;B=o.existShortcutUrl;H=o.existShortcutName}else if(l){B=l.existShortcutUrl;H=l.existShortcutName;m=r.formatToArray(f.default.a2odErrorMessageAscendantExists,H)}else if(c){m=r.formatToArray(f.default.a2odErrorMessageDescendantExists,t.title);j=c.nestDescendantItemKeys}if(B){var F=(function(e){var t=this,r=e.url;return i.createElement(v.Action,{onExecute:function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){window.open(r);return[2]})})}})})({url:B});_.push({key:"navigateToShortcut",name:f.default.a2odOpenExistedShortcutFolderCommand,action:F})}else j&&j.length>0&&_.push({key:"replaceShortcut",name:f.default.a2odReplaceExistedShortcutCommand,action:i.createElement(E.RetryReplaceShortcutProgressAction,{existedDescendants:j})})}return n.__assign(n.__assign(n.__assign({},h&&"item"!==t.format?{title:h}:{}),m?{description:m}:{}),{commands:_})}});
define("uH",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shortcutExistedAlreadyFacet=new n.Facet("shortcutExistedAlready");t.nestedDescendantShortcutExistsFacet=new n.Facet("nestedDescendantShortcutExists");t.nestedAscendantShortcutExistsFacet=new n.Facet("nestedAscendantShortcutExists")});
define("lH",["require","exports","lC","r","BO","jr","ks","_s","Jr","H6","C1","wo","Mo","uH"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRetryReplaceShortcutProgressAction=l.createItemCacheComponent(function(e,t){var u=t.itemKeys,l=t.existedDescendants,d=u.filter(function(t){var n=e.demandItemFacet(c.errorFacet,t);if(n&&n instanceof h.ItemOperationError){if(p.nestedDescendantShortcutExistsFacet.unpack(n.facets))return!0}return!1}),v=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){v(a.resolveItems({items:s.makeObject(d,function(){return f.addToOneDriveOperation.pack({replaceShortcut:l})})}));v(i.retryProgressItems({items:s.makeObject(d,function(){return{}})}));return[2]})})},isAvailable:d.length>0})});t.RetryReplaceShortcutProgressAction=u.withSelectedItems()(t.ItemRetryReplaceShortcutProgressAction)});
define("dH",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveCalloutNavigationControl=new n.ControlFacet("addToOneDriveCalloutNavigationControl")});
define("iH",["require","exports","jm","rH","c6"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveWithProgress=n.implementOperationWithProgress({operationTypeFacet:i.removeFromOneDriveOperation,progressKeyFacet:i.removeFromOneDriveProgressKeyFacet,initializeBatch:function(){return r.removeFromOneDriveProgressAddon}})});
define("rH",["require","exports","lC","ih","Hm","Fm","Gm","jm","me","oH","c6"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[o.ProgressPhase.started]=function(e){return a.formatToArray(a.getLocalizedCountValue(f.default.removeFromOneDriveStartedTitle,f.default.removeFromOneDriveStartedTitleIntervals,e)||"",e)},c[o.ProgressPhase.completed]=function(e){return a.formatToArray(a.getLocalizedCountValue(f.default.removeFromOneDriveCompletedTitle,f.default.removeFromOneDriveCompletedTitleIntervals,e)||"",e)},c[o.ProgressPhase.failed]=function(e){return a.formatToArray(a.getLocalizedCountValue(f.default.removeFromOneDriveFailedTitle,f.default.removeFromOneDriveFailedTitleIntervals,e)||"",e)},c[o.ProgressPhase.canceled]=function(e){return a.formatToArray(a.getLocalizedCountValue(f.default.removeFromOneDriveFailedTitle,f.default.removeFromOneDriveFailedTitleIntervals,e)||"",e)},c);function p(e,t){var r=u.getOverallSimpleProgressBreakdown(e,t),i=r.count,s=r.phase,o=h[s](i);return n.__assign({},o&&"item"!==t.format?{title:o}:{})}function d(){return function(e){return p}}t.removeFromOneDriveProgressAddon=i.createAddon(function(){return function(e){e(r.registerControlHandler(l.removeFromOneDriveProgressKeyFacet,s.progressControl)(r.createControlHandler()(d)))}})});
define("vVe",["require","exports","lC","r","FT","Ec","jr","To","TE","EM","jm","yVe","Rs","RL","ii","jL","tv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=m.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["UF"],t,n)})];case 1:return[2,t.sent().CheckInDialog]}})})}),y=l.implementOperationWithProgress({operationTypeFacet:i.updateCheckoutStateOperation,progressKeyFacet:i.checkoutProgressKeyFacet,initializeBatch:function(){return c.checkoutProgressAddon}});function b(e){var t=e.dispatch,n=e.itemKeys,i=e.itemSetKey;r.useEffect(function(){t(y({items:o.makeObject(n,function(){return{checkInOutType:"checkOut"}})})).then(function(){var e;i&&t(v.refreshItemsInSet({items:(e={},e[i]=o.makeObject(n,function(){return{}}),e)}))})},[]);return null}t.CheckOutItemExecutor=b;var w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.reject,l=t.resolve,c=t.itemKeys,m=t.checkInOutType,w=t.enableMinorVersions,E=t.itemSetKey,S=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){i(new u.CancelError);return[2]})})};return r.createElement(s.WithItemCache,null,function(t){var i,s=t.dispatch,u=t.itemCache;if(1===(c&&c.length)){var x=c[0],T=u.demandItemFacet(h.displayNameFacet,x),N=p.getVersion(u,x),C=N.minor;i={major:N.major,minor:C,displayName:T,moderationStatusType:u.demandItemFacet(d.moderationStatusTypeFacet,x)}}var k=function(t){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:l();e={checkInOutType:m,checkInText:t&&t.comment||"",checkInVersionType:t&&t.checkInVersionType};return[4,s(y({items:o.makeObject(c,function(){return e})})).then(function(){var e;E&&s(v.refreshItemsInSet({items:(e={},e[E]=o.makeObject(c,function(){return{}}),e)}))})];case 1:n.sent();return[2]}})})};return"undoCheckOut"===m?r.createElement(a.ConfirmationDialog,{onConfirm:k,onCancel:S,title:f.default.DiscardCheckoutTitle,prompt:f.default.DiscardCheckoutText}):"checkIn"===m?r.createElement(g,{onContinue:k,onCancel:S,itemCount:c&&c.length,itemInfo:i,enableMinorVersions:w}):"checkOut"===m?r.createElement(b,{dispatch:s,itemKeys:c,itemSetKey:E}):r.createElement(r.Fragment,null)})};return t})(r.PureComponent);t.CheckOutItemWizard=w});
define("yVe",["require","exports","lC","me","EM","FT","Hm","ih","Fm","jm","Xo","Gm"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h,p,d;Object.defineProperty(t,"__esModule",{value:!0});var v=((h={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h),m=((p={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p),g=((d={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d);t.checkoutProgressAddon=o.createAddon(function(){return function(e){e(u.registerControlHandler(s.checkoutProgressKeyFacet,a.progressControl)(u.createControlHandler()(y)))}});function y(){return function(e){return b}}function b(e,t){var r=t.itemKey,i=f.getOverallSimpleProgressBreakdown(e,t),o=i.phase,u=i.count,a=v,c=e.demandItemFacet(l.childItemsFacet,r),h=c&&c.itemKeys;if(h&&h.length>0){var p=e.demandItemFacet(s.updateCheckoutStateOperation,h[0]),d=p&&p.checkInOutType;"checkIn"===d?a=g:"undoCheckOut"===d&&(a=m)}var y=a[o](u);return n.__assign({},y&&"item"!==t.format?{title:y}:{})}});
define("SVe",["require","exports","lC","r","li","ii","sS","w7","Me","C1","ks","Es","DVe","Ps"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateListItemExecutor=f.createItemCacheComponent(function(e,t){var f,d=t.itemKey,v=t.contentTypeId,m=t.defaultValueOverride,g=void 0===m?{}:m,y=e.demandItemFacet(i.spItemKeyFacet,d),b="";if(y){var w=i.spListKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl}),E=e.demandItemFacet(s.listFormUrlsFacet,w);if(v){var S=i.spListContentTypeKeyFacet.serialize({listKey:{webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl},contentTypeId:v}),x=e.demandItemFacet(s.spListContentTypeFacet,S);if(x&&x.templateUrl){var T=new a.ItemUrlHelperBasic({context:{webAbsoluteUrl:y.webAbsoluteUrl,listUrl:y.listFullUrl}}).getUrlParts({path:x.templateUrl});T.fullItemUrl&&(b=T.fullItemUrl)}}b||(b=E&&E.newFormUrl||"");b&&(b=u.getListItemFormUrl(b,y.rootFolder||new o.default(y.listFullUrl).path,void 0,v));var N=v;if(!N){var C=e.demandItemFacet(s.contentTypeKeysFacet,w);if(C&&C.length){var k=e.demandItemFacet(s.spListContentTypeFacet,C[0]);k&&(N=k.contentTypeId)}}var L=e.demandItemFacet(h.createListItemActionControl,t.itemKey);f=h.createListItemActionControl.evaluate(L)(e,{itemKey:t.itemKey,formUrl:b,defaultValueOverride:g,contentTypeId:N}).action}return f?p.renderAction(f):r.createElement(l.Action,n.__assign({onExecute:(function(e){var t=this;return function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){e&&(t=window.open(e,"_blank"))&&t.focus();return[2]})})}})(b)},c.getItemActionEngagement(e,{itemKey:d,engagement:{name:"CreateItem",isIntentional:!0}})))})});
define("IVe",["require","exports","lC","r","C1","li","ii","_s","cP","Es","Ps","ks","tv","F1","R1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=h.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./FreshViewCreator"],t,n)})];case 1:return[2,t.sent().FreshViewCreator]}})})});t.CreateViewAction=i.createItemCacheComponent(function(e,t){var i=t.isEditing,h=t.currentViewKey,m=u.getCurrentItemSetKey(e),g=p.getItemsScope(e).itemsScopeItemKey,y=e.demandItemFacet(s.spFolderItemSetKeyFacet,m),b=e.demandItemFacet(a.saveViewActionControl,m),w=e.demandItemFacet(o.currentDerivedViewFacet,h),E=a.saveViewActionControl.evaluate(b)(e,{viewKey:h}).onViewSaved;if(!m||!g)return null;var S=!1;if(y&&w){var x=s.spListKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl}),T=e.demandItemFacet(o.listFacet,x);S=!!(T&&w&&"POWER"!==w.viewType&&T.permissions&&(T.permissions.managePersonalViews||T.permissions.manageLists))}var N=y?e.demandItemFacet(o.spPageContextFacet,s.spPageContextKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl})):void 0,C=l.renderComponentOnExecute(function(e){return r.createElement(d.ItemsScope,{itemsScopeItemKey:g},r.createElement(v,n.__assign({},e,t,{pageContext:N,itemSetKey:m,onViewSaved:E})))},{scope:"global"});return r.createElement(c.Action,n.__assign({isAvailable:S,onExecute:C},f.getItemActionEngagement(e,{itemKey:m,engagement:{name:i?"EditView":"CreateNewView",isIntentional:!0}})))})});
define("xVe",["require","exports","lC","r","C_","b8","Ec","ii","WM","jM","ce"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=i.asAutoAction()(a.CreateListItemAction),h=i.asAutoAction()(s.NewItemInOfficeClientAction),p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onComplete=function(){n.setState({isCompleted:!0});n.props.resolve()};n.state={isCompleted:!1};return n}t.prototype.render=function(){var e=this,t=this.props,n=t.contentTypeId,i=t.openInClient,s=t.contentTypeKey,a=t.pageContext,p=this.state.isCompleted;return n&&!p?r.createElement(o.WithItemCache,null,function(t){var o=t.itemCache.demandItemFacet(u.spListContentTypeFacet,s);if(o){var p=a&&!l.getKillSwitch(a).isActivated("E38C27E3-F930-424A-AE58-5E53C46F25DA","11/01/2019","Always open in client if appMap property exists except for infopath")&&!("ms-infopath"===o.appMap&&!i),d=o.templateUrl.indexOf("CreateNewDocument.aspx?id=")>-1,v=o.appMap&&f.getOfficeStringMap(o.appMap);if(i&&(d||v)||p&&o.appMap)return r.createElement(h,{contentTypeKey:s,onComplete:e._onComplete})}return r.createElement(c,{contentTypeId:n,onComplete:e._onComplete})}):null};return t})(r.Component);t.ContentTypeNavigationCreator=p});
define("CVe",["require","exports","lC","r","HT","fT","kM","Aw","bE","To","ss","OVe","jm","rs","Xo","fT"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editPinnedItemWithProgress=h.implementOperationWithProgress({operationTypeFacet:i.editPinnedItemOperation,progressKeyFacet:i.editPinnedItemProgressKeyFacet,initializeBatch:function(){return c.editPinnedItemProgressAddon}});var m=(function(e){n.__extends(i,e);function i(t){var n=e.call(this,t)||this;n.state={editPinnedItemError:void 0};return n}i.prototype.componentDidMount=function(){var e,n,r=this,i=this.props,o=i.itemCacheDispatch,u=i.pinnedItemSetKey,a=i.itemKey,f=i.editType,c=i.resolve,h=i.itemsScopeItemKey,m=i.editPinnedItem,g=void 0===m?t.editPinnedItemWithProgress:m;if(u){var y=o(p.readItems(function(e){return e.demandItem({pinnedItems:d.childItemsFacet},u)})).pinnedItems;if(0===f&&y&&y.itemKeys&&y.itemKeys.length>=v.MAX_PINNED_ITEM_COUNT)this.setState({editPinnedItemError:new s.EditPinnedItemError({resultType:3})});else{o(g({items:(e={},e[u]={itemEditTypeMap:(n={},n[a]={editType:f},n)},e)})).then(function(){c()},function(e){r.setState({editPinnedItemError:e})});1===f&&o(l.selectItems({itemsScopeItemKey:h,selectedItemKeys:[],currentSelectionKey:void 0}))}}else this.props.reject(new Error("No pinned item set to modify."))};i.prototype.render=function(){var e=this.props,t=e.editType,i=e.reject,s=this.state.editPinnedItemError;if(s){var l=(function(e,t,n){var r,i,s=e.resultType,a=3===t||2===t;if(1===s){r=a?o.default.errorMoveItemMissingTitle:0===t?o.default.errorPinItemMissingTitle:o.default.errorUnpinItemMissingTitle;i=o.default.errorFolderMissingBody}else if(2===s){if(0!==t)return;r=a?o.default.errorMoveItemMissingTitle:o.default.errorPinItemMissingTitle;i=o.default.errorItemMissingBody}else if(3===s){r=a?o.default.errorMoveGenericTitle:o.default.errorPinnedItemsFullTitle;i=o.default.errorPinnedItemsFullBody}else{if(4===s)return;r=a?o.default.errorMoveGenericTitle:0===t?o.default.errorPinGenericTitle:o.default.errorUnpinGenericTitle;i=o.default.errorGenericErrorBody}return{title:r,prompt:i,cancelText:u.default.cancelActionText,onCancel:function(){n(new f.CancelError)}}})(s,t,i);if(l)return r.createElement(a.WarningDialog,n.__assign({},l))}return null};return i})(r.PureComponent);t.EditPinnedItemExecutor=m});
define("OVe",["require","exports","lC","me","kM","Hm","ih","Fm","jm","Xo","Gm","HT","Rs","Um"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d,v,m,g;Object.defineProperty(t,"__esModule",{value:!0});var y=((d={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d),b=((v={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v),w=((m={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m),E=((g={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g);t.editPinnedItemProgressAddon=s.createAddon(function(){return function(e){e(o.registerControlHandler(c.editPinnedItemProgressKeyFacet,u.progressControl)(o.createControlHandler()(S)));e(o.registerControlHandler(c.editPinnedItemProgressKeyFacet,p.progressCommandSummaryControl)(o.createControlHandler()(x)))}});function S(){return function(e){return function(e,t){var r,i=t.itemKey,s=t.format,o=a.getOverallSimpleProgressBreakdown(e,t),u=o.phase,l=o.count,p=void 0,d=e.demandItemFacet(f.childItemsFacet,i),v=d&&d.itemKeys,m=0;if(v&&v.length>0){var g=e.demandItemFacet(c.editPinnedItemOperation,v[0]);if(g&&g.itemEditTypeMap){var S=g.itemEditTypeMap;for(var x in S)if(x&&S[x]){m=S[x].editType;break}}switch(m){case 0:p=y;break;case 1:p=b;break;case 3:p=E;break;case 2:p=w}r=p&&p[u](l)}else if("item"===s){var T=e.demandItemFacet(c.editPinnedItemProgressKeyFacet,i),N=T&&T.taskKey;if(N){var C=e.demandItemFacet(c.editPinnedItemProgressItemKeyFacet,N),k=C&&C.itemKey;if(k){r=e.demandItemFacet(h.displayNameFacet,k)}}}return n.__assign({},r&&"item"!==t.format?{title:r}:{})}}}function x(){return function(){return function(){return{reportMode:"pin"}}}}});
define("wVe",["require","exports","lC","TT","C1","ks","$1","Rs","Es"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUpdateLikesExectuor=i.connectToItemCache(function(e,t){var i=t.itemKey,s=e.demandItemFacet(u.likesCountFacet,i)||0,f=e.demandItemFacet(u.hasUserLikedFacet,i)||!1,l=f?s-1:s+1,c=e.dispatch;return n.__assign(n.__assign({isAvailable:!0},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"UpdateLikes",isIntentional:!0}})),{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(s){switch(s.label){case 0:c(o.resolveItems({items:(e={},e[i]=n.__assign(n.__assign({},u.likesCountFacet.pack(l)),u.hasUserLikedFacet.pack(!f)),e)}));return[4,c(r.updateItemLikes({items:(t={},t[i]={liked:!f},t)}))];case 1:s.sent();return[2]}})})}})})(s.Action)});
define("EVe",["require","exports","lC","r","ks","Xo","Ec","Ps","Es","zm","Xh","vs","li","ii","Qn","ce","$1","Xy","g6","AVe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w={ODB:1877},E={ODB:1391},S=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(o.WithItemCache,null,function(o){var S=o.itemCache,x=o.dispatch,T=a.getItemActionEngagement(S,{itemKey:t,engagement:{name:"ExitQuickEdit",isIntentional:!0}}),N=S.demandItem({deserizalizeKey:h.spFolderItemSetKeyFacet},t).deserizalizeKey,C=N&&h.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:N.webAbsoluteUrl,listFullUrl:N.listFullUrl},viewKey:N.viewKey}),k=S.demandItem({completeExitingQuickEditSignal:p.completeExitingQuickEditSignalFacet},C).completeExitingQuickEditSignal,L=N&&N.viewKey&&h.spViewKeyFacet.serialize(N.viewKey),A=g.getPageContextFromItemCache(S,t),O=y.isFeatureEnabled(S,{feature:w,pageContext:A}),M=y.isFeatureEnabled(S,{feature:E,pageContext:A}),_=O&&M,D=L&&S.demandItemFacet(p.currentDerivedViewFacet,L),P="HTML",H=S.demandItemFacet(p.quickEditExitLayoutType,L);if(H)P=b.getViewTypeFromLayoutType(H)||P;else{D&&D.viewType&&"GRIDFIXED"!==D.viewType&&"GRID"!==D.viewType&&(v.Killswitch.isActivated("E3C6F7C4-D470-41FE-B6C2-CE9B46D4AF45","06/11/2020","Exit quick edit to use current view's viewType if the viewType if not fixedGrid or datasheet")||(P=D.viewType));H=b.getLayoutTypeFromViewType(P)||c.detailsLayoutType}return r.createElement(u.WithAction,{action:r.createElement(l.SwitchLayoutAction,{layoutType:H})},function(o){var u=o.execute;return r.createElement(i.Action,n.__assign({isAvailable:!0,onExecute:function(r){return n.__awaiter(e,void 0,void 0,function(){var e,i=this;return n.__generator(this,function(o){switch(o.label){case 0:d.EventGroup.raise(document,"startExitingQuickEdit");return k?[4,k.promise.then(function(){return n.__awaiter(i,void 0,void 0,function(){var e;return n.__generator(this,function(n){x(f.invalidateItems({items:(e={},e[t]=[s.childItemsFacet],e)}));return[2]})})})]:[3,2];case 1:o.sent();o.label=2;case 2:_&&L&&x(m.resolveItems({items:(e={},e[L]=n.__assign(n.__assign({},p.viewTypeFacet.pack(P)),p.showViewModifiedIndicatorFacet.pack(!0)),e)}));return[4,u(r)];case 3:o.sent();return[2]}})})}},T))})})};return t})(r.PureComponent);t.ExitQuickEditActionExecutor=S});
define("AVe",["require","exports","Mr","vs","pP"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLayoutTypeFromViewType=function(e){switch(e){case"TILES":return n.tilesLayoutType;case"COMPACTLIST":return r.compactDetailsLayoutType;case"MODERNCALENDAR":return i.calendarMonthType;case"HTML":return r.detailsLayoutType;default:return}};t.getViewTypeFromLayoutType=function(e){switch(e){case n.tilesLayoutType:return"TILES";case r.detailsLayoutType:return"HTML";case r.compactDetailsLayoutType:return"COMPACTLIST";case i.calendarMonthType:return"MODERNCALENDAR";default:return}}});
define("LVe",["require","exports","lC","r","ii","li","C1","ks","u9","de"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExportListActionExecutor=o.createItemCacheComponent(function(e,t){var o=t.itemKey,l=e.demandItemFacet(s.spFolderItemSetKeyFacet,o),c="";if(l&&l.viewKey&&l.viewKey.viewId){var h="",p=s.spListKeyFacet.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}),d=e.demandItemFacet(i.listFacet,p);d&&(h=d.id);if(h){c=l.webAbsoluteUrl+"/_vti_bin/owssvr.dll?";c+=a.serializeQuery({CS:65001,Using:"_layouts/15/query.iqy",List:h,View:f.default.normalizeUpper(l.viewKey.viewId),RootFolder:l.rootFolder,CacheControl:1})}}return r.createElement(u.Action,{isAvailable:!0,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(c);return[2]})})}})})});
define("kVe",["require","exports","lC","UT","C1","ks","Es"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUpdateRatingExecutor=i.connectToItemCache(function(e,t){var i=t.itemKey,s=t.currentRating,u=e.dispatch;return n.__assign({onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,u(r.updateItemRating({items:(e={},e[i]={userNewRating:s},e)}))];case 1:t.sent();return[2]}})})},isAvailable:!0},o.getItemActionEngagement(e,{itemKey:i,engagement:{name:"UpdateRating",isIntentional:!0}}))})(s.Action)});
define("MVe",["require","exports","lC","r","li","pr","ks","$1","Xo","ii","Ec","Ps","Xf","Es","A8","xv","ai"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,g=t.sortFieldKey,y=t.itemSetKey,b=t.isAscending;return r.createElement(l.WithItemCache,null,function(t){var l=t.itemCache,w=t.dispatch,E=l.demandItemFacet(i.spFolderItemSetKeyFacet,y);if(!E)return r.createElement(c.WithAction,null);var S=i.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},E),{sortFieldKey:g,sortAscending:b})),x=i.spItemKeyFacet.serialize(E),T=E.viewKey&&i.spViewKeyFacet.serialize(E.viewKey),N=l.demandItemFacet(f.listFacet,i.spListKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})),C=l.demandItemFacet(f.spPageContextFacet,i.spPageContextKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})),k=p.getItemActionEngagement(l,{itemKey:y,engagement:{name:"Sort",isIntentional:!0}});return r.createElement(c.WithAction,{action:r.createElement(h.ItemOpenAction,{itemKey:S})},function(t){var i=t.execute;return r.createElement(o.Action,n.__assign({onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(o){switch(o.label){case 0:w((function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c;return n.__generator(this,function(n){switch(n.label){case 0:t=e.sortField,i=e.isAscending,s=e.webAbsoluteUrl,o=e.listFullUrl,u=e.pageContext,a=e.templateType;f=a===m.ListTemplateType.mySiteDocumentLibrary;if(!(u&&u.isSiteAdmin)||!f)return[3,2];l=d.getListApiUrl({webAbsoluteUrl:s,listFullUrl:o}).segment("DefaultView").segment("SetViewXml");c=i?"TRUE":"FALSE";return[4,r(v.getData({webAbsoluteUrl:s,listFullUrl:o,url:l.toString(),method:"POST",qosName:"SetDefaultView",noRedirect:!0,body:JSON.stringify({viewXml:'<View><Query><OrderBy><FieldRef Name="'+t+'" Ascending="'+c+'" /></OrderBy></Query></View>'})}))];case 1:return[2,n.sent()];case 2:return[4,Promise.resolve(void 0)];case 3:return[2,n.sent()]}})})}})({sortField:this.props.sortFieldKey,isAscending:this.props.isAscending,webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,pageContext:C,templateType:N&&N.templateType}));w(u.resolveItems({items:n.__assign((e={},e[S]=n.__assign(n.__assign({},a.parentItemFacet.pack({itemKey:x})),a.sortFacet.pack({columnKey:s.spListFieldKeyFacet.serialize({listKey:E,internalName:this.props.sortFieldKey}),isAscending:this.props.isAscending})),e),T?(r={},r[T]=n.__assign({},f.showViewModifiedIndicatorFacet.pack(!0)),r):{})}));return[4,i(t)];case 1:o.sent();return[2]}})})}},k))})})};return t})(r.PureComponent);t.SortActionExecutor=g});
define("PVe",["require","exports","lC","r","kw","am","FVe","me","Xw","rge","SPListItemsScopeDeferred_IS_mini_css","TVe","Vs","C1","RS","A","Ms","Ar","b","Sb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";l=l.SyncDialog_6;Object.defineProperty(t,"__esModule",{value:!0});function w(){return{button:{zIndex:100}}}function E(e){var t=e.clientDownloadUrl,n=e.resolve,h=e.reject,p=e.protocolCallback,d=e.getSyncInfo,v=e.isTenantAdmin,m=r.useState(),E=m[0],S=m[1],x=r.useState(),T=x[0],N=x[1],C=r.useState(),k=C[0],L=C[1],A=r.useState(),O=A[0],M=A[1];r.useEffect(function(){d().then(function(e){S(e)},function(e){N(e)})},[d]);r.useEffect(function(){v().then(function(e){L(e)},function(e){M(e)})},[v]);var _=E&&E.protocolUrl;r.useEffect(function(){p&&_&&p(_)},[p,_]);var D=g.useEventHandler(function(){var e=E&&E.syncConfigParams||"";f.copyToClipboard(e)}),P=g.useEventHandler(function(){T?h(T):O?h(O):E?n():h(new y.CancelError)}),H=T?r.createElement("div",{className:l.errorContainer},r.createElement("div",null,b.default.genericFailedDescription),T.message?r.createElement("div",null,T.message):null):null,B=r.createElement(r.Fragment,null,u.formatToArray(o.default.NGSCSyncDialogBody3Format,r.createElement("a",{className:l.pointerText,href:t,target:"_blank"},o.default.NGSCSyncDialogGetOneDriveButton))),j=k?r.createElement(r.Fragment,null,r.createElement("div",{className:l.adminContentContainer},r.createElement(a.Label,null,o.default.NGSCSyncDialogBody1,r.createElement(s.ActionButton,{className:l.copyLibraryId,onClick:D},o.default.NGSCSyncDialogBody4a),o.default.NGSCSyncDialogBody4b)),r.createElement("div",{className:l.separator},r.createElement(c.Separator,null)),r.createElement(a.Label,{className:l.footNote},B)):r.createElement("div",{className:l.contentContainer},o.default.NGSCSyncDialogBody1,B),F=r.createElement(i.Dialog,{hidden:!1,onDismiss:P,containerClassName:l.syncDialog,dialogContentProps:{type:i.DialogType.close,styles:w}},r.createElement("div",{className:l.syncDialogContent},r.createElement("img",{className:l.syncImg,src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/sync_to_device_illustration.svg",alt:o.default.syncImgAlt}),r.createElement("h2",{className:l.syncTitle},o.default.NGSCSyncDialogTitle),j,H));return r.createElement(r.Fragment,null,F,_&&!p?r.createElement("div",{style:{display:"none"}},r.createElement("iframe",{hidden:!0,src:_})):null)}t.SyncDialog=p.createItemCacheComponent(function(e,t){var i=t.itemKey,s=e.dispatch,o=e.demandItemFacet(d.itemSyncDialogControl,i),u=d.itemSyncDialogControl.evaluate(o)(e,{itemKey:i,clientDownloadUrl:"",userLoginName:""}),a=u.clientDownloadUrl,f=u.userLoginName,l=u.getSyncInfo,c=u.isTenantAdmin,p=h.getTelemetry(e).telemetry;if(!l)return r.createElement(S,n.__assign({},t,{message:"Missing sync info callback"}));if(!a)return r.createElement(S,n.__assign({},t,{message:"Missing client download URL"}));if(!f)return r.createElement(S,n.__assign({},t,{message:"Missing user login name"}));return r.createElement(E,n.__assign({},t,{telemetry:p,getSyncInfo:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e=new(p(v.Qos))({name:"SyncDialog.getSyncInfo"});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,s(l({}))];case 2:return[2,n.sent()];case 3:t=n.sent();e.end(m.getQosEndSchemaFromError(t));throw t;case 4:e.end({resultType:v.ResultTypeEnum.Success});return[7];case 5:return[2]}})})},clientDownloadUrl:a,userLoginName:f,isTenantAdmin:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:if(!c)return[2,!1];e=new(p(v.Qos))({name:"SyncDialog.isTenantAdmin"});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,s(c({}))];case 2:return[2,n.sent()];case 3:t=n.sent();e.end(m.getQosEndSchemaFromError(t));throw t;case 4:e.end({resultType:v.ResultTypeEnum.Success});return[7];case 5:return[2]}})})}}))});function S(e){var t=e.reject,n=e.message;r.useEffect(function(){var e=setTimeout(function(){t(new Error(n))},6e4);return function(){clearTimeout(e)}},[n,t]);return null}});
define("rge",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyToClipboard=function(e){var t=document.createElement("input");t.setAttribute("type","text");t.setAttribute("value",e);document.body.appendChild(t);var n=!1;try{t.focus();t.select();n=document.execCommand("copy")}catch(e){}if(!n&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(t.value);n=!0}catch(e){}document.body.removeChild(t);return n}});
define("TVe",["require","exports","lC","Pfe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("vU",["require","exports","lC","tH","WF","UF","yU"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t)});
define("tH",["require","exports","lC","r","Zd","kw","SE","EF","am","fU","Aw","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";c=c.SaveViewDialog_0;Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onCheckboxChanged=function(e,t){n.setState({isPublicView:!!t})};n._onNameRef=function(e){if(e){e.focus();e.select()}};n._onNameChanged=function(e,t){void 0===t&&(t="");var r=n.props.validator;n.setState(function(){return{viewTitle:t,errorMessage:r?r(t):void 0}})};n._onClickAction=function(){n.setState({showSpinner:!0});n.props.onContinue({viewTitle:n.state.viewTitle,isPublicView:n.state.isPublicView}).catch(function(e){n.setState({showSpinner:!1,errorMessage:e&&e.message})})};n._onKeyPress=function(e){13===e.which&&n._onClickAction()};n._initialViewTitle=t.viewTitle;n._initialIsPublicView=t.isPublicView;n.state={viewTitle:n._initialViewTitle,isPublicView:n._initialIsPublicView};return n}t.prototype.render=function(){var e=this.state,t=e.viewTitle,n=e.errorMessage,h=e.showSpinner;return r.createElement(s.Dialog,{hidden:!1,title:f.default.SaveAs,onDismiss:this.props.onCancel},r.createElement(o.TextField,{label:f.default.SaveViewExplanation,componentRef:this._onNameRef,value:t,onChange:this._onNameChanged,errorMessage:n,onKeyPress:this._onKeyPress,className:c.saveViewDialogTextField}),r.createElement(u.Checkbox,{label:f.default.SaveViewMakePublic,className:c.saveViewDialogTextField,disabled:t===this._initialViewTitle,defaultChecked:this._initialIsPublicView,onChange:this._onCheckboxChanged}),r.createElement(s.DialogFooter,null,r.createElement(a.PrimaryButton,{disabled:!t||!!n||h,onClick:this._onClickAction,text:f.default.SaveViewCommit}),h&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium,className:c.saveViewDialogSpinner}),r.createElement(a.DefaultButton,{text:l.default.cancelActionText,onClick:this.props.onCancel})))};return t})(r.PureComponent);t.SaveViewDialog=h});
define("WF",["require","exports","lC","r","Zd","kw","SE","am","HF","YF","QF","SPListItemsScopeDeferred_IS_mini_css","c7","me"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";c=c.ApproveRejectDialog_9;Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._textField=r.createRef();i._onChoiceGroupRef=function(e){e&&e.focus()};i._choiceGroupOnChange=function(e,t){i.setState({status:t?t.statusType:void 0})};i._onClickAction=function(){return n.__awaiter(i,void 0,void 0,function(){var e,t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:e=this.state.status;t=this._textField.current?this._textField.current.value:void 0;if(void 0===e)return[2];this.setState({showSpinner:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,this.props.onContinue({status:e,comment:t})];case 2:n.sent();return[3,5];case 3:r=n.sent();i=r;this._isDisposed||this.setState({errorMessage:i&&i.message});return[3,5];case 4:this._isDisposed||this.setState({showSpinner:!1});return[7];case 5:return[2]}})})};i._options=(function(e){var t=e.hideApproveRejectOptions,n=e.showDraftOption,r=e.itemCount,i=[],s=r&&r>1;if(!t){i.push({key:h.ModerationStatusType[h.ModerationStatusType.approved],text:s?l.default.approve_approved_mult:l.default.approve_approved,statusLabel:l.default.approve_approved_label,statusType:h.ModerationStatusType.approved,"data-is-focusable":!0,onRenderLabel:v});i.push({key:h.ModerationStatusType[h.ModerationStatusType.denied],text:s?l.default.approve_rejected_mult:l.default.approve_rejected,statusLabel:l.default.approve_rejected_label,statusType:h.ModerationStatusType.denied,"data-is-focusable":!0,onRenderLabel:v})}n&&i.push({key:h.ModerationStatusType[h.ModerationStatusType.draft],text:s?l.default.approve_draft_mult:l.default.approve_draft,statusLabel:l.default.approve_draft_label,statusType:h.ModerationStatusType.draft,"data-is-focusable":!0,onRenderLabel:v});i.push({key:h.ModerationStatusType[h.ModerationStatusType.pending],text:s?l.default.approve_pending_mult:l.default.approve_pending,statusLabel:l.default.approve_pending_label,statusType:h.ModerationStatusType.pending,"data-is-focusable":!0,onRenderLabel:v});return i})(t);void 0!==t.initialStatus&&(i._defaultSelectedKey=h.ModerationStatusType[t.initialStatus]);i.state={errorMessage:"",showSpinner:!1,status:t.initialStatus};return i}t.prototype.componentWillUnmount=function(){this._isDisposed=!0};t.prototype.render=function(){var e=this.props,t=e.onCancel,n=e.initialComment,h=e.itemCount,p=this.state,d=p.errorMessage,v=p.showSpinner,m=p.status,g=h&&h>1,y=this._getDialogMessage();return r.createElement(s.Dialog,{maxWidth:450,hidden:!1,dialogContentProps:{title:this._getDialogTitle()},onDismiss:t},y&&r.createElement(f.MessageBar,{className:c.approveRejectDialogMessageBar}," ",y),r.createElement(a.ChoiceGroup,{componentRef:this._onChoiceGroupRef,label:l.default.ApproveRejectChoiceGroupLabel,options:this._options,onChange:this._choiceGroupOnChange,defaultSelectedKey:this._defaultSelectedKey}),r.createElement(o.TextField,{className:c.commentRoot,label:l.default.CommentLabel,ariaLabel:g?l.default.approve_commentsdesc_mult:l.default.approve_commentsdesc,componentRef:this._textField,defaultValue:n,rows:5,placeholder:g?l.default.approve_commentsdesc_mult:l.default.approve_commentsdesc,multiline:!0}),r.createElement(s.DialogFooter,null,r.createElement(u.PrimaryButton,{disabled:void 0===m||!!d||v,onClick:this._onClickAction},l.default.ContinueButtonText),r.createElement(u.DefaultButton,{onClick:t},l.default.CancelButtonText),v&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium,className:c.approveRejectDialogSpinner})))};t.prototype._getDialogTitle=function(){var e=this.props,t=e.itemName,n=e.itemCount;return n&&n>1?p.format(l.default.ApproveRejectDialogTitle_mult,n):p.format(l.default.ApproveRejectDialogTitle,t)};t.prototype._getDialogMessage=function(){var e=this.props,t=e.initialStatus,n=e.initialStatusMapForBulkEdit,r=e.itemCount,i="";if(r&&r>1&&void 0===t&&n)for(var s=0,o=Object.keys(n);s<o.length;s++){var u=o[s],a=n[u];if(a>0){i&&(i+=", ");var f=p.getLocalizedCountValue(l.default.ApproveRejectDialogStatusMessage,l.default.ApproveRejectDialogStatusMessageIntervals,a);f&&(i+=p.format(f,a,u))}}return i};return t})(r.PureComponent);t.ApproveRejectDialog=d;function v(e){var t=e;return e?r.createElement("span",{id:e.labelId,className:"ms-ChoiceFieldLabel"},r.createElement("span",{className:c.approveRejectDialogStatusLabel},t.statusLabel)," - ",e.text):null}});
define("UF",["require","exports","lC","r","Zd","kw","SE","am","HF","FF","me","c7"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._textField=r.createRef();i._choiceGroupRef=r.createRef();i._onClickAction=function(){return n.__awaiter(i,void 0,void 0,function(){var e,t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:e=this._textField.current?this._textField.current.value:void 0;t=this._choiceGroupRef&&this._choiceGroupRef.current&&this._choiceGroupRef.current.checkedOption?this._choiceGroupRef.current.checkedOption.checkInVersionType:void 0;this.setState({showSpinner:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,this.props.onContinue({checkInVersionType:t,comment:e})];case 2:n.sent();return[3,5];case 3:r=n.sent();i=r;this._isDisposed||this.setState({errorMessage:i&&i.message});return[3,5];case 4:this._isDisposed||this.setState({showSpinner:!1});return[7];case 5:return[2]}})})};i.state={errorMessage:"",showSpinner:!1};i._options=(function(e,t){var n="",r="",i="";if(t){r=t.major+1+".0";n=0!==t.minor?t.major+"."+t.minor:t.major+".1";i=t.major+"."+(t.minor-1)}var s=[{key:f.default.MinorVersionLabel,text:t?l.format(f.default.MinorVersionLabelWithVersion,n):f.default.MinorVersionLabel,checkInVersionType:0,"data-is-focusable":!0},{key:f.default.MajorVersionLabel,text:t?l.format(f.default.MajorVersionLabelWithVersion,r):f.default.MajorVersionLabel,checkInVersionType:1,"data-is-focusable":!0}];1===e&&t&&t.minor>1&&t.moderationStatusType!==c.ModerationStatusType.approved&&s.push({key:f.default.OverwriteVersionLabel,text:t?l.format(f.default.OverwriteVersionLabelWithVersion,i):f.default.OverwriteVersionLabel,checkInVersionType:2,"data-is-focusable":!0});return s})(t.itemCount,t.itemInfo);return i}t.prototype.componentWillUnmount=function(){this._isDisposed=!0};t.prototype.render=function(){var e=this.props,t=e.onCancel,n=e.enableMinorVersions,l=this.state,c=l.errorMessage,h=l.showSpinner;return r.createElement(s.Dialog,{minWidth:450,maxWidth:450,hidden:!1,dialogContentProps:{title:this._getDialogTitle()},onDismiss:t},n&&r.createElement(a.ChoiceGroup,{componentRef:this._choiceGroupRef,label:f.default.VersionLabel,options:this._options,defaultSelectedKey:f.default.MinorVersionLabel}),r.createElement(o.TextField,{styles:n?{root:{marginTop:20}}:{},label:f.default.CommentLabel,componentRef:this._textField,rows:5,placeholder:f.default.CheckinCommentPlaceHolder,multiline:!0}),r.createElement(s.DialogFooter,null,r.createElement(u.PrimaryButton,{disabled:!!c||h,onClick:this._onClickAction,text:f.default.CheckIn}),h&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium})))};t.prototype._getDialogTitle=function(){var e=this.props,t=e.itemInfo,n=e.itemCount;return n&&n>1?l.format(f.default.CheckInDialogTitle_mult,n):l.format(f.default.CheckInDialogTitle,t&&t.displayName||"")};return t})(r.PureComponent);t.CheckInDialog=h});
define("yU",["require","exports","lC","r","am","bw","Zd","SPListItemsScopeDeferred_IS_mini_css","me","PF","OF","CF","Ps","hE","_F","mF","m7","SU","me"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";u=u.FilterPanel_7;Object.defineProperty(t,"__esModule",{value:!0});var b=g.BasePickerListBelow,w=f.default.ApplyFilterButtonAriaDescription,E=f.default.ApplyFilterButtonLabel,S=f.default.ClearAllButtonLabel,x=function(e){return a.format(f.default.ClearAllButtonAriaDescription,e)},T=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._onSelectedSuggestionOptionChange=function(e){i.setState(function(t){for(var r=-1,i=0;i<t.filterOptionSet.length;i++)if(t.filterOptionSet[i].value===e.value){r=i;break}return{filterOptionSet:-1===r?n.__spreadArrays(t.filterOptionSet,[e]):t.filterOptionSet,checkedFilterValues:-1===t.checkedFilterValues.indexOf(e.value)?n.__spreadArrays(t.checkedFilterValues,[e.value]):t.checkedFilterValues}})};i._onSelectedPersonasChange=function(e){var t=e&&e.length>0&&e[e.length-1];if(t){var n={display:t.name,value:t.name};i._onSelectedSuggestionOptionChange(n)}};i._onRenderNoResultFound=function(){return r.createElement("div",{className:u.filterPanelSuggestionsNone},y.format(f.default.NoResultFoundUsingContains,i._currentText))};i._onResolveSuggestions=function(e,t){i._currentText=e;var n=i.props.filterPickerProps;return n&&n.getFilterSuggestions?n.getFilterSuggestions(i.props.fieldInternalName,i.props.mappedColumnFieldType,e):[]};i._onSelectedSuggestionsChange=function(e){var t=e&&e.length>0&&e[e.length-1];if(t){var n={display:t.display,value:t.value};i._onSelectedSuggestionOptionChange(n)}};i._onCheckboxGroupChange=function(e,t,r){i.setState(function(e){var i=e.checkedFilterValues;if(r)i=n.__spreadArrays(i,[t.key]);else{var s=i.indexOf(t.key);s>-1&&(i=n.__spreadArrays(i.slice(0,s),i.slice(s+1)))}return{checkedFilterValues:i}})};i._onClearAllClick=function(){i.setState({checkedFilterValues:[]})};i._currentText="";i.state={filterOptionSet:t.filterOptionSet,checkedFilterValues:t.checkedFilterValues};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.isLoading&&!e.isLoading&&this.setState({filterOptionSet:e.filterOptionSet,checkedFilterValues:e.checkedFilterValues})};t.prototype.render=function(){var e=this,t=this.props,d=t.columnName,v=t.onClose,g=t.mappedColumnFieldType,b=(t.fieldInternalName,t.isLoading),T=t.applyFiltersAction,N=this.state,C=N.checkedFilterValues,k=N.filterOptionSet,L=k?(function(e,t,n){var r=[];e&&e.length&&(r=e.map(function(e){var n={key:e.value,label:e.display};t===m.ColumnFieldType.User?n.renderType=c.CheckboxGroupOptionRenderType.user:t===m.ColumnFieldType.FileIcon&&(n.renderType=c.CheckboxGroupOptionRenderType.fileType);return n}));return r})(k,g):void 0,A=(function(e){return a.format(f.default.FilterSelectPanelTitle,e)})(d),O=C.length?y.format(f.default.SectionTitleWithNumber,A,C.length):A,M=a.format(a.getLocalizedCountValue(f.default.CheckedFiltersCountAlert,f.default.CheckedFiltersCountIntervals,C.length)||"",C.length);return r.createElement(p.KeyboardZone,null,r.createElement(s.Panel,{"data-automationid":"FilterPanel",className:u.filterPanelRoot,isOpen:!0,type:s.PanelType.smallFixedFar,headerText:O,onDismiss:v,closeButtonAriaLabel:f.default.closeButtonAriaLabel,onRenderFooterContent:b?void 0:function(){return r.createElement("div",{className:u.filterPanelFooter},r.createElement(h.WithAction,{action:T({filterOptionSet:k,checkedFilterKeys:C})},function(t){var s=t.isAvailable,o=t.execute;return r.createElement(i.PrimaryButton,{"data-automationid":"FilterPanel-Apply",onClick:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);return[4,o({})];case 1:e.sent();this.props.onComplete();return[3,3];case 2:e.sent();return[3,3];case 3:return[2]}})})},disabled:!s,ariaDescription:w,text:E})}),r.createElement(i.DefaultButton,{className:u.filterPanelClearAllButton,"data-automationid":"FilterPanel-ClearAll",onClick:e._onClearAllClick,ariaDescription:x(d),text:S}))}},b?r.createElement(o.Spinner,null):r.createElement(r.Fragment,null,this._renderFilterPicker(A),r.createElement("div",{role:"alert",className:u.alert},M),r.createElement(l.CheckboxGroup,{ariaLabel:A,options:L,checkedKeys:C,onChange:this._onCheckboxGroupChange}))))};t.prototype._onRenderItem=function(){return null};t.prototype._getTextFromItem=function(e){return e.display};t.prototype._onRenderSuggestionsItem=function(e){return r.createElement("div",{className:u.filterPanelSuggestionItem},e.display)};t.prototype._renderFilterPicker=function(e){var t=this.props,n=t.mappedColumnFieldType,i=t.filterPickerProps;return n===m.ColumnFieldType.User&&i&&i.peoplePickerDataSource?r.createElement(d.PeoplePicker,{className:u.peoplePickerRoot,context:i.pageContextForPicker,peoplePickerType:v.PeoplePickerType.listBelow,dataSource:i.peoplePickerDataSource,onRenderItem:this._onRenderItem,onSelectedPersonasChange:this._onSelectedPersonasChange,inputProps:{placeholder:f.default.PeoplePickerPlaceholder,"aria-label":e},noResultsFoundText:f.default.NoResults}):n===m.ColumnFieldType.Text||n===m.ColumnFieldType.Title?r.createElement(b,{className:u.filterPickerRoot,onResolveSuggestions:this._onResolveSuggestions,getTextFromItem:this._getTextFromItem,onRenderItem:this._onRenderItem,onRenderSuggestionsItem:this._onRenderSuggestionsItem,pickerSuggestionsProps:{onRenderNoResultFound:this._onRenderNoResultFound},inputProps:{placeholder:f.default.FilterPickerPlaceholder,"aria-label":e},onChange:this._onSelectedSuggestionsChange}):null};return t})(r.PureComponent);t.FilterPanel=T});
define("HVe",["require","exports","lC","RVe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("RVe",["require","exports","li","Me","sS","ii","ih","OP"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderDialogControlHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var o,a=t.itemKey,f=e.demandItemFacet(n.spItemKeyFacet,a),l=u.nameValidator;if(f&&a){var c=f.rootFolder||new i.SimpleUri(f.listFullUrl).path,h=new r.ItemUrlHelperBasic({context:{webAbsoluteUrl:f.webAbsoluteUrl,listUrl:f.listFullUrl}}).getUrlParts({path:c});h.fullItemUrl&&(o=400-h.fullItemUrl.length);var p=f&&e.demandItemFacet(s.spPageContextFacet,n.spPageContextKeyFacet.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}));!p||p.supportPoundStorePath&&p.supportPercentStorePath||(l=u.nameValidatorWithoutPoundPercent)}return{validator:l,maxLength:o}}}})});
define("NVe",["require","exports","lC","BVe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("BVe",["require","exports","ih","jVe","Xy"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemDocumentCreatorControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,s=i.getPageContextFromItemCache(e,n),o=!(!s||!s.isAnonymousGuestUser);return{validator:r.nameValidator.bind(void 0,!!s&&!!s.supportPoundStorePath),askForFileName:o}}}})});
define("jVe",["require","exports","_A","VVe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameValidator=function(e,t){return n.checkFilename(t,r.default,e)}});
define("xN",["require","exports","li","ii","Xy","HN","C1","Xo","g6","m7","ce","T9","F1","AN","EN","wN","ON","Go","CN","Yo","Ro","Jf","Rs","Ik","pr"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N={ODB:1624},C={ODB:1261},k={ODB:1615},L={ODB:1855},A="A2F94414-23FB-4B23-AB7E-869F0766F332",O="12/20/2018",M="Add thumbnail to custom formatters.";t.ColumnFormatterRenderer=o.connectToItemCache(function(e,t){var n=t.fieldName,r=t.customFormatter,i=t.itemSetKey;return r?_(e,{itemKey:t.itemKey,rowIndex:t.rowIndex,customFormatter:r,currentFieldName:n,forFieldRenderer:!0,itemSetKey:i}):{}})(p.CustomFormatterWrapper);t.customFormatterEvalExp=function(e,t){var n=t.itemKey,r=t.itemSetKey,o=t.rowIndex,u=t.expression,a=_(e,{itemKey:n,customFormatter:{},itemSetKey:r,rowIndex:o,forFieldRenderer:!1});if(a){var f={rowIndex:a.rowIndex,fieldRendererFormat:{},row:a.item,currentFieldName:"Title",rowSchema:a.schema,errorStrings:{},pageContextInfo:a.pageContextInfo},h=i.getPageContextFromItemCache(e,n);if(!h||!l.getKillSwitch(h).isActivated(A,O,M)){var p=e.demandItemFacet(c.thumbnailUrlGeneratorFacet,n);p&&(f.thumbnails=p)}return new s.CustomFormatter(f).evalExpression(u)}return""};t.CustomRowRenderer=o.connectToItemCache(function(e,t){return _(e,{itemKey:t.itemKey,rowIndex:t.rowIndex,itemSetKey:t.itemSetKey,customFormatter:t.formatter,forFieldRenderer:!1})})(p.CustomFormatterWrapper);t.CustomGroupHeaderRenderer=o.connectToItemCache(function(e,t){var n=t.itemKey,r=t.rowIndex,i=t.itemSetKey,s=t.formatter;return{item:H(e,n,i),itemKey:n,rowIndex:r,customFormatter:s,schema:P(e,i),currentField:"Title",forFieldRenderer:!1,itemCacheDispatch:e.dispatch}})(p.CustomFormatterWrapper);t.CustomTileRenderer=o.connectToItemCache(function(e,t){var n=t.itemKey,r=t.itemSetKey;return _(e,{itemKey:n,rowIndex:t.rowIndex,itemSetKey:r,customFormatter:(function(e){if(e){e.style||(e.style={});e.style.height=e.style.height||"100%";e.style.overflow=e.style.overflow||"hidden";e.style["box-sizing"]=e.style["box-sizing"]||"border-box"}return e})(t.formatter),forFieldRenderer:!1})})(p.CustomFormatterWrapper);t.tileDesigner={defaultCardDimensions:m.defaultCardDimensions,topPreviewEligibleCols:m.topPreviewEligibleCols,createDefaultTileProps:d.createDefaultTileProps,createJSONFromConfig:d.createJSONFromConfig,generateInitialTileDesignerConfig:d.generateInitialTileDesignerConfig,decodeTileDesignerConfig:d.decodeTileDesignerConfig,encodeTileDesignerConfig:d.encodeTileDesignerConfig,encodeTileDesignerConfigForDocLib:v.encodeTileDesignerConfigForDocLib,shouldExcludeColumnInCards:d.shouldExcludeColumnInCards};function _(e,t){var s,o=t.itemKey,u=t.itemSetKey,f=t.rowIndex,p=t.customFormatter,d=t.currentFieldName,v=t.forFieldRenderer,m=e.demandItem({key:n.spItemKeyFacet,rowData:r.rowDataFacet},o),y=i.getPageContextFromItemCache(e,o),b=h.getItemsScope(e).itemsScopeItemKey,w=g.getCurrentLayout(e,{itemsScopeItemKey:b}),E=a.isFeatureEnabled(e,{feature:C,pageContext:y}),S=a.isFeatureEnabled(e,{feature:N,pageContext:y}),x=a.isFeatureEnabled(e,{feature:k,pageContext:y}),T=a.isFeatureEnabled(e,{feature:L,pageContext:y});s={rowIndex:f,customFormatter:p,item:m&&m.rowData,isRecordVersionngFlightOn:E,itemKey:o,currentField:d||"Title",schema:P(e,u),forFieldRenderer:v,pageContextInfo:y,layoutType:w,itemCacheDispatch:e.dispatch,features:{customCards:S,defaultCards:x,formatterReferences:T},fieldMetaData:D(e,u)};if(!y||!l.getKillSwitch(y).isActivated(A,O,M)){var _=e.demandItemFacet(c.thumbnailUrlGeneratorFacet,o);_&&(s.thumbnails=_)}return s}function D(e,t){if(t){var n=x.readItemSetSchemaFromItemCache(e,{mapping:{fieldData:r.fieldDataFacet},itemSetKey:t}),i={};for(var s in n)if(n.hasOwnProperty(s)){var o=n[s].fieldData;o&&o.RealFieldName&&(i[o.RealFieldName]={DisplayName:o.DisplayName||""})}return i}}function P(e,t){var n={},i=e.demandItem({schema:u.schemaFacet},t).schema,s=i&&i.columnKeys;if(s)for(var o=0,a=s;o<a.length;o++){var l=a[o],c=e.demandItem({internalName:r.internalNameFacet,realFieldName:r.realFieldNameFacet,fieldType:r.fieldTypeFacet,mappedFieldType:r.mappedColumnFieldTypeFacet},l),h=c.internalName,p=c.realFieldName,d=c.fieldType,v=c.mappedFieldType;h&&d&&("_IsRecord"===h?n._IsRecord="_IsRecord":n[p||h]=void 0!==v&&f.ColumnFieldType[v]||d)}return n}t.getCustomFormatterSchemaFromItemCache=P;t.getCustomFormatterSchemaFromColumns=function(e){void 0===e&&(e=[]);for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.internalName,o=i.mappedColumnFieldType,u=i.RealFieldName,a=i.FieldType;s&&a&&("_IsRecord"===s?t._IsRecord="_IsRecord":t[u||s]=void 0!==o&&f.ColumnFieldType[o]||a)}return t};t.mapColumnNameToColumnCustomFormatter=function(e){void 0===e&&(e=[]);for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];if(i.RealFieldName&&i.CustomFormatter)try{t[i.RealFieldName]=JSON.parse(i.CustomFormatter)}catch(e){}}return t};t.getSelectedRowIndex=function(e){var t=h.getItemsScope(e).itemsScopeItemKey,n=w.getCurrentItemSetKey(e,t),r=b.getSelectedItemKeys(e,{itemsScopeItemKey:t}).slice(-1)[0];return y.getItemIndexInSet(e,{itemKey:r,itemSetKey:n})};function H(e,t,i){var s,o,u,a=e.demandItem({columnTotals:r.columnTotalsFacet,count:E.countFacet,displayName:S.displayNameFacet,spGroupField:r.spGroupFieldFacet,spItemGroup:n.spItemGroupKeyFacet},t),f=x.readItemSetSchemaFromItemCache(e,{mapping:{fieldData:r.fieldDataFacet},itemSetKey:i}),l={groupBy:{internalName:null===(s=a.spGroupField)||void 0===s?void 0:s.internalName,displayName:B(f,null===(o=a.spGroupField)||void 0===o?void 0:o.internalName),title:null===(u=a.spItemGroup)||void 0===u?void 0:u.groupId,count:a.count},aggregates:[]};for(var c in a.columnTotals)if(a.columnTotals.hasOwnProperty(c)){var h=T.spListFieldKeyFacet.deserialize(c).internalName;l.aggregates.push({internalName:h,displayName:B(f,h),aggregateName:a.columnTotals[c].type,aggregateValue:a.columnTotals[c].value})}return l}function B(e,t){var n,r,i,s;for(var o in e)if((null===(r=null===(n=e[o])||void 0===n?void 0:n.fieldData)||void 0===r?void 0:r.Name)===t)return(null===(s=null===(i=e[o])||void 0===i?void 0:i.fieldData)||void 0===s?void 0:s.DisplayName)||t}});
define("AN",["require","exports","lC","r","HN","E7","Ps","Kf","Km","wb","UN","PN","ce","SPListItemsScopeDeferred_IS_mini_css","vs","Mr","f7","kN","LN","E7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";p=p.CustomFormatterRenderer_2;Object.defineProperty(t,"__esModule",{value:!0});t.getItemData=b.getItemData;var w=h.Killswitch.isActivated("A2F94414-23FB-4B23-AB7E-869F0766F332","12/20/2018","Add thumbnail to custom formatters."),E=(function(e){n.__extends(t,e);function t(i){var s=e.call(this,i)||this;s._onActionsUpdated=function(e){s._actions=e.actions};s._actionClickHandler=function(e){var t=e.currentTarget,n=t.getAttribute("data-actionname"),r=t.getAttribute("data-actionparams");r&&(r=JSON.stringify(r));var i=n+(r||""),o=s._actions[i];o&&o.isAvailable&&o.execute({event:e}).catch(function(){})};s._setupListeners=function(e){void 0===e&&(e=!1);var t=s._rootRef&&s._rootRef.current,n=e?"removeEventListener":"addEventListener",r=function(e){var t=e.currentTarget;""!==t.getAttribute("src")&&(t.src="")};if(t){[].forEach.call(t.querySelectorAll("button[data-iscustomformatter=true]"),function(e){e[n]("click",s._actionClickHandler)});w||[].forEach.call(t.querySelectorAll("img[data-iscustomformatterthumbnail=true]"),function(e){e[n]("error",r)})}};s._onRenderContent=function(e){return r.createElement(t,n.__assign({},s.props,{customFormatter:e}))};s._rootRef=r.createRef();var o=s.props.itemKey;s._actions={};s.state={itemKeys:o?[o]:[]};return s}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.itemKey;t!==this.props.itemKey&&this.setState({itemKeys:t?[t]:[]})};t.prototype.render=function(){var e=this.props,t=e.item,u=e.layoutType,a=e.customFormatter,f=e.features,l=e.rowIndex,c=e.forFieldRenderer,h=e.schema,m=e.isRecordVersionngFlightOn,b=e.currentField,E=e.thumbnails,T=e.pageContextInfo,N=e.itemCacheDispatch,C=e.fieldMetaData;if(!t)return null;var k=c?u&&u===d.compactDetailsLayoutType?p.customFieldCompact:p.customField:u===v.tilesLayoutType?p.customFieldTiles:void 0,L=new i.CustomFormatter(n.__assign({pageContextInfo:T,features:f,fieldRendererFormat:a,row:x(t)?t:s.getItemData(t,h,!!m),rowIndex:l,fieldMetaData:C,currentFieldName:b,rowSchema:h,errorStrings:{}},w?{}:{thumbnails:E})),A=L&&L.evaluate();return A?r.createElement(o.WithActionSet,{actions:S({itemKeyAsArray:this.state.itemKeys,html:A}),onActionsUpdated:this._onActionsUpdated},r.createElement("div",{className:k,dangerouslySetInnerHTML:{__html:A},ref:this._rootRef}),f&&f.customCards?r.createElement(g.CustomCards,{rootRef:this._rootRef,customFormatter:a,onRenderContent:this._onRenderContent,itemCacheDispatch:N}):null,f&&f.defaultCards?r.createElement(y.DefaultCards,n.__assign({},this.props,{rootRef:this._rootRef})):null):null};t.prototype.componentDidMount=function(){var e=this.props,t=e.schema,n=e.currentField,r=e.customFormatter,i=e.rowIndex,s=e.forFieldRenderer,o=e.itemCacheDispatch,u=e.features;if(s&&0===i){var a="CustomFormatterField."+(t&&t[n]);o(m.logEngagement({name:a,extraData:{templateId:r.templateId},isIntentional:!0}));u&&u.formatterReferences&&(function e(t){if(t.columnFormatterReference)return!0;if(t.children)for(var n=t.children,r=0;r<n.length;r++){var i=n[r];if(e(i))return!0}return!1})(r)&&o(m.logEngagement({name:"FormatterReferenceField",isIntentional:!0}))}this._setupListeners()};t.prototype.componentDidUpdate=function(e){e.item===this.props.item&&e.customFormatter===this.props.customFormatter||this._setupListeners()};t.prototype.componentWillUnmount=function(){this._setupListeners(!0)};return t})(r.PureComponent);t.CustomFormatterWrapper=E;function S(e){var t=e.itemKeyAsArray,n=e.itemKeyAsArray[0],i=e.html,s={},o=(new DOMParser).parseFromString(i,"text/xml").querySelectorAll("button[data-iscustomformatter=true]");if(o&&o.length)for(var h=0;h<o.length;h++){var p=o[h],d=p.getAttribute("data-actionname"),v=p.getAttribute("data-actionparams");v&&(v=JSON.stringify(v));var m=d+(v||"");"defaultClick"===d?s[m]=r.createElement(u.ItemDefaultClickAction,{itemKey:n}):"share"===d?s[m]=r.createElement(a.ItemShareAction,{itemKey:n}):"delete"===d?s[m]=r.createElement(f.ItemDeleteAction,{itemKeys:t}):"editProps"===d?s[m]=r.createElement(l.ItemEditPropsAction,{itemKey:n}):"executeFlow"===d&&(s[m]=r.createElement(c.ItemExecuteFlowAction,{itemKey:n,actionParam:v||"",noCache:!0}))}return s}function x(e){return!!e.groupBy}});
define("UN",["require","exports","C1","FN","Ps"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemEditPropsAction=n.createItemCacheComponent(function(e,t){var n=t.itemKey,s=e.demandItemFacet(r.itemEditPropsActionControl,n),o=r.itemEditPropsActionControl.evaluate(s)(e,{itemKey:n}).onClickAction;return i.evaluateAction(e,o)})});
define("PN",["require","exports","Ps","C1","TN","ks"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemExecuteFlowAction=r.createItemCacheComponent(function(e,t){var r=e.demandItemFacet(i.itemExecuteFlowActionControl,t.itemKey),o=i.itemExecuteFlowActionControl.evaluate(r)(e,{itemKey:t.itemKey,actionParam:t.actionParam,noCache:t.noCache,onClickAction:s.Action}).onClickAction;return n.renderAction(o)})});
define("kN",["require","exports","lC","r","SPListItemsScopeDeferred_IS_mini_css","dN","Ru","ku","r","f7"],function(e,t,n,r,i,s,o,u,a,f){"use strict";i=i.CustomFormatterRenderer_2;Object.defineProperty(t,"__esModule",{value:!0});t.CustomCards=function(e){var t=a.useState({}),l=t[0],c=t[1],h=function(e,t){var r=e.getAttribute("id");r&&c(function(e){var i;return n.__assign(n.__assign({},e),((i={})[r]=t,i))})},p=function(t){var n=t&&t.currentTarget,r=t&&t.target;if(null!==r.getAttribute("data-event-trigger")&&r===n){var i=e.itemCacheDispatch;i&&i(f.logEngagement({name:"CustomCardType",extraData:{CustomCardEvent:t.type},isIntentional:!0}));h(n,!0)}};a.useEffect(function(){(function(t){void 0===t&&(t=!1);var n=e.rootRef&&e.rootRef.current;if(n){var r=t?"removeEventListener":"addEventListener",i={click:"click",hover:"mouseover"};[].forEach.call(n.querySelectorAll("[data-custom-card-path]"),function(e){var t=e.getAttribute("data-event-trigger");if("click"===t||"hover"===t){e[r](i[t],p);"hover"===t&&e[r]("focus",p)}})}})()},[e.customFormatter]);var d=function(t){if(t){var n=t?t.formatter:{};return e.onRenderContent(n)}return null},v=function(e){e&&h(e,!1)},m=e.rootRef&&e.rootRef.current;if(!m)return null;var g=Object.keys(l).filter(function(e){return l[e]}).map(function(t){var a,f=m.querySelector('[id = "'+t+'"]');f&&(a=(function(t){if(t){var n=null!==t.getAttribute("data-custom-card-path")?String(t.getAttribute("data-custom-card-path")).split("."):"",r=e.customFormatter;if(r)for(var i=1;i<n.length;i++){var s=Number(n[i]);r.children&&s<r.children.length&&(r=r.children[s])}return r&&r.customCardProps}})(f));if(a){var l=a.openOnEvent,c=a.isBeakVisible,h=a.beakStyle,p=a.directionalHint,g={key:t,className:i.customCards,role:"alertDialog",target:f},y={isBeakVisible:c||!1,directionalHint:p&&u.DirectionalHint[p]||12,gapSpace:8,styles:n.__assign({beak:n.__assign({},h)})};if("click"===l)return r.createElement(o.Callout,n.__assign({onDismiss:function(){return v(f)},setInitialFocus:!0,"data-automation-id":"custom-callout"},g,y),d(a));if("hover"===l)return r.createElement(s.HoverCard,n.__assign({plainCardProps:{onRenderPlainCard:d,renderData:a,calloutProps:n.__assign({},y)},onCardHide:function(){return v(f)},type:s.HoverCardType.plain,"data-automation-id":"custom-hovercard"},g))}});return r.createElement(r.Fragment,null,g)}});
define("dN",["require","exports","lC","lN"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("lN",["require","exports","lC","SN","yN","vN","bN","hN","_N","pN","uN","ku"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t)});
define("SN",["require","exports","us","DN","yN"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HoverCard=n.styled(i.HoverCardBase,r.getStyles,void 0,{scope:"HoverCard"})});
define("DN",["require","exports","oc"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={host:"ms-HoverCard-host"};t.getStyles=function(e){var t=e.className,i=e.theme;return{host:[n.getGlobalClassNames(r,i).host,t]}}});
define("yN",["require","exports","lC","r","us","vN","bN","_N","pN"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i.classNamesFunction(),l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._hoverCard=r.createRef();n.dismiss=function(e){n._async.clearTimeout(n._openTimerId);n._async.clearTimeout(n._dismissTimerId);e?n._dismissTimerId=n._async.setTimeout(function(){n._setDismissedState()},n.props.cardDismissDelay):n._setDismissedState()};n._cardOpen=function(e){if(!(n._shouldBlockHoverCard()||"keydown"===e.type&&e.which!==n.props.openHotKey)){n._async.clearTimeout(n._dismissTimerId);"mouseenter"===e.type&&(n._currentMouseTarget=e.currentTarget);n._executeCardOpen(e)}};n._executeCardOpen=function(e){n._async.clearTimeout(n._openTimerId);n._openTimerId=n._async.setTimeout(function(){n.setState(function(t){return t.isHoverCardVisible?t:{isHoverCardVisible:!0,mode:u.ExpandingCardMode.compact,openMode:"keydown"===e.type?s.OpenCardMode.hotKey:s.OpenCardMode.hover}})},n.props.cardOpenDelay)};n._cardDismiss=function(e,t){if(e){if(!(t instanceof MouseEvent))return;if("keydown"===t.type&&t.which!==i.KeyCodes.escape)return;n.props.sticky||n._currentMouseTarget!==t.currentTarget&&t.which!==i.KeyCodes.escape||n.dismiss(!0)}else{if(n.props.sticky&&!(t instanceof MouseEvent)&&t.nativeEvent instanceof MouseEvent&&"mouseleave"===t.type)return;n.dismiss(!0)}};n._setDismissedState=function(){n.setState({isHoverCardVisible:!1,mode:u.ExpandingCardMode.compact,openMode:s.OpenCardMode.hover})};n._instantOpenAsExpanded=function(e){n._async.clearTimeout(n._dismissTimerId);n.setState(function(e){return e.isHoverCardVisible?e:{isHoverCardVisible:!0,mode:u.ExpandingCardMode.expanded}})};n._setEventListeners=function(){var e=n.props,t=e.trapFocus,r=e.instantOpenOnClick,i=e.eventListenerTarget,s=i?n._getTargetElement(i):n._getTargetElement(n.props.target),o=n._nativeDismissEvent;if(s){n._events.on(s,"mouseenter",n._cardOpen);n._events.on(s,"mouseleave",o);if(t)n._events.on(s,"keydown",n._cardOpen);else{n._events.on(s,"focus",n._cardOpen);n._events.on(s,"blur",o)}if(r)n._events.on(s,"click",n._instantOpenAsExpanded);else{n._events.on(s,"mousedown",o);n._events.on(s,"keydown",o)}}};i.initializeComponentRef(n);n._async=new i.Async(n);n._events=new i.EventGroup(n);n._nativeDismissEvent=n._cardDismiss.bind(n,!0);n._childDismissEvent=n._cardDismiss.bind(n,!1);n.state={isHoverCardVisible:!1,mode:u.ExpandingCardMode.compact,openMode:s.OpenCardMode.hover};return n}t.prototype.componentDidMount=function(){this._setEventListeners()};t.prototype.componentWillUnmount=function(){this._async.dispose();this._events.dispose()};t.prototype.componentDidUpdate=function(e,t){var n=this;if(e.target!==this.props.target){this._events.off();this._setEventListeners()}if(t.isHoverCardVisible!==this.state.isHoverCardVisible)if(this.state.isHoverCardVisible){this._async.setTimeout(function(){n.setState({mode:u.ExpandingCardMode.expanded},function(){n.props.onCardExpand&&n.props.onCardExpand()})},this.props.expandedCardOpenDelay);this.props.onCardVisible&&this.props.onCardVisible()}else{this.setState({mode:u.ExpandingCardMode.compact});this.props.onCardHide&&this.props.onCardHide()}};t.prototype.render=function(){var e=this.props,t=e.expandingCardProps,u=e.children,l=e.id,c=e.setAriaDescribedBy,h=void 0===c||c,p=e.styles,d=e.theme,v=e.className,m=e.type,g=e.plainCardProps,y=e.trapFocus,b=e.setInitialFocus,w=this.state,E=w.isHoverCardVisible,S=w.mode,x=w.openMode,T=l||i.getId("hoverCard");this._classNames=f(p,{theme:d,className:v});var N=n.__assign(n.__assign({},i.getNativeProps(this.props,i.divProperties)),{id:T,trapFocus:!!y,firstFocus:b||x===s.OpenCardMode.hotKey,targetElement:this._getTargetElement(this.props.target),onEnter:this._cardOpen,onLeave:this._childDismissEvent}),C=n.__assign(n.__assign(n.__assign({},t),N),{mode:S}),k=n.__assign(n.__assign({},g),N);return r.createElement("div",{className:this._classNames.host,ref:this._hoverCard,"aria-describedby":h&&E?T:void 0,"data-is-focusable":!this.props.target},u,E&&(m===s.HoverCardType.expanding?r.createElement(o.ExpandingCard,n.__assign({},C)):r.createElement(a.PlainCard,n.__assign({},k))))};t.prototype._getTargetElement=function(e){switch(typeof e){case"string":return i.getDocument().querySelector(e);case"object":return e;default:return this._hoverCard.current||void 0}};t.prototype._shouldBlockHoverCard=function(){return!(!this.props.shouldBlockHoverCard||!this.props.shouldBlockHoverCard())};t.defaultProps={cardOpenDelay:500,cardDismissDelay:100,expandedCardOpenDelay:1500,instantOpenOnClick:!1,setInitialFocus:!1,openHotKey:i.KeyCodes.c,type:s.HoverCardType.expanding};return t})(r.Component);t.HoverCardBase=l});
define("vN",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.hover=0]="hover";e[e.hotKey=1]="hotKey"})(t.OpenCardMode||(t.OpenCardMode={}));(function(e){e.plain="PlainCard";e.expanding="ExpandingCard"})(t.HoverCardType||(t.HoverCardType={}))});
define("bN",["require","exports","us","gN","hN"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExpandingCard=n.styled(i.ExpandingCardBase,r.getStyles,void 0,{scope:"ExpandingCard"})});
define("gN",["require","exports","oc"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-ExpandingCard-root",compactCard:"ms-ExpandingCard-compactCard",expandedCard:"ms-ExpandingCard-expandedCard",expandedCardScroll:"ms-ExpandingCard-expandedCardScrollRegion"};t.getStyles=function(e){var t,i=e.theme,s=e.needsScroll,o=e.expandedCardFirstFrameRendered,u=e.compactCardHeight,a=e.expandedCardHeight,f=e.className,l=i.palette,c=n.getGlobalClassNames(r,i);return{root:[c.root,{width:320,pointerEvents:"none",selectors:(t={},t[n.HighContrastSelector]={border:"1px solid WindowText"},t)},f],compactCard:[c.compactCard,{pointerEvents:"auto",position:"relative",height:u}],expandedCard:[c.expandedCard,{height:1,overflowY:"hidden",pointerEvents:"auto",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)",selectors:{":before":{content:'""',position:"relative",display:"block",top:0,left:24,width:272,height:1,backgroundColor:l.neutralLighter}}},o&&{height:a}],expandedCardScroll:[c.expandedCardScroll,s&&{height:"100%",boxSizing:"border-box",overflowY:"auto"}]}}});
define("hN",["require","exports","lC","r","us","_N","fN"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.classNamesFunction(),a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._expandedElem=r.createRef();n._onKeyDown=function(e){e.which===i.KeyCodes.escape&&n.props.onLeave&&n.props.onLeave(e)};n._onRenderCompactCard=function(){return r.createElement("div",{className:n._classNames.compactCard},n.props.onRenderCompactCard(n.props.renderData))};n._onRenderExpandedCard=function(){!n.state.firstFrameRendered&&n._async.requestAnimationFrame(function(){n.setState({firstFrameRendered:!0})});return r.createElement("div",{className:n._classNames.expandedCard,ref:n._expandedElem},r.createElement("div",{className:n._classNames.expandedCardScroll},n.props.onRenderExpandedCard&&n.props.onRenderExpandedCard(n.props.renderData)))};n._checkNeedsScroll=function(){var e=n.props.expandedCardHeight;n._async.requestAnimationFrame(function(){n._expandedElem.current&&n._expandedElem.current.scrollHeight>=e&&n.setState({needsScroll:!0})})};n._async=new i.Async(n);i.initializeComponentRef(n);n.state={firstFrameRendered:!1,needsScroll:!1};return n}t.prototype.componentDidMount=function(){this._checkNeedsScroll()};t.prototype.componentWillUnmount=function(){this._async.dispose()};t.prototype.render=function(){var e=this.props,t=e.styles,i=e.compactCardHeight,a=e.expandedCardHeight,f=e.theme,l=e.mode,c=e.className,h=this.state,p=h.needsScroll,d=h.firstFrameRendered,v=i+a;this._classNames=u(t,{theme:f,compactCardHeight:i,className:c,expandedCardHeight:a,needsScroll:p,expandedCardFirstFrameRendered:l===s.ExpandingCardMode.expanded&&d});var m=r.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this._onRenderCompactCard(),this._onRenderExpandedCard());return r.createElement(o.CardCallout,n.__assign({},this.props,{content:m,finalHeight:v,className:this._classNames.root}))};t.defaultProps={compactCardHeight:156,expandedCardHeight:384,directionalHintFixed:!0};return t})(r.Component);t.ExpandingCardBase=a});
define("_N",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.compact=0]="compact";e[e.expanded=1]="expanded"})(t.ExpandingCardMode||(t.ExpandingCardMode={}))});
define("fN",["require","exports","lC","r","us","ku","Ru"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CardCallout=function(e){var t=e.gapSpace,u=void 0===t?0:t,a=e.directionalHint,f=void 0===a?s.DirectionalHint.bottomLeftEdge:a,l=e.directionalHintFixed,c=e.targetElement,h=e.firstFocus,p=e.trapFocus,d=e.onLeave,v=e.className,m=e.finalHeight,g=e.content,y=e.calloutProps,b=n.__assign(n.__assign(n.__assign({},i.getNativeProps(e,i.divProperties)),{className:v,target:c,isBeakVisible:!1,directionalHint:f,directionalHintFixed:l,finalHeight:m,minPagePadding:24,onDismiss:d,gapSpace:u}),y);return r.createElement(r.Fragment,null,p?r.createElement(o.FocusTrapCallout,n.__assign({},b,{focusTrapProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!h}}),g):r.createElement(o.Callout,n.__assign({},b),g))}});
define("pN",["require","exports","us","mN","uN"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PlainCard=n.styled(i.PlainCardBase,r.getStyles,void 0,{scope:"PlainCard"})});
define("mN",["require","exports","oc"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-PlainCard-root"};t.getStyles=function(e){var t,i=e.theme,s=e.className;return{root:[n.getGlobalClassNames(r,i).root,{pointerEvents:"auto",selectors:(t={},t[n.HighContrastSelector]={border:"1px solid WindowText"},t)},s]}}});
define("uN",["require","exports","lC","r","us","fN"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.classNamesFunction(),u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onKeyDown=function(e){e.which===i.KeyCodes.escape&&n.props.onLeave&&n.props.onLeave(e)};i.initializeComponentRef(n);return n}t.prototype.render=function(){var e=this.props,t=e.styles,i=e.theme,u=e.className;this._classNames=o(t,{theme:i,className:u});var a=r.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this.props.onRenderPlainCard(this.props.renderData));return r.createElement(s.CardCallout,n.__assign({},this.props,{content:a,className:this._classNames.root}))};return t})(r.Component);t.PlainCardBase=u});
define("LN",["require","exports","r","Z4","h_","li","SPListItemsScopeDeferred_IS_mini_css","Ec","E"],function(e,t,n,r,i,s,o,u,a){"use strict";o=o.CustomFormatterRenderer_2;Object.defineProperty(t,"__esModule",{value:!0});t.DefaultCards=function(e){var t=n.useState(),f=t[0],l=t[1];n.useEffect(function(){function t(){f!==e.customFormatter&&l(e.customFormatter)}var n=e.rootRef.current;if(n&&(n.querySelector("[default-hovercard]")||c>0)){n.addEventListener("mouseenter",t);return function(){n.removeEventListener("mouseenter",t)}}},[e.rootRef.current,f,e.customFormatter]);var c=0,h=e.rootRef.current;if(h&&f&&f===e.customFormatter){var p=Array.prototype.slice.call(h.querySelectorAll("[default-hovercard]"));if(p.length>=0)return n.createElement(u.WithItemCache,null,function(t){for(var u=t.itemCache,f=e.item,l=e.itemKey,d=e.forFieldRenderer,v=e.schema,m=[],g=0,y=h.parentElement||h,b=0,w=p;b<w.length;b++){var E=w[b],S=E.getAttribute("default-hovercard");if(S){var x=S.trim().split(".",2),T=x[0],N=x[1],C=E.getBoundingClientRect(),k=d?o.fieldDefaultHoverCard:o.defaultHoverCard,L=v[T],A=n.createElement("div",{style:{height:C.height,width:C.width}}),O=void 0,M=new a.Qos({name:"CFDefaultCards"});switch(L){case"User":if(f[T]&&""!==f[T]){var _=s.spPersonKeyFacet.serialize({id:f[T][N].id}),D=r.getUserHoverCard(u,{itemKey:_});if(D){M.end({resultType:a.ResultTypeEnum.Success});O=n.createElement(D,{personKey:_},A)}else M.end({resultType:a.ResultTypeEnum.Failure,error:"There was an error while getting default LPC"})}break;case"Name":var P=i.getItemHoverCard(u,{itemKey:l});if(P){M.end({resultType:a.ResultTypeEnum.Success});O=n.createElement(P,{itemKey:l},A)}else M.end({resultType:a.ResultTypeEnum.Failure,error:"There was an error while getting default File hover card"})}if(O){var H=y.getBoundingClientRect();m.push(n.createElement("div",{className:k,style:{top:C.top-H.top,left:C.left-H.left,height:C.height,width:C.width},key:g++},O))}}}c=m.length;return n.createElement(n.Fragment,null,m)})}return null}});
define("CN",["require","exports","fi","do","Xo","Bp","Jf"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new n.KeyFacet("itemInItemSet",{itemKey:n.stringPart(),itemSetKey:n.stringPart()}),a=new r.ComputedItemFacet("itemSetItemIndexMap",function(e,t){var n=t.itemKey,r=e.demandItemFacet(i.childItemsFacet,n),u=r&&r.itemKeys,a=e.demandItemFacet(s.childItemsControl,n),f=s.childItemsControl.evaluate(a)(e,{itemKey:n,itemKeys:u}).itemKeys,l={},c=0;f&&(function t(n){for(var r=0,u=n;r<u.length;r++){var a=u[r];if(a){if(e.demandItemFacet(i.pageFacet,a)){"number"==typeof(f=e.demandItemFacet(o.countFacet,a))&&(c+=f)}else{if(e.demandItemFacet(o.isGroupFacet,a)){var f,h=e.demandItemFacet(i.childItemsFacet,a),p=h&&h.itemKeys,d=e.demandItemFacet(s.childItemsControl,a),v=s.childItemsControl.evaluate(d)(e,{itemKey:a,itemKeys:p}).itemKeys;if(v){t(v);continue}"number"==typeof(f=e.demandItemFacet(o.countFacet,a))&&(c+=f)}else{l[a]=c;c++}}}else c++}})(f);return l}),f=new r.ComputedItemFacet("itemIndexInSet",function(e,t){var n=e.demandItemFacet(u,t.itemKey);if(n){var r=n.itemKey,i=n.itemSetKey,s=e.demandItemFacet(a,i);if(s)return s[r]}});t.getItemIndexInSet=function(e,t){var n=t.itemKey,r=t.itemSetKey;if(!n||!r)return-1;var i=e.demandItemFacet(f,u.serialize({itemKey:n,itemSetKey:r}),{suppressGetItems:!0});return"number"==typeof i?i:-1}});
define("zVe",["require","exports","lC","xv","A8"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getListRootFolder=function(e){var t=this,s=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=i.getListApiUrl({webAbsoluteUrl:s,listFullUrl:o}).segment("RootFolder");return[4,e(r.getDataWithCache({url:t.toString(),method:"GET",webAbsoluteUrl:s,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,n.sent()]}})})}}});
define("GVe",["require","exports","Hm","ih","li","tze","KVe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointAddonAutoRefresh=n.createAddon(function(){return function(e){e(r.registerControlHandler(i.spFolderItemSetKeyFacet,s.itemAutoRefreshControl)(o.itemAutoRefreshControlHandler))}})});
define("tze",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemAutoRefreshControl=new n.ControlFacet("itemAutoRefreshControl")});
define("KVe",["require","exports","lC","r","Rm","ih","A1","eze","GA","qA","ri","tS","$Ve","JVe","ai","ce","v7","g6","ii","li","xv","YVe","qVe","WVe","k1","oo","F1","fi","Go","y6","v"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M={ODB:860},_={ODB:818},D=new k.KeyFacet("itemAutoRefreshHelper",{itemsScopeItemKey:k.stringPart(),spPageContextKey:k.stringPart()}),P=N.asOnceOnly(function(e){return{}});function H(e){var t=T.useItemCacheDispatch();r.useLayoutEffect(function(){var n,r,s,o,f,l,c,d,m,g;return t((r=(n=e).spPageContextKey,s=n.pageContext,o=n.listId,f=n.webAbsoluteUrl,l=n.listFullUrl,c=n.isTAB,d=n.itemKey,m=n.driveUrl,g=n.itemsScopeItemKey,function(e){var t=e(P),n=D.serialize({itemsScopeItemKey:g,spPageContextKey:r}),y=t[n];if(!y){var b,w,E=void 0;if(s&&!v.getKillSwitch(s).isActivated("1280C2A6-E41F-4140-9BBD-AD7F6BC4C604","10/31/2019","Use socketIo api for list subscriptions")){var T=e(a.getDataRequestor).dataRequestor;E=new h.default({listId:o,webAbsoluteUrl:f},{dataRequestor:T})}else E=new x.default({dispatch:e,webAbsoluteUrl:f,listFullUrl:l,listId:o});b=new p.default({disableWebSockets:!0},{subscriptionService:E});w=new S.default({pushChannelService:b,subscriptionService:E,webAbsoluteUrl:f,listFullUrl:l,itemSetKey:d});y=t[n]=new u.default({id:n,isTestMode:c,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:m,dispatch:e,template:w,itemsScopeItemKey:g,pushChannelService:b,logQoS:function(t){var n=e(i.logQoS(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete t[n]}})}return y})).subscribe()},[]);return null}function B(e){var t=T.useItemCacheDispatch();r.useLayoutEffect(function(){return t((function(e){var t=this,r=e.spPageContextKey,s=e.webAbsoluteUrl,o=e.listFullUrl,l=e.isTAB,c=e.driveAccessToken,d=e.pageContext,m=e.driveUrl,g=e.endpoint,y=e.itemsScopeItemKey;return function(e){var S=e(P),x=D.serialize({itemsScopeItemKey:y,spPageContextKey:r}),T=S[x];if(!T){var N,C,k=e(a.getDataRequestor).dataRequestor;C=new E.default({dataRequestor:k,rootItemKey:b.spItemKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:o,rootFolder:""})});N=new p.default({disableWebSockets:!0},{subscriptionService:new h.default({},{dataRequestor:k}),sessionTokenFetcher:function(){return n.__awaiter(t,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:if(!d||!v.getKillSwitch(d).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!l)return[3,1];t=c;return[3,3];case 1:return[4,e(w.getAuthToken({url:m,disallowCookies:!0}))];case 2:t=n.sent();n.label=3;case 3:return[3,7];case 4:return(i=g)?[4,e(f.getSessionToken(g,m))]:[3,6];case 5:i=n.sent();n.label=6;case 6:t=(r=i)&&r.accessToken;n.label=7;case 7:if(!t)throw new O.ApiError({code:"authFailure"});return[2,{accessToken:t,tokenUrl:m}]}})})}});T=S[x]=new u.default({id:x,isTestMode:l,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:m,dispatch:e,itemsScopeItemKey:y,template:C,pushChannelService:N,logQoS:function(t){var n=e(i.logQoS(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete S[x]}})}return T}})(e)).subscribe()},[]);return null}t.itemAutoRefreshControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey;if(!n)return{};var i=e.demandItem({key:b.spFolderItemSetKeyFacet},n).key;if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,u=i.listFullUrl,a=b.spPageContextKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:u}),f=e.demandItemFacet(y.spPageContextFacet,a);if(!g.isFeatureEnabled(e,{feature:M,pageContext:f})||!g.isFeatureEnabled(e,{feature:_,pageContext:f}))return{};var h=b.spListKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:u}),p=e.demandItem({listFacets:y.listFacet,listMediaTransformSchema:m.listMediaTransformFacet},h),v=p.listFacets,w=p.listMediaTransformSchema;if(!v||void 0===v.id||void 0===v.templateType)return{};var E=v.isDocumentLibrary,S=d.isGenericList(v.templateType);if(!E&&!S)return{};var x,T=o.getConfiguration(e,{isTAB:l.isTestMode}).isTAB,N=w&&w[".driveUrl"],k=N&&c.getUrlParts(N),O=k&&k.endpoint,D=C.getItemsScope(e).itemsScopeItemKey||"itemsSCopeItemKey";if(E&&!N)return{};var P=L.getCurrentLayout(e,{itemsScopeItemKey:D});if(P&&P.id===A.quickEditLayoutType.id)return{};if(E){if(!w)return{};if(!N)return{};if(T){var j=w[".driveAccessToken"];x=j&&j.replace("access_token=","")}if(!k)return{};var F=k.driveId;return O&&F?{isAvailable:!0,itemSubscriber:r.createElement(B,{spPageContextKey:a,driveUrl:N,isTAB:T,listFullUrl:u,endpoint:O,driveAccessToken:x,webAbsoluteUrl:s,pageContext:f,itemsScopeItemKey:D})}:{}}return{isAvailable:!0,itemSubscriber:r.createElement(H,{spPageContextKey:a,isTAB:T,itemKey:n,listFullUrl:u,webAbsoluteUrl:s,listId:v.id,pageContext:f,driveUrl:N,itemsScopeItemKey:D})}}}})});
define("eze",["require","exports","lC","Xo","Rs","Vm","Oh","be","tS","ZVe","JA","E","QVe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={ODB:819,ODC:"EnablePushChannelLogging"},d={ODB:459},v=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new o.default;var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:f.NotificationSource.WebhookSubscription},function(){t._log("PushChannelMessageSource",f.NotificationSource.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:f.NotificationSource.EventHub},function(){t._log("PushChannelMessageSource",f.NotificationSource.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?a.getUrlParts(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:f.NotificationSource.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i=this;return n.__generator(this,function(n){switch(n.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if("latest"!==this._syncToken)return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);return[4,this._getChangeMessages()];case 2:n.sent();return[3,4];case 3:t=n.sent();this._getChangesAttempts++;if(this._getChangesAttempts>10)return[2];r=!1;if(l.isGraphError(t))switch(t.status){case 404:case 410:r=!0;this._syncToken="latest"}r&&this._async&&this._async.setTimeout(function(){return i._onPushChannelConnection(i._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts));return[2];case 4:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var r=105001*Math.random()+15e3,i=Date.parse(t.expirationDateTime),s=Date.now(),o=i-s-r;if(o<12e4){if(u.default.isFeatureEnabled(d)){var a={refreshDelay:o,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:i,dateTimeNow:s,recreateBufferRandom:r};new c.default({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:a}).end({resultType:c.ResultTypeEnum.Failure,extraData:a})}o=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},o)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,o,u,a,f,l,c,p,d;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);e=new s.ItemResolver;return[4,this._getChangeMessages()];case 1:t=n.sent();this._log("Change messages",t);o=this._processMessages(t.messages);this._log("Changes",o);e.merge(t.itemResolver);for(u=0,a=o;u<a.length;u++)switch((f=a[u]).type){case h.ItemAutoRefreshChangeType.New:e.invalidateItems({items:(c={},c[f.invalidateKey]=[r.defaultChildItemSetFacet],c)});break;case h.ItemAutoRefreshChangeType.Update:f.hasSelection&&this._itemScopeItemKey?this._updateItems(f.invalidateKey):e.invalidateItems({items:(p={},p[f.invalidateKey]=[f.invalidateFacet],p)});break;case h.ItemAutoRefreshChangeType.Delete:e.invalidateItems({items:(d={},d[f.invalidateKey]=[i.deletedFacet],d)})}this._dispatch(e.execute());return[3,3];case 2:l=n.sent();this._log("onNotification error",l);return[3,3];case 3:return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];u.default.isFeatureEnabled(p)&&console.log.apply(console,n.__spreadArrays(["ItemAutoRefreshHelper"],e))};return e})();t.default=v});
define("ZVe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.WebhookSubscription=0]="WebhookSubscription";e[e.Meta=1]="Meta";e[e.EventHub=2]="EventHub"})(t.NotificationSource||(t.NotificationSource={}));(function(e){e[e.Zip=0]="Zip"})(t.NotificationScenario||(t.NotificationScenario={}))});
define("QVe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(t.ItemAutoRefreshChangeType||(t.ItemAutoRefreshChangeType={}))});
define("$Ve",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._dataRequestor=t.dataRequestor;this._listId=e.listId;this._webAbsoluteUrl=e.webAbsoluteUrl}e.prototype.getSocketIoSubscription=function(e){var t,n;if(this._listId&&this._webAbsoluteUrl){t=this._webAbsoluteUrl+"/_api/v2.0/sites/root/lists/"+this._listId;n=!1}else{if(!e.sessionToken)throw new Error("Invalid session token");t="/drive/root";n=!0}return this._dataRequestor.send({path:t+"/subscriptions/socketIo",apiName:"GetSocketIo",requestType:"GET",accessToken:e.sessionToken,useAuthorizationHeaders:n}).then(function(e){return e})};return e})();t.default=n});
define("JVe",["require","exports","lC","Oh","be","E","ZVe","JA","XVe","ce"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={ODB:819,ODC:"EnablePushChannelLogging"},c={ODB:459},h={ODB:!f.Killswitch.isActivated("390e1b6a-fe67-475a-a86e-07591cb0ebd5","04/01/2020","Log qos event for pushChannelService.Connect")},p={ODB:!f.Killswitch.isActivated("5eb8f962-4820-466c-a208-16534edec621","05/27/2020","Only use websockets when connecting to pushv2")},d=["Due to organizational policies, you can't access these resources from this network location","One of the provided arguments is not acceptable","Session has been revoked","The access token has expired","The caller does not have permission to perform the action","The caller is not authenticated","The request is malformed or incorrect","There has been an error authenticating the request"],v=(function(){function e(e,t){this._firedConnectQoSEvent=!1;this._getSubscriptionAttempts=0;this._socketIoReconnectAttempts=0;this._notificationHandlers={};this._connectionHandlers={};this._disableWebSockets=e.disableWebSockets;this._subscriptionService=t.subscriptionService;this._sessionTokenFetcher=t.sessionTokenFetcher;this._async=new r.default;this._socketIoReconnectAttempts=0}e.prototype.isConnected=function(){return!!this._socketIo&&this._socketIo.connected};e.prototype.getSocketIoSubscription=function(){return this._subscription};e.prototype.addConnectionHandler=function(e,t){this._connectionHandlers[e]=t};e.prototype.removeConnectionHandler=function(e){delete this._connectionHandlers[e]};e.prototype.setupNotificationHandler=function(e,t){var n=e.source,r=e.scenarios,i=e.id,s=void 0===i?"":i,u=o.NotificationSource[n];if(u){if(r&&r.length)for(var a=0,f=r;a<f.length;a++){var l=f[a];this._notificationHandlers[u.toLowerCase()+o.NotificationScenario[l].toLowerCase()+s]=t}else this._notificationHandlers[u.toLowerCase()+s]=t;return!0}return!1};e.prototype.connect=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,u,f,l,c=this;return n.__generator(this,function(d){switch(d.label){case 0:this.disconnect();if(void 0!==e)return[3,2];r=this;return[4,this._getSubscription("PushChannelService.Connect")];case 1:r._subscription=d.sent();return[3,3];case 2:this._subscription=e;d.label=3;case 3:this._log("Connecting to subscription",this._subscription);if(void 0===this._subscription){this._log("Invalid subscription");return[2,!1]}if(!this._firedConnectQoSEvent||i.default.isFeatureEnabled(h)){this._firedConnectQoSEvent=!0;u=new s.default({name:"PushChannelService.Connect",extraData:n.__assign({notificationUrl:this._subscription.notificationUrl},t||{})})}f={reconnectionAttempts:20};i.default.isFeatureEnabled(p)&&-1!==this._subscription.notificationUrl.indexOf("pushn")?f.transports=["websocket"]:this._disableWebSockets&&(f.transports=["polling"]);l=this._socketIo=a.connect(this._subscription.notificationUrl,f);this._socketIo.on("connect",function(){if(l===c._socketIo){c._log("Connected");u&&u.end({resultType:s.ResultTypeEnum.Success,extraData:n.__assign({notificationUrl:c._subscription.notificationUrl},t||{})});c._executeConnectionHandlers(!0)}else l.disconnect()});this._socketIo.on("disconnect",function(){if(l===c._socketIo){c._log("Disconnected");c._executeConnectionHandlers(!1)}});this._socketIo.on("reconnect_failed",function(){c._log("Reconnect failed");u&&u.end({resultType:s.ResultTypeEnum.Failure,extraData:n.__assign({notificationUrl:c._subscription.notificationUrl},t||{})});c._subscription=void 0;c._socketIoReconnectAttempts++;c._socketIoReconnectAttempts>3?c._log("Exceeded max reconnect attempts"):c._async.setTimeout(function(){c.connect(void 0,{methodInvoker:"reconnect_failed"})},0)});this._socketIo.on("notification",function(e){c._log("Notification",e);var t;try{t=JSON.parse(e)}catch(e){return}var n=t.source,r=t.scenario?t.scenario.toLowerCase():"";n||(n=o.NotificationSource[o.NotificationSource.WebhookSubscription]);n=n.toLowerCase();var i=!1;i=c._handleMessage(t,n);var s=n+r;for(var u in c._notificationHandlers)-1!==u.indexOf(s)&&u!==n&&(i=c._handleMessage(t,u,s)||i);i||c._log("Notification - missing handler for message")});return[2,!0]}})})};e.prototype.disconnect=function(){if(this._socketIo){this._socketIo.disconnect();this._socketIo=void 0}if(this._async){this._async.dispose();this._async=new r.default}this._subscription=void 0};e.prototype.refreshSubscription=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._getSubscription("PushChannelService.refreshSubscription")];case 1:if(void 0===(e=t.sent()))return[2,void 0];if(this.isConnected()&&this._subscription&&this._subscription.notificationUrl!==e.notificationUrl){this._log("Notification url changed. Reconnecting...");this.connect(e,{methodInvoker:"PushChannelService.refreshSubscription"});return[2,!1]}this._subscription=e;return[2,!0]}})})};e.prototype._getSubscription=function(e){void 0===e&&(e="unknown");return n.__awaiter(this,void 0,void 0,function(){var t,r,o,a,f,l,h,p,v=this;return n.__generator(this,function(n){switch(n.label){case 0:r=void 0;i.default.isFeatureEnabled(c)&&(r=new s.default({name:"PushChannelService.getSubscription",extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}}));n.label=1;case 1:n.trys.push([1,6,,7]);a=(o=this._subscriptionService).getSocketIoSubscription;f={};return this._sessionTokenFetcher?[4,this._sessionTokenFetcher()]:[3,3];case 2:l=n.sent();return[3,4];case 3:l=void 0;n.label=4;case 4:return[4,a.apply(o,[(f.sessionToken=l,f.existingSubscription=this._subscription,f)])];case 5:t=n.sent();r&&r.end({resultType:s.ResultTypeEnum.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});return[3,7];case 6:h=n.sent();this._log("Failed to get socketIo subscription",h);p=!1;u.isGraphError(h)&&(403===h.status?p=!0:h.error&&h.error.message&&(p=d.some(function(e){return 0===h.error.message.indexOf(e)})));r&&r.end({resultType:s.ResultTypeEnum.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});if(p)return[2,void 0];this._getSubscriptionAttempts++;return this._getSubscriptionAttempts>10?[2,void 0]:[2,new Promise(function(e){var t=500*Math.pow(2,v._getSubscriptionAttempts);v._log("Retrying in "+t+" milliseconds");v._async.setTimeout(function(){return e(v._getSubscription("Retry_getSubscription"))},t)})];case 7:return[2,t]}})})};e.prototype._handleMessage=function(e,t,n){void 0===n&&(n=t);var r=this._notificationHandlers[t];if(r){r(e.payload?e.payload:e.value);return!0}return!1};e.prototype._executeConnectionHandlers=function(e){for(var t=0,n=Object.keys(this._connectionHandlers);t<n.length;t++){var r=n[t];this._connectionHandlers[r](e)}};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.default.isFeatureEnabled(l)&&console.log.apply(console,n.__spreadArrays(["PushChannelService"],e))};return e})();t.default=v});
/*!
 * Socket.IO v2.3.0
 * (c) 2014-2019 Guillermo Rauch
 * Released under the MIT License.
 */
!(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("XVe",[],t):"object"==typeof exports?exports.io=t():e.io=t()})(this,function(){return(function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)})([function(e,t,n){function r(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r=i(e),s=r.source,f=r.id,l=r.path,c=a[f]&&l in a[f].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||c?(u("ignoring socket cache for %s",s),n=o(s,t)):(a[f]||(u("new io instance for %s",s),a[f]=o(s,t)),n=a[f]),r.query&&!t.query&&(t.query=r.query),n.socket(r.path,t)}var i=n(1),s=n(7),o=n(15),u=n(3)("socket.io-client");e.exports=t=r;var a=t.managers={};t.protocol=s.protocol,t.connect=r,t.Manager=n(15),t.Socket=n(39)},function(e,t,n){var r=n(2),i=n(3)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port,n.href=n.protocol+"://"+s+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),s=e.indexOf("]");-1!=i&&-1!=s&&(e=e.substring(0,i)+e.substring(i,s).replace(/:/g,";")+e.substring(s,e.length));for(var o=n.exec(e||""),u={},a=14;a--;)u[r[a]]=o[a]||"";return-1!=i&&-1!=s&&(u.source=t,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u}},function(e,t,n){(function(r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))}),t.splice(i,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e=void 0;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=(function(){try{return localStorage}catch(e){}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(5)(t);e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(t,n(4))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function s(){d&&h&&(d=!1,h.length?p=h.concat(p):v=-1,p.length&&o())}function o(){if(!d){var e=i(s);d=!0;for(var t=p.length;t;){for(h=p,p=[];++v<t;)h&&h[v].run();v=-1,t=p.length}h=null,d=!1,(function(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}})(e)}}function u(e,t){this.fun=e,this.array=t}function a(){}var f,l,c=e.exports={};!(function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}})();var h,p=[],d=!1,v=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new u(e,t)),1!==p.length||d||i(o)},u.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=a,c.addListener=a,c.once=a,c.off=a,c.removeListener=a,c.removeAllListeners=a,c.emit=a,c.prependListener=a,c.prependOnceListener=a,c.listeners=function(e){return[]},c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return i.colors[Math.abs(t)%i.colors.length]}function i(e){function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];if(n.enabled){var o=n,u=Number(new Date),a=u-(r||u);o.diff=a,o.prev=r,o.curr=u,r=u,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var f=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;f++;var r=i.formatters[n];if("function"==typeof r){var s=t[f];e=r.call(o,s),t.splice(f,1),f--}return e}),i.formatArgs.call(o,t);var l=o.log||i.log;l.apply(o,t)}}var r=void 0;return n.namespace=e,n.enabled=i.enabled(e),n.useColors=i.useColors(),n.color=t(e),n.destroy=s,n.extend=o,"function"==typeof i.init&&i.init(n),i.instances.push(n),n}function s(){var e=i.instances.indexOf(this);return-1!==e&&(i.instances.splice(e,1),!0)}function o(e,t){var n=i(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function u(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(e){return e instanceof Error?e.stack||e.message:e},i.disable=function(){var e=[].concat(r(i.names.map(u)),r(i.skips.map(u).map(function(e){return"-"+e}))).join(",");return i.enable(""),e},i.enable=function(e){i.save(e),i.names=[],i.skips=[];var t=void 0,n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$")));for(t=0;t<i.instances.length;t++){var s=i.instances[t];s.enabled=i.enabled(s.namespace)}},i.enabled=function(e){if("*"===e[e.length-1])return!0;var t=void 0,n=void 0;for(t=0,n=i.skips.length;t<n;t++)if(i.skips[t].test(e))return!1;for(t=0,n=i.names.length;t<n;t++)if(i.names[t].test(e))return!0;return!1},i.humanize=n(6),Object.keys(e).forEach(function(t){i[t]=e[t]}),i.instances=[],i.names=[],i.skips=[],i.formatters={},i.selectColor=t,i.enable(i.load()),i}},function(e,t){function n(e){var t=Math.abs(e);return t>=u?r(e,t,u,"day"):t>=o?r(e,t,o,"hour"):t>=s?r(e,t,s,"minute"):t>=i?r(e,t,i,"second"):e+" ms"}function r(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}var i=1e3,s=60*i,o=60*s,u=24*o,a=7*u,f=365.25*u;e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return(function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*f;case"weeks":case"week":case"w":return n*a;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}})(e);if("number"===r&&isFinite(e))return t.long?n(e):(function(e){var t=Math.abs(e);return t>=u?Math.round(e/u)+"d":t>=o?Math.round(e/o)+"h":t>=s?Math.round(e/s)+"m":t>=i?Math.round(e/i)+"s":e+"ms"})(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(){}function i(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var r=(function(e){try{return JSON.stringify(e)}catch(e){return!1}})(e.data);if(!1===r)return d;n+=r}return f("encoded %j as %s",e,n),n}function s(){this.reconstructor=null}function o(e){var n=0,r={type:Number(e.charAt(0))};if(null==t.types[r.type])return a("unknown packet type "+r.type);if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var i="";"-"!==e.charAt(++n)&&(i+=e.charAt(n),n!=e.length););if(i!=Number(i)||"-"!==e.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(n+1))for(r.nsp="";++n;){if(","===(o=e.charAt(n)))break;if(r.nsp+=o,n===e.length)break}else r.nsp="/";var s=e.charAt(n+1);if(""!==s&&Number(s)==s){for(r.id="";++n;){var o;if(null==(o=e.charAt(n))||Number(o)!=o){--n;break}if(r.id+=e.charAt(n),n===e.length)break}r.id=Number(r.id)}if(e.charAt(++n)){var u=(function(e){try{return JSON.parse(e)}catch(e){return!1}})(e.substr(n));if(!(!1!==u&&(r.type===t.ERROR||h(u))))return a("invalid payload");r.data=u}return f("decoded %s as %j",e,r),r}function u(e){this.reconPack=e,this.buffers=[]}function a(e){return{type:t.ERROR,data:"parser error: "+e}}var f=n(8)("socket.io-parser"),l=n(11),c=n(12),h=n(13),p=n(14);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=s;var d=t.ERROR+'"encode error"';r.prototype.encode=function(e,n){if(f("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)(function(e,t){c.removeBlobs(e,function(e){var n=c.deconstructPacket(e),r=i(n.packet),s=n.buffers;s.unshift(r),t(s)})})(e,n);else{n([i(e)])}},l(s.prototype),s.prototype.add=function(e){var n;if("string"==typeof e)n=o(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new u(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!p(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},u.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=c.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){(function(r){"use strict";function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(t=e.exports=n(9)).log=function(){return"object"===("undefined"==typeof console?"undefined":s(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(s=i))}),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:(function(){try{return window.localStorage}catch(e){}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(t,n(4))},function(e,t,n){"use strict";function r(e){function n(){if(n.enabled){var e=n,i=+new Date,s=i-(r||i);e.diff=s,e.prev=r,e.curr=i,r=i;for(var o=new Array(arguments.length),u=0;u<o.length;u++)o[u]=arguments[u];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;a++;var i=t.formatters[r];if("function"==typeof i){var s=o[a];n=i.call(e,s),o.splice(a,1),a--}return n}),t.formatArgs.call(e,o);var f=n.log||t.log||console.log.bind(console);f.apply(e,o)}}var r;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=(function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]})(e),n.destroy=i,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(10),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){return r(e,u,"day")||r(e,o,"hour")||r(e,s,"minute")||r(e,i,"second")||e+" ms"}function r(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var i=1e3,s=60*i,o=60*s,u=24*o,a=365.25*u;e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return(function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*a;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}})(e);if("number"===r&&!1===isNaN(e))return t.long?n(e):(function(e){return e>=u?Math.round(e/u)+"d":e>=o?Math.round(e/o)+"h":e>=s?Math.round(e/s)+"m":e>=i?Math.round(e/i)+"s":e+"ms"})(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(e){if(e)return(function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e})(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var r=n(13),i=n(14),s=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),u="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,s=e;return s.data=(function e(t,n){if(!t)return t;if(i(t)){var s={_placeholder:!0,num:n.length};return n.push(t),s}if(r(t)){for(var o=new Array(t.length),u=0;u<t.length;u++)o[u]=e(t[u],n);return o}if("object"==typeof t&&!(t instanceof Date)){o={};for(var a in t)o[a]=e(t[a],n);return o}return t})(n,t),s.attachments=t.length,{packet:s,buffers:t}},t.reconstructPacket=function(e,t){return e.data=(function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],n);else if("object"==typeof t)for(var s in t)t[s]=e(t[s],n);return t})(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,s=e;(function e(a,f,l){if(!a)return a;if(o&&a instanceof Blob||u&&a instanceof File){n++;var c=new FileReader;c.onload=function(){l?l[f]=this.result:s=this.result,--n||t(s)},c.readAsArrayBuffer(a)}else if(r(a))for(var h=0;h<a.length;h++)e(a[h],h,a);else if("object"==typeof a&&!i(a))for(var p in a)e(a[p],p,a)})(s),n||t(s)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e){return n&&Buffer.isBuffer(e)||r&&(e instanceof ArrayBuffer||i(e))};var n="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,r="function"==typeof ArrayBuffer,i=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,n){function r(e,t){if(!(this instanceof r))return new r(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||u;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var i=n(16),s=n(39),o=n(11),u=n(7),a=n(41),f=n(42),l=n(3)("socket.io-client:manager"),c=n(38),h=n(43),p=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},r.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},o(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e,t){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var s=a(n,"open",function(){r.onopen(),e&&e()}),o=a(n,"error",function(t){if(l("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var u=this._timeout;l("connect attempt will timeout after %d",u);var f=setTimeout(function(){l("connect attempt timed out after %d",u),s.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",u)},u);this.subs.push({destroy:function(){clearTimeout(f)}})}return this.subs.push(s),this.subs.push(o),this},r.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",f(this,"ondata"))),this.subs.push(a(e,"ping",f(this,"onping"))),this.subs.push(a(e,"pong",f(this,"onpong"))),this.subs.push(a(e,"error",f(this,"onerror"))),this.subs.push(a(e,"close",f(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",f(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},r.prototype.socket=function(e,t){function n(){~c(i.connecting,r)||i.connecting.push(r)}var r=this.nsps[e];if(!r){r=new s(this,e,t),this.nsps[e]=r;var i=this;r.on("connecting",n),r.on("connect",function(){r.id=i.generateId(e)}),this.autoConnect&&n()}return r},r.prototype.destroy=function(e){var t=c(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){l("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){l("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(17),e.exports.parser=n(24)},function(e,t,n){function r(e,t){return this instanceof r?(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=f(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=f(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=l.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new r(e,t)}var i=n(18),s=n(11),o=n(3)("engine.io-client:socket"),u=n(38),a=n(24),f=n(2),l=n(32);e.exports=r,r.priorWebsocketSuccess=!1,s(r.prototype),r.protocol=a.protocol,r.Socket=r,r.Transport=n(23),r.transports=n(18),r.parser=n(24),r.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=(function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t})(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};this.id&&(t.sid=this.id);return new i[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(h.onlyBinaryUpgrades){var t=!this.supportsBinary&&h.transport.supportsBinary;c=c||t}c||(o('probe transport "%s" opened',e),l.send([{type:"ping",data:"probe"}]),l.once("packet",function(t){if(!c)if("pong"===t.type&&"probe"===t.data){if(o('probe transport "%s" pong',e),h.upgrading=!0,h.emit("upgrading",l),!l)return;r.priorWebsocketSuccess="websocket"===l.name,o('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){c||"closed"!==h.readyState&&(o("changing transport and sending upgrade packet"),f(),h.setTransport(l),l.send([{type:"upgrade"}]),h.emit("upgrade",l),l=null,h.upgrading=!1,h.flush())})}else{o('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=l.name,h.emit("upgradeError",n)}}))}function n(){c||(c=!0,f(),l.close(),l=null)}function i(t){var r=new Error("probe error: "+t);r.transport=l.name,n(),o('probe transport "%s" failed because of error: %s',e,t),h.emit("upgradeError",r)}function s(){i("transport closed")}function u(){i("socket closed")}function a(e){l&&e.name!==l.name&&(o('"%s" works - aborting "%s"',e.name,l.name),n())}function f(){l.removeListener("open",t),l.removeListener("error",i),l.removeListener("close",s),h.removeListener("close",u),h.removeListener("upgrading",a)}o('probing transport "%s"',e);var l=this.createTransport(e,{probe:1}),c=!1,h=this;r.priorWebsocketSuccess=!1,l.once("open",t),l.once("error",i),l.once("close",s),this.once("close",u),this.once("upgrading",a),l.open()},r.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),o("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){o("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~u(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t,n){var r=n(19),i=n(21),s=n(35),o=n(36);t.polling=function(e){var t=!1,n=!1,o=!1!==e.jsonp;if("undefined"!=typeof location){var u="https:"===location.protocol,a=location.port;a||(a=u?443:80),t=e.hostname!==location.hostname||a!==e.port,n=e.secure!==u}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new i(e);if(!o)throw new Error("JSONP disabled");return new s(e)},t.websocket=o},function(e,t,n){var r=n(20);e.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){function r(){}function i(e){if(a.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function s(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function o(){for(var e in s.requests)s.requests.hasOwnProperty(e)&&s.requests[e].abort()}var u=n(19),a=n(22),f=n(11),l=n(33),c=n(3)("engine.io-client:polling-xhr");if(e.exports=i,e.exports.Request=s,l(i,a),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new s(e)},i.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},i.prototype.doPoll=function(){c("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},f(s.prototype),s.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new u(e),n=this;try{c("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(var r in this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError("number"==typeof t.status?t.status:0)},0))},c("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=s.requestsCount++,s.requests[this.index]=this)},s.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},s.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},s.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},s.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete s.requests[this.index],this.xhr=null}},s.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},s.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},s.prototype.abort=function(){this.cleanup()},s.requestsCount=0,s.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",o);else if("function"==typeof addEventListener){var h="onpagehide"in self?"pagehide":"unload";addEventListener(h,o,!1)}},function(e,t,n){function r(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=n(23),s=n(32),o=n(24),u=n(33),a=n(34),f=n(3)("engine.io-client:polling");e.exports=r;var l=null!=new(n(19))({xdomain:!1}).responseType;u(r,i),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){f("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(f("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){f("pre-pause polling complete"),--r||t()})),this.writable||(f("we are currently writing - waiting to pause"),r++,this.once("drain",function(){f("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){f("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;f("polling got data %s",e);o.decodePayload(e,this.socket.binaryType,function(e,n,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():f('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){f("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(f("transport open - closing"),e()):(f("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=s.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e);return t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var i=n(24),s=n(11);e.exports=r,s(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){function r(e,n){return n("b"+t.packets[e.type]+e.data.data)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,s=new Uint8Array(i),o=new Uint8Array(1+i.byteLength);o[0]=m[e.type];for(var u=0;u<s.length;u++)o[u+1]=s[u];return r(o.buffer)}function s(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(v)return(function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){t.encodePacket({type:e.type,data:i.result},n,!0,r)},i.readAsArrayBuffer(e.data)})(e,n,r);var i=new Uint8Array(1);i[0]=m[e.type];return r(new b([i.buffer,e.data]))}function o(e,t,n){for(var r=new Array(e.length),i=c(e.length,n),s=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},o=0;o<e.length;o++)s(o,e[o],i)}var u,a=n(25),f=n(26),l=n(27),c=n(28),h=n(29);"undefined"!=typeof ArrayBuffer&&(u=n(30));var p="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),d="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),v=p||d;t.protocol=3;var m=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},g=a(m),y={type:"error",data:"parser error"},b=n(31);t.encodePacket=function(e,t,n,o){"function"==typeof t&&(o=t,t=!1),"function"==typeof n&&(o=n,n=null);var u=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&u instanceof ArrayBuffer)return i(e,t,o);if(void 0!==b&&u instanceof b)return s(e,t,o);if(u&&u.base64)return r(e,o);var a=m[e.type];return void 0!==e.data&&(a+=n?h.encode(String(e.data),{strict:!1}):String(e.data)),o(""+a)},t.encodeBase64Packet=function(e,n){var r,i="b"+t.packets[e.type];if(void 0!==b&&e.data instanceof b){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];n(i+e)},s.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var o=new Uint8Array(e.data),u=new Array(o.length),a=0;a<o.length;a++)u[a]=o[a];r=String.fromCharCode.apply(null,u)}return i+=btoa(r),n(i)},t.decodePacket=function(e,n,r){if(void 0===e)return y;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=(function(e){try{e=h.decode(e,{strict:!1})}catch(e){return!1}return e})(e)))return y;var i=e.charAt(0);return Number(i)==i&&g[i]?e.length>1?{type:g[i],data:e.substring(1)}:{type:g[i]}:y}i=new Uint8Array(e)[0];var s=l(e,1);return b&&"blob"===n&&(s=new b([s])),{type:g[i],data:s}},t.decodeBase64Packet=function(e,t){var n=g[e.charAt(0)];if(!u)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=u.decode(e.substr(1));return"blob"===t&&b&&(r=new b([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var i=f(e);return n&&i?b&&!v?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void o(e,function(e,r){t.encodePacket(e,!!i&&n,!1,function(e){r(null,(function(e){return e.length+":"+e})(e))})},function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);"function"==typeof n&&(r=n,n=null);var i;if(""===e)return r(y,0,1);for(var s,o,u="",a=0,f=e.length;a<f;a++){var l=e.charAt(a);if(":"===l){if(""===u||u!=(s=Number(u)))return r(y,0,1);if(u!=(o=e.substr(a+1,s)).length)return r(y,0,1);if(o.length){if(i=t.decodePacket(o,n,!1),y.type===i.type&&y.data===i.data)return r(y,0,1);if(!1===r(i,a+s,f))return}a+=s,u=""}else u+=l}return""!==u?r(y,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){return e.length?void o(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var r=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),i=new Uint8Array(r),s=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);n=r.buffer}i[s++]=t?0:1;var u=n.byteLength.toString();for(o=0;o<u.length;o++)i[s++]=parseInt(u[o]);i[s++]=255;for(r=new Uint8Array(n),o=0;o<r.length;o++)i[s++]=r[o]}),n(i.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){o(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}var s=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(s.length+1);for(i=0;i<s.length;i++)o[i]=parseInt(s[i]);if(o[s.length]=255,b){var u=new b([t.buffer,o.buffer,e]);n(null,u)}})},function(e,t){return n(new b(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,s=[];i.byteLength>0;){for(var o=new Uint8Array(i),u=0===o[0],a="",f=1;255!==o[f];f++){if(a.length>310)return r(y,0,1);a+=o[f]}i=l(i,2+a.length),a=parseInt(a);var c=l(i,0,a);if(u)try{c=String.fromCharCode.apply(null,new Uint8Array(c))}catch(e){var h=new Uint8Array(c);c="";for(f=0;f<h.length;f++)c+=String.fromCharCode(h[f])}s.push(c),i=l(i,a)}var p=s.length;s.forEach(function(e,i){r(t.decodePacket(e,n,!0),i,p)})}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t,n){var r=n(13),i=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),o="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(r(t)){for(var n=0,i=t.length;n<i;n++)if(e(t[n]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||s&&t instanceof Blob||o&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)&&e(t[u]))return!0;return!1}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),s=new Uint8Array(n-t),o=t,u=0;o<n;o++,u++)s[u]=i[o];return s.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){function i(e,n){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(s=!0,t(e),t=r):0!==i.count||s||t(null,n)}var s=!1;return r=r||n,i.count=e,0===e?t():i}},function(e,t){function n(e){for(var t,n,r=[],i=0,s=e.length;i<s;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<s?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function r(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function i(e,t){return c(e>>t&63|128)}function s(e,t){if(0==(4294967168&e))return c(e);var n="";return 0==(4294965248&e)?n=c(e>>6&31|192):0==(4294901760&e)?(r(e,t)||(e=65533),n=c(e>>12&15|224),n+=i(e,6)):0==(4292870144&e)&&(n=c(e>>18&7|240),n+=i(e,12),n+=i(e,6)),n+c(63&e|128)}function o(){if(l>=f)throw Error("Invalid byte index");var e=255&a[l];if(l++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(e){var t,n;if(l>f)throw Error("Invalid byte index");if(l==f)return!1;if(t=255&a[l],l++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|o())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|o()<<6|o())>=2048)return r(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&((n=(7&t)<<18|o()<<12|o()<<6|o())>=65536&&n<=1114111))return n;throw Error("Invalid UTF-8 detected")}/*! https://mths.be/utf8js v2.1.2 by @mathias */
var a,f,l,c=String.fromCharCode;e.exports={version:"2.1.2",encode:function(e,t){for(var r=!1!==(t=t||{}).strict,i=n(e),o=i.length,u=-1,a="";++u<o;)a+=s(i[u],r);return a},decode:function(e,t){var r=!1!==(t=t||{}).strict;a=n(e),f=a.length,l=0;for(var i,s=[];!1!==(i=u(r));)s.push(i);return(function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=c((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=c(t);return i})(s)}}},function(e,t){!(function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,s="";for(n=0;n<i;n+=3)s+=e[r[n]>>2],s+=e[(3&r[n])<<4|r[n+1]>>4],s+=e[(15&r[n+1])<<2|r[n+2]>>6],s+=e[63&r[n+2]];return i%3==2?s=s.substring(0,s.length-1)+"=":i%3==1&&(s=s.substring(0,s.length-2)+"=="),s},t.decode=function(e){var t,r,i,s,o,u=.75*e.length,a=e.length,f=0;"="===e[e.length-1]&&(u--,"="===e[e.length-2]&&u--);var l=new ArrayBuffer(u),c=new Uint8Array(l);for(t=0;t<a;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],s=n[e.charCodeAt(t+2)],o=n[e.charCodeAt(t+3)],c[f++]=r<<2|i>>4,c[f++]=(15&i)<<4|s>>2,c[f++]=(3&s)<<6|63&o;return l}})()},function(e,t){function n(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function r(e,t){t=t||{};var r=new s;return n(e).forEach(function(e){r.append(e)}),t.type?r.getBlob(t.type):r.getBlob()}function i(e,t){return new Blob(n(e),t||{})}var s=void 0!==s?s:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,o=(function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}})(),u=o&&(function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}})(),a=s&&s.prototype.append&&s.prototype.getBlob;"undefined"!=typeof Blob&&(r.prototype=Blob.prototype,i.prototype=Blob.prototype),e.exports=o?u?Blob:i:a?r:void 0},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var s=n[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function n(e){var t="";do{t=s[e%o]+t,e=Math.floor(e/o)}while(e>0);return t}function r(){var e=n(+new Date);return e!==i?(a=0,i=e):e+"."+n(a++)}for(var i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,u={},a=0,f=0;f<o;f++)u[s[f]]=f;r.encode=n,r.decode=function(e){var t=0;for(f=0;f<e.length;f++)t=t*o+u[e.charAt(f)];return t},e.exports=r},function(e,t,n){(function(t){function r(){}function i(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function s(e){if(o.call(this,e),this.query=this.query||{},!a){var t=i();a=t.___eio=t.___eio||[]}this.index=a.length;var n=this;a.push(function(e){n.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var o=n(22),u=n(33);e.exports=s;var a,f=/\n/g,l=/\\n/g;u(s,o),s.prototype.supportsBinary=!1,s.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},s.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},s.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+i.iframeId+'">';s=document.createElement(e)}catch(e){(s=document.createElement("iframe")).name=i.iframeId,s.src="javascript:0"}s.id=i.iframeId,i.form.appendChild(s),i.iframe=s}var i=this;if(!this.form){var s,o=document.createElement("form"),u=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=a,o.method="POST",o.setAttribute("accept-charset","utf-8"),u.name="d",o.appendChild(u),document.body.appendChild(o),this.form=o,this.area=u}this.form.action=this.uri(),r(),e=e.replace(l,"\\\n"),this.area.value=e.replace(f,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,(function(){return this})())},function(e,t,n){function r(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=i&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=s),o.call(this,e)}var i,s,o=n(23),u=n(24),a=n(32),f=n(33),l=n(34),c=n(3)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?i=WebSocket:"undefined"!=typeof self&&(i=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{s=n(37)}catch(e){}var h=i||s;e.exports=r,f(r,o),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new h(e,t):new h(e):new h(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},r.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,i=n;r<i;r++)!(function(e){u.encodePacket(e,t.supportsBinary,function(r){if(!t.usingBrowserWebSocket){var i={};if(e.options&&(i.compress=e.options.compress),t.perMessageDeflate){("string"==typeof r?Buffer.byteLength(r):r.length)<t.perMessageDeflate.threshold&&(i.compress=!1)}}try{t.usingBrowserWebSocket?t.ws.send(r):t.ws.send(r,i)}catch(e){c("websocket closed before onclose event")}--n||(t.emit("flush"),setTimeout(function(){t.writable=!0,t.emit("drain")},0))})})(e[r])},r.prototype.onClose=function(){o.prototype.onClose.call(this)},r.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=l()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e);return t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===r.prototype.name)}},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,n){function r(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var i=n(7),s=n(11),o=n(40),u=n(41),a=n(42),f=n(3)("socket.io-client:socket"),l=n(32),c=n(26);e.exports=r;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=s.prototype.emit;s(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[u(e,"open",a(this,"onopen")),u(e,"packet",a(this,"onpacket")),u(e,"close",a(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},r.prototype.send=function(){var e=o(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(h.hasOwnProperty(e))return p.apply(this,arguments),this;var t=o(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:c(t))?i.BINARY_EVENT:i.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(f("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){if(f("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?l.encode(this.query):this.query;f("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},r.prototype.onclose=function(e){f("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===i.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];f("emitting event %j",t),null!=e.id&&(f("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=o(arguments);f("sending ack %j",r),t.packet({type:c(r)?i.BINARY_ACK:i.ACK,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(f("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):f("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){f("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(f("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags.compress=e,this},r.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])});
define("YVe",["require","exports","lC","xo","rs","Rs","Vm","Io","QVe","ph","eS","ri","E2","g6","v7","li","xv","qA","ii","ce","v"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t,n,r,s,o,u,a,f,l,c=this,h=e(i.readItems(function(e){return{spItem:e.demandItemFacet(v.spItemKeyFacet,c._rootItemKey)}})).spItem;if((null===(t=h)||void 0===t?void 0:t.webAbsoluteUrl)&&h.listFullUrl){var p=v.spListKeyFacet.serialize({webAbsoluteUrl:null===(n=h)||void 0===n?void 0:n.webAbsoluteUrl,listFullUrl:null===(r=h)||void 0===r?void 0:r.listFullUrl}),d=e(i.readItems(function(e){return e.demandItemFacet(y.listSubscriptionFacet,p)}));if((null===(s=d)||void 0===s?void 0:s.notificationUrl)&&(null===(o=d)||void 0===o?void 0:o.expirationDateTime)&&(null===(u=d)||void 0===u?void 0:u.subscribeID))return{notificationUrl:null===(a=d)||void 0===a?void 0:a.notificationUrl,expirationDateTime:null===(f=d)||void 0===f?void 0:f.expirationDateTime,id:null===(l=d)||void 0===l?void 0:l.subscribeID}}};e.prototype.getChangeMessages=function(e,t,s){var a;return n.__awaiter(this,void 0,void 0,function(){var E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z=this;return n.__generator(this,function(n){switch(n.label){case 0:if(void 0===s||void 0===s.endpoint||void 0===s.driveId)throw"Invalid drive url parts";E=s.endpoint+"/drives/"+s.driveId;S=e(u.readConfiguration({isTAB:c.isTestMode})).isTAB;x=e(i.readItems(function(e){var t=e.demandItemFacet(v.spItemKeyFacet,Z._rootItemKey);return{spItem:t,pageContext:t&&e.demandItemFacet(y.spPageContextFacet,v.spPageContextKeyFacet.serialize(t)),clientTimeStampEnabled:p.isFeatureEnabled(e,{feature:{ODB:1844}})}})),T=x.spItem,N=x.pageContext,C=x.clientTimeStampEnabled;k=new o.ItemResolver;if(C&&"latest"===t&&T){L=v.spListKeyFacet.serialize({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:T.listFullUrl});A=e(i.readItems(function(e){return e.demandItemFacet(y.listFacet,L)}));if(O=null===(a=A)||void 0===a?void 0:a.tick){M=O-621355968e9;M/=1e4;return[2,{syncToken:""+new Date(M).toISOString(),messages:[],itemResolver:k}]}}if(!N||!b.getKillSwitch(N).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!S)return[3,1];_=e(i.readItems(function(e){var t=T&&v.spListKeyFacet.serialize(T),n=e.demandItemFacet(d.listMediaTransformFacet,t),r=n&&n[".driveAccessToken"];return r&&r.replace("access_token=","")}));return[3,3];case 1:return[4,e(m.getAuthToken({url:E,disallowCookies:!0}))];case 2:_=n.sent();n.label=3;case 3:return[3,7];case 4:return(P=s.endpoint)?[4,e(g.getSessionToken(s.endpoint,E))]:[3,6];case 5:P=n.sent();n.label=6;case 6:_=(D=P)&&D.accessToken;n.label=7;case 7:if(void 0===_)throw new w.ApiError({code:"authFailure"});H=N&&b.getKillSwitch(N).isActivated("C827C03F-4B57-4B6A-8BAB-3AE30D6AB56B","01/23/2020","including drive endpoint in the path")?"/drive/root/view.delta?token="+encodeURIComponent(t):E+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:H,accessToken:{accessToken:_,tokenUrl:E},useAuthorizationHeaders:!0,headers:{"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"}})];case 8:B=n.sent();j=[];if(B&&B.value)for(F=0,I=B.value;F<I.length;F++){q=I[F];R=void 0;U={endpoint:s.endpoint,driveId:s.driveId,itemId:q.id};if(q.root){$=l.getEndpointVersionKeyAliases(U);for(z=0,W=$;z<W.length;z++){Q=W[z];k.mapKeys({mappings:(G={},G[Q]=this._rootItemKey,G)})}}else if(q.webUrl&&(X=h.getDecodedUrl(q.webUrl))){V=v.spItemFullUrlKeyFacet.serialize({itemFullUrl:X});if(e(r.readItem({spItemKey:v.spItemKeyFacet},V)).spItemKey){$=l.getEndpointVersionKeyAliases(U);for(J=0,K=$;J<K.length;J++){Q=K[J];k.mapKeys({mappings:(Y={},Y[Q]=V,Y)})}}}if(!q.root){q.parentReference&&(R=q.parentReference.id);j.push({itemKey:f.driveItemKeyFacet.serialize(U),parentItemKey:R&&f.driveItemKeyFacet.serialize({endpoint:s.endpoint,driveId:s.driveId,itemId:R}),isDeleted:!!q.deleted,isShared:!!q.shared,name:q.name,dateModified:q.lastModifiedDateTime,eTag:q.eTag})}}return[2,{syncToken:B["@delta.token"],messages:j,itemResolver:k}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(r.readItem({deleted:s.deletedFacet},t.itemKey)).deleted)return;return{type:a.ItemAutoRefreshChangeType.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(r.readItem({spItemKey:v.spItemKeyFacet,mediaTransformSchema:d.itemMediaTransformFacet,displayName:s.displayNameFacet},t.itemKey)),o=i.spItemKey,u=i.mediaTransformSchema,f=i.displayName;if(void 0===o){if(!t.parentItemKey)return;return{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(u&&t.eTag){var l=u[".etag"];if(l&&t.eTag&&t.eTag!==l)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:d.itemMediaTransformFacet,reason:"eTag changed from "+l+" to "+t.eTag}}if(void 0!==t.name&&f!==t.name)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:s.displayNameFacet,reason:"Name changed from "+f+" to "+t.name}};return e})();t.default=E});
define("qVe",["require","exports","lC","xo","rs","Rs","Xo","Vm","QVe","he","ue","y7","m7","ii","li","WVe","nS","Xy","Yo","a7","cS","ce"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof v.default){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){var t,n,r,s,o,u;if(this._webAbsoluteUrl&&this._listFullUrl){var a=d.spListKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),f=e(i.readItems(function(e){return e.demandItemFacet(p.listSubscriptionFacet,a)}));if((null===(t=f)||void 0===t?void 0:t.notificationUrl)&&(null===(n=f)||void 0===n?void 0:n.expirationDateTime)&&(null===(r=f)||void 0===r?void 0:r.subscribeID))return{notificationUrl:null===(s=f)||void 0===s?void 0:s.notificationUrl,expirationDateTime:null===(o=f)||void 0===o?void 0:o.expirationDateTime,id:null===(u=f)||void 0===u?void 0:u.subscribeID}}};e.prototype.getChangeMessages=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var r,s,o,a,h,p,v,y,b,w,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W=this;return n.__generator(this,function(X){switch(X.label){case 0:if(o=!!t&&"SPO_LIST,"===t.substr(0,9)){a=t.split(",");h=a[1];p=a[2];v='<Eq><FieldRef Name="Modified" />';v+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+p+"</Value></Eq>";y='<Gt><FieldRef Name="ID" /><Value Type="Number">'+h+"</Value></Gt>";r=f.combineFilters([v,y],l.CamlTags.and);b='<Gt><FieldRef Name="Modified" />';b+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+p+"</Value>";b+="</Gt>";r=f.combineFilters([r,b],l.CamlTags.or);s=["ID","FileRef","Modified","Title"];w=this._getListColumns(e);for(S=0,x=w;S<x.length;S++)"ID"!==(T=x[S]).internalName&&"FileRef"!==T.internalName&&"Modified"!==T.internalName&&"Title"!==T.internalName&&s.push(T.internalName)}else s=["ID","FileRef","Modified"];"ID";N=o;C=o?200:1;k=new c.default("<View></View>");r&&k.addFilters([r]);s&&k.replaceFields(s);k.updateSort({fieldName:"ID",isAscending:N});k.updateRowLimit({rowLimit:C,isPerPage:!1});L=e(i.readItems(function(e){return g.getPageContextFromItemCache(e,d.spItemKeyFacet.serialize({webAbsoluteUrl:W._webAbsoluteUrl,listFullUrl:W._listFullUrl}))}));this._requestDatesInUtc=!L||E.getKillSwitch(L).isActivated("3599C6B2-C5C1-42F2-A5E1-CA0C352D20AB","01/09/2020","Do not request dates in UTC for autorefresh");return[4,e(m.getServerData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:k.getEffectiveViewXml(),postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:L}))];case 1:A=X.sent();this._serverResponse=A;O=A.ListData;M=O&&O.Row||[];_=[];D=this._getLastIdInList(M);P=o?this._getLastModifiedTimeInList(M,L):(new Date).toISOString();for(H=0,B=M;H<B.length;H++)if(void 0!==(j=B[H]).FileRef){F={};I=Object.keys(j);for(q=0,R=I;q<R.length;q++){U=R[q];z=0===U.indexOf("OData_")?U.substr(6):U;F[z]=j[U]}_.push(n.__assign(n.__assign({itemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:j.ID}),parentItemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:j.Title||""},j.Modified?{dateModified:""+j.Modified}:{}),{fields:F}))}0===_.length&&_.push({itemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});return[2,{syncToken:"SPO_LIST,"+D+","+P,messages:_,itemResolver:new u.ItemResolver}]}})})};e.prototype.updateItems=function(e,t){if(t&&d.spFolderItemSetKeyFacet.matches(this._itemSetKey)&&this._serverResponse){var n=d.spFolderItemSetKeyFacet.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(w.getContentTypes({itemSetKey:r})),s=e(w.constructGetItemContext(n,i,"getSPItem")),o=e(b.processResponse({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(o.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){if(void 0===t.parentItemKey)return{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"};if(t.isDeleted){if(e(r.readItem({deleted:s.deletedFacet},t.itemKey)).deleted)return;return{type:a.ItemAutoRefreshChangeType.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var o=e(i.readItems(function(e){return e.isItemFacetResolved(d.spItemKeyFacet,t.itemKey)?{rowData:e.demandItemFacet(p.rowDataFacet,t.itemKey),spItemKey:e.demandItemFacet(d.spItemKeyFacet,t.itemKey),title:e.demandItemFacet(p.titleFacet,t.itemKey),selectedItemKeys:y.getSelectedItemKeys(e,{itemsScopeItemKey:n})}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:void 0}})),u=o.rowData,f=o.spItemKey,l=o.title,c=o.selectedItemKeys,h=c&&c.length>0;if(void 0===f||void 0===u){if(!t.parentItemKey)return;if(void 0===e(r.readItem({spParentItemKey:d.spItemKeyFacet},t.parentItemKey)).spParentItemKey)return;return h?void 0:{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==l&&void 0!==t.name&&l!==t.name)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:p.titleFacet,reason:'Item title changed from "'+l+'" to '+t.name+")"};if(t.fields){h||(this._serverResponse=void 0);for(var v=this._getListColumns(e),m=function(e){for(var n=e.internalName,r=0,i=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});r<i.length;r++){var s=i[r],o=u&&u[s],f=t.fields[s];try{"object"==typeof o&&(o=JSON.stringify(o));"object"==typeof f&&(f=JSON.stringify(f));if(g._requestDatesInUtc&&"DateTime"===e.fieldType){var l=Date.parse(o),c=Date.parse(f);if(!isNaN(l)&&!isNaN(c)){o=l;f=c}}}catch(e){continue}if(o!==f)return{value:{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:p.rowDataFacet,hasSelection:h,reason:'Item field "'+n+'" changed from "'+o+'" ('+typeof o+') to "'+f+'" ('+typeof f+")"}}}},g=this,b=0,w=v;b<w.length;b++){var E=m(w[b]);if("object"==typeof E)return E.value}}};e.prototype._getLastIdInList=function(e){return e&&e.length>0?Math.max.apply(Math,e.map(function(e){return parseInt(e.ID,10)})):0};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(r.readItem({schema:o.schemaFacet},this._itemSetKey)).schema,i=n&&n.columnKeys;if(i)for(var s=0,u=i;s<u.length;s++){var a=u[s],f=e(r.readItem({internalName:p.internalNameFacet,fieldType:p.fieldTypeFacet,mappedFieldType:p.mappedColumnFieldTypeFacet},a)),l=f.internalName,c=f.fieldType,d=f.mappedFieldType;void 0!==l&&void 0!==c&&void 0!==d&&d!==h.default.Title&&t.push({internalName:l,fieldType:c,mappedFieldType:d})}return t};return e})();t.default=S});
define("WVe",["require","exports","lC","Rm","P1","Io","ri","XA","de","Cv","xv","A8"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:819,ODC:"EnablePushChannelLogging"},p=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,p,d,v,m,g,y,b,w,E,S,x,T,N,C;return n.__generator(this,function(n){switch(n.label){case 0:if(e.existingSubscription)return[3,5];p=c.getStaticApiUrl({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:p.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){f.default.isFeatureEnabled(h)&&console.log("Error getting service url: ",e)})];case 1:d=n.sent();v=this._dispatch(s.readConfiguration({isTest:o.isTestMode})).isTest;if(!(m=d&&d.d&&d.d.GetServiceUrls&&d.d.GetServiceUrls.results&&d.d.GetServiceUrls.results[0])&&!v)throw new Error("Unable to retrieve PushChannel base url");v&&(m="https://northcentralus0-pushs.svc.ms");g=m+"/notifications/register";y=a.default.generate();b=this._dispatch(r.logQoS({name:"SubscriptionServiceGenericList.Register"}));w={correlationId:y};n.label=2;case 2:n.trys.push([2,4,,5]);return[4,u.default.start({url:g,method:"GET",headers:{"X-Correlation-Id":y},requestTimeoutInMS:1e4})];case 3:(E=n.sent())&&E.responseText&&E.responseText.length>0&&(S=JSON.parse(E.responseText))&&S.serverUrl&&S.webhookUrl&&(t=S.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(b({resultType:i.ResultType.success,extraData:w}));return[3,5];case 4:x=n.sent();this._dispatch(b({resultType:i.ResultType.failure,extraData:w}));throw x;case 5:T=c.getWebApiUrl({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){T=T.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else T=T.segments("Subscriptions","Add");N={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:T.toString(),body:JSON.stringify(N),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((C=n.sent())&&C.d){delete C.d.__metadata;if(e.existingSubscription){C.d.id=e.existingSubscription.id;C.d.notificationUrl=e.existingSubscription.notificationUrl;C.d.expirationDateTime=N.parameters.expirationDateTime}return[2,C.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=c.getWebApiUrl({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})();t.default=p});
define("nze",["require","exports","lC","Hm","ih","li","T5","rze","aze"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(a,t);t.sharePointAddonQuickEdit=r.createAddon(function(){return function(e){e(i.registerControlHandler(s.spFolderItemSetKeyFacet,o.itemSetQuickEditListControl)(u.itemSetQuickEditListControlHandler))}})});
define("rze",["require","exports","r","oze","ih"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetQuickEditListControlHandler=i.createControlHandler()(s);function s(){return function(e){return function(e,t){return{quickEditLayout:n.createElement(r.QuickEditLayout,null)}}}}t.getItemSetQuickEditListControlHandler=s});
define("oze",["require","exports","lC","tv","_s","Tr","C1","y6","LS"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=r.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["sze"],t,n)})];case 1:return[2,t.sent().ItemSetQuickEditList]}})})}),l=s.asLayout(u.quickEditLayoutType)(f);t.QuickEditLayout=i.withCurrentItemSet()(o.connectToItemCache(function(e,t){return{isAvailable:a.getIsQuickEditLayoutAvailable(e,t),allowEmptyFolder:!1,allowPinnedItems:!1}})(l))});
define("aze",["require","exports","lC","r","ks","Ec","Ps","Es","Xh","y6","li","ii","Uo","$1","ce","ize","Go","F1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=d.Killswitch.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),b=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(s.WithItemCache,null,function(s){var d=s.itemCache,b=s.dispatch,w=u.getItemActionEngagement(d,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),E=d.demandItem({deserizalizeKey:l.spFolderItemSetKeyFacet},t).deserizalizeKey,S=E&&E.viewKey,x=E&&l.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl},viewKey:S}),T=S&&l.spViewKeyFacet.serialize(S),N=g.getItemsScope(d).itemsScopeItemKey,C=m.getCurrentLayout(d,{itemsScopeItemKey:N});return r.createElement(o.WithAction,{action:r.createElement(a.SwitchLayoutAction,{layoutType:f.quickEditLayoutType})},function(t){var s=t.execute;return r.createElement(i.Action,n.__assign({isAvailable:!0,onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(i){switch(i.label){case 0:if(!y){v.resetRumOneMarker();v.addRumOneMarker("quickEdit.layoutManager.start")}x&&b(p.resolveItems({items:(e={},e[x]=n.__assign({},c.completeExitingQuickEditSignalFacet.pack(new h.Signal)),e)}));T&&b(p.resolveItems({items:(r={},r[T]=n.__assign({},c.quickEditExitLayoutType.pack(C)),r)}));return[4,s(t)];case 1:i.sent();y||v.addRumOneMarker("quickEdit.layoutManager.end");return[2]}})})}},w))})})};return t})(r.PureComponent);t.QuickEditActionExecutor=b});
define("ize",["require","exports","h1","I1","_1","q"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addRumOneMarker=function(e){n.default.getRUMOneLogger().mark(e)};t.resetRumOneMarker=function(){var e=n.default.getRUMOneLogger();e.isRunning()||e.resetLogger()};t.writeRumOneData=function(){var e=n.default.getRUMOneLogger();if(e&&e.isRunning()){var t=Number(e.getPerformanceDataPropertyValue("W3cNavigationStart")),a=s.HighResolutionTimingSupported?0:t,f=e.getMarkerTime("quickEditCommand.click"),l=f||a,c=e.getMarkerTime("quickEdit.pltafterlayoutswitch.start"),h=e.getMarkerTime("quickEdit.plt.end");e.addExpectedControl("QuickEdit");f?e.writeScenarioId("QuickEdit"):e.writeScenarioId("SPListQuickEdit",!0);e.writePageTransitionType(f?r.default.none:r.default.fullPageLoad);e.collectW3CPerfTimings();if(c&&h&&l>-1){var p={},d=e.getMarkerTime("quickEdit.layoutManager.start"),v=e.getMarkerTime("quickEdit.layoutManager.end");d&&v&&o(d,v,"QuickEditLayoutManagerDuration",p);v&&c&&o(v,c,"QuickEditItemsViewCacheDuration",p);var m=e.getMarkerTime("quickEdit.loadExternalFiles.start"),g=e.getMarkerTime("quickEdit.loadExternalFiles.end");m&&g&&o(m,g,"QuickEditExternalJsLoadDuration",p);var y=e.getMarkerTime("quickEdit.serialization.start"),b=e.getMarkerTime("quickEdit.serialization.end");y&&b&&o(y,b,"QuickEditGridSerializationDuration",p);var w=e.getMarkerTime("quickEdit.gridrender.start"),E=e.getMarkerTime("quickEdit.gridrender.end");w&&E&&o(w,E,"QuickEditGridRenderDuration",p);o(l,h,"QuickEditPLTRenderDuration",p);o(c,h,"QuickEditPLTAfterLayoutSwitchDuration",p);if(window._spPageContextInfo){e.writeServerCorrelationId(window._spPageContextInfo.CorrelationId);e.collectSPClientFlights(window._spPageContextInfo)}e.writeControlPerformanceData((function(e,t,n){return new i.default(e,t,n,u,function(){return!isNaN(t)&&!isNaN(n)})})("QuickEdit",l,h));e.writeEUPLBreakdown(JSON.stringify(p))}}};function o(e,t,n,r){if(e&&t){var i=t-e;r[n]=i}}function u(e,t){return e&&t?t.endTime-t.startTime:0}});
define("qQ",["require","exports","lC","Hm","$1","So","ri","Vm","li","Co","qr","si","bP","Rs","fL","ii","Io","x8"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function y(e){var t=e.itemKey,r=e.driveItem;return function(e){var i,s,o=e(m.readConfiguration({enableSharePointItemMapping:v.enableSharePointItemMappingConfigurationFacet})).enableSharePointItemMapping,h=void 0===o||o,g=new u.ItemResolver,y=r.webDavUrl||r.remoteItem&&r.remoteItem.webDavUrl||r.webUrl,b=y&&decodeURIComponent(y);if(b){var w={itemFullUrl:b},E=d.getParentItemUrl(b),S={itemFullUrl:E},x=a.spItemFullUrlKeyFacet.serialize(w),T=a.spItemFullUrlKeyFacet.serialize(S);g.mapKeys({mappings:(i={},i[x]=t,i)});g.resolveItems({items:(s={},s[x]=n.__assign(n.__assign({},h?n.__assign({},c.pack({preferredKeyFacet:f.preferredKeyFacetFacet},{preferredKeyFacet:new l.IfNotMatchPatch(a.spItemFullUrlKeyFacet,function(e){return e===a.spItemKeyFacet})})):{}),p.parentFolderItemFacet.pack({itemKey:T})),s[T]=n.__assign(n.__assign(n.__assign({},p.folderFacet.pack({})),p.canonicalUrlFacet.pack(E)),p.openUrlFacet.pack(encodeURI(E))),s)})}return{itemResolver:g}}}t.sharePointGraphAddon=r.createAddon(function(){return function(e){var t;e(g.sharePointGraphOneDriveAddon);e(h.sharePointItemByFullUrlAddon);e(i.resolveItems({items:(t={},t[s.configurationItemKey]=n.__assign({},o.processDriveItemFromSharePointFacet.pack({process:y})),t)}))}})});
define("sze",["require","exports","lC","r","Bs","C1","Xo","wo","ii","fze","li","pr","xv","xN","AN","g6","Ik","Ny","Vs","Es","VT","C_","Qn","jL","zm","Zd","ce","i9","E_","r9","g7","l4","ss","F1","ize","A1","Rf","tv","xA","Y7e","rs","Ih","w","YD","Yo","uze","lze","dze","cze","Ov"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var Q=new B.PlatformDetection,G=j.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../actions/launchColumnManagementPanel/LaunchColumnManagementPanelExecutor"],t,n)})];case 1:return[2,t.sent().LaunchColumnManagementPanelAction]}})})}),Y=n.__assign(n.__assign({},L.default),A.default),Z={ODB:1261},ee={ODB:1746},te={ODB:1725},ne={ODB:1439},re={ODB:1806},ie={ODB:1507},se={ODB:1892},oe={ODB:1947},ue={ODB:1948},ae={ODB:1170},fe={ODB:1310},le={ODB:1757},ce=E.asAutoAction()(w.LaunchFilterPanelAction),he=E.asAutoAction()(w.SortAction),pe=E.asAutoAction()(G),de={ODB:1553},ve={ODB:420},me={ODB:1024},ge={ODB:1300},ye={ODB:1206},be={ODB:988},we={ODB:1198},Ee={ODB:1672},Se={ODB:1722},xe={ODB:1740},Te={ODB:1918},Ne={ODB:1843},Ce=C.Killswitch.isActivated("69C410FF-8191-4047-AB22-9C64BCA7F076","07/02/2020","ensure Sort or Filter get correct schema"),ke=C.Killswitch.isActivated("8559E6CC-ECD4-46B1-8036-5674441D68C2","8/20/2020","Refresh the whole EQ when we update the schema of a specific column"),Le=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._refreshChangedItemsInCache=function(e){var t=n.props.refreshItemsById,r=Object.keys(n._itemIdsToRefresh);return t&&r.length?t({itemIds:r,shouldInvalidateDataForLayout:e}).then(function(){n._itemIdsToRefresh={}}):Promise.resolve()};n._onItemCreatedFromClientForm=function(e){return n._onItemCreatedOrUpdatedFromClientForm(I.ClientFormEvents.newItemCreated,e.args)};n._onItemUpdatedFromClientForm=function(e){return n._onItemCreatedOrUpdatedFromClientForm(I.ClientFormEvents.itemUpdated,e.args)};n._onItemCreatedOrUpdatedFromClientForm=function(e,t){var r=n.props,i=r.telemetry,s=r.refreshItemsById;if(s&&t&&t.itemIds){s({itemIds:t.itemIds,shouldReturnRefreshedRows:!0}).then(function(e){e&&e.length&&n.setState({refreshedRows:e})});i&&i(R.default).logData({name:e+"QuickEdit",isIntentional:!0,extraData:{isBulkEdit:t.itemIds.length>1}})}};n._onSelectionChanged=function(e){var t=n.props.onSelectionChanged;e&&e.length&&n._refreshChangedItemsInCache();t&&t(e)};n.onColumnChangeSucceeded=function(){n._isSchemaChanged=!0};n.onPaging=function(e){n._refreshChangedItemsInCache();if(n.props.onPaging){n.props.onPaging(e);n.setState({currentFirstRow:e.isBackward?e.firstRowInGrid-n.props.rowLimit:e.lastRowInGrid+1})}};n.onLaunchFilterPanel=function(e){var t=n.props.setKey;e&&t&&n.setState({filterPanel:{columnKey:c.spListFieldKeyFacet.serialize({listKey:t,internalName:e})}})};n.onFormatColumn=function(e){e&&n.setState({formatColumnProps:{internalName:e}})};n.onFormatColumnComplete=function(){n.setState({formatColumnProps:void 0})};n.onEditColumns=function(){n.setState({editColumns:!0})};n.onEditColumnsComplete=function(){n.setState({editColumns:!1})};n.onPinToFiltersPane=function(e,t){n.setState({pinToFiltersPaneProps:{column:e,showInFiltersPane:t}})};n.onPinToFiltersPaneComplete=function(){n.setState({pinToFiltersPaneProps:void 0})};n.onSort=function(e,t){e&&n.setState({sortActionProps:{itemSetKey:n.props.itemKey,isAscending:t,sortFieldKey:e}})};n.onSortActionComplete=function(){n.setState({sortActionProps:void 0})};n.closeFilterPanel=function(){n.setState({filterPanel:void 0})};n.onLaunchColumnManagementPanel=function(e,t){t&&(n._columnManagementPanelActionOnComplete=t);n.setState({columnPanelProps:{createField:e.createField,editField:e.editField,isHyperlink:e.isHyperlink,isQuickEdit:!0}})};n.onColumnManagementPanelActionComplete=function(){var e;if(n._columnManagementPanelActionOnComplete){n._columnManagementPanelActionOnComplete();n._columnManagementPanelActionOnComplete=void 0}n._isSchemaChanged=!0;if(!ke&&(null===(e=n.state.columnPanelProps)||void 0===e?void 0:e.editField)){n._columnEditCounter++;n.props.invalidateSchema&&n.props.invalidateSchema()}n.setState({columnPanelProps:void 0})};n.closeColumnManagementPanel=function(){n.setState({columnPanelProps:void 0})};P.addRumOneMarker("quickEdit.pltafterlayoutswitch.start");n.state={filterPanel:void 0,itemKey:t.itemKey};n._events=new S.EventGroup(n);n._itemIdsToRefresh={};n._isSchemaChanged=!1;n._columnEditCounter=0;return n}t.getDerivedStateFromProps=function(e,t){return t.itemKey&&t.itemKey!==e.itemKey?{itemKey:e.itemKey,currentFirstRow:void 0,isLoading:!0}:null};t.prototype.componentDidMount=function(){var e=this;this._events.on(document,"quickEditWriteChangesToList",function(t){if(t&&t.itemIds)for(var n=0,r=t.itemIds;n<r.length;n++){var i=r[n];e._itemIdsToRefresh[i]=!0}});this._events.on(window,I.ClientFormEvents.itemUpdated,this._onItemUpdatedFromClientForm);this._events.on(window,I.ClientFormEvents.newItemCreated,this._onItemCreatedFromClientForm)};t.prototype.componentWillUnmount=function(){this._isSchemaChanged&&this.props.invalidateSchema&&this.props.invalidateSchema();this._events.dispose()};t.prototype.componentDidUpdate=function(e){var t=this;if(!Ce&&(this.state.sortActionProps||this.state.filterPanel)&&this._isSchemaChanged&&this.props.invalidateSchema){this.props.invalidateSchema();this._isSchemaChanged=!1}this.state.isLoading&&this._refreshChangedItemsInCache(!0).then(function(){t.setState({isLoading:!1})})};t.prototype.render=function(){var e,t,i,s=this.props,o=s.itemResponseJsonString,u=s.getAuthToken,a=s.pageContext,l=s.gridInitInfo,c=s.completeExitingQuickEditSignal,h=s.customFormatterProps,p=s.additionalColumnSchema,d=s.telemetry,v=s.baseEngagementData,m=s.itemKey,g=s.rows,y=s.isDataReadyForLayout,b=s.rowLimit,w=s.hasNextPage,S=s.flightStatus,x=s.getEventSource,T=s.gridLayoutType,C=s.selectedItemIds,k=s.portalManager,L=s.launchColumnCustomization,A=s.launchColumnsEditorPanel,M=s.pinToFiltersPane,_=this.state,D=_.filterPanel,P=_.isLoading,H=_.sortActionProps,B=_.columnPanelProps,j=_.currentFirstRow,F=_.refreshedRows,I=_.formatColumnProps,q=_.editColumns,R=_.pinToFiltersPaneProps,U=!!P||!y||j&&g.length<j,z=g,W=g.length;if(!U&&a&&l&&void 0!==j){W=Math.min(j-1+b,W);z=g.slice(j-1,W)}L&&(e=E.asAutoAction()(L));A&&(t=E.asAutoAction()(A));M&&(i=E.asAutoAction()(M));return r.createElement("div",{className:"quickEditParentDiv"},U&&r.createElement(N.Spinner,{size:N.SpinnerSize.large}),!U&&a&&l&&r.createElement(f.default,{key:m+(j||1)+this._columnEditCounter,itemResponseJsonString:o,rows:z,firstRowInGrid:j||1,hasNextPage:w||W<g.length,onPaging:this.onPaging,getAuthToken:u,pageContext:a,gridInitInfo:l,completeExitingQuickEditSignal:c,customFormatterProps:h,additionalColumnSchema:p,telemetry:d,baseEngagementData:v,onLaunchFilterPanel:this.onLaunchFilterPanel,onSort:this.onSort,onLaunchColumnManagementPanel:this.onLaunchColumnManagementPanel,getColumnWidthsFromLocalStorage:O.getColumnWidthsFromLocalStorage,setColumnWidthsToLocalStorage:O.setColumnWidthsToLocalStorage,flightStatus:S,onColumnChangeSucceeded:this.onColumnChangeSucceeded,onSelectionChanged:this._onSelectionChanged,getEventSource:x,refreshedRows:F,gridLayoutType:T,selectedItemIds:C,portalManager:k,launchColumnCustomization:this.onFormatColumn,launchColumnsEditor:this.onEditColumns,onPinToFiltersPane:this.onPinToFiltersPane}),!U&&D&&D.columnKey&&r.createElement(ce,{columnKey:D.columnKey,itemSetKey:this.props.itemKey,onComplete:this.closeFilterPanel,onError:this.closeFilterPanel}),!!H&&H.sortFieldKey&&r.createElement(he,n.__assign({},H,{onComplete:this.onSortActionComplete})),!!B&&r.createElement(pe,{itemSetKey:this.props.itemKey,columnManagementPanelExecutorProps:B,onComplete:this.onColumnManagementPanelActionComplete,onError:this.closeColumnManagementPanel}),!!I&&e&&r.createElement(e,{internalName:I.internalName,onComplete:this.onFormatColumnComplete}),!!q&&t&&r.createElement(t,{onComplete:this.onEditColumnsComplete}),!!R&&i&&r.createElement(i,{column:R.column,showInFiltersPane:R.showInFiltersPane,onComplete:this.onPinToFiltersPaneComplete}))};return t})(r.PureComponent);var Ae=y.withTelemetry()(i.withLayoutRenderComplete()(function(e){var t=X.usePortalManager(),i=t[0],s=t[1];return r.createElement(r.Fragment,null,s,r.createElement(Le,n.__assign({portalManager:i},e)))}));t.ItemSetQuickEditList=s.connectToItemCache(function(e,t){var r=t.itemKey,i=e.dispatch,s=30,f=void 0,c=e.isItemFacetResolved(a.getItemResponseJsonStringFacet,t.itemKey)||e.isItemFacetResolved(u.errorFacet,t.itemKey),y=function(e){return i(h.getAuthToken({url:e}))},w=e.demandItem({setKey:l.spFolderItemSetKeyFacet,itemResponseJsonString:a.getItemResponseJsonStringFacet},r),E=w.setKey,S=w.itemResponseJsonString,x=e.demandItemFacet(a.viewFormatterFacet,M.getViewKeyFromItemSetKey(e,{itemSetKey:r}));if(!E||!S)return{itemResponseJsonString:S||"",rows:[],gridInitInfo:void 0,pageContext:void 0,getAuthToken:y,isDataReadyForLayout:!1,rowLimit:s};var N=[];if(S){var C=e.demandItemFacet(o.childItemsFacet,r);if(C&&C.itemKeys)for(var L=0,A=C.itemKeys;L<A.length;L++){var O=A[L];if(e.isItemFacetResolved(o.pageFacet,O))f=O;else{if(!e.isItemFacetResolved(a.rowDataFacet,O)){N=[];c=!1;break}var P=e.demandItemFacet(a.rowDataFacet,O);P&&N.push(n.__assign({},P))}}}var B=e.demandItemFacet(a.spPageContextFacet,l.spPageContextKeyFacet.serialize(E)),j=l.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl},viewKey:E.viewKey});Ce||(c=c&&e.isItemFacetResolved(a.gridInitInfoFacet,j));var I=e.demandItem({gridInitInfo:a.gridInitInfoFacet,completeExitingQuickEditSignal:a.completeExitingQuickEditSignalFacet},j),q=I.gridInitInfo,R=I.completeExitingQuickEditSignal,z=[],X=W.getSelectedItemKeys(e);if(X&&X.length)for(var G=0,ce=X;G<ce.length;G++){var he=ce[G],pe=e.demandItemFacet(a.listItemIdFacet,he);pe&&z.push(pe)}for(var ke=p.getCustomFormatterSchemaFromItemCache(e,r),Le=v.isFeatureEnabled(e,{feature:Z,pageContext:B}),Ae=[],_e=0,De=m.readItemSetSchemaFromItemCache(e,{mapping:{internalName:a.internalNameFacet,isFilterable:g.isFilterableFacet,customFormatter:a.customFormatterFacet,isSortable:g.isSortableFacet,mappedColumnFieldType:a.mappedColumnFieldTypeFacet,fieldType:a.fieldFieldTypeFacet,isEditable:g.isEditableFacet,isCalculated:a.isCalculatedFacet},itemSetKey:r});_e<De.length;_e++){var Pe=De[_e];if(Pe.internalName){var He={internalName:Pe.internalName,filterable:!!Pe.isFilterable,customFormatter:Pe.customFormatter,fieldType:Pe.fieldType,isEditable:Pe.isEditable,isCalculated:Pe.isCalculated};if(Pe.isSortable){var Be=k.getSortMenuStrings({fieldType:Pe.mappedColumnFieldType,internalName:Pe.internalName},Y),je=Be.ascendingString,Fe=Be.descendingString;He.ascendingString=je;He.descendingString=Fe}Ae.push(He)}}var Ie,qe=void 0;if(E.viewKey){var Re=l.spViewKeyFacet.serialize(E.viewKey),Ue=e.isItemFacetResolved(a.serverViewFacet,Re)?e.demandItemFacet(a.serverViewFacet,Re):void 0;Ue&&Ue.RowLimit&&(s=Ue.RowLimit);Ie=e.demandItemFacet(a.viewTypeFacet,Re);var ze=H.getConfiguration(e,{expandedPageRowLimitNumber:a.spItemPageExpandedRowLimitConfigurationFacet}).expandedPageRowLimitNumber;if(ze&&(!s||s<ze)){s=ze;if(f){var We=e.demandItemFacet(l.spItemPageKeyFacet,f),Xe=We&&We.token;if(Xe){var Ve=Xe&&U.deserializeQuery(Xe.toLowerCase()),$e=Ve&&Ve.pagefirstrow;if(Number($e)-1<s){c=!1;Oe(f,i)}}}}qe=function(){var e,t=E&&l.spListKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl});return i(T.invalidateItems({items:(e={},e[Re]=[a.serverViewFacet,a.currentDerivedViewFacet],e[j]=[a.gridInitInfoFacet],e[t]=[a.contentTypeKeysFacet],e[r]=[o.childItemsFacet],e)}))}}var Je={};Je[ee.ODB]=v.isFeatureEnabled(e,{feature:ee,pageContext:B});Je[ne.ODB]=v.isFeatureEnabled(e,{feature:ne,pageContext:B});Je[te.ODB]=v.isFeatureEnabled(e,{feature:te,pageContext:B})&&!Q.isIE;Je[re.ODB]=v.isFeatureEnabled(e,{feature:re,pageContext:B});Je[ie.ODB]=v.isFeatureEnabled(e,{feature:ie,pageContext:B});Je[se.ODB]=v.isFeatureEnabled(e,{feature:se,pageContext:B});Je[oe.ODB]=v.isFeatureEnabled(e,{feature:oe,pageContext:B});Je[ue.ODB]=v.isFeatureEnabled(e,{feature:ue,pageContext:B});Je[ae.ODB]=v.isFeatureEnabled(e,{feature:ae,pageContext:B});Je[fe.ODB]=v.isFeatureEnabled(e,{feature:fe,pageContext:B});Je[le.ODB]=v.isFeatureEnabled(e,{feature:le,pageContext:B});Je[de.ODB]=v.isFeatureEnabled(e,{feature:de,pageContext:B});Je[ve.ODB]=v.isFeatureEnabled(e,{feature:ve,pageContext:B});Je[me.ODB]=v.isFeatureEnabled(e,{feature:me,pageContext:B});Je[ge.ODB]=v.isFeatureEnabled(e,{feature:ge,pageContext:B});Je[ye.ODB]=v.isFeatureEnabled(e,{feature:ye,pageContext:B});Je[be.ODB]=v.isFeatureEnabled(e,{feature:be,pageContext:B})&&Je[te.ODB];Je[we.ODB]=v.isFeatureEnabled(e,{feature:we,pageContext:B});Je[Ee.ODB]=v.isFeatureEnabled(e,{feature:Ee,pageContext:B});Je[Se.ODB]=v.isFeatureEnabled(e,{feature:Se,pageContext:B});Je[xe.ODB]=v.isFeatureEnabled(e,{feature:xe,pageContext:B});Je[Te.ODB]=v.isFeatureEnabled(e,{feature:Te,pageContext:B});Je[K.GlobalDataSyncFeature.ODB]=v.isFeatureEnabled(e,{feature:K.GlobalDataSyncFeature,pageContext:B});Je[K.DataSyncEntityFeatures[K.DataSyncEntityType.SharePointList].ODB]=v.isFeatureEnabled(e,{feature:K.DataSyncEntityFeatures[K.DataSyncEntityType.SharePointList],pageContext:B});Je[Ne.ODB]=v.isFeatureEnabled(e,{feature:Ne,pageContext:B});var Ke=void 0;x&&x.viewFormatter&&!x.viewFormatter.getRowFormatter()&&(Ke=x.viewFormatter.getAdditionalRowClass());var Qe,Ge=b.getItemEngagement(e,{itemKey:l.spItemKeyFacet.serialize(E),engagement:{isIntentional:!0}}),Ye=D.getItemsScope(e).itemsScopeItemKey,Ze=e.demandItemFacet(V.launchColumnCustomizationControl,r),et=V.launchColumnCustomizationControl.evaluate(Ze)(e,{itemKey:r}).action,tt=e.demandItemFacet($.launchColumnsEditorPanelActionControl,r),nt=$.launchColumnsEditorPanelActionControl.evaluate(tt)(e,{itemKey:r}).onClickAction,rt=e.demandItemFacet(J.pinToFiltersPaneActionControl,r),it=J.pinToFiltersPaneActionControl.evaluate(rt)(e,{itemKey:r}).onClickAction;Ye&&(Qe=function(e){if(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n],o={webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,itemId:s},u=l.spItemKeyFacet.serialize(o);t.push(u)}i(_.selectItems({itemsScopeItemKey:Ye,selectedItemKeys:t,currentSelectionKey:void 0}))}});Ge.objectType=void 0;return{itemResponseJsonString:S||"",rows:N,gridInitInfo:q,pageContext:B,getAuthToken:y,isDataReadyForLayout:c,completeExitingQuickEditSignal:R,customFormatterProps:{customFormatterSchema:ke,getItemData:function(e,t){return d.getItemData(e,t,Le)},additionalRowClass:Ke},additionalColumnSchema:Ae,baseEngagementData:Ge,refreshItemsById:function(e){return Me(i,r,E.webAbsoluteUrl,E.listFullUrl,e)},invalidateSchema:qe,onPaging:function(e){var t,n=e.lastRowInGrid;!e.isBackward&&f&&N&&n+s>N.length&&(t=f);t&&Oe(t,i)},rowLimit:s,hasNextPage:!!f,flightStatus:Je,onSelectionChanged:Qe,getEventSource:function(){return i(F.getSharePointDataEventSource)},gridLayoutType:Ie,selectedItemIds:z,setKey:E,launchColumnCustomization:et,launchColumnsEditorPanel:nt,pinToFiltersPane:it}})(Ae);var Oe=function(e,t){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(z.demandItems(function(t){t.demandItemFacet(o.childItemsFacet,e)}))];case 1:n.sent();return[2]}})})},Me=function(e,t,r,i,s){var o,u=s.itemIds,f=s.shouldInvalidateDataForLayout,c=s.shouldReturnRefreshedRows;if(!u||!u.length)return Promise.resolve([]);for(var h={},p={},d=0,v=u;d<v.length;d++){var m=v[d],g=l.spItemKeyFacet.serialize({webAbsoluteUrl:r,listFullUrl:i,itemId:m});h[g]={};p[g]=[a.rowDataFacet]}f&&e(T.invalidateItems({items:p}));return e(x.refreshItemsInSet({items:(o={},o[t]=h,o)})).then(function(){if(!c)return[];for(var t=[],r=function(r){var i=e(q.readItems(function(e){return e.demandItemFacet(a.rowDataFacet,r)}));i&&i.ID&&t.push(n.__assign({},i))},i=0,s=Object.keys(h);i<s.length;i++){r(s[i])}return t})}});
define("fze",["require","exports","lC","r","JGe","SGe","lGe","cGe","sGe","oGe","Zd","SPListItemsScopeDeferred_IS_mini_css","ai","qk","vTe","iGe","aGe","nGe","tGe","am","ce","Qn","IA","A","eGe","$ze","xTe","Zze","ize","nU","tU","Xze","Jze","Yze","Qze","qze","pze"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B){"use strict";c=c.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var j=w.Killswitch.isActivated("FCBB4612-13ED-47B8-9E17-79F91890AC92","9/26/2019","Translate the title column to linktitle when comparing Grid columns to the additionalColumnSchema"),F=w.Killswitch.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),I=w.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),q=w.Killswitch.isActivated("09F7C55C-78BE-463F-A5CF-BEECB48E874B","11/25/2019","Allow the grid to exist in multiple webparts on a page."),R=w.Killswitch.isActivated("75452fe6-d341-4b80-a203-a947dca04245","10/3/2019","Remove unused strings carried over from classic implementation"),U=w.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),z=w.Killswitch.isActivated("3A4C46AF-0333-42C2-8741-9390170C8DB5","3/2/2020","fix an issue with some strings not loading in the correct language"),W=w.Killswitch.isActivated("734DA0D0-4C39-4582-A547-804B3D63665B","3/4/2020","fix jsgrid on prepsp machines"),X=w.Killswitch.isActivated("9536EDA9-94F6-4F65-BDB6-FAABD3B4565A","4/14/2020","remove extra space around the grid added by default by HTML table elements to allow for sticky header positioned correctly"),V=w.Killswitch.isActivated("A9EA6B41-8550-4E21-AAAC-83EE10F8699E","05/01/2020","Supoort link title in Quick edit"),$=w.Killswitch.isActivated("C523E9CC-6C6A-4709-BC40-5213BD939FC8","05/05/2020","Unbind all active editors on unmount"),J=w.Killswitch.isActivated("88A27C3C-E6D4-4843-B5E6-453111ABB9E4","07/08/2020","Replace the regular error message caught with the error stack in attempt to get more info on where the error is coming from"),K=w.Killswitch.isActivated("8C3C7769-3285-481A-9808-D802846E1A95","07/13/2020","Remove from Tab order the iframe used for auto-filters setup on column headers"),Q=w.Killswitch.isActivated("7004E61E-F336-440E-A3E7-A06FA6371622","05/27/2020","Use portalManager hook to render react component in SPGrid to ensure it will get the context from parent component"),G=w.Killswitch.isActivated("02C229AA-F1C1-4386-A3C2-A0B6242BA3D1","08/12/2020","Items Scope is perfeclty happy to display duplicate rows, but it blows up quick edit"),Y=w.Killswitch.isActivated("a842d84b-5aab-4456-b273-f2110801d664","8/24/2020","Populate SpRegionalSettings values using props.pageContext"),Z=1746,ee=1725,te=1553,ne=1757,re=1672,ie=988,se="https://ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjax.js",oe="QuickEdit.InitGrid",ue="QuickEdit.InitGanttControl",ae="QuickEdit.UpdateWithRefreshedRows",fe=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._additionColumnSchemaMap={};n.previousPageIds=[];n.currentPageIdx=0;n.didPage=!1;n.gridInitInfo={};n._loadScriptsDependentOnInit=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/",t="1033";n._loadCoreJsScript(function(){if(!R&&n.quickEditPltFlightEnabled){n.LoadClassicStrings();n._loadScriptsDependentOnStrings()}else{z||n._pageContextInfo.currentLanguage&&(t=n._pageContextInfo.currentLanguage.toString());n.LoadExternalJsFile(e+"_layouts/15/"+t+"/sp.res.js");n.LoadExternalJsFile(e+"_layouts/15/"+t+"/strings.js",n._loadScriptsDependentOnStrings);n.LoadExternalJsFile(e+"_layouts/15/"+t+"/sp.jsgrid.res.js")}n.quickEditPltFlightEnabled?_.global_inplview():n.LoadExternalJsFile(e+"_layouts/15/inplview.js");n.quickEditPltFlightEnabled||n.LoadExternalJsFile(e+"_layouts/15/clientrenderer.js");if(I||!n.quickEditPltFlightEnabled){n.LoadExternalJsFile(e+"_layouts/15/sp.runtime.js");n.LoadExternalJsFile(e+"_layouts/15/sp.js");n.LoadExternalJsFile(e+"_layouts/15/sp.init.js");n.LoadExternalJsFile(e+"_layouts/15/mquery.js")}n.LoadExternalJsFile(e+"_layouts/15/sp.ui.dialog.js");n.LoadExternalJsFile(e+"_layouts/15/datepicker.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.datetimeutil.js")})})};n._loadCoreJsScript=function(e){var t=n._pageContextInfo.webAbsoluteUrl+"/";if(n.quickEditPltFlightEnabled){D.global_core();e()}else n.LoadExternalJsFile(t+"_layouts/15/core.js",e.bind(n))};n._loadScriptsDependentOnStrings=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/";if(n.quickEditPltFlightEnabled){M.globalClienttemplates();n._loadScriptsDependentOnClientTemplates()}else n.LoadExternalJsFile(e+"_layouts/15/clienttemplates.js",n._loadScriptsDependentOnClientTemplates.bind(n))};n._loadScriptsDependentOnClientTemplates=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/",t="en-US";n.props.pageContext.currentUICultureName&&(t=n.props.pageContext.currentUICultureName.toString());n.LoadExternalJsFile(e+"_layouts/15/ms.rte.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.ui.rte.publishing.js",function(){});!I&&n.quickEditPltFlightEnabled||n.LoadExternalJsFile(e+"_layouts/15/sp.taxonomy.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.ui.taxonomy.js",function(){n.LoadExternalJsFile(e+"_layouts/15/scriptforwebtaggingui.js",function(){n.LoadExternalJsFile(e+"_layouts/15/ScriptResx.ashx?culture="+t.replace("-","%2D")+"&name=ScriptResources&rev=oRPNQhCzzZsnsjrrXFJTKg%3D%3D:formatted",function(){})})})})})};n._countLoadedJsFiles=function(){n._numLoadedJsFiles++;if(n._numLoadedJsFiles>=n._totalFilesToLoad){F||L.addRumOneMarker("quickEdit.loadExternalFiles.end");n.setState({isLoading:!1})}};n.onScroll=function(){var e=u.JsGridUtil.Internal.GetScrollParent(n.tableRef.current);if(e){n.jsGridControl.objBag.paneMgr.gridPane.UpdatePseudoStickyElementsForScroll(e);var t=document.getElementById("StickyColumnShadow");if(t)if(0==e.scrollLeft){if("0"!=t.style.opacity){t.style.opacity="0";t.style.visibility="hidden"}}else if("1"!=t.style.opacity){t.style.opacity="1";t.style.visibility=""}}};n.DoPagingBackward=function(e){var t=n.props,r=t.onPaging,i=t.firstRowInGrid;r&&r({firstRowInGrid:i,lastRowInGrid:i?n.rows.length+i-1:n.rows.length,isBackward:!0});return!1};n.DoPaging=function(e){var t=n.props,r=t.onPaging,i=t.firstRowInGrid;r&&r({firstRowInGrid:i,lastRowInGrid:i?n.rows.length+i-1:n.rows.length,isBackward:!1});return!1};n._constructPagingControls=function(){var e=n.props,t=e.firstRowInGrid,i=e.hasNextPage;if(e.onPaging){var s=t>1,o=i||n.rows&&n.props.rows&&n.rows.length<n.props.rows.length;if(s||o){var u=(t||1)+" - "+(t?t+n.rows.length-1:n.rows.length);return r.createElement("div",{className:c.spGridPagingFooter},s&&r.createElement(b.IconButton,{iconProps:{iconName:"ChevronLeft"},onClick:n.DoPagingBackward,title:v.default.previousPageButtonTitle}),r.createElement("span",{className:c.spGridPagingFooterContent},u),o&&r.createElement(b.IconButton,{iconProps:{iconName:"ChevronRight"},onClick:n.DoPaging,title:v.default.nextPageButtonTitle}))}}};n.onUndoRealCmdCountChange=function(e){if(n.props.getEventSource){var t=n.props.getEventSource();E.EventGroup.raise(t,S.SPGridEvents.undoRealCmdCountChangeEventName,{undoRealCmdCount:e})}};n.onRedoRealCmdCountChange=function(e){if(n.props.getEventSource){var t=n.props.getEventSource();E.EventGroup.raise(t,S.SPGridEvents.redoRealCmdCountChangeEventName,{redoRealCmdCount:e})}};n.itemResponse=JSON.parse(n.props.itemResponseJsonString);n.listData=n.itemResponse.ListData;n.listSchema=n.itemResponse.ListSchema;if(G)n.rows=t.rows;else{n.rows=[];n.TranscribeRows(t.rows)}n._additionalColumnSchema=t.additionalColumnSchema;n._customFormatterProps=t.customFormatterProps;n._telemetry=t.telemetry;n._portalManager=Q?void 0:t.portalManager;n._baseEngagementData=t.baseEngagementData;n._events=new E.EventGroup(n);n.getColumnWidthsFromLocalStorage=t.getColumnWidthsFromLocalStorage;n.quickEditPltFlightEnabled=t.flightStatus[Z];n._totalFilesToLoad=n._getTotalFilesToLoad();n._numLoadedJsFiles=0;n.tableRef=r.createRef();if(q)u.JsGridUtil.privateWpq="WPQ1";else{var i=document.getElementsByClassName("quickEditParentDiv");u.JsGridUtil.privateWpq="WPQ"+(i.length+1).toString()}n.dragDropMgr=new N.ColumnDragDropManager({telemetry:n._telemetry,baseEngagementData:n._baseEngagementData,events:n._events,onColumnChangeSucceeded:t.onColumnChangeSucceeded});if(n._additionalColumnSchema)for(var s=0,o=n._additionalColumnSchema;s<o.length;s++){var a=o[s];n._additionColumnSchemaMap[a.internalName]=a}n.props.pageContext?n._pageContextInfo=n.props.pageContext:n.itemResponse.PageContextInfo?n._pageContextInfo=JSON.parse(n.itemResponse.PageContextInfo):console.log("WARNING!! No page context!");u.JsGridUtil._gridutilPageContextKillswitchIsActive||(u.JsGridUtil.PageContext=n._pageContextInfo);Y||n._pageContextInfo&&(u.JsGridUtil.SpRegionalSettings.localeId=n._pageContextInfo.currentCultureLCID);if(t.gridInitInfo){n.gridInitInfo.controllerId=t.gridInitInfo.ControllerId;n.gridInitInfo.jsInitObj=JSON.parse(t.gridInitInfo.JsInitObj);n.viewId=n.gridInitInfo.jsInitObj.viewId;n.itemResponse&&n.itemResponse.rootFolder&&(n.gridInitInfo.jsInitObj.viewRootFolder=n.itemResponse.rootFolder);n.gridInitInfo.gridSerializer=t.gridInitInfo.GridSerializer;n.gridInitInfo.jsInitObj.iframeId="spgridIframeId";n.gridInitInfo.jsInitObj.flightStatus=n.props.flightStatus}n.setColumnWidthsToLocalStorage=function(e,r){var i=n.viewId.substring(1,n.viewId.length-1);t.setColumnWidthsToLocalStorage(i,e,r)};n.itemResponse.ListData.Row&&n.itemResponse.ListData.Row[0]&&n._addPageId(n.itemResponse.ListData.Row[0].ID);n.state={isLoading:n._shouldWaitLoadExternalJsFiles()};return n}t.prototype.TranscribeRows=function(e){for(var t=0;t<e.length;t++){for(var n=!1,r=0;r<t;r++)e[t].ID===e[r].ID&&(n=!0);n||this.rows.push(e[t])}};t.prototype._startGridLoadSequence=function(){var e=this,t=this.props.flightStatus,n=this._pageContextInfo.webAbsoluteUrl+"/",r="1033";z?this.props.pageContext.currentLanguage&&(r=this.props.pageContext.currentLanguage.toString()):this._pageContextInfo.currentLanguage&&(r=this._pageContextInfo.currentLanguage.toString());F||L.addRumOneMarker("quickEdit.loadExternalFiles.start");t[ee]&&!U||this.LoadExternalCssFile(n+"_layouts/15/styles/Themable/jsgrid.css","jsgridcss");!I&&this.quickEditPltFlightEnabled||this.LoadExternalCssFile(n+"_layouts/15/"+r+"/styles/WebTaggingUI.css","taxonomycss");this.GetRegionalSettings(this.props.pageContext.webServerRelativeUrl,null);this.LoadExternalJsFile(se,function(){e.LoadExternalJsFile("https://ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjaxWebForms.js",function(){if(e.quickEditPltFlightEnabled){P.globalInit();e._loadScriptsDependentOnInit()}else e.LoadExternalJsFile(n+"_layouts/15/init.js",e._loadScriptsDependentOnInit.bind(e))})})};t.prototype.LoadClassicStrings=function(){window.Strings=window.Strings||{STS:y.default};window.Strings.STS=y.default;window.Strings.STS.L_RelativeDateTime_Format_DateTimeFormattingString_Override="";window.SP=window.SP||{};window.SP.Res=window.SP.Res||m.default;window.SP.JsGrid=window.SP.JsGrid||{Res:g.default,Image:{},Utility:{},PropertyType:{}};window.SP.JsGrid.Res=window.SP.JsGrid.Res||g.default};t.prototype._startInitSequence=function(){var e=this;F||L.addRumOneMarker("quickEdit.serialization.start");var t=document.getElementById("spgridcontainer_"+u.JsGridUtil.privateWpq);if(t&&0===t.childElementCount){this._registerGlobals();window.modernJsGrid=this;PageMinimized.minimized=!0;this.gridInitInfo&&this.gridInitInfo.jsInitObj&&this.gridInitInfo.jsInitObj.viewId&&(window.g_SPGridInitInfo[this.gridInitInfo.jsInitObj.viewId]=this.gridInitInfo);u.JsGridUtil.Internal.SiteUrl=this.gridInitInfo.jsInitObj.siteUrl;var n={crsAjaxRefresh:!0,currentCtx:this.itemResponse};n.currentCtx.enteringGridMode=!0;n.currentCtx.wpq=u.JsGridUtil.privateWpq;var r={Fields:{}},i=void 0;i=this.quickEditPltFlightEnabled?M.RenderFieldValueDefault:window.RenderFieldValueDefault;for(var s=0;s<this.listSchema.Field.length;s++){var o=this.listSchema.Field[s];if(!V&&"LinkTitle"===o.Name){o.Name=o.StaticName="Title";o.Type=o.FieldType=o.role="Text"}r.Fields[o.Name]=i}n.currentCtx.Templates=r;var a=window.CLVPFromEventReal(n);this.oldReRenderListView=window.ReRenderListView;window.ReRenderListView=this.CatchContext.bind(this);window.CLVPRefreshPagingEx.bind(a)("?",!0,null,void 0,void 0);this.props.getAuthToken(this._pageContextInfo.webAbsoluteUrl).then(function(t){e._setAuthToken(t)});this.quickEditPltFlightEnabled||(GetThemedImageUrl=u.JsGridUtil.Internal.GetImageUrl);this.InitGrid()}};t.prototype._registerGlobals=function(){if(this.quickEditPltFlightEnabled){window.ReRenderListView=_.ReRenderListView;window.CLVPRefreshPagingEx=_.CLVPRefreshPagingEx;window.CLVPFromEventReal=_.CLVPFromEventReal;window.g_fAnimateListCSR=!1;SP&&SP.UI&&!SP.UI.Notify&&(SP.UI.Notify={addNotification:window.addNotification})}SP&&SP.JsGrid&&(SP.JsGrid.Image=u.JsGridUtil.Image);if(SP&&SP.JsGrid&&!SP.JsGrid.Utility){SP.JsGrid.Utility={};SP.JsGrid.Utility.IsChar=u.JsGridUtil.Utility.IsChar}this.quickEditPltFlightEnabled&&SP&&!SP.ScriptUtility&&(SP.ScriptUtility={isNullOrEmptyString:k.Taxonomy.Utility.isNullOrEmpty,isNullOrUndefined:k.Taxonomy.Utility.isNullOrUndefined,isUndefined:k.Taxonomy.Utility.isUndefined});this.quickEditPltFlightEnabled&&SP&&!SP.Utilities&&(SP.Utilities={});SP&&SP.Utilities&&(SP.Utilities.Range=a.Range);SP&&SP.JsGrid&&(SP.JsGrid.PropertyType={Utils:{RegisterEditControl:f.PropertyType.Utils.RegisterEditControl,RegisterWidgetControl:f.PropertyType.Utils.RegisterWidgetControl},RegisterNewCustomPropType:f.PropertyType.RegisterNewCustomPropType});var e=document.getElementById("__REQUESTDIGEST");if(!e){(e=document.createElement("INPUT")).id="__REQUESTDIGEST";e.name="__REQUESTDIGEST";e.type="hidden";e.value=this.props.pageContext.formDigestValue;document.body.appendChild(e)}!W&&SP&&SP.JsGrid&&(SP.JsGrid.DisplayControl={Type:{Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX",CSR:"DISP_CSR",User:"DISP_USER"}});M.InitListViewFlightSettings()};t.prototype._switchLayout=function(e){if(this.props.flightStatus[ee]&&this.props.flightStatus[te]){var t=e.viewType;this.gridInitInfo.jsInitObj.spCsrRenderCtx.fixedHeightRowEnabled="GRIDFIXED"===t;this.jsGridControl.RefreshAllRows(0,void 0)}};t.prototype.InitFromRenderContext=function(e){this.setState({isLoading:!0});this.listData=e.ListData;this.rows=e.ListData.Row;this.CatchContext(e);this.listSchema=e.ListSchema;if(this.didPage){this._addPageId(e.CurrentItem.ID);this.didPage=!1}this._startGridLoadSequence()};t.prototype._setAuthToken=function(e){var t=this;if(e){this._authToken="Bearer "+e;var n=this._authToken,r=SP.ClientRuntimeContext.prototype.onExecutingWebRequest;this._oldOnExecuting=SP.ClientRuntimeContext.prototype.onExecutingWebRequest;console.log(this._authToken+this._oldOnExecuting);SP.ClientRuntimeContext.prototype.onExecutingWebRequest=function(e){var i=r.bind(t);e.get_webRequest()._headers.Authorization=n;i(e)}}};t.prototype.CatchContext=function(e){this.renderCtx=e;window.ReRenderListView=this.oldReRenderListView;if(!this.quickEditPltFlightEnabled){g_ctxDict["{"+this.viewId.toUpperCase()+"}"]=e;g_ctxDict["ctx"+e.ctxId]=e}window["ctx"+e.ctxId]=e;currentCtx=e};t.prototype.LoadExternalCssFile=function(e,t){var n=document.getElementsByTagName("head")[0],r=document.createElement("link");r.id=t;r.rel="stylesheet";r.type="text/css";r.href=e;r.media="all";n.appendChild(r)};t.prototype._getTotalFilesToLoad=function(){var e=23;if(this.quickEditPltFlightEnabled){I||(e-=8);R||(e-=3);e-=2;e-=1;e-=1;e-=1}return e};t.prototype.LoadExternalJsFile=function(e,t){u.JsGridUtil.injectJsScript(e,this._countLoadedJsFiles.bind(this),t)};t.prototype.GetRegionalSettings=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){console.log(n.responseText);if(n.responseText){var e=JSON.parse(n.responseText);if(e.value){var t=JSON.parse(e.value);u.JsGridUtil.SpRegionalSettings.adjustHijriDays=t.HijriAdjustment;u.JsGridUtil.SpRegionalSettings.calendarType=t.CalendarType;u.JsGridUtil.SpRegionalSettings.currentDateInLocalCalendar=new Date;u.JsGridUtil.SpRegionalSettings.firstDayOfWeek=t.FirstDayOfWeek;u.JsGridUtil.SpRegionalSettings.firstWeekOfYear=t.FirstWeekOfYear;u.JsGridUtil.SpRegionalSettings.localeId=t.LocaleId;u.JsGridUtil.SpRegionalSettings.showWeeks=t.ShowWeekNumber;u.JsGridUtil.SpRegionalSettings.time24=t.HoursMode24;u.JsGridUtil.SpRegionalSettings.timeZone=t.TimeZoneDifference;u.JsGridUtil.SpRegionalSettings.timeZoneInHours=parseInt(t.TimeZoneDifference);u.JsGridUtil.SpRegionalSettings.workDays=t.WorkWeek;window._spRegionalSettings=u.JsGridUtil.SpRegionalSettings}}}};var r=(e+"/_api/web/GetRegionalDateTimeSchema").replace(/\/\//g,"/");n.open("POST",r,!0);n.setRequestHeader("Content-Type","application/json;charset=utf-8");n.setRequestHeader("ACCEPT","application/json; odata.metadata=minimal");this._pageContextInfo.formDigestValue&&n.setRequestHeader("x-requestdigest",this._pageContextInfo.formDigestValue);n.setRequestHeader("ODATA-VERSION","4.0");n.send(t?JSON.stringify(t):void 0)};t.prototype.InitGrid=function(){var e,t=this,r=new(this._telemetry(x.Qos))({name:oe}),a=this.gridInitInfo,f=document.getElementById("spgridcontainer_"+u.JsGridUtil.privateWpq);if(f){try{this.gridJson=i.DeserializeFromJson(a.gridSerializer)}catch(e){var l=H.getErrorMessage(e);r.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToDeserializeFromJsonString",error:l});console.log("SPGrid FailToDeserializeFromJsonString: "+l);return}try{if(this._additionalColumnSchema&&this._additionalColumnSchema.length&&this._additionColumnSchemaMap&&this.gridJson.Columns)for(var c=0,v=this.gridJson.Columns;c<v.length;c++){var m=v[c];if(j){if(g=this._additionColumnSchemaMap[m.columnKey]){m.customFormatter=g.customFormatter;m.isFilterable=g.filterable;m.ascendingString=g.ascendingString;m.descendingString=g.descendingString;m.fieldType=g.fieldType;m.internalName=g.internalName;m.isEditable=g.isEditable;m.isCalculated=g.isCalculated}}else{var g,y=u.JsGridUtil.Internal.normalizeColumnKey(m.columnKey);if(g=this._additionColumnSchemaMap[y]){m.customFormatter=g.customFormatter;m.isFilterable=g.filterable;m.ascendingString=g.ascendingString;m.descendingString=g.descendingString;m.fieldType=g.fieldType;m.internalName=g.internalName;m.isEditable=g.isEditable;m.isCalculated=g.isCalculated}}if(!V&&"LinkTitle"===m.fieldKey){m.fieldKey=m.columnKey=m.internalName="Title";m.fieldKeys=["Title"];m.isEditable=!0;m.fieldType="Text"}}if(!V&&this.gridJson&&this.gridJson.Fields)for(var b=0,E=this.gridJson.Fields;b<E.length;b++){var N=E[b];if("LinkTitle"===N.fieldKey){N.fieldKey="Title";N.editMode=T.JsGridConstants.EditMode.ReadWriteDefer;break}}if(this.viewId&&this.gridJson.Columns)for(var k=this.viewId.substring(1,this.viewId.length-1),M=this.viewId&&this.getColumnWidthsFromLocalStorage(k)||{},_=this.viewId&&this.getColumnWidthsFromLocalStorage(k,!0)||{},D=0,P=this.gridJson.Columns;D<P.length;D++){var B=(m=P[D]).name,I=parseInt(_[B],10)||parseInt(M[B],10);I&&(m.width=I+T.JsGridConstants.Internal.ColumnWidthOffset)}if(u.JsGridUtil.Internal.IsStickyColumnFlightEnabled()){this.gridJson.Columns.length&&"DocIcon"===this.gridJson.Columns[0].internalName?u.JsGridUtil.Internal.stickyLastColIdx=1:u.JsGridUtil.Internal.stickyLastColIdx=0;u.JsGridUtil.Internal.GetStickyDataColumnsWidth(this.gridJson.Columns)+u.JsGridUtil.Internal.stickyLeftEdgeOffset>u.JsGridUtil.Internal.GetScrollParent(this.tableRef.current).clientWidth/2?u.JsGridUtil.Internal.noSizeForSticky=!0:u.JsGridUtil.Internal.noSizeForSticky=!1}if(!F){L.addRumOneMarker("quickEdit.serialization.end");L.addRumOneMarker("quickEdit.gridrender.start")}this.callback=function(e){var r,i=t.jsGridControl=new s.JsGridControl(f,a.showLoading,{setColumnWidthsToLocalStorage:t.setColumnWidthsToLocalStorage.bind(t),dragDropMgr:t.dragDropMgr,onSelectionChanged:t.props.onSelectionChanged});a.jsInitObj.spCsrRenderCtx=t.renderCtx;a.jsInitObj.spCsrRenderCtx.queryString="";a.jsInitObj.peoplePickerDataSource=new p.PeoplePickerDataSource({},{pageContext:t._pageContextInfo,getAuthToken:t.props.getAuthToken});a.jsInitObj.locationDataSource=new d.LocationDataSource({pageContext:t._pageContextInfo});a.jsInitObj.taxonomyPickerDataSource=new C.TaxonomyDataSource(t._pageContextInfo);a.jsInitObj.pageContext=t._pageContextInfo;a.jsInitObj.customFormatterProps=t._customFormatterProps;a.jsInitObj.telemetry=t._telemetry;a.jsInitObj.portalManager=t._portalManager;a.jsInitObj.onLaunchFilterPanel=t.props.onLaunchFilterPanel;a.jsInitObj.onSort=t.props.onSort;a.jsInitObj.launchColumnCustomization=t.props.launchColumnCustomization;a.jsInitObj.launchColumnsEditor=t.props.launchColumnsEditor;a.jsInitObj.onLaunchColumnManagementPanel=t.props.onLaunchColumnManagementPanel;a.jsInitObj.baseEngagementData=t._baseEngagementData;a.jsInitObj.onColumnChangeSucceeded=t.props.onColumnChangeSucceeded;a.jsInitObj.onPinToFiltersPane=t.props.onPinToFiltersPane;a.jsInitObj.onUndoRealCmdCountChange=t.onUndoRealCmdCountChange;a.jsInitObj.onRedoRealCmdCountChange=t.onRedoRealCmdCountChange;t.props.flightStatus[ee]&&t.props.flightStatus[te]&&"GRIDFIXED"===t.props.gridLayoutType&&(a.jsInitObj.spCsrRenderCtx.fixedHeightRowEnabled=!0);var l=new(t._telemetry(x.Qos))({name:ue});try{var c=t.ganttControl=new o.GanttControl(t._telemetry,t._pageContextInfo.aadUserId);window[a.controllerId]=c;window[a.controllerId].Init(i,e,a.jsInitObj,a.pagingInfo);t.dragDropMgr.setGanttControl(c);t.dragDropMgr.setPaneManager(i._GetPaneManager());t._events.on(document,S.SPGridEvents.startExitingQuickEditEventName,function(){c.TryDispose(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){this.props.completeExitingQuickEditSignal&&this.props.completeExitingQuickEditSignal.resolve();window[a.controllerId]=null;return[2]})})})});if(t.props.getEventSource){var v=t.props.getEventSource();t._events.on(v,S.SPGridEvents.switchGridLayout,t._switchLayout);t._events.on(v,S.SPGridEvents.deleteCompletedEventName,function(e){e&&e.itemIds&&e.itemIds.length&&i.DeleteRecords(e.itemIds,null)});t._events.on(v,S.SPGridEvents.undoChangeEventName,function(){i.objBag.eventMgr.FireEvent(S.SPGridEvents.undoChangeEventName)});t._events.on(v,S.SPGridEvents.redoChangeEventName,function(){i.objBag.eventMgr.FireEvent(S.SPGridEvents.redoChangeEventName)});t._events.on(v,O.FiltersPaneEvents.showInFiltersPaneChanged,function(e){var t=e.fieldName,n=e.showInFiltersPane,r="LinkTitle"===t?"Title":t;u.JsGridUtil.Internal.getColumnFromListSchema(i,r).ShowInFiltersPane=A.ShowInFiltersPaneStatus[n]})}l.end({resultType:x.ResultTypeEnum.Success})}catch(e){var m=H.getErrorMessage(e);J||(m=(null===(r=e)||void 0===r?void 0:r.stack)||m);l.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToInitGanttControl",error:m});console.log("SPGrid FailToInitGanttControl: "+m)}window.setTimeout(function(){i.Focus()},0);if(null!=a.selectedRows&&1!=a.selectedRows.length||t._pageContextInfo.listBaseTemplate!==h.default.tasksWithTimelineAndHierarchy){if(null!=a.selectedRows)for(var g=0;g<a.selectedRows.length;g++)i.SelectRowRangeByKey(a.selectedRows[g],a.selectedRows[g],0!==g)}else{var y=null==a.selectedRows?i.GetTopRecordIndex():i.GetViewIndexOfRecord(a.selectedRows[0]),b=i.GetColumns();b.length>1&&"Checkmark"==b[0].columnKey?i.SelectCellRange(y,y,1,1,!1):i.SelectRowRange(y,y,!1)}if(!w.Killswitch.isActivated("BF732B58-C4BB-4AE6-8E1F-F245243C8E51","05/13/2020","Keep selected items after entering quick edit view")&&t.props.selectedItemIds)for(g=0;g<t.props.selectedItemIds.length;g++)i.SelectRowRangeByKey(t.props.selectedItemIds[g],t.props.selectedItemIds[g],0!==g);g_fAnimateListCSR=!1;null!=a.fnCallback&&a.fnCallback(window[a.controllerId]);if(u.JsGridUtil.Internal.IsStickyColumnEnabled()){u.JsGridUtil.Internal.GetScrollParent(t.tableRef.current).addEventListener("scroll",t.onScroll)}window.setTimeout(function(){F||L.addRumOneMarker("quickEdit.gridrender.end");t.PostRenderAfterJSGridRender(t.renderCtx);if(!F){L.addRumOneMarker("quickEdit.plt.end");L.writeRumOneData()}},0)};this.TranslateCSRtoJsGrid(this.listData,this.rows,this.gridJson,this.listSchema,this.renderCtx);this.callback(this.gridJson);r.end({resultType:x.ResultTypeEnum.Success})}catch(t){l=H.getErrorMessage(t);J||(l=(null===(e=t)||void 0===e?void 0:e.stack)||l);r.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToInitGrid",error:l});console.log("SPGrid FailToInitGrid: "+l)}}else r.end({resultType:x.ResultTypeEnum.Failure,resultCode:"MissingContainerElement",error:"Cannot init grid due to missing container element."})};t.prototype.PostRenderAfterJSGridRender=function(e){e.enteringGridMode=!1;this.quickEditPltFlightEnabled?M.SPClientRenderer._ExecuteRenderCallbacks(e,"OnPostRender"):window.SPClientRenderer._ExecuteRenderCallbacks(e,"OnPostRender")};t.prototype._shouldWaitLoadExternalJsFiles=function(){return!document.getElementById(se)};t.prototype.componentDidMount=function(){this._shouldWaitLoadExternalJsFiles()?this._startGridLoadSequence():u.JsGridUtil._gridWaitFullLoadEventKillSwitchIsActive||M.spMgr?this._startInitSequence():this._events.on(document,S.SPGridEvents.gridGlobalsInitialized,this._startInitSequence);this.dragDropMgr.subscribe()};t.prototype.shouldComponentUpdate=function(e,t){this.props.flightStatus[re]&&this.handleCustomFormatter(e);return t!==this.state||e.refreshedRows!==this.props.refreshedRows};t.prototype.componentDidUpdate=function(e,t){t.isLoading&&!this.state.isLoading?this._startInitSequence():e.refreshedRows!==this.props.refreshedRows&&this.updateWithRefreshedRows();this.dragDropMgr.subscribe()};t.prototype.componentWillUnmount=function(){if($){this._events.dispose();this.dragDropMgr.dispose();if(u.JsGridUtil.Internal.IsStickyColumnEnabled()){u.JsGridUtil.Internal.GetScrollParent(this.tableRef.current).removeEventListener("scroll",this.onScroll)}}else try{this.ganttControl&&this.ganttControl._jsGridControl&&this.ganttControl._jsGridControl._GetPaneManager().editMgr.unBindEditors();this._events.dispose();this.dragDropMgr.dispose();if(u.JsGridUtil.Internal.IsStickyColumnEnabled()){u.JsGridUtil.Internal.GetScrollParent(this.tableRef.current).removeEventListener("scroll",this.onScroll)}}catch(e){}};t.prototype.TranslateCSRtoJsGrid=function(e,t,n,r,i){var s,o,a,f,l,c,h,p,d=this,v={},m={},g=r.Field,y=g.length,b={},w=n.Fields,E=w.length,S=null,x=t.length,T=0,N=[],C=0,k=null,L=null,A=null,O=null,_=null,D=null,P=null,H=0,B=null==i;function j(t,r){if("string"==typeof e[r])if("?"==e[r].substring(0,1))n.AdditionalParams[t]=e[r].substring(1);else{var i=e[r].split("?");n.AdditionalParams[t]=i[1]}else n.AdditionalParams[t]=null}j("prevHref","PrevHref");j("nextHref","NextHref");function F(t,r){if("string"==typeof e[r])n.AdditionalParams[t]=Number(e[r]);else if("number"==typeof e[r])n.AdditionalParams[t]=e[r];else{u.JsGridUtil.DebugAssert(null==e[r]);n.AdditionalParams[t]=null}}F("first","FirstRow");F("last","LastRow");if("string"==typeof r.group1){C=1;L=r.group1;_=n.MetaData.GroupingPrefix;P=[];if("string"==typeof r.group2){C=2;A=r.group2}n.MetaData.GroupingLevel=C;O=n.MetaData.GridOperationalConstantsFieldKeyMap[0]=n.Columns[0].fieldKey;delete n.RecordCount;delete n.TopRecord}for(o=0;o<E;o++){"SPUser"!=w[o].propertyTypeId&&"SPUser_MultiValue"!=w[o].propertyTypeId&&"Location"!=w[o].propertyTypeId||(w[o].hasDataValue=!0);b[(a=w[o]).fieldKey]=a}for(o=0;o<y;o++)m[(a=g[o]).RealFieldName]=a;if(x>0){for(o=0,l=null;o<x&&(null==l||Boolean(l["CustomData."]));o++)l=t[o];for(s in l){h=this.TranslateCSRtoJsGridFieldName(s,m[s]);v[s]=h;null!=m[s]&&(v[m[s].Name]=h)}if("string"==typeof e.FilterLink){u.JsGridUtil.DebugAssert("?"==e.FilterLink.substring(0,1));var I=e.FilterLink.substring(1),q=new u.JsGridUtil.Internal.List_QstringStruct(I),R={};for(var U in q.filterParams){var z=q.filterParams[U],W=null,X=null;if(null!=z.FilterField){u.JsGridUtil.DebugAssert(null!=z.FilterValue);W=z.FilterField;X=z.FilterValue}else{u.JsGridUtil.DebugAssert(null!=z.FilterFields);u.JsGridUtil.DebugAssert(null!=z.FilterValues);W=z.FilterFields;X=z.FilterValues}W=v[u.JsGridUtil.Internal.UnescapeProperly(W)];X=u.JsGridUtil.Internal.UnescapeProperly(X);u.JsGridUtil.DebugAssert(null!=W);null!=W&&(R[W]=X)}n.AutoFilterState=R}}if(Boolean(e.SortField)){var V=v[e.SortField];null==V&&(V=e.SortField);n.SortState=[{fieldKey:V,isDescending:"ascending"!=e.SortDir}]}n.LocalizedTable=[];n.UnlocalizedTable=[];for(o=0;o<x;o++){l=t[o];if(Boolean(l["CustomData."]))T++;else{H++;if(C>0){var $=function(e,t,n){return _+l[e+".groupindex"+(2==n?"2":"")]+"_"+t},J=function(e,t){var r;if(B){r=e+": "+String(l[e]);if(1==t)D=_+" "+e+":"+String(l[e]);else{u.JsGridUtil.DebugAssert(2==t);D=_+" "+L+":"+String(l[L])+" "+A+":"+String(l[A])}}else{var s=document.createElement("div");if(1==t)d.quickEditPltFlightEnabled?s.innerHTML=M.RenderGroupEx(i,l,!0):s.innerHTML=window.RenderGroupEx(i,l,!0);else{u.JsGridUtil.DebugAssert(2==t);var o=l[L+".newgroup"];l[L+".newgroup"]="0";d.quickEditPltFlightEnabled?s.innerHTML=M.RenderGroup(i,l):s.innerHTML=window.RenderGroup(i,l);l[L+".newgroup"]=o}r=u.JsGridUtil.Internal.GetInnerText(s);if(1==t)D=$(e,r,1);else{u.JsGridUtil.DebugAssert(2==t);D=$(L,r,1)+" "+$(A,r,2)}}u.JsGridUtil.DebugAssert(-1==P.indexOf(D));f={};p={ID:D,_GRPDESC:Number(l[e+".COUNT.group"+(2==t?"2":"")])};2==C&&(p._GRPLVL=t);if(2==t){u.JsGridUtil.DebugAssert(null!=k);k._GRPDESC++}else k=p;p[O]=f[O]=r;n.LocalizedTable.push(f);n.UnlocalizedTable.push(p);P.push(D);N.push(D)};"1"==l[L+".newgroup"]&&J(L,1);"1"==l[A+".newgroup"]&&J(A,2)}f={};p={};N.push(this.TranslateCSRtoJsGridField("ID",m.ID,l,b.ID).value);for(s in l){var K=m[s],Q=null==K?null:v[K.Name];S=null==Q?null:b[Q];if(null!=(c=this.TranslateCSRtoJsGridField(s,K,l,S))&&null!=(a=b[h=v[s]])){if(a.hasLocalizedValue){u.JsGridUtil.DebugAssert(null!=c.localizedValue);f[h]=c.localizedValue}if(a.hasDataValue||C>0&&"Title"==h){u.JsGridUtil.DebugAssert(null!=c.value);p[h]=c.value}}}B||(p.csrInfo=l);n.LocalizedTable.push(f);n.UnlocalizedTable.push(p)}}if(!B)for(o=0;o<n.Fields.length;o++)(S=n.Fields[o]).csrInfo=m[S.fieldKey];n.ViewInfo=N;C>0?n.ViewDepKeys=P:n.RecordCount=H;n.AdditionalParams.last-=T};t.prototype.handleCustomFormatter=function(e){var t=this,n=!1;if(this.jsGridControl){var r=this.jsGridControl._GetPaneManager(),i=r&&r.gridPane;if(i&&i.tableMgr)for(var s=0,o=i.tableMgr.columns;s<o.length;s++)for(var a=o[s],f=0,l=e.additionalColumnSchema;f<l.length;f++){var c=l[f];if(c.internalName===u.JsGridUtil.Internal.normalizeColumnKey(a.columnKey,!0)&&c.customFormatter!==a.customFormatter){a.customFormatter=c.customFormatter;n=!0;c.customFormatter?a.fnGetDisplayControlName=function(){return B.DisplayControlType.CustomFormatter}:this.jsGridControl.objBag.jsGridParams.bRecordIndicatorCheckboxesEnabled?a.fnGetDisplayControlName=function(){return t.jsGridControl.objBag.gridControls[T.JsGridConstants.RecordIndicatorControlId].Id}:a.fnGetDisplayControlName=void 0;break}}var h=e.customFormatterProps,p=this.props.customFormatterProps;if(p&&h&&p.additionalRowClass!==h.additionalRowClass){this.jsGridControl.objBag.jsGridParams.customFormatterProps.additionalRowClass=e.customFormatterProps.additionalRowClass;n=!0}n&&this.jsGridControl.RefreshAllRows(0,void 0)}};t.prototype.TranslateCSRtoJsGridFieldName=function(e,t){switch(null!=t?t.FieldType:e){case"ContentTypeId":return"_ContentTypeId";case"File_x0020_Type":return"DocIcon";case"PermMask":return"Edit"}return null!=t&&"string"==typeof t.RealFieldName?t.RealFieldName:e};t.prototype.TranslateCSRtoJsGridField=function(e,t,n,r){var i,s=n[e];if(null!=r&&("SPMultilineText"==r.propertyTypeId||"String"==r.propertyTypeId||"SPTextMaxLength"==r.propertyTypeId)){u.JsGridUtil.Internal.IsNullOrUndefined(s)||u.JsGridUtil.DebugAssert("string"==typeof s||s.constructor==String);s=u.JsGridUtil.Internal.Encoding_STSHtmlDecode(s)}var o=null!=t?t.FieldType:e;if(null==s)return null;if(null==o)return null;switch(o){case"Boolean":return null==s||""==s?null:new le(n[e+".value"],s);case"Computed":if("FileLeafRef"==e){u.JsGridUtil.Internal.EnsureFileLeafRefName(n);return new le(null,n["FileLeafRef.Name"])}if("Hyperlink"==t.Format)return y(e,s,n);break;case"File_x0020_Type":return""==s?null:new le(null,s);case"ID":return new le(Number(s),String(s));case"Lookup":case"LookupMulti":if(""==s)return null;if("string"==typeof s)return new le(s);var a=s,f=[];s=null;for(i=0;i<a.length;i++){var l=a[i],c=l.lookupId,h=l.lookupValue;if("Lookup"==o)return new le(c,h);s=null==s?h:s+"; "+h;f.push(c)}return new le(f,s);case"MultiChoice":return Array.isArray(s)?new le(s.join("; ")):new le("");case"PermMask":var p=0|parseInt(s.substring(s.length-8),16);n.Edit=p;return new le(p);case"URL":return y(e,s,n);case"User":case"UserMulti":var d=n[e];s=[];var v="";for(i=0;i<d.length;i++){var m=d[i];v=""==v?m.title:v+"; "+m.title;s.push(b(m))}return new le(s,v);case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":var g=k.Taxonomy.DataConverters.DataValueToInputValue(s,"TaxonomyFieldTypeMulti"==o);return new le(s,g);case"Location":return new le(s,s?s.DisplayName:"")}return null==s||""==s?null:new le(s);function y(e,t,n){if(null==t||""==t)return null;var r=t,i=n[e+".desc"];return new le({display:i,address:r})}function b(e){if(null==e||""==e)return null;u.JsGridUtil.DebugAssert("email"in e&&"title"in e,"caller did not pass in the right user object");return{display:e.title,email:e.email}}};t.prototype._addPageId=function(e){this.previousPageIds[this.currentPageIdx]=e};t.prototype.render=function(){for(var e=[],t=0;t<this.listSchema.Field.length;t++)e.push(r.createElement("th",{scope:"col",title:"",role:"presentation"},r.createElement("span",null)));this.dragDropMgr.subscribe();var i=this.props.flightStatus[ne]&&!X,s=this.props.flightStatus[ie],o=s?c.gridParentFocusable:"",a=i?c.wrapperTable:"",f=i?c.wrapperTd:"",h={};K||(h.tabIndex=-1);return this.state.isLoading?r.createElement(l.Spinner,{size:l.SpinnerSize.large}):r.createElement("div",{className:c.spGridRoot},r.createElement("iframe",n.__assign({id:"spgridIframeId",title:"","aria-hidden":"true",style:{offsetLeft:"-550px",offsetTop:"-550px",display:"block",width:0,height:0,frameborder:0}},h)," "),r.createElement("table",{className:a,summary:"Custom list",ref:this.tableRef},r.createElement("thead",{role:"presentation",id:"js-listviewthead-"+u.JsGridUtil.privateWpq,className:c.spGridTableHead},r.createElement("tr",{role:"row",className:"ms-viewheadertr ms-vhltr"},r.createElement("th",{className:"ms-headerCellStyleIcon ms-vh-icon ms-vh-selectAllIcon",scope:"col",role:"columnheader"},r.createElement("span",{className:"ms-selectall-span",id:"cbxSelectAllItems2",title:"Select and deselect all items",role:"checkbox","aria-checked":"false","aria-label":"Press space key to select all items on this list"},r.createElement("span",{className:"ms-selectall-iconouter"},r.createElement("img",{className:"ms-selectall-icon",alt:"",src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey="})))),r.createElement("th",{scope:"col",role:"columnheader"},r.createElement("div",null,r.createElement("a",{id:"diidSort2LinkTitle",title:"Title, Click to sort by Title"},"Title"),r.createElement("span",{id:"diidSortArrowSpan2LinkTitle"},r.createElement("img",{src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey=",alt:""})),r.createElement("span",{id:"diidFilterSpan2LinkTitle"},r.createElement("img",{src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey=",alt:""}))),r.createElement("div",null,r.createElement("div",null,r.createElement("span",null," "),r.createElement("a",{href:"javascript:;",title:"Open Title sort and filter menu","aria-expanded":"false"},r.createElement("img",{src:"/_layouts/15/images/ecbarw.png?rev=44#ThemeKey=",alt:"Open Title sort and filter menu","ms-jsgrid-click-passthrough":"true"})),r.createElement("span",null)))),e)),r.createElement("script",{id:"scriptBody"+u.JsGridUtil.privateWpq}),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",{className:f},s&&r.createElement("div",{id:"gridFocusEntryPoint"+u.JsGridUtil.privateWpq,tabIndex:0,role:"button",className:c.gridFocusEntryPoint},v.default.gridFocusEntryPoint),r.createElement("div",{id:"spgridcontainer_"+u.JsGridUtil.privateWpq,className:o}))))),this._constructPagingControls())};t.prototype.updateWithRefreshedRows=function(){var e=this.props.refreshedRows;if(e&&e.length&&this.jsGridControl&&this.ganttControl){var t=new(this._telemetry(x.Qos))({name:ae});try{var r={Fields:this.gridJson.Fields,AdditionalParams:n.__assign({},this.gridJson.AdditionalParams)};this.TranslateCSRtoJsGrid({},e,r,this.listSchema);for(var i=0;i<e.length;i++){var s=e[i],o=this.jsGridControl.GetRecord(s.ID),u=this.ganttControl.MakeRecord(r.UnlocalizedTable[i],r.LocalizedTable[i]);u&&!u.fieldRawDataMap&&(u.fieldRawDataMap={});u.fieldRawDataMap.csrInfo=s;if(o){o.properties=u.properties;o.fieldRawDataMap=u.fieldRawDataMap;o.fieldRawLocMap=u.fieldRawLocMap;this.jsGridControl.RefreshRow(o.recordKey)}else{var a=this.jsGridControl.GetRecordKeyByViewIndex(0);this.jsGridControl.InsertRecordBefore(a,u,null);this.rows.unshift(s)}}t.end({resultType:x.ResultTypeEnum.Success})}catch(e){var f=H.getErrorMessage(e);t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToUpdateWithRefreshedRows",error:f})}}};return t})(r.Component);t.default=fe;var le=function(e,t){this.value=e;if(null!=t){this.localizedValue=t;this.localizedValueSetExplicitly=!0}else{this.localizedValue=e;this.localizedValueSetExplicitly=!1}}});
define("JGe",["require","exports","eGe","cGe","hGe","oGe","pze","bGe","SGe","XGe"],function(require,exports,constants_1,gridutil_1,ColumnInfo_1,property_1,control_1,styles_1,jsgridobj_1,JSONParse_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var NumberUnitFlight={ODB:1300},BooleanVisualRefreshFlight={ODB:1740},Deserializer=(function(){function e(e,t,n){this.keyColumnName=n;this._serializedJsGridData=e;this._initType=t;this.Init()}e.prototype.InitJsGridParams=function(e){var t=null!=e?e:new jsgridobj_1.JsGridControlParameters({});t.tableViewParams=this.InitJsGridTableViewParams(t.tableViewParams);return t};e.prototype.InitJsGridTableViewParams=function(e){var t=null!=e?e:new jsgridobj_1.TableViewParameters;t.operationalConstantsFieldKeyMap=this.operationalConstantsFieldKeyMap;t.gridFieldMap=this.gridFieldMap;t.paneLayout=this.paneLayout;t.keyFieldName=this.keyColumnName;t.bAutoFilterableColumns=this.bAutoFilterableColumns;null!=this.columns&&(t.columns=new ColumnInfo_1.ColumnInfoCollection(this.columns));this.isGanttEnabled&&(t.ganttParams=this.InitJsGridGanttParams(t.ganttParams));t.rowViewParams=this.InitJsGridRowViewParams(t.rowViewParams);return t};e.prototype.InitJsGridRowViewParams=function(e){var t=null!=e?e:new jsgridobj_1.RowViewParameters;t.minimalInfo=this.minimalInfo;t.hierarchyMode=!1;t.groupingLevel=this.groupingLevel;t.groupingRecordKeyPrefix=this.groupingPrefix;t.view=this.view;t.autoFilterState=this.autoFilterState;t.sortState=this.sortState;t.autoFilterEntries=this.autoFilterEntries;return t};e.prototype.InitJsGridGanttParams=function(e){var t=null!=e?e:new jsgridobj_1.GanttParameters;t.dateRange=[this.ganttInfo.StartDate,this.ganttInfo.FinishDate];t.ganttBarStyles=this.ganttInfo.Styles.barStyles;t.fieldKeyRedrawFilter=this.ganttInfo.Styles.fieldKeyRedrawFilter;return t};e.prototype.InitCellStyles=function(e){if(null!=this.cellStyles)for(var t in this.cellStyles)e.RegisterCellStyle(t,styles_1.StyleUtil.CreateStyle(styles_1.StyleType.Cell,this.cellStyles[t]));if(null!=this.groupingGridRowStyleIds){for(var n=[],r=0;r<this.groupingGridRowStyleIds.length;r++)n.push(e.GetCellStyle(this.groupingGridRowStyleIds[r]));e.groupingStyles=n}};e.prototype.Init=function(){this._initType==constants_1.JsGridConstants.DeserializationMode.Full?this.PopulateFull():this._initType==constants_1.JsGridConstants.DeserializationMode.TableView?this.PopulateTableView():this._initType==constants_1.JsGridConstants.DeserializationMode.RowView?this.PopulateRowView():this._initType==constants_1.JsGridConstants.DeserializationMode.Slice?this.PopulateIncremental():this._initType==constants_1.JsGridConstants.DeserializationMode.AutoFilter&&this.PopulateAutoFilter()};e.prototype.PopulateFull=function(){this.PopulateTableView(this._serializedJsGridData)};e.prototype.PopulateTableView=function(e){var t=this,n=this._serializedJsGridData.MultiValueSeparator;null!=e.LookupTableInfo&&(function(e){for(var t=0;t<e.length;t++)property_1.PropertyType.RegisterNewLookupPropType(e[t].id,e[t].lookup,e[t].showImage&&e[t].showText?control_1.DisplayControlType.ImageText:e[t].showImage?control_1.DisplayControlType.Image:control_1.DisplayControlType.Text,e[t].limitToList)})(e.LookupTableInfo);(function(e){t.gridFieldMap={};for(var r=gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(NumberUnitFlight),i=gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(BooleanVisualRefreshFlight),s=0;s<e.length;s++){"SPUser"!=e[s].propertyTypeId&&"SPUser_Multi"!=e[s].propertyTypeId&&"Location"!=e[s].propertyTypeId||(e[s].hasDataValue=!0);var o=e[s],u=new ColumnInfo_1.GridField(o.fieldKey,o.hasDataValue,o.hasLocalizedValue,o.textDirection,o.defaultCellStyleId,o.editMode,o.dateOnly,o.csrInfo);o.multiValue&&u.SetIsMultiValue(n);var a=null;if(r&&o.csrInfo&&"Number"===o.csrInfo.Type)a=property_1.PropertyType.Internal.Property.GetInstance().GetPropType("Number");else if(i&&o.csrInfo&&"Boolean"===o.csrInfo.Type)a=property_1.PropertyType.Internal.Property.GetInstance().GetPropType("CheckBoxBoolean");else{"DropdownBoolean"===o.propertyTypeId&&gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(BooleanVisualRefreshFlight)&&(o.propertyTypeId="CheckBoxBoolean");a=null!=o.propertyTypeId?property_1.PropertyType.Internal.Property.GetInstance().GetPropType(o.propertyTypeId):null}u.SetSingleValuePropType(a);t.gridFieldMap[u.key]=u}})(e.Fields);(function(e){t.columns=[];for(var n=0;n<e.length;n++){var r=e[n],i=new ColumnInfo_1.ColumnInfo(r.name,r.imgSrc,r.columnKey,r.width);i.isVisible=r.isVisible;i.isHidable=r.isHidable;i.isResizable=r.isResizable;i.isSortable=r.isSortable;i.isAutoFilterable=r.isAutoFilterable;i.imgRawSrc=r.imgRawSrc;i.customFormatter=r.customFormatter;i.ascendingString=r.ascendingString;i.descendingString=r.descendingString;i.isFilterable=r.isFilterable;i.fieldType=r.fieldType;i.internalName=r.internalName;i.isEditable=r.isEditable;i.isCalculated=r.isCalculated;i.customFormatter&&(i.fnGetDisplayControlName=function(){return control_1.DisplayControlType.CustomFormatter});t.columns.push(i)}})(e.Columns);null!=e.PivotedColumns&&gridutil_1.JsGridUtil.DebugAssert(!1,"Uh oh!  We removed pivoted columns...");this.paneLayout=e.PaneLayout;this.ganttInfo=e.GanttInfo;this.bAutoFilterableColumns=e.AutoFilterableColumns;this.PopulateRowView()};e.prototype.PopulateRowView=function(){this.view=this._serializedJsGridData.ViewInfo;this.autoFilterState=this._serializedJsGridData.AutoFilterState;this.sortState=this._serializedJsGridData.SortState;this.cellStyles=this._serializedJsGridData.CellStyles;this.groupingGridRowStyleIds=this._serializedJsGridData.GroupingGridRowStyleIds;this.autoFilterEntries=this.DecompressAutoFilterEntries(this._serializedJsGridData.AutoFilterEntries);this.PopulateIncremental()};e.prototype.PopulateIncremental=function(){null!=this._serializedJsGridData.MetaData&&this.PopulateMetaData(this._serializedJsGridData.MetaData);if(null!=this._serializedJsGridData.LocalizedTable&&null!=this._serializedJsGridData.UnlocalizedTable){var e=this._serializedJsGridData.LocalizedTable,t=this._serializedJsGridData.UnlocalizedTable;this.viewDependentKeys=this._serializedJsGridData.ViewDepKeys;gridutil_1.JsGridUtil.DebugAssert(e.length==t.length);this.data={};for(var n=0;n<t.length;n++)this.data[t[n][this.keyColumnName]]={data:t[n],localized:e[n]}}this.additionalParams=this._serializedJsGridData.AdditionalParams;null!=this._serializedJsGridData.RecordCount&&null!=this._serializedJsGridData.TopRecord&&(this.minimalInfo={topRecord:this._serializedJsGridData.TopRecord,recordCount:this._serializedJsGridData.RecordCount})};e.prototype.PopulateAutoFilter=function(){this.PopulateMetaData(this._serializedJsGridData.MetaData);this.autoFilterEntries=this.DecompressAutoFilterEntries(this._serializedJsGridData.AutoFilterEntries)};e.prototype.PopulateMetaData=function(e){switch(this._initType){case constants_1.JsGridConstants.DeserializationMode.Full:case constants_1.JsGridConstants.DeserializationMode.TableView:this.isGanttEnabled=e.IsGanttEnabled;this.operationalConstantsFieldKeyMap=e.GridOperationalConstantsFieldKeyMap;this.keyColumnName=e.KeyColumnName;case constants_1.JsGridConstants.DeserializationMode.RowView:this.groupingLevel=e.GroupingLevel;this.groupingPrefix=e.GroupingPrefix;this.isGrouped=0!==this.groupingLevel;this.isSorted=e.IsSorted;default:this.recordKeyHash=e.RecordKeyHash;this.recordKeyOrderChanged=e.RecordKeyOrderChanged}};e.prototype.DecompressAutoFilterEntries=function(e){if(null!=e)for(var t in e)for(var n=e[t],r=0;r<n.length;r++)1===n[r].displayString&&(n[r].displayString=n[r].dataValue);return e};return e})();exports.Deserializer=Deserializer;function DeserializeFromJson(e,t){t||(t={});"guid"in t||(t.guid=function(e){return'"'+gridutil_1.JsGridUtil.GuidManager.prototype.GetIndexForGuid(e)+'"'});for(var n in t)e=EvalFunctionCallsInJson(e,n,t[n]);gridutil_1.JsGridUtil.DebugAssert(null!=e&&""!==e,"Null or empty parameter to deserialize");try{return JSONParse_1.JSONParse(e)}catch(e){throw e}}exports.DeserializeFromJson=DeserializeFromJson;function EvalFunctionCallsInJson(jsonText,prefix,fn){var unescapedQuoteRegEx='([^\\\\])\\"',regEx=unescapedQuoteRegEx+Escape(prefix)+"<;>(.+?)"+unescapedQuoteRegEx;return jsonText.replace(eval("/"+regEx+"/g"),function(e,t,n,r){var i=fn.apply(null,DeserializeEncodedArray(n+r));return t+(null==i?"":i)});function DeserializeEncodedArray(e){for(var t=e.split("<;>"),n=0;n<t.length-1;n++)t[n]=Unescape(t[n]);return t}function Unescape(e){return e.replace(/;;/g,";")}function Escape(e){return e.replace(/;/g,";;")}}exports.EvalFunctionCallsInJson=EvalFunctionCallsInJson});
define("eGe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.SPGPermissions={addListItems:2,editListItems:4,deleteListItems:8};e.DeserializationMode={Full:0,TableView:1,RowView:2,Slice:3,AutoFilter:4};e.SelectionTypeFlags={NoRows:0,SingleRow:1,SingleRowRange:3,MultipleRowRanges:7,_RowMask:7,NoCols:0,SingleCol:8,SingleColRange:24,MultipleColRanges:56,_ColMask:56,NoCells:0,SingleCell:64,SingleCellRange:192,MultipleCellRanges:448,_CellMask:448};e.LinkType={FinishFinish:0,FinishStart:1,StartFinish:2,StartStart:3};e.ClickContext={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3,Gantt:4,Other:5};e.SelectionType={None:0,CellRange:1,RowRange:2,ColumnRange:3};e.EventType={OnCellFocusChanged:0,OnRowFocusChanged:1,OnCellEditBegin:2,OnCellEditCompleted:3,OnRightClick:4,OnPropertyChanged:6,OnRecordInserted:7,OnRecordDeleted:8,OnRecordChecked:9,OnCellErrorStateChanged:10,OnEntryRecordAdded:11,OnEntryRecordCommitted:13,OnEntryRecordPropertyChanged:14,OnRowErrorStateChanged:15,OnDoubleClick:16,OnBeforeGridDispose:17,OnSingleCellClick:18,OnInitialChangesForChangeKeyComplete:19,OnVacateChange:20,OnGridErrorStateChanged:21,OnSingleCellKeyDown:22,OnRecordsReordered:23,OnBeforePropertyChanged:24,OnRowEscape:25,OnBeginRenameColumn:26,OnEndRenameColumn:27,OnPasteBegin:28,OnPasteEnd:29,OnBeginRedoDataUpdateChange:30,OnBeginUndoDataUpdateChange:31};e.DelegateType={CreateRecords:0,ExpandColumnMenu:1,AddColumnMenuItems:2,Sort:3,Filter:4,InsertRecord:5,DeleteRecords:6,IndentRecords:7,OutdentRecords:8,IsRecordInsertInView:9,ExpandDelayLoadedHierarchyNode:10,AutoFilter:11,ExpandConflictResolution:12,GetAutoFilterEntries:13,LaunchFilterDialog:14,GetRecordEditMode:16,GetGridRowStyleId:17,CreateEntryRecord:18,TryInsertEntryRecord:19,WillAddColumnMenuItems:20,NextPage:21,AddNewColumn:22,RemoveColumnFromView:23,ReorderColumnPositionInView:24,TryCreateProvisionalRecord:25,CanReorderRecords:26,AddNewColumnMenuItems:27,TryBeginPaste:28,AllowSelectionChange:29,GetFieldEditMode:30,GetFieldReadOnlyActiveState:31,OnBeforeRecordReordered:32,EditColumn:33,MoveColumn:34};(function(e){e.EventType={OnRowHeaderStateChanged:0,OnGridDisposing:1,OnChangeKeyCreated:2,OnChangeKeyInitialUpdateFinished:3,OnBeforeRecordInserted:4,OnBeforeRecordDeleted:5};e.DelegateType={CallAsyncFn:0,GetLocalizedString:1,DoLargeTask:2};e.LoadErrorState={};e.MinColumnWidth=110;e.RowHeaderWidth=25;e.ColumnHeaderHeight=42;e.RowHeaderWidthNewStyles=58;e.SplitterWidth=6;e.IconColumnWidth=30;e.IconColumnNewWidth=40;e.ColumnWidthOffset=20;e.zIndex={editor:20,selectionFrame:25,expandableEditorsZIndex:30,stickyZIndex:1e3,tableHeader:35};e.fixedRowHeight=46})(e.Internal||(e.Internal={}));e.OperationalConstants={HierarchyMain:0,HierarchyOutlineLevel:1,GroupingOutlineLevel:2,HierarchyDescendantCount:3,GroupingDescendantCount:4,GanttDependants:5,GanttBarStyleIds:6,GridRowStyleId:7,RecordEditMode:8};e.csomFiles=["_layouts/15/sp.init.js","_layouts/15/mquery.js","_layouts/15/sp.runtime.js","_layouts/15/sp.js"];e.RecordIndicatorCheckboxColumnKey="JsGridRecordIndicatorCheckboxes";e.NewRowKeyPrefix="NewRowKey";e.ErrorWidgetId="ErrorWidget";e.RecordIndicatorControlId="DISP_RECORDINDICATORCHECKBOX";e.HierarchyControlId="DISP_HIERARCHY";e.UserPhotoPath="/_layouts/15/userphoto.aspx?accountname=";e.TextDirection={Default:0,RightToLeft:1,LeftToRight:2};e.PaneId={MainGrid:0,PivotedGrid:1,Gantt:2};e.PaneLayout={GridOnly:0,GridAndGantt:1,GridAndPivotedGrid:2};e.EditMode={ReadOnly:0,ReadWrite:1,ReadOnlyDefer:2,ReadWriteDefer:3,Defer:4};e.GanttDrawBarFlags={LeftLink:1,RightLink:2};e.GanttBarDateType={Start:0,End:1};e.ValidationState={Valid:0,Pending:1,Invalid:2};e.HierarchyMode={None:0,Standard:1,Grouping:2};e.EditActorWriteType={Both:1,LocalizedOnly:2,DataOnly:3,Either:4};e.EditActorReadType={Both:1,LocalizedOnly:2,DataOnly:3};e.EditActorUpdateType={Committed:0,Uncommitted:1};(function(e){e[e.Ascending=1]="Ascending";e[e.Descending=-1]="Descending";e[e.None=0]="None"})(e.SortMode||(e.SortMode={}));e.RowHeaderStyleId={Transfer:"Transfer",Conflict:"Conflict"};e.RowHeaderAutoStyleId={Dirty:"Dirty",Error:"Error",NewRow:"NewRow"};e.RowHeaderStatePriorities={Dirty:10,Transfer:30,CellError:40,Conflict:50,RowError:60,NewRow:90};e.UpdateSerializeMode={Cancel:0,Default:1,PropDataOnly:2,PropLocalizedOnly:3,PropBoth:4};e.UpdateTrackingMode={PropData:2,PropLocalized:3,PropBoth:4};e.ImagesDirectory="/_layouts/15/images/";e.UserAction={UserEdit:"User Edit",DeleteRecord:"Delete Record",InsertRecord:"Insert Record",Indent:"Indent",Outdent:"Outdent",Fill:"Fill",Paste:"Paste",CutPaste:"Cut/Paste"};e.ReadOnlyActiveState={ReadOnlyActive:0,ReadOnlyDisabled:1};e.ChangeType={Insert:0,Level:1,Prop:2,Delete:3};e.UnitTicks=[6e4,36e5,864e5,6048e5,864e6,2628e6,7884e6,15768e6,31536e6];e.NormalizedTouchTypes={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};e.SPCalendarType={none:0,gregorian:1,japan:3,taiwan:4,korea:5,hijri:6,thai:7,hebrew:8,gregorianMEFrench:9,gregorianArabic:10,gregorianXLITEnglish:11,gregorianXLITFrench:12,koreaJapanLunar:14,chineseLunar:15,sakaEra:16,umAlQura:23};e.MouseButton={leftButton:0,middleButton:1,rightButton:2};e.Key={backspace:8,tab:9,enter:13,esc:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:46,shift:16,insert:45,six:54,windows:91,numpad_plus:107,numpad_minus:109,F2:113,F6:117,plus:61,comma:188,minus:109,dot:190,back_slash:220,IMEInput:229};e.DialogResult={invalid:-1,cancel:0,OK:1};e.SUPERTEMPORARY_defaultCultureStringify='{"name":"en-US","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":false,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"$","NaNSymbol":"NaN","CurrencyNegativePattern":0,"NumberNegativePattern":1,"PercentPositivePattern":0,"PercentNegativePattern":0,"NegativeInfinitySymbol":"-Infinity","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"Infinity","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"‰","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1},"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"@-62135568000000@","MaxSupportedDateTime":"@253402300799999@","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":false},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, MMMM dd, yyyy h:mm:ss tt","LongDatePattern":"dddd, MMMM dd, yyyy","LongTimePattern":"h:mm:ss tt","MonthDayPattern":"MMMM dd","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH\':\'mm\':\'ss \'GMT\'","ShortDatePattern":"M/d/yyyy","ShortTimePattern":"h:mm tt","SortableDateTimePattern":"yyyy\'-\'MM\'-\'dd\'T\'HH\':\'mm\':\'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy\'-\'MM\'-\'dd HH\':\'mm\':\'ss\'Z\'","YearMonthPattern":"MMMM, yyyy","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":false,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"eras":[1,"A.D.",null,0]}}';e.SUPERTEMPORARY_invariantCultureStringify='{"name":"","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":true,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"¤","NaNSymbol":"NaN","CurrencyNegativePattern":0,"NumberNegativePattern":1,"PercentPositivePattern":0,"PercentNegativePattern":0,"NegativeInfinitySymbol":"-Infinity","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"Infinity","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"‰","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1},"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"@-62135568000000@","MaxSupportedDateTime":"@253402300799999@","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":true},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, dd MMMM yyyy HH:mm:ss","LongDatePattern":"dddd, dd MMMM yyyy","LongTimePattern":"HH:mm:ss","MonthDayPattern":"MMMM dd","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH\':\'mm\':\'ss \'GMT\'","ShortDatePattern":"MM/dd/yyyy","ShortTimePattern":"HH:mm","SortableDateTimePattern":"yyyy\'-\'MM\'-\'dd\'T\'HH\':\'mm\':\'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy\'-\'MM\'-\'dd HH\':\'mm\':\'ss\'Z\'","YearMonthPattern":"yyyy MMMM","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":true,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"eras":[1,"A.D.",null,0]}}';e.SUPERTEMPORARY_spcommonThemedData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ8AAAEMCAYAAADauzOQAAAgAElEQVR4Xuy9e3xV1Zk//Ky1Ey4FL9ChPztarL46SlI70jDy4tgWBSxBRgQMddQkUMg+yFvHhFTUV4EQ5VXBXBh9gezAAIk6lnARqoRKUKiO/mrNaIcmlMGP7SjMOHXKxVIDSfZ6fp9nnb0P+5zs67mEBPf+R8zZez1rPWvt717ruXwfBuEVaiDUQKiBJDTAkngmfCTUQKiBUAMQgke4CEINhBpISgMheCSltvChUAOhBkLwCNdAqIFQA0lpIASPpNQWPhRqINRACB7hGgg1EGogKQ2E4JGU2sKHQg2EGgjBI1wDoQZCDSSlgRA8klJb+FCogVADIXiEayDUQKiBpDQQgkdSagsfCjUQaiAEj3ANhBoINZCUBkLwSEpt4UOhBkINsNdffx1DNYQaCDUQaiCoBsKdR1CNhfeHGgg1IDUQgke4EEINhBpISgMheCSltvChUAOhBkLwCNdAqIFQA0lpIASPpNQWPhRqINRACB7hGgg1EGogKQ2E4JGU2sKHQg2EGgjBI1wDoQZCDSSlgRA8klJb+FCogVADIXiEayDUQKiBpDQQgkdSagsfCjUQaiAEj3ANhBoINZCUBkLwSEpt4UOhBkINhOARroFQA6EGktJACB5JqS18KNRAqIEQPPrxGvjoo4/wyiuvTP8cTqm4BFC/HRi7HRAuAYDrDDUdAAafAuJOYMpO2FXxaUrqm73hEtDZ7cD47YCYIId9Cih2goI7YeOc1OSk1Mm++fAf9j/+ACKuYBwGMIClI763pLK3e5r+hdfbI/iSyiPg+P3vfw/f/OY3IW0Akv/ICIDsZQCgAoDioVodADSArqXQ/ORngaZhzj+NgG4lmJwsfSls+FEwOQCwcOHC2xGxUAhxk6IoBFCg6/qnnPO3GGON1dXVOwP1vQ/c/On+x68Aph/mwGNzxDi7dsRNiw+lu3uqql5EbWqadjKx7RA80q3tXmjPBI6bb74Z3njjjfQAyJSKyYDiJQCQiwUQdwODV4HDO9DNowsnS1wEAsYBwm3A2GRjqCeB8btgV8VuX0O/d8Nk4MpLgBiVA2w3IL4KCr4DuhKVo+gXgc7GAWO3AWBUDmMnQeh3wfNzfMkpKyuj3dIGABjOGFuPiHsURZHgo+v6CMbYJACYjYgkc05NTc0BP/1fsGDBJbqur0bE6cb9pwBg4/Hjx8ubmpo6/bSR6j3/vW/ZJMbZa9Z2GODU5duOPyynKSvrqWeeeebVVOQUFBQow4YNawCAu412Go8fPz6nqamJPhrRKUlFQPhs72vAChym9JQBZPKSucCgztht7AHGF8Guig9cRzel4npAsQIA6CXUASECuyvXuz5T2DAXAA05uAcUXAQb57jLmb3hetDZCgD5susALAKNRa5yysrKJjPGmoQQGmPssZqamg67fpWVlQ1GxCc45yoiFtTU1HgCUyQS2YuItwBAI2PsLUS8CQAKox9nLeJrRRRuilJ/Nhbbv38ev//3m8umM2Tb4sAD4Z4/X140sa2t7arXX389R9f1Fl3X73/22Wd97dYSdxiqqt4HAKutMhBxTn19/cYQPHzNct+6yQ44UgaQKUsmAUKzARzLobnysUCjzl/yBAA8Kl9sBvmwq3KP7fP3Nk4CJgw5uBwaZweTU7jxCQAWlYM8H54vtJVDOw7G2D7OecEzzzzzup+x/OQnP7lFCNGEiOPddiAFBQUDhg0bdgYAdmualm+2rarqPgDI0TTta37kgQkOdgDi9pvR+B9+UbEBgM+Ok4WwfcT3Fj+l63rVmTNnvr127dpff/LJJ99WFOX+qqqqRqd+Oe0whg0bVgsAP04Aj+r6+vryEDx8zXLfuckNOJIGEGkYFb+NHlVYJTQvW5rUiM8CCB1hru1hSCXDqFB+Gz2qYCU0zk5OjgkgdITh+rV2htTy8vL3hRDra2pqnvMay4IFC4YOGDDgutra2ncWLlx4H2NMraqqGu30nPF1PgEAL2qado8FPF4BgJs0TbvYS2bsdzuQ8AMc+x9/ABjSi93zYuyxr3138XJd12k39WhbW9uvGxoaLuzs7NxeW1sbe+mtDzrtMDjnpxCxKQE8ptXX18dsROGxxfdsn7sb/QBHUgCSv4S2pbQ93QPNlbemNML8JXQGp6PFGmiuXBDXVuEmQw7ugcbZqckp3PiacYRZA43FcXLKysqmc86f/Pjjj3OtZ3O7cVVUVAw4efJkM2PsFkS858iRIz+97LLL/g0A6Jiz3e4ZVVXpyEXGZKfL/9GFWrCChbVFp+OM5Z5jb1WM7Bb8P+hPWVxcPvymio8RcaQQ4kHOeWzHsGvXLn3Pnj2namtrbYFNVdVnnXYYqqqSDeUBQ+wqTdOesnYzBI+U3pjMPxwEOAIByNRHLwVd+UgeVxgf42nj8Bpq1AbynrxN0S+HV5Yflf8u2nQpIETlKGKMp43DS460gfCoHAaXQ0NxVE7Us/ICY+xAVVVV3CK3a5LuNYyBnyHijTU1NR8uXLhwIQDkVVdXx3YV1mdVVbWWKVmp6/pTnPMVjLG55n2apgV7pxIBxAdwLFy4EKurq9lnb1ZKIPuLmxa/KIQ4zDmX3iS6dF2HpqYmOHLkCBw9evSkE3hEIpE77XYYjLFLAeB2Op7R0Wb48OGvIeIWTdPWmDKCDdRrYsPf06qBZIDDN4BMXvwwMPak9Kjsqpxq2/Epi+8GZGRxJ5fgKWlr2F3xluMg8xfvAKDYEHwEdj8efYGLGh4GxCeBsVehocheTvS+mwCRbCJDo4ZRKILG4hdtZRVt2gEIFIfyCDQUxYBi4cKFf2CM5VdVVbW6TcTChQvNr22HYed4l+4vLy/PQ8Tm6upqW9uFFTwYY7fW1dXtiUQiZGylHYm8egs8Vq5cuRwARpDMjo6OIUOGDIkB3hdffAEbN24Exhj86Ec/gocfftgRPOj5xB0GY6wVEU1vzj2IqDAm1wG1WV5XV1ct/53W1R42ljYNpAIcvgBk8uJmw926AJorY1+T2ACmLCkElK5Of8BBD0a9Nuukm3f341GDYmFDs3S3Ii6A52f3lGPVWNEmcgPTonUHkKjXZp108zYWSTnkOWGMfdHV1fU108OwcOHCHyqKsn/lypWxILPy8vKHkcAs+iIUVFVVbTG7cP/994/Izs7+AyJ+xc5Dk7DzOKpp2mWqqv6R3MFJgUeSxxbaeVRVVcV2F7/61a96rLu/+Zu/gYKCAlAUhXTjCB6GzSNuhwEALwshhjHGKBaHvDUE5uau5pCmadeG4JG2Vz29DaUDODwBJH/JEQC4FAQbCz9fJr+8DsBxEhDzYffj73iO8gdLbwCOvwSAo9BceVkUPDZF5TAYCw3F8XLsGiQAAdZsxIGQa3YeNBbF3IPykaJNNwBCVE5jsZSTCB7l5eVyR0ABYdnZ2feQ56WsrOxuxhgdVwg4Hkk83gQED7nLSAAU/zuPJA2m1HcTPDznw7jBCTwikchCRKwybuuxw6AdBwCQO956xTxN4c7D7wz00n3pBA5XAMlfQi7HAZDFL4efVXwcN7z8Jd0+IkyjjzRXnl1Df1cxEroFGfE6oblyoAEeUTmMXQ4NRWflOH11e+pZh8birLg/FzWMBMSonMbiqJzoS/VHOk7QsYWOIN3d3a8YUaU6xXwAwFzO+QAhxJra2tp4o27AY4vTcvB1bEnRVZsu8FBVlTxt1xhj6bHDyMrKGtPd3f2m8TtFr35IAWirV6+mwLjw2NJLmOBLTCaAwxFA3MHDf/3izINHz2AqZ/CIM5iWlZVdBQCvMcauMPUghNh59OjRGXbeGB8G0x6eCevEMsYq6+rqvN3QKQaJpRE8yMZkRgonrtG4WBa7BRzuPHy91r1zExUdp5DzTF0UiXrLLbdE59zt2DJ58WxgbJ2x++gA5Le6GkrNDqfl2CINp2T3GGxElPo6tlAXyFULAE8cOXLk2yY4PPjgg5cIIZoR8XoAeNcwkPaIOCWPgperNlPzErRdAo8gzwghbG0eFOfS3d1N7lgCWXMH0mOH4SQrBI8gs3A+3Xs2LsPeYJoMgJgGU2vciBmX4ctg6gM4aA5iBtOecSMUJIaIWnV1dcw4awSDPavr+iKncG0/QWLn0/SnYywheKRDi/2xDV+u2oAel7S6atkcaCyyD6t2cNUau4/rEPHNrKysGekOT++P05zJPofgkUnt9uW244LEcDTsetxXVqnjkKYsvg6QvS9/dwoSE2I0vDAnNTn3bLgOOI/KSQgSM/v2k5/85DbKVSHDqM/EuPuMXJiUMlH78nRnom8heGRCq/2lTTM83RqXkWzfz8aNuISnn43LSFZMLG6EwuATwtOtbZK3BQDIbkOZs42Uki+EIB4Pilm4lFLyGWOUDUv2j3legWVJ9/c8frD/g0fB5sEwuOM26Bj8KjTNsk29Po/nL7WhpS0xbukyAFwCAJlOjFsGwJZIbg+HxLhEhRAZEPF2AMD3LcFcxwBgP/Fw9AUyoEgkQjlBQBGrqU1o7z7dv8GjcBMRlVC04EgAoBiCRxxDmntXr/1HWpQEiLJCKSAoxZR8PtWRFIhIgBg35KSaki+m+iUFysREqKpKdpUljLFxMgAO4CgiUhAdrUO6FtXX1xM4eV5GSrzM1Tl+/PgYr4Q+zwZTvCEx6M2uOTOWpX+CRzTCkHzuN9gM7l1gcL+vaMYUFX3ePN6DDAjLPW0g+RU5AIJSw5MnAxJY7mkDuef5HODdtUHIgDI1Lwafx4MAQLss2iXsR8QPGWPk6qSPmEkL+KmmaV/304+SkpJCM7EOEdfX19c7cm/4aS/Ve85f8IgGB9EkmdRobrp60Uicio+eTFW75+vz0R0I8TdQXgkZI1+VRMccWoFH6ftA6CNAQJ5BjHyboYpTwHhBIBpCxi1y2KuS6JjkII/KYcKQI4mRz8pBUXCOdxxERkQh3fPq6+vj0vZVVY2G4UcvmffitVQopP7Pf/7zYSFEEd3LOW8YMmTI1U7MZ3btlZaWXs85f9uIi4lOkxCdiqJMqKqqck5idOicCR7m7oL+3/pveqx/7TwKNg+FQV88DMAoZZqCh/xeHQBYDae/8hQ0zZIhteHlooGoDYS+qj4JkNl6YGxpYBZ1yZrOg8lR9KV9gUWdYkbM8GyrJiORyGREpERCypuZU1dX50lpaGSzTtY0bTw9Z1Ac7knkzfBasxQcx9hZWsLEhD+n5912GecHeEQDgojqLsZV4KVMm98/BWCPeXFfJtHu+fmIdOPy6QbRMaV9k+eCrlZA/EzuShSxPcbZkawWiOtDwHSD6DheDrDPJDEyh+1Wzo6gotLBnl5SUkLGVjNBzNOeoarqTYyxO+vq6krN/hrZq9cbR5yLEJGOOhcJISasW7dO0iXOmzfvFs75XjI8M8Y+pP/SsQgAPrDyaCTqIBPg4abnvr/zKGz4PiDWAgMKK07PhfABMFYKjUW+jFnpERq2ci40kE72dFVV/8vy8fK0Zxh2jCetRxcCIMYY5ZKsEkJsycrK+nTt2rUxIiOrjoihvbOz81LO+Z3E5IWI+W4GWIqOTSArXmCNsPXaeSQeS7zmq++Cx72NVwGIFcDApLb3Gkvw3xG2A/BF8HwhoXp4nWcacGJPLy0tHacoimLaAvyypwe1Zxg7iGZN02IZv6TiSCQyDhHJ47TS62hiHGkeZIxNraurc6RDMAifqU3T02PWpZlWU1PjSoFgZ98wl0L/OractWuQNXtAL6znTkBYBWcGV4b2kARt91IlN6MGChVlup0xdgkiysp0RCWIiJ8yxnYqirJz9erVvivGObGnG4BCX35AxBlWnlIv9nTDnkGlDug44WnPsNt5WI4vNEbK9N197NixSGKtF/LoDB8+vA5R1qu5VdM014jc0tLSNznnVP4h8TpQXV39bbf36PyweaTHrpEs3oT2EFNzvVTJbc6cOcTYFahiXFdX19INGzZ41iBxYk83AILsCXRNSwwO80qMU1WV0v0H19XVzfBaaCUlJU2MsU4rw7r1mUgkkoOIbQBwuaZpcd5AVVVpB/ERY+zbdXV17V6yzN9LS0urOOfkUFhfXV09z89zftyydu30jWNLJuwafrRmd8+X3R7SS5XcjK/42cp0AOSVeFUI8Y5RvY12HhdxzikAi9y0scp0jLG73LwYXuzpdGxhjA2oqanpYfPySsknIygAEDHOVE3THHNgVFWlPtMx4ruaptm6Sg3S4Qc0Tfuu3VJUVfVNxthzdXV1P/W7nE2WNHIj19TUuBffMhp1O7a4yT234NEbdg2/Wk+878toD+mlSm6RSGSuQRasUK6JEYnpWjGupKSEDObEUC6D0Rhjkbq6OtuXw409nVysgwcPlvFBF1xwwcaKiooepSF9kAER0THZ4uZYAcTqjTGIh7a7VY9TVZXAkzwoT82fP/9SRKSARwLN+8mIatg7rtc07S6/y/iBBx64RlGU3zLGxvjN0+lf4FFQdxEMHLQEmKxE1Rt2Db+6T7yP7CHPwZnTldAU6VHgN9lG++RzvVTJjfI3iJncDIPXNC1QxThVVWOV6Ygh3S4PxI09/YEHHhipKIqsc5KdnX3x008/3WNevdjTjQhTik8hAp1XjYjQnQnemFPHjx//qlPdWiMw7I9U7oHybYhkmNoxwIPAlZjI9jPG3h4yZMhX/QaM0c7pG9/4xn998sknX/cb4t4/ji0FmxUY+IUKjNECiDFN98mXKb5TxwDxMTjzFQ2aZsUK/PaDfvvrYi9VciPDaHd3t6xM55uqz2YEFgA5mZWVda3VkGrHnm5twg94eBEgm+0Zu6FHGWNDqa5JEG+MeawxyhucYowtMG0bhi1kNbWLiBRb43pE8jfJznf1ffCQCVGsCoDlpDrYc/c8tgNi+bkMjc7I2HupkpuqqrJiHB1V6uvrU6oYV1JSQp4KWZlO07QYiXFvgkfiXASJLjV0QUefck3TbOvSqKpKxytiNafjTw+i5oyshSQazXxinH+W7CS638uP+Kjm1cs9Sl5cL1VyozO9EEJWjEPEMfX19a42Dq8B0VefMSazUDnnl1sDrazs6Ynt+Nl5eB1bvPrm53fahVEBLbsQd+vzZKOhPKMgbmo/8tN5TwgeQbR5XoGHj0puUcqDsxXjGMuHhiLnZCsbekDD+EfJjK9qmuZYMc7wZsRVjHP5Mu+gUohEwWANtnIzmPoBDy+DaZCl8mW4NwSPILN8PoGHVyW3woZCAJnoFa0Y5wUcpEebSm6qqpr0/gvc8jPocSMCM65inB2AGF4bYgmLKw9gx55uTq8XeHi5aoMsky/LvSF4BJnp8wo8XCq5WYGDWLsA86Gh2LtinE0lN9OYyDkfu3btWs+KcQaAEOBcRK5ZI/09rmLc/PnzbxBCyIpxianvduzpNMVe4OEUJKaqKvGlJpNfRa7Y0UGWV2/em6yxlPrYe3Ee55PNIzq7h4DBIUC2HQZ07oT184jSrv9dhZvsK7nJHcQm/xXjrIBqU4xJVdWonIRoygCLV9c0La5inBGFKSvGJeaPUHi6HXu6G3i4hadb+SyCTHKyz/mRcWTRZSrqYgVwTgDreQkE8uosGrnyk1g5imT7Z30u3Hl4qt7lBvoqI6yE04Oq+x1/qjt4+C8qlHnw6FH/1Q08aLbSyZ6ejpfM7xIzYkAohJ4Y8u53OuZ9Uv6XJ/wChymbAOTyZ45cYP5/kHGRPcqMlg3Bw+9sAvwUGPwUsrv2x3YYlP+hK8TvQFXkyWgHQKHtnE2Lq8XqX8a5udOtAHVhw+xoFXpp7+gAxm51NZSaI0jDscUwnMYqxgU9tphdSRd7epCXzDqRQZ8j4Dhx4sTQ7OxsGjsdk05qmnax3eL45MHLJLhftuIT+XPXp7+FM7/7FXS8vx3O/P5XjuvpGyuPxDYLfvtnZAiTe3wn5fWE4OH9ur4LQpkDL9zrnpg0e8P1IJQGiGaDfgqMjc0EgFiCo5abkZl+/+Y4VK9KbskAiE0lN0tchqfB1A9w0HhMg6mfuJFU2dP9vmSJeg7ynBG5ug0RO7q7uxcYAHLIKTzdBI+v/T8vAygDIGv4N4B/JYozpw/tg+NbHwb9RE+qkKDgYQT3kc2H3MtEI7AoBA838EDYAmcGF/k+hkSpBLZJgl7GDkDHoBvTneKvquqfDG7RU5qmya2n3785DrXIj6s2oMclja5aRJzjRAasqqqtq9b7mxD8jiAgkMzOg7w8F1988UvEPCY3sYhbhBCRzz///KRTmLkJHlZ5g64ZDxffXgFZI/4v0P/0GfxxQzF0HonP5g8CHtSv4cOHv4aIt1C4/PHjxydQf0LwcF5D78LpweN9A4fZDuXsDB78prEDeQoaix8Jvkydn1BVleIkKJ/iKU3TZNt+/+YMHpsuBQQZvAUZrORmDRIDgNFe/BReeqOyBwAgK8YlBol5PZvM717gYZRO+CG9ZJxzRQjx+okTJ14MkF9CcTRUfEpejLGNx44dm+f2vAkeX539T3KH0XXk36DjN7sB9S648AeL4ILvlYB+8lP4w3N/J/9rXk7gEYlEiNR5vaZpsXwfy872aFdX12iTDiEED/tVpLu+RKbXyMldWySLNFPK9ilQxNV9gazX82WJhadntpKbGZ6eGJfh2T+bGyxxI3Hh6cm05ecZN/CYO3fucM55M2MsrgQIIr7b3d09NTs7+w+mW9NOlqqqlKVLZNPyMhLtPLk4Em0e9CyBxPEtD8pjC+1Aht40Fzra98AfN/7IFTxKSkqo/gxxq+wfMmRIPiXiGeH2RCtAWczjrUxmIXjYr5qfQmOxcwq0F3hQm0UNr8hSAQj3w/PFz/lZnOf0nvQlxrlWcktXYlwkEqEMVFmZLjExLlN6dAOPSCRCdgrKU3mOMSbdoIhIfKKUNU6cH7c5gUdJSUkVY7IagHlpbmn81vFZjy10TBmcMwkuvLUcWPYg+J/6u6XR9H8t3ANZX/0m/OEfp8SOL3Y7D2NnSDEzVDZiJ3l5AIDC/0cgYml9ff0qq+wQPOxWGoMZ0FAcV4sj7jY/4BEN534BAN6CxmJbopdMLfKk2+2lSm6Wr5msTJdiSj7xenqWNiCdpMqebhckRoZaRVEeMwLVeuyAIpFILSI+QPLtwMMwkJLdxiQ6ek7TNHppfV12No/s/3U1jLhvG2DXafjvmkkw8Jt/A3SsOfXWejixs0K263RsMY6CtGumuBE6utB/X7RjQutb4CEjGCVk+wp48aXdZG4a0PVV14AvX+DRcAUAkh3hFDQWx3zqyXSnV59JJAPKUCW3RDIgxhhllrpydFKauhCi1g8ZkFVn6WRPDzIXicFvieBBRx1FUV7RNO1G4wh2gLwYQWSY4HHR1CXSvvH53mfh85+vkP+mv51sfgr+tH8t/GXFAXmc+e8qsnk6gwf9ZpI2GwF9B4YMGTLWjkukr4DHWcKdCxUFOrOJ68NPsaEgevZ7bwc0Fn/Fdqfh1YLVBlKweQAM6qCISoDTg78S2PDqJSuTv0d3IBmv5GbsQM7KAXiVYgh0XW/lPFoxTggxQlGUPCJGNqgI6c8UJVngZ8fhxJ6eqD6/7Ol2avcCCaepstoYsrKypnpl19q1Y4LHpU/8FtiAISD+/Ef4z2XXS5ftJQ+/LY2nf2woga/9wy6gHcnRR6/2BA+6waACWK0oytg1a9Ycchr3uQ1Pt1L9kauTLqroJuuSiioAyRzdm1cmwGMgNM3qQXXXm4MKLKuXKrkZNpAAFeNgfVZW1lI/6elO7OluuvBiT3cDD9o91dXVVVvvMTOJGWO5iSTGBDpEiNTd3b1q/fr1SaU2mOBx4cRSaRg99aYmdx/AFbjsqd/DmY/+N3y2tgBGzG+CAd+43jd4GAAyMpGUOWFssfKTvR2e/i4AWxQrunSWNZ2cVGcrup0LAqEs/Wuw4UfO7Nx+ji3EzcrEYRkw1ljsq9Bx4Be8Nx7ohUpuNAzDWEcGx9sYY2Sgk5XpDJYtmotXOefbnYoj2akikT2ddhfEXldTUxMXNfXggw8Su9lJc2vugz2dCJApy/gq+vIaINCKiNcg4lSzKJNZpoEx9k5dXd2ETEzXf/zksj9xZtQU9ikglfD0cw0eRC//CDQWR5mTnFjTrQzmvU9deE+sf3YT4gs8Nt4HjBFr1n5oLJb1R8Or9zSQyJ5uAMcrjLGRiDjeBJCysrJLGWP7EPHjM2fOTKOjg1dKvqqqZMu6gkZjAY9cRCRPBe2eKRqZjMHXAMAxIcSYdevW/S4To/9k0WUPAoplANxX3WZBLldkS0c+88lysz8BEhN7DKEXjy0Nj8YSx/yypscda3qJNJlkPl/sXJPDD3gUbqKkplv6jas2Eyv7HLaZSAZUUVEx4MSJE02ccyos1d7d3S0BPSsrax9jjAyxOy+++OICk0k9GTKgefPmXUFF6BCRSkUQz+1bnPPyILulc6iylERn/thC3UuONT2ewdwv8KSiDkWMho1z7GnyvMCDdlOA+/pVkJiDrtra2i6hF04IQQbLSxhjspIbIpJn5FPO+U568XJzc31XcrMTtXnz5ksURZFyOOeUPyHlAMABIYSUo+v6zlmzZvmSY8eebgDIK5zzSYwxObeIeL0QYs/FF1881VqCoTdoCFNZnn3t2cyCR3qOHvEM5pksFBXNTRkb2Esyd91w6Mym7StVPk97eHpvLZrDhw+P6OrqokAslTFGW3DHCxEp+lDLzs5eevXVV3tWcrM2tHnzZvKmBKoYp+v60lmzZjnKcSNANrwqr5llGYUQbzHGbk10RfplT++t+ejrcjIHHmk3eiYwmGesRCXugdNfmeE7uS0KHBTwc1OmEuN6YxG1tbWRh4sStGS8DdVSNaIk39F1XcbiKIpCv8lKbkYtVfqK02935ebm+gra2rZt22REjFWME0LsZoy9qijKO11dXVJOdnb2RbquU1Ho2zjncRXjZsyYYSvHCzyMCvVEpUDXfqo8H4LH2ZU1YcIEMgaPZ4xd3N3dfcW+fftOTIVG86UAACAASURBVJo0iXZoD1Bp0N27d/8+cR2mHzwy7m5lu0HwcpkuLzNaOyjjNM0XtgNjc6Ch2J02L3pUId4L2nF8BsDGQmNRRoxkaR5gXHPt7e2ykhvtNsxKbrm5ua4s521tbbFKbsYuJJKTk+Na5nDr1q1zAYDyOSiBbE9WVtai6dOnu8rZvn379d3d3Svo2GHYFCIzZ850qhj3R9pRWCum0bHl888/N6M5zYA0Oh7tvvDCC6eFx5boUpg4ceIbBB7GwngZACgsnSKuKdf/BGU57927l/4eu9IPHkEo7JJ/I3RoLI5S02WU5lB+fX8Kiv5BzBZSvDEPBOQBsB9K42j0M02LcmomuDxMFSEi2QRiFeWFENI+wDmPVZSn3ATGmC/7gNlue3u7rORmHFOW5+TkBKrk1t7eLiu5GQCSn5OTQ2Uke1zbtm2LVYxjjC2fMWNGIDnbtm17AhEfNZK18mfMmNFDTqLB1KiiRgFp5A7+sKuri6q00c7mbQPwt1944YV3pWIwTX4J2zxZUDYYTl0QYxKD5soYbWAQOX4ZySZOnFjKGDuhKMq+rq6uNxhj33SSk5WVdUXi7iMT4OGfwi6IRhLvNSM7Mwoenh08BcBMGsJTnncncQMijhCC3HKgUsq3WxNCCLL2a5zzpYwxTzsEGUYBgOqbXoSIlbm5uVTqMPBlARA6dlybaEg1DKOxinEzZsxISo4FQE7qun5toiE1kT2dap8MHDhwB2PsKirvmOCqfRsRP/TrqrVTykMPPSTX+tNPP536eySBY9BQgLNMYtBcacsk5jZBfhnJ6EiCiJLawOai3WCM9BkRf6/r+mg6yljvTX3QiZJ762U+d+BxCBj7EFDshAHdWzJJgGzYFWL2AUSU9gEAICZzk3tB2iHIPsAYi9kHyA5h2C0c11p7e3uskltubm5Kldza2tpildxycnLiqpxt3bpVyqGjSkFBQUpympqayPApK8bNnDmzRzW1RPZ0OrYcP378klWrVlGsUewiQuRhw4Z9atl13McYU6uqqnwznqcNPAoqBsCfxTZA7ADoXmAAyCForvRd6JoGFoSRbOLEiTUAUJqwOJZ1d3fXEkiMHz/+4qysLPrdBHoCDgKzl1taWmgnByF4BPnO9mLpBUScK4Soo90G2SGI/dp0NTp1mVyQiCgrytMuhHMeYYzZ2gcOHTp0qa7rHyEi7WbGeNk4vNRk2EBkJbesrKzLr7nmGhnRuXnz5ksVRZGkQ5zzMV42Di85ZAMRQkg5uq5fPmvWrLjIUSf2dLd2kwlPp/bSAh4FBQqcuvYlgCiTGABuAaFE4MK2k9DU5Ls+cjKMZFYAQcSNe/funWOABtmZPiAQIUMqY2y2RX8nWlpahoXg4bVSE3/vJfBARHr5mw1mquWU/h2kq7quP8E5f9QAkHzGWA/7wMGDBx9GxCcR8dXc3FzbSm4HDx68WwjRYNhDTpGHIjc317Fi3MGDB3dQMhtj7JFRo0Y9RX3esmXLw4yxJ4UQrxYUFNjK2bp1a1xlOsYY2TQc5TQ1Ne0wAr8eufPOO6Uc65VO9nQ3vacFPCYvaQB2lkkMGNsIQ9rnBQEO6qOqqoEZySZMmHAHY8ykobi5paVl38SJE2WdGjqq7N2794qJEyeSEZWMqea1r6Wl5eYQPIK8kXRvL4CHYRiV9gEhRKWiKEnZB0wAMY431yYaUg8ePNhsHIsW5OTk9DDMtbe3FyIifXVkxTgv4CD1kNcGANbRcWnUqFH59LempiYCQXLPLrjzzjt7yNm6dStR8MUq03kBB7VpeG3WkZu3oKBAykm80sWebm3XBAuvZePbBpK/tA4AY0xiwGA97Kr0ZBJLlJ8MI1mCd4WajAMPAPigpaVltBU8iPjI6nEJjy1eK8H6ey+Ah67rqznnsqI85zwl+4AQQtohhBBrFEWJsw+0tbUdYYxREeqx3/rWt+Jc0lbgoDgOznn+qFGjPCvG/eY3v7mBc/5LRDyam5t7mfGiHyGWKqoYN3369Dg5CcBx0gAOTznbt2+PVYybOXOmlON0pcqenjHwmLy0ChhamMSYBs3LIkGWI92bLCPZxIkTjxs2DCnS57GltqWlpczsYwge/marFZA/As8X2roh/TXhfRcixirKk33Ay8bh1aIRhh2rKM8Yi9kH2tvbZSU3RLw8Nzc3zpjY1tbW7RVhasrOycmJraG2traRjDFZyS0nJ2egAR5SjmGfiJOzdetW35XpZs6cGZOzefPmkYqiSDkzZ86Ucs7FlfSxhQykf9J3QMzAzZ6D5mW+mcTMsabCSDZx4kQ6rtxBxxOLi7a2u7t7mYPB1BQbA5AQPNxXHZWWfAwairf0xuJERGJIl3YIzrmtfQARpR3CsIecol0BY8zRPiCEIFelrCjPGIvZB9zAo7293be7PUXw8C3nvAGPH1QMBy5egebKG2Hy4mbg7ADsqgzEJEZrMR2MZNTO5MmTv9nd3U12jphbOAFQ4pY+Y2z0nj17ZGBfCB72qHAUgC2F04M2QtMs3xbvVAGGjKSGu3WBSahrbRMRC4UQG/wCh7EdlXYIcvMS0JjtuR1bDh48OFsIQbYL8vR0AMCtboZSs80kji1kxY9VpqPoUDdDqSknyLEl1Tlxez6pnUf+4iUAUbZy6OBTYV9FUvFB6WAks4CHW1T0vqysrDm6rsvo0z179sSKjofgEb86jgFCJZwZrAVOjkvDKtV1/QjnnFisxzLG4uwDVuAwjKC04/C0DyAilQX4pRDiqKIoMfuAJS7D1mCaDICYBlOy15hxI2ZchovBNDCAWAymKceNpDJtyYHHEgRglSDYKvh5RVJMYtTndDCSUTuGx4UM1rEwdMYYkTdLsDBtIXZ6CsEjqpVTAFgNp89UQ1MkVvgmlYWVzLO6rp/hnMuK8oyxOPuAruvdXhGmpkzGWGxeEXEkAPyHEKJTUZSYfcCPqzaoxyUFV20gj4uTq3bixIlIXqG9e/f6StIz9TVhwoTJlDjX0tKS/vchmYXQy8/Q0aWrq2sp53wVHUlMD4txfNnU0tISpV9PuNKvrP4VYdoJDDTI7lqayUhRv2vBDTzorfDbjh/wsAaJcc5Hjxo1ypXF3Ev2wYMHrxNCyHBnpyAxRVFG33HHHSnJefnll6/TdV3KSQwSmzhxIlEFvkkA4gcMTLAxMm6/29LS4mg78hr/l/H3LzF44HpgvDKTyWxBF5THsUXaIQx7Rwe5cd0MpaZsp2ML/W6Gp1vjMoL22bzfEjeyxiU83TEuw69cM27EKTzdBBBqz2snQeBhyA2Bw+8EWO778oEH0Q2i8phM6e9jlxmXAQBOBtPAAEJh7obBtEfcSLoS49ra2pYxxpYY3B6ZTIyLVYyzS4yj6bQAQhDw8Ly3jy2VPtGdLxN4vA4MHvHk6DiH0+LTVRvI4+LkqjWHaZAAEUmwrOSWSko+0RI4kQIZJEBU/1RJQ0r+VCdSoMTps4KJ9TevXck5XAb9RnQGwGPjEwDSWhutx5L+K2rcbJwdDdv2trH0SoBXOoaZECQ2mkV5QpK+EDFmh6CK8tYgMWujiWRARODrZQNpa2vLAQBZyS1ZMqDs7OxyLxvI5s2bcxhjtX7IgOwUReCRCBR2f7M+m5eXJ/M7klD8B62trb6zcpNoP/rI5MeuAVBUYEjMaGY/PwBk+wF0DXY/YVuwKVFeJBLZQKzy5Gnp7Oy8YuPGjSdKSkqu55w/QMWv165d24M9zNpG+sGDWp/zTyNAV5YAygpw5D1Ix0XGzTWQ3VUZM27O3nA96NyJk6BXA7zSMUBqwxKeHheXkUz7ZtyIXXh6Ynu0A2GMxSq5GYFqVPi4VQghuUE45yMAII8IixljtxltUN5LQUAawpgcSpgjomPOeWtXV5eUk52dTRwmUg7nPCaHKsb53XGY40sSPLC1tTXwu5GXl5fUc4HmdsrihYDsCWBwAAR7C7holc8LngccbwKE64DhY7Dr8bhCVHYySkpKiAAoxh5G3hYhRIw9jN5kTdPi2MMyDx6mhEKq3SooKMaa0htIV9GbbYybRZseBIQnjVoZ1jbPSYBXEoOyfSSNiXHLOOeyojwR9PhhGCMbiGG78EWADACU7r80KIu6QQ4UqGKcQYAciCWNFNznwaNg82AY1BFlD0O8H56fbc8edjakfRwwXAC7Ho/WQEq8piy+G5CtBsR34AJlGjRVxFUtVFW1FBEle5gQgrJlHdnDOOdXuO0+AqNrUi8J8Zoq+pOAQGHS/i834yYpfWCHCgxoEQ6nQjvnMsDL/6C876RsVyEElQsgrs9UU/KnepECJfaI3LhCCFnJjerGMsZkJTdENOvJykpuJmeH94js7yCuD875dIPoWO5qjDvlboeIj+hLmMjZEURenwYPWsNDTw2FLuU1YHA9UNH3hiJ79rD8JbUA8EPI4mPhZxVxMUA99PF3FSOhW/wSkL0Iu5eVm7/TkYQx5os9DAB+39nZOZqOMk767h3wMKUXbboBEKok07j7tR8YLPJl3KSaMIMG3w6nO3aeywCvIAvaz702ZEDlXjYQRMxBRGmH8CID8tOH8+GeZAymyR4/Aj1HRdEHn94GAjsgW19gAMghaCzuyR42ZfF1gOx9YJAPuyrjkzPzKWIVAJor49/lKUsmAUIzAP82NFdIz6KqqrbsYZ2dnbUEErNnz754wIABtuxhmqZJ9jDr1bvgYUq+t3ESgFgh0Tb+6jfGzd54sYwdCFU8k8ZnskNQRXmyQ0TZ2uUlv9gGCY+0DwghKGGuIOiOozfGlGkZ6XDVBgIBy4B8PyfrGXW8BAyi7GEIW2BgVwQ+v/CkbS5VdNdxg0ymS7ycwIPuy1/yNiB7x7r7sAIIY2xjXV3dHAKNQYMGXX/69OkPCEQMQ2oce5imaZI97NyDh9mDok0/BARKEqIUvaXQUPzTTC+u/tY+2UCEILuRbwLk9QYBcmD7QH/TjV1/0xEk5gUCRPn30Ucfmez55Hp+/YorrnixyS9tYOGmONYvANwIp78yzzEJM3/JbwHwOWh+/LlA4DFlyQPSadFcmWs+p6rqHUZJBTKA37x27dp9qqqa3qXfa5p2xfz588cb9pAotiHuq6+vl+xhfQc8qCeEwnT1YvZqf3xJyI1LJQQMouM4+wAiSvsALQond2x/HHPQPqcrPN0NPMaNGze8s7OzWe4E4q93hRBTOed/cPXUFDbEs4eRM6Bxtjt7WP6SMyBgBvy8kuaYdhTuqQrmEeYHS24DDi+YLOwJ3hU78PhA07TRCeAx3cnjcm6OLUFXRXh/qAEfGkhXYpwbeOTl5W0zQPw5RJSeEcYYMa//2Kiwd5sjeNy7qQoYxLOHNRZ5s4elBh4vQXPlBdRPVVXj2MN8HltqNU2LsYf1rZ2Hj0UR3hJqoDc14BAkRgz2jyEi1SRe09raGkfrmJeXR3YJCo4EW/AgA+mg0zsAMFoeg8Fz0FDsjz0sf8lhAFyV6rFFVVXJHkaeFIuLtrazs3OZg8HUVLstgIQ7j95clZmQNaXiEkD9diC2MIS4SvPA4FNA3AlM2Qm7KtJjA6HiRH+6aBIwnWQBoPIpXHByDzTVEGkQAJHdND9emYmh9tU2aadi7VsP8IjWM34FGotvhMKGZkA8AM8X+2cPy1/6LABeD82V3+2hA3eD6ZvSuN5cGVefZf78+d80MqCtbmEroMSJQcTR9fX1PcqChuDRV1ekV7/yHxkBkB2o0jxA11JoftKzkpytaFlfZBTRJD5IzO4J95yUKQNDf7scTo3qBsCl5yOAeIKE05wVNiwBwCh72OnBU30XUTfbM121wG+F5orX48Q4gUd+xS0A4jVgOBp2PR6X5mCAhyN7GBlIFUWJsYfV19fH2MPCY4vXi9nXf59SMRlQxCrJAeJuYPAqcHgHunmUzChLXAQCxgHCbWeJduEkMH4X7KoIRJYD0RqqVCyaKrW5XPg6AIvW702MO/CjUzNPKZGl3unvHm2mmruR2LwFPMpbW1vjwr/z8vIk/6wQIvf999+Pz9iW/cdKGNC9KmnemOjuYzpk8Rt9BolRPd4tibsOGpPhcYmxh1EYOiJSPosMVTdtIV5TFu48vDTU136fvGQusGileaKUBMYXwa4K10rzMKXiekCxwnj5dUCIwO5K14r2ccOOL0z0GTB8CkAxvoDi+4ByN0LeoLNXKuBBrdiVEw1Y+iLV3I28vDwKZqSX7Co6ihjgQTE21xBB9a9+9av91NXvfOc7lBdEhtR3WltbJ2RkyaQpPN3sG+0+EHGpEGIVHUksHhY6vmzSNM2WPSzceWRkdnuh0VjUoASO5dBcGaiSHOQvkRXtKf/ONlrRbgiTF48DxugrRtcBEHx8D+7N8RVDYbCgdHvK8oxeyYAHPeeUJe0TONKZu5GXl0dlMq+gbpngQTsLqk1jZI3TDoPm4hpKj1AUZcy7777rRiac+iJJTIxjGOW6RXZD0MS4VDsT7jxS1WBvPS8No0JWkpMEus3LkqokZwEQOsJc62lIPbvr0IHxMXG7nPylywCQAth6XsmChx2A+ASOdOduOE3tDTfccIWu65RmMY6AmBjdurq6yn/961/H1c3N2NI4m5JPR0RrSv7rQVLyU+1fCB6parC3ns9fIivNy6NKc2VKleQgf8lrxhFmDTRX9qg0Hzek/CX/BSC9OG/ZW/sdAOQcgEe6czd6a2r7q5wQPPrDzE199FLQo5Xme3z9k+l/1AYiK8mBol8OryzvnS+mn76mfmyJJX/5DIKiXp2wy93w093z5Z633377qo8//vjwXXfd5RsTfN94viipX45j8uKHgbEnpUdlV6VtJTk5rskVNwETFDpNiXQ6MCxy5H3IX7wDgGJD8BHY/XiPSvMxPdmGQju4YvOXUFwBGRmPQnOlaw1Z23mwAkeSBtN05m70xlqJlD54uq525aBAstLEJGbK/MUvfpHzn//5n230/yF4BJqJfnAzlSWM1jVdAM2V9mQx5jCiBk46lrgDSNRrs066eXc/bltpXjbpmEeRACC3Lc4DwaK7GYRG2F1ZFFizKbpq0527Ebj/AR/4h/KHOoBzCRz/uPJJfx/yNDKJkdx/+Zd/+VZ7e/uBefPmwT//8z/D3Xff7a8fGSk3GVCB4e0+NJC/RFaaB8HGws+XxVWSs306CiC0A6FgLh0Q58Hux+MDfX6wlKzz5DVw3yXEg8cBgK4JPQLNoscq8shQgSnw3U8fQw9yS7pzN4LIDnrvTx6toGC6aFKocT2zfJnzi5tmVy2JfOutt3Lfe++93zzwgIyqD8Ej6CT2i/spMYq4YLP45XEBQl7ZlWcHp0NzZVbcWKNsU7LSPDRXOlea7ynjGCCuBAZGqUtGx5SzUacM1sOuSvcs0QwpPd25G9RNkx/EiW3d63e7of6/FU84ZsX+fxWP2QNIGpjErH15/fXXJ7z55pstS5acdZaFO48MLcxz2mzq4NEz7iIoeJC9haJV3S66Zwifkcib2du6S1fuhhU86N92LOzm2JIp5bDsyRUxEFn6yCLnXUeamMQS52H//v1z9+3bt84EkBA8enul9oa8wMcWaTglu8fg1I8thiuWXK9RchmTM9Y68mPAoBJ2Va7qDXV4yUhX7oYpx46dLAhj2dM1q3rsNBaV/gN/qvofhSnjkfIHmPW+h8oeOAsmaWQSS9TdW2+9Vbp3794aApAQPLxWVn/8/Wxchg+DqQ/gIB2YBlM/cSMUDGYGpVGC3J9H3QKIMvISGPsdDDn4Ovhl0eoF/acrd8Pa1WS4UM3nCRTiwMD4ofrZNVFQQfhw4T/cd7Xj/WlkErNT/y9+8YuSN954Q7v66qtDg2kvrM/eFZG0qxbmwK7KRtvO+nXV9u5I0yYtHbkbiZ1JBBC/RxU78Pj/6/6pTID+Y874lQxg6wJ1bpTPFAB63J8aGVCMScxNuXv27Lnt7bfffmXp0qX9z9ti1PK43Sj0E8dLIYT4lAoD6bq+c9asWSnxUlBtEs65lEORk4yx6yT4E8cCgJQjhNgZtBZJ4sQY9VduN4iJiYdUyuGcH0DETw0i451+6qlAXJBYzxTrwG9cLMW7DwaJBR5M7z2QLvDQNjU+wEDcLnS8mXM4WjJ79jeso0gzeMSYxNKtKd8ok27BZnubN28eoShKIF4KowBQIF6Kw4cPj+jq6qJCyb4KGjHGtOzs7KVXX311IDmISNXO5Hio7oqb3qg8AgBoBmGxuxwzPN0rLsPPRJ2NG/EOT/fT3pfgnnQdWzY2vvSZAHEhKPCZgvyXxffcNbOhoWFIUVHRn112HmlhEkv3NJ1T8DCKH8d4KYQQu4nIV1GUd7q6uiQvRXZ29kW6ro8zCgNFKdwATjLG7vJbetAo5vwSY0yS2BglCYhM9h1d16UcRVHoN0p0uo1KHhi7EfrtLr+lFI3nYuNBRDkekmNUbqNmpRyDyDg2HpLjWiohbYlxsVwUf4lx6V5x/bC9dBhM7WweTqroufNIL5NYuqbgnIHH1q1b5wJEeSmEEHuysrIWTZ8+3ZWXYvv27dd3d3evCFL0OLGIMwAsys3NdZXT1tZGmYorghRxtinStIgx5ioHEa9HRCnHV5GmKAmQrDSfeko+nxqYFChdq64ftePmVfHrcXEymPoGjzQziaVL/b7Bo6ysbPCpU6cmcc4ldyXZIYYOHbqnpibKXVlSUrKkvr7eF3fltm3bqLI6RUBSzYvlM2bMCMRLsW3bticQUfJSMMbyZ8yYEV9Fy9BOe3u7lMMYky9bTk5OIDnt7e2S/8KoAp+fk5NjKwcR6eVvTlN5yHzGmK0cOaweZEBYnkgz12Nx5FfkAAgi6CUmsOBkQOlabf2wHa8gMK/facgpgwc1kkYmMXMa3iA/j3HdTJTMAS/PB6jAzbBhwxy5KxGx+sSJE8uHDRvWTcxEXgBiGEYlLwVjrHLGjBlJ8VJYAOSkruvXJhpSyTAKAL+lowoiVubm5iYlxwIgsmB0oiE1jYWpn+CcEyB6F6aO7kBileZlwhwRHXNoBa5EbSdCHwEC8gxi5FileWC8INxxBHxLUrw9LeCRgfB0Ag8CDfO/QYfpCh7GbmMHbavdGqaKWYgouSs1TXNtc+vWrZKXgo4qBQUFKfFSNDU1vWYcYdbMnDkzjpeivb1dykHEPbm5uSnJaWtre83QwZqcnJw4Obqur+acSzmc85TkCCGkHCHEGkVR3Hk2ojaQAJXm2XpgbKkn+U/iRFNcx59GETv7nQBIjFlnyWeAHQLELXDBwZ19Kc4j6EuQ6fvtgsS8ZDraSNLIJJZR8FBV1VoWj6qSPSWEMNmbv88Y68Fd6QYeVBVdUaK8FJzzMV42Di8Fkw1EiCgvha7rl5vV1KnKu67rHyHKxKMxXjYOLzmGDUTKycrKutysDk9V3IQQsfF42Ti85JANxBwP5/xyX9XfpBuXTzeIjuMqyQHiZ3JXoojtSXF2UOo35w2AsjraZwDyOHXKGMdQAKSPyghg8C4IUQS7nzjkNcbw9zRoIE1MYhkDj0gkQh6BGHelruvj169ff8w69AULFgzt7u6O4650A48tW7Y8zBgjhulXCwoKHHkptm3bdpNhE4mmlQMUzZw580U7tTc1Ne2guA1EfOTOO++UvBQHDx58GBGfpMLQubm5jnLa2tpuYtHs06Fk1+CcF40aNcpWzsGDB3cYMRuPjBo1SspBRMmYTXKIENdpWSDiTYZNZKhhGC1ijNnKEULQTo9iUB4hsE7DUkuuCfMLB0BzXg7NlfZ1hPOX0o6E7CnDgeFjsOvxOFbx5ISn9tRDDz0kz/JPP/103C7Y6e+pSeu/T2cMPCy7Dh0Rx1iLvkQiEYqXsOWudAOPpqYmMipORsQFd955pysvxbZt2wi8zvJSOACI4bVZR27egoICyUtx8ODBZsNtuiAnJ8dVzsGDB2Ny3ACEvDYAsI7cqaNGjZJyCBCYwbPBGHOVg4jj6FhCFe/dAIS8NiSH3Lycc2eejUyu2SlLVkQZ0dmL0HV6AbQ8HS3n4HRNfOgiyB60GgDvBgYrYVel/4JGGRiHCRJWALH7WwZE96smMwkeMe5KTdN6VKpyAhA38Ni6davkpeCcj50+fbonL4UBIGd5KQDmzZw5M46XYvv27TcIISQvxcyZMyV7VVtb2xHGGB0pxn7rW9/ylEMAYgABGVdpBzJv1KhRcXJ+85vf3ECs2Yh4NDc3V8rRdf0I55xKDoxljHnKIQAhXnEyFhsAMo+o8qwrDhHpiPBLIcRRRVGCs3Glunzzl1D195cA2HPQvMxfOURTZtQjQDVb73Lcqdj0b9KkSd9HRKrhmmf83MoYq96zZ48sbZDMZQUL6/OJu5Fk2j7nz9zbeA2AUIFJtnoLATLsB+AaPF/o6/iYMfDIhIK2bt0qeSkM+8THpoytW7e6V/0+2xl95syZcbwUmzdvHqkoiuSlmDlzpuSlaG9vl3IQ8fLc3NyYnPb2dl9yCEByc3Pj5LS1tY1kjEk5OTk5Uo6u62c45wMAgOwTMTmI6EsOAYiiKHFyEJEIdf5DCNGpKIozz0YmJogs+qekDeczGHpwjK0R1K28YbSqHNmGhsJQnusnNX/ixIny6OcwnEdaWlqSProlAsh5ARxFmxYCAoUQHACEt4AB1ZEhp2seMEkBeR0weAwaij2Pjxlz1aqq2uMFcHLFqqoa467UNM3xa5kG8ICZM2fGnWMzAR40Fzk5OXFyMgEeJIcxFifnnILHlMV3A7IXQMBU+HklRcb2vNzAg+7+wZLbgMMrwPAeR/5Uo1Vjx7GXcJhsVogo7Sqc89kAMvWfDN7jW1pa3koGK/sFeESr8ZEOaMd5vyPNpFkom1EVQFwAjcW2NjMo3HQ3MLYaEN6B04OmQdOszmR05+cZR7eqHXhIgEuI5Zg3b14e5zzKXQnQqGmaI3dlEscWMpye5aXI0LGFDKcAQG7SwRk+tpDhlOweg/vksSV/6QuyivvQg19zdL16gUd0NIo4gwAAIABJREFU9/Ff0jPTvOwet0U4ceJE86PTY4dh2ZHsb2lpkWUQg1z94tgigWPQUIBsWuN0/DgJzZXW4tNnh1y0qRYQfgiMjYWGotgu11YnRQ0jAfGXgPAiPF9c7qS3N0DuYCi2aPnNAIECKOWHz6nhBPA40NXVNWHDhg1xyVvz588nu0KMu5JsGWvXrnU8+5txGT4Npp7AQX23GExjcSOWuAxPg6kf4CA5psHUGjdixmUQMbEPg6kncBjgbBpMfceNlJSUkNs8zmZAwXv19fXBbAaSN4K1ur70XuBBgyAQYjgOdlVe6QEeJ8j+093d/fV9+/bFZUvn5+dTIuMf6IVqaWmxf6EcGs+kwZRIluvr628OAmS299IR8c9iGyB2AHQvMADkEDRX3tXj/ns2XAecvw/I8+H5wvjoYyfS6HsbJ0kmfaF8G164N752riHgDYA/3QxwgfnfoGPyCx7ULrnsViKi5K5kLJ67EhHX19fXu3JXpuCqnTNz5kxbXop0umoZY3NycnJs5aTZVTuHMWYrJ6irVlVVV5uBpmn+bQb5S04AsvWwe9nZr5VfnlRrkafJS6uA4Y9duVGj/KB+wONUS0vLBUEWdqZctQQcZj9SAhC5O7uWjNIGhwduAaFE4MK2k7Y7vuiu4wZoLL6xhx7cioAXbnpbHl8cdh9vRG1NtH6euhngkSA69rvzoLOvO3clwKvHjx+f0dTU5Hq+sgaJKYoy+o477iAOjaSvl19++Tpd19+nBpyCxDjno0eNGpWSnIMHD14nhJByXILERjPGUpKDiDE5foLEjB2HtBkwxiguRNoMhBBxNgNN0/zZDNILHio0V7q+9JZjy6KWlpaV1oUwceJECkCk4txJHVuSXlQOD1qBI2UAiS8cTl/ijTCkfZ7jUbFw028B4Tl4vvi5QOBx76YHgKEKjbNz060PV/AwXbHkei0pKXmAMWbLXUl5I/X19b65Ky3h6bG4jGQHZsaNAIBjeLo1LiNZOZa4Ebfw9JTjMsy4EV/h6UQYctZQ/UjiDsOyI9mvaZo/m0E6jy2AedBcea2bzidNmkTBfTvIg8UYW9TV1SXBT1GUuymYMFWDabLznfhc4o4jpR1I/tI6AFRjMvywzRduOgOIM+D52VEjtlNVPbNRs2DWvRtvA85fgIaiQMc+v3pzzUMhAKmrq5MJZZQgN3z4cMpfiXJXAvzu2LFjrzcF5K5MY2KcGaiW0cS4tra2ZQSciJjpxLhlnHMCaO/EOGMCVFWV2/6srKyvr169Os5mMGfOnBHZ2dnSZqBpmr/FEzWYToKhB7+eaYPpD37wg+G6rpOh0IztsFuzKblq/b4EXveZYGE9qtj9zasdiB7nyDZlXEyD5mURz+dSAQ/GXoLG4kDHPs/+mL33e2M67zNIgCQvRRpS8qc6kQIZJECvpCMlHwCmOpECUTSrEOKVNKXkT3UlBbJMhE/wOKVpmr/FY7pqGc93zLz1MphGM36b3Vy1CcBxCBEfY4wVGu5KGuG7qQaJpXO9pqWts1mxBgFUgCC8wk2HAWFVvzm2pEVhLo0kkgFlZ2eXe9lANm/enMMYq02FDIhzXu5lA2lra8sBgNoUyYDKvWwgiJiDiFKOLzKgBH1aji2LNE2LsxmoqhqzGfg+tkSDxKhm6amUgsQYXARD+LV2QWKJwNHd3T0+0dOS6bXX6+3/oGI4cPEKNFfeCEQBydmBQCH8RZueBYTrobG4R6R37AhjHlWsgyvc9KYMImsoLs3EmD35PDIh1GzT2IHEeCkoYY4IiDnnrV1dXdItnJ2dTZygeQYxcoyXgjFWEISGkDEWk2Mksu0EgFYhhJTDOZcZqSSHMRaTg4gFQWgIhRBNlL9CbZIcg+iYogBNN7eUYyTZSTlCiFOc8wK/Ow5TfyUlJdRXaTNAxEXZ2dnSZqDr+t2UGGjaDHwbTOnhDIanjxs3bvCQIUMotoOOKoe+FMAhdbp4CQAjXtv90MGnwr4KMzPZ3+tlumqB3QqNRWZWe/RZx/q+DbcA4GsgxGh4YY6nIf+qq64azzkf/+///u8V/jqVBHuQ34b93mfYQALwUsB6gwA5EIs6kQMZtgtfBMgAsB4AlgZlUSdyICGiPBs+CZDXGwTIgcYzd+7c4VlZWa8hoqvNIJCr1py02NmcPQdD20s9uTqk6zGnVua1IKuOc/UmLIQJEyaQDemHXxrgiAIyArBKEGwV/LwiLjPd73sC0d3HdGDsRp9BYm8Dgy1+dh0EHIwRJxDA4cOHfW8ofN/oe5BJ3khuXM75dIPoOI6XgnYHRCQshNhucnYkKQaI60MIMZ3cz0KIEYwx+fIhYivnnHYHtPvZbnJ2JCuHuD4AQI6HMRY3HkSU4wGA7b44OxI6kQAchxhjjyFinM0gqSAxU040SpT8/wSC7SDgMcdw9Wg4OkUq0lGvEoYefMoLbMaPHz903759wb6+yU7E+fJchsLTTeAYM2YMvPfee/0TPM6XOc70OBKBIysra3yipyVtfYgnA/oUEPYAM8iAEIYCk5yol0gyIORzoLnCNpIxbf0JGwJITIzjEI3oFnBD0MQ4K3BQEyF4nMcLjGghv/jiizeNo8qhjAJH3C4kZzoAUjTkVda0eQD8HQD/KQxt3+612ziPp6X3h2am5APcAsxIyUcgpv7X/abkJwJHCB4+pnHBggWX6Loeq+RGUZ30GHlGzEpuiqLszNjX3Ecf3W4xgvd+2CvAkWJfw8f7rgb+6q/+qoKSXK09ZIwt61cG095SrxE0FagyXVdX19LEZMDe6q+bHKJ/XL16dWgz6AuT8SXuQ58xmGZyDiKRCFEfxiq5AcBuMowKId4xIkdp53ER51xWjKPqKEZ/ZGW6uro6uj/pyyQHSuTuSLrB8MFQA31AA+c9eEQikbmIKCvTUTo9VYyz8rHazUFJSUmsYpyRdBapq6sj123gK5FVLASQwCo8pw9QLA3n/AGztEjCNv91IcSq+vp6ihn60l3+waNg82AY+MUkYCArxgHCp3DmK3ugaZasGAeFDUugschXxTg3LW/evHnwwIEDJzHGpByyQ5w5c2bPrFlROS+//PKSO+64w5ecSCQSq0xHhCeapgUiPFFV1SRLkZXp6urqnCu52QzKiY4wBJAMv2eOgVOboux4dtGYNl0iThvimNV1vXHdunXxwVkAMG/evFsURSlExNle9YqcRkxG8Ozs7L2MMckk9vTTT7sSaWdYc4Ga9waPgs0KDDr9MDB4EBBloejYxdhJQKiG04OWw6CObgC2NFkA2bx5szJgwAAqzUBh1fFyAE5S3EJnZ+fygQMHysp0XgBChtHu7u5YZTozwS+QdqKZqyaAnMzKyrrWryHVi8c0BJCgMxHgfmvWqQkUdn9zadKolNhNR1whxEon8OCc03qdnAx4EHAMGjSI2PRjTGJPP/20vyTGAOrI1K3u4EG7jUFf7ABwrxgXdRGBrBjnF9WtAzJ2GxRm7VqZzipn2rRprn1XVTVWMa6+vj6lSm4lJSWxinGaprlXcovuluL4X02gCHqEcaKC9LMYklnMftrtN/c4pa373HXQOFVV/S/G2FIhxFxjZxA3fESkBD46stytaVogzoyKiooBHR0d2wCgg3O+gAAEEQ+tWLGiJ5NYH1W6O3gUboqrGAcMngJuVIzr5t+XuxEAiqQ8ewWYHPOhl19+ucHIqqQ/UZRnrDId55zo5XvIcQMPgx5RVnJLrDmTzDyQDYQxJnlaiaRn7dq1R53a8QIIr9+t7RJ4JAMCyT6XjG769DOJABJwbUYikfcQcY6maY65IXQ0Jjauurq6CX51QbuaK6+8kgz4BpMYbOns7IwcOXLkZFCKC78yM3GfM3gUbRoHCNGKccSQld05HtbPi4/LL9g8FAZ1xFWMC7rz+NnPfkY1U2KV6c6cOTN+1qxZcXI2b948dODAgXFy3MDDQoTzqqZptpXcVFW9GwAIHImhm9ye+W4JZKqq0s5IVnJzyhfxCwx+7wsCAqqq3mT2P8hztovKKe3eKx3fa4Vmql0nuSmCh6qqROewys3WVVJSMpuyojVNcyV7tnbx4YcfbjDSCcw/b/zoo4/m9SfgkLDgON9ndx06KGIMbJxDEWzRq3DjMgDJLNbzCojull2HLoSIq1+7c+dOx8p0HuBBhZXI3bpA07QeBqiSkpJCxtgGv8BBgzS8NuvoDKxpWo9Kbn4BwVSYn/v9ggAZ7jjndLTaWVdXN8Pvc45zb+UtNblJ7f7mBRaJv2eqXbt+pOHYUlJSQvP9Vn19vSzMNXfu3Ks452SXW2XuRoj6gJIh6+vrHVnKrd1btGhRHWPsLJMYwPqnn37alfs3qJr93E9BYkKIfR9++OE+P/fb3eMGHrGKcfY8Ag4AEhA8duzYEZMzbdq0HnwFTgDiAR6xynSJbO4JwEFxHORFkaTObtf8+fNjlekSa9P4AQK7tr2e8wMChmGY+FXJO7VS07RFfp7zGm80E9TmshIdezZic0Om2rWKSoPB1Phg0Merg3aaRpDh24i4kzE2nXP+XTq+lpSUVHHOj9bV1XkWWXrooYeqACDGJIaI2ooVK7yZxJLRs8czV199tZxfRLw5WQDx9rZkoOOZblJVVVkxjiq5aZoWV+NCVVWyoNNRxfOy2htUVZWV3Ig7Q9O0uEpuXiDgJMjrOS8QMKghydBGxur9x48fn0BbX7Li19TURF3oqVyJL3qqwGH2JVPtmu2nz1V7H2Psmrq6utJIJLJXCLGT+HrpyEulLo4dOzZ22LBhdPSl47F9ESajT2Qg/eKLL6iIuQxAZIw999RTTwUr55nKXCY8S+BhZtImCyBuOw+bL4+DK5YYi0CWujsKjcWB6qvu2LHDtjKdnSt2x44dMTnTpk1zlOMBHr5KQZKu/YKHgeC2HpZkgYOes4JHJBJZSOUtNE2LFZ22uJGPdnV1jT516tSxYcOG0XGMFve36+rqUstyzdRLnql20/hyUVMlJSVE3XB3fX19gRGlTMdheSHijPr6+u0EKrquL7dz5Zr3lpWVDc/Ozn5lxYoVNy5atIjaOLBixYqki4Hn5eWZJRPsRky76Vvfe+8919rJJnhQA5RNmwyABAQPiZnxsRzFG/NARD0R5KiFxmLHinF2I7UDD2Ny4mI5tm/fHqtMh4iNd9xxh6McVVXdji1k4KKzLO0+6Ot8qx+mLbdji2VB+QIQrx2H2Z4JHiUlJUsoaYl2F0OGDMmnXYWxmMmITAFs4+noRen6iqJQKQZZfcw38bHdxGTqeJGpdtMMHNScMedVdoXeLXNEsUQFbh6Zhx56iOyDRIK0f9CgQVMrKgIyidmMzQFAfAEHNWcFj2QBxB94kLdF6Z4AG34UVzEOijZdanhkaEtP5tex0FDsWS3eqosE8DiQnZ09YcqUKXFyfvazn8VVphNCjJ0+fbqjHEtchpPBNDCAmAZTCnF3ixvxAgav3626McHDcD3/0nCLU1wBbXcJsEcgYqmxlV6NiCO6u7sXZGfL8oXtQTwAceszU4bNTLWbAeCgJo2j6l5N0652EkEk1F1dXVe7JVAaRagqOzs7V9XU1CTHJOYNIL6Bg5rKbFZtT2v1MWBspaxAFb1uio86xfXQODuw1Thx58EYO0YRfZxzKUcIcVNC1On6adOmucrx46oN6nHx46r12oEEAQ5j8cbiPFRVJeoAOrZR9C0dXei/LxJARCKRWkR8wNixbRFCRD7//PPkYwYy5VLNVLsZAo+CgoIBw4YN+xMAlAoh3h0wYMAhymamrObOzs5rOOcUUr46mVicdHXZ2IGQbcbzqJIumWY73jsPostDdK8YR/d0DJqRTEVuC3j4qkx35syZGbNmuVf+tgaJAcBoty2lH4UaL66sGOcVJOYEIIly/ISnJxpMDZcsnZnJGHxgyJAhY0+dOvWEUafWFPFcVlbWcr9h9H7G/2W+x0+U77kED5qbv/7rv77017/+tWPgYqbmzwU8DFcsuV5l2TrJZzk8oSPHAKESni/2XTEucSCmK5Zcrzt27JCV6RAxTg7tRqgy3bRp03zLMcPTneIygihUVVUzbmSNn/B0LwDxAxyJOw+zTSO4bbWiKGN1XaeyksQ1al5PaZr2iKqqH2ma5lpkOsj4v8z3RiKRcRTQReHpiHgNABAz/inGGNWbofD0Rj+u/vNRhx7h6RuXQePsKNsQJcgNPHMLMD1aMQ6V38GZga9D0yw9VcUQgNx+++1SDiXIDRw48BbGmJSDiL87c+bM67NmBZOTrsQ4s+wmHRWCJMY5AYhf4HACD+PvI7Oyso51d3dTOQmTe+QxTdOWuz2X6jyFz4casGrgvIzzMAdo8UiQZyXVlPypyZICJUsG5BTncd99911DBb6PHz9+wbBhw8jjQnEGsSLIXvEh4SsQaiAdGjivwYMUlEgGxBgr97KBRCKRHCGErOSWKhlQKpNkd96m87VlNyRLSRpbawKR2HHvXJ/DUxl3X3t28mM7ruEMVAT2fQQkNzgwYB8wwP0CQdv9xLRDfa3Pdv2ZOHGi7xgner6lpcUVH8578DAAhGgIYxXj6EtNeSC6rpu1WsirM0JRFFnJzaAipEfpbFuQ7I4jUwvKCIJbmpWVtTE0jDprmQzdiEgxMkQvSdnfRxHxHcZYpdcHxGx1yuIdCwXAExxgsJ0kQSn1AI/tenyaZ3h6ptaD33ZD8PCrqYT7DBtIoMp0WVlZS8OXM0mFn8PHDBcr0TjMpoBCxtjdxDbf3d29DxFfNOgfNh4/fvwpp0zWgorNA/6kD9jBIRpObl5c4Z30b6EL8njFLgG4+wKlc1pThbsnsIdaJGdOBwX23QCI98PzszPGJGZU67NPaE3oGDko9u7dG8euntj3L8XOwzpow40rK8ZRJTezXCNjrJUquZkV49w4O87hexGK9qEBVVWfJeBgjM0TQtxA3joyJquq+ih58iiGCBEpjH+jpmm2+SVTluyoBQQZO2Ne37n6q/9Wcff/LflrKl7830f/9fAfv53Qnepdj0/zlV0rnyPgGHpqKHQpr8n6K8TM11CUUSYxPwDiBzio+1868PCx9tJ+i59YASehoe0i2HQQrwkAvAAAZECmhEH6fzKY07GDPIMdxtGF2O/uA4B7EtMTpix++ToB7H2ekED5+D1j93/nmv9F5FTwr4f+e//iF34p/21eglIFFPx2c8Ud3jlFVD5y8OltILADsvUFBoAcgsbijDOJuQGIX+AIwSPYukz67mS9H4nPGYS8RCEQqBSEmdRlAlFeXl6c4ay1tdX1I+J0fyIoegGd3/spgnPgwIELOedkq6IoTspCfVcIsfvMmTPVbjVrVFUl4HjH9D6pqkq5J5S/9LERbr7PjIFRVfXHADAuMYzfbtdBffirSy8+/My8v5VG6Z+s+5dj/370hF3YuvfuQ4Y9dLwEzGASQ9gCA7si8PmFJ9MR+uBnodoBSBDgOK/BI22FkWiiB3fcDignmoKEpLUdQJb3OyQrkXcM3uk26WkED/qKvkkcJIjY7OdlNe8FgO+aX1gCAy/AcFqA1meTHRe17fRsWVkZfc03MMYGUAo851zmMNHxg3NOlf7I5jCnpqZmv10fKSmScz7WPHaqqvoHygOjbGRVVSmk/wh5qOhZM2cokZ9lyuIdBDg018lc7bsen+bOZxpP70nRTBvh9Ffm9RZwmINKNKB6eVcSlXFeHlvKysokJ6oQYk1tba0nYbHjCqGaoEwQXwN9/cgesgeAGZXakCINyZU7AkAWei6C5wttXXbJvmR2zxnbcspxiaMMcHiRzB1GDDjovr4KHmVlZdMZY9uIJOfMmTPliTsMY0dSRUxclBJfU1OzPXHcyRwRE0F48qM7znAuUwDirtzLh8OKuYTfAIvWvwVt/2Gb43Zy1+PTnO0WhQ11AGhhEvOXE/ad73yH0hDIZrP8X//1X2UJEb9/c1rfIXgkaKasrIy4LChGYwEiruacz3nmmWcobybYdbYa+TFgUA4NxT+1baBo052AUCtjLBg8Bg3FPVx2aQaP2JHDz87D7LP1Xit4JB5JnJRk7lScdh5+X1qzH4k6Ic4Lxth/kDekpqYmxq5VVlZGngioqamJEQyXlZURld/diHh5Ypaqzc6DEtsuC7LzSAU8mIBTry6fJnc2Pa57N1UBO8skBsA0aCzyxSSWl5dH45Ch8a2trbJ9v38LwcPHq09sTZ9//vlhYl+vrq5es3DhQjKILbzwwgtzKyoqpIvN13XvphUGM/yLcPr0AmiKxAh4bJ8vqLsIBg2iUg93A8JKeL44juglneDh90vrBSxmO352IX7u8TNGt3tKS0uf4JwXnj59Ote641i4cKEk4Kmuro7xxtIOZNCgQW1CiMba2tq4Ql6GzeMtk7uW8nwAYLyDzYPWBxFHx5EX3/bo9sPI+VWJuva587A/tpCBdNDpHQAYdf0yeA4ain0ziVn4O55qbW19xAAPkxTI9W8hePh468vLyylJbPbHH3+cS/57oum77LLL/o1ccjU1NSt9NAFQtOmHgEDGrECTK9su2vQsIPwYGNxl3an4ebHs+ubnOYejje+SDX6Awc89yfbVHHd5efn7ZBCtqamRL4bXVVZW9iQZVKuqqkZb7zWOdXTUXIOIVHmQAsToi21edOxsjR5BYS7NWqK35bZHtz+LnJMxNe7yBR4MVu2qnFYa9+DcdcOhM/sVaCy+EQobmgHxQOIHxmu8ffH388bmUVZWdilj7Lec87usx5Sf/OQntwkhiOr+ak8iFvl16PgIED6DM4PH2BqwnPgxaXajVvT3gMFQOD0416Qo8PNifdnBo7S09IyiKPdUVVVtsepi4cKF8phWXV0dt1bLy8vv1HV9XW1tbQ/7gqqqVJuYjjXENkd8MJ8RiTHxvBBhEjGiM8YIYIgPpcexwclV6wUe5KrlgKN3PX5HfJ0XKsUKKJng4PTgqdA0y7Cb9UVI8N8nV/AwDSqJVlinv/sVa56PE7fWTn/30+7ChQtfEEKMrK2t/e6CBQuIFJi+OntWr159a2lpKTFrfehpPC3cRLVcXgDEqfD8bHs7iRt4UEfv3XgbMEZ5JvdAY7EkxQ3BIzqDHseWE4qizAsCHhToVV1d3cO+YESYUiTlDxljLyLiD80IU8bYTxGR5vmnx48fr2xqarI9ztrtPrzAA+x2HTRwuWawEgZ0r+pR+8jP4u6j9/gCD+q7CSBWC21Q146pA6txzWpAM3/3e1437y8tLb2ec/4+Y2xMVVVV6/z588nVR6HJG9euXTuHfgcAovEbW1tbe7b+TOKkFG6iGIHJcHrw1xzdZl7gIWv7dlA5iT3QWCzP0iF4eIOH07HFaedBNhJFUW5LPLZYp5Qq/QHAo4wxcpFQaYpPEfEtyrCur693Xge0ibQJT3cDj6TD088xMLz00ks4cuTIq2+88cYPg3bF89jilEyTLHDYAYi100GBg54tLS19k3P+cXV1tXxZ58+fH3NrrV27VhrUSktLN3DOL7Ea3nooq3AT+fdbzZfeVple4BH90hAIjYPGYknIk2nwsOunXz36sWf4ucfPGJM0mPY4trgZTIO+AF73n0+JcXZjJfCgv//lX/5l7ve+9z3vyFhLI57gQfem6g92miC/EYduE0yuWdq+ElHPM8888zsDPIjTkQiBF6xdu1YmGjnZROLaLmo4AQLXw/PFZ/MTnCqPJXbKWuwq6pL7MTQWy/oufl4suzE6GUP97tDsdnj0bF901d5///0jsrOzPzI8KLHYHLudR2lpKbngC7u6uq589tln40m5vdAgid/NlHwd4RaFclAozh3hA4XB6/0pJd9u6C+++CL+/d//Paxbtw5ycnKu+9u//dvf+FVRvwYP4wv0WzrXVlVVxdyj8+fPN4ONZqxduzYWSFReXk4VwO52dN2mFzxUaCyW5/E0g4eMMqV2vXYXFvDoF0FiZAQl6gQ/QWJElZBoH/G76MP7zmrABA/6y6pVq2DMmDHfuummm9r86MgTPPrysYVcs4hItULjPCn33XdfnlGaYMyaNWvILScvC9isrKqq6smHmt5jSx40Fl+bTvAwo0vP5/D08vLySUIICgJzC09fUFNTEyi/x8/L8GW8xwoeNP7Kykr47ne/O/GWW26RwXluV781mJrHEABYWl1dHRfVSdb2v/iLv7juf/7nfw4kWtPLysrmMsZW2Lpuo7aKSXB68NfTbTD1mgin3xOq1qFRWzfQi9MfE+MGDx5MHwUKqJKJcZQCwBjb3dHRsdItMS5ZPZ+r58aMGUMpDlS1jeJOev2yggcBx/jx4+d9//vfX++nI77Aoy+6ask1SwvL7ghy33333UY7Es75c6tXr46LG6DAsZEjR76n6/o7PVy3MVetyIfn59i/oF4G03s3TAbGKSoy5qr1MxHhPV8+DdBa/Oijj2S1xSuvvHKMEzFRJjVjggcBx4QJE8puuukmSrXwdXkeW3y10ss3lZaWjuOcU8Xye2pqanoUGL7vvvvILUtfrNY1a9aMSexeWVnZZMbYK4g4uqam5mxATzRIrA0QTqUYJHYRnB58bTJ1bHpZlV9acePGjRvc1dW110j5v7+1tTVjDF5OSh4zZgwlb1KUK9UDWv/ee+819vaEEHgcPnwYbr75ZvV73/tefRD5/RU8XlMUZWhVVdWNdoOlnYcQgnIlVq5Zs8a2enlZWRkFcnXU1NQUxLWRgfD0IBMS3pt5DRBwnD59eijnnIIHZV3f1tZWVwYvrwBGr98TR0V96OzsPGxEwRJfScOAAQOufuedd6h+cq9dy5YtwxtvvHHqpEmTAieP9kvwWLhwYTdjbHlVVZUrx6LbDJSXlxciYl11dfVXetxnZj9SfkvH4FJPnoUo5wfR1v0YEKrjXL29tgzSIIgoCECo8H/a+xbwKMo03e//u9PpIB4uijprZuaQQUCzXqAbOebsjBgiI8sl3tB5UHB5CJ2RA4PISGDBEAMsCcy4/Q7wAAAgAElEQVSgjByYBHgcQFkHUAwOE5ebMrqwQjqwcsJN0N3RPeuAunhE0p1013eer7qrU11dl786HUig/ufhAar/+ur/v6p667t/DKimRlvdEoR9ALzWrOSA2dUZYwUijZGsMnwlSSo4fPiw0u40rQ3n5+d7vF7vm/ThkCRpKgEINXBqaGgwreBl5PamRZj9ZrRIn89Hxv4HGhsbh9Ecn89HBspdwWCwKq2NXYaTuip4UI3Kx+O1NNJl2zlEXKebiCVHiYbmAGA5IBwDwPmG4eoUjg5sETC4DYBVQshbZQk26a64I89rK0FwFBA+ACYnjwEg+IDJpfxuT6fkQPzFoliMh7UJaNrtmAWjxYFFphMMBilK1PaI2xheB4hX8ALY6vF4SnNzc4X6+qYbGe3z+Sju6C5EpExdKkgk/42IwxsbG6kcItXmoEZnBCCUwU3RntS4+jQiHrkcKpUIc7skeIhsLCNzkosBfRHPxFSSmpRiQBT2fBAk1yR47UlbEXoZWaMAkfvvv59iJ0736tVrfopRTkkVZ3APIE5V8nFSyJIxmbFVcqPzkLdYbc8xi2Oh3yRJGs45p5fWFECswINeNsaYTCcdABk8eLBcJEq1t9/l5eWV2DFUagMbFVpmMTdDhgy5V5IkMqKvQMSt0Wj0C6PeskOGDLkpGo1SkidVrpvBOR956NAh3appAre+Q6c44GHF3phK8lC8DCF9MSiGhEYQED4FDr+H5pxt6Ugb9yyHnPC3MDaMsK2pAlp8lfBRsBzkitz+hfBo1jWw48Cz0C4duKioiFoQLI2veeXu3buTa0hMXE/q1uPA2FDYMPHPpuyYuOEHgPghIGxSq2ZW4KGmafaSWYGHmo7dMop+v78GUV3BC9YFg8ESq9uv93s6kdGDBg0iIz/Z2ZZZqSak0gDAc5IkjdaqaQMGDFiEiJSvs/jkyZNy6oXosXT2anaOAx6Z5qgNev4XYAIy2MAA3mmWoNjLIRwsB+ZbCGsBYTJDmNiwANK2wBcVFZG6QaIwldRr4ZwX7Ny5MxE0B0+8cjtwfhiQj4RXJyTHGRi5pJ/ceD8wqR4k1x2KpKWAhyqblRpwk4S2Ud0bxSrSVgEPsktkZ2dTsyaZDjWT7tu3b6LHikiujfo2+Hy+X1NRKOUYY6y2oaFBqIJXpsCD6Ph8vtsBgIy074RCodKmpqakjN64PYbKCVB8y4hgMJic2k/6Tr9+33LOu0uSdOH06dNyBLPoMWUvCIjBhrbHwOyR9flJa2W6OOGAh42XPdNT8yvA4+Vym4BHGcABpGS6WJEaChzamjcQfrblMbldgO0xcuTIPq2trRRD8AM6GRFL9uzZkxz8E5M67paL1GiHWTzLhPX7ZfUlngOkgEIgEFAqWyWoMcZW1NTUyMVxRMFDVTVLvaoVwWBQpmMHPOiFzMnJqYsHnBEfVjY2NgpX8NKyJR21RU1j0KBBt3HOKfz7h8FgMEnS8/l8dK8ov+eOw4cP66rA/fv3T1QPO3XqlFw4SfSYso6Ghgb0+WICNCJBCVKB6fifKEgS/T8KnDM4fvwkhayLg8eJcf4BUQkDwPFekKSY1Z3zIyCxfS7OagduaegSvTltv3GX4QQZQBjsAQ5bg8/DisEvwEMMYE7erVCQLnDQNoqKikjHlkveMcbW7dq1K1VEp3B8hJXw6lOJJtkJFpiBx5PrZwDDAGz8O7lKuAo8qFI5FduxzLvRY7UCCj6fL0HHrnqipnvPPff0bm1t/UNDQ0OB3+8nfhxtaGhIKhFp55anazBVX8Pv91P+zoxgMPhjAx68Hwc4/Zq5dhZsMFcBjzbAkCAaJdCI/d2jRw/25ZdfosvF4cyZT8TB4/i4Qc9KEi5inOv25kRJauaczb91y+FO35szA3zuUBK+Svh3RTIISZBNdg/5y1oJn8d7qx5VbCDahQwfPpwK3TyXlZU1sr6+PimztKioaB4ALIqfE+zVq1eBbtGbCevDgPhwwpNklUGsZA6Th4nz15TuZkbgYfSV1u5F3U+GwEILHlYuXIWeFmh8Ph8VBKJkyH3hcHh0U1NT2hW8MuWq9fv9r8c9KFV33nnnzW63mzyHEIlEppMRlewd5Jmxch2358Ek8Bg8eBBEo8mgQcDRs2dPGTgISLKyXHDmzKfW4NE0Lt/DMbsOWexrZTUYwjsSCxfnb0nW26zOc35P5YCvEvYwgG0N5bDSvxDGIkJ5SIICBUy0Z4wYMaJQkiQ5cYmaISHiiN27d8tFmuN2jvfiXdK+5pz7d+7cKZcqSBntAQ/yemiyhtVqCwFCO8Ajof7EwUSou7sOeNB5lR6PZ8WBAwd0+ySIPo9WQWBWv9N14oFhX5HtSZIkiqWh0oSKKkmRpgs45/skSdrv8Xiu66iAMQKPO++8U5YylD+K1EF/kxpDw+PJgtOnz1iDx7FHBr8EPNabk7mzWtg1Pc9L35y7Qc1c3qPPWfzufE+MtMo9LVBiy/PfCIr35hS9U11wXrzYMlUwoxJ306l6u8g2fJVAPVP/DgH2MYC7kRLAAO5VjKh6AFJUVESxApSWTwY4utl7e/fuPfLChQs9WltbqeAzuY+jiDh6z549xkl0E9Z/DAgrMqW2kMG0Z8+eS4gHtbW139MDDz1Q0UoeccMhAcj4YDD4PT3JQw9U2qPiiNyr9s7x+XyjAIA8LtQX+QLVm1FsG2QLoRo0jDEKASCDxOhgMGg76lNkjQQet99+O7S2tiZUFbUKwxijcHkZPE6d+tgcPI6P890uSdHDjHMXerKb+/9mWxO7ttd1n0wd9d8i33x9HS3I3aP3V3mrdvw//Pa/vjr1i4fyWUs4B2WrCrsjf4u+cUdkI1fKHOo7wjmnXIm7JEn6Rq8wr3av5I5FhC2KcfSTExDJGwjuT06AHMjEEEoaFiS+TEmnFxYW3sw5pxweufEyIm4jKzzVbo1LJAt27dpVacrfWLX3u2DjU6n6t7nB9H05iGzDU6aGUC14UDPxmpoaf2lpaYPSYJzWpwUP7Zp1wCMYDAb9Pp+PDMKK6xy6AHhQew5qsj4rGAzqpk34fD76+JB3aFswGEy/YZnJjSfwyM+/DVpaWhP2DUXiUIDj+uuvZ999dwGPHz9hDh5aqaPfyrqP3L1v9Edamj/+9OlR19M6+q7e8aXbk3NL5Ou/NJyeVnyHI3203R2qbMUY6xOJRKZ6PB4qvnxMKYlo9vIqcR4/uhW2knGUbCDBcvjhuM3gOnMcHs2+FrabxXkUFRWR5EHqi2ykVI0du3fvHm0JzIqrFtgI2DhRjnRMDCPwmLChEAB3giQNgtcmya5EIy+K+jgBhgIcWgARAQ9V06kGBTi0ANLZwYMCwC5evHjByvaSn5/fvVu3bt0PHTpEgYkZHwQeAwcOgO7dr03YN0hVIWlD+eNyuSAryw1NTcfMwaPpkcEnGG/rzUnSx8DVfzzFr+15pxS6KFcV4t5u+dK35//1xNN/25+kjsSOJDh22xuN5r05M779zkNw5syZ1J1OVvcoehAASj///HOhcOdM7KKwsJB6uJKNQ7knFNrsV2wglteISR8PAWMFgkFi++X+vHGpwwo84lJQksShSCDac41csCrJQytxyP8nOnbct5Y8ucInEHj0798PwuHWhH1DkTgINAhAFPD46KOjlpJHGDS9OWUAqak/w6/p8dfES+m7b/7Px1NH9pWaw9eoeYsgfZO/5UhbRuKYxWTlJ2v/Ynh7Xqybl+gxFWFETNBhjMl0RI9dqnv/zDPP/Jpzngg+AoCVy5cvTzuGIN1133///dQAmpK9yFszdPfu3SnBRYa0MxSerqWvtW2YGVDVkoeWjta2YWZA7eySR7r3N9PnEXj06/cjCIdbyOAugwWpKefPn0cCDQVA3G43HDlyJD3w6P/y28fdva4bTIuP/NdXjaemj7k1SeqQUQUu3PZGY1vvjFGLvwUO3ek47JgXOy56LBk8Er05GWMyHUQUOpZpZuvRo45ljDEKI5YHIlaJdjvriPUVFRVR8lXzrl27fpcWfW1iHAe5Oz1IcLdVYpzR9ex6W4zo2HXVouIuSIsRsgfrig6eJPAYMKAfRCKSDBy0XQUwGCOpg46RCsOgsfGwJXh8DFzO9JMHeVv++8t1/+q97sYh0daWM4hRiewdoa/+cujfphffqdg74g9XstoyZtESAHqpsArenh9rHSh6LBk8EpF0jDGZDiIKHUvzmRE+LV4LlQydilt7/vLlyxcLE+isE5WUfIBCiFcJBwTqb7LXLCW/s4LH2++nxjJGIhHZy9Da0gI9uwGMKlSqHLbt4koHj4yGpzc9MvhlxkHuzYkcov1+s73Bc8PNQ6Otrf9+euoYWZfut+rtZldW1g9bzv7Hh58888igBIBIsOK2NxqTe3N20pdDBT56K6Q4iREUN2G2/BkzZgxwuVyHP/vss2u///3vUzWyHS+++GJqhGYn5cHVsCxF8iDwGPPjAbpbXrd1H9S+8iqUP1sCo4YPTZqTDnhEo9F/oI49lM/jcrn+Xu+iInO60v2RxTO1q5bnZH93y8tvn8JuPW48M20Mj359lmIGwNX7hi9+tPJtiV385i8fTx/Tn2wf5Krl3DXo1i2pCTydlQkGACIEHLSnePsGily8oNfqsLPu+2palwIeb713DB4cdpvu1le9thNu6XszzF/8EsyfORnGFP2PxLw0weOzuc+X5y5ZWPm5y+X6vgF4WM7pSvcpoduppQ9SW9w9r/+y9cv//Cv1ZrKu/97/jZz/8vquKHWo96EBEGHgIBrxhswUCfi7ZcuWdYgrrSs9QJ1xrQp4bN39ETxaJFc4SBkrN74DG19/I3H8wx1t5TuvNvB4NxZwSBnYp+8DuEX0nraBx1UWnh4HkKdFVBVRZjrzOgcHFPB4vT4IPxuZiCFLWlwkKsFvN1F2PMggkgnweG7u3+cuW/IPppKH1ZzLwcF3AZQkyqP3QayejMhIsSpfTYlxiEgVm/5DhFGdfU5paSlFtxaq18kY21tTUzPc1tonrKegsyQ6ssF041P26Ix8fg8A09DBvVC/0Baduro63fUUFxcb0lHA49W3P4QnxyTbM4gX5IxpDkfgwsVW2LzjT7DhH7fCwT+ubbfaMvO52bkvLltqCh5Wc2zdqwxNfg+gDgHGAsAH9wHoZvvqXUrXJaWk5DN6iDjGUvIldgQB9jop+Rm6Y3Eymzdvdnk8HsqQLUREF+d8bygU2vTYY48J1/EoKSkppNB4g5U9UVtbqxsKnTI/Fj1qSMewRKGW0MiKQoBY4l7KYPgE/HGh0Hq2b99OPNGlQ203HnzwQV06Cni8su0DmPQQSePJo6U1Ct81t8K3F1tg+679wuBhZvCMRqOfPfPL53Jf+tUyU/AwmiNsTH1m1yLgbB5IuBheuj8WRyV6zOABeQ/gNQSgsPhd9wGMEH3Cr2h/tigTLte8zZs39/Z6vfXx3iHqL99Bt9s9urW19WxxcXHKPdKTMkT3kCSN6EsZoqTapBFdKUOUTJs0YiBliBLaq0gjCnis2fwuTHnsvqTzoxLCxVCrLHVcuNgC/7TvQyHwUF7uZ2b9MvelX/8qBSAIPKZO/0Xuqpd/YwoeRnNk8InTNvPYwLM7vwXg3QGkC7B8RCyOSvSYMXjUIECAAWwfBlAsynAHPEQ51QHz6urqKCqUEqVWIqKchcsYIzsMuc0po3KUHnio6mdoU9VPkuuYMUZSC8WgyFm32pGoI0r5K1SjI7WOx0lA+fqU+PgAIOrSkc+lMbIcob6SyX8nj5OAbAdwjAIar0c+FwDq6uqQ9kt/p9CJ8cN0XwqvFPBYvWkXPD1ezhNMjBCpK80x4CAAee9AgyV4KMDx9PTpuRQ8teo3K6jeSsqYNGVK7itr1piChzJH7/ypv5iRiyjB6pdfJvr6Lt+Ze5YAwzmArApeHB6LoxI9ZvAMvwtANUWmMYBNw6jToeBwwEOQUZmetm3bNspJoazY1cXFxUnZk3V1ddTyT86XMQIPnfUQ+MxFRNJdCYS2x9MEqABy0kgCj1RCqyEUmgveHJkOhJq3Q7Z3HjBIoZMEHnp0WsNzwZMdo9MS3g6e7HmAOnRU4KG3r3A4PNfr9cp0QqHQ9uzsbEp/SFmPFjzIozJtQlt5GjKSKurKdxdjasu/BI+IgMdnT02enAtAodyManoCveSxTFQqTRH/NwBs2rjBFDzGT5iYSy+dHNkpR3fG/804IFD5P8JNhPXr1hnSyfSz+C6AHHyJAKsLAYQzeR3wyPSdaCc97VdXEDyORqPRYS6XixLkFCmBamAWICI1NUoKozQED8aOQlbLMGj1vNcmbeAxCIULwOsl10RyOKZa8kje91GQ+DDgUvJ6WsMF4MneKddNVQ9j8DgaDoeHZWdnJ9EJh8MFXq+XspeT6JiBh9pISqChgMfho0dFwEMOAHv40XG5wADe3LJFV/KIb0kkSEz3KXl43LhcQIA3t8r0Dem08xFLOX0vQDkDeIEBLB8GIFyfxwGPTN8JQXoiIGFESidnZDFj7FNEbHMZxKSPEkTsrWq9IJM0ljxwMQD/FCCZDgArAYa9ARMtHGJLMwaPxXJbCgZJ6wEEqqPaG5iGjgF4UHsBABDelxl4qI2kir2D1JdjJ45ZggdtVVFdRhc/mPuHurcyLhWQzUOhfSmBg/b2LsBNCHAzAnwxHEDY+5gKHoreGr+hKQ+w1e/xE5SXQ+/LSVOsftdelyp19erV63FyR3LOXZIk7T1//vwmOw17ZJpyN7jmxwFkt6YLgO+FkHeT7b4r48a54LuBj8fckcwFgHvhmuObYMsWIS+JCjxmFRcXJ9WDfeutt6iO5RJEzH/wwQdTqmjrgQc1dWKMUVWyxEDESVRnxCZ4nAbAJDoAbBIw7GMPPPA0aNYDiJMAWB+b4EFd05LWwxibhIgp+zICD1JfzIaoq1bYIyL4AVFP60jaIsvZDXBbEVB3RPFhDB5EQwsgaoOYEbhowIP+qwUQ9VfXCFzUW5g8eTJV6arXit+IeDASiYzOyso6a9ZMKEFr8tre0JJFATHabKiD4I6OhojrbOJrasbDn1b0BpdUnyJ+MzgI2DoaIOtsCu809IgHVNcCEQcwxkaPHTtW7gpWV1dHSjoZUg8YxTLogMdRt9tdEIlEyIaixGOfdLvd/kgkQvtN8leaqi3N3gLwXvwQgCXoQCjHD97mFDomksdRaOYFkCMlrQeauR9y5M5pyf5Tc7WlIDs7O4lOOBz2Z2dnp9DRAw8CBpHR3jgPkWt01jnvAsgV2RjAn88C5D0WM0xbDn21RQ8kbACHclU9kLALHESrtLT0TUSUvRKMMdkrgYhJXgkh8Hhy/ZvAqPANrISoK1Zj1BV9Wm5QzdgOQBwlBB4jy+NeErYSILYeAFoPTgMGOwBhlAh4kGTBGKMXg+pWEuq7qAEYY4yK9frHjh2rW7hYL9UdEZczxirjfIKsrKytkUiESgaQcTFpmBpMqVF3OFQJ3hziN0DIuxW8F+cAsBQ6pgZTZMshEqoEtydOx7UVciTd9ai9LTpP7PJwOFzp9XplOqFQaKvX66Um0Snr0YKH5dNvMCGd8PR0r9UZztsLsIoBjEeA7YUAE0XXZGzzSHW7xWhaSBzaC+u43eQpIhIHzfv5z39+tyTJX7DVtbW1SZbg0tLSl6gHBs2zBI+J6+8GBJkObHwq2aIca34k07EEj58uuBs4xujUVybTGVme8JKI8mn79u19EZFqVlLDpyhj7APG2KwxY8YY6p4mdTIofZ6aRikuTaXTvTh4yDgop+HvAgYxF6uSnq+9ucY2D2XmEWC0HhYFRJKodNdjAR5ES14PuaDjzZt06Yg+U6IvhzPPnAPmBlMtgNgEDuXS7TEOGi0/nX6hurS0MQ7KC2H3yckQr0QuGwgEEg2dROZr5rxTW1s7Uj42YUM9gPxSpzHYO7BxYozOA8/XA2Pp0UF8B95ZKNOpq6tr176Ki4tj63HGJeFApwePqxkkLskT4FzkqudAu7NqUzjYSdQWBTxIlK+pqUnySgQCAdKhqRxgfk1NjbmlWJEwGMyCDU8ld7ubuGEOUJUyyZWvNG82fKIUvjCcBX9cmEzngefnAGNLAHg+1FfYslxf9U+ww4DLxoGMZdXKO+hEBlMCD8UrQU2M1qxZI3slSktLH6Civ4yxA0KZozHwoNbgAwDYaNg4UaYDT77yADAuezeEMkdjvInTwdFQvzBG528rHgCU3gTAA3YzRy/bU+Nc2OEAAGQuq9bMq2LD42LmVbHjcYmDRz6ibKRM8koAwNeSJPnXrl2r305R/WgQeJBkwaNxOngsFp8ht5z4GoD5YeNEazoyD3g+gGzETVkPRCU/7FxkTcd5bB0OdBAH+vfvj6dOnRIOAM1cVq1VEJjV73GGWAWBWf2u5WtJSUlfl8v1a0SUvRJUe4BzPuu3v/2tcEScTHPChr5A3g0W824QHYipMvbojJjfF1w84SWR6biis+APi+3R6aAHyCGbygG7z5wRD0X60trhf1FRkZwIuHv3buEX3og+AQf9ZhM8nKxaOzess8z1+XyUi0I1UQnMqHUkgc8BAPgBrZFzPvvQoUMx1cgZ7eKAHYnX7EJqI75liIDFihXgyAR4KMBhFzycrNp2PVaX/mRq5pyTk/McIhJw7EJEAgjq9taPQtPjAWO0sC+o2fOlX+GVd8VMhQxkygOoBo72gocaONIADyertis97n6/fx4iPouIJY2NjdvUa/f5fJRVKTewJkkkGAzmiuzNrq4rQvNKmqMXsJhOYJlekJ5dCUQLHO0BDy1w2AUPJ6u2Cz7l1NBYr+nx4MGDH1CS3Ci5rbGx0TyzK773dPRdEfHc7ouhpdleW0OmbAKO5KF/tzOXVdsFX8KutOQhQ4bcK0nSUlqziD3D5/NREtmjwWDQsrFWujqvHv8ypddnws6QKbtAJtZCvMoUb4hWpvZGtNpz/zOTVduV3kQba509eza5ZKmj/b2UhEbNs6uqqoS+6DYuYznV5/P9JwDIjbRE7Bl+v38CtYkQUV3ao/eqF54pnT5TX/pM2QbaKwEpPLrSvC2Zzaq1fAXsTfhiX+XtnLMZkoQrbrq33LKDe1lZmbaGZeKCjLFSRKzRW0F1dbWuq2vmzJm9PR7PCQCgGhDKIDftsOrq6g/s7aZ9s+3aMwYPHlzIGKsPBoPZVldur+6r/aoq10tHbcmUfUH7dVbWlAm3phU/u+rvdm1fmc+qzRDnsKnCc+4r3kReBPIm9LlOymf5FS1m5Ak8jIDA6jeqPFVdXZ2npj979uzJjLHkqlaxCeuqq6uputUlG3F7BkW0fiNiz3Akj2TRnm6UAxyX7HE1vVC7g1KstnF2X+UcYHKBVXkgsNk3/uT5ZR0IHqAFntmzZ09jjFGF6KTBGNtYVVUlXL/Aaq+iv/t8vtcAICcYDD5sdY7P59tC5YODwaBlVev26LzadWRKr8+EnSGTdgErfju/i3OgQ8Hjm/0VvUMt/GPGgepoxsBDgq+9HumWHgUVVPBGdyjShVZ9IVCw+g0A/lxdXf1DNeF58+bdHIlESPrpoT7OGBteVVW1V5xdmZkZN4JSf9DRwWCQWgroDp/PNwoA/gAAPw4Gg5bqleNtycz9caiIcaBDwePcn15YhSD3IYHA8kZ5RbXPDqbC9av7/GSBYYl3K9XESKUx2/KcOXOo+xipLn1JZaA2BdXV1fEqYGLMUmZNmTLlXfr3mjVrEh2F9I6ZUfX7/TXxql+T1ACi9sbQWhlj2xoaGkpFVmhX1xWh6cy5OjiAVEUPYAgAHGJUVU9gdBh4nP3nirukKDRw4JR8lgQeEkhR7gL/Df+zgipEpQwr6UKRQNQnqo7p2TyotF85IlYyxr7IyclpDoVCWyRJWrl06VKqvGVrKEChAIj2/yLEKMI0Ozu7nDFGJfV2cM7XNTQ0bNd4Yy6EQqHrmpqaTG1EItdz5jgcMOKAAhxPlpYteLWm+gXGWIUItxLgEQgEFsXrXS6ura2Ve2CKHtO70Nk/vfA+AEsUulVLHrH5+MENP1mg21Q3XclDUXPUksns2bPvZoxR348cANhaXV09TmMDmaqWQMrKyv4GEad169atpKKi4oIRE9WAocxRSyIizKc5Q4YMuUuSpHmMse4NDQ0j7XpjRK/jzHM4oMcBBTjGT5m9gBpapQse38ZTzC/U1tbKPTADgYDQMe2izu2rHI8MyCiYGItfI08pwLwnBiaOMYQn+txbntKsuJ2SR5LNo6ys7LC6diZj7GeISMbTk/FK490557lLliw5N3fu3D6SJNF8jyRJdyxbtuwLs0cuHYnD6hFON7rUiq7zu8MBLQcU4Cie+MwCb5YbstyutMFDTo4BgKra2lq5B2YgEBA6pl5UzDWLJwBcZFtIjOVbP5Zb6f3ysf6qo9FP+1zHBmpdt+lKHnqPR1lZ2cW41KH+eUF1dXXlzJkzczweTx3nfMHp06cP5uXlUQ3NQkmShi9btkwok5UAJB2Jw3mUHQ5cbg4gYsXwR59e4PW4wZudBdluN2xas9S+2pKpjWhds5Z0EebecG95lXpeOyWPJJtHWVkZSUDj1fRzcnKuvXjx4lrOea3X6z3Y1NTUnJeXR6X8XwCAWdXV1cnlBS034UxwOND1OKBIHj99/H8tIPAg6eP36351ecDjy/2LbpYiEuknVGEraSzZdBKo0fC8JwcCp+6+beMCd/OB1xfMTxTRSVfy0LN5UKe5vLy8GYyxsYjoi6+NXLnU6MZDblBEvImiOAFgG9lEut5j4KzY4UB6HFAAZNT46TKAvPHK8ssDHuf+tHADAk7Q20aqwbRtFgO2sc9Pnk8Ea7UTPFLiPAzUGSrCQ7EWZBQlEDmXk5Mz1MxImt7taTtr//79hmH3BQUFMqJ2940ynHMhuEOeoxe+n477ur37cc6/Mjigtn3UbXjp8oDHX96rDDMuv4i2BkrQcuOw8kTuhlluC3ew6A4AAAN/SURBVABQdik1V0oZdl+geOwHSRzNiDh06dKlZETtsCECHkYAogCHsjg1j+zuu8M26BDushy47HEe596vDCDAoyi1RZRacZNx+JoBbO3z4/Jaq7kd8XtZWdl4xlhzVVVVUkGejriWKHhoAUQLHGoAcYCjI+6UQ1OEAx0WJCZy8attjh3wUADECDiuNt45++18HHDA4xLeE7vgcQmX5lzK4YBtDjjgYZtl6Z/ggEf6vHPO7HwcyAh4UMq0VY0FkTmdjz2xFVF6ulIQR/1vu+tNBzwyWSjX7nqd+Q4HzDiQAh52ra6itRbSAY9AIEC5MdPcbnfJqlWrDPNMlA0i4t9IkjSNc17CGLOcL/poZAo8RK+nnSfK43TpO+c5HEiHA3rgUaFk11ml59r5KtoFj0mTJvXJysqS80zcbvcdq1atMs0zQcREXgrn/A7Knk2HIXrnXG7woDXZ5V+m9u7QcThgxAFD8KA8FIpzNwMQ5YHW/q13MTsPP0WF9uzZs54xRjU4hivNrY02gYguRKxHxELO+XDGmFBeiuhjkQ54+Hw+w2CvYDAo812v/4eypnTqhorux5nncCATHDAEj9ZIFEKtEaCIMxEJpD02j0Ag8LokSbVr166Vq3pNmTKF6lxQpNusmpqalDyTaDT6OuWlMMbk+fGua3JeCmPMMC8FEW9mjNnuJZsOeNC69ABEAQ7l5mWigVAmHgSHhsMBuxzQBQ/K7Q9HIhAKt0KoJQJ7tq42DVkVkSrM5gQCgbNKnglj7Ka4FLFtzZo1unkm0Wj0LOdczkuhNgaSJJGUso1zbpiXQu0LAICqmo1gjB20w6h0wUMLIFrg0AMQR+Kwc2ecuZeTA7rg8fjkXy4gqYPA459+/7/bJXmIqDaBQCAlz8Ttdg81MpIiojxfkqREXgrnfKiRkTQOHFRugAaVILQFIO0BDwVAjIBDDSAOcFzOV8G5tl0O6ILHI5OeXUDAsWPTy5bAQRc0kypEjaolJSVkr5DzTFwu19DVq1eb5pmQfYMkDs55MwAQcOjO1wCHwp8UADGzP9BJaletGZMdALD7CDrzuyoHdMGDKguJ2DqUTVupLaKuxkAgMB4Rm9esWSOUZ4KIVKejmVSWrnoDnHU7HOiqHGh3nIeV5CEKMF2Vgc66HQ5crRzISITp1co8Z98OB65mDjjgcTXffWfvDgfawYH/D7MfvdieNp4hAAAAAElFTkSuQmCC";e.AddFieldOptions={defaultValue:0,addToDefaultContentType:1,addToNoContentType:2,addToAllContentTypes:4,addFieldInternalNameHint:8,addFieldToDefaultView:16,addFieldCheckDisplayName:32};e.ClientErrorCodes={GenericError:-1,AccessDenied:-2147024891,DocAlreadyExists:-2130575257,VersionConflict:-2130575339,ListItemDeleted:-2130575338,InvalidFieldValue:-2130575155,NotSupported:-2147024846,Redirect:-2130575152,NotSupportedRequestVersion:-2130575151,FieldValueFailedValidation:-2130575163,ItemValueFailedValidation:-2130575162};e.Priority={Low:3,Medium:2,High:1,SuperHigh:0};e.FieldTypeToJsGridType={DateTime:"SPDateTime",Choice:"Lookup",MultiChoice:"Lookup",Attachments:"SPAttachmentsFlag",User:"SPUser",UserMulti:"SPUser",URL:"Hyperlink",Computed:"SPTextMaxLength",Lookup:"SPTextMaxLength",Boolean:"DropdownBoolean",Note:"SPMultilineText",Edit:"SPEdit",TaxonomyFieldType:"TaxonomyField",TaxonomyFieldTypeMulti:"TaxonomyField",Text:"SPTextMaxLength",Number:"SPTextMaxLength",Currency:"SPTextMaxLength",WorkflowStatus:"SPTextMaxLength",Location:"Location",Geolocation:"SPTextMaxLength"};e.TextFieldIdInModernChoiceEditor="TextFieldInWell";e.IdOfCalloutInWellOfModernChoiceEditor="ModernChoiceEditorWellCallout";e.IdOfCalloutInFlyoutOfCommonEditorCallout="CommonEditorCalloutId";e.IdOfPeoplePickerInPeopldEditor="PeoplePickerInPeopldEditor"})(t.JsGridConstants||(t.JsGridConstants={}))});
define("cGe",["require","exports","lC","o","r","eGe","sGe","dGe","nc","Zd","ce","Rf"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1725},p={ODB:420};(function(t){t._locationFilldownKillswitchIsActive=l.Killswitch.isActivated("C63C13A2-4C8D-4AF9-AAF4-2F0193EB3C98","11/21/2019","fix filldown for location fields");t._gridutilPageContextKillswitchIsActive=l.Killswitch.isActivated("E4BE6FE2-3F8A-48C3-8C74-C713788B7F7B","06/12/2020","Load pagecontet from gridutil");t._keyboardToRowHeaderKillswitchIsActive=l.Killswitch.isActivated("D4E32E0E-C895-4A23-A9F7-0D3767BDA337","06/18/2020","Enable keyboard navigation to row header cells");t._headerScreenreaderKillSwitchIsActive=l.Killswitch.isActivated("255A5419-E993-4024-8A42-90860782D58E","7/18/2020","Piping the screen reader necessary attributes to read out the correct info.");t._errorWidgetInstantOpenKillSwitchIsActive=l.Killswitch.isActivated("4A87CEC1-6C39-491F-A325-BBACAC2D6DF5","8/05/2020","Make the error widget expand immediately on cell selection and do not show the error icon next to cell.");t._fixPasteNewRowPerfKillSwitchIsActive=l.Killswitch.isActivated("D2068B8A-DDB0-4C82-B490-CD5F73CD8842","8/1/2020","When pasting new rows into the grid, perf is awful due to too many reflows.");t._columnHeaderErrorIndicatorKillSwitchIsActive=l.Killswitch.isActivated("73A0879A-B0F3-499E-B934-66D6A4ACB9A0","8/06/2020","Marking column headers with an error asterisk when at least one error in that field.");t._gridWaitFullLoadEventKillSwitchIsActive=l.Killswitch.isActivated("1F1EBE99-332B-46B1-9151-F14385FA33BB","8/19/2020","Adding an event that upon firing will continue the init sequence of the subscribed SPGrid controls in the case of multiple list webparts.");t._lastColumnVisibilityKillSwitchIsActive=l.Killswitch.isActivated("8AC39057-883F-4539-8333-2349ABD458ED","8/21/2020","When an user has no permission to add a new column to the list we should not hide the visibility of the cells.");t._lookupFieldCopyPasteKillSwitchIsActive=l.Killswitch.isActivated("1CF3A488-FA44-4BEE-AB1C-E203225ABA0B","8/29/2020","Fetch the CSOM files when copy/pasting multiple cells of a Lookup field type.");t._removeExtraPasteListenerKillSwitchIsActive=l.Killswitch.isActivated("2107103A-B2D6-4021-8FE5-B7A78E227B61","8/29/2020","Remove 2 paste event listeners in favor of the Keydown handling the paste scenario.");t.EmptyValue={};t.InvalidValue={};t.serializedFieldSeparator=",#";t.SPUserValueOnPasteFixup=function(e){if(Boolean(t.lastCopiedValueType_SPUser)&&Boolean(t.hasPasteStarted)){for(var n=e.split(t.multiValSeparator),r=[],i=0;i<n.length;i++){var s=n[i].indexOf(t.serializedFieldSeparator);-1!==s?r.push(n[i].substring(0,s)):r.push(n[i])}return g.URI_ConvertMultiColumnValueToString(r,t.multiValSeparator,!1)}return e};function d(e){}t.ClearEventListeners=d;var v=(function(){function e(){this._map=[];this._idxMap=[]}e.prototype.GetIndexForGuid=function(e){var t,n=g.LowerBound(this._map,e,"guid");if(null!=this._map[n]&&this._map[n].guid==e)t=this._map[n].idx;else{t=this._idxMap.length;this._idxMap.push({guid:e,idx:t});this._map.splice(n,0,this._idxMap[t])}return t};e.prototype.LookupIndexForGuid=function(e){var t=g.LowerBound(this._map,e,"guid"),n=null;null!=this._map[t]&&this._map[t].guid==e&&(n=this._map[t].idx);return n};e.prototype.LookupGuidForIndex=function(e){return null!=this._idxMap[e]?this._idxMap[e].guid:null};return e})();t.GuidManager=v;var m=(function(){function e(){this._delay=[10,75,150,500];this._tasks={};this._stopCount=0}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.RegisterTask=function(e,t,n){var r=this,i=null==t?s.JsGridConstants.Priority.High:t,o=n,u=setInterval(function(){o in r._tasks&&!e(o)&&r.ClearTask(o)},this._delay[i]);o=null!=o?o:u;this._tasks[o]={intervalId:u,priority:i,fn:e};return o};e.prototype.SetTaskPriority=function(e,t){var n=this._tasks[e];this.ClearTask(e);this.RegisterTask(n.fn,t,e)};e.prototype.GetTaskPriority=function(e){return this._tasks[e]&&this._tasks[e].priority};e.prototype.TaskRegistered=function(e){return e in this._tasks};e.prototype.ClearTask=function(e){var t=this._tasks[e];if(null!=t){clearInterval(t.intervalId);delete this._tasks[e]}};e.prototype.Stop=function(){for(var e in this._tasks)clearInterval(this._tasks[e].intervalId);this._stopCount++};e.prototype.Resume=function(){if(1==this._stopCount){var e={};for(var t in this._tasks)e[t]=this._tasks[t];this._tasks={};for(var t in e)this.RegisterTask(e[t].fn,e[t].priority,t)}this._stopCount=Math.min(this._stopCount-1,0)};return e})();t.AsynchronousTaskManager=m;var g,y=(function(){function e(){this._jobs={};this._maxNumToProcess=10;this._curJobKey=0;this._upShiftThreshold=5;this._downShiftThreshold=20;this._asyncMgr=m.GetInstance()}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.TryAdjustThreadPriority=function(e){var t=e.cells.length-e.lastCellCount,n=this._asyncMgr.GetTaskPriority(e.token)==s.JsGridConstants.Priority.SuperHigh;if(!n&&t<this._upShiftThreshold){this._asyncMgr.SetTaskPriority(e.token,s.JsGridConstants.Priority.SuperHigh);n=!0}else if(n&&t>this._downShiftThreshold){this._asyncMgr.SetTaskPriority(e.token,s.JsGridConstants.Priority.Medium);n=!1}return n};e.prototype.ProcessTasks=function(e,t){var n,r=this._jobs[e];if(t)n=r.cells.length;else{var i=this.TryAdjustThreadPriority(r);n=Math.min(i?7*this._maxNumToProcess:this._maxNumToProcess,r.cells.length)}for(var s=0;s<n;s++)try{r.fn.apply(null,r.cells[s])}catch(e){console.log("Exception running job: "+e.toString())}r.cells.splice(0,n);r.lastCellCount=r.cells.length;return 0!==r.cells.length};e.prototype.RegisterCell=function(e,t,n){var r=this._jobs[e];null!=r.token&&this._asyncMgr.TaskRegistered(r.token)||(r.token=this._asyncMgr.RegisterTask(r.fnProcess,s.JsGridConstants.Priority.Medium));r.cells[r.cells.length]=Array.prototype.slice.apply(arguments,[1,arguments.length])};e.prototype.ChangeRecordKeys=function(e,t){for(var n in this._jobs)for(var r=this._jobs[n].cells,i=0;i<r.length;i++)r[i][0]==e&&(r[i][0]=t)};e.prototype.RegisterJob=function(e){var t=this,n=this._curJobKey++;this._jobs[n]={fn:e,cells:[],fnProcess:function(){return t.ProcessTasks(n)},lastCellCount:0};return n};e.prototype.FlushJob=function(e){e in this._jobs&&this.ProcessTasks(e,!0)};return e})();t.AsynchronousCellUpdater=y;t.DebugAssert=function(e,t){0};(function(e){(function(e){e._hex2pos={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15};e._pos2hex="0123456789ABCDEF";function t(e,t,r){return n(1,e,t,r)}e.MakeColor=t;function n(e,t,n,r){return{a:e,r:t*e,g:n*e,b:r*e}}e.MakeAlphaColor=n;e.RemoveAlphaChannel=function(e){return e.a<1?t(e.r/e.a,e.g/e.a,e.b/e.a):e};e.HexStringToColor=function(r){function i(t){var n=t.charAt(0),r=1==t.length?n:t.charAt(1);return(16*e._hex2pos[n]+e._hex2pos[r])/255}var s,o;if("#"==r.charAt(0)){var u=r.toUpperCase();s=4==u.length?t(i(u.substr(1,1)),i(u.substr(2,1)),i(u.substr(3,1))):t(i(u.substr(1,2)),i(u.substr(3,2)),i(u.substr(5,2)))}else 0==r.indexOf("rgb(")||0==r.indexOf("RGB(")?s=t((o=r.substr(4,r.length-5).split(","))[0]/255,o[1]/255,o[2]/255):0!=r.indexOf("rgba(")&&0!=r.indexOf("RGBA(")||(s=n((o=r.substr(5,r.length-6).split(","))[3],o[0]/255,o[1]/255,o[2]/255));return s};e.ColorToHexString=function(t){function n(t){t=Math.floor(255*t);return e._pos2hex.charAt(Math.floor(t/16))+e._pos2hex.charAt(t%16)}return"#"+n(t.r)+n(t.g)+n(t.b)};e.AlphaBlend=function(e,t){var r=1-e.a;return n(e.a+t.a*r,e.r+r*t.r,e.g+r*t.g,e.b+r*t.b)}})(e.Color||(e.Color={}));e.object=function(e){function t(){}t.prototype=e;return new t};e.getCalloutBoundsBelowStickyHeader=function(e){var t,n,r=null===(n=null===(t=document.getElementById(e))||void 0===t?void 0:t.getElementsByTagName("th")[1])||void 0===n?void 0:n.getBoundingClientRect();return r&&{left:0,top:r.bottom,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight-r.bottom}};e.ConvertTableToMap=function(e,t,n){for(var r={},i=0;i<e.length;i++)r[e[i][t]]=null!=n?e[i][n]:e[i];return r};e.ConvertTableColumnToArray=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r][t]);return n};e.ConvertSetKeysToArray=function(e){var t=[];for(var n in e)t.push(n);return t};e.ConvertSetDataToArray=function(e){var t=[];for(var n in e)t.push(e[n]);return t};e.ConvertArrayToSet=function(e,t){for(var n={},r=0;r<e.length;r++)n[e[r][t]]=e[r];return n};e.EncodeString=function(e){return'"'+e+'"'};e.MoveItemInArray=function(e,t,n){var r=e.splice(t,1);e.splice(n,0,r[0])};e.GetFirstElement=function(e){for(var t in e)return e[t]};e.IsAssocArrayEmpty=function(e){for(var t in e)return!1;return!0};e.GetAssocArraySize=function(e){var t=0;for(var n in e)t++;return t};e.CloneObj=function e(t,n){var r;if(null==t)return null;if(null!=t.clone&&n)return t.clone();if(null!=t.Clone&&n)return t.Clone();if(t instanceof Array){r=[];for(var i=0;i<t.length;i++)r.push(n?e(t[i],!0):t[i]);return r}if(t instanceof Date)return r=new Date(t.getTime());if(t instanceof Function)return t;if(t instanceof Object){var s=!0;for(var o in t)s=s&&!(t[o]instanceof Function);if(s){r={};for(var o in t)o in r||(r[o]=n?e(t[o],!0):t[o])}return r}return t};e.BinarySearch=function(t,n,r){var i=e.LowerBound(t,n,r);return i===t.length||(r?t[i][r]:t[i])!==n?null:i};e.LowerBound=function(t,n,r){return e.LowerBoundCompare(t,n,function(e,n){var i=r?t[e][r]:t[e];return n>i?1:i>n?-1:0})};e.LowerBoundCompare=function(e,t,n){for(var r,i=-1,s=e.length;s-i>1;)n(r=i+s>>>1,t)>0?i=r:s=r;return s};e.UpperBound=function(e,t,n){for(var r,i=-1,s=e.length;s-i>1;){r=i+s>>>1;t>=(n?e[r][n]:e[r])?i=r:s=r}return s};e.Compose=function(e,t){return function(n){var r=t?t(n):n;return e?e(r):r}};e.FindInArray=function(e,t,n){for(var r,i=0;i<e.length;i++)if(t(e[i])){r=i;if(!n)break}return r};e.Find=function(e,t,r){var i=n(e,t,r);return null==i?null:e[i]};function n(e,t,n){var r=void 0;for(var i in e)if(t(e[i])){r=i;if(!n)break}return r}e.FindKey=n;e.RoundTo=function(e,t){var n=Math.pow(10,t);return 0==e?e:Math.round(e*n)/n};e.shutUpKeys=null;e.CoalesceFunctionCalls=function(e,t,n){null==this._shutUpKeys&&(this._shutUpKeys=new o.Set);var r=this._shutUpKeys;if(!r.Contains(e)){r.Add(e);setTimeout(function(){r.Remove(e);t()},null==n?0:n)}};e.Flatten2LevelArray=function(e){var t=[];for(var n in e)for(var r in e[n])t.push(e[n][r]);return t};e.TokenizeString=function(e,n){var r=[];if(null!=e&&e!==t.EmptyValue)for(var i=e.split(n),s=0;s<i.length;s++){var o=i[s].replace(/^\s+|\s+$/g,"");""!==o&&r.push(o)}return r};e.JoinStrings=function(e,t){if(null==e)return null;for(var n=[],r=0;r<e.length;r++)""!==e[r]&&null!=e[r]&&n.push(e[r]);return n.join(t)};e.ProfilerMark=function(e){window.msWriteProfilerMark&&window.msWriteProfilerMark(e)};(function(e){e.OnRowHeaderStateChanged=function(e,t){return{recordKey:e,rowHeaderState:t}};e.ChangeKeyStageUpdated=function(e){return{changeKey:e}};e.RecordInserted=function(e){return{recordKey:e}};e.RecordDeleted=function(e){return{recordKey:e}}})(e.EventArgs||(e.EventArgs={}));e.EmptyFunction=function(){};e.CrackCellKey=function(e){var t=e.split(",");return{rowIdx:t[0],colIdx:t[1]}};e.MakeCellKey=function(e,t){return[e,t].join()};e.IsNoOpChange=function(e,t){var n=e.fieldKey;return!(t.HasLocalizedValue(n)&&e.oldProp.localized!=e.newProp.localized||t.HasDataValue(n)&&e.oldProp.data!=e.newProp.data)};var r=(function(){function n(){var e=this;this._zoomFactor=1;this.OnMouseMove=function(t){null!=e._fnUserOnMouseMove&&e._fnUserOnMouseMove(t)};this.OnMouseUp=function(t){null!=e._fnUserOnMouseUp&&e._fnUserOnMouseUp(t);e.ReleaseCapture()};this.StopEvent=function(e){e.stopPropagation();e.preventDefault()};this.CacheIEZoomFactor=function(){if(e.BrowserIsIE){var t,n;if(null==(t=document.getElementById("__iezoomtest1"))||null==(n=document.getElementById("__iezoomtest2"))){t=document.createElement("div");n=document.createElement("div");t.style.cssText="position:absolute;top:0px;left:0px";n.style.cssText="position:absolute;top:0px;left:200px";t.appendChild(n);t.id="__iezoomtest1";n.id="__iezoomtest2";document.body.appendChild(t)}var r=t.getBoundingClientRect(),i=n.getBoundingClientRect(),s={x:r.left,y:r.top},o={x:i.left,y:i.top};e._zoomFactor=(o.x-s.x)/200;0==e._zoomFactor&&(e._zoomFactor=1)}};this.BrowserIsIE=!1;this.BrowserIsIEAndRenderingModeIs7=!1;this.BrowserCanRenderVml=!1;this.functionsRequiringInit=[{name:"SetText",selector:function(){return null!=document.body.innerText?function(e,t){e.innerText=t}:function(e,t){e.textContent=t}}},{name:"GetScreenOffsets",selector:function(){return"pageYOffset"in window?function(){return{top:window.pageYOffset,left:window.pageXOffset}}:function(){return{top:document.documentElement.scrollTop,left:document.documentElement.scrollLeft}}}},{name:"GetXmlHttpObj",selector:function(){return window.XMLHttpRequest?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")}}},{name:"GetComputedStyle",selector:function(){return null!=document.defaultView&&null!=document.defaultView.getComputedStyle?function(e,t,n){var r=document.defaultView.getComputedStyle(e,null);return r?r.getPropertyValue(n):""}:function(e,t,n){return"width"==t?String(e.offsetWidth)+"px":e.currentStyle[t]}}},{name:"AdjustCoordsForIEZoom",selector:function(){if(e.BrowserIsIE){e.CacheIEZoomFactor();window.addEventListener("resize",e.CacheIEZoomFactor)}return function(t){return{x:Math.round(t.x/e._zoomFactor),y:Math.round(t.y/e._zoomFactor)}}}},{name:"GetOuterHTML",selector:function(){return null!=document.body.outerHTML?function(e){return e.outerHTML}:function(e){var t=e.ownerDocument,n=e.cloneNode(!0),r=t.createElement("div");t.documentElement.appendChild(r);r.appendChild(n);var i=r.innerHTML;t.documentElement.removeChild(r);return i}}}];for(var t=function(t){var n=e;n[t.name]=function(){n[t.name]=t.selector();return n[t.name].apply(n,arguments)}},n=0;n<this.functionsRequiringInit.length;n++)t(this.functionsRequiringInit[n])}n.GetInstance=function(){n._instance||(n._instance=new n);return n._instance};n.prototype.SetCapture=function(t,n,r){this._bUsingIE=!1;this._captureElem=t;this._fnUserOnMouseMove=n;this._fnUserOnMouseUp=r;this._origBodyCursor=document.body.style.cursor;document.body.style.cursor=e.DomElement.GetInstance().GetComputedStyle(this._captureElem,"cursor","cursor");document.addEventListener("mousemove",this.OnMouseMove,!0);document.addEventListener("mouseup",this.OnMouseUp,!0);document.addEventListener("mouseover",this.StopEvent,!0);document.addEventListener("mouseenter",this.StopEvent,!0);document.addEventListener("mouseleave",this.StopEvent,!0)};n.prototype.ReleaseCapture=function(){if(null!=this._captureElem){if(this._bUsingIE){this._captureElem.releaseCapture();document.removeEventListener("mousemove",this.OnMouseMove);document.removeEventListener("mouseup",this.OnMouseUp)}else{document.body.style.cursor=this._origBodyCursor;document.removeEventListener("mousemove",this.OnMouseMove,!0);document.removeEventListener("mouseup",this.OnMouseUp,!0);document.removeEventListener("mouseover",this.StopEvent,!0);document.removeEventListener("mouseenter",this.StopEvent,!0);document.removeEventListener("mouseleave",this.StopEvent,!0)}this._captureElem=null;this._fnUserOnMouseMove=null;this._fnUserOnMouseUp=null;this._origBodyCursor=null}};n.prototype.OnMouseWheel=function(e,t){var n=e.rawEvent;e.wheelDelta=Math.round(null!=n.wheelDelta?n.wheelDelta/-40:n.detail);t(e)};n.prototype.AttributeOnElementOrAncestor=function(e,t,n){for(;null!=e&&null!=e.getAttribute;){if(e.getAttribute(t)==n)return!0;e=e.parentNode}return!1};n.prototype.PointInDomElem=function(e,n,r,i){var s=null==i?t.Internal.DomElement.GetInstance().GetLocation(r):i;return s.x<=e&&s.x+r.offsetWidth>=e&&s.y<=n&&s.y+r.offsetHeight>=n};n.prototype.ElementAttachedToDom=function(e){if(null!=document.body.contains)return document.body.contains(e);t.DebugAssert(null!=document.body.compareDocumentPosition);return document.body.compareDocumentPosition(e)>=16};n.prototype.ForceIEZoomFactorRecomputation=function(){this.CacheIEZoomFactor()};n.prototype.GetLocation=function(t){var n=t.getBoundingClientRect();return e.DomElement.GetInstance().AdjustCoordsForIEZoom({x:n.left,y:n.top})};n.prototype.GetEventLocation=function(t){var n=e.DomElement.GetInstance().GetScreenOffsets();return e.DomElement.GetInstance().AdjustCoordsForIEZoom({x:t.clientX+n.left,y:t.clientY+n.top})};n.prototype.GetNextElement=function(e){do{var t=e.nextSibling}while(t&&1!==t.nodeType);return t};n.prototype.GetPrevElement=function(e){do{var t=e.previousSibling}while(t&&1!==t.nodeType);return t};n.prototype.GetFirstChildElement=function(e){for(var t=e.firstChild;t&&1!==t.nodeType;)t=e.nextSibling;return t};n.prototype.AddMouseWheelHandler=function(e,t){var n=this,r=function(e){n.OnMouseWheel(e,t)};null==e._mouseWheelFnInfo&&(e._mouseWheelFnInfo=[]);e._mouseWheelFnInfo.push({usrFn:t,wheelFn:r});e.addEventListener("mousewheel",r);e.addEventListener("DOMMouseScroll",r)};n.prototype.RemoveMouseWheelHandler=function(e,n){var r=t.Internal.FindInArray(e._mouseWheelFnInfo,function(e){return e.usrFn==n});if(null!=r){e.removeEventListener("mousewheel",e._mouseWheelFnInfo[r].wheelFn);e.removeEventListener("DOMMouseScroll",e._mouseWheelFnInfo[r].wheelFn);1==e._mouseWheelFnInfo.length?e._mouseWheelFnInfo=null:e._mouseWheelFnInfo.splice(r,1)}};n.prototype.GetCustomAttribute=function(e,t){var n=null!=e.getAttribute?e.getAttribute(t):null;return null==n||""==n?e[t]:n};n.prototype.GetParentElement=function(e){var t=e.parentNode;return t&&1!==t.nodeType?null:t};n.prototype.GetAncestorByTag=function(e,t){if(null===e)return null;for(var n=e.parentNode;null!==n&&n.tagName!==t;)n=n.parentNode;return n};n.prototype.SetOpacity=function(e,t){e.style.opacity=t;e.style["-moz-opacity"]=t;e.style.filter="alpha(opacity="+100*t+")"};n.prototype.RemoveOpacity=function(e){e.style.opacity="";e.style["-moz-opacity"]=1;e.style.filter=""};n.prototype.ForEachElementChild=function(e,t,n){n||t(e);for(var r=0;r<e.childNodes.length;r++)this.ForEachElementChild(e.childNodes[r],t,!1)};n.prototype.FindAncestorWithProperty=function(e,t,n){return null==e?null:void 0!==this.GetCustomAttribute(e,t)?{elem:e,child:n}:this.FindAncestorWithProperty(e.parentNode,t,e)};n.prototype.FindFirstAncestorWithAnyPropertyValue=function(e,t,n,r){return null==e?null:this.GetCustomAttribute(e,t)in n?{elem:e,child:r}:this.FindFirstAncestorWithAnyPropertyValue(e.parentNode,t,n,e)};n.prototype.GetChildrenWithCustomAttribute=function(e,t){var n=this,r={};this.ForEachElementChild(e,function(e){var i=n.GetCustomAttribute(e,t);null!=i&&(r[i]=e)},null);return r};n.prototype.FindChildrenWithProperty=function(e,t){var n=[];(function e(r,i){for(var s=0;s<r.childNodes.length;s++){var o=r.childNodes[s];null!=this.GetCustomAttribute(o,t)&&n.push(o);e(o,t)}})(e);return n};n.prototype.ComputeMaximumSizeForWebPart=function(e,n){var r={},i=document.getElementById("MSO_ContentTable");t.DebugAssert(null!=i,"The function 'ComputeMaximumSizeForWebPart' may only be called on a sharepoint web part page");var s=this.GetLocation(e),o=this.GetLocation(i);n||(e.style.display="none");var u=s.y-o.y;r.height=i.offsetHeight-u;u=s.x-o.x;r.width=i.offsetWidth-u;n||(e.style.display="block");return r};n.prototype.SetMouseHover=function(e,t,n,r){e.addEventListener("mousemove",u);e.addEventListener("mouseout",o);var i=!0,s=!1;function o(){s=!0;setTimeout(a,0)}function u(e){i&&null!=t&&t();null!=r&&r(e);i=s=!1}function a(){if(!i&&s){null!=n&&n();i=!0;s=!1}}return function(){e.addEventListener("mouseout",o);e.addEventListener("mousemove",u);o=null;u=null;a=null;e=null}};n.prototype.DashNameFromCamelName=function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})};n.prototype.CamelNameFromDashName=function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})};n.prototype.GetXmlDomObj=function(e){var t;if(document.implementation&&document.implementation.createDocument)t=document.implementation.createDocument("","",null);else try{var n=document.createElement("xml");document.body.appendChild(n);t=n.XMLDocument;document.body.removeChild(n)}catch(e){(t=new ActiveXObject("Microsoft.XMLDOM")).setProperty("ProhibitDTD",!0)}if(null!=e)if("loadXML"in t){t.async=!1;t.loadXML(e)}else t=(new DOMParser).parseFromString(e,"text/xml");return t};n.prototype.SetTextNoBR=function(e,t){e.innerHTML="";e.appendChild(document.createTextNode(t))};return n})();e.DomElement=r;var i=(function(){function e(){this.Reset()}e.prototype.ElapsedMs=function(){return(new Date).getTime()-this.start};e.prototype.Reset=function(){this.start=(new Date).getTime()};e.prototype.toString=function(e){var t=this.ElapsedMs(),n=new Date(t),r=Math.floor(t/36e5),i=n.getUTCMinutes(),s=n.getUTCSeconds()+n.getUTCMilliseconds()/1e3;if("M"==e){i+=60*r;r=0}else if("S"==e){s+=60*(60*r+i);r=i=0}var o=[];r&&o.push(r);r+i&&o.push((i<10?"0":"")+i);o.push((s<10?"0":"")+s.toFixed(3));return o.join(":")};return e})();e.Timer=i;e.CallAsyncFn=function(e,t,n,r){e(function(){null!=t&&t();null!=r&&r()})?t():null!=n&&n()};function u(e,t){for(var n=e[t],r=e.offsetParent;null!=r&&"BODY"!==r.tagName;){n+=r[t];r=r.offsetParent}null!=r&&(n+=r[t]);return n}e.DOM_Abs=u;e.DOM_AbsLeft=function(e){return u(e,"offsetLeft")};e.DOM_AbsTop=function(e){return u(e,"offsetTop")};function a(e,t,n){if(void 0!==document.defaultView&&void 0!==document.defaultView.getComputedStyle){var r=document.defaultView.getComputedStyle(e,null);return n?r.getPropertyValue(n):r}return"width"==t?String(e.offsetWidth)+"px":e.currentStyle[t]}e.GetCurrentStyle=a;e.GetVisible=function(e){var t=a(e,"");return"hidden"!==t.visibility&&"none"!==t.display};e.GenerateIID=function(e){return f(e,e.CurrentItem)};function f(e,t){return e.ctxId+","+t.ID+","+t.FSObjType}e.GenerateIIDForListItem=f;e.IsElementRtl=function(e){for(;null!=e&&null!=e.tagName;){var t=e.getAttribute("dir");null!=t&&""!=t||null==e.style||(t=e.style.direction);if("rtl"==t)return!0;if("ltr"==t)return!1;e=e.parentNode}return!1};e.AddCssClass=function(e,t){e.className+=" "+t};e.RemoveCssClass=function(e,t){e.classList.remove(t)};e.URI_ConvertMultiColumnValueToString=function(e,t,n){null==t&&(t=";#");null==n&&(n=!0);for(var r=t.charAt(0),i=r+r,s=new RegExp(t.charAt(0),"g"),o=!1,u="",a=0;a<e.length;a++){var f=e[a];null!=f&&f.length>0&&(f=f.replace(s,i));null!=f&&f.length>0&&(o=!0);(n||0!==a)&&(u+=t);u+=f}if(o){n&&(u+=t);return u}return""};e.GetEventSrcElement=function(e){return null!=e.target?e.target:null};e.GenerateXMLArray=function(e,t){var n=[];if(null!=e){var r="<"+t+">",i="</"+t+">";for(var s in e){n.push(r);n.push(e[s]);n.push(i)}}return n.join("")};e.EscapeProperly=function(t,n,r,i){var s="",o=0;if(void 0===t)return"";for(o=0;o<t.length;o++){var u=t.charCodeAt(o),a=t.charAt(o);if(n&&("#"==a||"?"==a)){s+=t.substr(o);break}if(r&&"&"==a)s+=a;else if(u<=127)i||u>=97&&u<=122||u>=65&&u<=90||u>=48&&u<=57||n&&u>=32&&u<=95&&" \"%<>'&".indexOf(a)<0?s+=a:u<=15?s+="%0"+u.toString(16).toUpperCase():u<=127&&(s+="%"+u.toString(16).toUpperCase());else if(u<=2047){s+="%"+(e.Utf8Variables.UTF8_1ST_OF_2|u>>6).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}else if((u&e.Utf8Variables.SURROGATE_6_BIT)!=e.Utf8Variables.HIGH_SURROGATE_BITS){s+="%"+(e.Utf8Variables.UTF8_1ST_OF_3|u>>12).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|(4032&u)>>6).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}else if(o<t.length-1){u=(1023&u)<<10;o++;u|=1023&t.charCodeAt(o);u+=e.Utf8Variables.SURROGATE_OFFSET;s+="%"+(e.Utf8Variables.UTF8_1ST_OF_4|u>>18).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|(258048&u)>>12).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|(4032&u)>>6).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}}return s};e.Utf8Variables={UTF8_1ST_OF_2:192,UTF8_1ST_OF_3:224,UTF8_1ST_OF_4:240,UTF8_TRAIL:128,HIGH_SURROGATE_BITS:55296,LOW_SURROGATE_BITS:56320,SURROGATE_6_BIT:64512,SURROGATE_ID_BITS:63488,SURROGATE_OFFSET:65536};e.IsXhrAborted=function(e){try{if(4==e.readyState&&(void 0===e.status||0==e.status))return!0}catch(e){return!0}return!1};e.IsStrNullOrEmpty=function(e){return null==e||""==e};e.IsNullOrUndefined=function(e){return null==e||null==e};var d=(function(){function e(e){this.nonFilterParams={};this.filterParams={};null==e&&(e="");0==e.indexOf("?")&&(e=e.substring(1));this.nonFilterParams={};this.filterParams={};var t,n=e.split("&");for(t=0;t<n.length;t++){var r=n[t].split("=");if(2==r.length)if(-1!=r[0].search("^Filter")){var i,s=r[0].match(new RegExp("[0-9]*$"));if(void 0!==this.filterParams[s])i=this.filterParams[s];else{i=new Object;this.filterParams[s]=i}i[r[0].match(new RegExp("^Filter[^0-9]*"))]=r[1]}else this.nonFilterParams[r[0]]=r[1]}}e.prototype.toArray=function(){var e,t,n=[],r=1;for(e in this.filterParams){var i=this.filterParams[e];for(e in i){(t=[]).push(e);t.push(r);t.push("=");t.push(i[e]);n.push(t.join(""))}r++}for(e in this.nonFilterParams){(t=[]).push(e);t.push("=");t.push(this.nonFilterParams[e]);n.push(t.join(""))}return n};return e})();e.List_QstringStruct=d;e.List_ReconcileQstringFilters=function(e,t){var n=[];n.push(new d(e));n.push(new d(t));var r,i,s,o,u=[];for(r=0;r<n.length;r++)for(s in n[r].nonFilterParams)if(0==r||void 0===n[0].nonFilterParams[s]&&1==r){(o=[]).push(s);o.push("=");o.push(n[r].nonFilterParams[s]);u.push(o.join(""))}var a=1,f=new Object;for(r=0;r<n.length;r++)for(i in n[r].filterParams){var l=n[r].filterParams[i],c="string"==typeof l.FilterField?l.FilterField:null;null==c&&(c="string"==typeof l.FilterFields?l.FilterFields:null);if(null!=c&&void 0===f[c]){for(s in l){(o=[]).push(s);o.push(a);o.push("=");o.push(l[s]);u.push(o.join(""))}a++;f[l.FilterField]=l}}return u.join("&")};e.UnescapeProperly=function(e){var t=null;if("undefined"!=typeof decodeURIComponent){t=decodeURIComponent(e);var n=v(e);t!=n&&alert("unescapeProperly error\noriginal string = "+e+"\ndecodeURIComponent string = "+t+"\nunescapeProperlyInternal string = "+n)}else t=v(e);return t};function v(e){if(null==e)return"null";for(var t,n,r=0,i=0,s="",o=new Array,u=0;r<e.length;)if("%"==e.charAt(r))if("u"==e.charAt(++r)){t="";for(i=0;i<4&&r<e.length;++i)t+=e.charAt(++r);for(;t.length<4;)t+="0";n=parseInt(t,16);isNaN(n)?s+="?":s+=String.fromCharCode(n)}else{t="";for(i=0;i<2&&r<e.length;++i)t+=e.charAt(r++);for(;t.length<2;)t+="0";n=parseInt(t,16);if(isNaN(n)){if(u){s+=y(o);u=0;o.length=u}s+="?"}else o[u++]=n}else{if(u){s+=y(o);u=0;o.length=u}s+=e.charAt(r++)}if(u){s+=y(o);u=0;o.length=u}return s}var m,g=[0,128,2048,65536,2097152,67108864,2147483648];function y(e){for(var t,n,r,i,s=0,o="";s<e.length;)if(e[s]<=127)o+=String.fromCharCode(e[s++]);else{n=e[s++];i=r=Boolean(32&n)?Boolean(b(n))?3:2:1;t=n&255>>>2+r;for(;Boolean(r)&&s<e.length;){--r;if(0==(n=e[s++]))return o;if(128!=(192&n)){o+="?";break}t=t<<6|63&n}if(Boolean(r)){o+="?";break}if(t<g[i]){o+="?";break}if(t<=65535)o+=String.fromCharCode(t);else if(t<=1114111){t-=65536;o+=String.fromCharCode(55296|t>>>10);o+=String.fromCharCode(56320|w(t))}else o+="?"}return o}function b(e){return 16&e}function w(e){return 1023&e}e.GetInnerText=function(e){return void 0!==e.textContent&&null!=e.textContent?e.textContent:void 0!==e.innerText?e.innerText:void 0};e.EnsureFileLeafRefName=function(e){if(void 0===e["FileLeafRef.Name"]){var t=e.FileLeafRef,n=t.lastIndexOf(".");n>=0&&l.Killswitch.isActivated("48F7CF05-25D8-41E7-9508-D739EC3005C3","10/30/2019","Do not truncate the file name in Quick Edit editors")?e["FileLeafRef.Name"]=t.substring(0,n):e["FileLeafRef.Name"]=t}};e.Encoding_STSHtmlDecode=function(e){if(null==e)return"";var t=[/\&lt;/g,/\&gt;/g,/\&quot;/g,/\&#39;/g,/\&#58;/g,/\&#123;/g,/\&#125;/g,/\&amp;/g],n=["<",">",'"',"'",":","{","}","&"],r=[],i=0,s=t.length;for(i=0;i<s;i++){var o=e.indexOf("&");if(-1==o)break;if(0<o){r.push(e.substr(0,o));e=e.substr(o)}e=e.replace(t[i],n[i])}r.push(e);return r.join("")};e.Encoding_STSHtmlEncode=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;default:n.push(s)}}return n.join("")};e.GetCSSClassForFieldTd=function(e){return"TRUE"==e.CalloutMenu||"Menu"==e.ClassInfo||"TRUE"==e.listItemMenu?"ms-cellstyle ms-vb-title":"Menu"==e.ClassInfo||"TRUE"==e.listItemMenu?"ms-cellstyle ms-vb-title ms-positionRelative":"Icon"==e.ClassInfo?"ms-cellstyle ms-vb-icon":"User"==e.Type||"UserMulti"==e.Type?"ms-cellstyle ms-vb-user":"ms-cellstyle ms-vb2"};e.SiteUrl="";e.GetImageUrl=function(e){return t.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+e};e.GetLocalizedImageUrl=function(e){return t.Internal.SiteUrl+"/_layouts/15/1033/images/"+e};e.GetScrollParent=function e(t){return"true"===t.getAttribute("data-is-scrollable")?t:t.parentElement?e(t.parentElement):null};e.GetGridParentElement=function(){var e=document.getElementsByClassName("quickEditParentDiv");return e&&e.length>0?e[0]:null};e.GetFocusElement=function(){return document.getElementById("spgridcontainer_"+t.privateWpq+"_focusElement")};function E(e){return window.g_SPGridInitInfo[Object.keys(window.g_SPGridInitInfo)[0]].jsInitObj.flightStatus[e.ODB]}e.IsFeatureEnabled=E;e.IsStickyColumnEnabled=function(){return t.Internal.IsStickyColumnFlightEnabled()&&!t.Internal.noSizeForSticky};e.IsStickyColumnFlightEnabled=function(){if(E(p)){void 0===m&&(m=new c.PlatformDetection);return E(h)&&E(p)&&!m.isIE}return!1};e.GetStickyDataColumnsWidth=function(e){for(var n=0,r=0;r<e.length&&r<=t.Internal.stickyLastColIdx;r++)e[r].width&&(n+=e[r].width);return n};e.stickyLeftEdgeOffset=0;e.stickyCheckColumnSize=60;e.stickyChromeless=!0;e.stickyLastColIdx=0;e.noSizeForSticky=!1;e.normalizeColumnKey=function(e,t){var n="Title"===e?"LinkTitle":e;t&&(n="FileLeafRef"===e?"LinkFilename":n);return n};e.getColumnFromListSchema=function(e,t){var n,r=e.GetSpCsrRenderCtx();if(r)for(var i=0,s=r.ListSchema.Field;i<s.length;i++){var o=s[i];if(o.RealFieldName===t){n=o;break}}return n};e.positionWidget=function(e,n,r){if(r){var i=t.Internal.GetGridParentElement(),s=i.getElementsByTagName("TABLE")[0].clientWidth-e.offsetWidth,o=t.Internal.GetScrollParent(i).scrollWidth-e.offsetWidth;e.style.left=Math.min(s,o,n.x)+"px"}else e.style.left=Math.max(0,n.x+n.width-e.offsetWidth)+"px"}})(g=t.Internal||(t.Internal={}));(function(e){e.CellFocusChanged=function(e,t,n,r){return{newRecordKey:e,newFieldKey:t,oldRecordKey:n,oldFieldKey:r}};e.RowFocusChanged=function(e,t){return{newRecordKey:e,oldRecordKey:t}};e.CellEditBegin=function(e,t){return{recordKey:e,fieldKey:t}};e.CellEditCompleted=function(e,t,n,r){return{recordKey:e,fieldKey:t,changeKey:n,bCancelled:r}};e.Click=function(e,t,n,r){return{eventInfo:e,context:t,recordKey:n,fieldKey:r}};e.PropertyChanged=function(e,t,n,r,i,s,o){return{recordKey:e,fieldKey:t,oldProp:n,newProp:r,propType:i,changeKey:s,validationState:o}};e.RecordInserted=function(e,t,n,r){return{recordKey:e,recordIdx:t,afterRecordKey:n,changeKey:r}};e.RecordDeleted=function(e,t,n){return{recordKey:e,recordIdx:t,changeKey:n}};e.RecordChecked=function(e,t){return{recordKeySet:e,bChecked:t}};e.OnCellErrorStateChanged=function(e,t,n,r,i,s){return{recordKey:e,fieldKey:t,bAddingError:n,bCellCurrentlyHasError:r,bCellHadError:i,errorId:s}};e.OnRowErrorStateChanged=function(e,t,n,r,i,s){return{recordKey:e,bAddingError:t,bErrorCurrentlyInRow:n,bRowHadError:r,errorId:i,message:s}};e.OnEntryRecordAdded=function(e){return{recordKey:e}};e.OnEntryRecordCommitted=function(e,t,n){return{originalRecordKey:e,recordKey:t,changeKey:n}};e.SingleCellClick=function(e,t,n){return{eventInfo:e,recordKey:t,fieldKey:n}};e.PendingChangeKeyInitiallyComplete=function(e){return{changeKey:e}};e.VacateChange=function(e){return{changeKey:e}};e.GridErrorStateChanged=function(e){return{bAnyErrors:e}};e.SingleCellKeyDown=function(e,t,n){return{eventInfo:e,recordKey:t,fieldKey:n}};e.OnRecordsReordered=function(e,t){return{reorderedKeys:e,changeKey:t}};e.OnRowEscape=function(e){return{recordKey:e}};e.OnEndRenameColumn=function(e,t,n){return{columnKey:e,originalColumnTitle:t,newColumnTitle:n}};e.OnBeginRedoDataUpdateChange=function(e){return{changeKey:e}};e.OnBeginUndoDataUpdateChange=function(e){return{changeKey:e}}})(t.EventArgs||(t.EventArgs={}));var b=(function(){function e(e,t,n,r,i){this.imgSrc=e;this.bIsClustered=t;this.outerCssNames=n;this.imgCssNames=r;this.bIsAnimated=i;this._imageWithFabricIcons=new w({imgSrc:e,bIsClustered:t,optOuterCssNames:n,optImgCssNames:r,bIsAnimated:i})}e.prototype.Render=function(e,t,n){return this._imageWithFabricIcons.Render(e,t,n)};return e})();t.Image=b;var w=(function(){function e(e){this.imgSrc=e.imgSrc;this.bIsClustered=e.bIsClustered;this.outerCssNames=e.optOuterCssNames;this.imgCssNames=e.optImgCssNames;this.bIsAnimated=e.bIsAnimated;this.iconProps=e.iconProps;this.spinnerProps=e.spinnerProps}e.prototype.Render=function(e,o,u){if(!this.imgSrc&&!this.iconProps&&!this.spinnerProps)return null;var l;if(this.iconProps||this.spinnerProps){var c=document.createElement("span");this.iconProps?r.render(i.createElement(a.Icon,n.__assign({ariaLabel:e},this.iconProps)),c):r.render(i.createElement(f.Spinner,n.__assign({ariaLabel:e},this.spinnerProps)),c);l=c}else{var h=document.createElement("img");h.src=this.imgSrc;if(null!=e){h.alt=e;u||(h.title=e)}else h.alt="";l=h}l.style.border="0";null!=this.imgCssNames&&(l.className=this.imgCssNames);if(this.bIsClustered){var p=document.createElement("div");p.className=this.outerCssNames;p.appendChild(l);l=p}if(this.bIsAnimated){t.DebugAssert(null==o,"Cannot specify a clickFn to an animated image.");o=function(e){l.style.visibility="hidden"}}if(null!=o){l.addEventListener("mousedown",o);l.addEventListener("keydown",function(e){e.keyCode==s.JsGridConstants.Key.enter&&o(e)});l.style.cursor="pointer";l.tabIndex=-1}null!=o&&(l.Dispose=function(){o=null;p=null;l.Dispose=null;l=null});return l};return e})();t.ImageWithFabricIcons=w;t.ApplyServerChangesToGrid=function(e,n,r,i,o,a){var f;if(null!=n)for(var l=0;l<n.length;l++){for(var c=n[l],h=[],p=[],d=[],v=0;v<c.updates.length;v++){var m=c.updates[v];m.type==s.JsGridConstants.ChangeType.Prop?h.push(g(m.recordKey,m.fieldKey,m.newProp)):m.type==s.JsGridConstants.ChangeType.Insert?d.push(m):m.type==s.JsGridConstants.ChangeType.Delete&&p.push(m.recordKey)}w(d);E(h);S(p);f=null}function g(e,t,n){return n.hasLocalizedValue&&n.hasDataValue?u.CreateValidatedPropertyUpdate(e,t,n.dataValue,n.localizedValue):u.CreateUnvalidatedPropertyUpdate(e,t,n.hasDataValue?n.dataValue:n.localizedValue,!n.hasDataValue)}function y(){var n=f;null!=n||o||(-1==c.changeNumber?t.DebugAssert(!1,"Invalid change list from server - if these changes are to be applied as a new update, please set the bOptNewChange parameter to true"):n=e.GetChangeKeyForVersion(c.changeNumber));return n}function b(e){f=e}function w(e){for(var n=0;n<e.length;n++){var i=r(e[n].afterRecordKey,e[n].recordKey,y());t.DebugAssert(null!=i,"The change key from inserting the record must be returned.");b(i)}}function E(t){if(h.length>0){var n=e.UpdateProperties(h,s.JsGridConstants.UserAction.UserEdit,y());null!=a&&a(h,n);b(n)}}function S(t){if(p.length>0){b(e.DeleteRecords(p,y()))}}};var E=(function(){function e(){this.events={}}e.prototype.FireEvent=function(e,t){var n=this.events[e];if(null!=n)for(var r in n)n[r](t)};e.prototype.AttachEvent=function(e,t){null==this.events[e]&&(this.events[e]=[]);this.events[e].push(t)};e.prototype.DetachEvent=function(e,n){if(null!=this.events[e]){var r=t.Internal.FindInArray(this.events[e],function(e){return e==n},null);null!=r&&this.events[e].splice(r,1)}};return e})();t.EventManager=E;var S=(function(){function e(){this._delegates={}}e.prototype.SetDelegate=function(e,t){null!=t?this._delegates[e]=t:delete this._delegates[e]};e.prototype.DelegatePresent=function(e){return e in this._delegates};e.prototype.GetDelegate=function(e){return this._delegates[e]};e.prototype.Apply=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._delegates[e[0]];if(null!=n)return n.apply(null,Array.prototype.slice.call(e,1))};return e})();t.DelegateManager=S;t.MakeShapeStyle=function(e,t){return{shape:e,color:t}};t.MakeBarStyle=function(e,t,n,r,i,s){return{shape:e,color:t,pattern:n,start:r,end:i,strokeWeight:s}};function x(){var e;return function(t){null==e&&(e=null!=t?t:1);e>0&&--e}}t.GetSingleStopBreakpoint=x;t.bpt=x();var T=(function(){function e(e,t,n){this._elementToCover=e;this._childElems=t;this._optId=n;this.Init()}e.prototype.Show=function(){this._elementToCover.addEventListener("resize",this.OnResize);this._elementToCover.appendChild(this.transparentDiv);this._elementToCover.appendChild(this.opaqueContainerDiv);this.RefreshLayout()};e.prototype.Hide=function(){this._elementToCover.removeEventListener("resize",this.OnResize);this._elementToCover.removeChild(this.transparentDiv);this._elementToCover.removeChild(this.opaqueContainerDiv)};e.prototype.Dispose=function(){this.transparentDiv=this.opaqueDiv=this.opaqueContainerDiv=null};e.prototype.RefreshLayout=function(){this.opaqueContainerDiv.style.height=this.transparentDiv.style.height=Math.max(0,this._elementToCover.offsetHeight-2)+"px";this.opaqueContainerDiv.style.width=this.transparentDiv.style.width=Math.max(0,this._elementToCover.offsetWidth-2)+"px";this.opaqueDiv.style.left=Math.max((this._elementToCover.offsetWidth-this.opaqueDiv.offsetWidth)/2,50)+"px";this.opaqueDiv.style.marginTop=(this._elementToCover.offsetHeight-this.opaqueDiv.offsetHeight)/2+"px"};e.prototype.OnResize=function(e){this.RefreshLayout()};e.prototype.Init=function(){t.DebugAssert("DIV"==this._elementToCover.tagName.toUpperCase()&&"RELATIVE"==this._elementToCover.style.position.toUpperCase(),"Banner can only cover relative positioned div elements!");this.transparentDiv=document.createElement("div");this.transparentDiv.style.cssText="z-index:5; position:absolute; top:0px; left:0px; background-color:#ffffff;border:1px solid #999999;";g.DomElement.GetInstance().SetOpacity(this.transparentDiv,.85);null!=this._optId&&(this.transparentDiv.id=this._optId);this.opaqueContainerDiv=document.createElement("div");this.opaqueContainerDiv.style.cssText="z-index:6; position:absolute; top:0px; left:0px; background-color:transparent;";this.opaqueDiv=document.createElement("div");this.opaqueDiv.style.cssText="position:absolute; vertical-align:middle; top:0px; left:0px; padding-left:20px; padding-right:20px; background-color:#ffffff; border:1px solid #EBEEF2; white-space:nowrap;";for(var e=0;e<this._childElems.length;e++)this.opaqueDiv.appendChild(this._childElems[e]);this.opaqueContainerDiv.appendChild(this.opaqueDiv)};return e})();t.ElementCover=T;var N=(function(){function e(e,t){this._elementToCover=e;this._optBannerId=t;this.Init()}e.prototype.Show=function(e){if(null==e){this.imgElem.alt=this.imgElem.title="";this.textElem.style.display="none"}else{g.DomElement.GetInstance().SetText(this.textElem,e);this.imgElem.alt=this.imgElem.title=e;this.textElem.style.display=""}this.elemCover.Show()};e.prototype.Hide=function(){this.elemCover.Hide()};e.prototype.UpdateText=function(e){g.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.RefreshLayout()};e.prototype.Dispose=function(){this.elemCover.Dispose();this.textElem=this.imgElem=this._elementToCover=null};e.prototype.Init=function(){this.imgElem=document.createElement("img");this.imgElem.src=t.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"progress-circle-24.gif";this.imgElem.style.cssText="vertical-align:middle;margin:30px 10px 30px 10px";this.textElem=document.createElement("span");this.textElem.style.cssText="vertical-align:middle; margin:30px 10px 30px 10px; color:black; text-align:center; white-space:nowrap; overflow:hidden";this.elemCover=new T(this._elementToCover,[this.imgElem,this.textElem],this._optBannerId)};return e})();t.LoadingBanner=N;var C=(function(){function e(e,t){this._elementToCover=e;this._optBannerId=t;this.Init()}e.prototype.Show=function(e){g.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.Show()};e.prototype.Hide=function(){this.elemCover.Hide()};e.prototype.UpdateText=function(e){g.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.RefreshLayout()};e.prototype.Dispose=function(){this.elemCover.Dispose();this.textElem=this._elementToCover=null};e.prototype.Init=function(){var e=document.createElement("table");this.textElem=e.insertRow(-1).insertCell(-1);this.textElem.style.cssText="align:middle; vertical-align:middle; color:#AA0000;text-align:center; padding:20px;";this.elemCover=new T(this._elementToCover,[e],this._optBannerId)};return e})();t.ErrorBanner=C;(function(e){e.IsChar=function(e){return e.rawEvent?"keypress"==e.type&&(null==e.rawEvent.which||e.rawEvent.which>0&&e.rawEvent.charCode>0):"keypress"==e.type};e.FocusElementInDOMCollection=function(e,n,r){var i=[];function s(e){return null!=e.hasAttribute?e.hasAttribute("tabIndex")&&-1==e.getAttribute("tabIndex"):null!=e.tabIndex&&-1==e.tabIndex}(function e(t){for(var n=0;n<t.length;n++){var r=t[n];s(r)&&i.push(r);e(r.childNodes)}})(e);return(function(){if(0==i.length)return null;var e;if(null==n)e=i[0];else for(var s=0;s<i.length;s++)if(i[s]===n){e=r?s==i.length-1?i[0]:i[s+1]:0==s?i[i.length-1]:i[s-1];break}if(null!=e)try{e.focus()}catch(e){t.DebugAssert(!1,"Incorrectly trying to focus the element. Is it hidden?")}return e})()};e.CloneObj=function(e,t){return g.CloneObj(e,t)};e.GetDocumentDirection=function(){return document.documentElement.getAttribute("dir")};e.HTMLDecode=function(e){return g.Encoding_STSHtmlDecode(e)};e.HTMLEncode=function(e){return g.Encoding_STSHtmlEncode(e)};var n=(function(){function e(e){this._jsFilesLoaded=!1;this._totalFilesToLoad=e;this._numLoadedJsFiles=0}e.prototype._countLoadedJsFiles=function(e,t){void 0===t&&(t=[]);this._numLoadedJsFiles++;if(this._numLoadedJsFiles>=this._totalFilesToLoad){this._jsFilesLoaded=!0;t.forEach(function(e){return e()});e()}};e.prototype._ensureExternalJsFilesLoaded=function(e,n,r){void 0===e&&(e=[]);if(this._jsFilesLoaded)n();else{var i=t.injectJsScript,s=this._countLoadedJsFiles.bind(this,n,r);e.forEach(function(e){return i(e,s)})}};return e})();e.LoadExternalJsFiles=n})(t.Utility||(t.Utility={}));var k=(function(){function e(){this._changeKeys=new Array}e.prototype.GetList=function(){return this._changeKeys};e.prototype.AddMapping=function(e,t){var n={id:e,fn:t};this._changeKeys.splice(g.LowerBound(this._changeKeys,e,"id"),0,n)};e.prototype.RemoveMapping=function(e){var t=g.BinarySearch(this._changeKeys,e,"id");null!=t&&this._changeKeys.splice(t,1);return null!=t};e.prototype.CallFunctions=function(e,t,n){for(var r=0;r<this._changeKeys.length&&this._changeKeys[r].id<=e;r++){null!=this._changeKeys[r].fn&&this._changeKeys[r].fn(t,n);this.RemoveMapping(this._changeKeys[r].id)}};return e})();t.ChangeKeyOnCompleteMap=k;t.SpRegionalSettings={adjustHijriDays:1,calendarType:1,firstDayOfWeek:3,firstWeekOfYear:4,localeId:1033,currentDateInLocalCalendar:new Date(2013,10,9),showWeeks:!0,timeZone:"-7:00",timeZoneInHours:-7,workDayEnd:16,workDayStart:8,workDays:"1110111",time24:"1"};t.hasPasteStarted=!1;t.injectJsScript=function(e,t,n){void 0===n&&(n=function(){});if(null==document.getElementById(e)){var r=document.createElement("script");r.setAttribute("type","text/javascript");r.setAttribute("src",e);r.id=e;r.onload=function(){t();n()};document.getElementsByTagName("head")[0].appendChild(r)}else{t();n()}};t.csomJsFilesLoader=new t.Utility.LoadExternalJsFiles(4);t.taxonomyLoadCallback=function(){SP.Taxonomy||(function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["mMt"],t,n)})];case 1:return[2,t.sent()]}})})})().then(function(e){SP.Taxonomy={TaxonomyFieldValue:e.TaxonomyFieldValue,TaxonomyFieldValueCollection:e.TaxonomyFieldValueCollection}})}})(t.JsGridUtil||(t.JsGridUtil={}))});
define("sGe",["require","exports","cGe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.collection=n.JsGridUtil.Internal.IsNullOrUndefined(e)?{}:e}e.prototype.IsEmpty=function(){for(var e in this.collection)return!1;return!0};e.prototype.First=function(){for(var e in this.collection)return e;n.JsGridUtil.DebugAssert(!1,"Should not call First on empty Set");return null};e.prototype.GetCollection=function(){return this.collection};e.prototype.ToArray=function(){return n.JsGridUtil.Internal.ConvertSetKeysToArray(this.collection)};e.prototype.AddArray=function(e){for(var t=0;t<e.length;t++)this.collection[e[t]]=1;return this};e.prototype.Add=function(e){this.collection[e]=1;return e};e.prototype.Remove=function(e){var t=this.collection[e];delete this.collection[e];return t};e.prototype.Clear=function(){this.collection={};return this};e.prototype.Contains=function(e){return e in this.collection};e.prototype.Clone=function(){var t={};for(var n in this.collection)t[n]=1;return new e(t)};e.prototype.SymmetricDifference=function(t){var n={};for(var r in this.collection)r in t.collection||(n[r]=1);for(r in t.collection)r in this.collection||(n[r]=1);return new e(n)};e.prototype.Difference=function(t){var n={};for(var r in this.collection)r in t.collection||(n[r]=1);return new e(n)};e.prototype.Union=function(e){var t=this.Clone();for(var n in e.collection)t.collection[n]=1;return t};e.prototype.UnionWith=function(e){for(var t in e.collection)this.collection[t]=1};e.prototype.Intersection=function(t){var n={};for(var r in this.collection)r in t.collection&&(n[r]=1);return new e(n)};return e})();t.Set=r;var i=(function(){function e(){this.dictionary={};this.valueKeyMap={}}e.prototype.Add=function(e,t){this.dictionary[e]=t;this.valueKeyMap[t]=e};e.prototype.RemoveKey=function(e){delete this.valueKeyMap[this.dictionary[e]];delete this.dictionary[e]};e.prototype.RemoveValue=function(e){delete this.dictionary[this.valueKeyMap[e]];delete this.valueKeyMap[e]};e.prototype.GetValue=function(e){return this.dictionary[e]};e.prototype.GetKey=function(e){return this.valueKeyMap[e]};e.prototype.GetDictionary=function(){return this.dictionary};e.prototype.Clear=function(){this.dictionary={};this.valueKeyMap={}};e.prototype.ContainsKey=function(e){return e in this.dictionary};e.prototype.ContainsValue=function(e){return e in this.valueKeyMap};return e})();t.KeyMap=i;var s=(function(){function e(e,t){if(null==e||null==t)this.Clear();else{this.begin=e;this.end=t}}e.prototype.Normalize=function(){var e=Math.min(this.begin,this.end),t=Math.max(this.begin,this.end);this.begin=e;this.end=t;return this};e.prototype.Contains=function(e){return e>=this.begin&&e<=this.end};e.prototype.IsEmpty=function(){return this.begin>this.end};e.prototype.Clear=function(){this.begin=0;this.end=-1};e.prototype.Size=function(){return Math.max(0,this.end-this.begin+1)};e.prototype.Overlaps=function(e){return this.end>=e.begin&&e.end>=this.begin};e.prototype.Intersect=function(t){return new e(Math.max(this.begin,t.begin),Math.min(this.end,t.end))};e.prototype.IsDifferent=function(e){return this.begin!==e.begin||this.end!==e.end};return e})();t.Range=s});
define("dGe",["require","exports","cGe","eGe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this.data=e;this.localized=t}e.prototype.HasDataValue=function(){return this.data!==n.JsGridUtil.EmptyValue};e.prototype.HasLocalizedValue=function(){return this.localized!==n.JsGridUtil.EmptyValue};return e})();t.PropertyUpdate=i;t.CreateUnvalidatedPropertyUpdate=function(e,t,n,r){return new s(e,t,n,r)};t.CreateValidatedPropertyUpdate=function(e,t,n,r){return new o(e,t,n,r)};var s=function(e,t,r,i){this.validated=!1;this.recordKey=e;this.fieldKey=t;this.newValue=r;this.newValueIsLocalized=i;if(!n.JsGridUtil._locationFilldownKillswitchIsActive&&!i&&"string"==typeof this.newValue)try{this.newValue=JSON.parse(this.newValue)}catch(e){}};t.UnvalidatedPropertyUpdate=s;var o=function(e,t,n,r){this.validated=!0;this.recordKey=e;this.fieldKey=t;this.newDataValue=n;this.newLocalizedValue=r};t.ValidatedPropertyUpdate=o;var u=(function(){function e(e,t){this._objBag=e}e.prototype.ApplyPropUpdates=function(e,t){for(var n=0;n<e.length;n++)this.ApplySinglePropUpdateRequest(e[n],t)};e.prototype.ApplySinglePropUpdateRequest=function(e,t){var s=this,o=function(o){f=!1;o.isValid?u(new i(o.dataValue,o.normalizedLocValue),r.JsGridConstants.ValidationState.Valid,null):u(e.newValueIsLocalized?new i(n.JsGridUtil.InvalidValue,e.newValue):new i(e.newValue,n.JsGridUtil.InvalidValue),r.JsGridConstants.ValidationState.Invalid,o.errorMsg);l&&s._objBag.pendingChangeMgr.DecrementPendingChangeCount(t)},u=function(n,i,o){e.fieldKey!==r.JsGridConstants.RecordIndicatorCheckboxColumnKey?s._objBag.versionMgr.AddPropChange(e.recordKey,e.fieldKey,t,n,i,o):n.data?s._objBag.checkSelMgr.ExternalAPI.CheckRecord(e.recordKey):s._objBag.checkSelMgr.ExternalAPI.UncheckRecord(e.recordKey)};if(e.validated)u(new i(e.newDataValue,e.newLocalizedValue),r.JsGridConstants.ValidationState.Valid,null);else{var a=this._objBag.controller.GetPropType(e.recordKey,e.fieldKey);n.JsGridUtil.DebugAssert(null!=a);e.newValueIsLocalized&&(e.newValue=null==e.newValue?"":e.newValue.replace(/^\s+|\s+$/g,""));var f=!0,l=!1;a.BeginValidateNormalizeConvert(e.recordKey,e.fieldKey,e.newValue,e.newValueIsLocalized,o,function(){var e={isValid:!1,errorMsg:SP.JsGrid.Res.vncfailed};o(e)});if(f){this._objBag.pendingChangeMgr.IncrementPendingChangeCount(t);l=!0;u(e.newValueIsLocalized?new i(n.JsGridUtil.InvalidValue,e.newValue):new i(e.newValue,n.JsGridUtil.InvalidValue),r.JsGridConstants.ValidationState.Pending,null)}}};return e})();t.PropertyUpdateManager=u;var a=(function(){function e(e){this.callbackCount=0;this.pendingCount=0;this.activeChangeKeys={};this.pendingCallbacks=[];this.completeCallbacks=[];this.pendingChangeKeys={};this.newRowChanges={};e.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnChangeKeyCreated,this.NotifyKeyCreated.bind(this));e.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,this.NotifyKeyInitiallyComplete.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.EntryRecordPropertyChanged.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordCommitted,this.EntryRecordCommitted.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnVacateChange,this.OnVacateChange.bind(this));this._objBag=e}e.prototype.OnVacateChange=function(e){var t=e.changeKey.GetVersionNumber();delete this.activeChangeKeys[t];delete this.pendingChangeKeys[t]};e.prototype.EntryRecordPropertyChanged=function(e){var t=e.recordKey;t in this.newRowChanges||(this.newRowChanges[t]=[]);this.newRowChanges[t].push(e.changeKey);this.IncrementPendingChangeCountForChangeKey(e.changeKey)};e.prototype.EntryRecordCommitted=function(e){var t=e.originalRecordKey;if(t in this.newRowChanges)for(var n=this.newRowChanges[t],r=0;r<n.length;r++)this.TryFireChangeKeyCompleteEvent(n[r])};e.prototype.NotifyKeyCreated=function(e){var t=e.changeKey.GetVersionNumber();this.activeChangeKeys[t]=e.changeKey;this.pendingChangeKeys[t]=1};e.prototype.NotifyKeyInitiallyComplete=function(e){this.TryFireChangeKeyCompleteEvent(e.changeKey)};e.prototype.TryFireChangeKeyCompleteEvent=function(e){var t=this,i=e.GetVersionNumber();if(0==--this.pendingChangeKeys[i]){delete this.pendingChangeKeys[i];this.callbackCount++;setTimeout(function(){t.callbackCount--;t._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnInitialChangesForChangeKeyComplete,n.JsGridUtil.EventArgs.PendingChangeKeyInitiallyComplete(e));delete t.activeChangeKeys[i];if(0!==t.completeCallbacks.length&&!t.AnyActiveChanges()){for(var s=0;s<t.completeCallbacks.length;s++)t.completeCallbacks[s]();t.completeCallbacks=[]}},0)}};e.prototype.AnyActiveChanges=function(){var e=!1;for(var t in this.activeChangeKeys)if(this._objBag.controller.IsChangeKeyApplied(this.activeChangeKeys[t])){e=!0;break}return e};e.prototype.IncrementPendingChangeCountForChangeKey=function(e){var t=e.GetVersionNumber();t in this.pendingChangeKeys?this.pendingChangeKeys[t]++:this.pendingChangeKeys[t]=1};e.prototype.WaitForPendingUpdates=function(e){null!=e&&(0!==this.pendingCount?this.pendingCallbacks.push(e):e())};e.prototype.WaitForAllChangeKeysToComplete=function(e){null!=e&&(0!==this.callbackCount||0!==this.pendingCount||this.AnyActiveChanges()?this.completeCallbacks.push(e):e())};e.prototype.IncrementPendingChangeCount=function(e){this.pendingCount++;this.IncrementPendingChangeCountForChangeKey(e)};e.prototype.DecrementPendingChangeCount=function(e){this.pendingCount--;if(0==this.pendingCount&&0!==this.pendingCallbacks.length){for(var t=0;t<this.pendingCallbacks.length;t++)this.pendingCallbacks[t]();this.pendingCallbacks=[]}this.TryFireChangeKeyCompleteEvent(e)};return e})();t.PendingChangesManager=a});
define("hGe",["require","exports","oGe","cGe","eGe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t,n,r,s,o,u,a){this.key=e;this.hasDataValue=t;this.hasLocalizedValue=n;this.textDirection=r;this._defaultCellStyleId=s;this._editMode=null==o?i.JsGridConstants.EditMode.Defer:o;this._propType=null;this._multiValue=!1;this.dateOnly=null==u||u;this.csrInfo=a}e.prototype.GetEditMode=function(){return this._editMode};e.prototype.SetEditMode=function(e){this._editMode=e};e.prototype.GetDefaultCellStyleId=function(){return this._defaultCellStyleId};e.prototype.CompareSingleDataEqual=function(e,t){var n=this.GetSingleValuePropType().IsDataEqual;return null==n?e==t:n(e,t)};e.prototype.GetPropType=function(){return this._propType};e.prototype.GetSingleValuePropType=function(){return this._multiValue?this._propType.singleValuePropType:this._propType};e.prototype.GetMultiValuePropType=function(){return this._multiValue?this._propType:null};e.prototype.SetSingleValuePropType=function(e){if(this._multiValue&&!r.JsGridUtil.Internal.IsNullOrUndefined(e)){var t=new n.PropertyType.MultiValuePropType(e.ID,this._listSeparator,null,null);n.PropertyType.RegisterNewDerivedCustomPropType(t,e.ID);this._propType=t}else this._propType=e};e.prototype.SetIsMultiValue=function(e){if(!this._multiValue){this._listSeparator=e;this._multiValue=!0;this.SetSingleValuePropType(this._propType)}};e.prototype.GetIsMultiValue=function(){return this._multiValue};return e})();t.GridField=s;var o=(function(){function e(e,t,n,i){this.isVisible=!0;this.isHidable=!0;this.isResizable=!0;this.isSortable=!0;this.isAutoFilterable=!0;this.isFooter=!1;this.bOpenMenuOnContentClick=!1;this.fnShouldLinkSingleValue=null;this.fnSingleValueClicked=null;this.fnGetCellEditMode=null;this.fnGetDisplayControlName=null;this.fnGetEditControlName=null;this.fnGetWidgetControlNames=null;this.fnGetCellStyleId=null;this.fnGetSingleValueTooltip=null;this.name=e;this.imgSrc=t;this.columnKey=n;this.fieldKeys=[n];this.width=i;this.bOpenMenuOnContentClick=!r.JsGridUtil.Internal.IsNullOrUndefined(this.imgSrc)}e.prototype.ColumnType=function(){return"column"};return e})();t.ColumnInfo=o;var u=(function(){function e(e){this.colInfoMap={};this._colInfoArray=e;this.BuildMap()}e.prototype.GetColumnByKey=function(e){return this.colInfoMap[e]};e.prototype.GetColumnArray=function(e){var t=[];if(e)for(var n=0;n<this._colInfoArray.length;++n)this._colInfoArray[n].isVisible&&t.push(this._colInfoArray[n]);else t=this._colInfoArray;return t};e.prototype.GetColumnMap=function(){return this.colInfoMap};e.prototype.AppendColumn=function(e){this.InsertColumnAt(this._colInfoArray.length,e)};e.prototype.InsertColumnAt=function(e,t){this._colInfoArray.splice(e,0,t);this.BuildMap()};e.prototype.RemoveColumn=function(e){var t=this.colInfoMap[e],n=r.JsGridUtil.Internal.FindKey(this._colInfoArray,function(e){return e==t},null);r.JsGridUtil.Internal.IsNullOrUndefined(n)||this._colInfoArray.splice(n,1);this.BuildMap();return n};e.prototype.GetColumnPosition=function(e){for(var t=0,n=0;n<this._colInfoArray.length;++n)if(this._colInfoArray[n].isVisible){if(this._colInfoArray[n].columnKey==e)return t;t++}return null};e.prototype.BuildMap=function(){for(var e=0;e<this._colInfoArray.length;++e)this.colInfoMap[this._colInfoArray[e].columnKey]=this._colInfoArray[e]};return e})();t.ColumnInfoCollection=u});
define("oGe",["require","exports","lC","cGe","eGe","pze","me","ce","s9"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=u.Killswitch.isActivated("5A1F221C-336E-4AD0-B168-F49F39DC1347","3/20/2020","fix custom formatter choice fields");(function(e){var t=(function(){function e(){var e=this;this.ID="String";this.toString=function(){return e.ID}}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=null!=n&&0==n.length?null:n;s({isValid:!0,dataValue:n=r.JsGridUtil.SPUserValueOnPasteFixup(n),normalizedLocValue:n})};return e})();e.String=t;var u=function(e,t,n){var i=this;this.GetItemFromData=function(e){return null==e?null:r.JsGridUtil.Internal.Find(i._items,function(t){return t.value==e})};this.GetItemFromLocalized=function(e){if(null==e)return null;var t=e.toLowerCase();return r.JsGridUtil.Internal.Find(i._items,function(e){return e.localString.toLowerCase()==t})};this.BeginValidateNormalizeConvert=function(e,t,n,r,s,o){var u={},a=r?i.GetItemFromLocalized(n):i.GetItemFromData(n);u.isValid=null!=a||!i._bLimitToList;if(null!=a){u.normalizedLocValue=a.localString;u.dataValue=a.value}else u.normalizedLocValue=u.dataValue=n;s(u)};this.GetItems=function(e){for(var t=[],n=0;n<i._items.length;n++)t.push(x.prototype.MakeProperty(i._items[n].value,i._items[n].localString,!0,!0,i));e(t)};this.DataToLocalized=function(e){var t=i.GetItemFromData(e);return f?t?t.localString:r.JsGridUtil.EmptyValue:t?t.localString:""};this.LocalizedToData=function(e){var t=i.GetItemFromLocalized(e);return f?t?t.value:r.JsGridUtil.EmptyValue:t?t.value:""};this.GetImageSource=function(e,t){var n=i.GetItemFromData(t);return null!=n?n.imageUrl:null};this.GetStyleId=function(e){var t=i.GetItemFromData(e);return null!=t?t.styleId:null};this.GetIsLimitedToList=function(){return i._bLimitToList};this.GetSerializableLookupPropType=function(){return{items:i._items,id:i._id,bLimitToList:i._bLimitToList}};this._items=e;this._id=t;this._bLimitToList=n;this.ID=t};e.LookupTable=u;var l=(function(){function e(){this.ID="CheckBoxBoolean"}e.prototype.BeginValidateNormalizeConvert=function(e,n,r,i,s,o){"string"!=typeof r&&r.constructor!=t||(r=r.toUpperCase());i||"boolean"==typeof r||(r="1"==r);s({isValid:!0,dataValue:r=i?""!==r&&"0"!==r:!!r,normalizedLocValue:this.DataToLocalized(r)})};e.prototype.DataToLocalized=function(e){"boolean"!=typeof e&&(e="1"==e);return e?"1":"0"};e.prototype.toString=function(){return this.ID};return e})();e.CheckBoxBoolean=l;var c=(function(){function n(){this.ID="DropdownBoolean"}n.prototype.BeginValidateNormalizeConvert=function(e,n,r,i,s,o){"string"!=typeof r&&r.constructor!=t||(r=r.toUpperCase());i||"boolean"==typeof r||(r="1"==r);s({isValid:!0,dataValue:r=i?""!==r&&r!==SP.JsGrid.Res.booleanNo.toUpperCase():!!r,normalizedLocValue:this.DataToLocalized(r)})};n.prototype.DataToLocalized=function(e){"boolean"!=typeof e&&(e="1"==e);return e?SP.JsGrid.Res.booleanYes:SP.JsGrid.Res.booleanNo};n.prototype.GetBool=function(e){"boolean"!=typeof e&&(e="1"==e);return e!=r.JsGridUtil.EmptyValue&&!!e};n.prototype.GetItems=function(t){for(var n=[],r=0;r<2;r++){var i=1==r?SP.JsGrid.Res.booleanYes:SP.JsGrid.Res.booleanNo;n.push(e.Property.prototype.MakeProperty(r,i,!0,!0,this))}t(n)};n.prototype.toString=function(){return this.ID};return n})();e.DropdownBoolean=c;var h=(function(){function t(e,t,n,i){var s=this;this.LocStrArrayToLocStr=function(e){return r.JsGridUtil.Internal.JoinStrings(e,s._separatorChar+" ")};this._singleValuePropTypeID=e;this._separatorChar=t;this._bDelayInit=n;this._bAllowDuplicateValues=i;this.ID=e+"_MultiValue";this.bMultiValue=!0;this.separator=t;this.singleValuePropType=this.svPropType;n||this.InitSVPropType()}t.prototype.InitSVPropType=function(){var t=this;this.svPropType=e.Internal.Property.GetInstance().GetPropType(this._singleValuePropTypeID);this.singleValuePropType=this.svPropType;null!=this.svPropType&&null!=this.svPropType.SetSeparator&&this.svPropType.SetSeparator(this._separatorChar);this.GetImageSource=this.svPropType.GetImageSource&&function(e,n){return t.ForEachInArray(n,function(n){return t.svPropType.GetImageSource(e,n)})};this.GetItems=this.svPropType.GetItems;this.GetUpdateTrackingMode=this.svPropType.GetUpdateTrackingMode;this.GetUpdateSerializeMode=this.svPropType.GetUpdateSerializeMode;this.DataToLocalized=this.svPropType.DataToLocalized&&function(e){return t.LocStrArrayToLocStr(t.ForEachInArray(e,function(e){return t.svPropType.DataToLocalized(e)}))};this.LocalizedToData=this.svPropType.LocalizedToData&&function(e){return t.ForEachInArray(t.LocStrToLocStrArray(e),function(e){return t.svPropType.LocalizedToData(e)})};this.GetDisplayValue=this.svPropType.GetDisplayValue&&function(e,n,i){var s=[];if(null!=n&&n!==r.JsGridUtil.EmptyValue&&n!==r.JsGridUtil.InvalidValue)for(var o=t.LocStrToLocStrArray(i),u=0;u<n.length;u++)s.push(t.svPropType.GetDisplayValue(e,n[u],u>=o.length?null:o[u]));else s.push(t.svPropType.GetDisplayValue(e,n,i));return r.JsGridUtil.Internal.JoinStrings(s,t._separatorChar+" ")}};t.prototype.GetCopyValue=function(e,t,n){return"SPUser"==this._singleValuePropTypeID&&null!=t&&t!==r.JsGridUtil.EmptyValue&&t!==r.JsGridUtil.InvalidValue?this.svPropType.GetCopyValue(e,t,n):n};t.prototype.GetSerializableMultiValuePropType=function(){return{singleValuePropTypeID:this._singleValuePropTypeID,separatorChar:this._separatorChar,bDelayInit:this._bDelayInit}};t.prototype.InitSingleValuePropType=function(){this.InitSVPropType()};t.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){var u=this,a=function(){u.svPropType.BeginValidateNormalizeConvert(e,t,n[p],i,f,o)},f=function(e){l(e);++p<n.length?a():s(c())},l=function(e){if(0==p)h={isValid:e.isValid,dataValue:[e.dataValue],normalizedLocValue:[e.normalizedLocValue]};else{h.isValid=h.isValid&&e.isValid;h.dataValue.push(e.dataValue);h.normalizedLocValue.push(e.normalizedLocValue)}},c=function(){if(null!=h){if(h.isValid){if(!u._bAllowDuplicateValues)for(var e=u.svPropType.IsDataEqual,t=h.dataValue,n=0;n<t.length;n++)for(var r=0;r<t.length;r++)n!=r&&(null==e?t[n]==t[r]:e(t[n],t[r]))&&t.splice(r,1);h.normalizedLocValue=u.LocStrArrayToLocStr(h.normalizedLocValue);return h}return{isValid:!1}}return{isValid:!0,dataValue:null,normalizedLocValue:null}};if(i&&""==n||!(i||null!=n&&0!=n.length))s({isValid:!0,dataValue:[],normalizedLocValue:""});else{i&&(n=this.LocStrToLocStrArray(n));r.JsGridUtil.DebugAssert(n.constructor==Array);var h,p=0;a()}};t.prototype.LocStrToLocStrArray=function(e){return e&&"string"!=typeof e?[]:r.JsGridUtil.Internal.TokenizeString(e,this._separatorChar)};t.prototype.ForEachInArray=function(e,t){if(null==e)return null;for(var n=[],r=0;r<e.length;r++)n.push(t(e[r]));return n};return t})();e.MultiValuePropType=h;var p=(function(){function e(){this.ID="Hyperlink";this.bHyperlink=!0;this._serializedValueStartsEndsWith='"';this._serializedValueSeparator='", "';this._serializedValueSeparatorEncoded=encodeURIComponent(this._serializedValueSeparator)}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?this.Deserialize(n):n;s({isValid:null!=u,dataValue:u,normalizedLocValue:this.DataToLocalized(u)})};e.prototype.DataToLocalized=function(e){return e?e.display:""};e.prototype.GetAddress=function(e){return e?e.address:""};e.prototype.GetCopyValue=function(e,t,n){return this.Serialize(t)};e.prototype.Serialize=function(e){if(!e)return null;var t=e.address.replace(this._serializedValueSeparator,this._serializedValueSeparatorEncoded);return o.format("{0}{1}{2}{3}{0}",this._serializedValueStartsEndsWith,t,this._serializedValueSeparator,e.display)};e.prototype.Deserialize=function(e){if(null==e)return null;0==e.length&&(e="");var t=e.indexOf(this._serializedValueSeparator);return t<0||!e.startsWith(this._serializedValueStartsEndsWith)||!e.endsWith(this._serializedValueStartsEndsWith)?{address:e,display:e}:{address:e.substring(1,t).replace(this._serializedValueSeparatorEncoded,this._serializedValueSeparator),display:e.substring(t+this._serializedValueSeparator.length,e.length-1)}};e.prototype.toString=function(){return this.ID};return e})();e.Hyperlink=p;var d=(function(){function e(){this.ID="Location";this.ForceDataCopy=!0}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?this.Deserialize(n):n;s({isValid:null!=u,dataValue:u,normalizedLocValue:this.DataToLocalized(u)})};e.prototype.DataToLocalized=function(e){return e?e.DisplayName:""};e.prototype.GetCopyValue=function(e,t,n){return r.JsGridUtil._locationFilldownKillswitchIsActive?this.Serialize(t):JSON.stringify(this.Serialize(t))};e.prototype.toString=function(){return this.ID};e.prototype.Serialize=function(e){return r.JsGridUtil._locationFilldownKillswitchIsActive?null:e};e.prototype.Deserialize=function(e){return null};return e})();e.Location=d;e.RegisterNewLookupPropType=function(t,n,i,o){r.JsGridUtil.DebugAssert(i==s.DisplayControlType.Image||i==s.DisplayControlType.ImageText||i==s.DisplayControlType.Text);var u=new e.LookupTable(n,t,o);v.Property.GetInstance().RegisterPropType(u,i,s.EditControlType.ComboBox,[])};e.RegisterNewCustomPropType=function(e,t,n,r){v.Property.GetInstance().RegisterPropType(e,t,n,r)};e.RegisterNewDerivedCustomPropType=function(e,t){v.Property.GetInstance().RegisterDerivedPropType(e,t)};(function(e){e.RegisterDisplayControl=function(e,t,n){v.Property.GetInstance().RegisterDisplayControl(e,t,n)};e.RegisterEditControl=function(e,t,n){v.Property.GetInstance().RegisterEditControl(e,t,n)};e.RegisterWidgetControl=function(e,t,n){v.Property.GetInstance().RegisterWidgetControl(e,t,n)};e.UpdateDisplayControlForPropType=function(e,t){v.Property.GetInstance().UpdateDisplayControlForPropType(e,t)};e.UpdateEditControlForPropType=function(e,t){v.Property.GetInstance().UpdateEditControlForPropType(e,t)};e.UpdateWidgetControlsForPropType=function(e,t){v.Property.GetInstance().UpdateWidgetControlsForPropType(e,t)};e.GetPropType=function(e){return v.Property.GetInstance().GetPropType(e)};e.GetPropTypes=function(){return v.Property.GetInstance().GetPropTypes()}})(e.Utils||(e.Utils={}));var v,m={ODB:1507},g={ODB:1806},y={ODB:1892},b={ODB:1300},w={ODB:1470};(function(e){var n=(function(){function e(){this.defaultControlsMap={};this.eligibleControlsMap={};var e=r.JsGridUtil.Internal.IsFeatureEnabled(m),n=1==r.JsGridUtil.SpRegionalSettings.calendarType,o=r.JsGridUtil.Internal.IsFeatureEnabled(g),u=r.JsGridUtil.Internal.IsFeatureEnabled(y),a=r.JsGridUtil.Internal.IsFeatureEnabled(b),f=r.JsGridUtil.Internal.IsFeatureEnabled(w);this.propTypeInfoTable=[[new t,s.DisplayControlType.Text,s.EditControlType.EditBox,[]],[new l,s.DisplayControlType.Checkbox,s.EditControlType.Checkbox,[]],[new c,s.DisplayControlType.Text,u?s.EditControlType.BooleanComboBox:s.EditControlType.ComboBox,[]],[new p,s.DisplayControlType.Text,s.EditControlType.Hyperlink,o?[]:[s.WidgetControlType.Hyperlink]],[new d,s.DisplayControlType.Text,s.EditControlType.LocationPicker,[]]];this.propSingletonMap=r.JsGridUtil.Internal.ConvertTableToMap(this.propTypeInfoTable,"0","1");this.displayControlInfoTable=[[s.DisplayControlType.Image,new s.DisplayControl.ImageDisplayControl,["GetImageSource"]],[s.DisplayControlType.ImageText,new s.DisplayControl.ImageTextDisplayControl,["GetImageSource"]],[s.DisplayControlType.Text,new s.DisplayControl.TextDisplayControl,[]],[s.DisplayControlType.Checkbox,new s.DisplayControl.CheckboxDisplayControl,["GetBool"]],[s.DisplayControlType.CSR,new s.DisplayControl.CSRDisplayControl,[]],[s.DisplayControlType.CustomFormatter,new s.DisplayControl.CustomFormatterDisplayControl,[]],[s.DisplayControlType.User,new s.DisplayControl.UserDisplayControl,["GetSipAddress"]],[s.DisplayControlType.ImageThumbnail,new s.DisplayControl.ImageThumbnailDisplayControl,[]]];this.displayControlsSingletonMap=r.JsGridUtil.Internal.ConvertTableToMap(this.displayControlInfoTable,"0","1");this.displayControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.displayControlInfoTable,"0","2");this.editControlInfoTable=[[s.EditControlType.EditBox,function(e,t){return new s.EditControl.EditBoxEditControl(e,t)},[]],[s.EditControlType.Checkbox,function(e){return new s.EditControl.CheckboxEditControl(e)},["GetBool"]],[s.EditControlType.PeoplePicker,function(e){return new s.EditControl.PeoplePickerEditControl(e)},["GetSipAddress"]],[s.EditControlType.LocationPicker,function(e){return new s.EditControl.LocationPickerEditControl(e)},[]]];f&&this.editControlInfoTable.push([s.EditControlType.Checkbox,function(e){return new s.EditControl.CheckboxEditControl(e)},[]]);a&&this.editControlInfoTable.push([s.EditControlType.NumberBox,function(e){return new s.EditControl.NumberEditControl(e)},[]]);e&&n&&this.editControlInfoTable.push([s.EditControlType.DatePicker,function(e){return new s.EditControl.DateEditControl(e)},[]]);o?this.editControlInfoTable.push([s.EditControlType.Hyperlink,function(e){return new s.EditControl.HyperlinkEditControlV2(e)},[]]):this.editControlInfoTable.push([s.EditControlType.Hyperlink,function(e,t){return s.EditControl.GetHyperlinkEditControl(e,t)},[]]);if(u){this.editControlInfoTable.push([s.EditControlType.ComboBox,function(e){return new s.EditControl.ModernComboBoxEditControl(e)},["GetItems"]]);this.editControlInfoTable.push([s.EditControlType.BooleanComboBox,function(e){return new s.EditControl.ComboBoxEditControl(e)},["GetItems"]])}else this.editControlInfoTable.push([s.EditControlType.ComboBox,function(e){return new s.EditControl.ComboBoxEditControl(e)},["GetItems"]]);this.editControlsFactoryMap=r.JsGridUtil.Internal.ConvertTableToMap(this.editControlInfoTable,"0","1");this.editControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.editControlInfoTable,"0","2");this.widgetControlInfoTable=[[i.JsGridConstants.ErrorWidgetId,function(e,t){return new s.WidgetControl.ErrorWidget(e,t)},[]]];e&&n||this.widgetControlInfoTable.push([s.WidgetControlType.Date,function(e){return new s.WidgetControl.DateWidget(e)},[]]);o||this.widgetControlInfoTable.push([s.WidgetControlType.Hyperlink,function(e){return new s.WidgetControl.HyperlinkWidget(e)},["GetAddress"]]);this.widgetControlsFactoryMap=r.JsGridUtil.Internal.ConvertTableToMap(this.widgetControlInfoTable,"0","1");this.widgetControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.widgetControlInfoTable,"0","2");this.Init()}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.GetDefaultDisplayControlMap=function(){var e={};for(var t in this.defaultControlsMap)e[t]=this.defaultControlsMap[t].display.Id;return e};e.prototype.RegisterDefaultPropTypesFromDefaultDisplayControlMap=function(e,t){null==t&&(t={});for(var n in e)null==this.defaultControlsMap[n]&&this.RegisterDefaultDisplayPropTypeInternal(n,this.GetDisplayControl(e[n]),t)};e.prototype.GetLookupPropTypeMap=function(){var e={};for(var t in this.propSingletonMap)null!=this.propSingletonMap[t].GetSerializableLookupPropType?e[t]=this.propSingletonMap[t].GetSerializableLookupPropType():this.propSingletonMap[t].bMultiValue&&null!=this.propSingletonMap[t].singleValuePropType.GetSerializableLookupPropType&&(e[t]=this.propSingletonMap[t].GetSerializableMultiValuePropType());return e};e.prototype.RegisterDisplayControl=function(e,t,n){this.displayControlsSingletonMap[e]=t;this.displayControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.RegisterEditControl=function(e,t,n){this.editControlsFactoryMap[e]=t;this.editControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.RegisterWidgetControl=function(e,t,n){this.widgetControlsFactoryMap[e]=t;this.widgetControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.GetPropType=function(e){r.JsGridUtil.DebugAssert(e in this.propSingletonMap);return this.propSingletonMap[e]};e.prototype.GetPropTypes=function(){var e=[];for(var t in this.propSingletonMap)e.push(t);return e};e.prototype.PropTypeExists=function(e){return e in this.propSingletonMap};e.prototype.GetDisplayControl=function(e){r.JsGridUtil.DebugAssert(e in this.displayControlsSingletonMap);return this.displayControlsSingletonMap[e]};e.prototype.GetEditControl=function(e,t){r.JsGridUtil.DebugAssert(e in this.editControlsFactoryMap,o.format("Edit control named {0} needs to be registered before being instatiated."));return this.editControlsFactoryMap[e].apply(null,t)};e.prototype.GetWidgetControl=function(e,t){r.JsGridUtil.DebugAssert(e in this.widgetControlsFactoryMap,o.format("Widget control named {0} needs to be registered before being instatiated."));return this.widgetControlsFactoryMap[e].apply(null,t)};e.prototype.GetUpdateTrackingMode=function(e,t){if(null!=e.GetUpdateTrackingMode)return e.GetUpdateTrackingMode();r.JsGridUtil.DebugAssert(null==t||t.hasDataValue||t.hasLocalizedValue);return null!=t&&t.hasDataValue?t.hasLocalizedValue?i.JsGridConstants.UpdateTrackingMode.PropBoth:i.JsGridConstants.UpdateTrackingMode.PropData:i.JsGridConstants.UpdateTrackingMode.PropLocalized};e.prototype.GetUpdateSerializeMode=function(e,t){if(e&&null!=e.GetUpdateSerializeMode)return e.GetUpdateSerializeMode();var n=null!=e&&null!=t?this.GetUpdateTrackingMode(e,t):i.JsGridConstants.UpdateSerializeMode.PropBoth;n==i.JsGridConstants.UpdateSerializeMode.PropBoth&&(n=i.JsGridConstants.UpdateSerializeMode.PropLocalizedOnly);return n};e.prototype.RegisterDefaultDisplayPropTypeInternal=function(e,t,n){if(e in n){var r=n[e];null!=r.singleValuePropTypeID?this.propSingletonMap[e]=new h(r.singleValuePropTypeID,r.separatorChar,r.bDelayInit,null):this.propSingletonMap[e]=new u(r.items,r.id,r.bLimitToList)}delete this.eligibleControlsMap[e];this.defaultControlsMap[e]={display:t,editControlName:"",widgetControlNames:[]}};e.prototype.RegisterPropType=function(e,t,n,r){t||(t=s.DisplayControlType.Text);r=null==r?[]:r;this.RegisterPropTypeInternal(e,this.GetDisplayControl(t),n,r)};e.prototype.RegisterDerivedPropType=function(e,t){var n=this.defaultControlsMap[t];this.RegisterPropTypeInternal(e,n.display,n.editControlName,n.widgetControlNames)};e.prototype.RegisterPropTypeInternal=function(e,t,n,r){this.propSingletonMap[e.ID]=e;delete this.eligibleControlsMap[e.ID];this.defaultControlsMap[e.ID]={display:t,editControlName:n,widgetControlNames:r}};e.prototype.UpdateDisplayControlForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].display=this.GetDisplayControl(t)};e.prototype.UpdateEditControlForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].editControlName=t};e.prototype.UpdateWidgetControlsForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].widgetControlNames=t};e.prototype.GetDisplayControlForProperty=function(e,t){return null!=t?this.GetDisplayControl(t):this.defaultControlsMap[e.ID].display};e.prototype.GetEditAndWidgetControlNamesForProperty=function(e,t,n,r){var i,s;return{editControlName:null!=t.fnGetEditControlName&&null!=(i=t.fnGetEditControlName(e,n))?i:this.defaultControlsMap[r.ID].editControlName,widgetControlNames:null!=t.fnGetWidgetControlNames&&null!=(s=t.fnGetWidgetControlNames(e,n))?s:[].concat(this.defaultControlsMap[r.ID].widgetControlNames)}};e.prototype.Init=function(){for(var e in this.propTypeInfoTable){var t=this.propTypeInfoTable[e];this.RegisterPropType(t[0],t[1],t[2],t[3])}this.InitLocalNumericTypesForGrid();this.InitLocalDateTypeForGrid()};e.prototype.InitLocalDateTypeForGrid=function(){var e=1==r.JsGridUtil.SpRegionalSettings.calendarType;r.JsGridUtil.Internal.IsFeatureEnabled(m)&&e?this.RegisterPropType(new a("JSDateTime","M/d/yyyy"),s.DisplayControlType.Text,s.EditControlType.DatePicker,[]):this.RegisterPropType(new a("JSDateTime","M/d/yyyy"),s.DisplayControlType.Text,s.EditControlType.EditBox,[s.WidgetControlType.Date])};e.prototype.InitLocalNumericTypesForGrid=function(){var e=function(e,t,n,r,i,s){var o=this;var u=r?(function(e){e=null!=o.PreParse?o.PreParse(e):e;var t=parseFloat(e);return null!=o.PostParse?o.PostParse(t):t})(n):null!=n.format?n:parseFloat(n+""),a=u.localeFormat(this.FormatString);i({isValid:!isNaN(u),dataValue:null!=this.ProcessData?this.ProcessData(u):u,normalizedLocValue:null!=this.ProcessLocalized?this.ProcessLocalized(u,a):a})},t=function(e,t){r.JsGridUtil.DebugAssert("number"==typeof e&&"number"==typeof t);return e-t},n=[{ID:"JSNumber",FormatString:"D"}];for(var i in n){var o=r.JsGridUtil.Internal.object(n[i]);o.BeginValidateNormalizeConvert=e;o.CompareTo=t;this.RegisterPropType(o,s.DisplayControlType.Text,s.EditControlType.EditBox,[])}};return e})();e.Property=n;var a=(function(){function e(e,t){this.ID=e;this._formatString=t}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s){var o={};n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?Date.parse(n)||Date.parse(n)||Date.parse(n):null!=n.getTime?n:new Date(+n);u=null!=u?new Date(u):null;o.isValid=null!=u&&!isNaN(u.getTime());o.dataValue=o.isValid?u:null;o.normalizedLocValue=o.isValid?u.localeFormat(this._formatString):null;s(o)};return e})();e.JSDateTime=a})(v=e.Internal||(e.Internal={}));var E=(function(){function t(e,t,n){this.gridFieldMap=e;this._keyColumnName=t;this._fnGetPropType=n}t.prototype.MakeRecord=function(t,n,r){var i=new S;i.recordKey=t[this._keyColumnName];for(var s in this.gridFieldMap){var o=this.gridFieldMap[s],u=e.Property.prototype.MakePropertyFromGridField(o,t[s],n[s],null==this._fnGetPropType||o.GetIsMultiValue()?null:this._fnGetPropType(i.recordKey,o.key,t));if(null!=u){i.properties[s]=u;if(!r){delete t[s];delete n[s]}}}i.fieldRawDataMap=null!=t?t:{};i.fieldRawLocMap=null!=n?n:{};return i};return t})();e.RecordFactory=E;var S=(function(){function e(){this.properties={};this.areValuesUpdated=!1}e.prototype.key=function(){return this.recordKey};e.prototype.GetDataValue=function(e){return e in this.properties?this.properties[e].GetData():this.fieldRawDataMap[e]};e.prototype.GetLocalizedValue=function(e){return e in this.properties?this.properties[e].GetLocalized():this.fieldRawLocMap[e]};e.prototype.HasDataValue=function(e){return e in this.properties?this.properties[e].HasDataValue():e in this.fieldRawDataMap};e.prototype.HasLocalizedValue=function(e){return e in this.properties?this.properties[e].HasLocalizedValue():e in this.fieldRawLocMap};e.prototype.HasUpdatedValues=function(){return this.areValuesUpdated};e.prototype.UpdateLocalizedValuesWithColumnData=function(e){for(var t=0;t<e.length;t++)if("Number"===e[t].FieldType&&null!=e[t].CommaSeparator){var n=this.properties[e[t].Name],r=n.GetLocalized();r=a.formatNumberString(r,e[t].CommaSeparator);n.LocalizedProperty(r)}this.areValuesUpdated=!0};e.prototype.GetProp=function(e){return this.properties[e]};e.prototype.SetProp=function(e,t){r.JsGridUtil.DebugAssert(e in this.properties);this.properties[e]=t};e.prototype.AddFieldValue=function(e,t){if(t.isProp)this.properties[e]=t.prop;else if(e in this.properties)this.properties[e].Update(t.hasData?t.data:r.JsGridUtil.EmptyValue,t.hasLocalized?t.localized:r.JsGridUtil.EmptyValue);else{t.hasLocalized&&(this.fieldRawLocMap[e]=t.localized);t.hasData&&(this.fieldRawDataMap[e]=t.data)}};e.prototype.RemoveFieldValue=function(e){delete this.properties[e];delete this.fieldRawLocMap[e];delete this.fieldRawDataMap[e]};return e})();e.Record=S;var x=(function(){function e(e,t,n){null!=n&&(this.propType=n);null!=e&&(this.dataValue=e);null!=t&&(this.localizedValue=t)}e.prototype.LocalizedProperty=function(e,t){this.localizedValue=e;null!=t&&(this.propType=t)};e.prototype.DataProperty=function(e,t){this.dataValue=e;null!=t&&(this.propType=t)};e.prototype.HasLocalizedValue=function(){return!0};e.prototype.HasDataValue=function(){return!0};e.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!0,!0,this.propType)};e.prototype.Update=function(e,t){e!==r.JsGridUtil.EmptyValue&&(this.dataValue=e!==r.JsGridUtil.InvalidValue?r.JsGridUtil.Internal.CloneObj(e,null):e);t!==r.JsGridUtil.EmptyValue&&(this.localizedValue=t)};e.prototype.GetLocalized=function(){return this.localizedValue};e.prototype.GetData=function(){return this.dataValue};e.prototype.MakeProperty=function(t,n,r,i,s){return r&&i?new e(t,n,s):r?new T(t,null,s):new N(null,n,s)};e.prototype.MakePropertyFromGridField=function(e,t,n,r){var i=null,s=null!=r?r:e.GetPropType();null!=s&&(i=this.MakeProperty(t,n,e.hasDataValue,e.hasLocalizedValue,s));return i};return e})();e.Property=x;var T=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.HasLocalizedValue=function(){return null!=this.propType.DataToLocalized};t.prototype.HasDataValue=function(){return!0};t.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!0,!1,this.propType)};t.prototype.Update=function(e,t){e!==r.JsGridUtil.EmptyValue&&(this.dataValue=e!==r.JsGridUtil.InvalidValue?r.JsGridUtil.Internal.CloneObj(e,null):e)};t.prototype.GetLocalized=function(){r.JsGridUtil.DebugAssert(this.HasLocalizedValue());return this.dataValue!==r.JsGridUtil.InvalidValue?this.propType.DataToLocalized(this.dataValue):""};t.prototype.GetData=function(){return this.dataValue};return t})(x);e.DataProperty=T;var N=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.HasLocalizedValue=function(){return!0};t.prototype.HasDataValue=function(){return null!=this.propType.LocalizedToData};t.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!1,!0,this.propType)};t.prototype.Update=function(e,t){t!==r.JsGridUtil.EmptyValue&&(this.localizedValue=t)};t.prototype.GetLocalized=function(){return this.localizedValue};t.prototype.GetData=function(){r.JsGridUtil.DebugAssert(this.HasDataValue());return this.localizedValue!==r.JsGridUtil.InvalidValue?this.propType.LocalizedToData(this.localizedValue):null};return t})(x);e.LocalizedProperty=N})(t.PropertyType||(t.PropertyType={}))});
define("pze",["require","exports","o","r","eGe","cGe","oGe","me","Kze","zze","Vze","Pze","Lze","Eze","Cze","xze","NPe","HN","iGe","ce","Dze","v9","_ne","vze","Zze","Xze","Oe","l9","d9","Hs","dUe","Ee","E","Ms","SPListItemsScopeDeferred_IS_mini_css","oc","mze"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,j,F){"use strict";var H=P.tablemgr_9,B=P.control_2,I=P.control_2;P=P.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var q=b.Killswitch.isActivated("46DFBEC2-2AE8-4FB3-A262-8250A3A2B12A","9/20/2019","Properly render thumbnails when we encounter them.  Fixes VSO 770299"),R=b.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),U=b.Killswitch.isActivated("E9D6989B-CA84-4451-BE8E-EB906AA2699E","12/13/2019","Use the same image rendering for all of the various types of possible image types."),z=b.Killswitch.isActivated("EA014738-A23C-45F3-B132-ED5DE252CBB3","12/30/2019","Dont let hyperlink widgets expand out past the left edge of the grid."),W=b.Killswitch.isActivated("E018B29A-CDB6-4371-ADC3-D48973674A2F","12/31/2019",'Update the return type for empty single choice from {} to "" so that it doesnt break .'),X=b.Killswitch.isActivated("4A9E7B15-9A73-4C10-9DED-B95112FFAE9E","2/25/2020","Fix a data format issue with custom formatters."),V=b.Killswitch.isActivated("59BAC612-E381-438A-893A-E1EC5719BB4C","1/30/2020",'Fix the positioning of the datepicker after the iframe loads to override the classic date picker"s incorrect positioning in some scenarios.'),$=b.Killswitch.isActivated("56576B97-4ED4-42AC-B0EA-FE5940B1F66B","1/31/2020","Fix an issue where some pickers do not cleanup container divs after dispose."),J=b.Killswitch.isActivated("F02E7AFA-FCD5-4ECF-A4C1-677F72C39097","4/1/2020","Fix an issue where single choice with fill-in columns with a custom formatter don't render fill-in values."),K=b.Killswitch.isActivated("6E0F9B18-4BCC-4034-980F-F477BA89DFB5","04/24/2020","Attempt to rationalize the way we determine the value for custom formatters."),Q=b.Killswitch.isActivated("D0B8E914-C520-4ED9-A468-2CB2127A68F9","04/23/2020","Render title or name field as text instead of link"),G=b.Killswitch.isActivated("0345ADFA-E6FE-43BA-8465-DB405A2881E2","04/27/2020","Set the resolve principal source for quick edit people pickers."),Y=b.Killswitch.isActivated("7623FA44-67E4-46EC-B3AC-8FD3648BC4B5","05/29/2020","Remove inline style to scss for editBox"),Z=b.Killswitch.isActivated("44C0BFD4-D9A5-4591-AFD2-CC6381FDB46C","06/03/2020","Use photos for the people pills"),ee=b.Killswitch.isActivated("a1cf5d24-0923-4100-9a30-e6e82f0b4deb","6/03/2020","Provide bounds to Callout so as to not render under sticky header"),te=b.Killswitch.isActivated("94BC9995-D876-4540-AB3C-DF0CCE333DEE","06/05/2020","Do some post-processing on the IssueID field"),ne=b.Killswitch.isActivated("1DBB5F75-EA94-443B-8126-2EBC868FB96A","06/29/2020","Handle custom formatters for lookup fields"),re=b.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN"),ie=b.Killswitch.isActivated("B4412CBF-54F1-484D-A505-5C5C983C0FE6","8/05/2020","Add aria attributes to the error message so screen readers can announce it."),se=b.Killswitch.isActivated("4C2B1882-9E1C-44E5-BBC9-324E837A3019","8/05/2020","Swap error widget inline styles with css classname."),oe=b.Killswitch.isActivated("026D94A4-9F7C-458F-A079-A0016F93398A","8/05/2020","Fix horizontal position of the error message widget."),ue=b.Killswitch.isActivated("57190993-8AB2-4641-86C8-2C131A4B0D5A","08/21/2020","Handle custom formatters for boolean field in quick edit mode"),ae=j.getIcon("CheckMark"),fe=j.getIcon("Cancel"),le={ODB:1746},ce={ODB:1725},he={ODB:1206},pe={ODB:1740};function de(e){return"Title"===e.key||"FileLeafRef"===e.key}(function(e){function t(e,t){return"function"!=typeof e.LocalizedValueToCSRValue||null==t||null==t.localized}e.PropTypeNeedsCSRItemToRender=t;function u(e,t,n,r,i,u,a,f,l){var c=r.GetSpCsrRenderCtx(),h=c.ListSchema,p=s.JsGridUtil.Internal.IsFeatureEnabled(ce);s.JsGridUtil.DebugAssert(!s.JsGridUtil.Internal.IsNullOrUndefined(n));null==i&&(i={});if(t.hasLocalizedValue&&"function"==typeof f.LocalizedValueToCSRValue){var d=t._propType.LocalizedValueToCSRValue(a.localized);i[n.RealFieldName]=i[n.Name]=d}c.CurrentItem=i;c.CurrentFieldSchema=n;var v=u.parentNode;s.JsGridUtil.DebugAssert("tr"==v.tagName.toLowerCase());null==v.getAttribute("iid")&&v.setAttribute("iid",s.JsGridUtil.Internal.GenerateIID(c));if("TRUE"==n.listItemMenu){var m=u;s.JsGridUtil.DebugAssert("td"==m.tagName.toLowerCase());m.setAttribute("IsECB","TRUE")}var g,y=document.createElement("span"),b={DocIcon:"File_x0020_Type",ThumbnailOnForm:"FileRef",PreviewOnForm:"FileRef"},w=n.RealFieldName in b?b[n.RealFieldName]:n.RealFieldName;te||"IssueID"!==w||w in i||"ID"in i&&(w="ID");if(U){if(!q&&"Thumbnail"===w){(E=document.createElement("img")).src=i.FileRef;l.width&&(p&&c.fixedHeightRowEnabled?E.style.maxHeight="36px":E.style.maxWidth=l.width-23+"px");return E}}else if("Thumbnail"===w||"Image"===n.Format||"Thumbnail"===n.FieldType){var E=document.createElement("img"),S="";if("Thumbnail"===w)S=i.FileRef;else if("Image"===n.Format)a&&a.data&&(S=a.data.address);else if("Thumbnail"===n.FieldType&&a&&a.localized)try{S=JSON.parse(a.localized).serverRelativeUrl}catch(e){console.log("Error parsing JSON for image: "+e.toString())}p&&c.fixedHeightRowEnabled&&u.classList.add(H.imageTypeCell);E.src=S;l.width&&(p&&c.fixedHeightRowEnabled?E.style.maxHeight="36px":E.style.maxWidth=l.width-23+"px");return E}if(!(w in i))return y;g=n.FieldType&&-1!==n.FieldType.indexOf("Taxonomy")?T.Taxonomy.TaxonomyFieldTemplate.renderViewControl(c,n,i,h):s.JsGridUtil.Internal.IsFeatureEnabled(le)?N.spMgr.RenderField(c,n,i,h):window.spMgr.RenderField(c,n,i,h);if(!s.JsGridUtil.Internal.IsNullOrUndefined(g)){s.JsGridUtil.DebugAssert(g.constructor==String);y.innerHTML=g}for(var x=y.getElementsByTagName("a"),C=0;C<x.length;C++){var k=x[C];if(!s.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(k,"ms-jsgrid-click-passthrough","true")){k.onclick=null;k.addEventListener("click",L)}}s.JsGridUtil.Internal.IsNullOrUndefined(l.fnGetDisplayControlName)||o.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(f,l.fnGetDisplayControlName(e,t.key));p&&n.FieldType&&(c.fixedHeightRowEnabled?y.classList.add(P.cellHiddenOverflow):y.classList.add(P.cellBreakWordOverflow));return y;function L(e){e.preventDefault();if(!s.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")){e.stopPropagation();s.JsGridUtil.Internal.IsNullOrUndefined(e.ctrlKey&&e.target.href)||window.open(e.target.href,"JsGridAnchorWindow")}}}e.RenderWithCSR=u;function a(e,t,n,r,i){if(null==e)return null;var o=new s.JsGridUtil.ImageWithFabricIcons({imgSrc:e,bIsClustered:!1}).Render(t,n,null);r&&(o.className=r);o.style.border="0px";return i?o:{elem:o,fnDispose:function(){if(!s.JsGridUtil.Internal.IsNullOrUndefined(o)&&!s.JsGridUtil.Internal.IsNullOrUndefined(o.Dispose)){o.Dispose();o=null}}}}e.RenderImage=a;function l(e,t,n,r,o){if(""==e||null==e||e==s.JsGridUtil.EmptyValue||e==s.JsGridUtil.InvalidValue)return null;var u,a=document.createElement("span");if(s.JsGridUtil.Internal.IsNullOrUndefined(t.fnClick))u=a;else{(u=document.createElement("a")).style.cssText=o;a.appendChild(u);u.href="javascript:";u.addEventListener("click",function(e){t.fnClick(e)});u.addEventListener("keydown",function(e){if(e.keyCode==i.JsGridConstants.Key.enter){t.fnClick(e);s.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)}});u.tabIndex=-1}s.JsGridUtil.Internal.DomElement.GetInstance().SetTextNoBR(u,e);s.JsGridUtil.Internal.IsNullOrUndefined(t.toolTip)||(u.title=t.toolTip);r&&(a.className=r);n.textDirection!==i.JsGridConstants.TextDirection.Default&&(a.dir=n.textDirection==i.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var f=a;s.JsGridUtil.Internal.IsNullOrUndefined(t.fnClick)||(f={elem:a,fnDispose:function(){s.JsGridUtil.ClearEventListeners(u);u=a=f=null}});return f}e.RenderText=l;function c(e,t,n){var r=document.createElement("div");r.style.cssText="text-align:center";var i=document.createElement("input");i.type="checkbox";i.tabIndex=-1;r.appendChild(i);i.disabled=e;i.checked=t;if(!s.JsGridUtil.Internal.IsNullOrUndefined(n)){i.addEventListener("mousedown",function(e){s.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)});i.addEventListener("click",n)}(r={elem:r}).fnDispose=function(){r=null;s.JsGridUtil.ClearEventListeners(i);i=null};return r}e.RenderCheckbox=c;function h(e,t,n,r,i,o){if(!s.JsGridUtil.Internal.IsNullOrUndefined(r)&&r.bHyperlink)return function(){window.open(r.GetAddress(o))};var u=!s.JsGridUtil.Internal.IsNullOrUndefined(t.fnShouldLinkSingleValue)&&t.fnShouldLinkSingleValue(e,n.key,o,i)&&t.fnSingleValueClicked;return u?function(){u(e,n.key,o)}:null}e.GetSingleValueClick=h;function p(e,t,n,r,i){var s=null==t.fnGetSingleValueTooltip?null:t.fnGetSingleValueTooltip(e,n.key,i,r);return null==s?r:s}e.GetSingleValueToolTip=p;function d(e,t,n,r,i,s){return{toolTip:p(e,t,n,i,s),fnClick:h(e,t,n,r,i,s)}}e.GetSingleValueRenderInfo=d;function v(e,t,n,r,i,s,o,u,f){var l=d(e,t,n,r,i,s),c=a(o,l.toolTip,l.fnClick,u,null);return null==c?[]:[c]}e.RenderImageForSingleValue=v;function y(e,t,n,r,i,s,o,u,a){var f=l(i,d(e,t,n,r,i,s),n,u,a);return null==f?[]:[f]}e.RenderTextForSingleValue=y;function w(e,t,n,r,i,o,u,f,c){var h=d(e,t,n,r,i,o),p=a(u,h.toolTip,h.fnClick,f,null),v=l(i,h,n,f,c),m=[];s.JsGridUtil.Internal.IsNullOrUndefined(p)||m.push(p);s.JsGridUtil.Internal.IsNullOrUndefined(v)||m.push(v);return m}e.RenderImageAndTextForSingleValue=w;function S(e,t,n,r,i,o,u,a,f,l,c){var h,p=[],d=!s.JsGridUtil.Internal.IsNullOrUndefined(i)&&i.GetImageSource?i.GetImageSource(t,e.data):null,v=c.GetSpCsrRenderCtx();h=s.JsGridUtil.Internal.IsFeatureEnabled(ce)?v.fixedHeightRowEnabled?P.cellHiddenOverflow:P.cellBreakWordOverflow:f.bEnabled?"jsgrid-control-text-rtl":"jsgrid-control-text";!Q&&de(r)&&(h=h+" "+(s.JsGridUtil.Internal.IsFeatureEnabled(ce)?P.isTitleOrNameFieldVisualRefresh:P.isTitleOrNameField));if(s.JsGridUtil.Internal.IsNullOrUndefined(i)||!i.bMultiValue||s.JsGridUtil.Internal.IsFeatureEnabled(ce)){var m=!s.JsGridUtil.SpRegionalSettings.calendarType||1===s.JsGridUtil.SpRegionalSettings.calendarType;if("SPDateTime"===i.ID&&e.localized&&c.paneMgr.editMgr._updatedValue.data&&r.csrInfo&&m&&s.JsGridUtil.Internal.IsFeatureEnabled(he)){var g=L.DateFormat[r.csrInfo.DateFormat],y=L.TimeFormat[r.csrInfo.TimeFormat],b={includeDate:!0,includeTime:!r.dateOnly,dateFormat:g,timeFormat:y,locale:v.ListSchema.Locale},w=c.paneMgr.editMgr._updatedValue.data,E=e.localized;"Invalid Date"!==w.toString()&&(E=L.formatDateTime(w,e.localized,"",b));p=u(t,n,r,i,E,e.data,d,h,l)}else p=u(t,n,r,i,e.localized,e.data,d,h,l)}else for(var S=i.LocStrToLocStrArray(e.localized),x=0;x<S.length;x++){var T=x<S.length-1&&a?S[x]+i.separator:S[x];p=p.concat(u(t,n,r,i.singleValuePropType,T,e.data?e.data[x]:null,d?d[x]:null,h,l))}return 1==p.length?p[0]:0==p.length?null:{multipleChildren:p}}e.RenderImageAndOrText=S;var x=(function(){function e(){this.Id="DISP_IMAGE"}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return S(e,t,n,r,i,0,v,!1,u,null,o)};e.prototype.FocusNext=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,o,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==i.JsGridConstants.Key.enter){var f=h(n,r,o,u,t.localized,t.data);if(null!=f){f(e);s.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.ImageDisplayControl=x;var A=(function(){function e(){this.Id="DISP_IMAGETEXT";this._styleForLinks=null}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return S(e,t,n,r,i,0,w,!0,u,this._styleForLinks,o)};e.prototype.FocusNext=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,o,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==i.JsGridConstants.Key.enter){var f=h(n,r,o,u,t.localized,t.data);if(null!=f){f(e);s.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.ImageTextDisplayControl=A;var O=(function(){function e(){this.Id="DISP_TEXT";this._styleForLinks=null}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return S(e,t,n,r,i,0,y,!0,u,this._styleForLinks,o)};e.prototype.FocusNext=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,o,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==i.JsGridConstants.Key.enter){var f=h(n,r,o,u,t.localized,t.data);if(null!=f){f(e);s.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.TextDisplayControl=O;var B=(function(){function e(){this.Id="DISP_CHECKBOX"}e.prototype.Render=function(e,t,n,r,i,o,u,a,f){s.JsGridUtil.DebugAssert(!i.bMultiValue);return u.IsGroupingRecordKey(t.key())?null:c(!1,i.GetBool(e.data),null)};e.prototype.FocusNext=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};return e})();e.CheckboxDisplayControl=B;var j=(function(){function e(e,t,n,r,s){this.Id=e+i.JsGridConstants.RecordIndicatorControlId;this._fnUpdateCheckStatus=t;this._fnIsHidden=n;this._fnIsDisabled=r;this._fnIsChecked=s}e.prototype.Render=function(e,t,n,r,i,s,o,u){var a=this,f=t.key();return this._fnIsHidden(f)?null:c(this._fnIsDisabled(f),this._fnIsChecked(f),function(){a._fnUpdateCheckStatus(f)})};e.prototype.OnKeyDown=function(e,t,n,r,o,u){if(e.keyCode==i.JsGridConstants.Key.space||e.charCode==i.JsGridConstants.Key.space){this._fnUpdateCheckStatus(n.key());s.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}return!1};e.prototype.FocusNext=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};return e})();e.RecordIndicatorCheckboxControl=j;var F=(function(){function e(){}e.prototype.Render=function(e,n,r,i,o,a,f,l,c){var h=n.fieldRawDataMap.csrInfo,p=i.csrInfo,d=null!=h&&null!=h.stale&&h.stale[i.key],v=!0;v=n.HasDataValue(i.key)?n.GetDataValue(i.key)==e.data:null==e.data||e.data==s.JsGridUtil.EmptyValue;v=n.HasLocalizedValue(i.key)?n.GetLocalizedValue(i.key)==e.localized:null==e.localized||e.localized==s.JsGridUtil.EmptyValue;var m=f.IsGroupingRecordKey(n.recordKey),g=f.IsGroupingColumnKey(r.columnKey),b=n.bIsNewRow&&"SPEdit"==i.GetPropType().ID,w="DropdownBoolean"==i.GetPropType().ID&&null==e.data;if(m&&!g||b||w)return null;o=i.GetPropType();var x=null==h&&t(o,e);if(("SPUser"==o.ID||"SPUser_MultiValue"==o.ID)&&(null==e.localized||e.localized==s.JsGridUtil.EmptyValue)&&v){(T=document.createElement("div")).style.width="180px";return T}if("CheckBoxBoolean"!==o.ID||!s.JsGridUtil.Internal.IsFeatureEnabled(pe)){h&&h[i.key]&&p&&"Geolocation"===p.FieldType&&0===h[i.key].indexOf("Point")&&(h[i.key]=E.formatGeolocationString(h[i.key]));if(!v||null==p||d||x||"JSGrid_NewColumn"==i.key||!Q&&de(i)){if(!Boolean(e)&&x&&null!=p&&"Title"==p.RealFieldName&&("TRUE"==p.listItemMenu||"TRUE"==p.CalloutMenu)){var T;return T=document.createElement("div")}return S(e,n,r,i,o,0,y,!1,l,null,f)}s.JsGridUtil.DebugAssert(!t(o,e)||null!=h);return u(n,i,p,f,h,c,e,o,r)}if(void 0!==e.data){var N=document.createElement("div");N.classList.add(P.boolIconDiv);var C=document.createElement("label");C.classList.add(P.srOnly);"0"===e.localized?C.innerText=SP.JsGrid.Res.booleanNo:"1"===e.localized?C.innerText=SP.JsGrid.Res.booleanYes:C.innerText=e.localized;N.appendChild(C);var k=document.createElement("i");k.classList.add("1"===e.data||!0===e.data?ae.subset.className:fe.subset.className);k.classList.add(P.boolIcon);k.setAttribute("aria-hidden","true");k.innerHTML="1"===e.data||!0===e.data?ae.code:fe.code;N.appendChild(k);return N}};return e})();e.CSRDisplayControl=F;var I=(function(){function e(){}e.prototype.Render=function(e,t,n,r,i,o,u,a,f){var l=document.createElement("div"),c=u.GetSpCsrRenderCtx();if(s.JsGridUtil.Internal.IsFeatureEnabled(ce)){l.classList.add(P.customFormatField);c.fixedHeightRowEnabled&&f.classList.add(H.customFormatterCell)}l.classList.add(P.spGridCustomFormatField);var h,p=u&&u.objBag&&u.objBag.jsGridParams&&u.objBag.jsGridParams.customFormatterProps,d=p&&p.customFormatterSchema;if(K)if(X){h=t&&t.fieldRawDataMap&&t.fieldRawDataMap.csrInfo;p&&p.getItemData&&(h=p.getItemData(h,d));if(b.Killswitch.isActivated("EC4AE4F1-A4D6-4A7D-B010-0F14A2EFA541","10/15/2019","Fix several problematic custom formatter bugs.")){if(!b.Killswitch.isActivated("A2742A0E-92AA-4A9A-8692-EF584A6C6B37","8/15/2019","Let custom formatters use the updated, user-entered value rather than the stored (old) value when rendering.")&&h){v=r.hasLocalizedValue?e.localized:e.data;h[r.key]!==v&&(h[r.key]=v)}}else{var v=t.HasDataValue(r.key)?e.data:e.localized;h?h[r.key]=v:(h={})[r.key]=v;W||"Choice"===r.csrInfo.FieldType&&h[r.key]===s.JsGridUtil.EmptyValue&&(h[r.key]="")}}else{h=M.deepCopy(t&&t.fieldRawDataMap&&t.fieldRawDataMap.csrInfo);var v=M.deepCopy(t.HasDataValue(r.key)?e.data:e.localized);J||(r&&r.csrInfo&&"MultiChoice"==r.csrInfo.FieldType?e&&e.localized&&(v=e.localized.split("; ")):!e.data&&e.localized?v=M.deepCopy(e.localized):e.data&&!e.localized&&(v=M.deepCopy(e.data)));h?h[r.key]=v:(h={})[r.key]=v;if(v&&t.fieldRawDataMap.csrInfo&&t.fieldRawDataMap.csrInfo[r.key]&&p.customFormatterSchema&&p.customFormatterSchema[r.key]&&"User"===p.customFormatterSchema[r.key])if((v=v).length&&t.fieldRawDataMap.csrInfo[r.key]&&t.fieldRawDataMap.csrInfo[r.key].length){for(var m=0;m<v.length;m++)for(var y=0;y<t.fieldRawDataMap.csrInfo[r.key].length;y++)if(v[m].display==t.fieldRawDataMap.csrInfo[r.key][y].title){h[r.key][m]=t.fieldRawDataMap.csrInfo[r.key][y];break}}else v&&t.fieldRawDataMap.csrInfo[r.key]&&t.fieldRawDataMap.csrInfo[r.key].length?(v=v).display==t.fieldRawDataMap.csrInfo[r.key][0].title&&(h[r.key]=t.fieldRawDataMap.csrInfo[r.key]):v&&t.fieldRawDataMap.csrInfo[r.key]&&(v=v).display==t.fieldRawDataMap.csrInfo[r.key].title&&(h[r.key]=t.fieldRawDataMap.csrInfo[r.key]);p&&p.getItemData&&(h=p.getItemData(h,d))}else h=this._getValueForCustomFormatter(t,r,e,p,d);var w=new _.default({name:"CFParseColumn"}),E=null;try{E=JSON.parse(n.customFormatter);w.end({resultType:_.ResultTypeEnum.Success})}catch(e){w.end(D.getQosEndSchemaFromError(e))}var S=new g.CustomFormatter({rowIndex:t?t.rowIndex:-1,fieldRendererFormat:E,row:h,currentFieldName:n.columnKey,rowSchema:d,errorStrings:null,pageContextInfo:u.objBag.jsGridParams.pageContext});l.innerHTML=S.evaluate();return l};e.prototype._getValueForCustomFormatter=function(e,t,n,r,i){var s=M.deepCopy(e&&e.fieldRawDataMap&&e.fieldRawDataMap.csrInfo),o=M.deepCopy(e.HasDataValue(t.key)?n.data:n.localized);if(t&&t.csrInfo&&t.csrInfo.FieldType)switch(t.csrInfo.FieldType){case"MultiChoice":n&&n.localized&&(o=n.localized.split("; "));break;case"Choice":n&&n.localized&&(o=n.localized);break;case"Boolean":!ue&&n&&n.localized&&(o=n.localized);break;case"User":case"UserMulti":if((o=o)&&o.length&&e.fieldRawDataMap.csrInfo[t.key]&&e.fieldRawDataMap.csrInfo[t.key].length){for(var u=0;u<o.length;u++)for(var a=0;a<e.fieldRawDataMap.csrInfo[t.key].length;a++)if(o[u].display==e.fieldRawDataMap.csrInfo[t.key][a].title){o[u]=e.fieldRawDataMap.csrInfo[t.key][a];break}}else o&&e.fieldRawDataMap.csrInfo[t.key]&&e.fieldRawDataMap.csrInfo[t.key].length?(o=o).display==e.fieldRawDataMap.csrInfo[t.key][0].title&&(o=e.fieldRawDataMap.csrInfo[t.key]):o&&e.fieldRawDataMap.csrInfo[t.key]&&(o=o).display==e.fieldRawDataMap.csrInfo[t.key].title&&(o=e.fieldRawDataMap.csrInfo[t.key]);break;case"Lookup":ne||n.data&&n.data&&n.localized&&(o=[{lookupId:n.data,lookupValue:n.localized}]);break;case"LookupMulti":if(!ne&&n.data&&n.data.length&&n.localized){o=[];var f=n.localized.split(";");for(u=0;u<n.data.length;u++)o[u]={lookupId:n.data[u],lookupValue:f[u]}}}s?s[t.key]=o:(s={})[t.key]=o;r&&r.getItemData&&(s=r.getItemData(s,i));return s};return e})();e.CustomFormatterDisplayControl=I;var R=(function(){function e(){}e.prototype.Render=function(e,t,o,u,a,l,c,h){var p=e&&e.localized;if(!p||p==s.JsGridUtil.EmptyValue||p==s.JsGridUtil.InvalidValue)return null;var d=a.bMultiValue?a.LocStrToLocStrArray(e.localized):[e.localized];if(s.JsGridUtil.Internal.IsFeatureEnabled({ODB:1947})){for(var v=document.createElement("div"),g=[],y=re?s.JsGridUtil.Internal.SiteUrl+i.JsGridConstants.UserPhotoPath:C.getUserPhotoUrl(),b=0;b<d.length;b++){(E=Array.isArray(e.data)?e.data[b]:e.data)&&(Z?g.push(f.GetPersonDisplay({text:d[b]||E.display})):g.push(f.GetPersonDisplay({text:d[b]||E.display,imageUrl:E.email?y+E.email:""})))}s.JsGridUtil.Internal.IsFeatureEnabled(ce)&&(c.GetSpCsrRenderCtx().fixedHeightRowEnabled?v.classList.add(P.cellHiddenOverflow,P.personaPillOverflowContainer):v.classList.add(P.cellBreakWordOverflow,P.personaPillOverflowContainer));var w=g.join("");v.innerHTML=w;return v}for(w=[],b=0;b<d.length;b++){var E;(E=Array.isArray(e.data)?e.data[b]:e.data)&&w.push({title:d[b]||E.display,email:E.email,picture:"",sip:""})}v=document.createElement("span");if(s.JsGridUtil.Internal.IsFeatureEnabled(ce)&&c.GetSpCsrRenderCtx().fixedHeightRowEnabled){v.classList.add(P.cellHiddenOverflow);var S=w.map(function(e){return e.title}).join(", ");v.textContent=S}else n.render(r.createElement(m.UserField,{users:w}),v);return v};e.prototype.FocusNext=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return s.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,o,u,a){return!u.bMultiValue&&(function(){if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==i.JsGridConstants.Key.enter){if(null!=h(n,r,o,u,t.localized,t.data)){this._fnClick(e);s.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1})()};return e})();e.UserDisplayControl=R;var z=(function(){function e(){}e.prototype.Render=function(e,t,n,r,i,o,u,a,f){var l=e&&e.localized;if(!l||l==s.JsGridUtil.EmptyValue||l==s.JsGridUtil.InvalidValue)return null;var c,h=u.GetSpCsrRenderCtx(),p=s.JsGridUtil.Internal.IsFeatureEnabled(ce);try{c=JSON.parse(e.localized)}catch(e){s.JsGridUtil.DebugAssert(!1,"Error parsing json for image data. "+e.toString())}if(c&&c.serverRelativeUrl){var d=c.serverRelativeUrl,v=d=(c.serverUrl||"")+d;if(c.thumbnailRenderer&&c.thumbnailRenderer.spItemUrl&&c.thumbnailRenderer.sponsorToken){var m=k.parseItemUrl(c.thumbnailRenderer.spItemUrl);d=k.buildThumbnailUrl(m,48,48,c.thumbnailRenderer.fileVersion,c.thumbnailRenderer.sponsorToken);v=k.buildThumbnailUrl(m,3e3,2e3,c.thumbnailRenderer.fileVersion,c.thumbnailRenderer.sponsorToken)}var g=document.createElement("img");g.src=d;g.title=c.fileName||"";g.onclick=function(e){Boolean(e)&&Boolean(e.target)&&window.open(v,"_blank")};p&&h.fixedHeightRowEnabled&&f.classList.add(H.imageTypeCell);n.width&&(p&&h.fixedHeightRowEnabled?g.style.maxHeight="36px":g.style.maxWidth=n.width-23+"px");return g}return null};return e})();e.ImageThumbnailDisplayControl=z})(t.DisplayControl||(t.DisplayControl={}));t.DisplayControlType={Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX",CSR:"DISP_CSR",User:"DISP_USER",CustomFormatter:"DISP_CUSTOMFORMATTER",ImageThumbnail:"DISP_IMAGE_THUMBNAIL"};(function(e){var t=(function(){function e(t,n){this.id="jsgrid_editbox";this._bInEdit=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;null!=t.parentNode&&(this.id+=t.parentNode.id);this._parentNode=t.parentNode;this._bUsingGridTextInputElement=null!=n;this._tbGrid=n;this._gridContext=t;this.iid="EditBoxEditControl_"+e._controlNum;console.log("IID: "+this.iid);e._controlNum++;this.Init()}e.prototype.Init=function(){s.JsGridUtil.DebugAssert(null==this._tbGrid||s.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(this._tbGrid));this._tbOwn=document.createElement("input");this._tbOwn.id=this.id;Y&&(this._tbOwn.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;");this._parentNode.appendChild(this._tbOwn);this.UpdateTextBoxProperty(["type"],"text");if(Y){var e=s.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(this._tbGrid||this._tbOwn,"backgroundColor","background-color"),t="#fff";if(null!=e&&e.length>0){var n=s.JsGridUtil.Internal.Color.HexStringToColor(e);n=s.JsGridUtil.Internal.Color.RemoveAlphaChannel(n);t=s.JsGridUtil.Internal.Color.ColorToHexString(n)}null!=t&&t.length>0&&this.UpdateTextBoxProperty(["style","backgroundColor"],t)}var r=this._gridContext.jsGridObj.GetSpCsrRenderCtx(),i=s.JsGridUtil.Internal.IsFeatureEnabled(ce)?P.spGridControlEditbox+" "+(r.fixedHeightRowEnabled?"":P.spGridControlEditboxDynamicHeight):"jsgrid-control-editbox";Y||(i+=" ms-grid-editbox "+I.msGridEditControlEditBox);this.UpdateTextBoxProperty(["className"],i);this.UpdateTextBoxProperty(["tabIndex"],-1);this.UpdateTextBoxProperty(["style","direction"],this._gridContext.RTL.ltr)};e.prototype.GetCellContext=function(){return this._cellContext};e.prototype.GetOriginalValue=function(){return this._cellContext.originalValue.localized};e.prototype.SetValue=function(e){this._cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){s.JsGridUtil.ClearEventListeners(this._tbOwn)};e.prototype.GetInputElement=function(){return this._tbGrid||this._tbOwn};e.prototype.Focus=function(e){var t=this,n=function(){var e=t.GetOriginalValue();r.value=null==e||e==s.JsGridUtil.EmptyValue?"":e;s.JsGridUtil.Internal.IsFeatureEnabled(ce)&&(r.scrollLeft=t._gridContext.RTL.bEnabled?-9999:9999)};try{var r=this.GetCurrentTextBoxInputControl();if(null==e){r.focus();r.value=r.value}else if(this._bUsingGridTextInputElement){this._gridContext.OnActivateActor();("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==i.JsGridConstants.Key.F2)&&n()}else{r.focus();if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==i.JsGridConstants.Key.F2)n();else if(s.JsGridUtil.Utility.IsChar(e)){var o=String.fromCharCode(e.charCode);r.value=o;this.SetValue(o)}}}catch(e){s.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the EditBoxEditControl while hidden?")}};e.prototype.BindToCell=function(e){this._cellContext=e;this.SizeToCell();this._cellContext.field.textDirection!==i.JsGridConstants.TextDirection.Default&&this.UpdateTextBoxProperty(["style","direction"],this._cellContext.field.textDirection==i.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");if(s.JsGridUtil.Internal.IsFeatureEnabled(ce)){var t=this.GetCurrentTextBoxInputControl();t.classList.remove(P.inputIsNumber);t.classList.remove(P.inputIsTitle);"Number"!==this._cellContext.field.csrInfo.FieldType||this._cellContext.field.csrInfo.CustomFormatter||t.classList.add(P.inputIsNumber);"Title"!==this._cellContext.fieldKey&&"FileLeafRef"!==this._cellContext.fieldKey||t.classList.add(P.inputIsTitle);s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?t.classList.add(P.stickyEditor):t.classList.remove(P.stickyEditor))}this.UpdateTextBoxValue(this._cellContext.originalValue.data)};e.prototype.OnBeginEdit=function(e){var t=this;this._bUsingGridTextInputElement=null!=this._tbGrid&&"keypress"==e.type;var n=this.GetCurrentTextBoxInputControl();this._cellContext.Show(n);this._bInEdit=!0;this.SetupHandlers(!0);"mousedown"!=e.type||this._bUsingGridTextInputElement?this.Focus(e):setTimeout(function(){t.Focus(e)},0)};e.prototype.Unbind=function(){this.UpdateTextBoxValue("")};e.prototype.OnEndEdit=function(){var e=this.GetOriginalValue(),t=this.GetCurrentTextBoxInputControl();e=null==e||e==s.JsGridUtil.EmptyValue?"":e;t.value!==e&&this.SetValue(t.value);this.SetupHandlers(!1);this._cellContext.Hide(t);this._bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCell();this._bInEdit&&this._cellContext.Show(this.GetCurrentTextBoxInputControl())};e.prototype.OnValueChanged=function(e){this.UpdateTextBoxValue(null==e.localized||e.localized==s.JsGridUtil.EmptyValue?"":e.localized)};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return this._bUsingGridTextInputElement};e.prototype.SetupHandlers=function(e){var t=this.GetCurrentTextBoxInputControl();if(e){t.addEventListener("focus",this._gridContext.OnActivateActor);t.addEventListener("blur",this._gridContext.OnDeactivateActor);this._bUsingGridTextInputElement||t.addEventListener("keydown",this._gridContext.OnKeyDown);t.addEventListener("keyup",this.OnKeyUp.bind(this));t.addEventListener("mousedown",this.OnMouseDown.bind(this))}else{t.addEventListener("focus",this._gridContext.OnActivateActor);t.addEventListener("blur",this._gridContext.OnDeactivateActor);this._bUsingGridTextInputElement||t.removeEventListener("keydown",this._gridContext.OnKeyDown);t.removeEventListener("keyup",this.OnKeyUp.bind(this));t.removeEventListener("mousedown",this.OnMouseDown.bind(this))}};e.prototype.OnKeyUp=function(){this.SetValue(this.GetCurrentTextBoxInputControl().value)};e.prototype.SizeToCell=function(){s.JsGridUtil.Internal.IsFeatureEnabled(ce)?this.SetSize(this._cellContext.cellWidth-3,this._cellContext.cellHeight-5):this.SetSize(this._cellContext.cellWidth-10,this._cellContext.cellHeight-6)};e.prototype.SetSize=function(e,t){this.UpdateTextBoxProperty(["style","width"],e+"px");this.UpdateTextBoxProperty(["style","height"],t+"px")};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.GetCurrentTextBoxInputControl=function(){return this._bUsingGridTextInputElement?this._tbGrid:this._tbOwn};e.prototype.UpdateTextBoxValue=function(e){var t="";null!=e&&void 0!==e&&"string"==typeof e&&(t=e);this._tbOwn.value=t;this._bUsingGridTextInputElement&&(this._tbGrid.value=t)};e.prototype.SetProp=function(e,t,n){for(var r=0;r<t.length-1;r++)e=e[t[r]];e[t[t.length-1]]=n};e.prototype.UpdateTextBoxProperty=function(e,t){this.SetProp(this._tbOwn,e,t);this._bUsingGridTextInputElement&&this.SetProp(this._tbGrid,e,t)};e._controlNum=0;return e})();e.EditBoxEditControl=t;var o=(function(){function e(e){var t=this;this.id="jsgrid_combobox";this._isDirty=!1;this._disposeFns=[];this._isBound=!1;this._shouldBind=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this.RegisterForKeyEvents=function(e){t._activeChoiceEditor=e};this.Expand=function(){t._activeChoiceEditor.Expand()};this.OnKeyDown=function(e){if(e.keyCode==i.JsGridConstants.Key.esc){t._processingEsc=!0;setTimeout(function(){t._gridContext.OnKeyDown(e);t._processingEsc=!1},0)}else e.keyCode==i.JsGridConstants.Key.tab?t._gridContext.OnKeyDown(e):e.keyCode==i.JsGridConstants.Key.space&&t._activeChoiceEditor.OnRegisteredKeyEvent(e)};this.OnValueChangedInternal=function(e){if(t._isBound){if(t._processingEsc)return;if(e){null==e.data&&e.localized===y.default.emptyChoice&&(e.localized=null);t._cellContext.SetCurrentValue(e);t._isDirty=!0}}};this.GetListData=function(e){t._cellContext.propType.GetItems(function(n){if(null==n)e(null,null,!1,!0);else{for(var r=[],i=0;i<n.length;i++){var s=t.GetCellValue(n[i],t._cellContext.fieldKey);(s.data||s.localized)&&r.push({key:s.data,text:s.localized})}n.length>0&&"DropdownBoolean"!==n[0].propType.ID&&r.push({key:null,text:y.default.emptyChoice});e(r)}})};this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;background-color:"+this._gridContext.styleManager.gridPaneStyle.verticalBorderColor+";overflow-x:visible;";this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){var t=this;this._shouldBind=!0;this._isBound=!1;this._isMultiSelect=e.propType.bMultiValue;this._gridPane.useCustomSelFrames=!0;if(this._shouldBind){this._isBound=!0;this._cellContext=e;this.GetListData(function(e){t.RenderData(e,t._cellContext.originalValue)})}};e.prototype.RenderData=function(e,t){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);var i={options:[],gridOptions:e,multiSelect:this._isMultiSelect,gridValue:t,gridOnChange:this.OnValueChangedInternal.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,registerForKeyEvents:this.RegisterForKeyEvents,shouldRestoreFocus:!1,onMenuDismissed:this.OnMenuDismissed,setSelectionFrame:this.SetSelectionFrame};if(this._cellContext.propType.GetIsLimitedToList)i.allowFreeform=!this._cellContext.propType.GetIsLimitedToList();else if(this._cellContext.propType.singleValuePropType&&this._cellContext.propType.singleValuePropType.GetIsLimitedToList){i.allowFreeform=!this._cellContext.propType.singleValuePropType.GetIsLimitedToList();if(i.allowFreeform&&t.localized&&t.data)for(var o=t.localized.split(";"),u=0;u<t.data.length;u++)if("object"==typeof t.data[u]){t.data[u]=o[u];e.push({key:o[u],text:o[u]})}}s.JsGridUtil.Internal.IsFeatureEnabled(ce)&&this._gridPane.tableDiv.classList.remove(H.tableHasMouseDown);this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(l.ChoiceEditor,i),this._container):n.render(r.createElement(l.ChoiceEditor,i),this._container);this.LayoutPickerControl();s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(P.stickyEditor):this._container.classList.remove(P.stickyEditor));this._container.addEventListener("keydown",this.OnKeyDown);this._container.focus()};e.prototype.Unbind=function(){this._shouldBind=!1;if(this._isBound){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):n.unmountComponentAtNode(this._container);this.OnEndEdit();this._container.removeEventListener("keydown",this.OnKeyDown.bind(this));this._cellContext.Hide(this._container);this._isDirty=!1;for(;this._disposeFns.length>0;)this._disposeFns.shift()()}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){};e.prototype.OnCellMove=function(e){};e.prototype.OnEndEdit=function(){this._isBound&&this._isDirty&&this._cellContext.NotifyEditComplete()};e.prototype.SetSize=function(e,t){if(this._isBound){this._container.style.minWidth=e+"px";this._container.style.width=e+"px";this._container.style.height=t-1+"px";this._container.style.top=(parseInt(this._container.style.top)+Math.max(0,t/2-10)).toString()+"px"}};e.prototype.LayoutPickerControl=function(){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);s.JsGridUtil.Internal.IsFeatureEnabled(ce)?this._cellContext.Show(this._container,!0):this._cellContext.Show(this._container)};e.prototype.OnValueChanged=function(e){var t=this;if(null==e)return this.OnValueChangedInternal(e);this._isBound&&this.GetListData(function(n){t.RenderData(n,e)})};e.prototype.GetCellValue=function(e,t){var n={};e.HasDataValue(t)&&(n.data=e.GetData(t));e.HasLocalizedValue(t)&&(n.localized=e.GetLocalized(t));null!=e.propType&&null!=e.propType.GetDisplayValue&&(n.localized=e.propType.GetDisplayValue(this._cellContext.record,n.data,n.localized));return n};return e})();e.ComboBoxEditControl=o;var u=(function(){function e(e){var t=this;this.id="jsgrid_combobox";this._isDirty=!1;this._disposeFns=[];this._isBound=!1;this._shouldBind=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.RegisterForKeyEvents=function(e){t._activeChoiceEditor=e};this.Expand=function(){t._activeChoiceEditor.Expand()};this.OnOK=function(e){t._cellContext.NotifyEditComplete();t._cellContext.NotifyEditComplete()};this.OnCancel=function(){t._cellContext.NotifyEditComplete(!0);t._cellContext.NotifyEditComplete(!0)};this.OnKeyDown=function(e){if(e.keyCode==i.JsGridConstants.Key.esc){t._processingEsc=!0;setTimeout(function(){t._gridContext.OnKeyDown(e);t._processingEsc=!1},0)}else e.keyCode==i.JsGridConstants.Key.tab?t._gridContext.OnKeyDown(e):e.keyCode==i.JsGridConstants.Key.space&&t._activeChoiceEditor.OnRegisteredKeyEvent(e)};this.OnValueChangedInternal=function(e){if(t._isBound){if(t._processingEsc)return;if(e){null==e.data&&e.localized===y.default.emptyChoice&&(e.localized=null);t._cellContext.SetCurrentValue(e);t._isDirty=!0}}};this.GetListData=function(e){t._cellContext.propType.GetItems(function(n){if(null==n)e(null,null,!1,!0);else{for(var r=[],i=0;i<n.length;i++){var s=t.GetCellValue(n[i],t._cellContext.fieldKey);(s.data||s.localized)&&r.push({key:s.data,text:s.localized})}e(r)}})};this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;background-color:"+this._gridContext.styleManager.gridPaneStyle.verticalBorderColor+";overflow-x:visible;"+(s.JsGridUtil.Internal.IsFeatureEnabled(ce)?"z-index:"+i.JsGridConstants.Internal.zIndex.editor:"margin-left:-1px");this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._shouldBind=!0;this._isBound=!1;this._isMultiSelect=e.propType.bMultiValue;this._gridPane.useCustomSelFrames=!0;if(this._shouldBind){this._isBound=!0;this._cellContext=e}};e.prototype.RenderData=function(e,t){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);var i={rowData:this._cellContext.record.fieldRawDataMap.csrInfo,rowSchema:[this._cellContext.column],currentFieldName:this._cellContext.column.columnKey,options:[],gridOptions:e,multiSelect:this._isMultiSelect,gridValue:t,gridOnChange:this.OnValueChangedInternal.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,registerForKeyEvents:this.RegisterForKeyEvents,shouldRestoreFocus:!1,onMenuDismissed:this.OnMenuDismissed,cellHeight:this._cellContext.cellHeight,cellWidth:this._cellContext.cellWidth,fieldType:this._cellContext.column.fieldType,goBackToSelectMode:this.GoBackToSelectMode.bind(this),onSave:this.OnOK,onCancel:this.OnCancel,parentNode:this._parentNode};if(this._cellContext.propType.GetIsLimitedToList)i.allowFreeform=!this._cellContext.propType.GetIsLimitedToList();else if(this._cellContext.propType.singleValuePropType&&this._cellContext.propType.singleValuePropType.GetIsLimitedToList){i.allowFreeform=!this._cellContext.propType.singleValuePropType.GetIsLimitedToList();if(i.allowFreeform&&t.localized&&t.data)for(var o=t.localized.split(";"),u=0;u<t.data.length;u++)if("object"==typeof t.data[u]){t.data[u]=o[u];e.push({key:o[u],text:o[u]})}}s.JsGridUtil.Internal.IsFeatureEnabled(ce)&&this._gridPane.tableDiv.classList.remove(H.tableHasMouseDown);s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(P.stickyEditor):this._container.classList.remove(P.stickyEditor));this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(c.ModernChoiceEditor,i),this._container):n.render(r.createElement(c.ModernChoiceEditor,i),this._container);this.LayoutPickerControl();this._container.addEventListener("keydown",this.OnKeyDown);this._container.focus()};e.prototype.Unbind=function(){this._shouldBind=!1;if(this._isBound){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):n.unmountComponentAtNode(this._container);this.OnEndEdit();this._container.removeEventListener("keydown",this.OnKeyDown);this._cellContext.Hide(this._container);this._isDirty=!1;for(;this._disposeFns.length>0;)this._disposeFns.shift()()}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.GoBackToSelectMode=function(){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):n.unmountComponentAtNode(this._container);this.OnEndEdit();this._cellContext.Hide(this._container);this._isDirty=!1};e.prototype.OnBeginEdit=function(e){var t=this;this.GetListData(function(e){t.RenderData(e,t._cellContext.originalValue)})};e.prototype.OnCellMove=function(e){};e.prototype.OnEndEdit=function(){this._isBound&&this._isDirty&&this._cellContext.NotifyEditComplete()};e.prototype.SetSize=function(e,t){if(this._isBound){this._container.style.minWidth=e+"px";this._container.style.width=e+"px";this._container.style.height=t-1+"px";this._container.style.top=(parseInt(this._container.style.top)+Math.max(0,t/2-10)).toString()+"px"}};e.prototype.LayoutPickerControl=function(){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);s.JsGridUtil.Internal.IsFeatureEnabled(ce)?this._cellContext.Show(this._container,!0):this._cellContext.Show(this._container)};e.prototype.OnValueChanged=function(e){var t=this;if(null==e)return this.OnValueChangedInternal(e);this._isBound&&this.GetListData(function(n){t.RenderData(n,e)})};e.prototype.GetCellValue=function(e,t){var n={};e.HasDataValue(t)&&(n.data=e.GetData(t));e.HasLocalizedValue(t)&&(n.localized=e.GetLocalized(t));null!=e.propType&&null!=e.propType.GetDisplayValue&&(n.localized=e.propType.GetDisplayValue(this._cellContext.record,n.data,n.localized));return n};return e})();e.ModernComboBoxEditControl=u;var f=(function(){function e(e){var t=this;this.id="jsgrid_boolean";this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.DataOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.DataOnly;this._isDirty=!1;this._isBound=!1;this.OnKeyDown=function(e){e.keyCode==i.JsGridConstants.Key.esc&&t.Unbind(!0);if(t.IsSpecialNavKeys(e)){t._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;t._gridContext.OnKeyDown(e)}};this.OnValueChangedInternal=function(e){if(e){t._cellContext.SetCurrentValue({data:e,localized:e});t._isDirty=!0;t._value=e}};this._parentNode=e.parentNode;this._gridContext=e;this.Init()}e.prototype.Init=function(){this.mainDiv=document.createElement("div");this.mainDiv.id=this.id;this.mainDiv.classList.add(B.msGridEditControlContainer);this._gridContext.RTL.bEnabled?this.mainDiv.style.right="0px":this.mainDiv.style.left="0px";this.mainDiv.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this.mainDiv);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this.mainDiv)};e.prototype.BindToCell=function(e){this._isBound=!0;this._cellContext=e;this._value=this.GetOriginalValue();s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this.mainDiv.classList.add(P.stickyEditor):this.mainDiv.classList.remove(P.stickyEditor))};e.prototype.Unbind=function(e){if(this._isBound){this.OnEndEdit(e);this._cellContext.Hide(this.mainDiv);this._isDirty=!1;this._gridContext.portalManager?this._gridContext.portalManager.unmount(this.mainDiv):n.unmountComponentAtNode(this.mainDiv)}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){this._cellContext.Show(this.mainDiv);this.RenderData(this._value)};e.prototype.OnCellMove=function(e){this.RenderData(this._value)};e.prototype.OnEndEdit=function(e){if(this._isBound&&this._isDirty){this._isDirty=!1;this._cellContext.NotifyEditComplete(e)}this._value=""};e.prototype.RenderData=function(e){var t=this._cellContext.cellWidth,i=this._cellContext.cellHeight;i=s.JsGridUtil.Internal.IsFeatureEnabled(ce)?this._cellContext.cellHeight-5:this._cellContext.cellHeight-6;var o={onEditorKeyDown:this.OnKeyDown,onValueChange:this.OnValueChangedInternal,height:i,width:t,value:e};this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(F.CheckboxEditor,o),this.mainDiv):n.render(r.createElement(F.CheckboxEditor,o),this.mainDiv)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==i.JsGridConstants.Key.tab||t==i.JsGridConstants.Key.esc||t==i.JsGridConstants.Key.enter||t==i.JsGridConstants.Key.windows||t>=i.JsGridConstants.Key.left&&t<=i.JsGridConstants.Key.down};e.prototype.GetOriginalValue=function(){if(void 0!==this._cellContext.originalValue.data)return this._cellContext.originalValue.data.toString()};return e})();e.CheckboxEditControl=f;var m=(function(){function e(e){var t=this;this.idPrefix="peoplePickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnUserResolvedCallback=function(e){t._isDirty=!0;var n;if(Boolean(t._cellContext.field._multiValue)&&e.length>0){for(var r=[],i=[],o=0;o<e.length;o++){var u=t.OnSingleUserValue(e[o]);r.push(u.data);i.push(u.localized)}n={data:r,localized:s.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(i,s.JsGridUtil.multiValSeparator,!1)}}else n=e.length>0?t.OnSingleUserValue(e[0]):{data:null,localized:""};void 0!==n&&null!=n&&t._cellContext.SetCurrentValue(n)};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsurePeoplePicker=function(e,t){var i=this._cellContext.propType.bMultiValue?this._cellContext.propType.singleValuePropType:this._cellContext.propType,o=i.GetPeoplePickerSettings.bind(i)(this._cellContext.fieldKey),u=null==o||""==o?[]:o.split(";#");s.JsGridUtil.DebugAssert(3==u.length,"SPUser settings to initialize PeoplePicker has 3 values.");var f={principalType:v.createSPPrincipalType(u[0]),allowMultipleEntities:this._cellContext.field._multiValue,groupID:u[1],maximumEntitySuggestions:3,required:"True"===u[2]};G||(f.principalSource=15);var l={dataSource:this._gridContext.peoplePickerDataSource,context:this._gridContext.pageContext,selectedItems:e,peoplePickerQueryParams:f,onSelectedPersonasChange:this.OnUserResolvedCallback,inputProps:{onBlur:this.OnPickerInputBlur.bind(this),onFocus:this._gridContext.OnActivateActor},onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:this.OnKeyDown.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,setSelectionFrame:this.SetSelectionFrame,cellHeight:this._cellContext.cellHeight,cellWidth:this._cellContext.cellWidth,parentNode:this._parentNode,goBackToSelectMode:this.GoBackToSelectMode.bind(this)};this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(a.PeopleEditor,l),this._pickercontainer):n.render(r.createElement(a.PeopleEditor,l),this._pickercontainer);var c=this._pickercontainer.getElementsByTagName("input");c&&c.length&&(this._editorelm=c[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._editorelm&&("keydown"==t.type||"keypress"==t.type)&&s.JsGridUtil.Utility.IsChar(t)){var h=String.fromCharCode(t.charCode);this._editorelm.value=h}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.CreatePickerDiv=function(e){this._pickercontainer=document.createElement("div");this._pickercontainer.id=e;this._pickercontainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickercontainer.style.right="-1px":this._pickercontainer.style.left="-1px";this._pickercontainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickercontainer.className=s.JsGridUtil.Internal.IsFeatureEnabled(ce)?P.msGrid:"ms-grid";s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickercontainer.classList.add(P.stickyEditor):this._pickercontainer.classList.remove(P.stickyEditor));this._parentNode.appendChild(this._pickercontainer);this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;this.CreatePickerDiv(this.idPrefix)};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;this._cellContext.Hide(this._pickercontainer);this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickercontainer):n.unmountComponentAtNode(this._pickercontainer);$||this._parentNode.removeChild(this._pickercontainer)};e.prototype.GoBackToSelectMode=function(){this._cellContext.NotifyEditComplete();this._cellContext.NotifyEditComplete()};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickercontainer,!0);this.EnsurePeoplePicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1};e.prototype.SetupHandlers=function(e){null!=this._pickercontainer&&(e?this._pickercontainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickercontainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==i.JsGridConstants.Key.tab||t==i.JsGridConstants.Key.esc||t==i.JsGridConstants.Key.enter||t==i.JsGridConstants.Key.windows||t>=i.JsGridConstants.Key.left&&t<=i.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){if(!this._inEdit||this.IsSpecialNavKeys(e)){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._editorelm,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickercontainer.style.minWidth=String(e-2)+"px";s.JsGridUtil.Internal.IsFeatureEnabled(ce)||(this._pickercontainer.style.minHeight=String(t-2)+"px");s.JsGridUtil.Internal.IsFeatureEnabled({ODB:1948})&&(this._pickercontainer.style.height=t-1+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){for(var e=[],t=this._cellContext.originalValue.data,n=0;n<t.length;n++)"email"in t[n]?e.push(this.BuildUnresolvedEntity(t[n].email,t[n].display)):e.push(this.BuildUnresolvedEntity(t[n].get_email(),t[n].get_lookupValue()));return e};e.prototype.GetOriginalLocValue=function(){var e=[],t=this._cellContext.originalValue.localized;if(null!=t&&""!==t)for(var n=t.split(s.JsGridUtil.multiValSeparator),r=0;r<n.length;r++)""!==n[r]&&e.push(this.BuildUnresolvedEntity(s.JsGridUtil.Internal.Encoding_STSHtmlEncode(n[r]),n[r]));return e};e.prototype.BuildUnresolvedEntity=function(e,t){return{userId:e,name:t,email:e}};e.prototype.OnSingleUserValue=function(e){var t={data:null,localized:""};e&&(t={data:{email:e.email,display:e.name},localized:e.name});return t};e.prototype.UpdateElementValue=function(e,t){s.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();e.PeoplePickerEditControl=m;var g=(function(){function e(e){var t=this;this.idPrefix="locationPickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnLocationResolvedCallback=function(e){t._isDirty=!0;var n;void 0!==(n=e?t.OnSingleLocationValue(e):{data:null,localized:""})&&null!=n&&t._cellContext.SetCurrentValue(n)};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsureLocationPicker=function(e,t){var i={dataSource:this._gridContext.locationDataSource,pageContext:this._gridContext.pageContext,defaultLocation:e,onChange:this.OnLocationResolvedCallback,onBlur:this.OnPickerInputBlur.bind(this),onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:this.OnKeyDown.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,setSelectionFrame:this.SetSelectionFrame};this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(w.LocationEditor,i),this._pickercontainer):n.render(r.createElement(w.LocationEditor,i),this._pickercontainer);var o=this._pickercontainer.getElementsByTagName("input");o&&o.length&&(this._editorelm=o[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._editorelm&&("keydown"==t.type||"keypress"==t.type)&&s.JsGridUtil.Utility.IsChar(t)){var u=String.fromCharCode(t.charCode);this._editorelm.value=u}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.CreatePickerDiv=function(e){this._pickercontainer=document.createElement("div");this._pickercontainer.id=e;this._pickercontainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickercontainer.style.right="-1px":this._pickercontainer.style.left="-1px";this._pickercontainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickercontainer.className=s.JsGridUtil.Internal.IsFeatureEnabled(ce)?P.msGrid:"ms-grid";this._parentNode.appendChild(this._pickercontainer);this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickercontainer.classList.add(P.stickyEditor):this._pickercontainer.classList.remove(P.stickyEditor))};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;this.CreatePickerDiv(this.idPrefix)};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;this._cellContext.Hide(this._pickercontainer);this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickercontainer):n.unmountComponentAtNode(this._pickercontainer)};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickercontainer);this.EnsureLocationPicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1};e.prototype.SetupHandlers=function(e){null!=this._pickercontainer&&(e?this._pickercontainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickercontainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==i.JsGridConstants.Key.tab||t==i.JsGridConstants.Key.esc||t==i.JsGridConstants.Key.enter||t==i.JsGridConstants.Key.windows||t>=i.JsGridConstants.Key.left&&t<=i.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){if(!this._inEdit||this.IsSpecialNavKeys(e)){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._editorelm,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickercontainer.style.minWidth=String(e-2)+"px";s.JsGridUtil.Internal.IsFeatureEnabled(le)||(this._pickercontainer.style.minHeight=String(t-2)+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){var e=this._cellContext.originalValue.data;return this.BuildUnresolvedEntity(e.Address,e.DisplayName,e.Coordinates,e.LocationUri,e.EntityType)};e.prototype.GetOriginalLocValue=function(){var e=this._cellContext.originalValue.localized;return this.BuildUnresolvedEntity(null,e,null,null,null)};e.prototype.BuildUnresolvedEntity=function(e,t,n,r,i){return e||t||n||r||i?{Address:e,DisplayName:t,Coordinates:n,LocationUri:r,EntityType:i}:null};e.prototype.OnSingleLocationValue=function(e){var t={data:null,localized:""};e&&(t={data:{Address:e.Address,DisplayName:e.DisplayName,Coordinates:e.Coordinates,LocationUri:e.LocationUri,EntityType:e.EntityType},localized:e.DisplayName});return t};e.prototype.UpdateElementValue=function(e,t){s.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();e.LocationPickerEditControl=g;var b=(function(){function e(e,t){var n=this;this.idPrefix="taxonomyPickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnTermResolvedCallback=function(e){n._isDirty=!0;var t;if(Boolean(n._cellContext.field._multiValue)&&e.length>0){for(var r=[],i=[],o=0;o<e.length;o++){var u=n.OnSingleTermValue(e[o]);r.push(u.data);i.push(u.localized)}t={data:r,localized:s.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(i,S.TERM_DELIMITER,!1)}}else t=e.length>0?n.OnSingleTermValue(e[0]):{data:null,localized:""};void 0!==t&&null!=t&&n._cellContext.SetCurrentValue(t)};this.PositionGridSelectionFrame=function(e){n._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,n._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){n._gridPane.SetSelectionFrameOnNonTdElement(e,n._cellContext.GetCurrentRect())};this._gridContext=e;this._customFieldInfo=t;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsureTaxonomyPicker=function(e,t){var i={onEditorKeyDown:this.OnKeyDown.bind(this),onEditorMouseDown:this.OnMouseDown.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,dataSource:this._gridContext.taxonomyPickerDataSource,pageContext:this._gridContext.pageContext,selectedTerms:e,onItemsChange:this.OnTermResolvedCallback,onBlur:this.OnPickerInputBlur.bind(this),schema:this._customFieldInfo[this._cellContext.fieldKey],setSelectionFrame:this.SetSelectionFrame};this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(x.TaxonomyEditor,i),this._pickercontainer):n.render(r.createElement(x.TaxonomyEditor,i),this._pickercontainer);var o=this._pickercontainer.getElementsByTagName("input");o&&o.length&&(this._editorelm=o[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._editorelm&&("keydown"==t.type||"keypress"==t.type)&&s.JsGridUtil.Utility.IsChar(t)){var u=String.fromCharCode(t.charCode);this._editorelm.value=u}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.CreatePickerDiv=function(e){this._pickercontainer=document.createElement("div");this._pickercontainer.id=e;this._pickercontainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickercontainer.style.right="-1px":this._pickercontainer.style.left="-1px";this._pickercontainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickercontainer.className=s.JsGridUtil.Internal.IsFeatureEnabled(ce)?P.msGrid:"ms-grid";s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickercontainer.classList.add(P.stickyEditor):this._pickercontainer.classList.remove(P.stickyEditor));this._parentNode.appendChild(this._pickercontainer);this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;this.CreatePickerDiv(this.idPrefix)};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;this._cellContext.Hide(this._pickercontainer);this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickercontainer):n.unmountComponentAtNode(this._pickercontainer);$||this._parentNode.removeChild(this._pickercontainer)};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickercontainer,!0);this.EnsureTaxonomyPicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1};e.prototype.SetupHandlers=function(e){null!=this._pickercontainer&&(e?this._pickercontainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickercontainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==i.JsGridConstants.Key.tab||t==i.JsGridConstants.Key.esc||t==i.JsGridConstants.Key.enter||t==i.JsGridConstants.Key.windows||t>=i.JsGridConstants.Key.left&&t<=i.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){if(!this._inEdit||this.IsSpecialNavKeys(e)){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._editorelm,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickercontainer.style.minWidth=String(e-2)+"px";s.JsGridUtil.Internal.IsFeatureEnabled(le)||(this._pickercontainer.style.minHeight=String(t-2)+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){var e=[],t=this._cellContext.originalValue.data;if(""!==t)if(Array.isArray(t))for(var n=0;n<t.length;n++)e.push(this.BuildUnresolvedEntity(t[n].TermID,t[n].Label));else e.push(this.BuildUnresolvedEntity(t.TermID,t.Label));return e};e.prototype.GetOriginalLocValue=function(){var e=[],t=this._cellContext.originalValue.localized;if(null!=t&&""!==t)for(var n=t.split(S.TERM_DELIMITER),r=0;r<n.length;r++)if(""!==n[r]){var i=n[r].split(S.LABEL_ID_DELIMITER);e.push(this.BuildUnresolvedEntity(i[1],i[0]))}return e};e.prototype.BuildUnresolvedEntity=function(e,t){var n=e!==S.INVALID_TERM_ID;return{term:{termId:e,label:t,isValid:n},isSynonym:!1,completions:[],start:"",state:n?1:2}};e.prototype.OnSingleTermValue=function(e){var t={data:null,localized:""};e&&(t={data:{Label:e.term.label,TermID:e.term.termId},localized:e.term.label+S.LABEL_ID_DELIMITER+e.term.termId});return t};e.prototype.UpdateElementValue=function(e,t){s.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();e.TaxonomyPickerEditControl=b;e.GetHyperlinkEditControl=function(t,n){var r=new e.EditBoxEditControl(t,n);r.SetValue=function(e){var t=r.GetInputElement(),n=r.GetCellContext(),i=null!=n.originalValue.data?n.originalValue.data.display:null,s=null!=n.originalValue.data?n.originalValue.data.address:null,o=null==i||""==i||i==s?t.value:i,u={address:t.value,display:o};n.SetCurrentValue({data:u})};r.GetOriginalValue=function(){var e=r.GetCellContext();return null!=e.originalValue.data?e.originalValue.data.address:null};r.OnValueChanged=function(e){r.GetInputElement().value=null==e.data||null==e.data.address||e.data==s.JsGridUtil.EmptyValue||e.data.address==s.JsGridUtil.EmptyValue?"":e.data.address};return r};var E=(function(){function e(e){var t=this;this.id="jsgrid_hyperlink";this._isDirty=!1;this._isBound=!1;this._inEdit=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this.OnValueChanged=function(e){if(t._isDirty){t.UpdateElementValue(t._editorelm,e);t._isDirty=!1}};this.OnOK=function(e){t._cellContext.NotifyEditComplete();t._cellContext.NotifyEditComplete()};this.OnCancel=function(){t._cellContext.NotifyEditComplete(!0);t._cellContext.NotifyEditComplete(!0)};this.OnValueChangedInternal=function(e){if(e){var n=t.GetOriginalValue(),r=n.display,i=n.address,s=e.display,o=e.address;s!=r||null!=r&&""!=r&&r!=i||(s=o);t._cellContext.SetCurrentValue({data:{address:o,display:s}});t._isDirty=!0}};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.classList.add(I.msGridEditControlContainer);this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._isBound=!0;this._cellContext=e};e.prototype.Unbind=function(){if(this._isBound){this.OnEndEdit();this._cellContext.Hide(this._container);this._isDirty=!1;this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):n.unmountComponentAtNode(this._container)}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._container);this.RenderData(t)};e.prototype.OnCellMove=function(e){};e.prototype.OnEndEdit=function(){if(this._isBound&&this._isDirty){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;this._cellContext.NotifyEditComplete()}};e.prototype.RenderData=function(e){var t=!ee&&s.JsGridUtil.Internal.getCalloutBoundsBelowStickyHeader(this._parentNode.id),o={target:this._cellContext.GetCurrentTd(),onSave:this.OnOK,onCancel:this.OnCancel,styles:{container:{zIndex:i.JsGridConstants.Internal.zIndex.expandableEditorsZIndex}},bounds:t,lightDismissElementsFilter:["spgridcontainer_"+s.JsGridUtil.privateWpq,i.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout],calloutId:i.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout},u={onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:this.OnKeyDown.bind(this),onValueChange:this.OnValueChangedInternal,currentUrlValue:e.address,currentDisplayValue:e.display,calloutProps:o};s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(P.stickyEditor):this._container.classList.remove(P.stickyEditor));this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(h.HyperlinkEditor,u),this._container):n.render(r.createElement(h.HyperlinkEditor,u),this._container);this._inEdit&&this.SetupHandlers(!0);s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(P.stickyEditor):this._container.classList.remove(P.stickyEditor));this._container.focus()};e.prototype.OnKeyDown=function(e){if(e.keyCode==i.JsGridConstants.Key.enter||e.keyCode==i.JsGridConstants.Key.esc){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.UpdateElementValue=function(e,t){s.JsGridUtil.DebugAssert(null!=e);e.value=t};e.prototype.SetupHandlers=function(e){null!=this._container&&(e?this._container.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._container.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.GetOriginalValue=function(){var e,t,n=this._cellContext.originalValue.data;if(null!=n){e=n.address;t=n.display}return{address:e,display:t}};return e})();e.HyperlinkEditControlV2=E;var T=(function(){function e(e){var t=this;this.id="jsgrid_number";this._isDirty=!1;this._isBound=!1;this._inEdit=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnSave=function(e){t._cellContext.NotifyEditComplete();t._cellContext.NotifyEditComplete()};this.OnValueChangedInternal=function(e){if(e){t._cellContext.SetCurrentValue({localized:e});t._isDirty=!0;t._value=e}};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.classList.add(I.msGridEditControlContainer);this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._isBound=!0;this._cellContext=e;this._value=this.GetOriginalValue()||"";this._value=this._value.replace(/%/g,"");s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(P.stickyEditor):this._container.classList.remove(P.stickyEditor))};e.prototype.Unbind=function(e){if(this._isBound){this.OnEndEdit(e);this._cellContext.Hide(this._container);this._isDirty=!1;this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):n.unmountComponentAtNode(this._container)}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){this._inEdit=!0;this._cellContext.Show(this._container);e&&s.JsGridUtil.Utility.IsChar(e)&&(this._value=String.fromCharCode(e.charCode));this.RenderData(this._value)};e.prototype.OnCellMove=function(e){this.RenderData(this._value)};e.prototype.OnEndEdit=function(e){if(this._isBound&&this._isDirty){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;this._cellContext.NotifyEditComplete(e)}this._value=""};e.prototype.RenderData=function(e){var t=0,i=0;if(s.JsGridUtil.Internal.IsFeatureEnabled(ce)){i=this._cellContext.cellWidth-3;t=this._cellContext.cellHeight-5}else{i=this._cellContext.cellWidth-10;t=this._cellContext.cellHeight-6}var o=this._gridContext.jsGridObj.GetSpCsrRenderCtx(),u=s.JsGridUtil.Internal.IsFeatureEnabled(ce)?P.spGridControlEditbox+" "+(o.fixedHeightRowEnabled?"":P.spGridControlEditboxDynamicHeight):"jsgrid-control-editbox";this._cellContext.field.csrInfo.CustomFormatter||(u+=" "+P.inputIsNumber);var a=this._cellContext.field&&this._cellContext.field.csrInfo,f=a&&a.Unit||"None",l=a&&a.CustomUnitName||"",c=!a||!a.CustomUnitOnRight||"TRUE"===a.CustomUnitOnRight,h={onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:this.OnKeyDown.bind(this),onValueChange:this.OnValueChangedInternal,onSave:this.OnSave,currentValue:e,unit:f,customUnitName:l,customUnitOnRight:c,width:i,height:t,className:u};this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(p.NumberEditor,h),this._container):n.render(r.createElement(p.NumberEditor,h),this._container);this._inEdit&&this.SetupHandlers(!0)};e.prototype.OnKeyDown=function(e){e.keyCode!=i.JsGridConstants.Key.enter&&e.keyCode!=i.JsGridConstants.Key.esc&&e.keyCode!=i.JsGridConstants.Key.tab||this._gridContext.OnKeyDown(e);e.keyCode==i.JsGridConstants.Key.esc&&this.Unbind(!0)};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.SetupHandlers=function(e){null!=this._container&&(e?this._container.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._container.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.GetOriginalValue=function(){return this._cellContext.originalValue.localized};return e})();e.NumberEditControl=T;var N=(function(){function e(e){var t=this;this.id="jsgrid_date";this._isDirty=!1;this._isBound=!1;this._inEdit=!1;this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.OnValueChanged=function(e){if(t._isDirty){t.UpdateElementValue(t._editorelm,e);t._isDirty=!1}};this.OnValueChangedInternal=function(e){t._isDirty=!0;if(e){var n=s.JsGridUtil._gridutilPageContextKillswitchIsActive?_spPageContextInfo.currentCultureName:s.JsGridUtil.PageContext.currentCultureName;if(t._cellContext.field.dateOnly){var r=e.toLocaleDateString(n);t._cellContext.SetCurrentValue({data:e,localized:r});t._cellContext.NotifyEditComplete();t._cellContext.NotifyEditComplete();t._cellContext.Hide(t._container)}else{var i=(r=e.toLocaleDateString(n))+" "+e.toLocaleTimeString(n,{hour:"2-digit",minute:"2-digit"});t._cellContext.SetCurrentValue({data:e,localized:i})}}};this.OnInputValueChangedInternal=function(e){t._isDirty=!0;e&&t._cellContext.SetCurrentValue({localized:e})};this.OnOK=function(e){A.Engagement.logData({name:"QuickEdit.CalendarType.Gregorian"});t._cellContext.NotifyEditComplete();t._cellContext.NotifyEditComplete();t._cellContext.Hide(t._container)};this.OnCancel=function(){t._cellContext.NotifyEditComplete(!0);t._cellContext.NotifyEditComplete(!0);t._cellContext.Hide(t._container)};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.classList.add(I.msGridEditControlContainer);this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._isBound=!0;this._cellContext=e};e.prototype.Unbind=function(){if(this._isBound){this.OnEndEdit();this._cellContext.Hide(this._container);this._isDirty=!1;this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):n.unmountComponentAtNode(this._container)}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){var t=this.GetDateValue(),n="";this._inEdit=!0;this._cellContext.Show(this._container);"keydown"!=e.type&&"keypress"!=e.type||e.keyCode===i.JsGridConstants.Key.F2||!s.JsGridUtil.Utility.IsChar(e)||(n=String.fromCharCode(e.charCode));this.RenderData(t,n)};e.prototype.OnCellMove=function(e){};e.prototype.GetOriginalValue=function(){return this._cellContext.originalValue.localized};e.prototype.OnEndEdit=function(){if(this._isBound&&this._isDirty){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;this._cellContext.NotifyEditComplete()}};e.prototype.RenderData=function(e,t){var o,u,a,f=this._cellContext.field.dateOnly,l=!ee&&s.JsGridUtil.Internal.getCalloutBoundsBelowStickyHeader(this._parentNode.id);a=f?{target:this._cellContext.GetCurrentTd(),onSave:this.OnOK,styles:{container:{zIndex:i.JsGridConstants.Internal.zIndex.expandableEditorsZIndex}},bounds:l,lightDismissElementsFilter:["spgridcontainer_"+s.JsGridUtil.privateWpq,i.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout],calloutId:i.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout}:{target:this._cellContext.GetCurrentTd(),onSave:this.OnOK,onCancel:this.OnCancel,styles:{container:{zIndex:i.JsGridConstants.Internal.zIndex.expandableEditorsZIndex}},bounds:l,lightDismissElementsFilter:["spgridcontainer_"+s.JsGridUtil.privateWpq,i.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout],calloutId:i.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout};var c,h=s.JsGridUtil._gridutilPageContextKillswitchIsActive?null===(u=_spPageContextInfo.webTimeZoneData)||void 0===u?void 0:u.Id:null===(o=s.JsGridUtil.PageContext.webTimeZoneData)||void 0===o?void 0:o.Id,p=e?new Date(e):void 0;if(p&&!isNaN(h)){var v=O.getIANATzNameFromSPTzID(h);p=O.maskServerTimeAsLocalTime(p,v)}if(p&&!f){var m=p.getHours(),g=p.getMinutes();c=this.formatTime(m)+":"+this.formatTime(g)}var y=s.JsGridUtil._gridutilPageContextKillswitchIsActive?_spPageContextInfo.currentCultureName:s.JsGridUtil.PageContext.currentCultureName,b={onInputKeyDown:this.OnInputKeyDown.bind(this),onValueChange:this.OnValueChangedInternal,onInputValueChange:this.OnInputValueChangedInternal,date:p,time:f?void 0:c,dateTime:t||this.GetOriginalValue(),inputProps:{height:this._cellContext.cellHeight,width:this._cellContext.cellWidth},currentCultureName:y,dateOnly:this._cellContext.field.dateOnly,calloutProps:a};s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(P.stickyEditor):this._container.classList.remove(P.stickyEditor));this._gridContext.portalManager?this._gridContext.portalManager.render(r.createElement(d.DateEditor,b),this._container):n.render(r.createElement(d.DateEditor,b),this._container);this._inEdit&&this.SetupHandlers(!0);s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(P.stickyEditor):this._container.classList.remove(P.stickyEditor));this._container.focus()};e.prototype.OnKeyDownInternal=function(e){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)};e.prototype.OnKeyDown=function(e){e.keyCode==i.JsGridConstants.Key.esc&&this.OnKeyDownInternal(e)};e.prototype.OnInputKeyDown=function(e){e.keyCode!=i.JsGridConstants.Key.enter&&e.keyCode!=i.JsGridConstants.Key.esc||this.OnKeyDownInternal(e);e.stopPropagation()};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.UpdateElementValue=function(e,t){s.JsGridUtil.DebugAssert(null!=e);e.value=t};e.prototype.SetupHandlers=function(e){if(null!=this._container)if(e){this._container.addEventListener("mousedown",this.OnMouseDown.bind(this));this._container.addEventListener("keydown",this.OnKeyDown.bind(this))}else{this._container.removeEventListener("mousedown",this.OnMouseDown.bind(this));this._container.addEventListener("keydown",this.OnKeyDown.bind(this))}};e.prototype.GetDateValue=function(){var e=this._cellContext.fieldKey;if(this._cellContext.record&&this._cellContext.record.fieldRawDataMap&&this._cellContext.record.fieldRawDataMap.csrInfo)return this._cellContext.record.fieldRawDataMap.csrInfo[e+"."]};e.prototype.formatTime=function(e){return e<10?"0"+e.toString():e.toString()};return e})();e.DateEditControl=N})(t.EditControl||(t.EditControl={}));t.EditControlType={EditBox:"EDIT_EDITBOX",ComboBox:"EDIT_COMBOBOX",Checkbox:"EDIT_CHECKBOX",Hyperlink:"EDIT_HYPERLINK",PeoplePicker:"EDIT_PEOPLEPICKER",LocationPicker:"EDIT_LOCATIONPICKER",DatePicker:"EDIT_DATEPICKER",BooleanComboBox:"EDIT_BOOLEANCOMBOBOX",NumberBox:"EDIT_NUMBERBOX"};(function(e){var t=(function(){function e(e,t){this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.Either;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.Both;this.id=i.JsGridConstants.ErrorWidgetId;this._gridContext=e;this._errorMgr=t;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._gridContext.bLightFocus=!0;var e=s.JsGridUtil.Internal.IsFeatureEnabled(ce),t=e?i.JsGridConstants.Internal.zIndex.editor:1;s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t+=i.JsGridConstants.Internal.zIndex.stickyZIndex);var n=this.id+"_mainDiv",r=this.id+"_focuselem",o=this.id+"_errorSpan";this.mainDiv=document.createElement("div");this.mainDiv.id=n;if(e&&!se){this.mainDiv.classList.add(I.errorWidgetContainer);s.JsGridUtil.Internal.IsStickyColumnEnabled()&&!se&&this.mainDiv.classList.add(I.stickyZIndex)}else this.mainDiv.style.cssText=["z-index:"+t+";","visibility: hidden;","font-size: 10;","position: absolute;","top: 0px;","left: 0px;","background-color: #FFE0E0;","border: 1px solid #DD3300;","padding: 5px 10px;","color: #333333!important;"].join("");this._parentNode.appendChild(this.mainDiv);this.focusElement=document.createElement("input");this.focusElement.id=r;this.focusElement.style.cssText="position:fixed;top:0px;left:-10px;height:0px;width:0px;display:none";this.focusElement.setAttribute("role","presentation");this.mainDiv.appendChild(this.focusElement);this.errorSpan=document.createElement("span");this.errorSpan.id=o;this.mainDiv.appendChild(this.errorSpan)};e.prototype.Dispose=function(){this._parentNode.removeChild(this.mainDiv)};e.prototype.BindToCell=function(e){this._cellContext=e;this.mainDiv.addEventListener("keydown",this._gridContext.OnKeyDown)};e.prototype.Unbind=function(){s.JsGridUtil.ClearEventListeners(this.mainDiv)};e.prototype.GetIcon=function(){return new s.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:P.spGridErrorIcon}}).Render(SP.JsGrid.Res.openErrorWidget)};e.prototype.Collapse=function(){ie||this.errorSpan.removeAttribute("role");s.JsGridUtil.Internal.IsFeatureEnabled(ce)&&!se?this.mainDiv.classList.remove(I.widgetExpanded):this.mainDiv.style.visibility="hidden";s.JsGridUtil.Internal.IsFeatureEnabled(ce)&&!s.JsGridUtil._errorWidgetInstantOpenKillSwitchIsActive||this._cellContext.NotifyCollapseWidget()};e.prototype.Expand=function(){s.JsGridUtil.Internal.DomElement.GetInstance().SetText(this.errorSpan,this._errorMgr.GetMessageForCell(this._cellContext.record.key(),this._cellContext.fieldKey));this._widgetHeight=this.mainDiv.offsetHeight;var e=this.mainDiv.offsetWidth,t=this._cellContext.cellRect,n=this._cellContext.cellExpandSpace;this.mainDiv.style.top=(n.bottom>this._widgetHeight||n.top<this._widgetHeight?t.y+t.height+4:t.y-this._widgetHeight-4)+"px";var r=this._gridContext.RTL.bEnabled;if(oe)this.mainDiv.style.left=t.x-(r?e-t.width:2)+"px";else if(r){this.mainDiv.style.left=t.x-(e-t.width)+"px";this.mainDiv.getBoundingClientRect().left<0&&(this.mainDiv.style.left=t.x+"px")}else{this.mainDiv.style.left=t.x+"px";this.mainDiv.getBoundingClientRect().right>(window.innerWidth||document.documentElement.clientWidth)&&(this.mainDiv.style.left=t.x-(e-t.width)+"px")}this._cellContext.NotifyExpandWidget();s.JsGridUtil.Internal.IsFeatureEnabled(ce)&&!se?this.mainDiv.classList.add(I.widgetExpanded):this.mainDiv.style.visibility="";ie||this.errorSpan.setAttribute("role","alert");this.focusElement.focus()};e.prototype.OnValueChanged=function(e){};return e})();e.ErrorWidget=t;var n=(function(){function e(e){this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.LocalizedOnly;this._widgetHeight=200;this.strDatePickerImageID="DatePickerImage";this.strDatePickerFrameID="DatePickerFrame";this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.ClickDatePickerFn=function(e,t,n,r){clickDatePicker(e,t,n);r()};e.prototype.Init=function(){var e=s.JsGridUtil.Internal.IsFeatureEnabled(ce);this._box=document.createElement("input");this._box.id="datewidgetinput-"+this._parentNode.id;this._box.style.cssText="display:none;position:absolute;top:0px;left:0px";this._box.onvaluesetfrompicker=this.OnValueSetHandler.bind(this);this._box.tabIndex=-1;this._parentNode.appendChild(this._box);this._anchor=document.createElement("div");this._anchor.id=this._box.id+this.strDatePickerImageID;this._anchor.style.cssText="position:absolute;background:transparent;visibility:hidden;height:0px;z-index:-1";this._parentNode.appendChild(this._anchor);this._iframe=document.createElement("iframe");this._iframe.id=this._box.id+this.strDatePickerFrameID;this._iframe.src=s.JsGridUtil.Internal.SiteUrl+i.JsGridConstants.ImagesDirectory+"blank.gif";this._iframe.frameBorder="0";this._iframe.scrolling="no";this._iframe.title=SP.JsGrid.Res.calendarTitle;var t=i.JsGridConstants.Internal.zIndex.editor;s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t+=i.JsGridConstants.Internal.zIndex.stickyZIndex);this._iframe.style.cssText="display: none; position: absolute; width: 220px; z-index: "+(e?t:1)+" ";this._iframe.tabIndex=-1;this._parentNode.appendChild(this._iframe);null==window.g_strDateTimeControlIDs&&(window.g_strDateTimeControlIDs=[]);window.g_strDateTimeControlIDs.JsGridDatePicker=this._box.id};e.prototype.Dispose=function(){this._box.onvaluesetfrompicker=null;this._parentNode.removeChild(this._box);this._parentNode.removeChild(this._anchor);this._parentNode.removeChild(this._iframe)};e.prototype.BindToCell=function(e){this._cellContext=e;this._curValue=this._cellContext.originalValue.localized==s.JsGridUtil.EmptyValue?"":this._cellContext.originalValue.localized};e.prototype.Unbind=function(){this._curValue=null};e.prototype.Expand=function(){var e=this,t=this._cellContext.cellRect;A.Engagement.logData({name:"QuickEdit.CalendarType."+(1===s.JsGridUtil.SpRegionalSettings.calendarType?"Gregorian":"NonGregorian")});s.JsGridUtil.DebugAssert(null!=t);if(null!=t){this._anchor.style.width=t.width+"px";this._anchor.style.top=(this._cellContext.cellExpandSpace.bottom>this._widgetHeight||this._cellContext.cellExpandSpace.top<this._widgetHeight?t.y+t.height+3:t.y-this._widgetHeight-3)+"px";this._anchor.style.left=t.x-(this._gridContext.RTL.bEnabled?this._anchor.offsetWidth-t.width:2)+"px";this._anchor.style.visibility="";this._box.value=null!=this._curValue?this._curValue:"";s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._anchor.classList.add(P.stickyEditor):this._anchor.classList.remove(P.stickyEditor));this._cellContext.NotifyExpandWidget();this.ClickDatePickerFn(this._box.id,this.GetDatePickerQueryString(),this._box.value,function(){var n=e._iframe.resultfunc;e._iframe.resultfunc=function(t){null==t&&e._cellContext.NotifyEditComplete(!0);e.Collapse();n(t)};V||(e._iframe.onloadcallback=function(){s.JsGridUtil.Internal.positionWidget(e._iframe,t,e._gridContext.RTL.bEnabled)})})}};e.prototype.GetIcon=function(){return new s.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Calendar"}}).Render(SP.JsGrid.Res.openCalendar)};e.prototype.Collapse=function(){var e=this;s.JsGridUtil.Internal.GetVisible(this._iframe)?this.ClickDatePickerFn(this._box.id,this.GetDatePickerQueryString(),this._box.value,function(){e._cellContext.NotifyCollapseWidget()}):this._cellContext.NotifyCollapseWidget()};e.prototype.OnValueChanged=function(e){this._curValue=e.localized};e.prototype.OnValueSetHandler=function(){this._cellContext.SetCurrentValue({localized:this._box.value});this._cellContext.NotifyEditComplete()};e.prototype.GetDatePickerQueryString=function(){var e=s.JsGridUtil._gridutilPageContextKillswitchIsActive?_spPageContextInfo.currentLanguage:s.JsGridUtil.PageContext.currentLanguage;return[s.JsGridUtil.Internal.SiteUrl+"/_layouts/iframe.aspx?","&cal=",s.JsGridUtil.SpRegionalSettings.calendarType,"&lcid=",s.JsGridUtil.SpRegionalSettings.localeId,"&langid=",e,"&tz=",s.JsGridUtil.SpRegionalSettings.timeZone,"&time24=",s.JsGridUtil.SpRegionalSettings.time24?"true":"false","&ww=",s.JsGridUtil.SpRegionalSettings.workDays,"&fdow=",s.JsGridUtil.SpRegionalSettings.firstDayOfWeek,"&fwoy=",s.JsGridUtil.SpRegionalSettings.firstWeekOfYear,"&hj=",s.JsGridUtil.SpRegionalSettings.adjustHijriDays,"&swn=",s.JsGridUtil.SpRegionalSettings.showWeeks?"true":"false","&minjday=109207","&maxjday=2666269","&dateonly=",this._cellContext.field.dateOnly?"true":"false","&date="].join("")};return e})();e.DateWidget=n;var r=(function(){function e(e){this.SupportedWriteMode=i.JsGridConstants.EditActorWriteType.Either;this.SupportedReadMode=i.JsGridConstants.EditActorReadType.Both;this.id="HyperlinkWidgetControl";this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){var e=s.JsGridUtil.Internal.IsFeatureEnabled(ce);this._mainDiv=document.createElement("div");this._mainDiv.id="mainDiv";this._mainDiv.className=R?"jsgrid-widget-hyperlink":"jsgrid-widget-hyperlink-quickedit";var t=i.JsGridConstants.Internal.zIndex.editor;s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t+=i.JsGridConstants.Internal.zIndex.stickyZIndex);this._mainDiv.style.cssText="z-index: "+(e?t:1)+"; visibility: hidden; position: absolute; top: 0px; left: 0px; width: 290px; direction: "+this._gridContext.RTL.ltr+";";this._parentNode.appendChild(this._mainDiv);this._addressInputId=u.format("{0}_{1}",this.id,"addressInput");this._verifyButtonId=u.format("{0}_{1}",this.id,"verifyButton");this._displayInputId=u.format("{0}_{1}",this.id,"displayInput");this._okButtonId=u.format("{0}_{1}",this.id,"okButton");this._cancelButtonId=u.format("{0}_{1}",this.id,"cancelButton");var n,r=u.format('<DIV style="margin:3px 10px 0px 10px; text-align:{0};"><img src="{1}" alt="{2}" title="{2}" id="{3}" tabIndex="-1" style="cursor:pointer;"/></DIV>',this._gridContext.RTL.Right,s.JsGridUtil.Internal.SiteUrl+i.JsGridConstants.ImagesDirectory+"closexon.png",SP.JsGrid.Res.close,this._cancelButtonId),o=u.format('<a href="javascript:;" id="{0}" title="{1}" style="float:{2};">{1}</a>',this._verifyButtonId,SP.JsGrid.Res.testHyperlink,this._gridContext.RTL.Right),a='<DIV style="margin:3px 10px 9px 10px;"><LABEL for={0}>{1}</LABEL>{3}<DIV style="margin-top:3px;"><INPUT id={0} style="width:268px; padding:0px;" maxLength="1024" type="text"></DIV><DIV style="margin-top:3px;">{2}</DIV></DIV>',f=u.format(a,this._addressInputId,SP.JsGrid.Res.hyperlinkAddress,SP.JsGrid.Res.hyperlinkAddressExample,o),l=u.format(a,this._displayInputId,SP.JsGrid.Res.hyperlinkDisplay,SP.JsGrid.Res.hyperlinkDisplayExample,"");n=R?u.format('<DIV style="padding:3px 10px 3px 10px; text-align:{0}" class="jsgrid-widget-hyperlink-buttonarea"><a href="javascript:;" title="{1}" id="{2}" class="jsgrid-widget-hyperlink-okbutton">{1}</a></DIV>',this._gridContext.RTL.Right,SP.JsGrid.Res.ok,this._okButtonId):u.format('<DIV style="padding:3px 10px 3px 10px; text-align:{0}" class="jsgrid-widget-hyperlink-buttonarea-quickedit"><a href="javascript:;" title="{1}" id="{2}">{1}</a></DIV>',this._gridContext.RTL.Right,SP.JsGrid.Res.ok,this._okButtonId);this._mainDiv.innerHTML=[r,f,l,n].join("");this._widgetHeight=this._mainDiv.offsetHeight;this._addressInput=document.getElementById(this._addressInputId);this._verifyButton=document.getElementById(this._verifyButtonId);this._displayInput=document.getElementById(this._displayInputId);this._okButton=document.getElementById(this._okButtonId);this._cancelButton=document.getElementById(this._cancelButtonId);this._displayInput.addEventListener("keyup",this.OnDisplayValueUpdated.bind(this));this._okButton.addEventListener("click",this.OnOK.bind(this));this._cancelButton.addEventListener("click",this.OnCancel.bind(this));this._verifyButton.addEventListener("click",this.OnVerify.bind(this));this._mainDiv.addEventListener("keydown",this.OnKeyDown.bind(this));this._mainDiv.addEventListener("mousedown",this.OnMouseDown.bind(this))};e.prototype.Dispose=function(){s.JsGridUtil.ClearEventListeners(this._displayInput);s.JsGridUtil.ClearEventListeners(this._okButton);s.JsGridUtil.ClearEventListeners(this._cancelButton);s.JsGridUtil.ClearEventListeners(this._verifyButton);s.JsGridUtil.ClearEventListeners(this._mainDiv);this._parentNode.removeChild(this._mainDiv)};e.prototype.BindToCell=function(e){this._cellContext=e;this._currentDisplayValue=this._cellContext.originalValue.localized!==s.JsGridUtil.EmptyValue?this._cellContext.originalValue.localized:this._cellContext.propType.GetAddress(this._cellContext.originalValue.data);this._currentDisplayValue||(this._currentDisplayValue="");this._currentAddress=this._cellContext.originalValue.data!==s.JsGridUtil.EmptyValue?this._cellContext.propType.GetAddress(this._cellContext.originalValue.data):this._cellContext.originalValue.localized};e.prototype.Unbind=function(){};e.prototype.GetIcon=function(){return new s.JsGridUtil.ImageWithFabricIcons({imgSrc:s.JsGridUtil.Internal.SiteUrl+i.JsGridConstants.ImagesDirectory+"link.gif"}).Render(SP.JsGrid.Res.editHyperlink)};e.prototype.Collapse=function(){this._mainDiv.style.visibility="hidden";this._cellContext.NotifyCollapseWidget()};e.prototype.Expand=function(){var e=this._cellContext.cellRect;this._mainDiv.style.top=(this._cellContext.cellExpandSpace.bottom>this._widgetHeight||this._cellContext.cellExpandSpace.top<this._widgetHeight?e.y+e.height+3:e.y-this._widgetHeight-3)+"px";z?this._mainDiv.style.left=(this._gridContext.RTL.bEnabled?e.x:e.x+e.width-this._mainDiv.offsetWidth)+"px":s.JsGridUtil.Internal.positionWidget(this._mainDiv,e,this._gridContext.RTL.bEnabled);this._currentDisplayValue=this._cellContext.originalValue.localized!==s.JsGridUtil.EmptyValue?this._cellContext.originalValue.localized:this._cellContext.propType.GetAddress(this._cellContext.originalValue.data);this._currentDisplayValue||(this._currentDisplayValue="");this._currentAddress=this._cellContext.originalValue.data!==s.JsGridUtil.EmptyValue?this._cellContext.propType.GetAddress(this._cellContext.originalValue.data):this._cellContext.originalValue.localized;this._displayInput.value=this._currentDisplayValue;this._addressInput.value=this._currentAddress;this._cellContext.NotifyExpandWidget();this._mainDiv.style.visibility="";s.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._mainDiv.classList.add(P.stickyEditor):this._mainDiv.classList.remove(P.stickyEditor));this._addressInput.focus();this._addressInput.value=this._addressInput.value};e.prototype.OnValueChanged=function(e){this._currentDisplayValue=null==e.localized||e.localized==s.JsGridUtil.EmptyValue?"":e.localized;this._currentAddress=null==e.data||e.data==s.JsGridUtil.EmptyValue?this._currentDisplayValue:this._cellContext.propType.GetAddress(e.data)};e.prototype.OnDisplayValueUpdated=function(){this.SetCurrentValue()};e.prototype.OnOK=function(e){this.SetCurrentValue();this._cellContext.NotifyEditComplete();this.Collapse();null!=e&&null!=e.preventDefault&&e.preventDefault();return!1};e.prototype.OnCancel=function(){this._cellContext.NotifyEditComplete(!0)};e.prototype.OnVerify=function(){window.open(this._addressInput.value)};e.prototype.SetCurrentValue=function(){this._cellContext.SetCurrentValue({localized:this._displayInput.value,data:{address:this._addressInput.value,display:this._displayInput.value}})};e.prototype.OnKeyDown=function(e){var t=this,n=!e.ctrlKey&&!e.altKey&&!e.shiftKey;!(function(){switch(e.keyCode){case i.JsGridConstants.Key.esc:t.OnCancel();return!0;case i.JsGridConstants.Key.enter:e.target==t._cancelButton?t.OnCancel():e.target==t._verifyButton?t.OnVerify():t.OnOK();return!0;case i.JsGridConstants.Key.tab:if(n){if(e.target==t._okButton){t._cancelButton.focus();return!0}}else if(e.shiftKey){if(e.target==t._cancelButton){t._okButton.focus();return!0}if(e.target==t._verifyButton){t._cancelButton.focus();return!0}}}return!1})()?e.stopPropagation():s.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.OnMouseDown=function(e){e.stopPropagation()};return e})();e.HyperlinkWidget=r})(t.WidgetControl||(t.WidgetControl={}));t.WidgetControlType={Demo:"WIDGET_DEMO",Date:"WIDGET_DATE",Hyperlink:"WIDGET_HYPERLINK"}});
define("Kze",["require","exports","lC","r","eGe","xF","yF","_F","gF","Cv","Ru","oc","Vpe","us","EU","cGe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";m=m.PeopleEditor_7;Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isActive=!0;n._useNewEditor=!1;n.handleScroll=function(e){if(!n._scrollEventTriggered){n._scrollEventTriggered=!0;n.props.goBackToSelectMode()}};n._onSelectedPersonasChange=function(e){if(n._isActive){var t=n.props,r=t.peoplePickerQueryParams,i=t.onSelectedPersonasChange,s=t.goBackToSelectMode,o=n.state.currentSelectedPeople;o=r.allowMultipleEntities||e.length<=1?e:[e[e.length-1]];n.setState({currentSelectedPeople:o});i&&i(o);r.allowMultipleEntities||s()}};n._onSuggestionSelected=function(e){if(n._isActive){var t=n.props.peoplePickerQueryParams;if(e&&(!1===e.isExternal||e.isExternal&&e.providerName))return e;if(e&&e.principalType===s.PrincipalType.distributionList){t.isGraphDistributionList=!0;t.useGraph=!0;t.useSubstrate=!0}return n._peoplePickerProvider.resolve(e.userId,t).then(function(e){e&&!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);e&&!e.name&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails);return e})}};n._setFocus=function(){n._peoplePicker&&n._peoplePicker.focusInput()};n.pickerStyleOverrides=function(e){var t=d.getStyles(e),r={text:{minHeight:n.props.cellHeight-12,minWidth:n.props.cellWidth-12}};return c.concatStyleSets(t,r)};n._containerRef=r.createRef();n._scrollParent=v.JsGridUtil.Internal.GetScrollParent(n.props.parentNode);n._scrollEventTriggered=!1;n._useNewEditor=f.default.isFeatureEnabled({ODB:1948});n._peoplePickerProvider=new o.PeoplePickerProvider({pageContext:t.context,peoplePickerDataSource:t.dataSource});n.state={currentSelectedPeople:t.selectedItems};return n}t.prototype.componentDidMount=function(){this._peoplePicker&&this._peoplePicker.focusInput();if(v.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}this._useNewEditor&&this._scrollParent.addEventListener("scroll",this.handleScroll)};t.prototype.componentDidUpdate=function(){if(v.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}if(this._useNewEditor){this._setFocus();var t=document.getElementsByClassName("ms-BasePicker-input")[0];t&&t.scrollIntoView()}};t.prototype.componentWillUnmount=function(){this._isActive=!1;this._useNewEditor&&this._scrollParent.removeEventListener("scroll",this.handleScroll)};t.prototype.render=function(){var e=this,t=this.props,s=t.peoplePickerQueryParams,o=t.onEditorKeyDown,c=t.onEditorMouseDown,p=t.theme,d=this.state.currentSelectedPeople,g=f.default.isFeatureEnabled({ODB:1725})?" "+m.increaseZIndex:"",y=v.JsGridUtil.Internal.IsStickyColumnEnabled()?" "+m.inStickyMode:"";if(this._useNewEditor){var b=m.peopleEditor+g+y+(this._useNewEditor?" "+m.styleUpdates:""),w={container:{zIndex:i.JsGridConstants.Internal.zIndex.expandableEditorsZIndex},root:{minWidth:this.props.cellWidth-2,minHeight:this.props.cellHeight-2,backgroundColor:p.palette.white,border:"2px solid "+p.palette.themePrimary},calloutMain:{padding:0,margin:4}};return r.createElement("div",{ref:this._containerRef,style:{height:"100%",width:"100%"}},r.createElement(h.CommonEditorCallout,{target:this._containerRef,directionalHint:l.DirectionalHint.leftBottomEdge,coverTarget:!0,isBeakVisible:!1,styles:w,gapSpace:0,doNotLayer:!1,onKeyDown:o,onMouseDown:c,preventDismissOnScroll:!1,onLayerMounted:this._setFocus,calloutMaxHeight:Math.max(this.props.cellHeight,200)-12,onSave:this.props.goBackToSelectMode,lightDismissElementsFilter:[i.JsGridConstants.IdOfPeoplePickerInPeopldEditor,"spgridcontainer_"+v.JsGridUtil.privateWpq,i.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout],calloutId:i.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout},r.createElement(u.PeoplePicker,n.__assign({},this.props,{className:b,onSelectedPersonasChange:this._onSelectedPersonasChange,selectedItems:d,onSuggestionSelected:this._onSuggestionSelected,"aria-required":s&&s.required,componentRef:function(t){return e._peoplePicker=t},onRenderItem:a.SelectedItemWithPills,pickerOverrideStyles:this.pickerStyleOverrides,theme:p,pickerCalloutProps:{id:i.JsGridConstants.IdOfPeoplePickerInPeopldEditor}}))))}return r.createElement("span",{onKeyDown:o,onMouseDown:c,ref:this._containerRef},r.createElement(u.PeoplePicker,n.__assign({},this.props,{className:m.peopleEditor+g+y,onSelectedPersonasChange:this._onSelectedPersonasChange,selectedItems:d,onSuggestionSelected:this._onSuggestionSelected,"aria-required":s&&s.required,componentRef:function(t){return e._peoplePicker=t}})))};return t})(r.PureComponent);t.PeopleEditor=p.styled(g,function(){return{}})});
define("zze",["require","exports","MU","us","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";i=i.PersonDisplay_7;Object.defineProperty(t,"__esModule",{value:!0});t.GetPersonDisplay=function(e){var t;if(e.imageUrl)t="<div class="+i.personDisplayCoin+"><img class="+i.personDisplayPhoto+" src="+e.imageUrl+"></img></div>";else{var s=n.getPersonaInitialsColor(e),o=r.getInitials(e.text,!1);t="<div class="+i.personDisplayCoin+" style='background:"+s+"'>"+o+"</div>"}var u="<span class="+i.personDisplayName+">"+e.text+"</span>";return"<div class="+i.personDisplayPill+">"+t+u+"</div>"}});
define("Vze",["require","exports","lC","r","eGe","qpe","oc","ce","Cv","cGe"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u.Killswitch.isActivated("DC101D81-F3CE-4E97-8A0D-BA3985B448FC","12/03/2019","Fix an issue with multiple-choice lookup fields."),c=o.getTheme(),h=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._isActive=!0;s.OnPendingValueUpdated=function(e,t,n){n&&s.setState({pendingValue:{data:n,localized:n}})};s.OnValueChanged=function(e,t,r,i){if(s._isActive){var o={data:[],localized:""};if(s.props.multiSelect){var u=[];if(s.props.allowFreeform&&i){o={data:n.__spreadArrays(s.state.value.data,[i]),localized:s.state.value.localized+";"+i};u.push({key:i,text:i})}else{if(t.selected){if(null!==t.key)if(s.state.value.data||l){for(var a=0;a<s.state.value.data.length;a++)o.data.push(s.state.value.data[a]);o.data.push(t.key)}else o.data.push(t.key)}else for(a=0;a<s.state.value.data.length;a++)s.state.value.data[a]!==t.key&&o.data.push(s.state.value.data[a]);for(a=0;a<o.data.length;a++)if(l)o.localized+=o.data[a]+";";else for(var f=0;f<s.state.options.length;f++)s.state.options[f].key==o.data[a]&&(o.localized+=s.state.options[f].text+";");o.localized=o.localized.substr(0,o.localized.length-1)}s.props.gridOnChange(o);s.setState({value:o,pendingValue:o,options:n.__spreadArrays(s.state.options,u)})}else{s.props.allowFreeform?i?o={data:i,localized:i}:t&&(o={data:t.key,localized:t.text}):o={data:t.key,localized:t.text};if(o){s.props.gridOnChange(o);s.setState({value:o,pendingValue:o})}}}};s.OnRegisteredKeyEvent=function(e){e.keyCode==i.JsGridConstants.Key.space&&s.Expand()};s.Expand=function(){s._comboxBoxRef.current&&s._comboxBoxRef.current.focus(!0,!0)};s._fixedEditorPadding=56;s._editorLetterSize=6.5;s.state={options:s.props.gridOptions,value:s.props.gridValue,pendingValue:s.props.gridValue};s._containerRef=r.createRef();s._comboxBoxRef=r.createRef();s.props.registerForKeyEvents&&s.props.registerForKeyEvents(s);return s}t.prototype.componentWillUnmount=function(){this.state.pendingValue!==this.state.value&&this.props.gridOnChange(this.state.pendingValue);this._isActive=!1};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({value:e.gridValue,pendingValue:e.gridValue})};t.prototype.componentDidMount=function(){this._fixEditorWidth()};t.prototype.componentDidUpdate=function(){this._fixEditorWidth()};t.prototype.render=function(){var e=this.state.value.data,t={root:{borderWidth:0,marginBottom:0},divider:{borderWidth:0,borderBottomWidth:1,borderColor:c.palette.neutralTertiary}};a.default.isFeatureEnabled({ODB:1725})&&(t.root.zIndex=i.JsGridConstants.Internal.zIndex.editor);return r.createElement("div",{ref:this._containerRef},r.createElement(s.ComboBox,n.__assign({},this.props,{options:this.state.options,styles:t,componentRef:this._comboxBoxRef,text:this.state.value.localized,onChange:this.OnValueChanged,onPendingValueChanged:this.OnPendingValueUpdated,selectedKey:e})))};t.prototype._fixEditorWidth=function(){if(this._isActive){if(this.state&&this.state.value&&this.state.value.localized&&this._containerRef&&this._containerRef.current){var e=this._containerRef.current.clientWidth,t=this._fixedEditorPadding+this._editorLetterSize*this.state.value.localized.length,n=0;this.state.pendingValue&&this.state.pendingValue.localized&&(n=this._fixedEditorPadding+this._editorLetterSize*this.state.pendingValue.localized.length);this._containerRef.current.style.width=Math.max(e,Math.max(n,t)).toString()+"px"}if(f.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this._containerRef&&this._containerRef.current&&this._containerRef.current.children&&this._containerRef.current.children.length>0&&this._containerRef.current.children[0]&&this._containerRef.current.children[0].children&&this._containerRef.current.children[0].children.length>0&&this.props.setSelectionFrame(this._containerRef.current.children[0].children[0]);else if(this.props.positionGridSelectionFrame){var r=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(r)}}};return t})(r.PureComponent);t.ChoiceEditor=h});
define("Pze",["require","exports","lC","r","eGe","ce","Bze","Uze","cGe","SPListItemsScopeDeferred_IS_mini_css","Vpe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";f=f.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var c=s.Killswitch.isActivated("DC101D81-F3CE-4E97-8A0D-BA3985B448FC","12/03/2019","Fix an issue with multiple-choice lookup fields."),h=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s.handleScroll=function(e){if(!s.scrollEventTriggered){s.scrollEventTriggered=!0;s.onSaveHandlerOfCommonCalloutEditor(e)}};s.onSaveHandlerOfCommonCalloutEditor=function(e){s.props.onSave(e)};s.onCancelHandlerOfCommonCalloutEditor=function(e){s._setIsXButtonClickedValue();s.props.onCancel(e)};s.resetCurrentTabCount=function(){s.setState({currentTabCount:0},function(){var e=document.getElementById(l.IdOfAcceptButtonInCommonEditorCallout);e&&e.classList.remove(f.buttonBorderFocused);var t=document.getElementById(l.IdOfCancelButtonInCommonEditorCallout);t&&t.classList.remove(f.buttonBorderFocused)})};s.incrementCurrentTabCount=function(){var e=document.getElementById(l.IdOfAcceptButtonInCommonEditorCallout),t=document.getElementById(l.IdOfCancelButtonInCommonEditorCallout);s.setState(function(e,t){return{currentTabCount:e.currentTabCount+1}},function(){switch(s.state.currentTabCount%3){case 0:t&&t.classList.remove(f.buttonBorderFocused);break;case 1:e&&e.classList.add(f.buttonBorderFocused);break;case 2:t&&t.classList.add(f.buttonBorderFocused);e&&e.classList.remove(f.buttonBorderFocused)}})};s.updateWellIndex=function(e,t){switch(e){case i.JsGridConstants.Key.left:s.setState(function(t,n){return{currentWellIndex:s.computeNewWellIndex(e,t.currentWellIndex,t.selectedOptions)}},function(){if(t){var e=document.getElementById("Well-"+s.state.currentWellIndex);e&&e.focus()}});break;case i.JsGridConstants.Key.right:s.setState(function(t,n){return{currentWellIndex:s.computeNewWellIndex(e,t.currentWellIndex,t.selectedOptions)}},function(){if(s.state.currentWellIndex===s.state.selectedOptions.length)s.setState({currentFlyoutIndex:s.state.inputPrefix.length&&s.props.allowFreeform?-1:0},function(){event.preventDefault();document.getElementById(i.JsGridConstants.TextFieldIdInModernChoiceEditor).focus()});else{document.getElementById("Well-"+s.state.currentWellIndex).focus()}})}};s.computeNewWellIndex=function(e,t,n){switch(e){case i.JsGridConstants.Key.left:return Math.max(0,t-1);case i.JsGridConstants.Key.right:return Math.min(t+1,n.length)}};s.updateFlyoutIndexToANumber=function(e){s.setState({currentFlyoutIndex:e})};s.updateWellIndexToANumber=function(e){s.setState({currentWellIndex:e})};s.updateFlyoutIndex=function(e){switch(e){case i.JsGridConstants.Key.up:case i.JsGridConstants.Key.down:s.setState(function(t,n){return{currentFlyoutIndex:s.computeNewFlyoutIndex(e,t.currentFlyoutIndex,t.notYetSelectedOptions)}})}};s.computeNewFlyoutIndex=function(e,t,n){var r=s.state,o=r.inputPrefix,u=r.notYetSelectedOptionsBasedOnInput;switch(e){case i.JsGridConstants.Key.up:return 0===t?o.length>0?-1:n.length-1:-1===t?n.length-1:t-1;case i.JsGridConstants.Key.down:return o.length>0?t===u.length-1?s.props.allowFreeform?-1:0:t+1:t===n.length-1?0:t+1}};s.isFreeformTextRepeated=function(){var e=s.state,t=e.inputPrefix,n=e.pendingValue;return s.countOccurrences(n.localized,t)>1};s.getPendingValueWithoutFreeFormOption=function(){var e=s.state.pendingValue.localized.split(";"),t=e.slice(0,e.length-1).join("; ");return{data:t,localized:t}};s.countOccurrences=function(e,t){return e.split(";").reduce(function(e,n){return n.trim()===t?e+1:e},0)};s.trySaveNewSelectedOptions=function(e,t){if(!s.isOptionAlreadySelected(t)){s._saveOptions(t,!0);s.OnValueChanged(e,t)}};s.isOptionAlreadySelected=function(e){return s.state.selectedOptions.filter(function(t){return t.key===e.key}).length>0};s.OnValueChanged=function(e,t){var r={},i=String(t.key);if(s.props.multiSelect){var o=s.state.value.data,u=s.state.value.localized,a=u&&u.split(";");r.data=[];r.localized="";if(a)for(var f=0;f<o.length;f++)""===o[f]&&Array.isArray(o)&&(o[f]=a[f].trim());if(t.selected){if(null!==t.key)if(o||c){for(f=0;f<o.length;f++)r.data.push(o[f]);r.data.push(i)}else r.data.push(i)}else for(f=0;f<o.length;f++)o[f]!==t.key&&r.data.push(o[f]);for(f=0;f<r.data.length;f++)if(c)r.localized+=r.data[f]+"; ";else{for(var l=!1,h=0;h<s.state.options.length;h++)if(s.state.options[h].key==r.data[f]){r.localized+=s.state.options[h].text+"; ";l=!0;break}l||(r.localized+=r.data[f]+"; ")}var p=r.localized.lastIndexOf(";");r.localized=r.localized.substring(0,p);s.props.gridOnChange(r);s.setState({value:r,pendingValue:r,options:n.__spreadArrays(s.state.options,[])})}else{s.props.allowFreeform?t&&(r=t.selected?{data:String(t.key),localized:t.text}:{data:[],localized:""}):r=t.selected?{data:String(t.key),localized:t.text}:{data:[],localized:""};if(r){s.props.gridOnChange(r);s.setState({value:r,pendingValue:r})}}};s.OnRegisteredKeyEvent=function(e){e.keyCode==i.JsGridConstants.Key.space&&s.Expand()};s.Expand=function(){s._comboxBoxRef.current&&s._comboxBoxRef.current.focus(!0,!0)};s._setIsXButtonClickedValue=function(){s.isXButtonClicked=!0};s._onInputChanged=function(e){var t,n=s.props.allowFreeform;t=s.props.multiSelect&&s.state.value.localized&&s.state.value.localized.length>0?{data:s.state.value.localized+"; "+e,localized:s.state.value.localized+"; "+e}:{data:e,localized:e};s.setState({inputPrefix:e,pendingValue:t,currentFlyoutIndex:e.length>0&&n?-1:0});var r=[],i=s.state.notYetSelectedOptions;if(e){i.forEach(function(t){0===t.text.toLowerCase().lastIndexOf(e.toLowerCase(),0)&&r.push(t)});s.setState({notYetSelectedOptionsBasedOnInput:r})}};s.clearTextFieldValue=function(){s.setState({inputPrefix:"",currentFlyoutIndex:0})};s._saveOptions=function(e,t){var r=s.state,o=r.selectedOptions,u=r.notYetSelectedOptions,a=r.notYetSelectedOptionsBasedOnInput,f=n.__spreadArrays(o),l=n.__spreadArrays(u),c=n.__spreadArrays(a);if(t){var h=s.state.options;0==h.filter(function(t){return t.key==e.key}).length&&h.push({key:e.key,text:e.text});s.setState({options:h,currentFlyoutIndex:s.state.currentFlyoutIndex===u.length-1?Math.max(0,s.state.currentFlyoutIndex-1):s.state.currentFlyoutIndex});if(s.props.multiSelect){f.push(e);l=l.filter(function(t){return t.key!==e.key});c=c.filter(function(t){return t.key!==e.key})}else{f=[e];l=s.state.options.filter(function(t){return t.key!==e.key});c=s.state.options.filter(function(t){return t.key!==e.key})}}else{var p=document.getElementById(i.JsGridConstants.TextFieldIdInModernChoiceEditor);p.focus();var d=s.state.inputPrefix?s.state.inputPrefix.length:0;s.state.inputPrefix&&d>0&&p.setSelectionRange(d,d);s.setState({currentFlyoutIndex:s.state.inputPrefix.length>0&&s.props.allowFreeform?-1:0});l.push(e);0===e.text.toLowerCase().lastIndexOf(s.state.inputPrefix.toLowerCase(),0)&&c.push(e);f=s.props.multiSelect?f.filter(function(t){return t.key!==e.key}):[]}s.setState({currentWellIndex:f.length,selectedOptions:f,notYetSelectedOptions:l,notYetSelectedOptionsBasedOnInput:c})};s.currentlySelectedOptions=[];s.currentNotYetSelectedOptions=s.props.gridOptions;s.isXButtonClicked=!1;s.scrollParent=a.JsGridUtil.Internal.GetScrollParent(s.props.parentNode);s.scrollEventTriggered=!1;s._initializeWellAndFlyoutOptions();s.state={options:s.props.gridOptions,value:s.props.gridValue,pendingValue:s.props.gridValue,selectedOptions:s.currentlySelectedOptions,notYetSelectedOptions:s.currentNotYetSelectedOptions,notYetSelectedOptionsBasedOnInput:s.currentNotYetSelectedOptions,inputPrefix:"",currentFlyoutIndex:0,currentWellIndex:s.currentlySelectedOptions.length,currentTabCount:0};s._containerRef=r.createRef();s._comboxBoxRef=r.createRef();s.props.registerForKeyEvents&&s.props.registerForKeyEvents(s);return s}t.prototype.componentWillUnmount=function(){var e=this.state,t=e.pendingValue,n=e.value,r=e.inputPrefix,i=e.selectedOptions,s=this.props,o=s.allowFreeform,u=s.fieldType,a=s.gridOnChange;if(t!==n&&!this.isXButtonClicked)if(o){if(r.length>0)if("MultiChoice"===u)if(this.isFreeformTextRepeated()){a(this.getPendingValueWithoutFreeFormOption())}else a(t);else"Choice"===u&&0===i.length&&a(t)}else if(0===r.length)a(this.state.pendingValue);else if("MultiChoice"===u){a(this.getPendingValueWithoutFreeFormOption())}this.scrollParent.removeEventListener("scroll",this.handleScroll)};t.prototype.componentDidMount=function(){this._fixEditorWidth();this.scrollParent.addEventListener("scroll",this.handleScroll)};t.prototype.componentDidUpdate=function(){this._fixEditorWidth()};t.prototype.render=function(){var e=this.props,t=e.rowSchema,n=e.rowData,i=e.currentFieldName,s=e.cellHeight,a=e.cellWidth,f=e.fieldType,l=e.allowFreeform,c=e.goBackToSelectMode,h=e.onSave,p=e.onCancel,d=this.state,v=d.selectedOptions,m=d.inputPrefix,g=d.notYetSelectedOptionsBasedOnInput,y=d.notYetSelectedOptions,b=d.currentFlyoutIndex,w=d.currentWellIndex,E=d.currentTabCount;return r.createElement("div",{ref:this._containerRef,style:{height:"100%",width:"100%"}},r.createElement(u.Well,{targetElement:this._containerRef,saveSelectedOptions:this._saveOptions,optionsInWell:v,onValueChanged:this.OnValueChanged,onInputChanged:this._onInputChanged,rowSchema:t,rowData:n,currentFieldName:i,cellHeight:s,cellWidth:a,fieldType:f,allowFillInText:l,trySaveNewSelectedOptions:this.trySaveNewSelectedOptions,currentTextFieldValue:m,updateFlyoutIndex:this.updateFlyoutIndex,optionsInFlyout:m.length>0?g:y,currentFlyoutIndex:b,updateWellIndex:this.updateWellIndex,updateFlyoutIndexToANumber:this.updateFlyoutIndexToANumber,updateWellIndexToANumber:this.updateWellIndexToANumber,clearTextFieldValue:this.clearTextFieldValue,currentWellIndex:w,incrementCurrentTabCount:this.incrementCurrentTabCount,currentTabCount:E,onSaveHandlerOfCommonCalloutEditor:this.onSaveHandlerOfCommonCalloutEditor,onCancelHandlerOfCommonCalloutEditor:this.onCancelHandlerOfCommonCalloutEditor,resetCurrentTabCount:this.resetCurrentTabCount,goBackToSelectMode:c}),r.createElement(o.Flyout,{targetElement:this._containerRef,saveSelectedOptions:this._saveOptions,options:m.length>0?g:y,onValueChanged:this.OnValueChanged,rowSchema:t,rowData:n,currentFieldName:i,fieldType:f,cellWidth:a,goBackToSelectMode:c,onSave:h,onCancel:p,setIsXButtonClickedValue:this._setIsXButtonClickedValue,fillInTextFromWell:m,selectedOptions:v,allowFillInText:l,currentFlyoutIndex:b,updateWellIndex:this.updateWellIndex,updateFlyoutIndexToANumber:this.updateFlyoutIndexToANumber,updateWellIndexToANumber:this.updateWellIndexToANumber,currentWellIndex:w,currentTabCount:E,onCancelHandlerOfCommonCalloutEditor:this.onCancelHandlerOfCommonCalloutEditor,clearTextFieldValue:this.clearTextFieldValue}))};t.prototype._initializeWellAndFlyoutOptions=function(){var e=this;if(this.props.gridValue&&this.props.gridValue.localized){var t=this.props.gridValue.localized.split(";");(t=t.map(function(e){return e.trim()})).map(function(t,n){return e.currentlySelectedOptions.push(void 0===e.props.gridOptions.filter(function(e){return e.key===t})[0]?{key:t,text:t}:e.props.gridOptions.filter(function(e){return e.key===t})[0])});this.currentNotYetSelectedOptions=this.props.gridOptions.filter(function(e){return-1===t.indexOf(e.key)})}};t.prototype._fixEditorWidth=function(){if(this.state&&this.state.value&&this.state.value.localized&&this._containerRef&&this._containerRef.current){var e=this._containerRef.current.clientWidth;this._containerRef.current.style.width=e.toString()+"px"}if(this.props.positionGridSelectionFrame){var t=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(t)}};return t})(r.PureComponent);t.ModernChoiceEditor=h});
define("Bze",["require","exports","lC","r","Ru","Fze","SPListItemsScopeDeferred_IS_mini_css","Vpe","us","Xw","jze","eGe","cGe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";o=o.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.handleClick=function(e,n){n.selected=!0;t.props.saveSelectedOptions(n,!0);t.props.onValueChanged(e,n);t.props.clearTextFieldValue();"Choice"===t.props.fieldType&&t.props.goBackToSelectMode()};t.onSaveHandler=function(e){t.props.onSave(e)};t.onCancelHandler=function(e){t.props.setIsXButtonClickedValue();t.props.onCancel(e)};t.isFocusOnTextFieldOrGridOrFlyoutCallout=function(){var e=document.getElementById(c.JsGridConstants.TextFieldIdInModernChoiceEditor),t=document.activeElement;return!!(e&&t===e||-1!==t.id.indexOf("spgridcontainer")||-1!==t.id.indexOf(c.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout))};t.onClickFillInDiv=function(e){var n=t.props.fillInTextFromWell,r={key:n,text:n};t.handleClick(e,r)};t.isOptionPresentInCallout=function(e,t){for(var n=0;n<t.length;n++){if(t[n].key===e)return!0}return!1};return t}t.prototype.render=function(){var e=this,t=this.props,a=t.rowData,p=t.rowSchema,d=t.currentFieldName,v=t.fieldType,m=t.options,g=t.targetElement,y=t.theme,b=t.cellWidth,w=t.fillInTextFromWell,E=t.allowFillInText,S=t.currentFlyoutIndex,x=t.currentWellIndex,T=t.updateWellIndex,N=t.currentTabCount,C=t.onCancelHandlerOfCommonCalloutEditor,k=[c.JsGridConstants.IdOfCalloutInWellOfModernChoiceEditor,"spgridcontainer_"+h.JsGridUtil.privateWpq,c.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout],L={onSave:this.onSaveHandler,onCancel:"MultiChoice"===v?this.onCancelHandler:void 0,styles:{root:{width:b},calloutMain:{padding:"0 8px 8px 8px"}},gapSpace:4,target:g,isBeakVisible:!1,directionalHint:i.DirectionalHint.bottomLeftEdge,theme:y,doNotLayer:!1,buttonsContainerClassName:o.flyOutButtonsContainer,lightDismissElementsFilter:k,calloutId:c.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout},A=void 0,O=S;if(void 0!==w&&0!==w.length)if(E){if(this.isOptionPresentInCallout(w,this.props.selectedOptions)){A=r.createElement(f.Label,{className:o.fillInLabel},l.default.OptionAlreadyAdded);-1===S&&(O=0)}else{this.isOptionPresentInCallout(w,this.props.options)?-1===S&&(O=0):A=r.createElement("div",{onClick:this.onClickFillInDiv,className:-1===S?o.fillInWrapperDivWithBackground:o.fillInWrapperDiv},r.createElement(f.Label,{className:o.fillInLabel},l.default.AddFillInTextPrefix),r.createElement("div",{className:o.fillInPillDiv},w))}}else 0===m.length&&(A=r.createElement(f.Label,{className:o.fillInLabel},l.default.NoMatchingResults));return r.createElement(u.CommonEditorCallout,n.__assign({},L),r.createElement("div",{role:"listbox"},A,m.map(function(t,n){return r.createElement(s.ChoicePill,{option:t,onClick:e.handleClick,valueToDisplay:t.key,rowData:a,rowSchema:p,currentFieldName:d,customClassName:N%3==0&&n===O&&e.isFocusOnTextFieldOrGridOrFlyoutCallout()?o.pillWithHoverByDefault:o.pill,fieldType:v,pillDivId:"Flyout-"+n,updateWellIndex:T,updateFlyoutIndexToANumber:e.props.updateFlyoutIndexToANumber,updateWellIndexToANumber:e.props.updateWellIndexToANumber,selectedOptions:e.props.selectedOptions,fillInTextFromWell:e.props.fillInTextFromWell,currentWellIndex:x,allowFillInText:E,onCancelHandlerOfCommonCalloutEditor:C,ariaRole:"option"})})))};return t})(r.Component);t.Flyout=a.styled(p,function(){return{}})});
define("Fze",["require","exports","lC","r","EUe","Rze","Hze","nU","nc","eGe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";l=l.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.onKeyUpFired=function(e){e.which===f.JsGridConstants.Key.backspace&&t.props.onClick(e,t.props.option)};t.computeTabIndex=function(){return"Well-"+t.props.currentWellIndex===t.props.pillDivId?0:-1};t.onKeyDownEventFired=function(e){var n,r=t.props.allowFillInText;switch(e.which){case f.JsGridConstants.Key.left:t.props.updateWellIndex(f.JsGridConstants.Key.left,!0);break;case f.JsGridConstants.Key.right:t.props.updateWellIndex(f.JsGridConstants.Key.right,!0);break;case f.JsGridConstants.Key.enter:t.props.onClick(e,t.props.option);break;case f.JsGridConstants.Key.del:e.preventDefault();t.props.onClick(e,t.props.option);break;case f.JsGridConstants.Key.down:(n=document.getElementById(f.JsGridConstants.TextFieldIdInModernChoiceEditor)).focus();t.props.updateFlyoutIndexToANumber(t.props.fillInTextFromWell.length>0&&r?-1:0);t.props.updateWellIndexToANumber(t.props.selectedOptions.length);break;case f.JsGridConstants.Key.tab:e.preventDefault();(n=document.getElementById(f.JsGridConstants.TextFieldIdInModernChoiceEditor)).focus();var i=t.props.fillInTextFromWell?t.props.fillInTextFromWell.length:0;t.props.fillInTextFromWell&&i>0&&n.setSelectionRange(i,i);t.props.updateFlyoutIndexToANumber(t.props.fillInTextFromWell.length>0&&r?-1:0);t.props.updateWellIndexToANumber(t.props.selectedOptions.length);break;case f.JsGridConstants.Key.esc:t.props.onCancelHandlerOfCommonCalloutEditor(e)}};t.onClickChoice=function(e){t.props.onClick(e,t.props.option)};return t}t.prototype.render=function(){var e=this.props,t=e.currentFieldName,n=e.fieldType,u=e.valueToDisplay,f=e.rowSchema,c=e.rowData,h=e.customClassName,p=e.pillDivId,d=e.ariaRole,v="MultiChoice"===n?[u]:u,m=this.changeFieldTypeForMultiChoice(f),g=this.props.showDeleteButton&&s.overridePillFormatterForDeleteButton(o.getCustomFormatterProps(m,this.props.currentFieldName)),y=void 0===m||m.length>0&&void 0===m[0].customFormatter;return r.createElement("div",{onKeyUp:this.onKeyUpFired,onKeyDown:this.onKeyDownEventFired,id:p,tabIndex:this.computeTabIndex(),className:h,onClick:this.onClickChoice,role:d||"button"},y?r.createElement("div",{className:l.innerPillPlainText},this.props.option.key,this.props.showDeleteButton&&r.createElement(a.FontIcon,{iconName:"Cancel",className:l.iconClass})):r.createElement(i.CustomFieldRenderer,{rowSchema:m,rowData:c,currentFieldName:t,currentValueOverride:v,formatterOverride:g}))};t.prototype.changeFieldTypeForMultiChoice=function(e){var t=JSON.parse(JSON.stringify(e));if(t&&t.length>0)for(var n=0;n<t.length;n++)"MultiChoice"!==t[n].fieldType&&"Choice"!==t[n].fieldType||(t[n].fieldType=u.ColumnFieldType.Choice);return t};return t})(r.Component);t.ChoicePill=c});
define("EUe",["require","exports","r","LUe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";i=i.CustomFieldRenderer_2;Object.defineProperty(t,"__esModule",{value:!0});t.CustomFieldRenderer=function(e){var t=n.useRef(null),s=i.spCustomFormatField,o=e.rowData,u=e.rowSchema,a=e.formatterOverride,f=e.currentFieldName,l=e.onErrorRenderer,c=e.currentValueOverride,h=n.useMemo(function(){return r.generatePreviewHtml(e)},[o,u,f,a,c]);return h||!l?n.createElement("div",{ref:t,className:s,dangerouslySetInnerHTML:{__html:h}}):l(e)}});
define("LUe",["require","exports","lC","m7","HN"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t){var r,i=e.rowData,s=e.currentFieldName,o=e.currentValueOverride,u=e.getRowData,a=void 0!==o?((r={})[s]=o,r):{};return n.__assign(n.__assign({},u?u(i,t):i),a)};t.generatePreviewHtml=function(e){var t=e.rowSchema,n=e.currentFieldName,o=e.pageContext,u=void 0===o?window._spPageContextInfo:o,a=e.rowIndex,f=void 0===a?1:a,l=(function(e,t){void 0===t&&(t=[]);for(var n,i={},o=0,u=t;o<u.length;o++){var a=u[o],f=a.internalName,l=a.fieldType,c=a.serverFieldType,h=void 0===c?"":c;if(f)if("_IsRecord"===f)i._IsRecord="_IsRecord";else{i[f]=void 0!==l?r.ColumnFieldType[l]:h;if(e.currentFieldName===f)try{n=e.formatterOverride||JSON.parse(a.customFormatter||"")}catch(e){}}}return{rowData:s(e,i),formatterSchema:i,formatter:n}})(e,t),c=l.rowData,h=l.formatterSchema,p=l.formatter;if(!p)return"";var d={row:c,rowSchema:h,fieldRendererFormat:p,currentFieldName:n,pageContextInfo:u,rowIndex:f};return new i.CustomFormatter(d).evaluate()||""}});
define("Rze",["require","exports","lC","SPListItemsScopeDeferred_IS_mini_css","us"],function(e,t,n,r,i){"use strict";r=r.OverridePillFormatter_4;Object.defineProperty(t,"__esModule",{value:!0});t.overridePillFormatterForDeleteButton=function(e){var t;if(e&&e.children&&e.children[0]&&e.children[0].children){var s=e.children[0],o=i.getRTL()?"padding-left":"padding-right";return n.__assign(n.__assign({},e),{children:[n.__assign(n.__assign({},s),{style:n.__assign(n.__assign({},s.style),(t={position:"relative"},t[o]="24px",t)),children:n.__spreadArrays(s.children||[],[{elmType:"span",attributes:{iconName:"Cancel",class:r.pillDeleteButton}}])})]})}}});
define("Hze",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCustomFormatterProps=function(e,t){for(var n,r=0,i=e;r<i.length;r++){var s=i[r],o=s.internalName;if(s.internalName&&t===o)try{n=JSON.parse(s.customFormatter||"")}catch(e){}}return n}});
define("Uze",["require","exports","lC","r","Ru","SE","Fze","SPListItemsScopeDeferred_IS_mini_css","eGe","us","Vpe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";u=u.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var c={fieldGroup:{maxHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2-1,minHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2-1,border:"none"},root:{maxHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2,minHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2}},h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.handleClick=function(e,t){t.selected=!1;n.props.saveSelectedOptions(t,!1);n.props.onValueChanged(e,t);"Choice"===n.props.fieldType&&n.props.goBackToSelectMode()};n.handleInputChange=function(e,t){n.props.onInputChanged(t)};n.handleTextFieldKeyDownEvent=function(e){var t=n.props,r=t.allowFillInText,i=t.optionsInFlyout,s=t.currentFlyoutIndex,o=t.currentTabCount,u=t.optionsInWell,f=t.currentWellIndex,l=n.state._textfield.value;switch(e.which){case a.JsGridConstants.Key.enter:if(o%3==0){var c=void 0;if(-1===s&&r){c={key:l,text:l,selected:!0};n.props.trySaveNewSelectedOptions(e,c);n.props.clearTextFieldValue();"Choice"===n.props.fieldType&&n.props.onSaveHandlerOfCommonCalloutEditor(e)}else if(i&&i.length>0){c={key:i[s].key,text:i[s].text,selected:!0};n.props.trySaveNewSelectedOptions(e,c);n.props.clearTextFieldValue();"Choice"===n.props.fieldType&&n.props.onSaveHandlerOfCommonCalloutEditor(e)}}else o%3==1?n.props.onSaveHandlerOfCommonCalloutEditor(e):o%3==2&&n.props.onCancelHandlerOfCommonCalloutEditor(e);break;case a.JsGridConstants.Key.backspace:if((void 0===l||0===l.length)&&u&&u.length>0){var h=Math.max(0,f-1);n.props.updateWellIndex(a.JsGridConstants.Key.left,!1);n.props.updateFlyoutIndexToANumber(-2);var p={key:u[h].key,text:u[h].text,selected:!1};n.handleClick(e,p)}break;case a.JsGridConstants.Key.left:var d=document.getElementById(a.JsGridConstants.TextFieldIdInModernChoiceEditor),v=void 0;d&&(v=d.selectionStart);if(0===v){n.props.resetCurrentTabCount();if(u&&u.length>0){n.props.updateWellIndex(a.JsGridConstants.Key.left,!0);n.props.updateFlyoutIndexToANumber(-2)}}break;case a.JsGridConstants.Key.up:n.props.updateFlyoutIndex(a.JsGridConstants.Key.up);break;case a.JsGridConstants.Key.down:n.props.updateFlyoutIndex(a.JsGridConstants.Key.down);n.props.resetCurrentTabCount();break;case a.JsGridConstants.Key.tab:e.preventDefault();"MultiChoice"===n.props.fieldType&&n.props.incrementCurrentTabCount();break;case a.JsGridConstants.Key.esc:n.props.onCancelHandlerOfCommonCalloutEditor(e)}};n.getAriaActiveDescendantValue=function(){switch(n.props.currentTabCount%3){case 0:return"Flyout-"+n.props.currentFlyoutIndex;case 1:return l.IdOfAcceptButtonInCommonEditorCallout;case 2:return l.IdOfCancelButtonInCommonEditorCallout}};n.onMouseDownHandler=function(e){n.props.updateWellIndexToANumber(n.props.optionsInWell.length)};n._getRef=function(e){n.setState({_textfield:e})};n.getCalloutStyles=f.memoizeFunction(function(e){var t=e.theme.palette;return{root:{width:n.props.cellWidth,border:"2px solid "+t.themePrimary,minHeight:n.props.cellHeight,backgroundColor:t.white}}});n.state={_textfield:void 0};return n}t.prototype.componentDidUpdate=function(){if(this.state._textfield){this.state._textfield.focus();document.getElementById(a.JsGridConstants.TextFieldIdInModernChoiceEditor).scrollIntoView()}};t.prototype.render=function(){var e=this,t=this.props,n=t.targetElement,f=t.rowData,l=t.rowSchema,h=t.currentFieldName,p=t.fieldType,d=t.optionsInWell,v=t.allowFillInText,m=t.currentTextFieldValue,g=t.updateWellIndex,y=t.currentWellIndex;return r.createElement(i.Callout,{styles:this.getCalloutStyles,target:n,directionalHint:i.DirectionalHint.leftBottomEdge,coverTarget:!0,isBeakVisible:!1,calloutMaxHeight:Math.max(this.props.cellHeight,200),id:a.JsGridConstants.IdOfCalloutInWellOfModernChoiceEditor,"aria-live":"assertive"},this.props.optionsInWell.map(function(t,n){return r.createElement(o.ChoicePill,{option:t,onClick:e.handleClick,valueToDisplay:t.key,rowData:f,rowSchema:l,currentFieldName:h,customClassName:u.pillNoHoverStyle,fieldType:p,showDeleteButton:!0,pillDivId:"Well-"+n,updateWellIndex:g,updateFlyoutIndexToANumber:e.props.updateFlyoutIndexToANumber,updateWellIndexToANumber:e.props.updateWellIndexToANumber,selectedOptions:d,fillInTextFromWell:m,currentWellIndex:y,allowFillInText:v,onCancelHandlerOfCommonCalloutEditor:e.props.onCancelHandlerOfCommonCalloutEditor})}),r.createElement(s.TextField,{id:a.JsGridConstants.TextFieldIdInModernChoiceEditor,onChange:this.handleInputChange,onKeyDown:this.handleTextFieldKeyDownEvent,componentRef:this._getRef,borderless:!0,styles:c,autoComplete:"off",value:m,placeholder:!1===v||"Choice"===p&&d&&d.length>0?"Type to filter":"Type to filter or add new choice",onMouseDown:this.onMouseDownHandler,"aria-activedescendant":this.getAriaActiveDescendantValue()}))};return t})(r.Component);t.Well=h});
define("Lze",["require","exports","lC","r","kze","Vpe","ju"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isActive=!0;n.OnDisplayValueChanged=function(e,t){var r=n.props.onValueChange;if(n._isActive&&r){r({address:n.state.address,display:t});n.setState({display:t})}};n.OnUrlValueChanged=function(e,t){var r=n.props.onValueChange;if(n._isActive&&r){r({address:t,display:n.state.display});n.setState({address:t})}};n.state={address:t.currentUrlValue,display:t.currentDisplayValue};return n}t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this.props,t=e.onEditorKeyDown,u=e.onEditorMouseDown,a=e.calloutProps,f=this.state,l=f.address,c=f.display;return r.createElement(o.FocusTrapZone,{isClickableOutsideFocusTrap:!0},r.createElement(s.CommonEditorCallout,n.__assign({},a,{setInitialFocus:!0}),r.createElement(i.HyperlinkControl,n.__assign({},this.props,{linkText:l,displayText:c,onLinkTextChange:this.OnUrlValueChanged,onDisplayTextChange:this.OnDisplayValueChanged,onKeyDown:t,onMouseDown:u,style:{width:"288px"}}))))};return t})(r.PureComponent);t.HyperlinkEditor=u});
define("kze",["require","exports","lC","r","SE","us","Mze"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={root:{paddingBottom:8},subComponentStyles:{label:{root:{paddingTop:0}}}};t.HyperlinkControl=r.memo(function(e){var t=s.getNativeProps(e,s.divProperties);return r.createElement("div",n.__assign({},t),r.createElement(i.TextField,{label:o.default.Link,styles:u,value:e.linkText,onChange:e.onLinkTextChange,placeholder:o.default.LinkPlaceholder}),r.createElement(i.TextField,{label:o.default.Display,value:e.displayText,onChange:e.onDisplayTextChange,placeholder:o.default.DisplayPlaceholder}))})});
define("Eze",["require","exports","lC","r","SE","SPListItemsScopeDeferred_IS_mini_css","s9","eGe"],function(e,t,n,r,i,s,o,u){"use strict";s=s.NumberEditor_5;Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isActive=!0;n._renderPrefix=function(e){return r.createElement("span",{className:s.numberEditorUnit},e.prefix)};n._renderSuffix=function(e){return r.createElement("span",{className:s.numberEditorUnit},e.suffix)};n.OnDisplayValueChanged=function(e,t){var r=n.props.onValueChange;if(n._isActive&&r){r(t);n.setState({value:t})}};n.state={value:t.currentValue};n._inputRef=r.createRef();return n}t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.componentDidMount=function(){this._inputRef&&this._inputRef.current.focus()};t.prototype.render=function(){var e=this.state.value,t=this.props,s=t.unit,a=t.customUnitName,f=t.customUnitOnRight,l=t.height,c=t.width,h=t.onSave,p=t.onEditorMouseDown,d=t.onEditorKeyDown,v=t.className,m=o.isUnitSuffix(s,f),g=!m&&"None"!==s,y=o.getUnitString(s,a),b={suffix:m?y:void 0,onRenderSuffix:m?this._renderSuffix:void 0,prefix:g?y:void 0,onRenderPrefix:g?this._renderPrefix:void 0},w={padding:0,maxWidth:"40%"},E={fieldGroup:{height:l,width:c,zIndex:u.JsGridConstants.Internal.zIndex.editor},field:{textOverflow:"clip"},suffix:[m&&w],prefix:[g&&w]};return r.createElement(i.TextField,n.__assign({},b,{inputClassName:v,value:e,borderless:!0,validateOnLoad:!1,onChange:this.OnDisplayValueChanged,onBlur:h,onMouseDown:p,onKeyDown:d,componentRef:this._inputRef,styles:E}))};return t})(r.PureComponent);t.NumberEditor=a});
define("Cze",["require","exports","lC","r","Vpe","zce","ju","cGe","wze","SPListItemsScopeDeferred_IS_mini_css","Hs"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";f=f.DateEditor_5;Object.defineProperty(t,"__esModule",{value:!0});t.DayPickerStrings={months:[a.default.January,a.default.February,a.default.March,a.default.April,a.default.May,a.default.June,a.default.July,a.default.August,a.default.September,a.default.October,a.default.November,a.default.December],shortMonths:[a.default.ShortJanuary,a.default.ShortFebruary,a.default.ShortMarch,a.default.ShortApril,a.default.ShortMay,a.default.ShortJune,a.default.ShortJuly,a.default.ShortAugust,a.default.ShortSeptember,a.default.ShortOctober,a.default.ShortNovember,a.default.ShortDecember],days:[a.default.Sunday,a.default.Monday,a.default.Tuesday,a.default.Wednesday,a.default.Thursday,a.default.Friday,a.default.Saturday],shortDays:[a.default.ShortSunday,a.default.ShortMonday,a.default.ShortTuesday,a.default.ShortWednesday,a.default.ShortThursday,a.default.ShortFriday,a.default.ShortSaturday],goToToday:a.default.GoToToday,prevMonthAriaLabel:a.default.PrevMonth,nextMonthAriaLabel:a.default.NextMonth};var c=(function(e){n.__extends(c,e);function c(t){var n=e.call(this,t)||this;n._onSelectDate=function(e){var t=n.props,r=t.onValueChange,i=t.dateOnly,s=t.currentCultureName,o=n.state.time;if(r)if(i){r(e);l.Engagement.logData({name:"QuickEdit.CalendarType.Gregorian"});var u=e.toLocaleDateString(s);n.setState({dateTime:u})}else{r(e=n._setTime(o,e));var a=n._getDateTimeString(e);n.setState({dateTime:a})}n.setState({date:e})};n._onTimeChange=function(e){var t=n.props.onValueChange,r=n.state.date,i=e.target.value;if(t){var s=r;s||(s=new Date);t(s=n._setTime(i,s));var o=n._getDateTimeString(s);n.setState({date:s,dateTime:o})}n.setState({time:i})};n._onTextInputChange=function(e){var t=n.props.onInputValueChange,r=e.target.value;t&&t(r);n.setState({dateTime:r})};n._inputRef=r.createRef();n.state={date:n.props.date,time:n.props.time||"00:00",dateTime:n.props.dateTime};return n}c.prototype.render=function(){var e=this.props,l=e.onInputKeyDown,c=e.calloutProps,h=e.dateOnly,p=e.inputProps,d=this.state,v=d.date,m=d.time,g=d.dateTime;return r.createElement(o.FocusTrapZone,{isClickableOutsideFocusTrap:!0},r.createElement("input",{type:"text",value:g,ref:this._inputRef,className:f.quickEditDateTimeEditorInput,style:{height:p.height-8,width:p.width-16},onChange:this._onTextInputChange,"aria-label":h?a.default.Date:a.default.DateTime,onKeyDown:l}),r.createElement(i.CommonEditorCallout,n.__assign({},c,{target:this._inputRef}),r.createElement(s.Calendar,{strings:t.DayPickerStrings,firstDayOfWeek:u.JsGridUtil.SpRegionalSettings.firstDayOfWeek,firstWeekOfYear:u.JsGridUtil.SpRegionalSettings.firstWeekOfYear,showGoToToday:!1,isDayPickerVisible:!0,isMonthPickerVisible:!1,placeholder:a.default.datePlaceHolder,onSelectDate:this._onSelectDate,value:v,id:"quickEditDateTimeEditor",className:f.quickEditDateTimeEditor}),!h&&r.createElement("input",{type:"time",onChange:this._onTimeChange,value:m,className:f.quickEditDateTimeEditorTimeInput})))};c.prototype._setTime=function(e,t){var n=e.split(":");if(n.length>1){var r=n[0],i=n[1];r&&t.setHours(Number(r));i&&t.setMinutes(Number(i))}return t};c.prototype._getDateTimeString=function(e){var t=this.props.currentCultureName;return e.toLocaleDateString(t)+" "+e.toLocaleTimeString(t,{hour:"2-digit",minute:"2-digit"})};return c})(r.PureComponent);t.DateEditor=c});
define("xze",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createSPPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t}});
define("NPe",["require","exports","r","us","SPListItemsScopeDeferred_IS_mini_css","F_"],function(e,t,n,r,i,s){"use strict";i=i.Field_7;Object.defineProperty(t,"__esModule",{value:!0});t.UserField=function(e){var t=e.users,o=e.isAnonymous,u=e.isDisabled;return t&&t.length?o?n.createElement("div",null,t.map(function(e,t){return n.createElement("div",{key:t},n.createElement(s.BaseText,{isDisabled:u,text:e.title}))})):n.createElement("div",null,t.map(function(e,t){return n.createElement(s.BaseText,{isDisabled:u,key:t,dir:"auto",className:r.css(""+i.field,""+i.nofill),text:e.title})})):null}});
define("Dze",["require","exports","lC","r","r","bTe","cTe","iTe","A","SPListItemsScopeDeferred_IS_mini_css","cGe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";f=f.LocationEditor_1;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._picker=i.createRef();r._containerRef=i.createRef();r._isActive=!0;r._resolveItem=function(e){return e&&e.LocationUri?r._dataSource.resolveLocationFromBingUri(e.LocationUri).then(function(t){if(t){var r=n.__assign(n.__assign({},e.Address),t.Address);if(e.Address){for(var i in r)!r[i]&&e.Address[i]&&(r[i]=e.Address[i]);t.Address=r}return t}return e}):Promise.resolve(e)};r._resolveSuggestions=function(e){return r._dataSource.search(e).then(function(t){return r._hasFillIn()?t.concat([{DisplayName:e,EntityType:"Custom"}]):t}).catch(function(e){e&&"Canceled"!==e.name&&r.setState({error:e});return[]})};r._onItemsChange=function(e){if(r._isActive){var t,n=r.props.onChange;r.setState({selectedLocation:e});if(r.state.selectedLocation){var i=r.state.selectedLocation;t="Custom"===i.EntityType?new a.Qos({name:"QuickEditSaveUnresolvedLocation"}):i.Address&&i.Address.Street&&i.Address.City&&i.Address.State&&i.Address.CountryOrRegion&&i.Address.PostalCode&&i.Coordinates?new a.Qos({name:"QuickEditSaveFullLocation"}):new a.Qos({name:"QuickEditSaveSparseLocation"})}else t=new a.Qos({name:"QuickEditSaveRemoveLocation"});try{n&&n(e);t.end({resultType:a.ResultTypeEnum.Success})}catch(e){t.end({resultType:a.ResultTypeEnum.Failure,error:e})}}};r._dataSource=r._getDataSource(t);r.state={selectedLocation:t.defaultLocation};return r}t.prototype._updateGridSelectionFrame=function(){if(l.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}};t.prototype.componentDidMount=function(){this._picker.current&&this._picker.current.focus();this._updateGridSelectionFrame()};t.prototype.componentDidUpdate=function(){this._updateGridSelectionFrame()};t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this,t=this.props,i=t.onEditorKeyDown,s=t.onEditorMouseDown,a=this.state.selectedLocation;return r.createElement("span",{onKeyDown:i,onMouseDown:s,ref:this._containerRef},r.createElement(o.LocationPicker,n.__assign({},this.props,{defaultLocation:a,onChange:this._onItemsChange,className:f.locationEditor,resolveLocations:this._resolveSuggestions,placeHolder:u.default.locationEditorPlaceHolder,onItemSelected:this._resolveItem,strings:{useCustomLocation:u.default.useLocationCustomValueTag},componentRef:this._picker,allowCustomLocations:this._hasFillIn(),onFocus:function(){return e._updateGridSelectionFrame()}})))};t.prototype.getData=function(){var e=this.state.selectedLocation;return e?JSON.stringify(e):""};t.prototype._shouldSaveDataOnEnter=function(){return!1};t.prototype._getAriaLabelDataString=function(){if(this.state.selectedLocation)return this.state.selectedLocation.DisplayName};t.prototype._hasFillIn=function(){return!0};t.prototype._getPlaceHolderString=function(){return u.default.locationEditorPlaceHolder};t.prototype._getDataSource=function(e){return e&&e.dataSource?e.dataSource:new s.LocationDataSource({pageContext:e.pageContext})};return t})(r.PureComponent);t.LocationEditor=c});
define("bTe",["require","exports","lC","vTe","gTe","b9"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("vTe",["require","exports","lC","Fe","Wte","Vte","nk","ce"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.LocalServices=8]="LocalServices";e[e.Relevance=16]="Relevance";e[e.BingAutoSuggest=32]="BingAutoSuggest";e[e.Default=48]="Default"})(t.LocationProvider||(t.LocationProvider={}));var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{dataSourceName:"LocationDataSource"},{pageContext:t.pageContext})||this;n._getLocations=function(e){for(var t=[],n=0,r=JSON.parse(e).MeetingLocations;n<r.length;n++){var i=r[n];t.push(i.MeetingLocation)}return t};n._getUrl=function(){return u.Killswitch.isActivated("2618A760-9346-458E-B67E-604157417CDC","03/31/2020","Update location API url")?"https://outlook.office365.com/Scheduling/api/v1.0/me/findmeetinglocations":"https://outlook.office365.com/SchedulingB2/api/v1.0/me/findmeetinglocations"};n._tokenProvider=t.tokenProvider?t.tokenProvider:new i.default(null,{oAuthTokenDataSource:new s.default(t.pageContext)});return n}t.prototype.search=function(e,t){return this._search({QueryConstraint:{Query:e},LocationProvider:32,BingMarket:this._pageContext.currentCultureName},t)};t.prototype.resolveLocationFromBingUri=function(e){return this._search({QueryConstraint:{Query:"",Id:e,ResolveAvailability:!1},LocationProvider:8,BingMarket:this._pageContext.currentCultureName}).then(function(e){return e&&e.length>0&&e[0]})};t.prototype._search=function(e,t){var n=this;return new r.default(function(r){n._getAdditionalHeaders(t).then(function(t){r(n.getData(n._getUrl,n._getLocations,"GetLocations",function(){return JSON.stringify(e)},"Post",t,void 0,void 0,!0,!0))})})};t.prototype._getAdditionalHeaders=function(e){var t=this,n=e||this._pageContext.userEmail;return new r.default(function(e){t._token?e({authorization:"Bearer "+t._token,"x-findmeetinglocations-appname":"sharepoint","X-AnchorMailbox":n,"x-findmeetinglocations-appscenario":"locationfield"}):t._tokenProvider.getToken("https://outlook.office365.com").then(function(r){t._token=r;e({authorization:"Bearer "+r,"x-findmeetinglocations-appname":"sharepoint","X-AnchorMailbox":n,"x-findmeetinglocations-appscenario":"locationfield"})})})};return t})(o.default);t.LocationDataSource=a});
define("gTe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.Default="Default";e.ConferenceRoom="ConferenceRoom";e.LocalBusiness="LocalBusiness";e.PostalAddress="PostalAddress";e.Custom="Custom"})(t.LocationType||(t.LocationType={}))});
define("cTe",["require","exports","lC","r","r","SU","am","lTe","us","ce","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(s.BasePicker);t.BaseLocationPicker=l;t.LocationItemRenderer=function(e){var t=e.index,i=e.onRemoveItem,s=e.removeButtonAriaLabel;return r.createElement("div",{"data-selection-index":t,"data-is-focusable":!0,key:t,role:"listitem",className:a.css("ms-PickerItem-container","ms-LocationPicker-item",e.selected&&"is-selected")},r.createElement("div",{className:"ms-PickerItem-content"},r.createElement(u.LocationToken,n.__assign({},e.item))),r.createElement("span",null,r.createElement(o.IconButton,{onClick:i,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content ms-PickerItem-removeButton","data-is-focusable":!1,ariaLabel:s})))};var c=(function(e){n.__extends(o,e);function o(t){var o=e.call(this,t)||this;o._picker=i.createRef();o._onRenderSuggestionsItem=function(e){var t,i=o._getTokenDisplayText(e);if("Custom"!==e.EntityType)t=r.createElement(u.LocationToken,n.__assign({},e,{className:"ms-Location-suggestionPickerToken",DisplayName:i}));else{if(!o.props.strings.useCustomLocation)return null;t=r.createElement(u.LocationToken,n.__assign({},e,{className:"ms-Location-suggestionPickerToken",DisplayName:o.props.strings.useCustomLocation,addressString:i}))}return r.createElement("div",{className:"ms-Location-suggestionTokenContainer"},t)};o._getTokenDisplayText=function(e){return e.DisplayName||e.Address&&e.Address.Street};o._validateInput=function(e){return f.Killswitch.isActivated("3F535709-34A1-402D-849D-6C8A1E97EBDE","03/27/2020","Do not create item for empty input in LocationPicker")||e?s.ValidationState.valid:s.ValidationState.invalid};o._onItemsChange=function(e){var t=e&&e[0];o.props.onChange&&o.props.onChange(t);o.setState({selectedLocation:e.length>0?e[0]:null},function(){return o.focus()})};o.state={selectedLocation:t.defaultLocation};return o}o.prototype.focus=function(){this._picker.current&&(this.state.selectedLocation?this._picker.current.focus():this._picker.current.focusInput());this.props.onFocus&&this.props.onFocus()};o.prototype.render=function(){return r.createElement(l,{"data-automationid":"LocationPicker",selectedItems:this.state.selectedLocation?[this.state.selectedLocation]:[],onChange:this._onItemsChange,className:a.css("Location-Picker",this.props.className),onResolveSuggestions:this.props.resolveLocations,onRenderItem:function(e){return r.createElement(t.LocationItemRenderer,n.__assign({},e))},onItemSelected:this.props.onItemSelected,onRenderSuggestionsItem:this._onRenderSuggestionsItem,createGenericItem:this.props.allowCustomLocations?this._createGenericItem:void 0,onValidateInput:this.props.allowCustomLocations?this._validateInput:void 0,inputProps:{placeholder:this.props.placeHolder,"aria-label":this.props.ariaLabel},pickerSuggestionsProps:{className:"Location-Picker-Suggestions"},itemLimit:1,resolveDelay:200,componentRef:this._picker,onBlur:this.props.onBlur})};o.prototype._createGenericItem=function(e,t){return{item:{DisplayName:e},selected:!1}};return o})(a.BaseComponent);t.LocationPicker=c});
define("lTe",["require","exports","r","MU","nc","fTe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});t.LocationToken=function(e){return n.createElement(r.Persona,{text:e.DisplayName||e.Address&&e.Address.Street,secondaryText:e.addressString?e.addressString:s.getAddress(e.Address),size:r.PersonaSize.size40,"data-is-focusable":!1,imageInitials:e.EntityType,onRenderInitials:t.LocationTokenIcon,className:e.className,onClick:e.onClick})};t.LocationTokenMap=((o={}).ConferenceRoom="Room",o.Custom="Poi",o.Default="EMI",o.LocalBusiness="EMI",o.PostalAddress="EMI",o);t.LocationTokenIcon=function(e){var r=t.LocationTokenMap[e.imageInitials]||"EMI";return n.createElement(i.Icon,{iconName:r,className:"Location-personaIcon"})}});
define("fTe",["require","exports","nc","r","pe","us","mTe","ce","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LocationAddress=function(e){if(e.Street||e.State||e.CountryOrRegion||e.PostalCode||e.City){if(u.Killswitch.isActivated("696c58bb-75fc-4a59-bff7-ac7ca7301102","05/13/2020","render compacted Location")){var t=a(e);return r.createElement("div",{className:s.css("Location-addressContainer",e.className)},r.createElement(n.Icon,{iconName:"Poi"}),r.createElement("div",{className:"Location-addressText"},t))}var i=a(e,1),o=a(e,2);return r.createElement("div",{className:s.css("Location-addressContainer-noIcon",e.className)},r.createElement("div",{className:"Location-addressText"},i),r.createElement("div",{className:"Location-addressText"},o))}return null};function a(e,t){if(e){var n=i.format(o.default.locationAddress,e.Street||"",e.City||"",e.State||"",e.CountryOrRegion||"").split(",");if(u.Killswitch.isActivated("696c58bb-75fc-4a59-bff7-ac7ca7301102","05/13/2020","render compacted Location"))return n.reduce(function(e,t){return e?t?e+", "+t:e:t});n.reduce(function(e,t){return e?t?e+", "+t:e:t});return t?1===t?n[0]:n.slice(1).join(", "):n.join()}return null}t.getAddress=a});
define("vze",["require","exports","lC","r","Sze","r","am","MTe","Zne","_ne","wTe","xTe","ITe","us","Cv","Ih","ce","cGe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";y=y.TaxonomyEditor_2;Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._taxonomyPicker=s.createRef();n._root=s.createRef();n._isActive=!0;n.showClassicTaggingTree=function(){n.setState({forceClassicTree:!0,taxonomyTreeOpen:!0})};n._resolveSuggestions=function(e){return n._dataManager.resolveSuggestions(e,n.state.queryParams).then(function(e){return h.TaxonomyEditorDataManager.filterTaggedTerms(e,n.state.selectedTerms)}).catch(function(e){return[]})};n._onPickerItemsChange=function(e){for(var t=S(n.state.selectedTerms,e),r=1;r<=t;r++)w("TaxonomyPickerInQuickEditUpdated");n._onItemsChange(e)};n._onItemsChange=function(e){if(n._isActive){n.setState({selectedTerms:e},function(){0===e.length&&n._focus();n._validateTerms(e)});n.props.onItemsChange&&n.props.onItemsChange(e);n._updateGridSelectionFrame()}};n._launchTree=function(e){if(!n.state.taxonomyTreeOpen){v.Engagement.logData({name:"QuickEditLaunchTaxonomyTree",isIntentional:!0});n.setState({taxonomyTreeOpen:!0})}};n._dismissTree=function(){n.state.taxonomyTreeOpen&&n.setState({taxonomyTreeOpen:!1},n._focus)};n.handleTreeDialogResults=function(e){if(e){var t=e.value;try{var r=t.split(f.TERM_DELIMITER).map(function(e){var t=e.split(f.LABEL_ID_DELIMITER),n=t[1]!==f.INVALID_TERM_ID;return{term:{label:t[0],termId:t[1],isValid:n},isSynonym:!1,completions:[],start:"",state:n?1:2}});if(0===r.filter(function(e){return!e.term.isValid}).length){n.setState({selectedTerms:r,taxonomyTreeOpen:!1},n._focus);n.props.onItemsChange&&n.props.onItemsChange(r);n._updateGridSelectionFrame()}}catch(e){}}else n.setState({taxonomyTreeOpen:!1},n._focus)};n._dataSource=t.dataSource||new c.TaxonomyDataSource(t.pageContext);n._dataProvider=new c.TaxonomyProvider({},{dataSource:n._dataSource});n._dataManager=new h.TaxonomyEditorDataManager({dataProvider:n._dataProvider,dataSource:n._dataSource});n._async=new p.Async;var r=t.schema,i={lcid:r.Lcid||1033,sspList:r.SspId,termSetList:r.TermSetId,anchorId:r.AnchorId||f.INVALID_TERM_ID,excludedTermset:f.INVALID_TERM_ID,isSpanTermStores:r.IsSpanTermStores||!1,isSpanTermSets:r.IsSpanTermSets||!1,isIncludeUnavailable:!1,isIncludeDeprecated:!1,isAddTerms:r.IsAddTerms||!1,isIncludePathData:!1,excludeKeyword:!r.Name&&"TaxKeyword"!==r.Name,isUseCommaAsDelimiter:"boolean"!=typeof r.IsUseCommaAsDelimiter||r.IsUseCommaAsDelimiter,isIncludeTermSetName:!1,webServiceUrl:r.WebServiceUrl,allowFillIn:"boolean"!=typeof r.AllowFillIn||r.AllowFillIn};n.state={queryParams:i,selectedTerms:t.selectedTerms,taxonomyTreeOpen:!1,serverTerms:t.selectedTerms};return n}t.prototype._updateGridSelectionFrame=function(){if(g.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._root.current);else{var e=this._root.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}};t.prototype.componentDidMount=function(){this._taxonomyPicker.current&&this._taxonomyPicker.current.focus();this._updateGridSelectionFrame()};t.prototype.componentDidUpdate=function(){this._updateGridSelectionFrame()};t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this.props,t=e.onEditorKeyDown,n=e.onEditorMouseDown,s=e.schema,f=e.onBlur,c=s.AllowMultipleValues?void 0:1,h=this.state.queryParams&&!this.state.queryParams.isSpanTermSets,p=this._isQuickEditVisualRefreshFlightEnabled?" "+y.increaseZIndex:"";return r.createElement("span",{onKeyDown:t,onMouseDown:n,ref:this._root,className:y.taxonomyEditorSpan+p},r.createElement(a.TaxonomyPicker,{selectedTerms:this.state.selectedTerms,onItemsChange:this._isTelemetryEnabledForChangesInPicker?this._onPickerItemsChange:this._onItemsChange,className:"taxonomyEditor-Picker",containerClassName:"taxonomyEditor-TaxonomyPicker",resolveSuggestions:this._resolveSuggestions,termLimit:c,ref:this._taxonomyPicker,"aria-required":this._isRequiredField(),onBlur:f}),h&&r.createElement(o.ActionButton,{"aria-hidden":this._isNarrationForTagIconEnabled?void 0:"true","aria-label":this._isNarrationForTagIconEnabled?i.default.AriaLabelForTagIcon:void 0,iconProps:{iconName:"tag"},onClick:this._launchTree}),h&&this._isModernTaggingToBeDisplayed&&r.createElement(l.TaxonomyTaggingPanel,{onDismiss:this._dismissTree,title:s.Title,onItemsChange:this._onItemsChange,selectedTerms:this.state.selectedTerms,queryParams:this.state.queryParams,pageContext:this.props.pageContext,dataSource:this._dataSource,termLimit:c,isRequiredField:this._isRequiredField(),isPanelOpen:this.state.taxonomyTreeOpen,getOAuthToken:this.props.getOAuthToken,showClassicTaggingTree:this.showClassicTaggingTree}),h&&this.state.taxonomyTreeOpen&&!this._isModernTaggingToBeDisplayed&&r.createElement(u.TaxonomyTreePicker,{taxonomyTreeUrl:this.getTaxonomyTreeUrl(),resultHander:this.handleTreeDialogResults,onDismiss:this._dismissTree,title:s.Title}))};t.prototype._focus=function(){this._taxonomyPicker.current&&this._taxonomyPicker.current.focus()};t.prototype._isRequiredField=function(){return this.props.schema&&this.props.schema.Required};t.prototype._validateTerms=function(e){var t=this;this._timeout&&this._async.clearTimeout(this._timeout);this._timeout=this._async.setTimeout(function(){t._getValidatedTerms(e).then(function(e){t.setState({selectedTerms:e})})},300)};t.prototype._getValidatedTerms=function(e){return e.some(function(e){return 1!==e.state})?this._dataManager.validateTerms(this.state.queryParams,e):Promise.resolve(e)};t.prototype.getTaxonomyTreeUrl=function(){return this._dataSource.getTaxonomyTreeUrl(this.convertToTermsRawString(this.state.selectedTerms),{name:this.props.schema.Name,id:this.props.schema.Id,isMulti:this.props.schema.AllowMultipleValues},this.state.queryParams)};t.prototype.convertToTermsRawString=function(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(1===r.state){t+=r.term.label+f.LABEL_ID_DELIMITER+r.term.termId;n<e.length-1&&(t+=f.TERM_DELIMITER)}}return t};t.prototype._getTermsAsServerString=function(){return this.state.selectedTerms.reduce(function(e,t){return e+t.term.label+f.LABEL_ID_DELIMITER+t.term.termId+f.TERM_DELIMITER},"")};t.prototype.getData=function(){return this._getTermsAsServerString()};t.prototype._shouldSaveDataOnEnter=function(){return!1};Object.defineProperty(t.prototype,"_isModernTaggingToBeDisplayed",{get:function(){return this._isClassicTreeToBeShownForcefullyAllowed?!this.state.forceClassicTree&&(this._isModernTaggingIgniteFlightEnabled||this._isModernTaggingQuickEditGAFlightEnabled)&&this._isOauthCallbackDefined:(this._isModernTaggingIgniteFlightEnabled||this._isModernTaggingQuickEditGAFlightEnabled)&&this._isOauthCallbackDefined},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isOauthCallbackDefined",{get:function(){return E(this.props.getOAuthToken)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isClassicTreeToBeShownForcefullyAllowed",{get:function(){return d.default.isFeatureEnabled({ODB:1910})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isModernTaggingIgniteFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1659})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isModernTaggingQuickEditGAFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1842})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isQuickEditVisualRefreshFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1725})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isNarrationForTagIconEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:307})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isTelemetryEnabledForChangesInPicker",{get:function(){return!m.Killswitch.isActivated("3635202a-20b2-4274-ad59-079e4c6e33c5","06/17/2020","Adding Telemetry whenever taxonomy picker is updated by user")},enumerable:!0,configurable:!0});return t})(r.PureComponent);t.TaxonomyEditor=b;function w(e){v.Engagement.logData({name:e,isIntentional:!0})}function E(e){if(m.Killswitch.isActivated("9d964d2e-efe9-4b47-9bf4-d9c9e2b93b03","06/08/2020","Show classic tree when oauth token is not passed")){w("ModernTaggingTreeOpenAttemptedWithoutCheckingOAuthCallback");return!0}var t=void 0!==e,n="ModernTaggingTreeOpenAttemptedWithOAuthCallback";t||(n="ModernTaggingTreeOpenAttemptedWithoutOAuthCallback");w(n);return t}t.isOauthCallbackDefined=E;function S(e,t){if(!t&&!e)return 0;if(!t)return e.length;if(!e)return t.length;if(e.length>t.length)return S(t,e);for(var n={},r=0,i=e;r<i.length;r++){n[(a=i[r]).term.termId]=a}for(var s=0,o=0,u=t;o<u.length;o++){var a;n[(a=u[o]).term.termId]||s++}return s}t.getCountOfUpdatedTerms=S});
define("MTe",["require","exports","lC","r","r","kw","Zd","us","S7","PTe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._iFrame=i.createRef();n.iframeOnLoad=function(e){var t=e.target;if(t&&t.contentWindow){var r=t.contentWindow.document,i=a.default.getElementByTagAndPartialId(r,"input","OkButton"),s=a.default.getElementByTagAndPartialId(r,"input","CancelButton");if(i&&s){if(!i.onclickListenerAdded){i.onclickListenerAdded=!0;n._events.on(i,"click",function(e){var t=a.default.getElementByTagAndPartialId(r,"input","FieldEditorHiddenInput");n.props.resultHander(t)})}if(!s.onclickListenerAdded){s.onclickListenerAdded=!0;n._events.on(s,"click",function(e){n.props.resultHander(null);e.stopPropagation();e.preventDefault()})}}n.setInnerDialogStyle(r);n._async.setTimeout(function(){var e=t.style.height;e&&"0px"!==e||(e=.618*document.body.clientHeight+"px");n.setState({loading:!1,iFrameStyle:{height:e}})},200)}};n.state={loading:!0};return n}t.prototype.render=function(){return r.createElement(s.Dialog,{hidden:!1,modalProps:{containerClassName:"ms-TreePicker-dialog"},title:f.default.WebTaggingDialogTitle+this.props.title,onDismiss:this.props.onDismiss},this.state.loading&&r.createElement("div",{className:"ms-TreePicker-dialogSpinner"},r.createElement(o.Spinner,{label:f.default.TaxonomyTreeLoadingLabel}," ")),r.createElement("iframe",{className:"ms-TreePicker-iFrame",ref:this._iFrame,src:this.props.taxonomyTreeUrl,onLoad:this.iframeOnLoad,style:this.state.iFrameStyle,sandbox:"allow-same-origin allow-scripts"}))};t.prototype.componentWillUnmount=function(){this._iFrame.current&&(this._iFrame.current.src="")};t.prototype.setInnerDialogStyle=function(e){var t=e.getElementById("FieldEditoreditableRegion");if(t){t.parentElement.style.width="100%"}};return t})(u.BaseComponent);t.TaxonomyTreePicker=l});
define("wTe",["require","exports","lC","r","r","us","pd","One","bw","am","Ee","xTe","ITe","Ih","ATe","_ne","Cv","ce","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.componentClassName="ms-TaggingPanel";var y=(function(e){n.__extends(s,e);function s(n){var s=e.call(this,n)||this;s._taxonomyPicker=i.createRef();s._onRenderFooterContent=function(){var e=s.state.selectedTerms.some(function(e){return 1!==e.state})||s.props.isRequiredField&&0===s.state.selectedTerms.length,n=r.createElement(r.Fragment,null,r.createElement(f.PrimaryButton,{text:d.default.ApplyButtonLabel,className:t.componentClassName+"-ApplyButton",onClick:s._handleClickApplyButton,style:{marginRight:"8px"},disabled:e}),r.createElement(f.DefaultButton,{text:d.default.CancelButtonLabel,className:t.componentClassName+"-CancelButton",onClick:s._handleClickCancelButton}));return s._isReturnToClassicTreeOptionToBeShown?r.createElement(r.Fragment,null,r.createElement("div",null,n),r.createElement("p",null,r.createElement(o.Link,{onClick:s._handleShowClassicTree},d.default.ShowClassicTree))):n};s._handleClickCancelButton=function(){s._log("ClickCancelButton");s.props.onDismiss&&s.props.onDismiss()};s._handleShowClassicTree=function(){s._log("ReturnToClassicTreeClicked");s._saveStateAndClosePanel();s.props.showClassicTaggingTree()};s._handleClickApplyButton=function(){s._log("ClickApplyButton");s._saveStateAndClosePanel()};s._onItemsChange=function(e){var t=s.state.selectedTerms;s._updateTaxonomyPicker(t,e)};s._resolveSuggestions=function(e){return s._dataManager.resolveSuggestions(e,s.props.queryParams).then(function(e){return h.TaxonomyEditorDataManager.filterTaggedTerms(e,s.state.selectedTerms)}).catch(function(e){return[]})};s.convertToTreeNode=function(e,t,n,r){void 0===n&&(n="en-US");void 0===r&&(r="en-US");return{key:u.getNodeKey(e,t),id:e.id,type:t,name:u.getLabel(e,t,n,r),isDisabled:g.Killswitch.isActivated("665be32c-2b5d-40a8-9fc7-83e3248be1ac","05/22/2020","Changed API Response of IsAvailableForTagging Property to a map")?void 0!==e.isAvailableForTagging&&!e.isAvailableForTagging:b(e.isAvailableForTagging,s.props.queryParams.termSetList),isLeaf:void 0!==e.childrenCount&&0===e.childrenCount}};s.getEmptySearchResults=function(e){var t=[];s.props.emptyKeySearchSuggestions&&s.props.emptyKeySearchSuggestions.forEach(function(e){var n={state:0,isSynonym:!1,completions:[],start:"",term:{label:e,termId:v.INVALID_TERM_ID}};t.push(n)});return h.TaxonomyEditorDataManager.filterTaggedTerms(t,e,!0)};s._dataSource=n.dataSource||new c.TaxonomyDataSource(n.pageContext);s._dataProvider=new c.TaxonomyProvider({},{dataSource:s._dataSource});s._dataManager=new h.TaxonomyEditorDataManager({dataProvider:s._dataProvider,dataSource:s._dataSource});s.state={selectedTerms:n.selectedTerms?l.deepCopy(n.selectedTerms):[],selectedNodes:{},highlightedNodesMap:{},nodeParents:{},orphanHighlightedNodes:{}};s.onSelect=s.onSelect.bind(s);s.onDeselect=s.onDeselect.bind(s);s.addParentToChildren=s.addParentToChildren.bind(s);s.updateTermsFromParentPane=s.updateTermsFromParentPane.bind(s);return s}s.prototype.componentDidMount=function(){this.setTermsInTreeFromPicker()};s.prototype.setTermsInTreeFromPicker=function(){this._log("AutoSending"+this.state.selectedTerms.length+"TermsForSelectionInTree");for(var e=0;e<this.state.selectedTerms.length;e++)this._selectNodeInTree(this.convertToNode(this.state.selectedTerms[e].term),[])};s.prototype.render=function(){return r.createElement("div",{className:t.componentClassName},r.createElement(a.Panel,{isOpen:this.props.isPanelOpen,className:t.componentClassName+"-Panel",onDismiss:this.props.onDismiss,onOpen:this.updateTermsFromParentPane,type:a.PanelType.medium,headerText:this.props.title,isFooterAtBottom:!0,onRenderFooterContent:this._onRenderFooterContent,closeButtonAriaLabel:this._isNarrationForCloseButtonFlightEnabled?d.default.PanelCloseButtonAriaLabel:void 0},r.createElement(u.TaxonomyTreeSelector,{selectedTerms:this.state.selectedTerms,onDismiss:this.props.onDismiss,queryParams:this.props.queryParams,pageContext:this.props.pageContext,dataSource:this.props.dataSource,termLimit:this.props.termLimit,isRequiredField:this.props.isRequiredField,resolveSuggestions:this._resolveSuggestions,onItemsChange:this._onItemsChange,taxonomyPicker:this._taxonomyPicker,selectedNodes:this.state.selectedNodes,highlightedNodesMap:this.state.highlightedNodesMap,onSelect:this.onSelect,onDeselect:this.onDeselect,addParentToChildren:this.addParentToChildren,isTaxonomyPickerVisible:!0,isHeadingVisible:!0,isTermSuggestionAllowed:!0,convertToTreeNode:this.convertToTreeNode,onEmptyResolveSuggestions:this.getEmptySearchResults,qosNamePrefix:"TaggingTree",getOAuthToken:this.props.getOAuthToken})))};s.prototype.updateTermsFromParentPane=function(){var e=this;this.setState(function(t){return{selectedTerms:e.props.selectedTerms?l.deepCopy(e.props.selectedTerms):[]}});this.setState(function(e){return{selectedNodes:{},highlightedNodesMap:{},orphanHighlightedNodes:{},nodeParents:{}}},function(){e.setTermsInTreeFromPicker()})};s.prototype.getSelectionMode=function(){return 1===this.props.termLimit?1:2};s.prototype.updateHighlightedNodes=function(e,t){var n=this.state.nodeParents[e.id]?this.state.nodeParents[e.id]:[];n.push(e.id);this.updateHighlight(t,n)};s.prototype.updateHighlight=function(e,t){var n=this,r="Highlight"===e?1:-1;this.setState(function(e){var i=2===n.getSelectionMode()?e.highlightedNodesMap:{};t.forEach(function(e){var t=JSON.stringify({id:e}),n=void 0!==i[t]?i[t]:0;i[t]=n+r;i[t]<=0&&delete i[t]});return{highlightedNodesMap:i}})};s.prototype.onMultiSelect=function(e){var t=this,n={};this.setState(function(r){(n=r.selectedNodes)[t._getNodeKey(e)]=!0;return{selectedNodes:n}})};s.prototype.onSingleSelect=function(e){var t=this;this.setState(function(){var n={};n[t._getNodeKey(e)]=!0;return{selectedNodes:n}})};s.prototype.onDeselect=function(e,t){void 0===t&&(t=[]);this._deselectNodeInTree(e,t);this._log("PassingDeselectionOfTermFromTreeToPicker");this._updateTaxonomyPicker(this.state.selectedTerms,this.state.selectedTerms.filter(function(t){return t.term.termId!==e.id}))};s.prototype.addParentToChildren=function(e,t){var r=this.state.nodeParents,i=this.state.orphanHighlightedNodes,s=void 0===r[t.id]?[]:r[t.id],o=[];e.forEach(function(e){r[e.id]=n.__spreadArrays(s,[t.id]);if(!0===i[e.id]){o=n.__spreadArrays(o,r[e.id],[e.id]);delete i[e.id]}});this.setState({nodeParents:r,orphanHighlightedNodes:i});o.length>0&&this.updateHighlight("Highlight",o)};s.prototype._log=function(e){p.Engagement.logData({name:"TaxonomyTaggingPanel"+e,isIntentional:!0})};s.prototype._saveStateAndClosePanel=function(){this.state.selectedTerms&&this.props.onItemsChange(this.state.selectedTerms);this.props.onDismiss&&this.props.onDismiss()};s.prototype.updateTermsInTreeFromPicker=function(e,t){var n=this,r={};t.forEach(function(e){r[n._getTermKey(e.term)]=!0});e.forEach(function(e){var t=e.term;if(!r[n._getTermKey(t)]){var i=n.convertToNode(t);n._log("PassingDeselectionOfTermFromPickerToTree");n._deselectNodeInTree(i,[])}});r={};e.forEach(function(e){r[n._getTermKey(e.term)]=!0});t.forEach(function(e){var t=e.term;if(!r[n._getTermKey(t)]){var i={name:t.label,id:t.termId,type:"TERM".toString()};n._log("PassingSelectionOfTermFromPickerToTree");n._selectNodeInTree(i,[])}})};s.prototype._getTermKey=function(e){return JSON.stringify({label:e.label,id:e.termId})};s.prototype.convertToNode=function(e){return{name:e.label,id:e.termId}};s.prototype._updateTaxonomyPicker=function(e,t){var n=this;this.setState({selectedTerms:t},function(){0===t.length&&n._focus();n._validateTerms(e,t)})};s.prototype._focus=function(){this._taxonomyPicker.current&&this._taxonomyPicker.current.focus()};s.prototype.onSelect=function(e,t){void 0===t&&(t=[]);this._selectNodeInTree(e,t);var n={state:1,isSynonym:!1,completions:[],start:"",term:{label:e.name,termId:e.id}},r=1===this.getSelectionMode()?[]:this.state.selectedTerms;this._log("PassingSelectionOfTermFromTreeToPicker");this._updateTaxonomyPicker(this.state.selectedTerms,r.concat(n))};s.prototype._selectNodeInTree=function(e,t){if(2===this.getSelectionMode())this.onMultiSelect(e);else{this.onSingleSelect(e);this.setState(function(e){return{orphanHighlightedNodes:{}}})}this._isNodeOrphan(t,e)&&this.setState(function(t){var n=t.orphanHighlightedNodes;n[e.id]=!0;return{orphanHighlightedNodes:n}});if(this._isNodeLoadedInTree(e)){this._log("SelectedNodeInLoadedTree");this.updateHighlightedNodes(e,"Highlight")}else this._log("SelectedNodeNotInLoadedTree")};s.prototype._isNodeLoadedInTree=function(e){return void 0!==this.state.nodeParents[e.id]};s.prototype._isNodeOrphan=function(e,t){return 0===e.length&&void 0===this.state.nodeParents[t.id]};s.prototype._deselectNodeInTree=function(e,t){var n=this,r={};this.setState(function(t){delete(r=t.selectedNodes)[n._getNodeKey(e)];return{selectedNodes:r}});void 0!==this.state.orphanHighlightedNodes[e.id]&&this.setState(function(t){var n=t.orphanHighlightedNodes;delete n[e.id];return{orphanHighlightedNodes:n}});if(this._isNodeLoadedInTree(e)){this._log("DeselectedNodeLoadedInTree");this.updateHighlightedNodes(e,"unHighlight")}else this._log("DeselectedNodeNotInLoadedTree")};s.prototype._getNodeKey=function(e){return JSON.stringify({id:e.id,type:"TERM".toString()})};s.prototype._validateTerms=function(e,t){var n=this;this._getValidatedTerms(t).then(function(t){n.setState({selectedTerms:t});n.updateTermsInTreeFromPicker(e,t)})};s.prototype._getValidatedTerms=function(e){return e.some(function(e){return 1!==e.state})?this._dataManager.validateTerms(this.props.queryParams,e):Promise.resolve(e)};Object.defineProperty(s.prototype,"_isReturnToClassicTreeOptionToBeShown",{get:function(){return m.default.isFeatureEnabled({ODB:1910})},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"_isNarrationForCloseButtonFlightEnabled",{get:function(){return m.default.isFeatureEnabled({ODB:307})},enumerable:!0,configurable:!0});return s})(s.BaseComponent);t.TaxonomyTaggingPanel=y;function b(e,t){if("boolean"==typeof e)return void 0!==e&&!e;if(void 0===e)return!1;var n=e.filter(function(e){return e.setId===t});return void 0!==n&&0!==n.length&&!n[0].isAvailable}t.isTermDisabled=b});
define("xTe",["require","exports","lC","OTe","CTe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("OTe",["require","exports","lC","nk","Le","u9"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){return e.call(this,{dataSourceName:"TaxonomyDataSource"},{pageContext:t})||this}t.prototype.getSuggestions=function(e,t){var n=this;return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_vti_bin/TaxonomyInternalService.json/GetSuggestions"},function(e){var t=JSON.parse(e);if(0===t.d.Groups.length)return[];var r=t.d.Groups[0].Suggestions;return n.transformSuggestionData(r)},"TaxonomySuggestion",function(){return n.constructSuggestionPostBody(e,t)})};t.prototype.getMatches=function(e,t){var n=this;return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_vti_bin/TaxonomyInternalService.json/GetMatches"},function(e){var t=JSON.parse(e).d.Matches;return n.transformMatchData(t)},"TaxonomyMatch",function(){return n.constructMatchPostBody(e,t)})};t.prototype.getTaxonomyTreeUrl=function(e,t,n){var r=i.default.escapeUrlForCallback(this._pageContext.webAbsoluteUrl),o=i.default.escapeUrlForCallback(this._pageContext.layoutsUrl),u={Field:t.name,IsDlg:1,lcid:n.lcid,sspIds:n.sspList,termSetIds:n.termSetList,anchorGuid:n.anchorId,fieldName:t.name,fieldId:t.id,IsMulti:t.isMulti,tags:e,allowFillIn:n.allowFillIn,webServiceUrl:n.webServiceUrl,isAddTerms:n.isAddTerms,isIgnoreFormatting:!1,isIncludeDeprecated:n.isIncludeDeprecated,isIncludePathData:n.isIncludePathData,isIncludeTermSetName:n.isIncludeTermSetName,isIncludeUnavailable:n.isIncludeUnavailable,isSpanTermSets:n.isSpanTermSets,isSpanTermStores:n.isSpanTermStores,isUseCommaAsDelimiter:n.isUseCommaAsDelimiter};return r+"/"+o+"/WebTaggingDialog.aspx?"+s.serializeQuery(u)};t.prototype.transformSuggestionData=function(e){var t=this;return e.map(function(e){var n={label:e.DefaultLabel,description:e.Description,termId:e.Id,isKeyword:e.IsKeyword,paths:e.Paths,rawSynonyms:e.Synonyms,synonyms:t.processSynonymsData(e.Synonyms),isValid:!0},r={completions:e.Completions,starts:e.Starts,isSynonym:e.IsSynonym};return{term:n,isSynonym:r.isSynonym,start:r.starts?r.starts[0]:null,completions:r.completions}})};t.prototype.transformMatchData=function(e){var t=this;return e.map(function(e){var n={label:e.DefaultLabel,termId:e.Id,isAmbiguous:e.IsAmbiguous,disambiguationData:[]};if(n.isAmbiguous){var r=e.DisambiguationData;n.disambiguationData=r.map(function(e){return{label:e.DefaultLabel,description:e.Description,termId:e.Id,isSynonym:e.IsSynonym,paths:e.TermsetAndPaths,synonyms:t.processSynonymsData(e.Synonyms)}})}return n})};t.prototype.processSynonymsData=function(e){var t=[];e&&e.length>0&&(t=e.split(";").map(function(e){return e.trim()}).filter(function(e){return e&&e.length>0}));return t};t.prototype.constructSuggestionPostBody=function(e,t){var n={start:e,lcid:t.lcid,sspList:t.sspList,termSetList:t.termSetList,anchorId:t.anchorId,isSpanTermStores:t.isSpanTermStores,isSpanTermSets:t.isSpanTermSets,isIncludeUnavailable:t.isIncludeUnavailable,isIncludeDeprecated:t.isIncludeDeprecated,isAddTerms:t.isAddTerms,isIncludePathData:t.isIncludePathData,excludeKeyword:t.excludeKeyword,excludedTermset:t.excludedTermset};return JSON.stringify(n)};t.prototype.constructMatchPostBody=function(e,t){var n={terms:e,lcid:t.lcid,SSPList:t.sspList,termSetList:t.termSetList,anchorId:t.anchorId,isSpanTermStores:t.isSpanTermStores,isSpanTermSets:t.isSpanTermSets,isIncludeUnavailable:t.isIncludeUnavailable,isIncludeDeprecated:t.isIncludeDeprecated,isAddTerms:t.isAddTerms,isIncludeTermSetName:t.isIncludeTermSetName,isIncludePathData:t.isIncludePathData,isUseCommaAsDelimiter:t.isUseCommaAsDelimiter};return JSON.stringify(n)};return t})(r.default);t.TaxonomyDataSource=o;t.default=o});
define("CTe",["require","exports","Fe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){void 0===e&&(e={});this.dataSource=t.dataSource;this.matchResult={promise:null};this.suggestionResult={promise:null}}e.prototype.getSuggestions=function(e,t){var r=this,i=null;this.suggestionResult.promise=new n.default(function(n,s){i=r.dataSource.getSuggestions(e,t).then(function(e){n(e)})},function(){i&&i.cancel()});return this.suggestionResult};e.prototype.getMatches=function(e,t){this.matchResult.promise=this.dataSource.getMatches(e,t).then(function(e){return e},function(e){throw e});return this.matchResult};return e})();t.TaxonomyProvider=r;t.default=r});
define("ITe",["require","exports","LTe","Fe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){this._taxonomyProvider=e.dataProvider}Object.defineProperty(e.prototype,"hasActiveQuery",{get:function(){return!!this._suggestionsQuery||!!this._matchQuery},enumerable:!0,configurable:!0});e.filterTaggedTerms=function(e,t,n){void 0===n&&(n=!1);for(var r=[],i=function(i){var s=e[i];0===t.filter(function(e){return e.term.label===s.term.label&&(n||e.term.termId===s.term.termId)}).length&&r.push(s)},s=0;s<e.length;s++)i(s);return r};e.convertTermsToRawString=function(e){for(var t="",r=0;r<e.length;r++){var i=e[r];if(i.term.isValid){t+=i.term.label+n.LABEL_ID_DELIMITER+i.term.termId;r<e.length-1&&(t+=n.TERM_DELIMITER)}else t+=i.term.label+n.LABEL_ID_DELIMITER+i.term.termId+n.TERM_DELIMITER}return t};e.createMatchString=function(t,r){var i="";i=e.convertTermsToRawString(t);r&&r.length>0&&(i+=r+n.LABEL_ID_DELIMITER+n.INVALID_TERM_ID);return i};e.prototype.resolveSuggestions=function(e,t){var n=this;this._abortSuggestionQuery();var i=this._taxonomyProvider.getSuggestions(e,t).promise,s=function(e){n._suggestionsQuery=null};this._suggestionsQuery=new r.default(function(e){i.then(function(t){e(t)}).catch(s)});return this._suggestionsQuery};e.prototype.validateTerms=function(t,n,i){var s=this;this._abortSuggestionQuery();var o=e.createMatchString(n,i);if(o&&o.length>0&&t){var u=this._taxonomyProvider.getMatches(o,t);this._matchQuery=new r.default(function(e){u.promise.then(function(t){t&&t.length>0?e(s.ProcessMatchResults(t)):e([])}).catch(function(e){s._matchQuery=null})});return this._matchQuery}return r.default.resolve([])};e.prototype.ProcessMatchResults=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r],s={term:{termId:"",label:i.label},isSynonym:!1,completions:[],start:"",state:0};if(i.termId!==n.INVALID_TERM_ID){if(i.isAmbiguous){if(i.disambiguationData&&i.disambiguationData.length>0){s.term.label=i.disambiguationData[0].label;s.term.termId=i.disambiguationData[0].termId}}else{s.term.label=i.label;s.term.termId=i.termId}s.state=1}else{s.term.label=i.label;s.term.termId=i.termId;s.state=2}t.push(s)}return t};e.prototype._abortSuggestionQuery=function(){if(this._suggestionsQuery){this._suggestionsQuery.cancel();this._suggestionsQuery=null}if(this._matchQuery){this._matchQuery.cancel;this._matchQuery=null}};return e})();t.TaxonomyEditorDataManager=i});
define("LTe",["require","exports","lC","Zne","MTe","rae","nae","kTe","_ne"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t)});
define("kTe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.unknown=0]="unknown";e[e.valid=1]="valid";e[e.invalid=2]="invalid"})(t.TermValidationState||(t.TermValidationState={}))});
define("Xze",["require","exports","cGe","Qze","d9","c9","ce","s9","L7","Qn","IA","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";c=c.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var h,p,d,v,m,g,y=o.Killswitch.isActivated("096CBC65-3042-4DE8-9984-92CA9D6AC32B","7/14/2020","Fix HTML string decoding for display control for multi line text fields."),b=o.Killswitch.isActivated("F8981E1F-1867-43CA-9123-178C686F8AE1","2/25/2020","Strip only certain HTML tags from RTE and MultiLine Text Fields to preserve font styles minus fot-size"),w=o.Killswitch.isActivated("82B53297-2CF5-4E0A-8A06-A203E9461B03","8/06/2020","Change function used for getting relative date time string to be the same one thats used in items-view."),E={ODB:1725},S={ODB:1300},x={ODB:1206},T={ODB:1198},N={ODB:988};t.globalClienttemplates=function(){n.JsGridUtil.SPListView||(n.JsGridUtil.SPListView=!1);h="undefined"!=typeof SingleListView;(function(){var e=n.JsGridUtil.SPListView;ListModule.Settings.SupportsCallouts=e;ListModule.Settings.SupportsDragDrop=e;ListModule.Settings.SupportsRibbon=e;ListModule.Settings.SupportsQCB=e;ListModule.Settings.SupportsUpload=e;ListModule.Settings.SupportsInplHash=e;ListModule.Settings.SupportsAnimation=e;ListModule.Settings.SupportsGrouping=e;ListModule.Settings.SupportsNonCSR=e;ListModule.Settings.SupportsInPlaceEdit=e;ListModule.Settings.SupportsItemDelete=e;ListModule.Settings.SupportsCheckout=e;ListModule.Settings.SupportsPopup=e;ListModule.Settings.SupportsErrorDlg=e;ListModule.Settings.SupportsFileAttach=e;ListModule.Settings.SupportsCopies=e;ListModule.Settings.SupportsModeration=e;ListModule.Settings.SupportsMQuery=e;ListModule.Settings.SupportsForms=e;ListModule.Settings.SupportsViewSelectorPivot=e;ListModule.Settings.SupportsWebPageLibraryTemplate=e;ListModule.Settings.SupportsDeveloperAppTemplate=e;ListModule.Settings.SupportsDelayLoading=e;ListModule.Settings.SupportsItemSelection=e;ListModule.Settings.SupportsSharingDialog=e;ListModule.Settings.UseAbsoluteUserDispUrl=!e;ListModule.Settings.SupportsCrossDomainPhotos=e;ListModule.Settings.SupportsTouch=e;ListModule.Settings.SupportsBusinessDataField=e;ListModule.Settings.SupportsUrlTokenReplacement=e;ListModule.Settings.SupportsAsyncDataLoad=e;ListModule.Settings.SupportsBreadCrumb=e;ListModule.Settings.SupportsSubmitFormPost=e;ListModule.Settings.SupportsFacePile=e;ListModule.Settings.SupportsRest=h;ListModule.Settings.SupportsDatapipes=h;ListModule.Settings.SupportsOldDesktopMenus=e;ListModule.Settings.SupportsTaskListEditMode=e})();p=!1;d=!1;(function(){if(Boolean(d))return;void 0===window.ListView&&(window.ListView=new Object);void 0===window.ListView.Strings&&(n.JsGridUtil.SPListView&&void 0!==Strings.STS?window.ListView.Strings=Strings.STS:void 0!==window.ListViewDefaults.Strings&&(window.ListView.Strings=window.ListViewDefaults.Strings));d=!0})();void 0===window.ListView&&(window.ListView=new Object);void 0===window.ListView.ImageBasePath&&(window.ListView.ImageBasePath="");v=[];m=function(e,t){v.push(this);var n=e,r={},i={},s={},o={},u={};this.Matches=function(e){return e==n};this.RegisterHierarchyNode=function(e,t,n,a){r[e]=!0;i[e]=n;s[a]=e;u[e]=a;o[e]=[];null!=t&&o[t].push(e)};this.IsParent=function(e){return e in o&&o[e].length>0};this.ToggleExpandByImg=function(e){if(e.id in s){a(s[e.id],e)}};this.ToggleExpandById=function(e){if(null!=e&&e in u){var t=u[e],n=window.$get(t);null!=n&&a(e,n)}};this.GetToggleStateById=function(e){return null==e?0:e in r?0==o[e].length?0:r[e]?1:2:0};function a(e,n){var s=!r[e];if(s){n.firstChild.className="ms-commentcollapse"+(t?"rtl":"")+"-icon";(function e(t){for(var n=0;n<o[t].length;n++){document.getElementById(i[o[t][n]]).style.display="";r[o[t][n]]&&e(o[t][n])}})(e)}else{n.firstChild.className="ms-commentexpand"+(t?"rtl":"")+"-icon";(function e(t){for(var n=0;n<o[t].length;n++){document.getElementById(i[o[t][n]]).style.display="none";e(o[t][n])}})(e)}r[e]=s}};t.SPClientRenderer={GlobalDebugMode:!1,AddCallStackInfoToErrors:!1,RenderErrors:!0};t.SPClientRenderer.IsDebugMode=function(e){return void 0!==e&&null!=e&&void 0!==e.DebugMode?Boolean(e.DebugMode):Boolean(t.SPClientRenderer.GlobalDebugMode)};t.SPClientRenderer._ExecuteRenderCallbacks=function(e,n){var r={Operation:n};return L(function(){return t.SPClientRenderer._ExecuteRenderCallbacksWorker(e,n,r)},e,null,r)};t.SPClientRenderer._ExecuteRenderCallbacksWorker=function(e,t,n){if(e&&null!=t&&""!=t){var r=e[t];if(null!=r)if("function"==typeof r){n.TemplateFunction=r;r(e)}else if("object"==typeof r){var i=r.length;if(i&&"number"==typeof i)for(var s=0;s<Number(i);s++)if("function"==typeof r[s]){n.TemplateFunction=r[s];r[s](e)}}}};t.SPClientRenderer.CoreRender=A;t.SPClientRenderer.ParseTemplateString=function(e,n){return L(function(){return t.SPClientRenderer.ParseTemplateStringWorker(e,n)},n,null,{TemplateFunction:e,Operation:"ParseTemplateString"})};t.SPClientRenderer.ParseTemplateStringWorker=function(e,t){if(null==e||0==e.length)return null;var n="var p=[]; p.push('"+e.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*#>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<#=(.+?)#>/g,"',$1,'").split("<#").join("');").split("#>").join("p.push('")+"'); return p.join('');";return new Function("ctx",n)};"function"!=typeof window.ComputedFieldWorker&&(window.ComputedFieldWorker=(function(){function e(e,t,r){if("1"==e["Created_x0020_Date.ifnew"]){var i;i=n.JsGridUtil.Internal.GetImageUrl("spcommon.png");r.push('<span class="ms-newdocument-iconouter"><img class="ms-newdocument-icon" src="');r.push(i);r.push('" alt="');r.push(window.ListView.Strings.L_SPClientNew);r.push('" title="');r.push(window.ListView.Strings.L_SPClientNew);r.push('" /></span>')}}function t(e,t,n,r,s,o,u){var a=[];a.push('<span style="vertical-align:middle">');a.push('<span style="height:16px;width:16px;position:relative;display:inline-block;overflow:hidden;" class="s4-clust"><a href="');a.push(e);i(a,o,u);a.push('" style="height:16px;width:16px;display:inline-block;" ><img src="'+ListView.ImageBasePath+'/_layouts/15/images/fgimg.png?rev=47" alt="');a.push(t);a.push('" style="left:-0px !important;top:');a.push(n);a.push('px !important;position:absolute;" title="');a.push(r);a.push('" class="imglink" longDesc="');a.push(s);a.push('"></a>');a.push("</span>");a.push("</span>");return a.join("")}function i(e,t,n){e.push(t.HttpVDir);e.push("/Lists/Posts/Post.aspx?ID=");e.push(n.ID)}function s(t,i,s){var o=[],u=i.FileRef;if(null!=u&&void 0!==u&&""!=r.TrimSpaces(u))if("1"==i.FSObjType)"1"==s.IsDocLib?Q(t,o,i.FileLeafRef,i,s):K(o,i.FileLeafRef,i,s);else if(ListModule.Settings.SupportsAddToOneDrive&&Boolean(r.IsMountPoint(i))){z(i);o.push(r.RenderMountPointLink(t,o,i["FileLeafRef.Name"],i,s))}else if(ListModule.Settings.SupportsShortcutLink&&Boolean(r.IsShortcutLink(i))){z(i);r.RenderShortcutLink(t,o,i["FileLeafRef.Name"],i,s)}else{var a,f=(Boolean(t.RealHttpRoot)?ListModule.Util.getHostUrl(t.HttpRoot):"")+i.FileRef;f=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(54)?Encoding.HtmlEncodeEx(f):Encoding.HtmlEncode(f);var l=n.JsGridUtil.Internal.IsFeatureEnabled(E)?" "+c.listLink:"";o.push("<a class='ms-listlink"+l+"' href=\"");o.push(f);o.push('" onmousedown="return VerifyHref(this,event,\'');o.push(s.DefaultItemOpen);o.push("','");o.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);o.push("','");a=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?Encoding.ScriptEncode(i["serverurl.progid"]):i["serverurl.progid"];if((null==window.OffSwitch||OffSwitch.IsActive("88E16BF7-E8BC-4ABA-ABE7-001818C101E8"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(164)&&"ms-word"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(194)&&"ms-powerpoint"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(225)&&"ms-visio"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(181)&&"ms-excel"==i["File_x0020_Type.mapapp"]){a=a.replace("WopiFrame.aspx","doc.aspx");(null==window.OffSwitch||OffSwitch.IsActive("8682DDE6-14A4-4290-876C-8D1F5AFD46E0")||"ms-visio"!=i["File_x0020_Type.mapapp"]&&"ms-excel"!=i["File_x0020_Type.mapapp"])&&(a=a.replace("action=default","action=edit"))}o.push(a);o.push('\')" onclick="');Ae(o,i,"Navigation");if(P()){if(D()&&_(t)){o.push("CoreInvoke('CallSuiteExtensionControlFactory', this, event, '");null==window.OffSwitch||OffSwitch.IsActive("9E9D50DD-3F1B-4186-8AC0-80E9634B2891")?o.push(i.File_x0020_Type):o.push(Encoding.ScriptEncode(i.File_x0020_Type));o.push("','");o.push(t.HttpRoot);o.push("','");o.push(Encoding.ScriptEncode(i.FileRef));o.push("');")}}else{o.push("CoreInvoke('CallSuiteExtensionControlFactory', this, event, '");null==window.OffSwitch||OffSwitch.IsActive("9E9D50DD-3F1B-4186-8AC0-80E9634B2891")?o.push(i.File_x0020_Type):o.push(Encoding.ScriptEncode(i.File_x0020_Type));o.push("','");o.push(t.HttpRoot);o.push("','");o.push(Encoding.ScriptEncode(i.FileRef));o.push("');")}o.push("return DispEx(this,event,'TRUE','FALSE','");o.push(i["File_x0020_Type.url"]);o.push("','");o.push(i["File_x0020_Type.progid"]);o.push("','");o.push(s.DefaultItemOpen);o.push("','");o.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);o.push("','");o.push(i.HTML_x0020_File_x0020_Type);o.push("','");o.push(a);o.push("','");o.push(Boolean(i.CheckoutUser)?i.CheckoutUser[0].id:"");o.push("','");o.push(s.Userid);o.push("','");o.push(s.ForceCheckout);o.push("','");o.push(i.IsCheckedoutToLocal);o.push("','");o.push(i.PermMask);var h=i.FileLeafRef;if(null!=h){var p=h.lastIndexOf(".");h=p>=0?h.substring(0,p):h}if(ListModule.Settings.SupportsDoclibAccessibility){o.push("')\"");var d=h+", "+I(i["File_x0020_Type.mapapp"],i.File_x0020_Type);o.push(" aria-label='");o.push(Encoding.HtmlEncode(d));o.push("'>")}else o.push("')\">");o.push(Encoding.HtmlEncode(h));o.push("</a>");e(i,0,o)}else{o.push("<nobr>");o.push(Encoding.HtmlEncode(i.FileLeafRef));o.push("</nobr>")}return o.join("")}function o(e,t,n,i){var s=[],o=Encoding.HtmlEncode(n.FileLeafRef),u="imgIcon"+n.ID+e.wpq,a=void 0!==n["DocIcon.groupHeader"];if(a){u="imgIcon"+e.ctxId+"-";if(n["DocIcon.groupindex"])u+=n["DocIcon.groupindex"];else if(n["DocIcon.groupindex2"]){var f=i.group1;u+=n[f+".groupindex"]+n["DocIcon.groupindex2"]}}if(ListModule.Settings.SupportsAddToOneDrive&&Boolean(r.IsMountPoint(n))){var l=r.createByListItem(n,e);if(r.SupportAjaxFolderNav(e)){s.push('<a href="#" onclick="');s.push("EnterFolderAjax(event, '");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push("', '");s.push(l.getMountPointUrl());s.push("', true);return false;\"");ListModule.Settings.SupportsDoclibAccessibility?s.push(' aria-label="'+Encoding.HtmlEncode(window.ListView.Strings.L_FieldType_SharedFolder)+'">'):s.push(">")}else{s.push('<a href="');s.push(l.getMountPointUrl());ListModule.Settings.SupportsDoclibAccessibility?s.push(' aria-label="'+Encoding.HtmlEncode(window.ListView.Strings.L_FieldType_SharedFolder)+'">'):s.push('">')}s.push('<img border="0" alt="');s.push(o);s.push('" title="');s.push(o);s.push('" src="');s.push(ListView.ImageBasePath+"/_layouts/15/images/SharedFolder16.png?rev=47");s.push('" />');s.push("</a>")}else if(ListModule.Settings.SupportsShortcutLink&&Boolean(r.IsShortcutLink(n))){z(n);r.RenderShortcutLinkIcon(e,s,n["FileLeafRef.Name"],n,i)}else if("1"==n.FSObjType){var c=V()?"&MaintainUserChrome=true":"";if(w())S();else{s.push('<a href="');s.push(i.PagePath);s.push("?RootFolder=");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push(i.ShowWebPart);s.push("&FolderCTID=");s.push(n.ContentTypeId);s.push("&View=");s.push(URI_Encoding.encodeURIComponent(i.View));s.push(c);s.push('" onmousedown="VerifyFolderHref(this, event, \'');s.push(n["File_x0020_Type.url"]);s.push("','");s.push(n["File_x0020_Type.progid"]);s.push("','");s.push(i.DefaultItemOpen);s.push("', '");s.push(n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);s.push("', '");s.push(n.HTML_x0020_File_x0020_Type);s.push("', '");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?s.push(Encoding.ScriptEncode(n["serverurl.progid"])):s.push(n["serverurl.progid"]);s.push('\')" onclick="');Ae(s,n,"Navigation");s.push("return HandleFolder(this,event,'");s.push(i.PagePath);s.push("?RootFolder=");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push(i.ShowWebPart);s.push("&FolderCTID=");s.push(n.ContentTypeId);s.push("&View=");s.push(URI_Encoding.encodeURIComponent(i.View));s.push(c);s.push("','TRUE','FALSE','");s.push(n["File_x0020_Type.url"]);s.push("','");s.push(n["File_x0020_Type.progid"]);s.push("','");s.push(i.DefaultItemOpen);s.push("','");s.push(n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);s.push("','");s.push(n.HTML_x0020_File_x0020_Type);s.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?s.push(Encoding.ScriptEncode(n["serverurl.progid"])):s.push(n["serverurl.progid"]);s.push("','");s.push(Boolean(n.CheckoutUser)?n.CheckoutUser[0].id:"");s.push("','");s.push(i.Userid);s.push("','");s.push(i.ForceCheckout);s.push("','");s.push(n.IsCheckedoutToLocal);s.push("','");s.push(n.PermMask);ListModule.Settings.SupportsDoclibAccessibility?s.push('\');" tabIndex="-1" IsFolder="TRUE" aria-label="'+Encoding.HtmlEncode(F(n["File_x0020_Type.mapapp"],!1))+'"><img border="0" alt="'):s.push('\');"><img border="0" alt="');s.push(o);s.push('" title="');s.push(o);s.push('" src="');s.push((function(e){return""==e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]?ListView.ImageBasePath+"/_layouts/15/images/folder.gif?rev=47":ListView.ImageBasePath+"/_layouts/15/images/"+e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]})(n));s.push('" />');if(void 0!==n.IconOverlay&&""!=n.IconOverlay){s.push('<img width="16" height="16" src="'+ListView.ImageBasePath+"/_layouts/15/images/");null==window.OffSwitch||OffSwitch.IsActive("B35674E3-5E63-4A44-AF45-127010C82E7D")?s.push(n["IconOverlay.mapoly"]):s.push(Encoding.HtmlEncode(n["IconOverlay.mapoly"]));s.push('" class="ms-vb-icon-overlay" alt="" title="" />')}s.push("</a>")}}else if("1"==i.IsDocLib)if(void 0===n.IconOverlay||""==n.IconOverlay){var h=!1,p=null,d=void 0===n.CheckoutUser||""==n.CheckoutUser,v=void 0!==n._ComplianceFlags&&null!=n._ComplianceFlags&&4==(4&n._ComplianceFlags);if(P()){e.allowedSuiteExtensionFileTypes=["pdf"];D()&&_(e)&&(h=!0)}else{e.allowedSuiteExtensionFileTypes=["bmp","chm","gif","htm","html","jpeg","jpg","pdf","png","psd","tif","txt","wma","wmv","xml","zip"];D()&&void 0!==n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]&&(""==n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]||IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,n.File_x0020_Type,0)>-1)&&(h=!0)}if(w())S();else if(d){p=ListModule.Settings.SupportsDoclibAccessibility?I(n["File_x0020_Type.mapapp"],n.File_x0020_Type):n.FileLeafRef;var m=Boolean(n["HTML_x0020_File_x0020_Type.File_x0020_Type.isIconDynamic"])?" onclick=\"this.style.display='none';\"":"";v&&(p=b());E(p,n.FileLeafRef,!0,n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],m)}else E(p=y(),p,!0,n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],void 0);if(!a&&(!d||v)){var g=ListView.ImageBasePath+"/_layouts/15/images/checkoutoverlay.gif";p=y();if(d&&v){p=b();g=ListView.ImageBasePath+"/_layouts/15/images/lockoverlay.png"}s.push('<img src="'+g+'" class="ms-vb-icon-overlay" alt="');s.push(p);s.push('" title="');s.push(p);s.push('" />')}}else{E(n.FileLeafRef,n.FileLeafRef,!1,n["IconOverlay.mapico"],void 0);s.push('<img width="16" height="16" src="'+ListView.ImageBasePath+"/_layouts/15/images/");null==window.OffSwitch||OffSwitch.IsActive("B35674E3-5E63-4A44-AF45-127010C82E7D")?s.push(n["IconOverlay.mapoly"]):s.push(Encoding.HtmlEncode(n["IconOverlay.mapoly"]));s.push('" class="ms-vb-icon-overlay" alt="" title="" />')}else E(n.FileLeafRef,n.FileLeafRef,!1,n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],void 0);function y(){return n.FileLeafRef+"&#10;"+window.ListView.Strings.L_SPCheckedoutto+": "+(Boolean(n.CheckoutUser)?Encoding.HtmlEncode(n.CheckoutUser[0].title):"")}function b(){return n.FileLeafRef+"&#10;"+window.ListView.Strings.L_Tag_Callout_BlockDeleteItem}function w(){return ListModule.Settings.SupportsPolicyTips&&void 0!==n._ip_UnifiedCompliancePolicyUIAction&&Number(n._ip_UnifiedCompliancePolicyUIAction)>0&&!a}function E(t,r,i,o,a){s.push('<img width="16" height="16" border="0" alt="');s.push(t);P()?h&&s.push('" class="registerFileIcon'):h&&(""==n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]||IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,n.File_x0020_Type,0)>-1)&&s.push('" class="registerFileIcon');s.push('" title="');s.push(r);if(void 0!==u){s.push('" id="');s.push(u)}i&&h&&""==o&&(o="icgen.gif");s.push('" src="'+ListView.ImageBasePath+"/_layouts/15/images/"+o);s.push('"');void 0!==a&&s.push(a);s.push("/>")}function S(){var t,r;if(1==Number(n._ip_UnifiedCompliancePolicyUIAction)){t="dlpalert.png";r=window.ListView.Strings.L_DLP_Callout_PolicyTip}else{t="dlpblock.png";r=window.ListView.Strings.L_DLP_Callout_BlockedItem}E(r,r,!0,t,' class="ms-listview-policyTipIcon"');var i=!1;O(e,function(){if(!i){i=!0;var t=document.getElementById(u);Boolean(t)&&DOM.AddEventHandler(t,"onclick",function(t){1!=Number(n._ip_UnifiedCompliancePolicyUIAction)&&3!=Number(n._ip_UnifiedCompliancePolicyUIAction)||"function"==typeof LaunchDlpDialog&&LaunchDlpDialog(n,e,"DocIcon")},!1)}})}return s.join("")}function u(e,t,n,r){return a(e,n,r,n.Title)}function a(t,n,r,i){var s=[];"1"==n.FSObjType?"1"==r.IsDocLib?Q(t,s,q(i),n,r):K(s,q(i),n,r):j(s,t,n,r,q(i),void 0);e(n,0,s);return s.join("")}function f(e,t,n,r){var i=[];i.push('<a href="'+W(n.FileRef,void 0)+'">');i.push('<img galleryimg="false" border="0"');i.push(' id="'+n.ID+'webImgShrinked"');"PreviewOnForm"!=t.Name&&i.push(' class="ms-displayBlock"');var s=("PreviewOnForm"==t.Name?"256":"128")+"px";i.push(' style="max-width: '+s+"; max-height: "+s+'; margin:auto; visibility: hidden;"');i.push(' onerror="displayGenericDocumentIcon(event.srcElement ? event.srcElement : event.target, '+n.FSObjType+'); return false;"');i.push(" onload=\"(event.srcElement ? event.srcElement : event.target).style.visibility = 'visible';\"");i.push(' alt="');var o=n._Comments;null!=o&&""!=o?i.push(Encoding.HtmlEncode(o)):i.push(window.ListView.Strings.L_ImgAlt_Text);i.push('" src="'+W((function(e,t,n){var r,i=function(t){return"1"==e[t+".value"]&&ListModule.Util.isDefinedAndNotNullOrEmpty(e["FileLeafRef.Name"])&&ListModule.Util.isDefinedAndNotNullOrEmpty(a)||""==e[t+".value"]&&null!=n&&109==n.ListTemplateType},s=""==e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"];r=void 0===t||16===t?"":s?String(t):32===t?"lg_":String(t)+"_";z(e);(function(e){if(void 0===e["FileLeafRef.Suffix"]){var t=e.FileLeafRef,n=t.lastIndexOf(".");e["FileLeafRef.Suffix"]=n>=0?t.substring(n+1):""}})(e);(function(e){if(void 0===e.FileDirRef){var t=e.FileRef;if(Boolean(t)){var n=t.indexOf("/"),r=t.lastIndexOf("/");e.FileDirRef=r>=0?t.substring(n,r-n):""}}})(e);var o=e.AlternateThumbnailUrl,u=ListModule.Util.isDefinedAndNotNullOrEmpty(o),a=e["FileLeafRef.Suffix"],f=i("PreviewExists"),l=i("ThumbnailExists"),c=ListModule.Util.isDefinedAndNotNullOrEmpty(a)&&("mp3"==a||"wma"==a||"wav"==a||"oga"==a),h="undefined"!=typeof ctx?ctx:n;return""!=r&&(u||f||l)?u?String(o):e.FileDirRef+"/_w/"+e["FileLeafRef.Name"]+"_"+e["FileLeafRef.Suffix"]+".jpg":c?h.imagesPath+"audiopreview.png":s?h.imagesPath+"folder"+r+".gif":h.imagesPath+r+e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]})(n,256,e),void 0)+'"/>');i.push("</a>");return i.join("")}return{URLwMenu:function(e,t,n,r){var i;if("1"==n.FSObjType){var s=[];s.push('<a onfocus="OnLink(this)" href="SubmitFormPost()" onclick="ClearSearchTerm(\'');s.push(r.View);s.push("');ClearSearchTerm('');SubmitFormPost('");s.push(r.PagePath);s.push("?RootFolder=");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push(r.ShowWebPart);s.push("&FolderCTID=");s.push(n.ContentTypeId);s.push("');return false;\">");s.push(n.FileLeafRef);s.push("</a>");i=s.join("")}else i=X(n,"URL",r,t,!0);return i},URLNoMenu:function(e,t,n,r){return X(n,"URL",r,t,!0)},mswh_Title:function(e,t,n,r){var i=[];i.push('<a onfocus="OnLink(this)" href="');i.push(n.FileRef);i.push('" onclick="LaunchWebDesigner(');i.push("'");i.push(n.FileRef);i.push("','design'); return false;");i.push('">');i.push(q(n.Title));i.push("</a>");return i.join("")},LinkTitle:u,LinkTitleNoMenu:u,Edit:function(e,t,n,r){if(ListModule.Util.hasEditPermission(n)){var i=(function(e,t){return"4"==e.EventType?e.ID+".1."+e.MasterSeriesItemID:e.ID})(n),s=[];s.push('<a href="');s.push(e.editFormUrl);s.push("&ID=");s.push(i);s.push('" onclick="EditItemWithCheckoutAlert(event, \'');s.push(e.editFormUrl);s.push("&ID=");s.push(i);s.push("', '");s.push((function(e,t){var n=void 0===e.CheckoutUser||""==e.CheckoutUser;return"1"==t.ForceCheckout&&"1"!=e.FSObjType&&n?"1":""})(n,r));s.push("', '");s.push(n.IsCheckedoutToLocal);s.push("', '");s.push(escape(n.FileRef));s.push("', '");s.push(r.HttpVDir);s.push("', '");s.push(n.CheckedOutUserId);s.push("', '");s.push(r.Userid);s.push('\');return false;" target="_self">');s.push('<img border="0" alt="');s.push(window.ListView.Strings.L_SPClientEdit);s.push('" src="'+ListView.ImageBasePath+'/_layouts/15/images/edititem.gif?rev=47"/></a>');return s.join("")}return"&nbsp;"},DocIcon:o,MasterPageIcon:o,LinkFilename:function(e,t,n,r){return s(e,n,r)},LinkFilenameNoMenu:function(e,t,n,r){return s(e,n,r)},NumCommentsWithLink:function(e,n,r,s){var o=[];o.push(t("",window.ListView.Strings.L_SPClientNumComments,"-396",window.ListView.Strings.L_SPClientNumComments,window.ListView.Strings.L_SPClientNumComments,s,r));o.push('<span><a href="');i(o,s,r);o.push('">&nbsp;');o.push(r.NumComments);o.push("&nbsp;");o.push("Comment(s)");o.push("</a></span>");return o.join("")},EmailPostLink:function(e,n,r,i){return t("javascript:navigateMailToLink('",window.ListView.Strings.L_SPEmailPostLink,"-267",window.ListView.Strings.L_SPEmailPostLink,window.ListView.Strings.L_SPEmailPostLink,i,r)},Permalink:function(e,n,r,i){return t("","Permanent Link to Post","-412","Permanent Link to Post","Permanent Link to Post",i,r)},CategoryWithLink:function(e,t,n,r){var i=[];i.push('<a class="static menu-item" href="');i.push(r.HttpVDir);i.push("/");i.push("lists/Categories/Category.aspx?CategoryId=");i.push(n.ID);i.push('" id="blgcat');i.push(n.ID);i.push('"><span class="additional-backgroud"><span class="menu-item-text">');i.push(n.Title);i.push("</span></span></a>");return i.join("")},LinkIssueIDNoMenu:function(e,t,n,r){var i=[];i.push('<a href="');i.push(e.displayFormUrl);i.push("&ID=");i.push(n.ID);i.push('" onclick="');Ae(i,n,"Navigation");i.push("EditLink2(this,");i.push(e.ctxId);i.push(');return false;" target="_self">');i.push(n.ID);i.push("</a>");return i.join("")},SelectTitle:function(e,t,n,r){if(r.SelectedID==n.ID||"-1"==r.SelectedID&&1==n.firstRow)return'<img border="0" align="absmiddle" style="cursor: hand" src="'+ListView.ImageBasePath+'/_layouts/15/images/rbsel.gif" alt="'+window.ListView.Strings.L_SPSelected+'" />';var i=[];i.push("<a href=\"javascript:SelectField('");i.push(r.View);i.push("','");i.push(n.ID);i.push("');return false;\" onclick=\"SelectField('");i.push(r.View);i.push("','");i.push(n.ID);i.push('\');return false;" target="_self">');i.push('<img border="0" align="absmiddle" style="cursor: hand" src="'+ListView.ImageBasePath+'/_layouts/15/images/rbunsel.gif"  alt="');i.push(window.ListView.Strings.L_SPGroupBoardTimeCardSettingsNotFlex);i.push('" /></a>');return i.join("")},DisplayResponse:function(e,t,n,r){var i=[];i.push('<a onfocus="OnLink(this)" href="');i.push(e.displayFormUrl);i.push("&ID=");i.push(n.ID);i.push('" onclick="GoToLinkOrDialogNewWindow(this);return false;" target="_self" id="onetidViewResponse">');i.push(window.ListView.Strings.L_SPView_Response);i.push(" #");i.push(n.ID);i.push("</a>");return i.join("")},Completed:function(e,t,n,r){return"1"==n._Level?window.ListView.Strings.L_SPYes:window.ListView.Strings.L_SPNo},RepairDocument:function(e,t,n,r){return'<input id="chkRepair" type="checkbox" title="'+window.ListView.Strings.L_SPRelink+'" docID="'+n.ID+'" />'},Combine:function(e,t,n,r){if("0"==n.FSObjType){var i='<input id="chkCombine" type="checkbox" title="';i+=window.ListView.Strings.L_SPMerge;i+='" href="';i+=("0"==n.FSObjType?String(r.HttpVDir)+String(n.FileRef):n.FileRef)+'" />';i+='<input id="chkUrl" type="hidden" href="';i+=n.TemplateUrl;i+='" />';i+='<input id="chkProgID" type="hidden" href="';i+=n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"];return i+='" />'}return""},HealthReportSeverityIcon:function(e,t,n,r){var i,s=new String(n.HealthReportSeverity),o=s.indexOf(" - ");i="1"==(s=s.substring(0,o))?"hltherr":"2"==s?"hlthwrn":"3"==s?"hlthinfo":"4"==s?"hlthsucc":"hlthfail";return'<img src="'+ListView.ImageBasePath+"/_layouts/15/images/"+i+'.png" alt="'+s+'" />'},FileSizeDisplay:function(e,t,n,r){return"0"==n.FSObjType?String(Math.ceil(n.File_x0020_Size/1024))+" KB":""},NameOrTitle:function(e,t,n,r){return a(e,n,r,n.FileLeafRef)},ImageSize:function(e,t,n,r){var i=[];if("0"==n.FSObjType&&""!=n.ImageWidth&&"0"!=n.ImageWidth){i.push('<span dir="ltr">');i.push(n.ImageWidth+" x "+n.ImageHeight);i.push("</span>")}return i.join("")},ThumbnailOnForm:f,PreviewOnForm:f,Thumbnail:f,FileType:function(e,t,n,r){return n.File_x0020_Type},_IsRecord:function(e,t,n,r){return void 0!==n._ComplianceFlags&&null!=n._ComplianceFlags&&(4==(4&n._ComplianceFlags)||256==(256&n._ComplianceFlags))?window.ListView.Strings.L_SPYes:window.ListView.Strings.L_SPNo}}})());R.prototype={fieldRenderer:null,fldName:null,RenderField:U};g=function(e,t,r,i,s){var o=[],u=e.ListSchema,a=n.JsGridUtil.Internal.IsFeatureEnabled(E)&&e.fixedHeightRowEnabled?" "+c.cellHiddenOverflow:"";o.push('<div class="ms-vb '+(1==s?"":"ms-tableCell ms-list-TitleLink")+a+' ms-vb-menuPadding itx" CTXName="ctx');o.push(e.ctxId);o.push('" id="');o.push(t.ID);o.push('" Field="');o.push(r.Name);o.push('" Perm="');o.push(t.PermMask);o.push('" EventType="');o.push(t.EventType);o.push('">');o.push(i);o.push("</div>");if(1==s){o.push('</td><td class="ms-list-itemLink-td ms-cellstyle');u.Field[u.Field.length-1]==r&&o.push(" ms-vb-lastCell");o.push('">')}if(!PageMinimized()){o.push('<div class="ms-list-itemLink '+(1==s?"":"ms-tableCell ms-alignRight")+'" ');o.push("onclick=\"CoreInvoke('ShowECBMenuForTr', this, event");o.push(", ListView.Strings");o.push('); return false;">');o.push('<a ms-jsgrid-click-passthrough="true" class="ms-lstItmLinkAnchor ms-ellipsis-a" title="');o.push(Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenuECB));o.push('" aria-haspopup="true" ');o.push("onclick=\"CoreInvoke('ShowECBMenuForTr', this.parentNode, event");o.push(", ListView.Strings");o.push('); return false; " href="#" >');o.push('<img class="ms-ellipsis-icon" src="'+n.JsGridUtil.Internal.GetImageUrl("spcommon.png")+'" alt="'+Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenu)+'" /></a>');o.push("</div>")}return o.join("")};G.prototype={fldName:null,RenderField:Y};Z.prototype={fldName:null,RenderField:ee};te.prototype={fldName:null,RenderField:ne};re.prototype={fldName:null,RenderField:ie};se.prototype={fldName:null,RenderField:oe};ue.prototype={fldName:null,RenderField:ae};fe.prototype={fldName:null,RenderField:le};ce.prototype={fldName:null,RenderField:he};pe.prototype={fldName:null,RenderField:de};ve.prototype={fldName:null,RenderField:me};ge.prototype={fldName:null,RenderField:ye};be.prototype={fldName:null,RenderField:we};null==window.OffSwitch||OffSwitch.IsActive("39A8E192-9EFC-4922-9FD8-343D685E163C")||(Ee.prototype={fldName:null,RenderField:Se});xe.prototype={fldName:null,RenderField:Te};Ne.prototype={fldName:null,RenderField:ke};Le.prototype={NewGroup:void 0,RenderField:void 0,RenderFieldByName:void 0};t.spMgr=new Le;n.JsGridUtil._gridWaitFullLoadEventKillSwitchIsActive||f.EventGroup.raise(document,l.SPGridEvents.gridGlobalsInitialized);"function"==typeof window.RegisterSharedWithFieldRenderer&&window.RegisterSharedWithFieldRenderer()};t.InitListViewFlightSettings=function(){if(!Boolean(p)){ListModule.Settings.SupportsFileExtensionControls=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(439);ListModule.Settings.SupportsFileHandlerForAllNonOfficeFiles=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(754);ListModule.Settings.SupportsFileExtensionDataPipe=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(461);ListModule.Settings.SupportsFileHandlerAddInPicker=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(512);ListModule.Settings.SupportsFileHandlerFileCreation=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(540);ListModule.Settings.SupportsAddToOneDrive=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134);ListModule.Settings.SupportsAddToOneDriveQCB=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(161);ListModule.Settings.SupportsPeopleHoverCard=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(0);ListModule.Settings.SupportsMaintainUserChrome=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(63);ListModule.Settings.SupportsInfiniteScroll=!1;ListModule.Settings.SupportsAddToOneDriveInSync=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(259);ListModule.Settings.SupportsPolicyTips=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(340);ListModule.Settings.SupportsRightClickECB=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(249)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(383)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(104);ListModule.Settings.SupportsShortcutLink=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(563);ListModule.Settings.SupportsDoclibAccessibility=!n.JsGridUtil.SPListView||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(169);ListModule.Settings.SupportsDoclibQCB=!n.JsGridUtil.SPListView||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(60);p=!0}};function C(e){for(var t=0;t<v.length;t++)v[t].ToggleExpandByImg(e.target.parentNode);e.stopPropagation()}function k(e,t){for(var n=0;n<v.length;n++)if(v[n].Matches(e))return v[n];return new m(e,t)}t.GetClientHierarchyManagerForWebpart=k;function L(e,n,r,i){if(t.SPClientRenderer.IsDebugMode(n))return e();try{return e()}catch(e){null==n.Errors&&(n.Errors=[]);try{e.ExecutionContext=i;Boolean(t.SPClientRenderer.AddCallStackInfoToErrors)&&"object"==typeof i&&null!=i&&"function"==typeof window.ULSGetCallstack&&(i.CallStack=window.ULSGetCallstack(L.caller))}catch(e){}n.Errors.push(e);return r}}function A(e,n){return L(function(){return(function(e,n){var r;"string"==typeof e?r=t.SPClientRenderer.ParseTemplateString(e,n):"function"==typeof e&&(r=e);return null==r?"":r(n)})(e,n)},n,"",{TemplateFunction:e,Operation:"CoreRender"})}function O(e,t){(function(e,t,n,r){if(Boolean(e)&&"function"==typeof n&&""!=t){var i=e[t];if(null==i)e[t]=n;else if("function"==typeof i){if(!Boolean(r)||String(i)!=String(n)){var s=[];s.push(i);s.push(n);e[t]=s}}else if("object"==typeof i){var o=!1;if(Boolean(r))for(var u=0;u<i.length;u++)if(i[u]==n){o=!0;break}o||e[t].push(n)}}})(e,"OnPostRender",t,!1)}function M(e,t,n){if(null==e||null==t||null==n)return null;for(var r="",i=-1,s=[],o=0,u=(s=s.concat(t.split("||"))).length;o<u;o++){var a=s[o];if(null!=a&&""!=a){for(var f=[],l=0,c=(f=f.concat(a.split(","))).length;l<c;l++){var h=f[l];if(null!=h&&""!=h)if(isNaN(Number(h))){if(-1!=h.indexOf("-")){var p,d=h.split("-");if(null==d||2!==d.length)continue;if(""===d[0])p=0;else{if(isNaN(Number(d[0])))continue;p=parseInt(d[0])}if(n>=p){if(""===d[1]){i=o;break}if(isNaN(Number(d[1])))continue;if(n<=parseInt(d[1])){i=o;break}}}else if(-1!=h.indexOf("*")){var v=h.trim().replace(/\*/g,"[0-9]*");if(new RegExp("^"+v+"$").test(n.toString())){i=o;break}}}else{if(n===parseInt(h)){i=o;break}}}if(-1!==i)break}}if(-1!==i){var m=e.split("||");null!=m&&null!=m[i]&&""!=m[i]&&(r=m[i])}return r}function _(e){return void 0!==e.allowedSuiteExtensionFileTypes&&IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,e.CurrentItem.File_x0020_Type,0)>-1||!Boolean(e.CurrentItem["File_x0020_Type.mapapp"])&&!Boolean(e.CurrentItem["serverurl.progid"])}function D(){return!(BrowserDetection.userAgent.ie8down||!ListModule.Settings.SupportsFileExtensionControls)}function P(){return!(BrowserDetection.userAgent.ie8down||!ListModule.Settings.SupportsFileHandlerForAllNonOfficeFiles)}function H(e){return null!=e&&null!=e.ListSchema&&"1"==e.ListSchema.TabularView&&1!=e.inGridMode}function B(e){return null!=e&&null!=e.CurrentFieldValue?e.CurrentFieldValue.toString():""}t.RenderFieldValueDefault=B;function j(e,t,r,i,s,o){var u=n.JsGridUtil.Internal.IsFeatureEnabled(E)?" "+c.listLink:"";e.push('<a class="ms-listlink'+u+'" onfocus="OnLink(this)" href="');e.push(ListModule.Util.createItemPropertiesTitleUrl(t,r));e.push('" onclick="');Ae(e,r,"Navigation");e.push("EditLink2(this,");e.push(t.ctxId);e.push(');return false;" target="_self">');e.push(Boolean(i.HasTitle)||Boolean(o)?s:Encoding.HtmlEncode(s));e.push("</a>")}function F(e,t){return null!=e&&-1!=e.toLowerCase().indexOf("onenote")?t?window.ListView.Strings.L_FieldType_File_OneNote:window.ListView.Strings.L_FieldType_Folder_OneNote:window.ListView.Strings.L_FieldType_Folder}function I(e,t){var n=window.ListView.Strings.L_FieldType_File;null!=e&&""!=e?-1!=e.toLowerCase().indexOf("ms-word")?n=window.ListView.Strings.L_FieldType_File_Document:-1!=e.toLowerCase().indexOf("ms-excel")?n=window.ListView.Strings.L_FieldType_File_workbook:-1!=e.toLowerCase().indexOf("ms-powerpoint")?n=window.ListView.Strings.L_FieldType_File_PPT:-1!=e.toLowerCase().indexOf("onenote")&&(n=window.ListView.Strings.L_FieldType_File_OneNote):null!=t&&""!=t&&(n=t+" "+window.ListView.Strings.L_FieldType_File);return n}function q(e){return""==e?window.ListView.Strings.L_SPClientNoTitle:e}function R(e){this.fldName=e;this.fieldRenderer=null}function U(e,t,n,r){null==this.fieldRenderer&&(this.fieldRenderer=window.ComputedFieldWorker[this.fldName]);return null!=this.fieldRenderer?this.fieldRenderer(e,t,n,r):Encoding.HtmlEncode(n[this.fldName])}function z(e){if(void 0===e["FileLeafRef.Name"]){var t=e.FileLeafRef,n=t.lastIndexOf(".");e["FileLeafRef.Name"]=n>=0?t.substring(0,n):t}}function W(e,t){return void 0!==e&&null!=e?t?e.replace(/'/g,"%27"):e.replace(/"/g,"%22"):""}function X(e,t,r,i,s){var o=[],u=e[t],a=e[t+".desc"];if("Image"==i.Format){if(ListModule.Util.isDefinedAndNotNullOrEmpty(u)){o.push("<img ");if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(494)){o.push(" class='ms-listview-image' ");o.push(" onclick='javascript:var imgUrl=\"");o.push(W(u,void 0));o.push("\"; if (_shouldOpenInLightbox(imgUrl)){_openInLightbox(imgUrl);} else{STSNavigate(imgUrl);}'")}s&&o.push('onfocus="OnLink(this)" ');o.push('src="');o.push(W(u,void 0));o.push('" alt="');o.push(a);o.push('"/>')}}else if("Hyperlink"==i.Format)if(ListModule.Util.isDefinedAndNotNullOrEmpty(u)){o.push("<a ");n.JsGridUtil.Internal.IsFeatureEnabled(N)&&o.push('tabindex="-1" ');s&&o.push('onfocus="OnLink(this)" ');o.push('href="');o.push(W(u,void 0));var f=void 0===Nav.ajaxNavigate?window.location.search.match(RegExp("[?&]IsDlg=1")):Nav.ajaxNavigate.get_search().match(RegExp("[?&]IsDlg=1"));Boolean(f)&&o.push('" target="_blank');o.push('">');""==a?o.push(Encoding.HtmlEncode(u)):o.push(Encoding.HtmlEncode(a));o.push("</a>")}else null!=a&&o.push(a);return o.join("")}function V(){var e=new URI(Nav.ajaxNavigate.get_href()).getQueryParameter("MaintainUserChrome");return ListModule.Settings.SupportsMaintainUserChrome&&Boolean(e)&&"true"==e.toLowerCase()}function $(e,t){var n=e.AdditionalQueryString;void 0!==n&&""!=n&&t.push(n)}function J(e,t,n){n.push(t.PagePath);n.push("?RootFolder=");n.push(URI_Encoding.encodeURIComponent(e.FileRef));n.push(t.ShowWebPart);n.push("&FolderCTID=");n.push(e.ContentTypeId);n.push("&View=");n.push(URI_Encoding.encodeURIComponent(t.View));$(e,n)}function K(e,t,n,r){e.push('<a onfocus="OnLink(this)" href="');J(n,r,e);e.push('" onclick="');Ae(e,n,"Navigation");e.push("javascript:EnterFolder('");e.push(r.PagePath);e.push("?RootFolder=");e.push(URI_Encoding.encodeURIComponent(n.FileRef));e.push(r.ShowWebPart);e.push("&FolderCTID=");e.push(n.ContentTypeId);e.push("&View=");e.push(URI_Encoding.encodeURIComponent(r.View));$(n,e);if(ListModule.Settings.SupportsDoclibAccessibility){e.push('\');return false;" aria-label="');e.push(Encoding.HtmlEncode(t));e.push(", "+Encoding.HtmlEncode(F(n["File_x0020_Type.mapapp"],!0))+'">')}else e.push("');return false;\">");e.push(Encoding.HtmlEncode(t));e.push("</a>")}function Q(e,t,r,i,s){V()&&(function(e,t,n){var r=e.AdditionalQueryString;if(void 0!==r&&""!=r){var i=new URI(e.FileRef+"?"+r);i.setQueryParameter(t,n);e.AdditionalQueryString="&"+i.getQuery()}else e.AdditionalQueryString="&"+t+"="+n})(i,"MaintainUserChrome","true");var o=n.JsGridUtil.Internal.IsFeatureEnabled(E)?" "+c.listLink:"";t.push('<a onfocus="OnLink(this)" class="ms-listlink'+o+'" href="');J(i,s,t);t.push('" onmousedown="');t.push("javascript:VerifyFolderHref(this,event,'");t.push(i["File_x0020_Type.url"]);t.push("','");t.push(i["File_x0020_Type.progid"]);t.push("','");t.push(s.DefaultItemOpen);t.push("','");t.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);t.push("','");t.push(i.HTML_x0020_File_x0020_Type);t.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?t.push(Encoding.ScriptEncode(i["serverurl.progid"])):t.push(i["serverurl.progid"]);t.push("');");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(226)||t.push("return false;");t.push('" onclick="');Ae(t,i,"Navigation");t.push("return HandleFolder(this,event,'");t.push(s.PagePath);t.push("?RootFolder=");t.push(URI_Encoding.encodeURIComponent(i.FileRef));t.push(s.ShowWebPart);t.push("&FolderCTID=");t.push(i.ContentTypeId);t.push("&View=");t.push(URI_Encoding.encodeURIComponent(s.View));$(i,t);var u=ListModule.Util.makeMountedFolderQueryStrParams(!0,!0);Boolean(u)&&t.push(u);t.push("','TRUE','FALSE','");t.push(i["File_x0020_Type.url"]);t.push("','");t.push(i["File_x0020_Type.progid"]);t.push("','");t.push(s.DefaultItemOpen);t.push("','");t.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);t.push("','");t.push(i.HTML_x0020_File_x0020_Type);t.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?t.push(Encoding.ScriptEncode(i["serverurl.progid"])):t.push(i["serverurl.progid"]);t.push("','");t.push(Boolean(i.CheckoutUser)?i.CheckoutUser[0].id:"");t.push("','");t.push(s.Userid);t.push("','");t.push(s.ForceCheckout);t.push("','");t.push(i.IsCheckedoutToLocal);t.push("','");t.push(i.PermMask);if(ListModule.Settings.SupportsDoclibAccessibility){t.push('\');" aria-label="');t.push(Encoding.HtmlEncode(r));t.push(", "+Encoding.HtmlEncode(F(i["File_x0020_Type.mapapp"],!0))+'">')}else t.push("');\">");t.push(Encoding.HtmlEncode(r));t.push("</a>")}function G(e){this.fldName=e}function Y(e,t,n,r){return Encoding.HtmlEncode(n[this.fldName])}function Z(e){this.fldName=e}function ee(e,t,n,r){return n[this.fldName]}function te(e){this.fldName=e}function ne(e,t,r,i){return"0"!=r[this.fldName]?'<img border="0" width="16" height="16" src="'+n.JsGridUtil.Internal.GetImageUrl("attach16.png")+'"/>':""}function re(e){this.fldName=e}function ie(e,t,n,r){var i=n[this.fldName],s='<img border="0" width="16" height="16" src="';s+=ListView.ImageBasePath;s+="/_layouts/15/images/";if("1"==i){var o=n.EventType;s+="3"==o||"4"==o?"recurEx.gif":"recur.gif"}else s+="blank.gif";s+='" alt="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;s+='" title="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;return s+='"/>'}function se(e){this.fldName=e}function oe(e,t,r,i){if("1"!=r.WorkspaceLink&&"-1"!=r.WorkspaceLink)return'<img border="0" width="16" height="16" src="'+ListView.ImageBasePath+'/_layouts/15/images/blank.gif" />';var s='<a href="';s+=r.Workspace;s+='" target="_self" title="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;s+='"><img border="" src="'+n.JsGridUtil.Internal.GetImageUrl("mtgicon.gif")+'" alt="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;return s+='"/></a>'}function ue(e){this.fldName=e}function ae(e,t,n,r){return n[this.fldName]==window.ListView.Strings.L_SPYes?window.ListView.Strings.L_SPYes:""}function fe(e){this.fldName=e}function le(e,t,r,i){var s=r[this.fldName];if(n.JsGridUtil.Internal.IsFeatureEnabled(S)&&s){var o=t&&t.Unit||"None",a=t&&t.CustomUnitName||"",f=!t||!t.CustomUnitOnRight||"TRUE"===t.CustomUnitOnRight;s=u.getDisplayStringWithUnit(o,s,a,f)}n.JsGridUtil.Internal.IsFeatureEnabled(T)&&null!=t.CommaSeparator&&(s=u.formatNumberString(s,t.CommaSeparator));null==window.OffSwitch||OffSwitch.IsActive("856528C6-8452-44E4-A756-32C6E13004E3")||"Calculated"!=t.FieldType||(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(68)||Boolean(_spPageContextInfo)&&Boolean(_spPageContextInfo.AllowCustomMarkupInCalculatedField)?s=Encoding.HtmlEncode(s):t.scriptLogged||(t.scriptLogged=!0));return'<div align="right" class="ms-number'+(n.JsGridUtil.Internal.IsFeatureEnabled(E)&&e.fixedHeightRowEnabled?" "+c.cellHiddenOverflow:"")+'">'+s+"</div>"}function ce(e){this.fldName=e}function he(e,t,n,r){var i=e.CurrentFieldSchema,s=n[this.fldName];""==s&&(s=window.ListView.Strings.L_BusinessDataField_Blank);var o='<table cellpadding="0" cellspacing="0" style="display=inline">';o+="<tr>";if(Boolean(i.HasActions)){o+='<td><input type="hidden" name="BusinessDataField_ActionsMenuProxyPageWebUrl" id="BusinessDataField_ActionsMenuProxyPageWebUrl" value="'+e.HttpRoot+'" />';o+='<div style="display=inline">';o+='<table cellspacing="0">';o+="<tr>";o+='<td class="ms-vb" valign="top" nowrap="nowrap">';o+='<span class="ms-SPLink ms-hovercellinactive" onmouseover="this.className=\'ms-SPLink ms-HoverCellActive\';" onmouseout="this.className=\'ms-SPLink ms-HoverCellInactive\';">';var u="",a="",f="";if(Boolean(e.ExternalDataList)){u="showActionMenuInExternalList("+(f="'"+window.ListView.Strings.L_BusinessDataField_ActionMenuLoadingMessage+"',null,true,'"+e.LobSystemInstanceName+"','"+e.EntityNamespace+"','"+e.EntityName+"','"+e.SpecificFinderName+"','"+i.AssociationName+"','"+i.SystemInstanceName+"','"+i.EntityNamespace+"','"+i.EntityName+"','"+n.ID+"', event")+")";a="actionMenuOnKeyDownInExternalList("+f+")"}else if(void 0!==t.RelatedField&&""!=t.RelatedField&&void 0!==n[t.RelatedField]&&""!=n[t.RelatedField]){u="showActionMenu("+(f="'"+window.ListView.Strings.L_BusinessDataField_ActionMenuLoadingMessage+"',null,true,'"+i.SystemInstanceName+"','"+i.EntityNamespace+"','"+i.EntityName+"','"+n[t.RelatedField]+"', event")+")";a="actionMenuOnKeyDown("+f+")"}o+='<a style="cursor:hand;white-space:nowrap;">';o+='<img border="0" align="absmiddle" src='+ListView.ImageBasePath+'/_layouts/15/images/bizdataactionicon.gif?rev=47 tabindex="0" alt="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'" title="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'"';o+=' onclick="'+u+'"';o+=' onkeydown="'+a+'" />';o+="</a>";o+="<a>";o+='<img align="absmiddle" src='+ListView.ImageBasePath+'/_layouts/15/images/menudark.gif?rev=47 tabindex="0" alt="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'"';o+=' onclick="'+u+'"';o+=' onkeydown="'+a+'" />';o+="</a>";o+="</span>";o+="</td>";o+="</tr>";o+="</table>";o+="</div>";o+='<div STYLE="display=inline" />';o+="</td>"}o+='<td class="ms-vb">';""!=i.Profile&&"True"==i.ContainsDefaultAction?o+='<a href="'+e.HttpRoot+i.Profile+n[t.RelatedField]+'" >'+s+"</a>":o+=s;o+="</td>";o+="</tr>";return o+="</table>"}function pe(e){this.fldName=e}function de(e,t,r,o){var u,f,l,c,h=r[this.fldName];null==window.OffSwitch||OffSwitch.IsActive("856528C6-8452-44E4-A756-32C6E13004E3")||"Calculated"!=t.FieldType||(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(68)?h=Encoding.HtmlEncode(h):t.scriptLogged||(t.scriptLogged=!0));if(null==h)return"";var p=r[this.fldName+".FriendlyDisplay"],d=null;null!=p&&""!=p&&(d=w?(function(e){var t=null,n=null,r=e.split("|"),i=Boolean(window.ListView)&&Boolean(window.ListView.Strings)?window.ListView.Strings:Strings.STS;if("0"==r[0])return e.substring(2);var s="1"==r[1],o=r[2],u=r.length>=4?r[3]:null,a=r.length>=5?r[4]:null;switch(o){case"1":t=s?i.L_RelativeDateTime_AFewSecondsFuture:i.L_RelativeDateTime_AFewSeconds;break;case"2":t=s?i.L_RelativeDateTime_AboutAMinuteFuture:i.L_RelativeDateTime_AboutAMinute;break;case"3":n=M(s?i.L_RelativeDateTime_XMinutesFuture:i.L_RelativeDateTime_XMinutes,s?i.L_RelativeDateTime_XMinutesFutureIntervals:i.L_RelativeDateTime_XMinutesIntervals,Number(u));break;case"4":t=s?i.L_RelativeDateTime_AboutAnHourFuture:i.L_RelativeDateTime_AboutAnHour;break;case"5":null==u?t=s?i.L_RelativeDateTime_Tomorrow:i.L_RelativeDateTime_Yesterday:n=s?i.L_RelativeDateTime_TomorrowAndTime:i.L_RelativeDateTime_YesterdayAndTime;break;case"6":n=M(s?i.L_RelativeDateTime_XHoursFuture:i.L_RelativeDateTime_XHours,s?i.L_RelativeDateTime_XHoursFutureIntervals:i.L_RelativeDateTime_XHoursIntervals,Number(u));break;case"7":null==a?t=u:n=i.L_RelativeDateTime_DayAndTime;break;case"8":n=M(s?i.L_RelativeDateTime_XDaysFuture:i.L_RelativeDateTime_XDays,s?i.L_RelativeDateTime_XDaysFutureIntervals:i.L_RelativeDateTime_XDaysIntervals,Number(u));break;case"9":t=i.L_RelativeDateTime_Today}if(null!=n){t=n.replace("{0}",u);null!=a&&(t=t.replace("{1}",a))}return t})(p):a.getRelativeDateTimeStringForLists(p));var v='<span class="ms-noWrap" title="'+h+'">',m=!n.JsGridUtil.SpRegionalSettings.calendarType||1===n.JsGridUtil.SpRegionalSettings.calendarType;if(""!==h&&n.JsGridUtil.Internal.IsFeatureEnabled(x)&&t&&m){var g=i.DateFormat[t.DateFormat],y=i.TimeFormat[t.TimeFormat],b=r[this.fldName+"."],E=b?new Date(b):void 0,S=null===(f=null===(u=_spPageContextInfo)||void 0===u?void 0:u.webTimeZoneData)||void 0===f?void 0:f.Bias,T=null===(c=null===(l=_spPageContextInfo)||void 0===l?void 0:l.webTimeZoneData)||void 0===c?void 0:c.DaylightBias,N={includeDate:!0,includeTime:!("DateOnly"===t.Format),dateFormat:g,timeFormat:y,locale:o.Locale},C=h;if(void 0!==E&&void 0!==S&&void 0!==T){E=s.shiftTimeByTimeZoneAndDST(E,S,T);C=i.formatDateTime(E,h,d,N)}v+=d||C}else v+=null!=d&&""!=d?d:h;return v+="</span>"}function ve(e){this.fldName=e}function me(e,t,n,r){return null!=t.AutoHyperLink?n[this.fldName]:Encoding.HtmlEncode(n[this.fldName])}function ge(e){this.fldName=e}function ye(e,t,r,i){var s=r[this.fldName];if(!Boolean(s))return"";if("string"==typeof s)return Encoding.HtmlEncode(s);if(null!=t.RenderAsText)return(function(e){if(!Boolean(e))return"";o=[];for(u=0;u<e.length;u++){u>0&&o.push("; ");o.push(Encoding.HtmlEncode(e[u].lookupValue))}return o.join("")})(s);if(!Boolean(t.DispFormUrl))return"";for(var o=[],u=0;u<s.length;u++){u>0&&o.push("; ");var a=[];null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?a.push(Encoding.ScriptEncode(t.DispFormUrl)):a.push(t.DispFormUrl);a.push("&ID=");a.push(s[u].lookupId.toString());a.push("&RootFolder=*");var f=a.join("");o.push("<a ");n.JsGridUtil.Internal.IsFeatureEnabled(N)&&o.push('tabindex="-1" ');o.push("onclick=\"OpenPopUpPage('");null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?o.push(f):o.push(Encoding.ScriptEncode(f));o.push("', RefreshPage); return false;\" ");o.push('href="');null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?o.push(f):o.push(W(f,void 0));o.push('">');o.push(Encoding.HtmlEncode(s[u].lookupValue));o.push("</a>")}return o.join("")}function be(e){this.fldName=e}function we(e,t,r,i){var s,o,u,a,f,l=[],h=r[this.fldName];if(n.JsGridUtil.Internal.IsFeatureEnabled(E)&&e.fixedHeightRowEnabled){f=" "+c.cellHiddenOverflow;if(b){var p=document.createElement("div");p.innerHTML=h;a=p.textContent||p.innerText||h}else a="Note"===t.Type&&"FALSE"===t.RichText?null===(s=h)||void 0===s?void 0:s.replace(/\&lt;br\&gt;/g," "):"Note"===t.Type&&"TRUE"===t.RichText?null===(o=h)||void 0===o?void 0:o.replace(/(<\s*\/?\s*(div|br|p|ul|li|blockquote)\s*.*?>)|(font-size\s*.*?pt;)/g," "):h}else{f="";a=h;y||"Note"!==t.Type||"FALSE"!==t.RichText||(a=null===(u=a)||void 0===u?void 0:u.replace(/\&lt;br\&gt;/g,"<br>"))}l.push('<div dir="');l.push(t.Direction);l.push('" class="ms-rtestate-field'+f+'">');l.push(a);l.push("</div>");return l.join("")}function Ee(e){this.fldName=e}function Se(e,t,n,r){var i,s=n[this.fldName];s.DisplayName?i=s.DisplayName:s.Address&&s.Address.Street&&(i=s.Address.Street);return Encoding.HtmlEncode(i)}function xe(e){this.fldName=e}function Te(e,t,n,r){return X(n,this.fldName,0,t,!1)}function Ne(e){this.fldName=e}function Ce(e,t){void 0!==t.piCD&&""!=t.piCD&&void 0===e.piCD&&(e.piCD=t.piCD);void 0!==t.piPC&&""!=t.piPC&&void 0===e.piPC&&(e.piPC=t.piPC)}function ke(e,t,n,r){var i=n[this.fldName];if("string"==typeof i&&(""==i||"***"==i))return i;var s=[],o=t.DefaultRender&&t.AllowMultipleValues;if(o&&t.InlineRender){for(var u=[],a=0;a<i.length;a++){var f=i[a];Ce(f,n);u.push(void 0)}if(1===u.length)s.push(u[0]);else if(2===u.length)s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineTwo),u[0],u[1]));else if(3===u.length)s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineThree),u[0],u[1],u[2]));else{var l="",c="";if(Boolean(t.InlineRenderMoreAsLink)){l='<a href="#" onclick="return false;" class="ms-imnMoreLink ms-link">';c="</a>"}var h=u.length-3;s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineMore),u[0],u[1],u[2],l,String(h),c))}}else{o&&s.push("<table style='padding:0px; border-spacing:0px; border:none'><tr><td class='ms-vb'>");var p=!0;for(var d in i){p?p=!1:t.AllowMultipleValues&&(o?s.push("</td></tr><tr><td class='ms-vb'>"):t.WithPicture||t.WithPictureDetail||t.PictureOnly||s.push("; "));var v=i[d];Ce(v,n);s.push(void 0)}o&&s.push("</td></tr></table>")}return s.join("")}function Le(){this.NewGroup=function(e,t){return"1"==e[t]};function e(e,t,n,r){if(void 0===t.FieldRenderer){var i={Computed:new R(t.Name),Attachments:new te(t.Name),User:new Ne(t.Name),UserMulti:new Ne(t.Name),URL:new xe(t.Name),Note:new be(t.Name),Recurrence:new re(t.Name),CrossProjectLink:new se(t.Name),AllDayEvent:new ue(t.Name),Number:new fe(t.Name),BusinessData:new ce(t.Name),Currency:new fe(t.Name),DateTime:new pe(t.Name),Text:new ve(t.Name),Lookup:new ge(t.Name),LookupMulti:new ge(t.Name),WorkflowStatus:new Z(t.Name),Location:void 0};null==window.OffSwitch||OffSwitch.IsActive("39A8E192-9EFC-4922-9FD8-343D685E163C")||(i.Location=new Ee(t.Name));if("1"==t.XSLRender)t.FieldRenderer=new Z(t.Name);else{t.FieldRenderer=i[t.FieldType];null==t.FieldRenderer&&(t.FieldRenderer=i[t.Type])}null==t.FieldRenderer&&(t.FieldRenderer=new G(t.Name))}return t.FieldRenderer.RenderField(e,t,n,r)}this.RenderField=function(r,i,s,o){if(void 0===i.fieldRenderer){var u,a,f=r.Templates.Fields,l=i.Name;null!=f[l]&&(u=f[l]);null!=u&&""!=u&&u!=B?"string"==typeof u?a=t.SPClientRenderer.ParseTemplateString(u,r):"function"==typeof u&&(a=u):a=e;i.fieldRenderer=a}r.CurrentFieldSchema=i;var h=i.fieldRenderer(r,i,s,o);r.CurrentFieldSchema=null;if(null!=i.Direction){var p=[];p.push('<span dir="');p.push(i.Direction);p.push('">');p.push(h);p.push("</span>");h=p.join("")}if(null!=i.linkToItem){p=[];"1"==s.FSObjType?"1"==o.IsDocLib?Q(0,p,h,s,o):K(p,h,s,o):j(p,r,s,o,q(s[i.Name]),!0);h=p.join("")}o.UseParentHierarchy&&o.ParentHierarchyDisplayField==i.Name&&(h=(function(e,t,r,i,s){if(e.inGridMode)return s;var o=e.ListData.HierarchyHasIndention?22:0,u=e.ListData.HierarchyHasIndention?13:0,a=[],f=e.ctxId+","+r.ID+","+r.FSObjType,l="idExpandCollapse"+f;a.push('<span style="');r.isParent&&a.push("font-weight: bold;");a.push("float: ");a.push(DOM.rightToLeft?"right":"left");a.push("; margin-");a.push(DOM.rightToLeft?"right":"left");a.push(":");var c=parseInt(r.outlineLevel);if(c<=1)h=r.isParent?0:u;else{var h=(c-1)*o;r.isParent||(h+=u)}a.push(h);a.push('px">');a.push("<table><tr>");if(r.isParent){a.push('<td style="vertical-align: top;"><span id="');a.push(l);a.push('" class="ms-commentcollapse'+(DOM.rightToLeft?"rtl":"")+'-iconouter"><img src="');a.push(n.JsGridUtil.Internal.GetImageUrl("spcommon.png"));a.push('" class="ms-commentcollapse'+(DOM.rightToLeft?"rtl":"")+'-icon"/></span></td>')}a.push("<td>");a.push(s);a.push("</td></tr></table></span>");function p(){var t=e.hierarchyMgr;null==t&&(t=e.hierarchyMgr=k(e.wpq,DOM.rightToLeft));if(r.isParent){var i=document.getElementById(l);null!=i&&window.$addHandler(i,"click",C);var s=n.JsGridUtil.Internal.DomElement.GetInstance().GetAncestorByTag(i,"TR");null!=s&&(s.style.fontWeight="bold")}t.RegisterHierarchyNode(parseInt(r.ID),null==r.parentID?null:parseInt(r.parentID),f,l)}O(e,function(){setTimeout(p,0)});return a.join("")})(r,0,s,0,h));var d=s["CustomData."];null!=d&&void 0!==d&&0!=Boolean(d)||(null!=i.CalloutMenu?h=(function(e,t,r,i,s){var o=[],u="ctx"+e.ctxId+"_"+t.ID+"_calloutLaunchPoint",a=e.ListSchema,f=n.JsGridUtil.Internal.IsFeatureEnabled(E)&&e.fixedHeightRowEnabled?" "+c.cellHiddenOverflow:"";o.push('<div class="ms-vb '+(1==s?"":"ms-tableCell ms-list-TitleLink")+f+' itx" CTXName="ctx');o.push(e.ctxId);o.push('" id="');o.push(t.ID);if(!OffSwitch.IsActive("18AE54C9-EB03-45F3-8768-DFB1CC034209")&&t.PermMask){o.push('" Perm="');o.push(t.PermMask)}o.push('" App="');o.push(t["File_x0020_Type.mapapp"]);o.push('">');o.push(i);o.push("</div>");if(1==s){o.push('</td><td class="ms-list-itemLink-td ms-cellstyle');a.Field[a.Field.length-1]==r&&o.push(" ms-vb-lastCell");o.push('" role="gridcell">')}if(!PageMinimized())if(void 0!==t.RenderCalloutWithoutHover&&t.RenderCalloutWithoutHover)o.push(Oe(!1,t,u,!0));else{o.push('<div class="ms-list-itemLink '+(1==s?"":"ms-tableCell ms-alignRight")+' " ');o.push(' onclick="ShowMenuForTrOuter(this,event, true); return false;" >');o.push(Oe(!0,t,u,!1));o.push("</div>")}return o.join("")})(r,s,i,h,H(r)):null!=i.listItemMenu&&(h=g(r,s,i,h,H(r))));return h};this.RenderFieldByName=function(e,t,n,r){var i="",s=!1;for(var o in r.Field){var u=r.Field[o];if(u.Name==t){var a=e.CurrentFieldSchema;e.CurrentFieldSchema=u;i=this.RenderField(e,u,n,r);e.CurrentFieldSchema=a;s=!0;break}}s||(i=Encoding.HtmlEncode(n[t]));return i}}function Ae(e,t,n){if(void 0!==t.piCD&&""!=t.piCD){if(void 0!==t.piPC&&""!=t.piPC){e.push("RecordClickForPaging('"+Encoding.HtmlEncode(n)+"','");e.push(Encoding.HtmlEncode(t.piCD));e.push("','");e.push(Encoding.HtmlEncode(t.piPC))}else{e.push("RecordClick('Navigation','");e.push(Encoding.HtmlEncode(t.piCD))}e.push("');")}}function Oe(e,t,r,i){var s=[],o=Boolean(i),u="ms-lstItmLinkAnchor "+(o?"ms-ellipsis-a-tile":"ms-ellipsis-a");s.push('<a ms-jsgrid-click-passthrough="true" class="'+u+'" title="');s.push(Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenuAriaLabel));s.push('" aria-haspopup="true" aria-expanded="false"');s.push('onclick="');i||Ae(s,t,"Hover");e?s.push("OpenCalloutAndSelectItem(this, event, this, '"+t.ID+'\'); return false;" href="#" id="'+r+'" >'):s.push("OpenCallout(this, event, this, '"+t.ID+'\'); return false;" href="#" id="'+r+'" >');var a=o?"ms-ellipsis-icon-tile":"ms-ellipsis-icon";s.push('<img class="'+a+'" src="'+n.JsGridUtil.Internal.GetImageUrl("spcommon.png")+'" alt="'+Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenu)+'" /></a>');return s.join("")}t.RenderGroup=function(e,t){return Me(e,t,!1)};function Me(e,n,r){var i=e.ListSchema,s=i.group1,o=i.group2,u=null==i.Collapse||"TRUE"!=i.Collapse,a=e.ctxId,f="undefined"!=typeof ctx?ctx:e,l=Boolean(f.ExternalDataList),c="",h=e.Templates.Group;null==h||h==_e||"function"!=typeof h&&"string"!=typeof h?h=De:"string"==typeof h&&(h=t.SPClientRenderer.ParseTemplateString(h,e));a+="-";a+=n[s+".groupindex"];"1"==n[s+".newgroup"]&&(c+=h(e,s,a,n,i,1,u));if("1"==n[s+".newgroup"]||null!=o&&"1"==n[o+".newgroup"]){null==o||r||(c+=h(e,o,a+=n[o+".groupindex2"],n,i,2,u));c+=(function(e,t,n){var r='<tbody id="tbod';r+=e;r+='_"';!t&&n&&(r+=' style="display: none;"');r+=' isLoaded="';r+=t||n?"true":"false";return r+='"/>'})(a,u,l)}return c}t.RenderGroupEx=Me;function _e(e){return null!=e&&"function"==typeof e.RenderItems?e.RenderItems(e):""}function De(e,r,i,s,o,u,a){e.CurrentItem=s;var f='<tbody id="titl';f+=i;f+='" groupString="';f+=s[r+".urlencoded"];f+='"';2!=u||a||(f+=' style="display:none"');f+='><tr><td colspan="100" nowrap="nowrap" class="ms-gb';2==u&&(f+="2");f+='">';2==u&&(f+="<img src="+ListView.ImageBasePath+'"/_layouts/15/images/blank.gif?rev=47" alt="" height="1" width="10">');f+='<a href="javascript:" onclick="javascript:ExpCollGroup(';f+="'";f+=i;f+="', 'img_";f+=i;f+="',event, false);return false;";f+='">';var l=null,c=null;if(DOM.rightToLeft){l=a?"ms-commentcollapsertl-iconouter":"ms-commentexpandrtl-iconouter";c=a?"ms-commentcollapsertl-icon":"ms-commentexpandrtl-icon"}else{l=a?"ms-commentcollapse-iconouter":"ms-commentexpand-iconouter";c=a?"ms-commentcollapse-icon":"ms-commentexpand-icon"}var h=a?window.ListView.Strings.L_SPCollapse:window.ListView.Strings.L_SPExpand;f+='<span class="';f+=l;f+='"><img class="';f+=c;f+='" src="';f+=n.JsGridUtil.Internal.GetImageUrl("spcommon.png");f+='" alt="';f+=h;f+='" id="img_';f+=i;f+='" /></span>';for(var p,d=r,v=0;v<o.Field.length;v++){var m=o.Field[v];if(m.Name==r){d=m.DisplayName;p=m;break}}f+=Encoding.HtmlEncode(d);f+="</a> : ";if(null!=p)if("Number"==p.Type||"Currency"==p.Type)f+=s[m.Name];else if("DateTime"==p.Type&&Boolean(s[m.Name+".groupdisp"]))f+=s[m.Name+".groupdisp"];else if("User"==p.Type||"UserMulti"==p.Type)f+=s[m.Name+".span"];else{e.CurrentItemIdx=v;s[r+".groupHeader"]=!0;f+=t.spMgr.RenderFieldByName(e,r,s,o);delete s[r+".groupHeader"];e.CurrentItemIdx=-1}f+=' <span style="font-weight: lighter; display: inline-block;">(';f+=2==u?s[r+".COUNT.group2"]:s[r+".COUNT.group"];f+=")</span></td></tr></tbody>";var g=o.Aggregate;null==g||e.inGridMode||(f+=Pe(e,i,s,o,u,a,g));e.CurrentItem=null;return f}function Pe(e,t,n,r,i,s,o){var u="";if(null==t){u+='<tbody id="aggr';u+=e.wpq;u+='">'}else{u='<tbody id="aggr';u+=t;u+='_"';s||(u+=' style="display:none"');u+=">"}u+='<tr id="agg';u+=e.wpq;u+='"><td/>';var a="";1==i?a=".agg":2==i&&(a=".agg2");var f=r.Field;for(var l in f){var c=f[l];if(null!=c.GroupField)break;u+='<td class="ms-vb2">';var h=o[c.Name];if(null!=h&&""!=h){u+="<nobr><b>";var p,d;if("COUNT"==h){p=window.ListView.Strings.L_SPCount;d=c.Name+".COUNT"+a}if("SUM"==h){p=window.ListView.Strings.L_SPSum;d=c.Name+".SUM"+a}else if("AVG"==h){p=window.ListView.Strings.L_SPAvg;d=c.Name+".AVG"+a}else if("MAX"==h){p=window.ListView.Strings.L_SPMax;d=c.Name+".MAX"+a}else if("MIN"==h){p=window.ListView.Strings.L_SPMin;d=c.Name+".MIN"+a}else if("STDEV"==h){p=window.ListView.Strings.L_SPStdev;d=c.Name+".STDEV"+a}else if("VAR"==h){p=window.ListView.Strings.L_SPVar;d=c.Name+".VAR"+a}else{p=window.ListView.Strings.L_SPCount;d=c.Name+".COUNT"+a}u+=p;u+="=&nbsp;";u+=Boolean(n)?n[d]:"0";u+="</b></nobr>"}u+="</td>";!H(e)||"TRUE"!=c.CalloutMenu&&"TRUE"!=c.listItemMenu||(u+="<td></td>")}return u+="</tr></tbody>"}t.RenderAggregate=Pe});
define("Qze",["require","exports","cGe","ce"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k=r.Killswitch.isActivated("042F9C52-243F-407C-8752-4E8F7D7623B1","5/13/2020","Make sure to check the ListModule object presence on the window because some 3rd party code can already instantiate the object");t.globalInit=function(){window.RegisterModuleInit=P;window.commonShowModalDialog=q;window.ExecuteAndRegisterBeginEndFunctions=_;window.ExecuteOrDelayUntilScriptLoaded=j;window.currentCtx=null;window._dlgWndTop=I;window.ctx=void 0;window.setInnerText=z;window.GetImageUrlWithRevision=W;window.IsFullNameDefined=K;void 0===i&&((i={__namespace:!0}).IsActive=function(e){var t=window.g_SPOffSwitches,n=null;if(null==t){var r=window._spPageContextInfo;n=null==r?null:r.killSwitches;t=n}null==t||t.hasOwnProperty("C1AF433B-A979-4DD9-8C60-56024438168A")||e&&(e=e.toUpperCase().replace(/[{}]/g,""));return null!=t&&t.hasOwnProperty(e)});window.OffSwitch=i;if(void 0===s){s={__namespace:!0};(function(){s.MismatchError=function(e,t,n){Error.call(this,n);this.expected=e;this.actual=t};s.MismatchError.prototype=new Error;s.ArgumentTypeError=function(e,t){s.MismatchError.call(this,e,t,"runtime type mismatch")};s.ArgumentTypeError.prototype=new s.MismatchError})()}void 0===o&&(o={__namespace:!0});void 0===u&&(u={__namespace:!0});void 0===a&&(a={__namespace:!0});(function(){t.prototype={firefox:void 0,firefox36up:void 0,firefox3up:void 0,firefox4up:void 0,ie:void 0,ie55up:void 0,ie5up:void 0,ie7down:void 0,ie8down:void 0,ie8standard:void 0,ie8standardUp:void 0,ie9down:void 0,ie9standardUp:void 0,ipad:void 0,windowsphone:void 0,chrome:void 0,chrome7up:void 0,chrome8up:void 0,chrome9up:void 0,iever:void 0,mac:void 0,major:void 0,msTouch:void 0,isTouch:void 0,nav:void 0,nav6:void 0,nav6up:void 0,nav7up:void 0,osver:void 0,safari:void 0,safari125up:void 0,safari3up:void 0,verIEFull:void 0,w3c:void 0,webKit:void 0,win:void 0,win8AppHost:void 0,win32:void 0,win64bit:void 0,winnt:void 0,armProcessor:void 0};e.prototype=t.prototype;e.prototype.ie10standardUp=void 0;e.prototype.ie11=void 0;e.prototype.ie11up=void 0;e.prototype.msEdge=void 0;function e(){var e,t=navigator.userAgent.toLowerCase();this.osver=1;if(Boolean(t)){var n=t.substring(t.indexOf("windows ")+11);this.osver=parseFloat(n)}this.major=parseInt(navigator.appVersion);this.msEdge=-1!=t.indexOf("edge/");var r=t.indexOf("msie"),i=t.indexOf("trident");this.ie=-1!=r||-1!=i;var s="0";if(this.ie)if(-1!=r)s=t.substring(r+5);else{var o=t.indexOf("rv:");-1!=o&&(s=t.substring(o+3))}this.iever=parseInt(s);this.verIEFull=parseFloat(s);this.ie4up=this.ie&&this.major>=4;this.ie5up=this.ie&&this.iever>=5;this.ie55up=this.ie&&this.verIEFull>=5.5;this.ie6up=this.ie&&this.iever>=6;this.ie7down=this.ie&&this.iever<=7;this.ie8down=this.ie&&this.iever<=8;this.ie9down=this.ie&&this.iever<=9;this.ie7up=this.ie&&this.iever>=7;this.ie8standard=this.ie&&Boolean(document.documentMode)&&8==document.documentMode;this.ie8standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=8;this.ie9standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=9;this.ie10standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=10;this.ie11=this.ie&&Boolean(document.documentMode)&&11==document.documentMode;this.ie11up=this.ie&&Boolean(document.documentMode)&&document.documentMode>=11;this.nav=-1!=t.indexOf("mozilla")&&-1==t.indexOf("spoofer")&&-1==t.indexOf("compatible")&&!this.ie;this.nav6=this.nav&&5==this.major;this.nav6up=this.nav&&this.major>=5;this.nav7up=!1;this.nav6up&&(e=t.indexOf("netscape/"))>=0&&(this.nav7up=parseInt(t.substring(e+9))>=7);this.winnt=-1!=t.indexOf("winnt")||-1!=t.indexOf("windows nt");this.win32=this.major>=4&&"Win32"==navigator.platform||-1!=t.indexOf("win32")||-1!=t.indexOf("32bit");this.win64bit=-1!=t.indexOf("win64");this.win=this.winnt||this.win32||this.win64bit;this.safari=-1!=t.indexOf("webkit")&&!this.ie&&!this.msEdge;this.safari125up=!1;this.safari3up=!1;if(this.safari&&this.major>=5){(e=t.indexOf("webkit/"))>=0&&(this.safari125up=parseInt(t.substring(e+7))>=125);var u=t.indexOf("version/");u>=0&&(this.safari3up=parseInt(t.substring(u+8))>=3)}this.firefox=this.nav&&-1!=t.indexOf("firefox");this.firefox3up=!1;this.firefox36up=!1;this.firefox4up=!1;if(this.firefox&&this.major>=5){var a=t.indexOf("firefox/");if(a>=0){var f=t.substring(a+8);this.firefox3up=parseInt(f)>=3;this.firefox36up=parseFloat(f)>=3.6;this.firefox4up=parseInt(f)>=4}}this.chrome=this.nav&&-1!=t.indexOf("chrome")&&!this.ie&&!this.msEdge;this.chrome7up=!1;this.chrome8up=!1;this.chrome9up=!1;if(this.chrome&&this.major>=5){var l=t.indexOf("chrome/");if(l>=0){var c=t.substring(l+7),h=parseInt(c);this.chrome7up=h>=7;this.chrome8up=h>=8;this.chrome9up=h>=9}}this.ipad=-1!=t.indexOf("ipad");this.windowsphone=-1!=t.indexOf("windows phone");this.aol=this.ie&&-1!=t.indexOf(" aol ");this.mac=-1!=t.indexOf("mac");this.w3c=this.nav6up;this.webKit=-1!=t.indexOf("webkit")&&!this.ie&&!this.msEdge;this.win8AppHost=-1!=t.indexOf("msapphost");this.msTouch=void 0!==navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>0;this.isTouch=this.msTouch||"ontouchstart"in document.documentElement;this.armProcessor=-1!=t.indexOf("arm")}function t(){var e,t=navigator.userAgent.toLowerCase();this.osver=1;if(Boolean(t)){var n=t.substring(t.indexOf("windows ")+11);this.osver=parseFloat(n)}this.major=parseInt(navigator.appVersion);this.nav=-1!=t.indexOf("mozilla")&&-1==t.indexOf("spoofer")&&-1==t.indexOf("compatible");this.nav6=this.nav&&5==this.major;this.nav6up=this.nav&&this.major>=5;this.nav7up=!1;this.nav6up&&(e=t.indexOf("netscape/"))>=0&&(this.nav7up=parseInt(t.substring(e+9))>=7);this.ie=-1!=t.indexOf("msie");this.ipad=-1!=t.indexOf("ipad");this.windowsphone=-1!=t.indexOf("windows phone");this.aol=this.ie&&-1!=t.indexOf(" aol ");if(this.ie){var r=t.substring(t.indexOf("msie ")+5);this.iever=parseInt(r);this.verIEFull=parseFloat(r)}else this.iever=0;this.ie4up=this.ie&&this.major>=4;this.ie5up=this.ie&&this.iever>=5;this.ie55up=this.ie&&this.verIEFull>=5.5;this.ie6up=this.ie&&this.iever>=6;this.ie7down=this.ie&&this.iever<=7;this.ie8down=this.ie&&this.iever<=8;this.ie9down=this.ie&&this.iever<=9;this.ie7up=this.ie&&this.iever>=7;this.ie8standard=this.ie&&Boolean(document.documentMode)&&8==document.documentMode;this.ie8standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=8;this.ie9standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=9;this.ie10standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=10;this.winnt=-1!=t.indexOf("winnt")||-1!=t.indexOf("windows nt");this.win32=this.major>=4&&"Win32"==navigator.platform||-1!=t.indexOf("win32")||-1!=t.indexOf("32bit");this.win64bit=-1!=t.indexOf("win64");this.win=this.winnt||this.win32||this.win64bit;this.mac=-1!=t.indexOf("mac");this.w3c=this.nav6up;this.webKit=-1!=t.indexOf("webkit");this.safari=-1!=t.indexOf("webkit");this.safari125up=!1;this.safari3up=!1;if(this.safari&&this.major>=5){(e=t.indexOf("webkit/"))>=0&&(this.safari125up=parseInt(t.substring(e+7))>=125);var i=t.indexOf("version/");i>=0&&(this.safari3up=parseInt(t.substring(i+8))>=3)}this.firefox=this.nav&&-1!=t.indexOf("firefox");this.firefox3up=!1;this.firefox36up=!1;this.firefox4up=!1;if(this.firefox&&this.major>=5){var s=t.indexOf("firefox/");if(s>=0){var o=t.substring(s+8);this.firefox3up=parseInt(o)>=3;this.firefox36up=parseFloat(o)>=3.6;this.firefox4up=parseInt(o)>=4}}this.win8AppHost=-1!=t.indexOf("msapphost");this.chrome=this.nav&&-1!=t.indexOf("chrome");this.chrome7up=!1;this.chrome8up=!1;this.chrome9up=!1;if(this.chrome&&this.major>=5){var u=t.indexOf("chrome/");if(u>=0){var a=t.substring(u+7),f=parseInt(a);this.chrome7up=f>=7;this.chrome8up=f>=8;this.chrome9up=f>=9}}this.msTouch=void 0!==navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>0;this.isTouch=this.msTouch||"ontouchstart"in document.documentElement;this.armProcessor=-1!=t.indexOf("arm")}"undefined"!=typeof _browserisFlight?a.userAgent=new e:a.userAgent=new t})();void 0===f&&(f={__namespace:!0});if(void 0===l){l={__namespace:!0};(function(){l.rightToLeft="rtl"==document.documentElement.dir;l.GetElementsByName=function(e){var t;0==(t=document.getElementsByName(e)).length&&Boolean(XMLHttpRequest)&&(t=(function(e,t){var n,r=[],i=e.getElementById(t);for(;null!=i;){r.push(i);i.id="";i=e.getElementById(t)}for(n=0;n<r.length;n++)r[n].id=t;return r})(document,e));return t};l.AddEventHandler=function(e,t,n,r){if(Boolean(e.addEventListener)){r=void 0!==r&&null!=r&&r;e.addEventListener(t.substr(2),n,r)}else Boolean(e.attachEvent)&&e.attachEvent(t,n)}})()}if(void 0===c){c={__namespace:!0};(function(){c.HtmlEncode=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;default:n.push(s)}}return n.join("")};c.HtmlEncodeEx=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;case"#":n.push("%23");break;case"%":n.push("%25");break;default:n.push(s)}}return n.join("")};c.ScriptEncode=function(e){if(null==e||void 0===e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charCodeAt(r);if(s>4095)n.push("\\u"+s.toString(16).toUpperCase());else if(s>255)n.push("\\u0"+s.toString(16).toUpperCase());else if(s>127)n.push("\\u00"+s.toString(16).toUpperCase());else{var o=t.charAt(r);switch(o){case"\n":n.push("\\n");break;case"\r":n.push("\\r");break;case'"':n.push("\\u0022");break;case"%":n.push("\\u0025");break;case"&":n.push("\\u0026");break;case"'":n.push("\\u0027");break;case"(":n.push("\\u0028");break;case")":n.push("\\u0029");break;case"+":n.push("\\u002b");break;case"/":n.push("\\u002f");break;case"<":n.push("\\u003c");break;case">":n.push("\\u003e");break;case"\\":n.push("\\\\");break;default:n.push(o)}}}return n.join("")}})()}window.Encoding=c;void 0===h&&(h={__namespace:!0});if(void 0===p){p={__namespace:!0};(function(){p.arrayIndexOf=function(e,t,n){if(void 0!==Array.prototype.indexOf)return e.indexOf(t,n);if(void 0===t)return-1;var r=e.length;if(0!==r){n-=0;if(isNaN(n))n=0;else{isFinite(n)&&(n-=n%1);n<0&&(n=Math.max(0,r+n))}for(var i=n;i<r;i++)if(void 0!==e[i]&&e[i]===t)return i}return-1};p.attachDOMContentLoaded=function(e){void 0===document.addEventListener?document.onreadystatechange=function(){"complete"==document.readyState&&e()}:document.addEventListener("DOMContentLoaded",e,!1)}})()}if(void 0===d){d={__namespace:!0};(function(){d.BuildParam=function(e){var t,n;for(n=1;n<arguments.length;n++){t=new RegExp("\\^"+String(n));e=e.replace(t,arguments[n])}return e};d.IsGuid=function(e){return/^((\{[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}\})|([0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}))$/i.test(e)}})()}void 0===v&&(v={__namespace:!0});m=function(e,t){var n=this,r=!1;void 0!==t&&"boolean"==typeof t.queryCaseInsensitive&&(r=t.queryCaseInsensitive);var i=!1;void 0!==t&&"boolean"==typeof t.disableEncodingDecodingForLegacyCode&&(i=t.disableEncodingDecodingForLegacyCode);var s="",o="",u={};this.setQuery=function(e){var t=a(e);n.setQueryFromObject(t)};this.getQueryAsObject=function(){return u};this.setQueryFromObject=function(e){u={};for(var t in e)e.hasOwnProperty(t)&&n.setQueryParameter(t,e[t])};this.getQueryParameter=function(e){var t=null,i=n.getQueryAsObject();if(r)for(var s in i)u.hasOwnProperty(s)&&s.toLowerCase()===e.toLowerCase()&&(t=i[s]);else t=i[e];return void 0!==t?t:null};this.setQueryParameter=function(e,t){var n=p(e),r=p(t);u[n]=r};var a=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=e.split(/[;&]+/),r=0;r<n.length;r++){var i=n[r].split("=");if(i.length>0){var s=i[0];if(s.length>0){var o="";2==i.length&&(o=i[1]);t[s]=o}}}return t},f=function(e){o=e;var t=e.lastIndexOf("@");t>=0&&(o=o.substring(t+1));var n=o.indexOf(":");if(!(t<0&&n<0)){var r=e;if(t<0)o=r;else{s=r.substring(0,t);o=r.substring(t+1)}n>=0&&(o=o.substring(0,n));s=p(s);o=p(o)}},l=function(e){for(var t=e.split("/"),n=0;n<t.length;++n){var r=t[n].split(";"),i=p(r[0]);t[n]=h(i);for(var s=1;s<r.length;++s){var o=p(r[s]);t[n]+=";"+h(o)}}},c=function(e,t){for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<t.length;i++)if(r===t[i])return n;return-1},h=function(e){return i?e:encodeURIComponent(e)},p=function(e){return i?e:m.decodeURIComponent(e)};(function(){var t=e,r=t.indexOf("#");if(r>=0){var i=t.substring(r+1);n.setFragment(i);t=t.substring(0,r)}var s=c(t,";/?:@&=$,");if(s>=0){var o=t.indexOf(":");o>=0&&o===s&&(t=t.substring(s+1));var u="",a=t.indexOf("//");if(a>=0&&0===a){t=t.substring(2);var h,p=c(t,"/?");if(p>=0){u=t.substring(0,p);t=t.substring(p);h=!1}else{u=t;h=!0}f(u);if(h)return}var d=t.indexOf("?");if(d>=0){n.setQuery(t.substring(d+1));t=t.substring(0,d)}l(t)}else l(t)})()};(function(){var e=[0,128,2048,65536,2097152,67108864,2147483648];function t(t){for(var n,r,i,s,o=0,u="";o<t.length;)if(t[o]<=127)u+=String.fromCharCode(t[o++]);else{r=t[o++];s=i=Boolean(32&r)?Boolean(16&r)?3:2:1;n=r&255>>>2+i;for(;Boolean(i)&&o<t.length;){--i;if(0==(r=t[o++]))return u;if(128!=(192&r)){u+="?";break}n=n<<6|63&r}if(Boolean(i)){u+="?";break}if(n<e[s]){u+="?";break}if(n<=65535)u+=String.fromCharCode(n);else if(n<=1114111){n-=65536;u+=String.fromCharCode(55296|n>>>10);u+=String.fromCharCode(56320|1023&n)}else u+="?"}return u}function n(e){var n=null;try{n=decodeURIComponent(e)}catch(r){n=(function(e){if(null==e)return"null";var n,r,i=0,s=0,o="",u=[],a=0;for(;i<e.length;)if("%"==e.charAt(i))if("u"==e.charAt(++i)){n="";for(s=0;s<4&&i<e.length;++s)n+=e.charAt(++i);for(;n.length<4;)n+="0";r=parseInt(n,16);isNaN(r)?o+="?":o+=String.fromCharCode(r)}else{n="";for(s=0;s<2&&i<e.length;++s)n+=e.charAt(i++);for(;n.length<2;)n+="0";r=parseInt(n,16);if(isNaN(r)){if(Boolean(a)){o+=t(u);a=0;u.length=a}o+="?"}else u[a++]=r}else{if(Boolean(a)){o+=t(u);a=0;u.length=a}o+=e.charAt(i++)}if(Boolean(a)){o+=t(u);a=0;u.length=a}return o})(e)}return n}m.decodeURIComponent=n;m.getAbsolute=function(e){var t=document.createElement("a");t.href=e;var n=t.href;t=null;return n};m.removeKeyValue=function(e,t){var n=new RegExp(e+"=[^&]*&");t=t.replace(n,"");n=new RegExp(e+"=[^&]*");return t=t.replace(n,"")};m.removeParameters=function(e){var t=e.indexOf("?");return-1==t?e:e.substr(0,t)};m.removeQueryParameter=function(e,t){var n=e.indexOf("?"),r=e.indexOf("#");if(-1==n)return e;-1==r&&(r=e.length);if(r<=n)return e;var i=e.substr(n,r-n),s=new RegExp("[&?]"+t+"=[^&]*","");(i=i.replace(s,"")).length>0&&"&"==i[0]&&(i="?"+i.substr(1));return e.substr(0,n)+i+e.substr(r)};m.completeDecode=function(e){if(void 0===e||null==e)return e;for(var t=e,r=n(t);t!=r;)r=n(t=r);return t};m.restructureFilterUrl=function(e,t){var n=t+1,r=e.match(new RegExp("FilterField"+String(n)+"=[^&]*")),i=!1;Boolean(r)||(i=null!=(r=e.match(new RegExp("FilterFields"+String(n)+"=[^&]*"))));for(var s=t;null!=r;s++){var o=i?"FilterFields"+String(s):"FilterField"+String(s),u=i?"FilterFields"+String(n):"FilterField"+String(n);e=e.replace(u,o);o=i?"FilterValues"+String(s):"FilterValue"+String(s);u=i?"FilterValues"+String(n):"FilterValue"+String(n);e=e.replace(u,o);o="FilterOp"+String(s);u="FilterOp"+String(n);e=e.replace(u,o);o="FilterLookupId"+String(s);u="FilterLookupId"+String(n);e=e.replace(u,o);o="FilterData"+String(s);u="FilterData"+String(n);n++;r=(e=e.replace(u,o)).match(new RegExp("FilterField"+String(n)+"=[^&]*"));Boolean(r)||(r=e.match(new RegExp("FilterFields"+String(n)+"=[^&]*")))}return e};m.parseMultiColumnValue=function(e,t,n){var r,i=[];null==t&&(t=";#");var s=t.charCodeAt(0),o=t.charCodeAt(1);if(null==e||0==e.length)return i;var u=t.charAt(0),a=new RegExp(u+u,"g"),f=t.charAt(0),l=0;if(e.substr(0,2)==t){Boolean(n)&&i.push("");l=2}for(var c=l,h=!1,p=e.length;c<p;){var d=e.indexOf(u,c);if(d>=0){c=d;c++;if(e.charCodeAt(c)==o){if(c-1>l){r=e.substr(l,c-l-1);h&&(r=r.replace(a,f));i.push(r);h=!1}else i.push("");l=++c;continue}if(e.charCodeAt(c)==s){c++;h=!0;continue}throw"ArgumentException"}c=p}if(c>l){r=e.substr(l,c-l);h&&(r=r.replace(a,f));i.push(r)}else Boolean(n)&&i.push("");return i};m.convertMultiColumnValueToString=function(e,t,n){null==t&&(t=";#");null==n&&(n=!0);for(var r=t.charAt(0),i=r+r,s=new RegExp(t.charAt(0),"g"),o=!1,u="",a=0;a<e.length;a++){var f=e[a];null!=f&&f.length>0&&(f=f.replace(s,i));null!=f&&f.length>0&&(o=!0);(n||0!=a)&&(u+=t);u+=f}if(o){n&&(u+=t);return u}return""}})();if(void 0===g){g={__namespace:!0};(function(){function e(e,t,n,r){var i="",s=0;if(void 0===e)return"";for(s=0;s<e.length;s++){var o=e.charCodeAt(s),u=e.charAt(s);if(t&&("#"==u||"?"==u)){i+=e.substr(s);break}if(n&&"&"==u)i+=u;else if(o<=127)r||o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||t&&o>=32&&o<=95&&" \"%<>'&".indexOf(u)<0?i+=u:o<=15?i+="%0"+o.toString(16).toUpperCase():o<=127&&(i+="%"+o.toString(16).toUpperCase());else if(o<=2047){i+="%"+(192|o>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}else if(55296!=(64512&o)){i+="%"+(224|o>>12).toString(16).toUpperCase();i+="%"+(128|(4032&o)>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}else if(s<e.length-1){o=(1023&o)<<10;s++;o|=1023&e.charCodeAt(s);i+="%"+(240|(o+=65536)>>18).toString(16).toUpperCase();i+="%"+(128|(258048&o)>>12).toString(16).toUpperCase();i+="%"+(128|(4032&o)>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}}return i}g.encodeURIComponent=e;g.escapeUrlForCallback=function(t){var n=t.indexOf("#"),r=t.indexOf("?");if(n>0&&(-1==r||n<r)){var i=t.substr(0,n);r>0&&(i+=t.substr(r));t=i}return e(t,!0,!1,!0)}})()}if(void 0===y){y={__namespace:!0};(function(){function e(e,t){if(L(e,"/")){t.startsWith("/")&&(t=t.substring(1));return e+t}return t.startsWith("/")?e+t:e+"/"+t}var t=new(function(){this._list=new Array(0);this.get_href=function(){var e=null;if(L(window.location.pathname.toLowerCase(),"/_layouts/15/start.aspx")){"undefined"!=typeof g_MinimalDownload&&g_MinimalDownload&&(e=this.getSavedFormAction());Boolean(e)||(e=(function(){var e=null,t=window.location.href,n=t.toLowerCase().indexOf("/_layouts/15/start.aspx"),r=t.indexOf("://"),i=t.indexOf("/",r+3);-1==i&&(i=t.length);var s=t.indexOf("#");e=-1!=s&&s+1<=t.length&&"/"==t[s+1]?s+2<=t.length&&"/"==t[s+2]?t.substr(0,i)+t.substr(s+2):t.substr(0,n)+t.substr(s+1):t.substr(0,n);return e})())}else e=window.location.href;return e};this.get_search=function(){var e="";if("undefined"!=typeof g_MinimalDownload&&g_MinimalDownload&&L(window.location.pathname.toLowerCase(),"/_layouts/15/start.aspx")){var t=this.getSavedFormAction();if(Boolean(t)){var n=t.indexOf("?");-1!=n&&(e=t.substr(n))}}else e=window.location.search;return e};this.add_navigate=function(e){if("function"!=typeof e)throw"unexpected";-1==p.arrayIndexOf(this._list,e,0)&&this._list.push(e)};this.convertMDSURLtoRegularURL=function(t){var n=t;if(null!=t||""!=t){var r=t.toLowerCase().indexOf("/_layouts/15/start.aspx");if(-1!=r){var i=t.substring(0,r);r+="/_layouts/15/start.aspx".length;if(t.length==r)n=i;else if("#"==t[r]){r+=1;if(t.length==r)n=i;else if(t.length>=r+2&&"/"==t[r]&&"/"==t[r+1]){var s=t.indexOf("://");if(-1!=s){var o=t.indexOf("/",s+3);if(-1!=o){n=e(t.substring(0,o),t.substring(r+1))}}}else if(t.length>=r+1&&"/"==t[r]){n=e(i,t.substring(r))}}}}return n}});y.ajaxNavigate=t;y.combineUrl=e;y.pageUrlValidation=function(e,t){if(n(e))return e;Boolean(t)&&alert(t);return""};y.getUrlKeyValue=function(e,t,n,r){var i,s,o="";null==n&&(n=y.ajaxNavigate.get_href()+"");(i=n.indexOf("#"))>=0&&(n=n.substr(0,i));if(r){e=e.toLowerCase();s=n.toLowerCase()}else s=n;-1==(i=s.indexOf("&"+e+"="))&&(i=s.indexOf("?"+e+"="));if(-1!=i){var u=n.indexOf("&",i+1);-1==u&&(u=n.length);o=n.substring(i+e.length+2,u)}return t?o:m.decodeURIComponent(o)};y.isPageUrlValid=n;function n(e){return"http"==e.substr(0,4)||"/"==e.substr(0,1)||-1==e.indexOf(":")}})()}if(k){if(void 0===b){b={__namespace:!0};A()}window.ListModule=b;if(void 0===w){w={__namespace:!0};O()}}else{if(void 0===window.ListModule){b={__namespace:!0};A();window.ListModule=b}if(void 0===window.List_Util){window.List_Util={__namespace:!0};O()}}null==E&&((E={}).ExpFeatures=[]);E.VariantConfiguration={};E.VariantConfiguration.IsExpFeatureClientEnabled=function(e){var t,n=Math.floor(e/32);if(null==window.OffSwitch||i.IsActive("AF5A380E-20E0-4096-BA87-2C4CDFB4DBDF")){if(n<0||n>=E.ExpFeatures.length)return!1;t=1<<e%32;return 0!=(E.ExpFeatures[n]&t)}var r=E.ExpFeatures,s=window._spPageContextInfo;0===r.length&&null!=s&&null!=s.ExpFeatures&&(r=_spPageContextInfo.ExpFeatures);if(n<0||n>=r.length)return!1;t=1<<e%32;return 0!=(r[n]&t)};window.Flighting=E;String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};void 0===S&&(S=new Array(0));window.NotifyScriptLoadedAndExecuteWaitingJobs=function(){};void 0!==Date.now&&null!==Date.now||(Date.now=function(){return Number(new Date)});M.prototype={webPartId:void 0,serverUrl:void 0,siteRelativeUrl:void 0,listName:void 0,rootFolder:void 0,overwriteAll:void 0,hideProgressBar:void 0,refreshFunc:void 0,preUploadFunc:void 0,postUploadFunc:void 0,checkPermissionFunc:void 0};window.PageMinimized=H;if(null==x){(x=[]).push("_spBodyOnLoad");x.push("_spRestoreScrollForDiv_rscr")}null!=document.body&&null!=document.body.firstChild||void 0!==document.addEventListener&&void 0!==window.msWriteProfilerMark&&document.addEventListener("DOMContentLoaded",function(){window.msWriteProfilerMark("DOMContentLoaded")},!1);T=new Object;F.prototype.buildMinimized=void 0;F.prototype.initialTabId=void 0;N=0;C=null;(function(){R.prototype.hasRetVal=void 0;R.prototype.retVal=void 0;R.prototype.set=function(e){if(void 0!==e){this.retVal=e;this.hasRetval=!0}};R.prototype.isSet=function(){return this.hasRetval};R.prototype.get=function(){return this.hasRetval?this.retVal:void 0};R.prototype.clear=function(){this.hasRetval=!1;this.retVal=null}})();n.JsGridUtil.SPListView=!0;U("SP");U("SP.UI");x.push("AllowCSSFiltersOnIE8")};function L(e,t){return-1!==e.indexOf(t,e.length-t.length)}function A(){b.BasePermissions=function(){};b.BasePermissions.prototype={ManageLists:void 0,OpenItems:void 0};b.Context=function(){this.listBaseType=null;this.listTemplate=null;this.listName=null;this.view=null;this.listUrlDir=null;this.HttpPath=null;this.HttpRoot=null;this.serverUrl=null;this.imagesPath=null;this.PortalUrl=null;this.RecycleBinEnabled=null;this.enteringGridMode=!1;this.inGridMode=!1;this.isWebEditorPreview=null;this.rootFolderForDisplay=null;this.isPortalTemplate=null;this.isModerated=!1;this.recursiveView=!1;this.displayFormUrl=null;this.editFormUrl=null;this.newFormUrl=null;this.ctxId=null;this.CurrentUserId=null;this.isForceCheckout=!1;this.EnableMinorVersions=!1;this.ModerationStatus=0;this.verEnabled=0;this.isVersions=0;this.WorkflowsAssociated=!1;this.ExternalDataList=!1;this.HasRelatedCascadeLists=0;this.CascadeDeleteWarningMessage=null;this.ContentTypesEnabled=!1;this.SendToLocationName="";this.SendToLocationUrl="";this.StateInitDone=!1;this.TotalListItems=null;this.CurrentSelectedItems=null;this.LastSelectableRowIdx=null;this.SelectAllCbx=null;this.TableCbxFocusHandler=null;this.TableMouseoverHandler=null;this.onItemSelectionChangedHandlers=[]};b.Context.prototype={AllowGridMode:void 0,BasePermissions:void 0,BaseViewID:void 0,CascadeDeleteWarningMessage:void 0,ContentTypesEnabled:void 0,CurrentSelectedItems:void 0,CurrentUserId:void 0,EnableMinorVersions:void 0,ExternalDataList:void 0,HasRelatedCascadeLists:void 0,HttpPath:void 0,HttpRoot:void 0,RealHttpRoot:void 0,NoScriptEnabled:void 0,LastSelectableRowIdx:void 0,LastSelectedItemIID:void 0,LastRowIndexSelected:void 0,RowFocusTimerID:void 0,ListData:void 0,ListSchema:void 0,ModerationStatus:void 0,mountPointUrl:void 0,PortalUrl:void 0,RecycleBinEnabled:void 0,SelectAllCbx:void 0,SendToLocationName:void 0,SendToLocationUrl:void 0,StateInitDone:void 0,TableCbxFocusHandler:void 0,TableMouseoverHandler:void 0,TotalListItems:void 0,WorkflowsAssociated:void 0,clvp:void 0,ctxId:void 0,ctxType:void 0,dictSel:void 0,displayFormUrl:void 0,editFormUrl:void 0,imagesPath:void 0,inGridMode:void 0,inGridFullRender:void 0,isForceCheckout:void 0,isModerated:void 0,isPortalTemplate:void 0,isVersions:void 0,isWebEditorPreview:void 0,leavingGridMode:!1,loadingAsyncData:!1,listBaseType:void 0,listName:void 0,listTemplate:void 0,listUrlDir:void 0,newFormUrl:void 0,onRefreshFailed:void 0,overrideDeleteConfirmation:void 0,overrideFilterQstring:void 0,overrideScope:void 0,searchTerm:void 0,recursiveView:void 0,rootFolderForDisplay:void 0,serverUrl:void 0,verEnabled:void 0,view:void 0,queryString:void 0,IsClientRendering:void 0,wpq:void 0,rootFolder:void 0,hasRootFolder:void 0,IsAppWeb:void 0,NewWOPIDocumentEnabled:void 0,NewWOPIDocumentUrl:void 0,NewWOPIDocumentTypes:void 0,AllowCreateFolder:void 0,CanShareLinkForNewDocument:void 0,VisioDrawingCreationEnabled:void 0,noGroupCollapse:void 0,SiteTemplateId:void 0,RealSiteTemplateId:void 0,ExcludeFromOfflineClient:!1,onItemSelectionChangedHandlers:void 0,bNoDelete:!1,qcb:void 0};b.Context.Type={EditMenu:0,ViewSelector:1};b.Settings={SupportsCallouts:!1,SupportsDragDrop:!1,SupportsRibbon:!1,SupportsQCB:!1,SupportsUpload:!1,SupportsInplHash:!1,SupportsAnimation:!1,SupportsGrouping:!1,SupportsNonCSR:!1,SupportsInPlaceEdit:!1,SupportsItemDelete:!1,SupportsCheckout:!1,SupportsPopup:!1,SupportsErrorDlg:!1,SupportsFileAttach:!1,SupportsCopies:!1,SupportsModeration:!1,SupportsMQuery:!1,SupportsRest:!1,SupportsDatapipes:!1,SupportsAddToOneDrive:!1,SupportsAddToOneDriveQCB:!1,SupportsTaskListEditMode:!1,SupportsPeopleHoverCard:!1,SupportsMaintainUserChrome:!1,SupportsInfiniteScroll:!1,SupportsDragDropAttract:!1,SupportsDragDropAttractB:!1,SupportsDoclibAccessibility:!1,SupportsDoclibQCB:!1,SupportsOldDesktopMenus:!1,SupportsPolicyTips:!1,SupportsRightClickECB:!1,SupportsShortcutLink:!1,SupportsFileExtensionDefinition:!1,SupportsFileExtensionControls:!1,SupportsFileHandlerForAllNonOfficeFiles:!1,SupportsFileExtensionDataPipe:!1,SupportsFileHandlerAddInPicker:!1,SupportsFileHandlerFileCreation:!1}}function O(){b.Util={};b.Util.createViewEditUrl=e;b.Util.createItemPropertiesTitleUrl=function(t,n){if(t.inGridMode)return e(t,n,!0,!1);return e(t,n,!1,!1)};b.Util.isDefinedAndNotNullOrEmpty=function(e){return null!=e&&""!==e};b.Util.hasEditPermission=function(e){var t=String(e.PermMask);return 0!=(4&parseInt("0x"+t.substring(t.length-1)))};b.Util.makeMountedFolderQueryStrParams=function(e,t){var n=(function(e,t){var n=new m(y.ajaxNavigate.get_href()),r=n.getQueryParameter("RemoteSiteId"),i=[];if(Boolean(r)){var s=n.getQueryParameter("RemoteWebId");if(Boolean(s)){var o=null;e&&(o=n.getQueryParameter("RemoteFolderId"));if(d.IsGuid(r)&&d.IsGuid(s)&&(!e||Boolean(o)&&d.IsGuid(o))){i.push({k:"RemoteSiteId",v:r});i.push({k:"RemoteWebId",v:s});e&&i.push({k:"RemoteFolderId",v:o})}}}else{var u=n.getQueryParameter("GroupSiteUrl");if(Boolean(u)){var a=n.getQueryParameter("GroupId");if(Boolean(a)&&d.IsGuid(a)){i.push({k:"GroupSiteUrl",v:u});i.push({k:"GroupId",v:a})}}}if(i.length>0){if(t){var f=n.getQueryParameter("MPPrefix");if(Boolean(f)){i.push({k:"MPPrefix",v:f});i.push("&MPPrefix=");i.push(f)}}return i}return null})(e,t);if(null==n)return null;for(var r=[],i=0;i<n.length;i++){r.push("&");r.push(n[i].k);r.push("=");r.push(n[i].v)}return r.join("")};b.Util.removeOnlyPagingArgs=function(e){e=e.replace(/&*Paged=TRUE/gi,"");e=e.replace(/&*PagedPrev=TRUE/gi,"");e=e.replace(/&p_[^&]*/gi,"");e=e.replace(/&PageFirstRow=[^&]*/gi,"");return e=e.replace(/&PageLastRow=[^&]*/gi,"")};b.Util.groupStringFromGroupName=function(e){if(null==e||""==e)return null;var t=document.getElementById("titl"+e+"_");if(null==t)return null;var n=t.getAttribute("groupString");return""!=n?n:null};b.Util.ctxInitItemState=function(e){e.TotalListItems=0;e.CurrentSelectedItems=0;e.LastSelectableRowIdx=0;e.StateInitDone=!0};b.Util.clearSelectedItemsDict=function(e){null!=e&&(e.dictSel=[])};b.Util.getHostUrl=function(e){var t=e;t.lastIndexOf("/")>t.indexOf("//")+1&&(t=t.substring(0,t.indexOf("/",t.indexOf("//")+2)));return t};function e(e,t,n,r){var i=[];n?i.push(e.editFormUrl):i.push(e.displayFormUrl);i.push("&ID=");i.push(t.ID);i.push("&ContentTypeID=");i.push(t.ContentTypeId);if(r){i.push("&Source=");i.push(y.getSource())}return i.join("")}}t.TrimSpaces=function(e){var t,n,r=(e=e.toString()).length;for(t=0;t<r&&" "==e.charAt(t);t++);if(t==r)return"";for(n=r-1;n>t&&" "==e.charAt(n);n--);n++;return e.substring(t,n)};function M(e,t,n,r,i,s,o,u,a,f,l){this.webPartId=e;this.serverUrl=t;this.siteRelativeUrl=n;this.listName=r;this.rootFolder=i;this.overwriteAll=s;this.hideProgressBar=o;this.refreshFunc=u;this.preUploadFunc=a;this.postUploadFunc=f;this.checkPermissionFunc=l}function _(e,t,n,r){D(e,e,t,n,r);null!=t&&t();null!=n&&n();null!=r&&r()}function D(e,t,n,r,i){if("string"!=typeof t)throw"Unexpected";if(null!=n&&"function"!=typeof n)throw"Unexpected";if(null!=r&&"function"!=typeof r)throw"Unexpected";if(null!=i&&"function"!=typeof i)throw"Unexpected";S[t]||(S[t]={tag:t,scriptURI:new m(e),beginFunc:n,endFunc:r,loadFunc:i,executed:!1})}function P(e,t){D(e,e,t,null,null)}function H(){return!0}t.IsXhrAborted=function(e){try{if(4==e.readyState&&(void 0===e.status||0==e.status))return!0}catch(e){return!0}return!1};function B(e,t){var n=T[t];if(null!=n&&n.notified){null!=n.args?e.apply(null,n.args):e();return!0}(function(e,t){var n=T[t];if(null==n){(n=new Object).notified=!1;n.jobs=[];n.args=null;T[t]=n}n.jobs.push(e)})(e,t);return!1}function j(e,t){return B(e,"sp.scriptloaded-"+(t=t.toLowerCase()))}function F(){}t.getUniqueIndex=function(){return++N};function I(){if(Boolean(C))return C;try{var e;e=window;for(;null!=e&&e!=e.parent;)null!=(e=e.parent)&&e.g_spDlgLauncher&&(C=e)}catch(e){}finally{Boolean(C)||(C=window)}return C}function q(e,t,n,r){}function R(){}t.IsShortcutLink=function(e){return Boolean(e)&&("url"==e.File_x0020_Type||"website"==e.File_x0020_Type)};t.AjaxNavAddNavigate=function(e){y.ajaxNavigate.add_navigate(e)};function U(e){(function(e,t){for(var n,r=e.split("."),i=0,s=r.length;i<s;i++){var o=r[i];void 0===n&&(n=window);void 0===n[o]&&(n[o]=new Object);n=n[o];t&&(n.__namespace=!0)}})(e,!0)}function z(e,t){var n=e.ownerDocument;if(Boolean(n.createTextNode)){var r=n.createTextNode(t);e.innerHTML="";e.appendChild(r)}else e.innerText=t}function W(e){return e.search(/[?]/)>-1?e:e+"?rev=47"}function X(e,t,n,r,i,s){var o=r._ShortcutUniqueId,u=r._ShortcutWebId,a=r._ShortcutSiteId,f=r._ShortcutUrl,l=(function(e,t,n,r,i){var s="",o="?";if(Boolean(t)){var u=t.indexOf("?");-1!=u&&(o=t.substring(u))}if(Boolean(i)&&Boolean(r)&&Boolean(n)){s=e.WebUrl+"/_layouts/15/ShortcutLink.aspx";s+=o;s+="&siteid="+g.encodeURIComponent(n);s+="&webid="+g.encodeURIComponent(r);s+="&uniqueid="+g.encodeURIComponent(i)}else Boolean(t)&&(s=t);return s})(e,f,a,u,o);t.push('<a onfocus="OnLink(this)" class="ms-listlink" href="');if(""!=l){t.push(c.HtmlEncode(l));t.push('" title="');t.push(c.HtmlEncode(f))}else{l=e.WebUrl+"/_layouts/15/ShortcutLink.aspx?shortcut="+g.encodeURIComponent(r.FileRef);t.push(l);t.push('" title="');t.push(c.HtmlEncode(Strings.STS.L_Shortcut_Processing));if(s){t.push('" id="shortcut_');t.push(c.HtmlEncode(r.FileRef));(function(e,t){if(null!=window.XMLHttpRequest){var n=t.WebUrl+"/_api/SP.Utilities.ShortcutLink.GetShortcutLink('"+g.encodeURIComponent(e)+"')",r=new XMLHttpRequest;r.open("GET",n,!0);r.setRequestHeader("Content-Type","application/json");r.setRequestHeader("Accept","application/json");r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var t=JSON.parse(r.responseText),n=void 0;if(null!=(n=document.getElementById("shortcut_"+e))){n.href=t.url;n.title=t.url}}};r.send(null)}})(r.FileRef,e)}}t.push('" aria-label="');t.push(c.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('">')}t.RenderShortcutLink=function(e,t,n,r,i){X(e,t,0,r,0,!0);t.push(c.HtmlEncode(n));t.push("</a>")};t.RenderShortcutLinkIcon=function(e,t,n,r,i){X(e,t,0,r,0,!1);t.push('<img border="0" alt="');t.push(c.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('" title="');t.push(c.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('" src="');t.push(ListView.ImageBasePath+"/_layouts/15/images/icspgen.gif?rev=47");t.push('" />');t.push("</a>")};function V(e){return E.VariantConfiguration.IsExpFeatureClientEnabled(134)&&Boolean(e)&&Boolean(e._mpSPSiteId)&&Boolean(e._mpSPWebId)&&Boolean(e._mpItemUniqueId)}t.IsMountPoint=V;function $(e,t){var n={};if(Boolean(V(e))&&Boolean(t)){var r=null;E.VariantConfiguration.IsExpFeatureClientEnabled(168)&&(r=new m("http://foo?"+(function(e){var t="",n="";if(null!=e&&null!=e.clvp&&"function"==typeof e.clvp.WebPartId){n=(r=e.clvp.WebPartId(),y.ajaxNavigate.getParam("InplviewHash"+r));Boolean(n)&&(t=(function(e){return e.replace(/-/g,"&").replace(/&&/g,"-")})(n))}var r;return t})(t)));Boolean(r)||(r=new m(y.ajaxNavigate.get_href()));if(Boolean(r)){n.mpPrefix=r.getQueryParameter("MPPrefix");Boolean(n.mpPrefix)||(n.mpPrefix=e.FileRef.replace(/.url$/,""));n.siteId=e._mpSPSiteId;n.webId=e._mpSPWebId;n.folderId=e._mpItemUniqueId}}return(function(e){var t=e.rootFolder,n=e.siteId,r=e.webId,i=e.folderId,s=e.mpPrefix,o=Boolean(s)&&Boolean(n)&&Boolean(r)&&Boolean(i),u=Boolean(e.mpLevel)?e.mpLevel:"1,0",a=-1,f=-1,l=[];if(Boolean(u)&&o&&2==(l=u.split(",")).length){a=h(l[0],1);f=h(l[1],0)}function c(e,t){a+=e;0==e?f+=t:f=0;u=String(a)+","+String(f)}function h(e,t){var n=t;return null!=e&&e.length>0&&!isNaN(n)&&(n=parseInt(e))<t?t:n}function p(e){if(!o)return{};var t={RemoteSiteId:n,RemoteWebId:r,RemoteFolderId:i};if(!Boolean(e)){t.MPLevel=u;t.MPPrefix=s}return t}return{isInitProperly:o,mpPrefix:o?s:"",rootFolder:o?t:"",getMajorLevel:function(){return a},getMinorLevel:function(){return f},incrementMajorLevel:function(){c(1,0)},incrementMinorLevel:function(){c(0,1)},decrementMinorLevel:function(){c(0,-1)},getMountPointProperties:p,getMountPointUrl:function(e,t){var n=[];if(o){var r=p(t);for(var i in r)n.push(i+"="+r[i])}Boolean(e)||(e="&");return n.join(e)}}})(n)}t.createByListItem=$;function J(e){return Boolean(e)&&!e.inGridMode&&(E.VariantConfiguration.IsExpFeatureClientEnabled(168)&&700==e.ListTemplateType&&51==e.BaseViewID||E.VariantConfiguration.IsExpFeatureClientEnabled(424)&&null!=window.groupContextData&&101==e.ListTemplateType&&1==e.BaseViewID)}t.SupportAjaxFolderNav=J;t.RenderMountPointLink=function(e,t,n,r,i){var s=$(r,e);t.push('<a onfocus="OnLink(this)" class="ms-listlink" href="');if(e.NoScriptEnabled&&J(e)){t.push('"#" onclick="');t.push("EnterFolderAjax(event, '");t.push(g.encodeURIComponent(r.FileRef));t.push("', '");t.push(s.getMountPointUrl());t.push("', true);return false;\"");E.VariantConfiguration.IsExpFeatureClientEnabled(169)&&t.push(' aria-label="'+c.HtmlEncode(Strings.STS.L_FieldType_SharedFolder)+'"');t.push(">")}else{t.push(i.PagePath);t.push("?");t.push(s.getMountPointUrl());E.VariantConfiguration.IsExpFeatureClientEnabled(169)?t.push('" aria-label="'+c.HtmlEncode(Strings.STS.L_FieldType_SharedFolder)+'">'):t.push('">')}t.push(c.HtmlEncode(n));t.push("</a>")};function K(e){if(!Boolean(e))return!1;for(var t=e.split("."),n=t.length,r=window,i=0;i<n;i++)if(void 0===(r=r[t[i]]))return!1;return!0}(function(e){e.AddClass=function(e,t){if(null!=e&&!n(e,t)){e.className+=" "+t;return!0}return!1};e.RemoveClass=function(e,r){if(n(e,r)){e.className=e.className.replace(t(r)," ");return!0}return!1};function t(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")}function n(e,n){return null!=e&&null!=n&&null!=e.className.match(t(n))}})(t.CSSUtil||(t.CSSUtil={}))});
define("dUe",["require","exports","T7"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SHAREPOINT_TIME_ZONE_ID_TO_IANA_TIMEZONE={2:"Europe/London",3:"Europe/Paris",4:"Europe/Berlin",5:"Europe/Bucharest",6:"Europe/Budapest",7:"Europe/Kaliningrad",8:"America/Sao_Paulo",9:"America/Halifax",10:"America/New_York",11:"America/Chicago",12:"America/Denver",13:"America/Los_Angeles",14:"America/Anchorage",15:"Pacific/Honolulu",16:"Pacific/Apia",17:"Pacific/Auckland",18:"Australia/Brisbane",19:"Australia/Adelaide",20:"Asia/Tokyo",21:"Asia/Singapore",22:"Asia/Bangkok",23:"Asia/Kolkata",24:"Asia/Dubai",25:"Asia/Tehran",26:"Asia/Baghdad",27:"Asia/Jerusalem",28:"America/St_Johns",29:"Atlantic/Azores",30:"Etc/GMT+2",31:"Atlantic/Reykjavik",32:"America/Cayenne",33:"America/La_Paz",34:"America/Indianapolis",35:"America/Bogota",36:"America/Regina",37:"America/Mexico_City",38:"America/Phoenix",39:"Etc/GMT+12",40:"Pacific/Fiji",41:"Asia/Magadan",42:"Australia/Hobart",43:"Pacific/Port_Moresby",44:"Australia/Darwin",45:"Asia/Shanghai",46:"Asia/Novosibirsk",47:"Asia/Tashkent",48:"Asia/Kabul",49:"Africa/Cairo",50:"Africa/Johannesburg",51:"Europe/Moscow",53:"Atlantic/Cape_Verde",54:"Asia/Baku",55:"America/Guatemala",56:"Africa/Nairobi",57:"Europe/Warsaw",58:"Asia/Yekaterinburg",59:"Europe/Kiev",60:"America/Godthab",61:"Asia/Rangoon",62:"Asia/Katmandu",63:"Asia/Irkutsk",64:"Asia/Krasnoyarsk",65:"America/Santiago",66:"Asia/Colombo",67:"Pacific/Tongatapu",68:"Asia/Vladivostok",69:"Africa/Lagos",70:"Asia/Yakutsk",71:"Asia/Almaty",72:"Asia/Seoul",73:"Australia/Perth",74:"Asia/Riyadh",75:"Asia/Taipei",76:"Australia/Sydney",77:"America/Chihuahua",78:"America/Santa_Isabel",79:"Asia/Amman",80:"Asia/Beirut",81:"America/Manaus",82:"Asia/Tbilisi",83:"Africa/Windhoek",84:"Asia/Yerevan",85:"America/Buenos_Aires",86:"Africa/Casablanca",87:"Asia/Karachi",88:"America/Caracas",89:"Indian/Mauritius",90:"America/Montevideo",91:"America/Asuncion",92:"Asia/Kamchatka",93:"UTC",94:"Asia/Ulaanbaatar",95:"Etc/GMT+11",96:"Etc/GMT+2",97:"Etc/GMT-12",98:"Asia/Damascus",99:"Asia/Magadan",100:"Europe/Kaliningrad",101:"Europe/Istanbul",102:"Asia/Dhaka",103:"America/Bahia",106:"Europe/Samara",107:"Asia/Srednekolymsk",108:"Asia/Anadyr",109:"Europe/Minsk"};t.getTzOffsetFromIANATzName=function(e,t,n,i,s,o,u,a){return r(e,new Date(Date.UTC(t,n,i,s,o,u,a)))};function r(e,t){try{var r=new Date(t.toLocaleString("en-US",{timeZone:"UTC"})),i=new Date(t.toLocaleString("en-US",{timeZone:e}));return(r.getTime()-i.getTime())/n.ONE_MINUTE}catch(e){return 0}}t.getIANATzNameFromSPTzID=function(e){return t.SHAREPOINT_TIME_ZONE_ID_TO_IANA_TIMEZONE[e]};t.maskServerTimeAsLocalTime=function(e,t){if(!e)return e;var i=e.getTime(),s=r(t,e)*n.ONE_MINUTE,o=e.getTimezoneOffset()*n.ONE_MINUTE;return new Date(i+o-s)}});
define("mze",["require","exports","lC","r","EF","SPListItemsScopeDeferred_IS_mini_css","_ze"],function(e,t,n,r,i,s,o){"use strict";s=s.CheckboxEditor_0;Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onChange=function(e,t){n.props.onValueChange(t?"1":"0");n.setState({value:t})};n.state={value:"1"===t.value||"Yes"===t.value||"true"===t.value};n._inputRef=r.createRef();return n}t.prototype.componentDidMount=function(){this._inputRef&&this._inputRef.current.focus()};t.prototype.render=function(){return r.createElement("div",{style:{height:this.props.height,width:this.props.width}},r.createElement(i.Checkbox,{checked:this.state.value,inputProps:{onKeyDown:this.props.onEditorKeyDown},onChange:this._onChange,className:s.checkBox,ariaLabel:this.state.value?o.default.onAriaLabel:o.default.offAriaLabel,componentRef:this._inputRef}))};return t})(r.PureComponent);t.CheckboxEditor=u});
define("bGe",["require","exports","cGe","oc","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";var s=i.SPGrid_6;i=i.styles_9;Object.defineProperty(t,"__esModule",{value:!0});var o=r.getTheme(),u={ODB:1725};function a(e){var t=n.JsGridUtil.Internal.Color.HexStringToColor(e);null!=t&&(t=n.JsGridUtil.Internal.Color.MakeAlphaColor(.2,t.r,t.g,t.b));return t}t.StyleType={Splitter:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{}},SplitterHandle:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{},gripUpperColor:{jsId:"color"},gripLowerColor:{jsId:"borderRightColor"}},GridPane:{verticalBorderColor:{jsId:"borderRightColor"},verticalBorderStyle:{jsId:"borderRightStyle"},horizontalBorderColor:{jsId:"borderBottomColor"},horizontalBorderStyle:{jsId:"borderBottomStyle"},backgroundColor:{jsId:"backgroundColor"},columnDropIndicatorColor:{jsId:"borderLeftColor"},rowDropIndicatorColor:{jsId:"borderLeftColor"},linkColor:{classId:"link",jsId:"color"},visitedLinkColor:{classId:"link",jsId:"backgroundColor"},copyRectForeBorderColor:{classId:"selection",jsId:"borderLeftColor"},copyRectBackBorderColor:{classId:"selection",jsId:"borderRightColor"},focusRectBorderColor:{classId:"selection",jsId:"borderTopColor"},selectionRectBorderColor:{classId:"selection",jsId:"borderBottomColor",semanticColor:"inputFocusBorderAlt"},selectedCellBgColor:{classId:"selection",jsId:"color",fromCss:a},readonlySelectionRectBorderColor:{classId:"readOnlySelection",jsId:"borderBottomColor"},changeHighlightCellBgColor:{classId:"edit",jsId:"backgroundColor",fromCss:a},fillRectBorderColor:{classId:"edit",jsId:"borderLeftColor",semanticColor:"inputFocusBorderAlt"},errorRectBorderColor:{classId:"edit",jsId:"borderTopColor"}},Header:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},textColor:{jsId:"color"},outerBorderColor:{jsId:"borderBottomColor"},innerBorderColor:{jsId:"borderRightColor"},eyeBrowBorderColor:{jsId:"borderTopColor"},eyeBrowColor:{jsId:"borderLeftColor"},menuColor:{classId:"elementColor",jsId:"backgroundColor"},menuBorderColor:{classId:"elementColor",jsId:"borderLeftColor"},resizeColor:{classId:"elementColor",jsId:"borderBottomcolor"},resizeBorderColor:{classId:"elementColor",jsId:"borderRightColor"},menuHoverColor:{classId:"elementHoverColor",jsId:"backgroundColor"},menuHoverBorderColor:{classId:"elementHoverColor",jsId:"borderLeftColor"},resizeHoverColor:{classId:"elementHoverColor",jsId:"borderTopColor"},resizeHoverBorderColor:{classId:"elementHoverColor",jsId:"borderRightColor"},eyeBrowHoverColor:{classId:"elementHoverColor",jsId:"borderTopColor"},eyeBrowHoverBorderColor:{classId:"elementHoverColor",jsId:"borderBottomColor"},elementClickColor:{classId:"elementClickColor",jsId:"backgroundColor"},elementClickBorderColor:{classId:"elementClickColor",jsId:"borderLeftColor"}},RowHeaderStyle:{backgroundColor:{},outerBorderColor:{jsId:"borderBottomColor"},innerBorderColor:{jsId:"borderRightColor"}},TimescaleTier:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},textColor:{jsId:"color"},backgroundColor:{},verticalBorderColor:{jsId:"borderRightColor"},verticalBorderStyle:{jsId:"borderRightStyle"},horizontalBorderColor:{jsId:"borderBottomColor"},horizontalBorderStyle:{jsId:"borderBottomStyle"},outerBorderColor:{jsId:"borderLeftColor"},todayLineColor:{jsId:"borderTopColor"}},Cell:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},fontStyle:{},textColor:{jsId:"color"},backgroundColor:{},textAlign:{}},Widget:{backgroundColor:{jsId:"backgroundColor"},borderColor:{jsId:"borderColor"}}};var f,l=0,c=1,h=2,p=3,d=4,v=5,m=(function(){function e(){var e=this;this.Dispose=function(){window.removeEventListener("unload",e.Dispose);e.testElement=null};this.Type=t.StyleType;for(var r in t.StyleType)for(var i in t.StyleType[r]){var s=t.StyleType[r][i],o=null==s.jsId?i:s.jsId;if(""!==o&&(null==s.cssId||""==s.cssId)){s.cssId=n.JsGridUtil.Internal.DomElement.GetInstance().DashNameFromCamelName(o);s.jsId=o}}window.addEventListener("unload",this.Dispose)}e.getInstance=function(){e._instance||(e._instance=new e);return e._instance};e.prototype.CreateStyleObject=function(e){var t={};for(var n in e)t[n]=null;return t};e.prototype.CreateReadOnlyCellStyle=function(){return{textColor:null}};e.prototype.MakeHeaderStyleCollection=function(){var e=this,n=function(n){var r=e.CreateStyleObject(t.StyleType.Header);r.type=n;return r};return{normal:n(l),normalHover:n(p),partSelected:n(c),partSelectedHover:n(d),allSelected:n(h),allSelectedHover:n(v)}};e.prototype.MakeSplitterStyleCollection=function(){return{normal:this.CreateStyleObject(t.StyleType.Splitter),normalHandle:this.CreateStyleObject(t.StyleType.SplitterHandle),hover:this.CreateStyleObject(t.StyleType.Splitter),hoverHandle:this.CreateStyleObject(t.StyleType.SplitterHandle),drag:this.CreateStyleObject(t.StyleType.Splitter),dragHandle:this.CreateStyleObject(t.StyleType.SplitterHandle)}};e.prototype.LoadNameClassInfoFromStyle=function(e){var t={};for(var n in e){var r=null==e[n].classId?"base":e[n].classId;r in t||(t[r]={});t[r][n]=e[n]}return t};e.prototype.LoadCollectionCss=function(e,t,n){for(var r in t)null!=n[r]&&f.CreateStyleFromCss(t[r],n[r],e)};e.prototype.GetDefaultStyleMgr=function(){var e=this,r={};return{gridPaneStyle:this.CreateStyleObject(t.StyleType.GridPane),columnHeaderStyleCollection:this.MakeHeaderStyleCollection(),rowHeaderStyleCollection:this.MakeHeaderStyleCollection(),splitterStyleCollection:this.MakeSplitterStyleCollection(),defaultCellStyle:{},readOnlyCellStyle:this.CreateReadOnlyCellStyle(),readOnlyFocusedCellStyle:{},timescaleTierStyle:this.CreateStyleObject(t.StyleType.TimescaleTier),groupingStyles:[],widgetDockStyle:{},widgetDockHoverStyle:{},widgetDockPressedStyle:{},RegisterCellStyle:function(e,t){r[e]=t},GetCellStyle:function(e){return r[e]},UpdateSplitterStyleFromCss:function(e,n){for(var r in n)for(var i in n[r])f.CreateStyleFromCss(t.StyleType.Splitter,n[r][i],e[r],i)},UpdateHeaderStyleFromCss:function(e,n){for(var r in n)for(var i in n[r])f.CreateStyleFromCss(t.StyleType.Header,n[r][i],e[r],i)},UpdateGridPaneStyleFromCss:function(n,r){e.LoadCollectionCss(n,e.LoadNameClassInfoFromStyle(t.StyleType.GridPane),r)},UpdateDefaultCellStyleFromCss:function(e,r){f.CreateStyleFromCss(t.StyleType.Cell,r,e);e.textAlign="rtl"==n.JsGridUtil.Utility.GetDocumentDirection()?"right":"left"},UpdateGroupStylesFromCss:function(e,r){for(var i={},s=1;s<10;s++){i=f.CreateStyleFromCss(t.StyleType.Cell,r+s);n.JsGridUtil.Internal.IsAssocArrayEmpty(i)||e.push(i)}}}};e.prototype.InitStylesFromCSS=function(e){for(var r=n.JsGridUtil.Internal.IsFeatureEnabled(u),o=[[e.gridPaneStyle,e.UpdateGridPaneStyleFromCss,null,{base:r?s.msGrid:"ms-grid",link:r?s.msGridLink:"ms-grid-link",selection:r?s.msGridSelection:"ms-grid-selection",readOnlySelection:r?s.msGridSelectionReadonly:"ms-grid-selection-readonly",edit:r?s.msGridEdit:"ms-grid-edit"}],[e.columnHeaderStyleCollection,e.UpdateHeaderStyleFromCss,null,{normal:{base:r?s.msGridColHeaderNormal:"ms-grid-col-header-normal",elementColor:r?s.msGridColHeaderElemBgColorsNormal:"ms-grid-col-header-elem-bg-colors-normal",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsNormal:"ms-grid-col-header-elem-hover-bg-colors-normal",elementClickColor:r?s.msGridColElemColorsClickNormal:"ms-grid-col-elem-colors-click-normal"},normalHover:{base:r?s.msGridColHeaderNormalHover:"ms-grid-col-header-normal-hover",elementColor:r?s.msGridColHeaderElemBgColorsNormalHover:"ms-grid-col-header-elem-bg-colors-normal-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsNormalHover:"ms-grid-col-header-elem-hover-bg-colors-normal-hover",elementClickColor:r?s.msGridColElemColorsClickNormalHover:"ms-grid-col-elem-colors-click-normal-hover"},partSelected:{base:r?s.msGridColHeaderPartSelected:"ms-grid-col-header-part-selected",elementColor:r?s.msGridColHeaderElemBgColorsPartSelected:"ms-grid-col-header-elem-bg-colors-part-selected",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsPartSelected:"ms-grid-col-header-elem-hover-bg-colors-part-selected",elementClickColor:r?s.msGridColElemColorsClickPartSelected:"ms-grid-col-elem-colors-click-part-selected"},partSelectedHover:{base:r?s.msGridColHeaderPartSelectedHover:"ms-grid-col-header-part-selected-hover",elementColor:r?s.msGridColHeaderElemBgColorsPartSelectedHover:"ms-grid-col-header-elem-bg-colors-part-selected-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsPartSelectedHover:"ms-grid-col-header-elem-hover-bg-colors-part-selected-hover",elementClickColor:r?s.msGridColElemColorsClickPartSelectedHover:"ms-grid-col-elem-colors-click-part-selected-hover"},allSelected:{base:r?s.msGridColHeaderAllSelected:"ms-grid-col-header-all-selected",elementColor:r?s.msGridColHeaderElemBgColorsAllSelected:"ms-grid-col-header-elem-bg-colors-all-selected",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsAllSelected:"ms-grid-col-header-elem-hover-bg-colors-all-selected",elementClickColor:r?s.msGridColElemColorsClickAllSelected:"ms-grid-col-elem-colors-click-all-selected"},allSelectedHover:{base:r?s.msGridColHeaderAllSelectedHover:"ms-grid-col-header-all-selected-hover",elementColor:r?s.msGridColHeaderElemBgColorsAllSelectedHover:"ms-grid-col-header-elem-bg-colors-all-selected-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsAllSelectedHover:"ms-grid-col-header-elem-hover-bg-colors-all-selected-hover",elementClickColor:r?s.msGridColElemColorsClickAllSelectedHover:"ms-grid-col-elem-colors-click-all-selected-hover"}}],[e.rowHeaderStyleCollection,e.UpdateHeaderStyleFromCss,null,{normal:{base:r?s.msGridRowHeaderNormal:"ms-grid-row-header-normal"},normalHover:{base:r?s.msGridRowHeaderNormalHover:"ms-grid-row-header-normal-hover"},partSelected:{base:r?s.msGridRowHeaderPartSelected:"ms-jsgrid-rowheader-partselected"},partSelectedHover:{base:r?s.msGridRowHeaderPartSelectedHover:"ms-jsgrid-rowheader-partselected"},allSelected:{base:r?s.msGridRowHeaderAllSelected:"ms-grid-row-header-all-selected"},allSelectedHover:{base:r?s.msGridRowHeaderAllSelectedHover:"ms-grid-row-header-all-selected-hover"}}],[e.splitterStyleCollection,e.UpdateSplitterStyleFromCss,null,{normal:{base:r?s.msGridSplitter:"ms-grid-splitter"},normalHandle:{base:r?s.msGridSplitterHandle:"ms-grid-splitter-handle"},hover:{base:r?s.msGridSplitterHover:"ms-grid-splitter-hover"},hoverHandle:{base:r?s.msGridSplitterHandleHover:"ms-grid-splitter-handle-hover"},drag:{base:r?s.msGridSplitterDrag:"ms-grid-splitter-drag"},dragHandle:{base:r?s.msGridSplitterHandleDrag:"ms-grid-splitter-handle-drag"}}],[e.defaultCellStyle,e.UpdateDefaultCellStyleFromCss,null,i.msGridCell],[e.readOnlyCellStyle,t.StyleType.Cell,i.msGridCellReadonly],[e.readOnlyFocusedCellStyle,t.StyleType.Cell,i.msGridCellReadonlyFocused],[e.timescaleTierStyle,t.StyleType.TimescaleTier,r?s.msGridTimescale:"ms-grid-timescale"],[e.groupingStyles,e.UpdateGroupStylesFromCss,null,"ms-grid-group"],[e.widgetDockStyle,t.StyleType.Widget,r?s.msGridWidgetDock:"jsgrid-widget-dock"],[e.widgetDockHoverStyle,t.StyleType.Widget,r?s.msGridWidgetDockHover:"jsgrid-widget-dock-hover"],[e.widgetDockPressedStyle,t.StyleType.Widget,r?s.msGridWidgetDockPressed:"jsgrid-widget-dock-pressed"]],a=0;a<o.length;a++){var l=o[a];null!=l[2]?f.CreateStyleFromCss(l[1],l[2],l[0]):l[1].apply(e,[l[0],l[3]])}return e};e.prototype.SetRTL=function(e){this._rtl=e};e.prototype.MakeJsGridStyleManager=function(){return this.InitStylesFromCSS(this.GetDefaultStyleMgr())};return e})();t.Style=m;(function(e){var r,s;e.CreateStyleFromCss=function(e,t,u,a){var f=n.JsGridUtil.Internal.IsNullOrUndefined(u)?{}:u;if(n.JsGridUtil.Internal.IsNullOrUndefined(r)){n.JsGridUtil.DebugAssert(n.JsGridUtil.Internal.IsNullOrUndefined(s));(r=document.createElement("div")).style.display="none";document.body.appendChild(r);(s=document.createElement("div")).style.display="none";document.body.appendChild(s)}n.JsGridUtil.DebugAssert(""==s.className);r.className=i.msGridBaseStyle+" "+t;for(var l in e)if(null==a||a==e[l].classId||"base"==a&&null==e[l].classId){var c=e[l].jsId;if(e[l].semanticColor)f[l]=o.semanticColors[e[l].semanticColor];else if(""!==c){var h=n.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(r,c,e[l].cssId),p=n.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(s,c,e[l].cssId);if("backgroundColor"!==c||h!==p){var d=n.JsGridUtil.Internal.IsNullOrUndefined(e[l].fromCss)?h:e[l].fromCss(h);null!=d&&(f[l]=d)}else f[l]="transparent"}}return f};e.CreateStyle=function(e,t){var n={};for(var r in e)null!=t[r]&&(n[r]=t[r]);return n};e.MergeCellStyles=function(e,n){var r={};for(var i in t.StyleType.Cell)r[i]=null!=e&&null!=e[i]?e[i]:n[i];return r};e.ApplyCellStyle=function(e,t){var n=e.style;null!=t.textColor&&(n.color=t.textColor);null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor);null!=t.font&&(n.fontFamily=t.font);null!=t.fontSize&&(n.fontSize=t.fontSize);null!=t.fontWeight&&(n.fontWeight=t.fontWeight);null!=t.fontStyle&&(n.fontStyle=t.fontStyle);null!=t.textAlign&&(n.textAlign=t.textAlign)};function u(e,t,r){var i=e.style;if(e.headerStyleType!==t.type){e.headerStyleType=t.type;i.backgroundColor=t.backgroundColor;if(null!=t.innerBorderColor){e.headerStyleInnerBorderString=i.borderBottom="1px solid "+t.innerBorderColor;i["border"+m.getInstance()._rtl.Right]="1px solid "+t.outerBorderColor}else e.headerStyleBorderString=i.borderBottom=i["border"+m.getInstance()._rtl.Right]="1px solid "+t.outerBorderColor;i.borderTop="0px"}var s=r&&r(e,!0);if(null!=s){var o=a(s,e);null!=t.innerBorderColor?s.style.borderBottom=o.headerStyleInnerBorderString:s.style.borderBottom=o.headerStyleBorderString}var u=r&&r(e,!1);null!=(o=null!=u?a(u,e):e).headerStyleInnerBorderString?i.borderBottom=o.headerStyleInnerBorderString:i.borderBottom=o.headerStyleBorderString;function a(e,t){n.JsGridUtil.DebugAssert(null!=e.headerStyleType||null!=t.headerStyleType);return null==e.headerStyleType?t:null==t.headerStyleType||e.headerStyleType>t.headerStyleType?e:t}}e.ApplyRowHeaderStyle=u;e.ApplyCornerHeaderBorderStyle=function(e,t,n){u(e,t,function(){return null})};e.ApplyHeaderInnerBorderStyle=function(e,t,n,r){e.style[t?"borderTop":"border"+r.Left]=n.headerStyleInnerBorderString};e.ApplyColumnContextMenuStyle=function(e,t){e.style.border=a(1,"solid",t.borderColor);e.style.backgroundColor=t.backgroundColor||"transparent"};e.ApplySplitterStyle=function(e,t){e.style.borderLeft=e.style.borderRight=a(1,"solid",t.outerColor);e.style.backgroundColor=t.innerColor};function a(e,t,n){return[e,"px ",t," ",n||"transparent"].join("")}e.MakeBorderString=a;e.GetCellStyleDefaultBackgroundColor=function(){return"#FFFFFF"}})(f=t.StyleUtil||(t.StyleUtil={}))});
define("SGe",["require","exports","cGe","eGe","sGe","bGe","YGe","qGe","WGe","VGe","OGe","pze","CGe","xGe","DGe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(){function e(e,t,i){var s=this;this.disableCount=0;this.bIsInitialized=!1;this.bViewSet=!1;this.eventMgr=new n.JsGridUtil.EventManager;this.delegateMgr=new n.JsGridUtil.DelegateManager;this.intDelegateMgr=new n.JsGridUtil.DelegateManager;this.objBag={};this.TestEventType={Start:0,Finish:1};this.Dispose=function(){if(s.bIsInitialized){window.removeEventListener("unload",s.Dispose);s.objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnBeforeGridDispose);s.objBag.intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnGridDisposing);s.loadingBanner.Dispose();if(n.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(s.parentNode)){s.paneMgr.Dispose();s.parentNode.innerHTML="";s.parentNode=s.parentNode.jsgrid=s.parentNode.jsgridparams=s.parentNode.jsgridtableviewparams=s.parentNode.jsgridrowviewparams=null}delete s.parentNode;s.objBag.parentNode=null;s.bIsInitialized=s.bViewSet=!1;s.commandMgr.RemovePreExecuteNotifier(s.StopEditing.bind(s))}};this.StaticInit();e.style.position="relative";this.parentNode=e;this.bShowLoadingBanner=t;this.loadingBanner=new n.JsGridUtil.LoadingBanner(e,e.id+"_disable_banner");e.jsgrid=this;t&&this.SetEnabledState(!1);if(i){this.objBag.setColumnWidthsToLocalStorage=i.setColumnWidthsToLocalStorage;this.objBag.dragDropMgr=i.dragDropMgr;this.objBag.onSelectionChanged=i.onSelectionChanged}}e.prototype.IsInitialized=function(){return this.bIsInitialized};e.prototype.ResetData=function(e){this.tableCache=e};e.prototype.Init=function(e){var t=this,i=e;this._jsGridParams=this.parentNode.jsgridparams=i;this.parentNode.jsgridtableviewparams=i.tableViewParams;this.parentNode.jsgridrowviewparams=i.tableViewParams&&i.tableViewParams.rowViewParams;this.FireTestEvent(this.TestEventType.Start);this.name=null!=i.name?i.name:"";this.InitOldStyleDelegates();this.tableCache=i.tableCache;this.commandMgr=i.commandMgr;this.commandMgr.IsUndoEnabled()&&this.commandMgr.AddPreExecuteNotifier(this.StopEditing.bind(this));this.objBag.RTL={bEnabled:i.isRTL,left:i.isRTL?"right":"left",Left:i.isRTL?"Right":"Left",right:i.isRTL?"left":"right",Right:i.isRTL?"Left":"Right",ltr:i.isRTL?"rtl":"ltr"};s.Style.getInstance().SetRTL(this.objBag.RTL);this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,this.CallAsyncFn.bind(this));this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.GetLocalizedString,this.GetLocalizedString.bind(this));this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.DoLargeTask,this.DoLargeTask.bind(this));this.objBag.jsGridObj=this;this.objBag.jsGridParams=this._jsGridParams;this.objBag.gridId=this.parentNode.id;this.objBag.eventMgr=this.eventMgr;this.objBag.intEventMgr=new n.JsGridUtil.EventManager;this.objBag.intDelegateMgr=this.intDelegateMgr;this.objBag.commandMgr=i.commandMgr;this.objBag.portalManager=i.portalManager;this.objBag.delegateMgr=this.delegateMgr;this.objBag.styleMgr=i.styleManager;this.objBag.tableCache=i.tableCache;this.objBag.canUserAddColumn=i.canUserAddColumn;this.objBag.showAddColumnMenu=i.showAddColumn;this.objBag.spGrid=i.spGrid;this.objBag.spCsrRenderCtx=i.spCsrRenderCtx;this.objBag.qualifier=i.qualifier;this.objBag.errorMgr=new o.ErrorManager(this.objBag);this.objBag.rowHeaderStateMgr=new u.RowHeaderStateManager(this.objBag.intEventMgr);this.objBag.rowHeaderStates=new u.RowHeaderStates(this.objBag);this.objBag.rowHeaderAutoStates=new u.AutoRowHeaderStates(i.enabledRowHeaderAutoStates,this.objBag);this.objBag.entryRecordMgr=new a.EntryRecordManager(this.objBag);this.objBag.provisionalRecordMgr=new a.ProvisionalRecordManager(this.objBag);this.objBag.parentNode=this.parentNode;this.objBag.bUpdateCoordCache=!1;this.objBag.gridControls={};this.spCsrRenderCtx=i.spCsrRenderCtx;var h="{cursor:pointer} :link {color:"+this.objBag.styleMgr.gridPaneStyle.linkColor+"} :visited {color: "+this.objBag.styleMgr.gridPaneStyle.visitedLinkColor+"}";c.DisplayControl.ImageTextDisplayControl.prototype._styleForLinks=h;c.DisplayControl.TextDisplayControl.prototype._styleForLinks=h;i.bNotificationsEnabled&&o.ErrorNotificationManager.Instance.Init(this.objBag.gridId,this.objBag);this.objBag.controller=this.controller=new f.MVCController(this.objBag,this.GetLocalizedString.bind(this));this.objBag.paneMgr=this.paneMgr=new l.PaneManager(this.parentNode.id,this.objBag,this.GetLocalizedString.bind(this),this.parentNode,i.minHeaderHeight,i.minRowHeight,function(){return 0==t.disableCount});this.paneMgr.SetEventSinks(this.controller.GetViewEventSinks());null!=e.tableViewParams&&this.SetTableViewInternal(e.tableViewParams);window.addEventListener("unload",this.Dispose);this.bIsInitialized=!0;this.FireTestEvent(this.TestEventType.Finish)};e.prototype.InitOldStyleDelegates=function(){null!=this._jsGridParams.fnCreateNewRecords&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.CreateRecords,this._jsGridParams.fnCreateNewRecords);null!=this._jsGridParams.fnExpandColumnMenu&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.ExpandColumnMenu,this._jsGridParams.fnExpandColumnMenu);null!=this._jsGridParams.fnSort&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.Sort,this._jsGridParams.fnSort)};e.prototype.Cleanup=function(){window.removeEventListener("unload",this.Dispose);this.loadingBanner.Dispose();if(n.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(this.parentNode)){this.paneMgr.Dispose();this.parentNode.innerHTML=""}this.bIsInitialized=this.bViewSet=!1};e.prototype.NotifyDataAvailable=function(){this.controller.NotifyDataAvailable()};e.prototype.NotifySave=function(){this.controller.NotifySave()};e.prototype.NotifyHide=function(){this.controller.NotifyHide()};e.prototype.NotifyResize=function(){this.paneMgr.NotifyResize()};e.prototype.ClearTableView=function(){if(this.bViewSet){this.controller.ClearTableView();this.bViewSet=!1}};e.prototype.HideInitialLoadingBanner=function(){if(this.bShowLoadingBanner){this.SetEnabledState(!0);this.bShowLoadingBanner=!1}};e.prototype.ShowInitialGridErrorMsg=function(e){n.JsGridUtil.DebugAssert(!this.bViewSet);this.HideInitialLoadingBanner();this.errorBanner=new n.JsGridUtil.ErrorBanner(this.parentNode,this.parentNode.id+"_initial_error_banner");this.errorBanner.Show(e)};e.prototype.ShowGridErrorMsg=function(e){this.HideInitialLoadingBanner();this.errorBanner=new n.JsGridUtil.ErrorBanner(this.parentNode,this.parentNode.id+"_error_banner");this.errorBanner.Show(e)};e.prototype.LaunchPrintPreview=function(e,t,n,i,s,o,u,a,f,l){var c=this,p=null;null==i&&(i="test");this.paneMgr.GetRecordMap(function(d){c.objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return p=c.tableCache.GetRecords([{pos:0,count:c.tableCache.GetRecordCount()}],function(t){p=t;e()})},function(){c._jsGridParams.tableViewParams.rowViewParams.view=c.tableCache.GetView();s?h.FinishLaunchPrintPreview(p.records[0],c._jsGridParams,e,t,n,u,a,i,s,o,c.parentNode.clientWidth-c.objBag.paneMgr.GetSplitterPosition()-r.JsGridConstants.Internal.SplitterWidth,c.objBag.paneMgr.GetGanttZoomLevel(),f,l):h.FinishLaunchPrintPreview(p.records[0],c._jsGridParams,e,t,n,u,a,i,s,null,0,0,null,null)})})};e.prototype.GetAllDataJson=function(e,t){this.paneMgr.GetAllDataJson(e,t)};e.prototype.GetAllDataAfterExpansionJson=function(e,t){this.paneMgr.GetAllDataAfterExpansionJson(e,t)};e.prototype.AddColumn=function(e,t,n){this.paneMgr.AddColumn(e,n);this.objBag.entryRecordMgr.AddColumn(e.columnKey,t)};e.prototype.SetTableView=function(e){this._jsGridParams.tableViewParams=this.parentNode.jsgridtableviewparams=e;this.parentNode.jsgridrowviewparams=e.rowViewParams;this.FireTestEvent(this.TestEventType.Start);this.SetTableView(e);this.FireTestEvent(this.TestEventType.Finish)};e.prototype.SetTableViewInternal=function(e){this.bViewSet&&this.ClearTableView();this.bViewSet=!0;this.HideInitialLoadingBanner();this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetGridRowStyleId)&&(e.fnGetGridRowStyleId=this.delegateMgr.GetDelegate(r.JsGridConstants.DelegateType.GetGridRowStyleId));null!=this._oldStyleAttachedRightClickFn&&this.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnRightClick,this._oldStyleAttachedRightClickFn);this._oldStyleAttachedRightClickFn=null==e.fnOnRightClick?null:function(t){e.fnOnRightClick(t.eventInfo,t.context,t.recordKey,t.fieldKey)};null!=this._oldStyleAttachedRightClickFn&&this.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRightClick,this._oldStyleAttachedRightClickFn);this.posConverter=new p.PositionConverter(this.tableCache,this.objBag);if(null!=e.operationalConstantsFieldKeyMap){this.operationalConstantsFieldKeyMap=e.operationalConstantsFieldKeyMap;this.operationalUtil=this.GetOperationalUtility()}n.JsGridUtil.DebugAssert(!e.bNewRowEnabled||this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CreateEntryRecord)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.TryInsertEntryRecord));n.JsGridUtil.DebugAssert(null!=this.operationalUtil);this.controller.SetTableView(e.rowViewParams,e.columns,e.gridFieldMap,e.defaultEditMode,e.bNewRowEnabled,e.bEditingEnabled,e.splitterPos,this.posConverter,this.operationalUtil,e.fnGetGridRowStyleId,e.allowedSelectionTypes,e.bMovableColumns,e.bResizableColumns,e.bHidableColumns,e.bSortableColumns,e.bAutoFilterableColumns,e.bRowHeadersEnabled,e.paneLayout,e.ganttParams,e.pivotedGridParams,e.bRecordIndicatorCheckboxesEnabled,e.checkSelectionCheckboxHiddenRecordKeys,e.checkSelectionCheckboxDisabledRecordKeys,e.checkSelectionCheckedRecordKeys)};e.prototype.SetRowView=function(e){this._jsGridParams.tableViewParams.rowViewParams=this.parentNode.jsgridrowviewparams=e;this.FireTestEvent(this.TestEventType.Start);this.controller.SetRowView(e);this.FireTestEvent(this.TestEventType.Finish)};e.prototype.Enable=function(){this.SetEnabledState(!0)};e.prototype.Disable=function(e){this.SetEnabledState(!1,e)};e.prototype.EnableEditing=function(){this.controller.EnableEditing()};e.prototype.DisableEditing=function(){this.controller.DisableEditing()};e.prototype.TryBeginEdit=function(){return this.controller.TryBeginEdit()};e.prototype.FinalizeEditing=function(e,t){this.controller.FinalizeEditing(e,t)};e.prototype._GetPaneManager=function(){return this.objBag.paneMgr};e.prototype.GetColumnByFieldKey=function(e,t){var n=this.paneMgr.GetGridPane().GetGridPaneConverter().FieldKeyToColIdx(e);return null==n?null:this.paneMgr.GetColumns(t)[n]};e.prototype.Focus=function(){this.paneMgr.Focus()};e.prototype.TryCommitFirstEntryRecords=function(e){this.objBag.entryRecordMgr.TryCommitFirstEntryRecords(e,!0)};e.prototype.ClearUncommittedEntryRecords=function(){this.objBag.entryRecordMgr.ClearUncommittedEntryRecords()};e.prototype.ClearEntryRecord=function(e){this.objBag.entryRecordMgr.ClearEntryRecord(e)};e.prototype.AnyUncomittedEntryRecords=function(){return null!=this.objBag&&null!=this.objBag.entryRecordMgr&&this.objBag.entryRecordMgr.AnyUncomittedEntryRecords()};e.prototype.AnyUncomittedProvisionalRecords=function(){return null!=this.objBag&&null!=this.objBag.provisionalRecordMgr&&this.objBag.provisionalRecordMgr.AnyUncomittedProvisionalRecords()};e.prototype.GetRecord=function(e){return this.objBag.entryRecordMgr.IsEntryRecordKey(e)?this.objBag.entryRecordMgr.GetEntryRecord(e):this.objBag.tableCache.GetCachedRecord(e)};e.prototype.GetEntryRecord=function(e){return this.objBag.entryRecordMgr.GetEntryRecord(e)};e.prototype.IsEntryRecordKey=function(e){return this.objBag.entryRecordMgr.IsEntryRecordKey(e)};e.prototype.IsCellEditable=function(e,t,n){return this.paneMgr.IsCellEditable(e,t,n)};e.prototype.AddBuiltInRowHeaderState=function(e,t){this.AddRowHeaderState(e,this.objBag.rowHeaderStates[t])};e.prototype.AddRowHeaderState=function(e,t){this.objBag.rowHeaderStateMgr.AddRowHeaderState(e,t)};e.prototype.RemoveRowHeaderState=function(e,t){this.objBag.rowHeaderStateMgr.RemoveRowHeaderState(e,t)};e.prototype.GetCheckSelectionManager=function(){return this.controller.GetCheckSelectionManager()};e.prototype.UpdateProperties=function(e,t,r){var i=this.controller.UpdateProperties(e,t,r,null);n.JsGridUtil.DebugAssert(null!=i,"can't update the NewRow programmatically");return i};e.prototype.GetLastRecordKey=function(){return this.objBag.paneMgr.GetLastRecordKey()};e.prototype.InsertProvisionalRecordBefore=function(e,t,n){return this.objBag.provisionalRecordMgr.InsertProvisionalRecordBefore(e,t,n)};e.prototype.InsertProvisionalRecordAfter=function(e,t,n){null==e&&(e=this.objBag.paneMgr.GetLastRecordKey());return this.objBag.provisionalRecordMgr.InsertProvisionalRecordAfter(e,t,n)};e.prototype.IsProvisionalRecordKey=function(e){return this.objBag.provisionalRecordMgr.IsProvisionalRecordKey(e)};e.prototype.InsertRecordAfter=function(e,t,n){return this.controller.InsertRecordAfter(e,t,n,!0)};e.prototype.InsertRecordBefore=function(e,t,n){return this.controller.InsertRecordBefore(e,t,n,!0)};e.prototype.InsertHiddenRecord=function(e,t,n){return this.controller.InsertHiddenRecord(e,t,n)};e.prototype.DeleteRecords=function(e,t){return this.controller.DeleteRecords(e,t)};e.prototype.IndentRecords=function(e,t){return this.controller.AdjustRecordsIndentLevel(e,1,t)};e.prototype.OutdentRecords=function(e,t){return this.controller.AdjustRecordsIndentLevel(e,-1,t)};e.prototype.ReorderRecords=function(e,t,n,r){return this.controller.ReorderRecords(e,t,n,r)};e.prototype.GetContiguousRowSelectionWithoutEntryRecords=function(){var e=this,t=function(t){for(var n=[],r=0;r<t.length;r++)e.IsEntryRecordKey(t[r])||n.push(t[r]);return n},n=(function(e){if(e.length<=1)return e;var t=e.slice(0);t.sort(function(e,t){return e.begin<t.begin});for(var n=[t[0]],r=1;r<t.length;r++){if(n[0].end+1!=t[r].begin)return e;n[0].end=t[r].end;n[0].keys.push(t[r].keys)}return n})(this.GetSelectedRowRanges());return 1==n.length?{begin:n[0].begin,end:n[0].end,keys:t(n[0].keys)}:1==(n=this.GetSelectedCellRanges()).length&&n[0].rowRange.keys.length>0?{begin:n[0].rowRange.begin,end:n[0].rowRange.end,keys:t(n[0].rowRange.keys)}:null};e.prototype.CanMoveRecordsUpByOne=function(e){return!(!this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)||!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,e))&&(!(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,e))&&(0!=(e=this.GetReorderRange(e)).length&&this.posConverter.RecordKeyToViewIdx(e[0])>0))};e.prototype.CanMoveRecordsDownByOne=function(e){return!(!this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)||!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,e))&&(!(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,e))&&(0!=(e=this.GetReorderRange(e)).length&&this.posConverter.RecordKeyToViewIdx(e[e.length-1])<this.GetViewRecordCount()-1))};e.prototype.MoveRecordsUpByOne=function(e){e=this.GetReorderRange(e);var t=this.posConverter.RecordKeyToViewIdx(e[0]),n=this.posConverter.ViewIdxToRecordKey(t-1);return this.ReorderRecords(e[0],e[e.length-1],n,!0)};e.prototype.MoveRecordsDownByOne=function(e){e=this.GetReorderRange(e);var t=this.posConverter.RecordKeyToViewIdx(e[e.length-1]),n=this.posConverter.ViewIdxToRecordKey(t+2);this.IsEntryRecordKey(n)&&(n=null);return this.ReorderRecords(e[0],e[e.length-1],n,!0)};e.prototype.GetReorderRange=function(e){return e};e.prototype.GetNodeExpandCollapseState=function(e){return this.controller.GetNodeExpandCollapseState(e)};e.prototype.ToggleExpandCollapse=function(e){this.controller.ToggleExpandCollapse(e)};e.prototype.AttachEvent=function(e,t){this.eventMgr.AttachEvent(e,t)};e.prototype.DetachEvent=function(e,t){this.eventMgr.DetachEvent(e,t)};e.prototype.SetDelegate=function(e,t){this.delegateMgr.SetDelegate(e,t)};e.prototype.GetDelegate=function(e){return this.delegateMgr.GetDelegate(e)};e.prototype.RefreshRow=function(e){this.paneMgr.NotifyChangedRows(this.posConverter.RecordKeyToViewIdx(e),1)};e.prototype.RefreshAllRows=function(e,t){this.paneMgr.RefreshAllRows(e,t)};e.prototype.ClearChanges=function(){this.controller.ClearChanges()};e.prototype.GetGanttZoomLevel=function(){return this.paneMgr.GetGanttZoomLevel()};e.prototype.SetGanttZoomLevel=function(e){this.paneMgr.SetGanttZoomLevel(e)};e.prototype.ScrollGanttToDate=function(e){this.paneMgr.ScrollGanttToDate(e)};e.prototype.ScrollCellIntoView=function(e,t,n){this.paneMgr.ScrollCellIntoView(e,t,n)};e.prototype.GetTopRecordIndex=function(){return this.posConverter.GetTopViewIdx()};e.prototype.GetTopRowIndex=function(e){return this.paneMgr.GetTopRowIndex(e)};e.prototype.GetViewRecordCount=function(){return this.posConverter.GetViewRecordCount()};e.prototype.GetViewIndexOfRecord=function(e){return this.posConverter.RecordKeyToViewIdx(e)};e.prototype.GetRecordKeyByViewIndex=function(e){return this.posConverter.ViewIdxToRecordKey(e)};e.prototype.GetLeftColumnIndex=function(e){return this.paneMgr.GetLeftColumnIndex(e)};e.prototype.GetOutlineLevel=function(e){return this.controller.GetOutlineLevel(e)};e.prototype.ShowColumn=function(e,t){this.paneMgr.ShowColumn(e,t)};e.prototype.HideColumn=function(e){this.paneMgr.HideColumn(e)};e.prototype.EnsurePaneWidth=function(){this.paneMgr.EnsurePaneWidth()};e.prototype.RenameColumn=function(e){this.paneMgr.RenameColumn(e)};e.prototype.UpdateColumns=function(e){this.paneMgr.UpdateColumns(e)};e.prototype.GetColumns=function(e){return this.paneMgr.GetColumns(e)};e.prototype.GetSplitterPosition=function(){return this.paneMgr.GetSplitterPosition()};e.prototype.SetSplitterPosition=function(e){this.paneMgr.SetSplitterPosition(e)};e.prototype.AnyErrors=function(){return this.objBag.errorMgr.AnyErrors()};e.prototype.AnyErrorsInRecord=function(e){return this.objBag.errorMgr.AnyErrorsInRow(e)};e.prototype.SetCellError=function(e,t,n){return this.objBag.errorMgr.SetCellError(e,t,n)};e.prototype.SetRowError=function(e,t){return this.objBag.errorMgr.SetRowError(e,t)};e.prototype.ClearCellError=function(e,t,n){this.objBag.errorMgr.ClearCellError(e,t,n)};e.prototype.ClearAllErrorsOnCell=function(e,t){this.objBag.errorMgr.ClearAllErrorsOnCell(e,t)};e.prototype.ClearRowError=function(e,t){this.objBag.errorMgr.ClearRowError(e,t)};e.prototype.ClearAllErrorsOnRow=function(e){return this.objBag.errorMgr.ClearAllErrorsOnRow(e)};e.prototype.GetRowErrorMessage=function(e){return this.objBag.errorMgr.GetMessageForRow(e)};e.prototype.GetCellErrorMessage=function(e,t){return this.objBag.errorMgr.GetMessageForCell(e,t)};e.prototype.ScrollToAndExpandNextError=function(e,t){return this.objBag.paneMgr.ScrollToAndExpandNextError(e,null,t)};e.prototype.ScrollToAndExpandNextErrorOnRecord=function(e,t,r,i){n.JsGridUtil.DebugAssert(null!=t);return this.objBag.paneMgr.ScrollToAndExpandNextError(e,t,r,i)};e.prototype.GetFocusedItem=function(){return this.paneMgr.GetFocusedItemInfo()};e.prototype.SendKeyDownEvent=function(e){return this.objBag.focusMgr.HandleKeyDown(e)};e.prototype.JumpToEntryRecord=function(){this.paneMgr.JumpToEntryRecord()};e.prototype.SelectRowRange=function(e,t,n,r){this.paneMgr.Select(e,t,null,null,n,r)};e.prototype.SelectColumnRange=function(e,t,n,r){this.paneMgr.Select(null,null,e,t,n,r)};e.prototype.SelectCellRange=function(e,t,n,r,i,s){this.paneMgr.Select(e,t,n,r,i,s)};e.prototype.SelectRowRangeByKey=function(e,t,n,r){this.paneMgr.SelectByKey(e,t,null,null,n,r)};e.prototype.SelectColumnRangeByKey=function(e,t,n,r){this.paneMgr.SelectByKey(null,null,e,t,n,r)};e.prototype.SelectCellRangeByKey=function(e,t,n,r,i,s){this.paneMgr.SelectByKey(e,t,n,r,i,s)};e.prototype.ChangeKeys=function(e,t){this.objBag.controller.ChangeKeys(e,t)};e.prototype.GetSelectedRowRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.RowRange)};e.prototype.GetSelectedColumnRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.ColumnRange)};e.prototype.GetSelectedCellRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.CellRange)};e.prototype.GetSelectedRanges=function(e){return this.paneMgr.GetOrderedSelections(e,null)};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){return this.controller.MarkPropUpdateInvalid(e,t,n,r)};e.prototype.GetCurrentChangeKey=function(){return this.controller.GetCurrentChangeKey()};e.prototype.CreateAndSynchronizeToNewChangeKey=function(){var e=this.controller.CreateDataUpdateCmd();this.commandMgr.Execute(e,null,d.CommandManagerConstants.CommandType.Explicit);return e.GetChangeKey()};e.prototype.CreateDataUpdateCmd=function(e){return this.controller.CreateDataUpdateCmd(e)};e.prototype.IsChangeKeyApplied=function(e){return this.objBag.controller.IsChangeKeyApplied(e)};e.prototype.GetChangeKeyForVersion=function(e){return this.controller.GetChangeKeyForVersion(e)};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.controller.TryReadPropForChangeKey(e,t,n)};e.prototype.GetUnfilteredHierarchyMap=function(){return null};e.prototype.GetHierarchyState=function(e){return null};e.prototype.IsGroupingRecordKey=function(e){return!1};e.prototype.IsGroupingColumnKey=function(e){return!1};e.prototype.GetSelectedRecordKeys=function(e){return this.GetSelectedRecordKeysInternal(e)};e.prototype.CutToClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnCut(e)};e.prototype.CopyToClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnCopy(e)};e.prototype.PasteFromClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnPaste(e)};e.prototype.TryRestoreFocusAfterInsertOrDeleteColumns=function(e){var t=this.objBag.selectionMgr.GetFocusedPane();null!=t&&t.TryRestoreFocusAfterInsertOrDeleteColumns(e)};e.prototype.GetUndoManager=function(){return this.commandMgr};e.prototype.GetVisibleRecordCount=function(){return this.objBag.paneMgr.GetVisibleRecordCount()};e.prototype.GetRecordIndicatorCheckBoxColumnIndex=function(){return this.objBag.paneMgr.GetRecordIndicatorCheckBoxColumnIndex()};e.prototype.IsRecordVisibleInView=function(e){return null!=this.posConverter.RecordKeyToViewIdx(e)};e.prototype.GetHierarchyQueryObject=function(){return null};e.prototype.StopEditing=function(){this.objBag.paneMgr.StopEditing(!1)};e.prototype.GetSelectedRecordKeysInternal=function(e){var t,n=this.GetSelectedRowRanges(),r=this.GetSelectedColumnRanges(),s=this.GetSelectedCellRanges();if(0!==r.length)t=this.tableCache.GetView();else if(e){t=[];for(var o=0;o<n.length;o++)t=t.concat(n[o].keys);for(o=0;o<s.length;o++)t=t.concat(s[o].rowRange.keys)}else{var u=new i.Set;for(o=0;o<n.length;o++)u.AddArray(n[o].keys);for(o=0;o<s.length;o++)u.AddArray(s[o].rowRange.keys);t=u.ToArray()}return t};e.prototype.StaticInit=function(){this._bStaticInit||(this._bStaticInit=!0)};e.prototype.GetOperationalUtility=function(){var e=this,t=function(t){return e.operationalConstantsFieldKeyMap[t]};return{GetFieldKey:t,GetProp:function(e,n){var r=t(n);return{fieldKey:r,prop:e.GetProp(r)}},GetValue:function(e,n){return e.GetDataValue(t(n))}}};e.prototype.CallAsyncFn=function(e,t){return n.JsGridUtil.Internal.CallAsyncFn(e,t,function(){this.Disable()},function(){this.Enable()})};e.prototype.DoLargeTask=function(e,t,r,i,s){var o=this,u=0;if(e>t){n.JsGridUtil._fixPasteNewRowPerfKillSwitchIsActive&&this.Disable();n.JsGridUtil.AsynchronousTaskManager.GetInstance().RegisterTask(function(){var s=(Math.floor(u/t)+1)*t;if((u=r(u,s))<e)return!0;n.JsGridUtil._fixPasteNewRowPerfKillSwitchIsActive&&o.Enable();i();return!1},s)}else{r(0,e);i()}};e.prototype.GetLocalizedString=function(e){e=e.charAt(0).toLowerCase()+e.substr(1);var t=this._jsGridParams.tableViewParams.messageOverrides;return t&&t[e]||SP.JsGrid.Res[e]};e.prototype.FireTestEvent=function(e){if(this.parentNode.fireEvent)switch(e){case this.TestEventType.Start:this.parentNode.fireEvent("onbeforeupdate");break;case this.TestEventType.Finish:this.parentNode.fireEvent("onafterupdate")}};e.prototype.SetEnabledState=function(e,t){if(e&&1==this.disableCount)this.loadingBanner.Hide();else if(!e){var r=null==t?SP.JsGrid.Res.loadingMsg:t;0==this.disableCount?this.loadingBanner.Show(r):this.loadingBanner.UpdateText(r)}this.disableCount-=e?1:-1;null!=this.objBag.ariaMgr&&this.objBag.ariaMgr.EnableGrid(e);n.JsGridUtil.DebugAssert(this.disableCount>=0)};e.prototype.GetSpCsrRenderCtx=function(){return this.spCsrRenderCtx};return e})();t.JsGridControl=v;var m=function(e){this.tableCache=null;this.name=null;this.bNotificationsEnabled=!1;this.styleManager=s.Style.getInstance().MakeJsGridStyleManager();this.minHeaderHeight=0;this.minRowHeight=0;this.commandMgr=new d.CommandManager(e.commandManagerParams);this.enabledRowHeaderAutoStates=(new i.Set).AddArray([r.JsGridConstants.RowHeaderAutoStyleId.Error]);this.isRTL="rtl"==n.JsGridUtil.Utility.GetDocumentDirection();this.tableViewParams=new g};t.JsGridControlParameters=m;var g=function(){this.keyFieldName=null;this.columns=null;this.gridFieldMap=null;this.messageOverrides=null;this.operationalConstantsFieldKeyMap=null;this.defaultEditMode=r.JsGridConstants.EditMode.ReadWriteDefer;this.allowedSelectionTypes=r.JsGridConstants.SelectionTypeFlags.MultipleCellRanges|r.JsGridConstants.SelectionTypeFlags.MultipleRowRanges|r.JsGridConstants.SelectionTypeFlags.MultipleColRanges;this.bMovableColumns=!0;this.bResizableColumns=!0;this.bHidableColumns=!0;this.bSortableColumns=!0;this.bAutoFilterableColumns=!0;this.bRowHeadersEnabled=!0;this.bRecordIndicatorCheckboxesEnabled=!1;this.bCreateFieldColumnEnabled=!1;this.bFillControlEnabled=!0;this.checkSelectionCheckboxHiddenRecordKeys=[];this.checkSelectionCheckboxDisabledRecordKeys=[];this.checkSelectionCheckedRecordKeys=[];this.bEditingEnabled=!1;this.bNewRowEnabled=!1;this.splitterPos=400;this.paneLayout=r.JsGridConstants.PaneLayout.GridOnly;this.ganttParams=null;this.pivotedGridParams=null;this.rowViewParams=new y};t.TableViewParameters=g;var y=function(){this.view=null;this.minimalInfo=null;this.topViewIdx=0;this.hierarchyMode=r.JsGridConstants.HierarchyMode.None;this.groupingLevel=null;this.groupingRecordKeyPrefix;this.autoFilterState=null;this.unfilteredHierarchyMgr=null;this.hierarchyDelayLoadKeys=null;this.hierarchyState=null;this.sortState=null;this.filterState=null;this.autoFilterEntries=null;this.filteredDescCounts=null};t.RowViewParameters=y;var b=function(){this.columns=null};t.PivotedGridParameters=b;var w=function(){this.dateRange=null;this.ganttBarStyles=null;this.ganttZoomLevel=3;this.fnRenderGanttRow=null;this.fnGetGanttBarDate=null;this.fnGetGanttBarStyleIds=null;this.fnGetPredecessors=null;this.workDayStart=n.JsGridUtil.SpRegionalSettings.workDayStart;this.workDayEnd=n.JsGridUtil.SpRegionalSettings.workDayEnd;this.fieldKeyRedrawFilter=null};t.GanttParameters=w});
define("YGe",["require","exports","eGe","cGe","sGe","ce","me","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";u=u.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var a=s.Killswitch.isActivated("0557E1F5-5D22-4E62-BF9E-E4457A269D68","8/05/2020","Add/remove filedKey map of fields that have records with errors in that field"),f={ODB:1725};t.ErrorType={Row:1,Cell:2};var l=(function(){function e(e){this._rowErrs=new p;this._cellErrs={};this._key=e}e.prototype.AddRowError=function(e,t){this._rowErrs.AddError(e,t)};e.prototype.AddCellError=function(e,t,n){e in this._cellErrs||(this._cellErrs[e]=new p);this._cellErrs[e].AddError(t,n)};e.prototype.ClearRowError=function(e){return this._rowErrs.RemoveError(e)};e.prototype.ClearCellError=function(e,t){if(e in this._cellErrs&&this._cellErrs[e].RemoveError(t)){this._cellErrs[e].AnyErrors()||delete this._cellErrs[e];return!0}return!1};e.prototype.ClearAllErrorsOnCell=function(e){e in this._cellErrs&&delete this._cellErrs[e]};e.prototype.ClearAllErrorsOnRow=function(){this._rowErrs=new p};e.prototype.AnyErrors=function(){return this._rowErrs.AnyErrors()||!r.JsGridUtil.Internal.IsAssocArrayEmpty(this._cellErrs)};e.prototype.AnyErrorsOnCell=function(e){return e in this._cellErrs&&this._cellErrs[e].AnyErrors()};e.prototype.AnyErrorsOnRow=function(){return this._rowErrs.AnyErrors()};e.prototype.GetMessageForCell=function(e){return e in this._cellErrs?this._cellErrs[e].GetTopMessage(e):null};e.prototype.GetMessageForRow=function(){return this._rowErrs.GetTopMessage()};e.prototype.GetIdForCell=function(e){return e in this._cellErrs?this._cellErrs[e].GetTopId():null};e.prototype.GetIdForRow=function(){return this._rowErrs.GetTopId()};e.prototype.GetMinError=function(e){var n=this,r=this._rowErrs.GetMinError(null!=e?function(t){return e(n._key,null,t)}:null);null!=r&&(r.type=t.ErrorType.Row);for(var i in this._cellErrs){var s=this._cellErrs[i].GetMinError(null!=e?function(t){return e(n._key,i,t)}:null);if(null!=s&&(null==r||s.id<r.id)){(r=s).fieldKey=i;r.type=t.ErrorType.Cell}}return r};return e})();t.RecordErrorCollection=l;var c=(function(){function e(e){this._curId=0;this._errors={};this._fieldsWithErrors={};this._currentlyDeletedRecords=new i.Set;e.intEventMgr.AttachEvent(n.JsGridConstants.Internal.EventType.OnBeforeRecordInserted,this.OnRecordInserted.bind(this));e.intEventMgr.AttachEvent(n.JsGridConstants.Internal.EventType.OnBeforeRecordDeleted,this.OnRecordDeleted.bind(this));this._objBag=e}e.prototype.SetRowError=function(e,t){var i=this.AnyErrors();null==this._errors[e]&&(this._errors[e]=new l(e));var s=this._curId++;t=null!=t?t:SP.JsGrid.Res.defaultRowMessage;var o=i&&this._errors[e].AnyErrorsOnRow();this._errors[e].AddRowError(s,t);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!0,!0,o,s,t));i||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0));return s};e.prototype.ClearRowError=function(e,t){if(null!=this._errors[e]&&this._errors[e].ClearRowError(t)){this.TryCleanUpRecord(e);var i=e in this._errors&&this._errors[e].AnyErrorsOnRow();this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!1,i,!0,t,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1));return!0}return!1};e.prototype.SetCellError=function(e,t,i){var s=this.AnyErrors();null==this._errors[e]&&(this._errors[e]=new l(e));var o=this._errors[e].AnyErrorsOnCell(t),u=this._curId++;this._errors[e].AddCellError(t,u,i);a||this.UpdateFieldKeysErrors(t,e,!0);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!0,!0,o,u));s||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0));return u};e.prototype.ClearCellError=function(e,t,i){if(null!=this._errors[e]&&this._errors[e].ClearCellError(t,i)){this.TryCleanUpRecord(e);var s=e in this._errors&&this._errors[e].AnyErrorsOnCell(t);a||this.UpdateFieldKeysErrors(t,e,!1);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!1,s,!0,i));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1));return!0}return!1};e.prototype.ClearAllErrorsOnRow=function(e){var t=!1;if(e in this._errors){t=!0;this._errors[e].ClearAllErrorsOnRow();this.TryCleanUpRecord(e);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!1,!1,-1,null,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))}return t};e.prototype.ClearAllErrorsOnCell=function(e,t){var i=!1;if(e in this._errors&&this._errors[e].AnyErrorsOnCell(t)){i=!0;var s=this._errors[e].GetIdForCell(t);this._errors[e].ClearAllErrorsOnCell(t);this.TryCleanUpRecord(e);a||this.UpdateFieldKeysErrors(t,e,!1);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!1,!1,s,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))}return i};e.prototype.CellHasError=function(e,t){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)&&this._errors[e].AnyErrorsOnCell(t)};e.prototype.GetMessageForCell=function(e,t){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)?this._errors[e].GetMessageForCell(t):null};e.prototype.GetMessageForRow=function(e){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)?this._errors[e].GetMessageForRow():null};e.prototype.AnyErrors=function(){var e=!1;for(var t in this._errors)if(!this._currentlyDeletedRecords.Contains(t)){e=!0;break}return e};e.prototype.AnyErrorsInRow=function(e){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)&&this._errors[e].AnyErrors()};e.prototype.AnyErrorsInField=function(e){return this._fieldsWithErrors[e]&&this._fieldsWithErrors[e].length>0};e.prototype.GetNextError=function(e,t){var n=null;if(this.AnyErrors()){null!=e&&e<this._curId&&(n=this.GetMinError(function(n,r,i){return i>e&&(null==t||t(n,r,i))}));null==n&&(n=this.GetMinError(t))}return n};e.prototype.GetNextErrorForRecord=function(e,t,n){var r=null;if(t in this._errors&&!this._currentlyDeletedRecords.Contains(t)){null!=e&&e<this._curId&&(r=this._errors[t].GetMinError(function(t,r,i){return i>e&&(null==n||n(t,r,i))}));null==r&&(r=this._errors[t].GetMinError(n));null!=r&&(r.recordKey=t)}return r};e.prototype.ChangeKeys=function(e,t){if(this._currentlyDeletedRecords.Contains(e)){this._currentlyDeletedRecords.Remove(e);this._currentlyDeletedRecords.Add(t)}if(e in this._errors){this._errors[t]=this._errors[e];delete this._errors[e]}};e.prototype.GetMinError=function(e){var t=null;for(var n in this._errors){var r=this._errors[n].GetMinError(e);null!=r&&(null==t||r.id<t.id)&&((t=r).recordKey=n)}return t};e.prototype.OnRecordInserted=function(e){var t=this.AnyErrors();this._currentlyDeletedRecords.Remove(e.recordKey);!t&&this.AnyErrors()&&this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0))};e.prototype.OnRecordDeleted=function(e){var t=this.AnyErrors();this._currentlyDeletedRecords.Add(e.recordKey);t&&!this.AnyErrors()&&this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))};e.prototype.TryCleanUpRecord=function(e){this._errors[e].AnyErrors()||delete this._errors[e]};e.prototype.UpdateFieldKeysErrors=function(e,t,n){var r;n?void 0!==this._fieldsWithErrors[e]?this._fieldsWithErrors[e].push(t):this._fieldsWithErrors[e]=[t]:this._fieldsWithErrors[e]=(null===(r=this._fieldsWithErrors[e])||void 0===r?void 0:r.filter(function(e){return e!==t}))||[]};return e})();t.ErrorManager=c;var h=(function(){function e(){this._notificationId=null;this._lastExpandedId=null}Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0});e.prototype.Init=function(e,t){var r=this;this._objBag=t;this._objBag.eventMgr.AttachEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,this.NotifyError);this._id=e;window[this._id+"_onclick"]=function(){r._lastExpandedId=r._objBag.jsGridObj.ScrollToAndExpandNextError(r._lastExpandedId)}};e.prototype.NotifyError=function(e){if(e.bAnyErrors&&null==this._notificationId)this._notificationId=addNotification((r.JsGridUtil.Internal.IsFeatureEnabled(f),u.spGridErrorNotification),!0);else if(!e.bAnyErrors&&null!=this._notificationId){removeNotification(this._notificationId);this._notificationId=null}};return e})();t.ErrorNotificationManager=h;var p=(function(){function e(){this._errors=[]}e.prototype.AddError=function(e,t){this._errors.unshift({id:e,msg:t})};e.prototype.RemoveError=function(e){var t=r.JsGridUtil.Internal.FindInArray(this._errors,function(t){return e==t.id});if(null!=t){this._errors.splice(t,1);return!0}return!1};e.prototype.AnyErrors=function(){return 0!==this._errors.length};e.prototype.GetTopMessage=function(){return this._errors.length>0?this._errors[0].msg:null};e.prototype.GetTopId=function(){return this._errors.length>0?this._errors[0].id:null};e.prototype.GetMinError=function(e){for(var t=null,n=this._errors.length-1;n>=0;n--){var r=this._errors[n];(null==e||e(r.id))&&(t={message:r.msg,id:r.id})}return t};e.prototype.ContainsError=function(e){return null!=r.JsGridUtil.Internal.FindInArray(this._errors,function(t){return e==t.id},null)};return e})()});
define("qGe",["require","exports","cGe","eGe","Zd","oc","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o){"use strict";var u=o.RowHeaderState_3;o=o.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var a={ODB:1725},f=(function(){function e(e){this._rowHeaderStates={};this._intEventMgr=e}e.prototype.AddRowHeaderState=function(e,t){var i=null;e in this._rowHeaderStates?i=this._rowHeaderStates[e][0]:this._rowHeaderStates[e]=[];var s=this._rowHeaderStates[e],o=n.JsGridUtil.Internal.LowerBoundCompare(s,t.GetPriority(),function(e,t){return t>s[e].GetPriority()});s.splice(o,0,t);null!=i&&s[0].GetId()===i.GetId()||this._intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,n.JsGridUtil.Internal.EventArgs.OnRowHeaderStateChanged(e,s[0]))};e.prototype.RemoveRowHeaderState=function(e,t){if(e in this._rowHeaderStates){var i=this._rowHeaderStates[e][0];this.RemoveLastStateWithId(this._rowHeaderStates[e],t);0==this._rowHeaderStates[e].length&&delete this._rowHeaderStates[e];null!=this._rowHeaderStates[e]&&i.GetId()===this._rowHeaderStates[e][0].GetId()||this._intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,n.JsGridUtil.Internal.EventArgs.OnRowHeaderStateChanged(e,this._rowHeaderStates[e]&&this._rowHeaderStates[e][0]))}};e.prototype.ChangeKeys=function(e,t){if(e in this._rowHeaderStates){this._rowHeaderStates[t]=this._rowHeaderStates[e];delete this._rowHeaderStates[e]}};e.prototype.GetRowHeaderState=function(e){return e in this._rowHeaderStates?this._rowHeaderStates[e][0]:null};e.prototype.RemoveLastStateWithId=function(e,t){for(var n=0;n<e.length;n++)if(e[n].GetId()==t){e.splice(n,1);break}};return e})();t.RowHeaderStateManager=f;var l=(function(){function e(e,t,n,r,i){this.id=e;this.img=t;this.priority=n;this.tooltip=r;this.fnOnClick=i}e.prototype.GetId=function(){return this.id};e.prototype.GetImg=function(){return this.img};e.prototype.GetPriority=function(){return this.priority};e.prototype.GetOnClick=function(){return this.fnOnClick};e.prototype.GetTooltip=function(){return this.tooltip};e.prototype.toString=function(){return this.id};return e})();t.RowHeaderState=l;var c=function(e){this[r.JsGridConstants.RowHeaderStyleId.Transfer]=new l(r.JsGridConstants.RowHeaderStyleId.Transfer,new n.JsGridUtil.ImageWithFabricIcons({spinnerProps:{size:i.SpinnerSize.xSmall,styles:n.JsGridUtil.Internal.IsFeatureEnabled(a)?{circle:{width:14,height:14}}:{}}}),r.JsGridConstants.RowHeaderStatePriorities.Transfer,SP.JsGrid.Res.transferHeaderStateTooltip,null);this[r.JsGridConstants.RowHeaderStyleId.Conflict]=new l(r.JsGridConstants.RowHeaderStyleId.Conflict,new n.JsGridUtil.ImageWithFabricIcons({imgSrc:n.JsGridUtil.Internal.SiteUrl+r.JsGridConstants.ImagesDirectory+"jsgridcluster.png",bIsClustered:!0,optOuterCssNames:"clip16x16",optImgCssNames:"jsgridcluster_conflictheader"}),r.JsGridConstants.RowHeaderStatePriorities.Conflict,e.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandConflictResolution)?SP.JsGrid.Res.conflictHeaderStateClickTooltip:SP.JsGrid.Res.conflictHeaderStateTooltip,e.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandConflictResolution)?function(t,n){e.delegateMgr.Apply(r.JsGridConstants.DelegateType.ExpandConflictResolution,t,n)}:null);this[r.JsGridConstants.RowHeaderAutoStyleId.Dirty]=new l(r.JsGridConstants.RowHeaderAutoStyleId.Dirty,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Edit"}}),r.JsGridConstants.RowHeaderStatePriorities.Dirty,SP.JsGrid.Res.editingHeaderStateTooltip,null)};t.RowHeaderStates=c;var h=function(e,t){this.autoRowStates=[[r.JsGridConstants.RowHeaderAutoStyleId.Dirty,function(e){t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellEditBegin,function(e){if(0==i){n=e.recordKey;t.jsGridObj.AddRowHeaderState(e.recordKey,s)}i++});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellEditCompleted,function(r){r.bCancelled&&i--;0==i&&r.bCancelled&&r.recordKey==n&&t.jsGridObj.RemoveRowHeaderState(n,e)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,function(r){i>0&&t.jsGridObj.RemoveRowHeaderState(n,e);i=0;n=r.recordKey});var n,i,s=t.rowHeaderStates[r.JsGridConstants.RowHeaderAutoStyleId.Dirty]}],[r.JsGridConstants.RowHeaderAutoStyleId.Error,function(e){var i=document.createElement("span");i.id=e+"mainDiv";i.style.cssText="display:none; font-size:10; position:absolute; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important;";i.style.cssText=i.style.cssText+"z-index: "+s.ZIndexes.ScrollablePane+";";document.body.appendChild(i);var f=null,c=null,h=e+"RowError",p=new l(e,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:n.JsGridUtil.Internal.IsFeatureEnabled(a)?u.errorIcon:o.spGridErrorIcon}}),r.JsGridConstants.RowHeaderStatePriorities.CellError,SP.JsGrid.Res.errorHeaderStateTooltip,function(e,n){c!==n&&(f=null);f=t.jsGridObj.ScrollToAndExpandNextErrorOnRecord(f,n);c=n}),d=new l(h,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:n.JsGridUtil.Internal.IsFeatureEnabled(a)?u.errorIcon:o.spGridErrorIcon}}),r.JsGridConstants.RowHeaderStatePriorities.RowError,SP.JsGrid.Res.rowErrorToolTip,function(e,r){if(i.curRecKey!==r){i.curRecKey=r;i.style.display="";n.JsGridUtil.Internal.DomElement.GetInstance().SetText(i,t.jsGridObj.GetRowErrorMessage(r));var s=(function(e){for(;null!=e&&"TD"!==e.tagName.toUpperCase();)e=e.parentNode;return e})(e.target);if(null!=s){var o=n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(s);i.style.left=o.x+"px";i.style.top=o.y+s.offsetHeight+2+"px"}else{n.JsGridUtil.DebugAssert(!1);i.style.left=e.clientX+5+"px";i.style.top=e.clientY+5+"px"}}else{i.curRecKey=null;i.style.display="none"}});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellErrorStateChanged,function(n){n.bAddingError&&!n.bCellHadError?t.jsGridObj.AddRowHeaderState(n.recordKey,p):n.bCellCurrentlyHasError||t.jsGridObj.RemoveRowHeaderState(n.recordKey,e)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowErrorStateChanged,function(e){e.bAddingError&&!e.bRowHadError?t.jsGridObj.AddRowHeaderState(e.recordKey,d):e.bErrorCurrentlyInRow||t.jsGridObj.RemoveRowHeaderState(e.recordKey,h)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,function(e){if(e.newRecordKey!==c){f=null;i.curRecKey=null;i.style.display="none"}});t.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnGridDisposing,function(){if(null!=i){i.curRecKey=null;i.innerHTML="";i=null}})}],[r.JsGridConstants.RowHeaderAutoStyleId.NewRow,function(e){var i=null,s=r.JsGridConstants.SUPERTEMPORARY_spcommonThemedData,o=new l(e,new n.JsGridUtil.ImageWithFabricIcons({imgSrc:s,bIsClustered:!0,optOuterCssNames:"clip16x16",optImgCssNames:"ms-addcolumn-icon"}),r.JsGridConstants.RowHeaderStatePriorities.NewRow,"",null);t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordAdded,function(n){null!=i&&t.jsGridObj.RemoveRowHeaderState(i,e);t.jsGridObj.AddRowHeaderState(n.recordKey,o);i=n.recordKey})}]];var i=n.JsGridUtil.Internal.ConvertTableToMap(this.autoRowStates,0,1);for(var f in i)e.Contains(f)&&(i[f]=new i[f](f));this.autoRowStates=null};t.AutoRowHeaderStates=h});
define("WGe",["require","exports","cGe","eGe","sGe","oGe","dGe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e,t){for(var n={},r=0;r<e;r++)t.IsChangeKeyApplied(e[r].changeKey)&&(n[e[r].fieldKey]=0);return n}var a=(function(){function e(e){this._entryRecordKeyPrefix="NewRowKey";this._entryRecordKeys=new i.Set;this._entryRecords=[];this._entryRecordUpdates={};this._entryRecordKeyIdxCache={};this._committedRecordKeys=new i.Set;this._bRegisteredEvent=!1;this._bCurrentlyCommitting=!1;this._curEntryRecordIdx=0;this._bReadyToCommit=!1;this._commitErrorId=null;this._bClearingUncommittedChanges=!1;this._commitAttemptCompleteNotifiers=[];this._objBag=e}e.prototype.GetNextEntryRecordKey=function(){return this._entryRecordKeyPrefix+this._curEntryRecordIdx++};e.prototype.CreateEntryRecord=function(e,t){var i=null==t?this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.CreateEntryRecord):t;null==i.recordKey&&(i.recordKey=this.GetNextEntryRecordKey());n.JsGridUtil.DebugAssert(i.key()==i.recordKey);i.properties[this._objBag.jsGridParams.tableViewParams.keyFieldName].dataValue=i.recordKey;this._entryRecords.push(i);this._entryRecordKeyIdxCache[i.key()]=this._entryRecords.length-1;this._entryRecordKeys.Add(i.key());i.bIsNewRow=!0;i.newRowNumber=this._curEntryRecordIdx;this._objBag.paneMgr.NotifyCreateEntryRow(this._entryRecords.length-1,e);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnEntryRecordAdded,n.JsGridUtil.EventArgs.OnEntryRecordAdded(i.key()));return i};e.prototype.IsEntryRecordDirty=function(e){var t=this._objBag.controller.GetEarliestChangeKeyForRecord(e);return null!=t&&this._objBag.controller.IsChangeKeyApplied(t)};e.prototype.RemoveEntryRow=function(e,t){this._objBag.editUtil.IsNewRowEnabled()&&!t&&this._objBag.paneMgr.NotifyRemoveEntryRow(e);var n=this._entryRecords[e].key();this._entryRecords.splice(e,1);this._entryRecordKeys.Remove(n);this._entryRecordKeyIdxCache[n]=null;for(e=n+1;null!=this._entryRecordKeyIdxCache[e];++e)this._entryRecordKeyIdxCache[e]=this._entryRecordKeyIdxCache[e]-1;delete this._entryRecordUpdates[n];this._objBag.controller.ClearAllPropChangesForRecord(n);return n};e.prototype.RemoveLastEntryRecord=function(){var e=null;this._entryRecords.length>1&&(e=this.RemoveEntryRow(this._entryRecords.length-1));return e};e.prototype.ClearUncommittedEntryRecordsInternal=function(e,t){var n=this;this._bClearingUncommittedChanges=!0;this._objBag.paneMgr.StopEditing(!0);this._objBag.paneMgr.UnbindEditing(function(){if(null==t)for(;n._entryRecords.length>0;)n.RemoveEntryRow(0,e);else for(var r=0;r<n._entryRecords.length;r++)if(n._entryRecords[r].key()==t){n.RemoveEntryRow(r,e);break}n._bClearingUncommittedChanges=!1})};e.prototype.CreateEntryRecordWithChangeKey=function(e,t,r){var i=this,s=this.CreateEntryRecord(e,r);this._objBag.controller.AttachUndoActionToChangeKey(t,function(){var e=i.RemoveLastEntryRecord();n.JsGridUtil.DebugAssert(null==e||s.key()==e,"either the record we're removing should have been committed or it should be the record we added.")})};e.prototype.OnEntryRecordPropertyUpdated=function(e){this.GetLastEntryKey()==e.recordKey&&this.CreateEntryRecordWithChangeKey(!1,e.changeKey);if(e.validationState==r.JsGridConstants.ValidationState.Valid){null==this._entryRecordUpdates[e.recordKey]&&(this._entryRecordUpdates[e.recordKey]=[]);this._entryRecordUpdates[e.recordKey].push(e);e.recordKey==this._entryRecords[0].key()&&this.ForceReadyToCommit()}var t=this._objBag.paneMgr.GetFocusedItemInfo();null!=t&&t.recordKey==e.recordKey||this.TryCommitFirstEntryRecord()};e.prototype.ForceReadyToCommit=function(){this._bReadyToCommit=!0;if(null!=this._commitErrorId){var e=this._objBag.errorMgr.ClearRowError(this._entryRecords[0].key(),this._commitErrorId);n.JsGridUtil.DebugAssert(e);this._commitErrorId=null}};e.prototype.OnRowFocusChanged=function(e){this._entryRecords.length>0&&e.oldRecordKey==this._entryRecords[0].key()&&this.TryCommitFirstEntryRecord()};e.prototype.OnRecordFailedCommit=function(e,t){this._objBag.commandMgr.Unlock();this._bCurrentlyCommitting=!1;this._bReadyToCommit=!1;this._commitErrorId=null!=t?t:this._objBag.errorMgr.SetRowError(this._entryRecords[0].key(),e)};e.prototype.OnRecordSuceededCommit=function(e,t,n){this._objBag.commandMgr.Unlock();this._bCurrentlyCommitting=!1;return this.Commit(e,t,n)};e.prototype.Commit=function(e,t,i){var s=this._entryRecords[0],o=s.key(),a=u(this._entryRecordUpdates[o],this._objBag.jsGridObj);delete this._entryRecordUpdates[o];this._entryRecordKeys.Remove(o);this._committedRecordKeys.Add(o);if(null!=e&&e!==o){this._objBag.controller.ChangeKeys(o,e);s.recordKey=e;s.properties[this._objBag.jsGridParams.tableViewParams.keyFieldName].dataValue=s.recordKey}n.JsGridUtil.DebugAssert(null==s.key().startsWith||!s.key().startsWith(this._entryRecordKeyPrefix));this._entryRecords.shift();this._entryRecordKeyIdxCache={};delete s.bIsNewRow;for(var f in i)f in a||s.AddFieldValue(f,{hasData:!0,data:i[f]});for(var f in t)f in a||s.AddFieldValue(f,{hasLocalized:!0,localized:t[f]});var l=this._objBag.controller.GetEarliestChangeKeyForRecord(s.key());n.JsGridUtil.DebugAssert(this._objBag.controller.IsChangeKeyApplied(l));0==this._entryRecords.length&&this.CreateEntryRecordWithChangeKey(!1,l);var c=this._objBag.paneMgr.GetLastRecordKey();this._objBag.controller.InsertRecordAfter(c,s,l,!1,!0,null,!1);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnEntryRecordCommitted,n.JsGridUtil.EventArgs.OnEntryRecordCommitted(o,s.key(),l));this._objBag.paneMgr.NotifyChangedRowByKey(s.key());this.TryCommitFirstEntryRecord();return l};e.prototype.TryCommitFirstEntryRecords=function(e,t){null!=e&&this._commitAttemptCompleteNotifiers.push(e);t&&this.ForceReadyToCommit();this.TryCommitFirstEntryRecord()};e.prototype.TryCommitFirstEntryRecord=function(){var e=this,t=!1;if(!this._bCurrentlyCommitting&&this._bReadyToCommit&&this._entryRecords.length>0&&this._entryRecords[0].key()in this._entryRecordUpdates&&!this._bClearingUncommittedChanges&&this.IsEntryRecordDirty(this._entryRecords[0].key())){t=this._bCurrentlyCommitting=!0;this._objBag.commandMgr.Lock();setTimeout(function(){e._objBag.pendingChangeMgr.WaitForPendingUpdates(n)},0)}t||this._bCurrentlyCommitting||this.TryNotifyCommitComplete();var n=function(){if(e._objBag.errorMgr.AnyErrorsInRow(e._entryRecords[0].key())){e._bCurrentlyCommitting=!1;e._bReadyToCommit=!1;e._objBag.commandMgr.Unlock();e.TryNotifyCommitComplete()}else e._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryInsertEntryRecord,e._entryRecords[0],e._entryRecordUpdates[e._entryRecords[0].key()],e.OnRecordSuceededCommit.bind(e),e.OnRecordFailedCommit.bind(e))}};e.prototype.TryNotifyCommitComplete=function(){if(this._commitAttemptCompleteNotifiers.length>0)for(var e=!this.AnyUncomittedEntryRecords();this._commitAttemptCompleteNotifiers.length>0;)this._commitAttemptCompleteNotifiers.shift()(e)};e.prototype.CreateEntryRows=function(e,t,n){for(var r=0;r<e;r++)this.CreateEntryRecordWithChangeKey(!t,n)};e.prototype.AnyUncomittedEntryRecords=function(){return this._entryRecords.length>1||1==this._entryRecords.length&&this.IsEntryRecordDirty(this._entryRecords[0].key())};e.prototype.ClearUncommittedEntryRecords=function(){this.ClearUncommittedEntryRecordsInternal(!1,null)};e.prototype.ClearEntryRecord=function(e){this.ClearUncommittedEntryRecordsInternal(!1,e)};e.prototype.EnsureLastEntryRowExists=function(){if(this._objBag.editUtil.IsNewRowEnabled()&&0==this._entryRecords.length){this.CreateEntryRecord(!1);if(!this._bRegisteredEvent){this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.OnEntryRecordPropertyUpdated.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._bRegisteredEvent=!0}}};e.prototype.AddColumn=function(e,t){if(this._entryRecords.length>0){var n={isProp:!0,prop:s.PropertyType.Property.prototype.MakeProperty(void 0,void 0,t.hasDataValue,t.hasLocalizedValue,t.GetPropType())};this._entryRecords[0].AddFieldValue(e,n)}};e.prototype.NotifyTableViewChangeCompleted=function(){this._bReadyToCommit=!1;this.EnsureLastEntryRowExists()};e.prototype.NotifyTableViewCleared=function(){if(this._entryRecords.length>0){this.ClearUncommittedEntryRecordsInternal(!0,null);if(this._bRegisteredEvent){this._objBag.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.OnEntryRecordPropertyUpdated.bind(this));this._objBag.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._bRegisteredEvent=!1}}};e.prototype.GetEntryRecords=function(){return this._entryRecords};e.prototype.IsEntryRecordKey=function(e){return this._entryRecordKeys.Contains(e)};e.prototype.GetLastEntryKey=function(){n.JsGridUtil.DebugAssert(this._entryRecords.length>0);return null!=this._objBag?this._entryRecords[this._entryRecords.length-1].key():null};e.prototype.GetEntryRecordIdx=function(e){if(null!=this._entryRecordKeyIdxCache[e])return this._entryRecordKeyIdxCache[e];var t=n.JsGridUtil.Internal.FindInArray(this._entryRecords,function(t){return e==t.key()});n.JsGridUtil.DebugAssert(null!=t);this._entryRecordKeyIdxCache[e]=t;return t};e.prototype.GetEntryRecord=function(e){return this._entryRecords[this.GetEntryRecordIdx(e)]};return e})();t.EntryRecordManager=a;var f=(function(){function e(e){this._provisionalRecordKeyPrefix="NewInsertedKey";this._currentKey=null;this._bPastingCells=!1;this._provisionalRecords={};this._provisionalRecordUpdates={};this._curProvisionalRecordIdx=0;this._bRegisteredEvents=!1;this._objBag=e}e.prototype.GetNextProvisionalRecordKey=function(){return this._provisionalRecordKeyPrefix+this._curProvisionalRecordIdx++};e.prototype.EnsureEventHandlers=function(){if(!this._bRegisteredEvents){this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnProvisionalRecordPropertyUpdated.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPasteBegin,this.OnPasteBegin.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPasteEnd,this.OnPasteEnd.bind(this));this._bRegisteredEvents=!0}};e.prototype.AnyUncomittedProvisionalRecords=function(){return!n.JsGridUtil.Internal.IsAssocArrayEmpty(this._provisionalRecords)};e.prototype.IsProvisionalRecordKey=function(e){return e in this._provisionalRecords};e.prototype.InsertProvisionalRecordBefore=function(e,t,n){return this.InsertionProvisionalRecord(e,t,this._objBag.jsGridObj.InsertRecordBefore,n)};e.prototype.InsertProvisionalRecordAfter=function(e,t,n){return this.InsertionProvisionalRecord(e,t,this._objBag.jsGridObj.InsertRecordAfter,n)};e.prototype.InsertionProvisionalRecord=function(e,t,i,s){var u=this;this.EnsureEventHandlers();t.recordKey=this.GetNextProvisionalRecordKey();this._provisionalRecords[t.key()]=t;var a=i(e,t,null,!0);(function(e,t,i){u._provisionalRecordUpdates[e]=[];if(null!=t)for(var s=0;s<t.length;s++)u._provisionalRecordUpdates[e].push(n.JsGridUtil.EventArgs.PropertyChanged(e,t[s].fieldKey,null,new o.PropertyUpdate(t[s].propertyValue.hasDataValue?t[s].propertyValue.dataValue:n.JsGridUtil.EmptyValue,t[s].propertyValue.hasLocalizedValue?t[s].propertyValue.localizedValue:n.JsGridUtil.EmptyValue),null,i,r.JsGridConstants.ValidationState.Pending))})(t.key(),s,a);this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryCreateProvisionalRecord,t,this._provisionalRecordUpdates[t.key()],function(e){u.OnSuccess.apply(u,[t.key()].concat(e))},this.OnFailed);return a};e.prototype.OnProvisionalRecordPropertyUpdated=function(e){var t=e.recordKey;if(null!=this._provisionalRecords[t]){null==this._provisionalRecordUpdates[t]&&(this._provisionalRecordUpdates[t]=[]);this._provisionalRecordUpdates[t].push(e);if(this._bPastingCells){var n=this._currentKey;this._currentKey=t;n!==t&&this.TryCommitProvisionalRecordUpdatesForKey(n)}else this.TryCommitProvisionalRecordUpdatesForKey(t)}};e.prototype.OnPasteBegin=function(){this._bPastingCells=!0;this._currentKey=null};e.prototype.OnPasteEnd=function(){this._bPastingCells=!1;this.TryCommitProvisionalRecordUpdatesForKey(this._currentKey)};e.prototype.TryCommitProvisionalRecordUpdatesForKey=function(e){var t=this;this._provisionalRecords[e]&&this._provisionalRecordUpdates[e]&&this._provisionalRecordUpdates[e].length>0&&this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryCreateProvisionalRecord,this._provisionalRecords[e],this._provisionalRecordUpdates[e],function(n){t.OnSuccess.apply(t,[e].concat(n))},this.OnFailed)};e.prototype.OnSuccess=function(e,t,n,r){var i=this._provisionalRecords[e],s=u(this._provisionalRecordUpdates[e],this._objBag.jsGridObj);delete this._provisionalRecords[e];delete this._provisionalRecordUpdates[e];if(null!=t&&t!==e){this._objBag.jsGridObj.ChangeKeys(e,t);i.recordKey=t;i.properties.ID.dataValue=i.recordKey}for(var o in n)o in s||i.AddFieldValue(o,{hasLocalized:!0,localized:n[o]});for(var o in r)o in s||i.AddFieldValue(o,{hasData:!0,data:r[o]});this._objBag.paneMgr.NotifyChangedRowByKey(i.key())};e.prototype.OnFailed=function(){};return e})();t.ProvisionalRecordManager=f});
define("VGe",["require","exports","IGe","dGe","cGe","eGe","oGe","zGe","DGe","pze","sGe","me"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(){function e(e,t){var s=this;this.processingNewRow=!1;this.actionsAssociatedWithUndo={};this._objBag=e;this._fnGetLocStr=t;this.versionMgr=e.versionMgr=new n.VersionManager(e,this.DoPhysicalPropChange.bind(this),this.DoPhysicalRowInsert.bind(this),this.DoPhysicalRowDelete.bind(this),function(){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},this.GetRecord.bind(this));this.checkSelMgr=new v(e);this.pendingChangeMgr=e.pendingChangeMgr=new r.PendingChangesManager(e);this.propUpdateMgr=new r.PropertyUpdateManager(e);e.tableCache.fnApplyUpdatesToNewRecord=function(e){s.versionMgr.ApplyChangesToRecord(e)};this.editUtil=e.editUtil=new p(this);this.eventSinks={OnPropertiesChanged:function(e,t,n,r){s.UpdateProperties(e,t,n,r)},OnNodeExpanded:function(e){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},OnNodeCollapsed:function(e){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},OnFocusedCellChanged:function(e){s.OnCellFocusedChanged(e)}}}e.prototype.GetCurrentDataValue=function(e,t){var n=this.versionMgr.GetCurrentValue(e,t);if(n==i.JsGridUtil.EmptyValue){var r=this._objBag.tableCache.GetCachedRecord(e);n=null!=r?r.GetDataValue(t):null}else n=n.GetData();return n};e.prototype.GetEarliestChangeKeyForRecord=function(e){return this.versionMgr.GetEarliestPropChangeKeyForRecord(e)};e.prototype.GetCurrentLocalizedValue=function(e,t){var n=this.versionMgr.GetCurrentValue(e,t);if(n==i.JsGridUtil.EmptyValue){var r=this._objBag.tableCache.GetCachedRecord(e);n=null!=r?r.GetLocalizedValue(t):null}else n=n.GetLocalized();return n};e.prototype.GetPropType=function(e,t){var n=this._objBag.tableCache.GetCachedRecord(e),r=null;null!=n&&null!=n.GetProp(t)?r=n.GetProp(t).propType:this._objBag.entryRecordMgr.IsEntryRecordKey(e)&&null!=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t]?r=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t].GetPropType():t==s.JsGridConstants.RecordIndicatorCheckboxColumnKey&&(r=o.PropertyType.Internal.Property.GetInstance().GetPropType("RecordIndicatorCheckBoxBoolean"));null==r&&(r=o.PropertyType.Internal.Property.GetInstance().GetPropType("String"));return r};e.prototype.ClearAllPropChangesForRecord=function(e){this.versionMgr.ClearAllPropChangesForRecord(e)};e.prototype.NotifyDataAvailable=function(){this._objBag.paneMgr.RefreshAllRows(0)};e.prototype.ClearChanges=function(){this._objBag.commandMgr.ClearUndoStack();null!=this.versionMgr&&this.versionMgr.Clear()};e.prototype.GetViewEventSinks=function(){return this.eventSinks};e.prototype.ClearTableView=function(){this._objBag.entryRecordMgr.NotifyTableViewCleared();this._objBag.paneMgr.ClearView()};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.versionMgr.TryReadPropForChangeKey(e,t,n)};e.prototype.SetTableView=function(e,t,n,r,i,s,o,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){this.posConverter=a;this.operationalUtil=f;this.columns=t;this.defaultEditMode=r;this.gridFieldMap=n;this.bNewRowEnabled=i;this.bEditingEnabled=s;this.SetRowViewInternal(e,!1);this.checkSelMgr.SetTableView(S,x,T);null!=this._objBag.columnMenuMgr&&this._objBag.columnMenuMgr.Dispose();this._objBag.columnMenuMgr=new u.default(this._objBag,e.autoFilterState,e.autoFilterEntries,this.gridFieldMap,this._fnGetLocStr,e.sortState);this._objBag.paneMgr.SetView(this.posConverter,this.columns,this.gridFieldMap,e.topViewIdx,this.operationalUtil,o,l,c,h,p,d,v,m,g,y,b,w,E,e.sortState);this.UpdateFilterAndSortState(e.sortState,e.filterState,e.autoFilterState)};e.prototype.SetRowView=function(e){this.SetRowViewInternal(e,!0);this._objBag.columnMenuMgr.SetAutoFilterState(e.autoFilterState);this._objBag.columnMenuMgr.SeedAutoFilterEntryCache(e.autoFilterEntries)};e.prototype.ChangeKeys=function(e,t){this._objBag.paneMgr.ChangeKeys(e,t);this.versionMgr.ChangeKeysOnPropUpdates(e,t);i.JsGridUtil.AsynchronousCellUpdater.GetInstance().ChangeRecordKeys(e,t);this._objBag.rowHeaderStateMgr.ChangeKeys(e,t);this._objBag.errorMgr.ChangeKeys(e,t);this._objBag.entryRecordMgr.IsEntryRecordKey(e)||this._objBag.tableCache.ChangeKeys(e,t)};e.prototype.UpdateFilterAndSortState=function(e,t,n){this._objBag.paneMgr.SetSortState(e);var r=new l.Set(n);null!=t&&(r=r.Union(t));this._objBag.paneMgr.SetFilterState(r.ToArray())};e.prototype.SetRowViewInternal=function(e,t){this._objBag.tableCache.SetView(e.view,e.minimalInfo&&e.minimalInfo.recordCount);if(t){this._objBag.paneMgr.NotifyNewRowStateChanged(!0);this._objBag.paneMgr.RefreshAllRows(e.topViewIdx);this.UpdateFilterAndSortState(e.sortState,e.filterState,e.autoFilterState)}};e.prototype.UpdateProperties=function(e,t,n,r){i.JsGridUtil.DebugAssert(e.length>0);var s;if(null==n){this._objBag.commandMgr.OpenGroup();n=(s=this.CreateDataUpdateCmd(null)).GetChangeKey()}null!=r&&r(n);this.propUpdateMgr.ApplyPropUpdates(e,n);if(null!=s){this._objBag.commandMgr.Execute(s,t,a.CommandManagerConstants.CommandType.Explicit);this._objBag.commandMgr.CloseGroup(t,a.CommandManagerConstants.CommandType.Explicit,!0)}return n};e.prototype.InsertHiddenRecord=function(e,t,n){if(null!=n&&this._objBag.entryRecordMgr.IsEntryRecordKey(n)){alert(this._fnGetLocStr("NoInsertAfterEntryRow"));return null}return this.InsertRecordAfterCore(this.GenerateRowUpdateForInsert(e,!1,n,!1,!1,null,null),t)};e.prototype.InsertRecordAfter=function(e,t,n,r,i,s,o){if(this._objBag.entryRecordMgr.IsEntryRecordKey(e)){alert(this._fnGetLocStr("NoInsertAfterEntryRow"));return null}this._objBag.tableCache.SeedInsertedRecord(t);return this.InsertRecordAfterCore(this.GenerateRowUpdateForInsert(t.key(),!0,e,r,i,s,o),n)};e.prototype.InsertRecordAfterCore=function(e,t){var n;null==t&&(t=(n=this.CreateDataUpdateCmd(null)).GetChangeKey());this.versionMgr.AddRowInsertChange(e,t);null!=n&&this._objBag.commandMgr.Execute(n,s.JsGridConstants.UserAction.InsertRecord,a.CommandManagerConstants.CommandType.Explicit);return t};e.prototype.InsertRecordBefore=function(e,t,n,r){var s,o;if(null==e)s=this.posConverter.RecordIdxToRecordKey(this._objBag.tableCache.GetRecordCount()-1);else{var u=this.posConverter.RecordKeyToRecordIdx(e);s=o=0==u?null:this.posConverter.RecordIdxToRecordKey(u-1);i.JsGridUtil.DebugAssert(null!=s,"Cannot determine afterRecordKey from beforeRecordKey")}return this.InsertRecordAfter(s,t,n,r,!1,o,s!==o)};e.prototype.DeleteRecords=function(e,t){var n,r=this;if(null!=i.JsGridUtil.Internal.FindInArray(e,function(e){return r._objBag.entryRecordMgr.IsEntryRecordKey(e)})){alert(this._fnGetLocStr("OpNotSupportedOnEntryRow"));return null}null==t&&(t=(n=this.CreateDataUpdateCmd(null)).GetChangeKey());for(var o=0;o<e.length;o++)this.versionMgr.AddRowDeleteChange(this.GenerateRowUpdateForDelete(e[o]),t);null!=n&&this._objBag.commandMgr.Execute(n,s.JsGridConstants.UserAction.DeleteRecord,a.CommandManagerConstants.CommandType.Explicit);return t};e.prototype.EnableEditing=function(){if(!this.bEditingEnabled){this.bEditingEnabled=!0;this._objBag.entryRecordMgr.EnsureLastEntryRowExists();this._objBag.paneMgr.NotifyNewRowStateChanged();this._objBag.paneMgr.NotifyCanEditUpdated();this._objBag.ariaMgr.EnableGridEditing(!0)}};e.prototype.DisableEditing=function(){var e=this;if(this.bEditingEnabled){this._objBag.paneMgr.StopEditing(!0);this._objBag.paneMgr.UnbindEditing(function(){e._objBag.entryRecordMgr.ClearUncommittedEntryRecords();e._objBag.paneMgr.NotifyNewRowStateChanged();e._objBag.paneMgr.NotifyCanEditUpdated();e._objBag.ariaMgr.EnableGridEditing(!1);e.bEditingEnabled=!1})}};e.prototype.TryBeginEdit=function(){var e=this._objBag.selectionMgr.GetFocusedPane();return null!=e&&e.TryBeginEdit({type:"gridapi"})};e.prototype.FinalizeEditing=function(e,t){var n=this;i.JsGridUtil.DebugAssert(null!=e&&null!=t);if(this.bEditingEnabled){this._objBag.paneMgr.StopEditing(!1);this.pendingChangeMgr.WaitForPendingUpdates(function(){n._objBag.errorMgr.AnyErrors()?t():n._objBag.entryRecordMgr.TryCommitFirstEntryRecords(function(){n._objBag.entryRecordMgr.AnyUncomittedEntryRecords()?t():n.pendingChangeMgr.WaitForAllChangeKeysToComplete(e)},!1)})}else e()};e.prototype.NotifyHide=function(){this.FinalizeEditing(function(){},function(){})};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){return this.versionMgr.MarkPropUpdateInvalid(e,t,n,r)};e.prototype.GetCurrentChangeKey=function(){return this.versionMgr.GetCurrentChangeKey()};e.prototype.IsChangeKeyApplied=function(e){return this.versionMgr.IsChangeKeyApplied(e)};e.prototype.GetChangeKeyForVersion=function(e){return this.versionMgr.GetChangeKeyForVersion(e)};e.prototype.GetCheckSelectionManager=function(){return null!=this.checkSelMgr?this.checkSelMgr.ExternalAPI:null};e.prototype.OnCellFocusedChanged=function(e){var t=e.oldRecordKey;e.newRecordKey!==t&&this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRowFocusChanged,i.JsGridUtil.EventArgs.RowFocusChanged(e.newRecordKey,e.oldRecordKey));this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnCellFocusChanged,e)};e.prototype.AttachUndoActionToChangeKey=function(e,t){var n=e.GetVersionNumber();null==this.actionsAssociatedWithUndo[n]&&(this.actionsAssociatedWithUndo[n]=[]);this.actionsAssociatedWithUndo[n].push(t)};e.prototype.CreateDataUpdateCmd=function(e){var t=this,n=!1,r=this.versionMgr.GetNextVersionKey();this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyCreated,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r));r.Reserve();return{Apply:function(){n&&t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginRedoDataUpdateChange,i.JsGridUtil.EventArgs.OnBeginRedoDataUpdateChange(r));t._objBag.paneMgr.ClearAllChangeIndications();t.versionMgr.ApplyChangeKey(r);n||e||t._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r));n=!0},Undo:function(){t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginUndoDataUpdateChange,i.JsGridUtil.EventArgs.OnBeginUndoDataUpdateChange(r));t._objBag.paneMgr.ClearAllChangeIndications();t.versionMgr.UndoChangeKey(r);var e=t.actionsAssociatedWithUndo[r.GetVersionNumber()];if(null!=e)for(var n=e.length-1;n>=0;n--)e[n]();t.actionsAssociatedWithUndo[r.GetVersionNumber()]=null},Dispose:function(e){e==a.CommandManagerConstants.DisposeState.Unapplied&&t.versionMgr.VacateChange(r);r.Release()},GetChangeKey:function(){return r},NotifyInitialUpdateComplete:function(){i.JsGridUtil.DebugAssert(e);t._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r))}}};e.prototype.DoPhysicalPropChange=function(e,t,n,o,u,a,f,l,h){this._objBag.cutcopypasteMgr.CancelMode();var p=null,d=null!=f?f:this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.entryRecordMgr.GetEntryRecord(e):this._objBag.tableCache.GetCachedRecord(e);null==n&&(n=new r.PropertyUpdate(null,""));var v=new r.PropertyUpdate(i.JsGridUtil.EmptyValue,i.JsGridUtil.EmptyValue);if(null!=d){var m=!0;if(null!=(p=d.GetProp(t))){v.localized=p.HasLocalizedValue()?p.GetLocalized():i.JsGridUtil.EmptyValue;v.data=p.HasDataValue()?p.GetData():i.JsGridUtil.EmptyValue;v.data!==n.data||v.localized!==n.localized?(v.localized!==n.localized||"SPUser"!==p.propType.ID&&"SPUser_MultiValue"!==p.propType.ID)&&p.Update(n.data,n.localized):m=!1}if(m){a||this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeforePropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u));this._objBag.paneMgr.NotifyUpdateProperty(e,t,!0,n,u,o)}}this._objBag.errorMgr.ClearAllErrorsOnCell(e,t);if(u==s.JsGridConstants.ValidationState.Invalid){var g=null!=l?l:n.localized!==i.JsGridUtil.EmptyValue?c.format(this._fnGetLocStr("LocalizedConversionError"),n.localized):this._fnGetLocStr("GeneralConversionError");this._objBag.errorMgr.SetCellError(e,t,g)}if(!a){i.JsGridUtil.DebugAssert(null!=u);this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnEntryRecordPropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u)):this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnPropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u))}};e.prototype.GetInsertIdxForRowUpdate=function(e,t,n){var r=!1,i=null;if("visualAfterRecordKey"in e){r=!0;i=e.visualAfterRecordKey;for(;null!=i&&null!=t&&null!=t[i];)n(i=t[i].visualAfterRecordKey)&&(i=null)}return this.GetRecordIdxForInsert(e.afterRecordKey,i,r)};e.prototype.DoPhysicalRowInsert=function(e,t,n,r){var o=function(){};this._objBag.cutcopypasteMgr.CancelMode();if(n(e.recordKey))return null;var u=null;this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnBeforeRecordInserted,i.JsGridUtil.EventArgs.RecordInserted(e.recordKey,null,null,null));if(e.bIsInView){u=this.GetInsertIdxForRowUpdate(e,r,n);this._objBag.tableCache.InsertRecord(u,e.recordKey);e.bDoNotUpdatePaneOnFirstInsert?delete e.bDoNotUpdatePaneOnFirstInsert:this._objBag.paneMgr.NotifyInsertRows(this.posConverter.RecordIdxToViewIdx(u),1,e.bUpdateFocusPos,o)}this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordInserted,i.JsGridUtil.EventArgs.RecordInserted(e.recordKey,u,e.afterRecordKey,t));return e};e.prototype.DoPhysicalRowDelete=function(e,t,n){this._objBag.cutcopypasteMgr.CancelMode();var r=[],o=[e.recordKey];if(n(e.recordKey))return null;for(var u=0;u<o.length;u++){var a=o[u],f=a==e.recordKey?e:this.GenerateRowUpdateForDelete(a),l=null;this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnBeforeRecordDeleted,i.JsGridUtil.Internal.EventArgs.RecordDeleted(a));if(f.bIsInView){l=this.posConverter.RecordKeyToRecordIdx(a);var c=this.posConverter.RecordIdxToViewIdx(l);this._objBag.tableCache.IsKeyInView(a)&&this._objBag.tableCache.DeleteRecord(l);null!=c&&this._objBag.paneMgr.NotifyDeleteRows(c,1);0}this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordDeleted,i.JsGridUtil.EventArgs.RecordDeleted(a,l,t));r.push(f)}return r};e.prototype.GenerateRowUpdateForDelete=function(e){var t=this._objBag.tableCache.IsKeyInView(e),n=t?this.posConverter.RecordKeyToRecordIdx(e):null,r=null;t&&(r=0==n?null:this.posConverter.RecordIdxToRecordKey(n-1));return new d(e,r,0,t,!0,!1,void 0,void 0)};e.prototype.GenerateRowUpdateForInsert=function(e,t,n,r,i,s,o){return new d(e,n,0,t,r,i,s,o)};e.prototype.GetRecord=function(e){return this._objBag.tableCache.GetCachedRecord(e)};e.prototype.GetRecordIdxForInsert=function(e,t,n){var r=n?t:e,i=null==r?null:this.posConverter.RecordKeyToRecordIdx(r);n&&null!=r&&null==i&&(i=null==e?null:this.posConverter.RecordKeyToRecordIdx(e));return null==i?0:i+1};return e})();t.MVCController=h;var p=(function(){function e(e){this._controller=e}e.prototype.ValidateAndExpandKeyList=function(e){return!1};e.prototype.IsEditingEnabled=function(){return this._controller.bEditingEnabled};e.prototype.IsNewRowEnabled=function(){return this._controller.bNewRowEnabled&&this._controller.bEditingEnabled};e.prototype.GetFieldValueForCopy=function(e,t){i.JsGridUtil.lastCopiedValueType_SPUser=!1;var n,r=e.HasLocalizedValue(t)?e.GetLocalizedValue(t):null;if(t!==s.JsGridConstants.RecordIndicatorCheckboxColumnKey){var u=e.GetProp(t);n=u&&u.propType}else n=o.PropertyType.Internal.Property.GetInstance().GetPropType("RecordIndicatorCheckBoxBoolean");if(null!=n&&(null!=n.GetDisplayValue||null!=n.GetCopyValue)){var a=e.HasDataValue(t)?e.GetDataValue(t):null;null!=n.GetDisplayValue?r=n.GetDisplayValue(e,a,r):null!=n.GetCopyValue&&(r=n.GetCopyValue(e,a,r))}return null!=r?r:""};e.prototype.CanBindToField=function(e,t,n){return this.CanEditField(e,t,n)&&!(null!=n&&n==s.JsGridConstants.RecordIndicatorCheckboxColumnKey)};e.prototype.CanEditField=function(e,t,n){if(!this._controller.bEditingEnabled||null==e)return!1;if(!e.bIsNewRow&&null!=this._controller.operationalUtil.GetValue(e,s.JsGridConstants.OperationalConstants.GroupingOutlineLevel))return!1;if(null!=n&&n==s.JsGridConstants.RecordIndicatorCheckboxColumnKey)return!0;var r=null!=t&&null!=t.fnGetCellEditMode?t.fnGetCellEditMode(e,n):null;r=null==r?s.JsGridConstants.EditMode.Defer:r;var i=e.bIsNewRow?s.JsGridConstants.EditMode.ReadWriteDefer:this._controller._objBag.delegateMgr.DelegatePresent(s.JsGridConstants.DelegateType.GetRecordEditMode)?this._controller._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.GetRecordEditMode,e):null;i=null==(i=null==i?this._controller.operationalUtil.GetValue(e,s.JsGridConstants.OperationalConstants.RecordEditMode):i)?s.JsGridConstants.EditMode.Defer:i;var o=null;null!=n&&(o=null==(o=this._controller._objBag.delegateMgr.DelegatePresent(s.JsGridConstants.DelegateType.GetFieldEditMode)?this._controller._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.GetFieldEditMode,n):o)?this._controller.gridFieldMap[n].GetEditMode():o);null==o&&(o=s.JsGridConstants.EditMode.Defer);var u=Math.min(Math.min(Math.min(i,o),r),this._controller.defaultEditMode);return u==s.JsGridConstants.EditMode.ReadWrite||u==s.JsGridConstants.EditMode.ReadWriteDefer||u==s.JsGridConstants.EditMode.Defer};return e})(),d=function(e,t,n,r,i,s,o,u){this.recordKey=e;this.afterRecordKey=t;this.newOutlineLevel=n;r&&(this.bIsInView=r);i&&(this.bUpdateFocusPos=i);s&&(this.bDoNotUpdatePaneOnFirstInsert=s);u&&(this.visualAfterRecordKey=o)},v=(function(){function e(e){var t=this;this._checkedRecordKeys=new l.Set;this._checkboxDisabledRecordKeys=new l.Set;this._checkboxHiddenRecordKeys=new l.Set;this.ExternalAPI={CheckAllRecords:function(){for(var e=t._objBag.tableCache.GetView(),n=new l.Set,r=0;r<e.length;r++){var i=e[r];t._checkedRecordKeys.Contains(i)||t.IsRecordIndicatorCheckboxHidden(i)||t.IsRecordIndicatorCheckboxDisabled(i)||n.Add(i)}t.ChangeMultipleCheckboxStates(n,!0)},ClearCheckedRecords:function(){var e=t._checkedRecordKeys.Clone();t.ChangeMultipleCheckboxStates(e,!1)},EnableRecordCheckbox:function(e){if(t._checkboxDisabledRecordKeys.Contains(e)){t._checkboxDisabledRecordKeys.Remove(e);t.RefreshRecordIndicatorCell(e)}},DisableRecordCheckbox:function(e){if(!t._checkboxDisabledRecordKeys.Contains(e)){t._checkboxDisabledRecordKeys.Add(e);t.RefreshRecordIndicatorCell(e)}},ShowRecordCheckbox:function(e){if(t._checkboxHiddenRecordKeys.Contains(e)){t._checkboxHiddenRecordKeys.Remove(e);t.RefreshRecordIndicatorCell(e)}},HideRecordCheckbox:function(e){if(!t._checkboxHiddenRecordKeys.Contains(e)){t._checkboxHiddenRecordKeys.Add(e);t.RefreshRecordIndicatorCell(e)}},CheckRecord:this.CheckRecord,UncheckRecord:this.UncheckRecord,AnyRecordsChecked:function(){return!t._checkedRecordKeys.IsEmpty()},GetCheckedRecordKeys:function(){return t._checkedRecordKeys.GetCollection()},GetCheckedRecordCount:function(){return t._checkedRecordCount},GetHiddenCheckboxRecordKeys:function(){return t._checkboxHiddenRecordKeys.GetCollection()},GetDisabledCheckboxRecordKeys:function(){return t._checkboxDisabledRecordKeys.GetCollection()}};this._objBag=e;e.checkSelMgr=this;this.Init()}e.prototype.Init=function(){this._checkedRecordCount=0;var e=this._objBag.gridControls[s.JsGridConstants.RecordIndicatorControlId]=new f.DisplayControl.RecordIndicatorCheckboxControl(this._objBag.gridId,this.OnCheckboxClicked,this.IsRecordIndicatorCheckboxHidden,this.IsRecordIndicatorCheckboxDisabled,this.IsRecordIndicatorCheckboxChecked);o.PropertyType.Utils.RegisterDisplayControl(e.Id,e,[])};e.prototype.IsRecordIndicatorCheckboxHidden=function(e){return!!this._checkboxHiddenRecordKeys.Contains(e)};e.prototype.IsRecordIndicatorCheckboxDisabled=function(e){return this._checkboxDisabledRecordKeys.Contains(e)};e.prototype.CheckRecord=function(e){this._checkedRecordKeys.Contains(e)||this.ChangeSingleCheckboxState(e)};e.prototype.UncheckRecord=function(e){this._checkedRecordKeys.Contains(e)&&this.ChangeSingleCheckboxState(e)};e.prototype.ChangeMultipleCheckboxStates=function(e,t){var n=this,r=function(t){if(t){for(var r in e.GetCollection())if(!n._checkedRecordKeys.Contains(r)){n._checkedRecordKeys.Add(r);++n._checkedRecordCount}}else for(var r in e.GetCollection())if(n._checkedRecordKeys.Contains(r)){n._checkedRecordKeys.Remove(r);--n._checkedRecordCount}n.RefreshRecordIndicatorCell(null);n._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordChecked,i.JsGridUtil.EventArgs.RecordChecked(e,t))};this._objBag.commandMgr.Execute({Apply:function(){r(t)},Undo:function(){r(!t)}},"ChangeIndicatorCheckBox",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.ChangeSingleCheckboxState=function(e){var t=this,n=function(){if(!t.IsRecordIndicatorCheckboxHidden(e)&&!t.IsRecordIndicatorCheckboxDisabled(e)){var n=!t.IsRecordIndicatorCheckboxChecked(e);if(n){t._checkedRecordKeys.Add(e);++t._checkedRecordCount}else{t._checkedRecordKeys.Remove(e);--t._checkedRecordCount}t.RefreshRecordIndicatorCell(e);t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordChecked,i.JsGridUtil.EventArgs.RecordChecked((new l.Set).AddArray([e]),n))}};this._objBag.commandMgr.Execute({Apply:n,Undo:n,Dispose:function(){n=null}},"ChangeIndicatorCheckBox",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.OnCheckboxClicked=function(e){this.ChangeSingleCheckboxState(e);if(this.IsRecordIndicatorCheckboxChecked(e)){var t=this.GetRecordKeysWhereColumnIsSelected(s.JsGridConstants.RecordIndicatorCheckboxColumnKey);if(t.Contains(e)){for(var n in t)(this._checkedRecordKeys.Contains(n)||this.IsRecordIndicatorCheckboxHidden(n)||this.IsRecordIndicatorCheckboxDisabled(n))&&t.Remove(n);this.ChangeMultipleCheckboxStates(t,!0)}}};e.prototype.GetRecordKeysWhereColumnIsSelected=function(e){for(var t=this._objBag.jsGridObj.GetSelectedRowRanges(),n=this._objBag.jsGridObj.GetSelectedColumnRanges(),r=this._objBag.jsGridObj.GetSelectedCellRanges(),s=new l.Set,o=0;o<n.length;o++)if(null!=i.JsGridUtil.Internal.FindInArray(n[o].keys,function(t){return t==e})){s.AddArray(this._objBag.tableCache.GetView());break}if(s.IsEmpty()){for(o=0;o<t.length;o++)s.AddArray(t[o].keys);for(o=0;o<r.length;o++)null!=i.JsGridUtil.Internal.FindInArray(r[o].colRange.keys,function(t){return t==e})&&s.AddArray(r[o].rowRange.keys)}return s};e.prototype.RefreshRecordIndicatorCell=function(e){this._objBag.paneMgr.NotifyUpdateProperty(e,s.JsGridConstants.RecordIndicatorCheckboxColumnKey,!1,null)};e.prototype.IsRecordIndicatorCheckboxChecked=function(e){return this._checkedRecordKeys.Contains(e)};e.prototype.SetTableView=function(e,t,n){this._checkboxHiddenRecordKeys=new l.Set;this._checkboxHiddenRecordKeys.AddArray(e);this._checkboxDisabledRecordKeys=new l.Set;this._checkboxDisabledRecordKeys.AddArray(t);this._checkedRecordKeys=new l.Set;this._checkedRecordKeys.AddArray(n);this._checkedRecordCount=n.length};return e})()});
define("IGe",["require","exports","cGe","eGe","oGe","dGe","sGe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e){this.message=e||"Invalid Change Key Error";this.name="InvalidChangeKeyError"}t.InvalidChangeKeyError=u;u.prototype=new Error;u.prototype.constructor=u;var a=function(e){this.version=e;this.changes=[];this.recordKeys=[]},f=(function(){function e(){this.vChanges=[]}e.prototype.VacateChange=function(e){var t=this.GetVacatedChange(e);n.JsGridUtil.DebugAssert(null==t.item);this.vChanges.splice(t.idx,0,e)};e.prototype.AdvanceBaseline=function(e){var t=this.GetVacatedChange(e);this.vChanges.splice(0,t.idx+(null!=t.item?1:0))};e.prototype.ChangeIsVacated=function(e){return null!=this.GetVacatedChange(e).item};e.prototype.GetVacatedChange=function(e){var t=n.JsGridUtil.Internal.LowerBound(this.vChanges,e,null);return{idx:t,item:null!=this.vChanges[t]&&this.vChanges[t]==e?this.vChanges[t]:null}};return e})(),l=(function(){function e(e,t){this.version=e;this._versionManager=t}e.prototype.Reserve=function(){n.JsGridUtil.DebugAssert(this.version>=this._versionManager.baselineVersion);var e=n.JsGridUtil.Internal.LowerBound(this._versionManager.reservedChanges,this.version,"version");null==this._versionManager.reservedChanges[e]||this._versionManager.reservedChanges[e].version!==this.version?this._versionManager.reservedChanges.splice(e,0,{version:this.version,count:1}):this._versionManager.reservedChanges[e].count++};e.prototype.Release=function(){var e=n.JsGridUtil.Internal.LowerBound(this._versionManager.reservedChanges,this.version,"version");n.JsGridUtil.DebugAssert(this._versionManager.reservedChanges[e].version==this.version);if(1==this._versionManager.reservedChanges[e].count){this._versionManager.reservedChanges.splice(e,1);this._versionManager.UpdateBaselineVersion()}else this._versionManager.reservedChanges[e].count--};e.prototype.GetVersionNumber=function(){return this.version};e.prototype.CompareTo=function(e){return this.version-e.GetVersionNumber()};return e})();t.ChangeKey=l;var c=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.AddInsertChange=function(e,t){this.ApplyInsert(e,t,null,null,null)};e.prototype.AddDeleteChange=function(e,t){this.ApplyDelete(e,t,null,null)};e.prototype.ApplyAllRowInsertChanges=function(e){this.DoRowChangeOp(this.ApplyInsert.bind(this),this.rowInserts,e,!1,!1,!0)};e.prototype.ApplyAllRowDeleteChanges=function(e){this.DoRowChangeOp(this.ApplyDelete.bind(this),this.rowDeletes,e,!1,!1,!1)};e.prototype.UndoAllRowInsertChanges=function(e){this.DoRowChangeOp(this.ApplyDelete.bind(this),this.rowInserts,e,!0,!0,!1)};e.prototype.UndoAllRowDeleteChanges=function(e){this.DoRowChangeOp(this.ApplyInsert.bind(this),this.rowDeletes,e,!0,!0,!0)};e.prototype.VacateChange=function(e){var t=n.JsGridUtil.Internal.BinarySearch(this.rowInserts,e,"version");null!=t&&this.rowInserts.splice(t,1);null!=(t=n.JsGridUtil.Internal.BinarySearch(this.rowDeletes,e,"version"))&&this.rowDeletes.splice(t,1)};e.prototype.AdvanceBaseline=function(e){};e.prototype.GetChange=function(e,t,n){var i;null!=t&&(i=new o.Set).AddArray(t);var s=this.GetChanges(this.rowInserts,e,i,n?r.JsGridConstants.ChangeType.Delete:r.JsGridConstants.ChangeType.Insert),u=this.GetChanges(this.rowDeletes,e,i,n?r.JsGridConstants.ChangeType.Insert:r.JsGridConstants.ChangeType.Delete);return n?u.concat(s):s.concat(u)};e.prototype.Init=function(){this.rowInserts=[];this.rowDeletes=[]};e.prototype.GetChanges=function(e,t,r,i){var s=[],o=n.JsGridUtil.Internal.BinarySearch(e,t,"version");if(null!=o)for(var u=0;u<e[o].changes.length;u++){var a=e[o].changes[u];(null==r||r.Contains(a.recordKey))&&s.push({type:i,recordKey:a.recordKey,afterRecordKey:a.afterRecordKey,newOutlineLevel:a.newOutlineLevel})}return s};e.prototype.DoRowChangeOp=function(e,t,r,i,s,o){var u=function(e,t){var n;if(o){n=i?t[t.length-1]:t[0];for(;n.afterRecordKey in e;)n=e[n.afterRecordKey];delete e[n.recordKey];for(var r=0;r<t.length;r++)if(n==t[r]){t.splice(r,1);break}}else n=i?t.pop():t.shift();return n},f=n.JsGridUtil.Internal.BinarySearch(t,r.GetVersionNumber(),"version");if(null!=f){var l=t[f].changes;s||(t[f]=new a(t[f].version));for(var c={},h=[],p=0;p<l.length;p++){c[l[p].recordKey]=l[p];h.push(l[p])}for(;h.length>0;)e(u(c,h),r,!0,s,c)}};e.prototype.ApplyInsert=function(e,t,n,r,i){var s=this,o=t.GetVersionNumber();if(this._versionManager.curVersion>=o||n){var u=this._versionManager.fnDoPhysicalRowInsert(e,t,function(e){return 1==s.GetRecordStatus(e,n&&s._versionManager.curVersion<o?o:s._versionManager.curVersion)},i);null==u||r||this.AddChange(this.rowInserts,o,u)}else r||this.AddChange(this.rowInserts,o,e)};e.prototype.ApplyDelete=function(e,t,n,r){var i=this,s=t.GetVersionNumber();if(this._versionManager.curVersion>=s||n){var u=this._versionManager.fnDoPhysicalRowDelete(e,t,function(e){return-1==i.GetRecordStatus(e,n&&i._versionManager.curVersion<s?s:i._versionManager.curVersion)});if(null!=u){for(var a=new o.Set,f=0;f<u;f++)u[f].isbIsInView&&a.Add(u[f].recordKey);a.IsEmpty()||this.ForEachRowChange(function(t,n){if(t)for(var r in n.recordKeys)a.Contains(r)&&a.Remove(r);if(a.IsEmpty())return!1;for(var i=0;i<n.changes.length;i++)a.Contains(n.changes[i].afterRecordKey)&&(n.changes[i].afterRecordKey=e.afterRecordKey);return!0},s,!1,!0);if(!r)for(f=0;f<u.length;f++)this.AddChange(this.rowDeletes,s,u[f])}}else r||this.AddChange(this.rowDeletes,s,e)};e.prototype.GetRecordStatus=function(e,t){var n=0;this.ForEachRowChange(function(t,r){n=e in r.recordKeys?t?1:-1:n;return!0},t,!0,!1);return n};e.prototype.ForEachRowChange=function(e,t,n,r){for(var i=0;(i<this.rowDeletes.length&&(r||this.rowDeletes[i].version<=t)||i<this.rowInserts.length&&r&&this.rowInserts[i].version<=t)&&(!(i<this.rowInserts.length&&(n||this.rowInserts[i].version>t))||e(!0,this.rowInserts[i]))&&(!(i<this.rowDeletes.length&&(n||this.rowDeletes[i].version>t))||e(!1,this.rowDeletes[i]));i++);};e.prototype.AddChange=function(e,t,r){var i=n.JsGridUtil.Internal.LowerBound(e,t,"version");i!=e.length&&e[i].version===t||e.splice(i,0,new a(t));var s=e[i];s.changes.push(r);s.recordKeys[r.recordKey]=null};return e})(),h=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.GetChange=function(e,t,i){var s=[],o=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),u=function(t){if(o.hasOwnProperty(t)){var n=o[t];a.ApplyToItemsInRecord(n,e,function(e,t){if(null!=t.item){var o=i?t.prevItem:t.item;s.push({type:r.JsGridConstants.ChangeType.Prop,recordKey:n,fieldKey:e,propUpdate:o.value,validationState:null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState})}},!0)}},a=this;for(var f in o)u(f);return s};e.prototype.TryReadPropForVersion=function(e,t,n){if(e in this.propChanges&&t in this.propChanges[e]){var r=this.GetChangeFromList(this.propChanges[e][t],n),i=null==r.item?r.prevItem:r.item;return null!=i?i.value:null}return null};e.prototype.ChangeKeys=function(e,t){this.propChanges[t]=this.propChanges[e];delete this.propChanges[e]};e.prototype.GetEarliestChangeKeyForRecord=function(e){var t,n=this.propChanges[e];if(null!=n)for(var r in n)if(n.hasOwnProperty(r)){var i=n[r],s=i[0].version!==this._versionManager.baselineVersion?i[0].version:i[1].version;t=null==t||s<t?s:t}return t};e.prototype.ClearAllPropChangesForRecord=function(e){delete this.propChanges[e]};e.prototype.MarkPropUpdateInvalid=function(e,t,n,i){var s=!1,o=n.GetVersionNumber(),u=this.propChanges[e][t];if(null!=u){var a=this.GetChangeFromList(u,o);if(null!=a.item){if(a.item.validationState!==r.JsGridConstants.ValidationState.Invalid){a.item.validationState=r.JsGridConstants.ValidationState.Invalid;null!=i&&(a.item.optErrorMsg=i);this._versionManager.fnDoPhysicalPropChange(e,t,a.item.value,n,r.JsGridConstants.ValidationState.Invalid,!1,null,i,this.GetOldValue(u,a.idx,!1))}s=!0}}return s};e.prototype.AddPropChange=function(e,t,i,s,o,u){var a=i.GetVersionNumber(),f=null,l=null;if(a==this._versionManager.baselineVersion){if(null!=(c=null!=this.propChanges[e]&&null!=this.propChanges[e][t]?this.GetChangeFromList(this.propChanges[e][t],a):null)){n.JsGridUtil.DebugAssert(0==c.idx);n.JsGridUtil.DebugAssert(null!=c.item);f=c.item;l=c.idx}}else{null==this.propChanges[e]&&(this.propChanges[e]={});var c,h=this.propChanges[e][t];if(null==h){var p=this._versionManager.fnGetRecord(e),d=null;null!=p&&(d=this.GetPropUpdateFromRecord(p,t));h=this.propChanges[e][t]=[{version:this._versionManager.baselineVersion,value:d}]}l=(c=this.GetChangeFromList(h,a)).idx;if(null==c.item){this.MinimizePropUpdate(e,t,s);var v={version:a,value:s};o!==r.JsGridConstants.ValidationState.Valid&&(v.validationState=o);null!=u&&(v.optErrorMsg=u);h.splice(l,0,v)}else f=c.item}if(null!=f){f.value=s;o!==f.validationState&&(null==o||o==r.JsGridConstants.ValidationState.Valid?delete f.validationState:f.validationState=o)}var m=null==l?null:this.propChanges[e][t];this._versionManager.curVersion>=a&&(null==l||l==m.length-1||m[l+1].version>this._versionManager.curVersion)&&this._versionManager.fnDoPhysicalPropChange(e,t,s,i,o,!1,null,u,this.GetOldValue(m,l,!1))};e.prototype.ApplyChangesToRecord=function(e){var t=this;e.key()in this.propChanges&&this.ApplyToItemsInRecord(e.key(),this._versionManager.curVersion,function(i,s){var o=t.propChanges[e.key()][i],u=null==s.item?s.prevItem:s.item;if(null!=u&&null!=e.GetProp(i)){var a=n.JsGridUtil.Internal.LowerBound(t._versionManager.changeMap,s.version,"version");t._versionManager.fnDoPhysicalPropChange(e.key(),i,u.value,t._versionManager.changeMap[a].key,null==u.validationState?r.JsGridConstants.ValidationState.Valid:u.validationState,!0,e,u.optErrorMsg,t.GetOldValue(o,a,!1))}},!0)};e.prototype.VacateChange=function(e){var t=this,r=function(r){i.propChanges.hasOwnProperty(r)&&i.ApplyToItemsInRecord(r,e,function(i,s){var o=t.propChanges[r][i];n.JsGridUtil.DebugAssert(o.length>1);if(2==o.length){n.JsGridUtil.DebugAssert(o[0].version==t._versionManager.baselineVersion);n.JsGridUtil.DebugAssert(o[1].version==e);t.DeleteEntry(r,i)}else o.splice(s.idx,1)},null)},i=this;for(var s in this.propChanges)r(s)};e.prototype.SynchronizeToChange=function(e,t){var i=this,s=e.GetVersionNumber(),o=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),u=function(t){if(o.hasOwnProperty(t)){var n=o[t];a.ApplyToItemsInRecord(n,s,function(t,s){var o=null==s.item?s.prevItem:s.item;null!=o&&o.version>i._versionManager.curVersion&&i._versionManager.fnDoPhysicalPropChange(n,t,o.value,e,null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState,!1,null,o.optErrorMsg,i.GetOldValue(i.propChanges[n][t],s.idx,!1))},!0)}},a=this;for(var f in o)u(f)};e.prototype.RollBackChange=function(e,t){var i=this,s=e.GetVersionNumber(),o=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),u=function(e){if(o.hasOwnProperty(e)){var t=o[e];a.ApplyToItemsInRecord(t,s,function(e,s){n.JsGridUtil.DebugAssert(s.idx>0);var o=i.propChanges[t][e][s.idx-1],u=n.JsGridUtil.Internal.LowerBound(i._versionManager.changeMap,o.version,"version"),a=i._versionManager.changeMap[u].key;i._versionManager.fnDoPhysicalPropChange(t,e,o.value,a,null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState,!1,null,o.optErrorMsg,i.GetOldValue(i.propChanges[t][e],s.idx-1,!0))},null)}},a=this;for(var f in o)u(f)};e.prototype.AdvanceBaseline=function(e){for(var t in this.propChanges)if(this.propChanges.hasOwnProperty(t))for(var r in this.propChanges[t])if(this.propChanges[t].hasOwnProperty(r)){for(var i=this.propChanges[t][r],s=n.JsGridUtil.Internal.LowerBound(i,e,"version"),o=1;o<s;o++)i.shift();1==i.length?this.DeleteEntry(t,r):i[0].version=e}};e.prototype.GetOldValue=function(e,t,n){var r,i=n?t+1:t-1;i>=0&&i<e.length&&(r=e[i].value);return r};e.prototype.GetPropUpdateFromRecord=function(e,t){var o=this._versionManager._objBag.controller.GetPropType(e.key(),t),u=o&&i.PropertyType.Internal.Property.GetInstance().GetUpdateTrackingMode(o,this._versionManager._objBag.jsGridParams.tableViewParams.gridFieldMap[t]),a=e.HasDataValue(t)&&u!==r.JsGridConstants.UpdateTrackingMode.PropLocalized?e.GetDataValue(t):n.JsGridUtil.EmptyValue,f=e.HasLocalizedValue(t)&&u!==r.JsGridConstants.UpdateTrackingMode.PropData?e.GetLocalizedValue(t):n.JsGridUtil.EmptyValue;return new s.PropertyUpdate(a,f)};e.prototype.MinimizePropUpdate=function(e,t,i){var s=this._versionManager._objBag.controller.GetPropType(e,t),o=s&&s.GetUpdateTrackingMode&&s.GetUpdateTrackingMode();null!=s&&null!=o&&(o==r.JsGridConstants.UpdateTrackingMode.PropLocalized&&i.data!==n.JsGridUtil.EmptyValue?i.data=n.JsGridUtil.EmptyValue:o==r.JsGridConstants.UpdateTrackingMode.PropData&&i.localized!==n.JsGridUtil.EmptyValue&&(i.localized=n.JsGridUtil.EmptyValue))};e.prototype.Init=function(){this.propChanges={}};e.prototype.DeleteEntry=function(e,t){delete this.propChanges[e][t];n.JsGridUtil.Internal.IsAssocArrayEmpty(this.propChanges[e])&&delete this.propChanges[e]};e.prototype.ApplyToItemsInRecord=function(e,t,n,r){var i=this.propChanges[e];if(null!=i)for(var s in i)if(i.hasOwnProperty(s)){var o=this.GetChangeFromList(i[s],t);(null!=o.item||r)&&n(s,o)}};e.prototype.GetChangeFromList=function(e,t){var r=n.JsGridUtil.Internal.LowerBound(e,t,"version");return{idx:r,item:null!=e[r]&&e[r].version==t?e[r]:null,prevItem:r>0&&r<=e.length?e[r-1]:null}};return e})(),p=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.AddLevelChange=function(e,t,n,r){var i=r.GetVersionNumber(),s=this.levelChanges[i];null==s&&(s=this.levelChanges[i]=[]);s.push({recordKey:e,levelDelta:t,adoptedChildrenKeys:n});this._versionManager.curVersion>=i&&this._versionManager.fnDoPhysicalLevelChange(e,t,n,r)};e.prototype.ApplyAllLevelChanges=function(e){this.DoLevelChange(e,!1)};e.prototype.UndoAllLevelChanges=function(e){this.DoLevelChange(e,!0)};e.prototype.GetChange=function(e,t,n){var i;null!=t&&(i=new o.Set).AddArray(t);var s=[],u=this.levelChanges[e];if(null!=u)for(var a=r.JsGridConstants.ChangeType.Level,f=0;f<u.length;f++)if(null==i||i.Contains(u[f].recordKey)){var l=u[f].levelDelta*(n?-1:1);s.push({type:a,recordKey:u[f].recordKey,levelDelta:l,adoptedChildrenKeys:u[f].adoptedChildrenKeys})}return s};e.prototype.VacateChange=function(e){delete this.levelChanges[e]};e.prototype.AdvanceBaseline=function(e){for(var t=this._versionManager.baselineVersion;t<e;t++)this.VacateChange(t)};e.prototype.Init=function(){this.levelChanges={}};e.prototype.DoLevelChange=function(e,t){var n=this.levelChanges[e.GetVersionNumber()];if(null!=n)if(t)for(var r=n.length-1;r>=0;r--)this._versionManager.fnDoPhysicalLevelChange(n[r].recordKey,-n[r].levelDelta,n[r].adoptedChildrenKeys,e);else for(r=0;r<n.length;r++)this._versionManager.fnDoPhysicalLevelChange(n[r].recordKey,n[r].levelDelta,null,e)};return e})(),d=(function(){function e(e,t,n,r,i,s){this.reservedChanges=[];this.curVersion=0;this.baselineVersion=0;this.changeCount=1;this.vacatedChanges=new f;this._objBag=e;this.fnDoPhysicalPropChange=t;this.fnDoPhysicalRowInsert=n;this.fnDoPhysicalRowDelete=r;this.fnDoPhysicalLevelChange=i;this.fnGetRecord=s;this.rowChangeMgr=new c(this);this.changeMap=[{key:new l(0,this),version:0}];this.propChangeMgr=new h(this);this.levelChangeMgr=new p(this)}e.prototype.ChangeKeysOnPropUpdates=function(e,t){this.propChangeMgr.ChangeKeys(e,t)};e.prototype.GetEarliestPropChangeKeyForRecord=function(e){var t=this.propChangeMgr.GetEarliestChangeKeyForRecord(e);null!=t&&(t=this.GetChangeKeyForVersion(t));return t};e.prototype.AddPropChange=function(e,t,n,r,i,s){this.ValidateChangeKey(n,!0)&&this.propChangeMgr.AddPropChange(e,t,n,r,i,s)};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){var i=!1;this.ValidateChangeKey(n,!0)&&(i=this.propChangeMgr.MarkPropUpdateInvalid(e,t,n,r));return i};e.prototype.ClearAllPropChangesForRecord=function(e){this.propChangeMgr.ClearAllPropChangesForRecord(e)};e.prototype.AddRowInsertChange=function(e,t){this.ValidateChangeKey(t,!0)&&this.rowChangeMgr.AddInsertChange(e,t)};e.prototype.AddRowDeleteChange=function(e,t){this.ValidateChangeKey(t,!0)&&this.rowChangeMgr.AddDeleteChange(e,t)};e.prototype.AddIndentLevelChange=function(e,t,n,r){this.ValidateChangeKey(r,!0)&&this.levelChangeMgr.AddLevelChange(e,t,n,r)};e.prototype.ApplyChangesToRecord=function(e){this.propChangeMgr.ApplyChangesToRecord(e)};e.prototype.ApplyChangeKey=function(e){if(!this.ValidateChangeKey(e,!0)){ULS.SendErrorMessageJS(ULSCat.msoulscat_WSS_JsGrid,"Invalid change key: "+e.GetVersionNumber().toString());throw new u("Invalid change key: "+e.GetVersionNumber().toString())}null!=this.OnSynchronizeChange&&this.OnSynchronizeChange(e);this.rowChangeMgr.ApplyAllRowInsertChanges(e);this.levelChangeMgr.ApplyAllLevelChanges(e);this.propChangeMgr.SynchronizeToChange(e);this.rowChangeMgr.ApplyAllRowDeleteChanges(e);this.curVersion=e.GetVersionNumber()};e.prototype.UndoChangeKey=function(e){if(!this.ValidateChangeKey(e,null)){ULS.SendErrorMessageJS(ULSCat.msoulscat_WSS_JsGrid,"Invalid change key: "+e.GetVersionNumber().toString());throw new u("Invalid change key: "+e.GetVersionNumber().toString())}null!=this.OnRollbackChange&&this.OnRollbackChange(e);var t=this.TryGetPreviousChangeKeyFromVersion(e.GetVersionNumber());this.curVersion=t.GetVersionNumber();this.rowChangeMgr.UndoAllRowDeleteChanges(e);this.levelChangeMgr.UndoAllLevelChanges(e);this.propChangeMgr.RollBackChange(e);this.rowChangeMgr.UndoAllRowInsertChanges(e)};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.propChangeMgr.TryReadPropForVersion(e,t,n.GetVersionNumber())};e.prototype.GetChange=function(e,t,r){var i=e.GetVersionNumber();n.JsGridUtil.DebugAssert(!r||i!==this.baselineVersion);var s=this.rowChangeMgr.GetChange(i,t,r),o=this.levelChangeMgr.GetChange(i,t,r),u=this.propChangeMgr.GetChange(i,t,r);return s.concat(o,u).sort(function(e,t){return e.type-t.type})};e.prototype.GetCurrentVersion=function(){return this.curVersion};e.prototype.GetCurrentChangeKey=function(){return this.GetChangeKeyFromVersion(this.curVersion)};e.prototype.IsChangeKeyApplied=function(e){return null!=e&&e.GetVersionNumber()<=this.curVersion};e.prototype.GetNextVersionKey=function(){var e=new l(this.changeCount++,this);this.changeMap.push({key:e,version:e.GetVersionNumber()});e.Reserve();return e};e.prototype.ForceReleaseChanges=function(e,t){var n,r=0;this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.reservedChanges,function(e,t){n=null==n?t:n;r++});this.reservedChanges.splice(n,r);this.UpdateBaselineVersion()};e.prototype.GetChangeKeyForVersion=function(e){var t=this.GetChangeKeyFromVersion(e);return null!=t&&this.ValidateChangeKey(t,!0)?t:null};e.prototype.Clear=function(){this.reservedChanges=[];this.rowChangeMgr.Clear();this.levelChangeMgr.Clear();this.propChangeMgr.Clear()};e.prototype.ReleaseChanges=function(e,t){this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.changeMap,function(e,t){e.key.Release()});this.UpdateBaselineVersion()};e.prototype.ReserveChanges=function(e,t){this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.changeMap,function(e,t){e.key.Reserve()})};e.prototype.VacateChange=function(e){var t=e.GetVersionNumber();n.JsGridUtil.DebugAssert(t>this.baselineVersion);n.JsGridUtil.DebugAssert(t>this.curVersion);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnVacateChange,n.JsGridUtil.EventArgs.VacateChange(e));null!=this.OnVacateChange&&this.OnVacateChange(e);this.propChangeMgr.VacateChange(t);this.rowChangeMgr.VacateChange(t);this.levelChangeMgr.VacateChange(t);this.vacatedChanges.VacateChange(t);this.CleanUpChangeMap(t,t)};e.prototype.CleanUpChangeMap=function(e,t){var n,r=0;this.ForEachChange(e,t,this.changeMap,function(e,t){n=null==n?t:n;r++});this.changeMap.splice(n,r)};e.prototype.ForEachChange=function(e,t,r,i){for(var s=null==e?0:n.JsGridUtil.Internal.LowerBound(r,e,"version"),o=null==t?r.length-1:n.JsGridUtil.Internal.LowerBound(r,t,"version"),u=s;u<=o;u++)null!=r[u]&&i(r[u],u)};e.prototype.ValidateChangeKey=function(e,t){var r=e.GetVersionNumber();n.JsGridUtil.DebugAssert(r>this.baselineVersion||t&&r==this.baselineVersion);return!this.vacatedChanges.ChangeIsVacated(r)};e.prototype.TryGetPreviousChangeKeyFromVersion=function(e){for(var t=null,n=0;n<this.changeMap.length&&this.changeMap[n].version<e;n++)t=this.changeMap[n];return t&&t.key};e.prototype.GetChangeKeyFromVersion=function(e){var t=n.JsGridUtil.Internal.BinarySearch(this.changeMap,e,"version");return this.changeMap[t].key};e.prototype.UpdateBaselineVersion=function(){var e=this.reservedChanges.length>0?this.reservedChanges[0]-1:this.curVersion-1;if(e>this.baselineVersion){this.propChangeMgr.AdvanceBaseline(e);this.rowChangeMgr.AdvanceBaseline(e);this.levelChangeMgr.AdvanceBaseline(e);this.vacatedChanges.AdvanceBaseline(e);this.CleanUpChangeMap(this.baselineVersion,e-1);this.baselineVersion=e}};return e})();t.VersionManager=d});
define("zGe",["require","exports","KGe","eGe","_Ge","GGe","tGe","me","cGe","ce","C4","p7","sf"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=f.Killswitch.isActivated("FCBB4612-13ED-47B8-9E17-79F91890AC92","9/26/2019","Translate the title column to linktitle when comparing Grid columns to the additionalColumnSchema"),d=f.Killswitch.isActivated("FE3155B7-42CB-443A-96A5-A7250085F375","7/8/2020","Command to move column left or right"),v={ODB:1672},m={ODB:1722},g={ODB:1918},y={ODB:1843},b=(function(){function e(e,t,n,r,i,s){var o=this;this._sortStateMap={};this.OnPropertyChanged=function(e){delete o.cache[e.fieldKey]};this.OnRecordInserted=function(e){o.ClearCache()};this.OnRecordDeleted=function(e){o.ClearCache()};this._objBag=e;this._autoFilterState=t;this._fnGetLocStr=i;if(s)for(var u=0,a=s;u<a.length;u++){var f=a[u];this._sortStateMap[f.fieldKey]=f.isDescending}this.cache=n||{};this.paneMgr=e.paneMgr;this.delegateMgr=e.delegateMgr;this.jsGridObj=e.jsGridObj;this.Init()}e.prototype.Init=function(){this._autoFilterState=null==this._autoFilterState?{}:this._autoFilterState;this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged);this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInserted);this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordDeleted);this.addColumnMgr=new n.default(this._objBag)};e.prototype.Dispose=function(){this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged);this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInserted);this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordDeleted);this.addColumnMgr.Dispose()};e.prototype.SetAutoFilterState=function(e){this._autoFilterState=null==e?{}:e;this.ClearCache()};e.prototype.SeedAutoFilterEntryCache=function(e){this.cache=e||{}};e.prototype.ClearCache=function(){this.cache={}};e.prototype.CanExpandMenu=function(e,t,n,i,s){return t||s||n&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.Sort)||i&&e.isAutoFilterable&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetAutoFilterEntries)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.AutoFilter)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.LaunchFilterDialog)||e.columnKey==r.JsGridConstants.RecordIndicatorCheckboxColumnKey||this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.WillAddColumnMenuItems)&&this.delegateMgr.Apply(r.JsGridConstants.DelegateType.WillAddColumnMenuItems,e.columnKey)};e.prototype.ExpandMenu=function(e,t,n,f,b,w,E){var S=this;var x=e.columnKey,T=E||this.jsGridObj.parentNode;this.columnMenu=new i.ContextMenuWrapper({target:T,id:this.jsGridObj.parentNode.id+"_columnmenu",OnMenuHidden:function(){n()},portalManager:this.jsGridObj.objBag?this.jsGridObj.objBag.portalManager:void 0});var N=a.JsGridUtil.Internal.IsFeatureEnabled(m);if(e.isFooter)this.addColumnMgr.PopulateNewColumnMenu(this.columnMenu,this._objBag.jsGridParams.onColumnChangeSucceeded,this._objBag.jsGridParams.onLaunchColumnManagementPanel);else{e.fieldType&&-1!==l.FieldTypeSwitcherHelper.getSupportedPanelTypes().indexOf(e.fieldType)&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onLaunchColumnManagementPanel&&e.isEditable&&!e.isCalculated&&e.internalName&&"Title"!==e.internalName&&this.addColumnMgr.EditColumn(this.columnMenu,this._objBag.jsGridParams.onLaunchColumnManagementPanel,e.fieldType,e.internalName);this.columnMenu.InsertMenuItem({key:"RenameColumn",text:this._fnGetLocStr("RenameColumn"),onClick:function(){S.OnColumnRename(x,S._objBag.jsGridParams.onColumnChangeSucceeded)}});if(b&&e.isSortable&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onSort){this.columnMenu.InsertSeparator();var C=this._sortStateMap[x];this.columnMenu.InsertMenuItem({key:"SortAsc",text:e.ascendingString||this._fnGetLocStr("SortAsc"),onClick:function(){S._objBag.jsGridParams.onSort(x,!0)},canCheck:!0,checked:!1===C});this.columnMenu.InsertMenuItem({key:"SortDesc",text:e.descendingString||this._fnGetLocStr("SortDesc"),onClick:function(){S._objBag.jsGridParams.onSort(x,!1)},canCheck:!0,checked:!0===C})}if(e.isFilterable&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onLaunchFilterPanel){var k=this._autoFilterState[x],L=s.default.columnMenuFilter;if(k){var A=k.split(";#");L=u.format(s.default.columnMenuFilterByWithNumber,A.length)}this.columnMenu.InsertMenuItem({key:"FilterBy",text:L,onClick:function(){p?S._objBag.jsGridParams.onLaunchFilterPanel(x):S._objBag.jsGridParams.onLaunchFilterPanel(a.JsGridUtil.Internal.normalizeColumnKey(x))}})}var O=[];a.JsGridUtil.Internal.IsFeatureEnabled(v)&&O.push({key:"CustomizeColumn",text:s.default.columnMenuFormat,onClick:function(){S._objBag.jsGridParams.launchColumnCustomization(a.JsGridUtil.Internal.normalizeColumnKey(x,!0))}});if(!d){this.isMoveColumnAvailable(!0,x)&&O.push({key:"columnMenuMoveLeft"+x,text:s.default.columnMenuMoveLeft,onClick:function(){S.onMoveColumn(e,x,!0)}});this.isMoveColumnAvailable(!1,x)&&O.push({key:"columnMenuMoveRight"+x,text:s.default.columnMenuMoveRight,onClick:function(){S.onMoveColumn(e,x,!1)}})}N&&e.isHidable&&O.push({key:"HideColumn",text:s.default.columnMenuHideThisColumn,onClick:function(){if(S.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.RemoveColumnFromView)){var e=a.JsGridUtil.Internal.normalizeColumnKey(x,!0);S.delegateMgr.Apply(r.JsGridConstants.DelegateType.RemoveColumnFromView,e)}}});if(a.JsGridUtil.Internal.IsFeatureEnabled(g)&&e.isFilterable){var M=a.JsGridUtil.Internal.getColumnFromListSchema(this.jsGridObj,x),_=c.ShowInFiltersPaneStatus[M.ShowInFiltersPane];if(M){_===c.ShowInFiltersPaneStatus.Auto&&O.push({key:"PinToFiltersPane",text:s.default.columnMenuPinToFiltersPane,onClick:function(){S.onPinToFiltersPane(M,c.ShowInFiltersPaneStatus.Pinned);M.ShowInFiltersPane=c.ShowInFiltersPaneStatus[c.ShowInFiltersPaneStatus.Pinned]}});_===c.ShowInFiltersPaneStatus.Pinned&&O.push({key:"UnpinFromFiltersPane",text:s.default.columnMenuUnpinFromFiltersPane,onClick:function(){S.onPinToFiltersPane(M,c.ShowInFiltersPaneStatus.Auto);M.ShowInFiltersPane=c.ShowInFiltersPaneStatus[c.ShowInFiltersPaneStatus.Auto]}})}}if(N){O.push({key:"divider_1",itemType:h.ContextualMenuItemType.Divider});O.push({key:"LaunchColumnsEditorPanel",text:s.default.addColumnShowHide,onClick:function(){S._objBag.jsGridParams.launchColumnsEditor()}})}if(a.JsGridUtil.Internal.IsFeatureEnabled(y)&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onLaunchColumnManagementPanel){N||O.push({key:"divider_1",itemType:h.ContextualMenuItemType.Divider});var D=this.addColumnMgr.PopulateNewColumnMenu(this.columnMenu,this._objBag.jsGridParams.onColumnChangeSucceeded,this._objBag.jsGridParams.onLaunchColumnManagementPanel,a.JsGridUtil.Internal.normalizeColumnKey(e.internalName,!0),!0);D&&D.length&&O.push({key:"AddColumn",text:o.default.L_AddColumn_Text,subMenuProps:{items:D}})}if(O.length){this.columnMenu.InsertSeparator();this.columnMenu.InsertMenuItem({key:"ColumnSettings",text:s.default.columnMenuColumnSettings,subMenuProps:{items:O}})}}if(x==r.JsGridConstants.RecordIndicatorCheckboxColumnKey){this.columnMenu.InsertSeparator();this.columnMenu.InsertMenuItem({key:"CheckAllRecords",text:this._fnGetLocStr("CheckAllRecords"),onClick:function(){S.jsGridObj.GetCheckSelectionManager().CheckAllRecords()}});this.columnMenu.InsertMenuItem({key:"ClearCheckedRecords",text:this._fnGetLocStr("ClearCheckedRecords"),onClick:function(){S.jsGridObj.GetCheckSelectionManager().ClearCheckedRecords()}})}this.columnMenu.IsEmpty()||this.columnMenu.Show();return!this.columnMenu.IsEmpty()};e.prototype.isMoveColumnAvailable=function(e,t){var n=!1,r=this.paneMgr.gridPane.GetAllColumns()._colInfoArray.map(function(e){return e.columnKey});if(r&&r.length){var i=r.indexOf(t);n=e?i>1:i>=0&&i<r.length-2}return n};e.prototype.onMoveColumn=function(e,t,n){var i=this.paneMgr.gridPane.GetAllColumns().GetColumnPosition(t),s=n?i-1:i+1;this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.MoveColumn)&&this.delegateMgr.Apply(r.JsGridConstants.DelegateType.MoveColumn,{columnInfo:e,dragDropDetails:{draggedIndex:i,targetIndex:s},onColumnChangeSucceeded:this._objBag.jsGridParams.onColumnChangeSucceeded})};e.prototype.onPinToFiltersPane=function(e,t){this._objBag.jsGridParams.onPinToFiltersPane({id:e.ID,internalName:a.JsGridUtil.Internal.normalizeColumnKey(e.RealFieldName,!0),showInFiltersPane:c.ShowInFiltersPaneStatus[e.ShowInFiltersPane],filterable:!0},t)};e.prototype.OnColumnRename=function(e,t){this.columnMenu.Hide();this.paneMgr.RenameColumn(e,t)};return e})();t.default=b});
define("KGe",["require","exports","eGe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._objBag=e;this.Init()}e.prototype.Init=function(){this._delegateMgr=this._objBag.delegateMgr;this._objBag.addColumnMgr=this};e.prototype.PopulateNewColumnMenu=function(e,t,r,i,s){return this._delegateMgr.Apply(n.JsGridConstants.DelegateType.AddNewColumnMenuItems,e,t,r,i,s)};e.prototype.EditColumn=function(e,t,r,i){this._delegateMgr.Apply(n.JsGridConstants.DelegateType.EditColumn,e,t,r,i)};e.prototype.ShouldShowAddColumnMenu=function(){return 1==this._objBag.showAddColumnMenu};e.prototype.Dispose=function(){this._objBag.addColumnMgr=null};return e})();t.default=r});
define("_Ge",["require","exports","r","cGe","sf","uGe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e){var t=this;this._itemCount=0;this._seperatorCount=0;this._menuItems=[];this._functionDispatch=[];this._isOpen=!1;this.Hide=function(){if(t.IsOpen()){t._onMenuHidden&&t._onMenuHidden();t.Dispose()}};this.Show=function(){if(t._itemCount){var e=n.createElement(i.ContextualMenu,{items:t._menuItems,target:t._target,onDismiss:t.Hide,calloutProps:{shouldRestoreFocus:!0}});t._portalManager.render(e,t._popupAnchor);t._isOpen=!0}};this.Dispose=function(){t._isOpen=!1;t._portalManager.unmount(t._popupAnchor);if(!r.JsGridUtil.Internal.IsNullOrUndefined(t._popupAnchor)&&r.JsGridUtil.Internal.DomElement.GetInstance().GetParentElement(t._popupAnchor)){t._popupAnchor.parentNode.removeChild(t._popupAnchor);t._popupAnchor=null}window[t._id+"_onclick"]=null};var o=e.target,u=e.id,a=e.OnMenuHidden,f=e.portalManager;this._target=o;this._id=u;this._onMenuHidden=a;this._portalManager=f||s.defaultPortalManger;this._popupAnchor=document.createElement("div");this._popupAnchor.style.cssText="position:absolute;visibility:hidden;width:250px;";window[this._id+"_onclick"]=function(e){setTimeout(t._functionDispatch[e],0)}}e.prototype.IsOpen=function(){return this._isOpen};e.prototype.IsEmpty=function(){return 0==this._itemCount};e.prototype.InsertMenuItem=function(e){e.onClick&&this._functionDispatch.push(e.onClick);this._menuItems.push(e);this._itemCount++};e.prototype.InsertSeparator=function(){if(this._menuItems.length&&this._menuItems[this._menuItems.length-1].itemType!==i.ContextualMenuItemType.Divider){this._menuItems.push({key:"divider_"+this._seperatorCount,itemType:i.ContextualMenuItemType.Divider});this._seperatorCount++}};e.prototype.RemoveMenuItem=function(e){this._menuItems.splice(e,1)};return e})();t.ContextMenuWrapper=o});
define("uGe",["require","exports","o"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultPortalManger={unmount:n.unmountComponentAtNode,render:n.render}});
define("DGe",["require","exports","cGe","IGe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=(function(){function e(e){this.lockCount=0;this.undoStack=[];this.redoStack=[];this.undoRealCmdCount=0;this.redoRealCmdCount=0;this.groupStack=[];this._cmdTypeEnum=i.CommandType;this.preExecuteNotifiers=[];this._maxUndoDepth=void 0===e.maxUndoDepth?100:e.maxUndoDepth;this._onUndoRealCmdCountChange=e.onUndoRealCmdCountChange;this._onRedoRealCmdCountChange=e.onRedoRealCmdCountChange}e.prototype.IsUndoEnabled=function(){return this._maxUndoDepth>0};e.prototype.OpenGroup=function(){this.bApplyingOrUndoing?n.JsGridUtil.DebugAssert(!1,"Cannot open a Command Group within an Apply/Undo"):this.groupStack.push([])};e.prototype.CloseGroup=function(e,t,r){if(this.bApplyingOrUndoing)n.JsGridUtil.DebugAssert(!1,"Cannot close a Command Group within an Apply/Undo");else{n.JsGridUtil.DebugAssert(0!==this.groupStack.length);var i=this.groupStack.pop();if(0!=i.length){var s=1==i.length?i[0]:new o(i,r);this.AppendToUndoStack(s,e,t)}}};e.prototype.Execute=function(e,t,r){if(this.bApplyingOrUndoing){n.JsGridUtil.DebugAssert(!1,"Cannot add a command to the undo stack within an Apply/Undo");e.Apply()}else{this.CleanUpRedoStack();this.AppendToUndoStack(e,t,r);this.PreExecuteNotify();this.bExecuting=!0;e.Apply();this.bExecuting=!1}};e.prototype.Undo=function(){var e;try{if(0!==this.lockCount||this.groupStack.length>0||!this.undoRealCmdCount||this.bApplyingOrUndoing||this.bExecuting)return!1;this.PreExecuteNotify();this.bApplyingOrUndoing=!0;do{(e=this.undoStack.pop()).cmd.Undo();this.redoStack.push(e)}while(e.type==this._cmdTypeEnum.Implicit);this.undoRealCmdCount--;this._onUndoRealCmdCountChange&&this._onUndoRealCmdCountChange(this.undoRealCmdCount);this.redoRealCmdCount++;this._onRedoRealCmdCountChange&&this._onRedoRealCmdCountChange(this.redoRealCmdCount)}catch(t){if(t instanceof r.InvalidChangeKeyError){this.ClearUndoStack();throw new u("Failed to Undo command with Name:"+e.name+" and Type:"+e.type+" due to Invalid change key: "+e.cmd.GetChangeKey().GetVersionNumber().toString())}throw t}finally{this.bApplyingOrUndoing=!1}return!0};e.prototype.Redo=function(){var e;try{if(0!==this.lockCount||0!==this.groupStack.length||!this.redoRealCmdCount||this.bApplyingOrUndoing||this.bExecuting)return!1;this.PreExecuteNotify();this.bApplyingOrUndoing=!0;do{(e=this.redoStack.pop()).cmd.Apply();this.undoStack.push(e)}while(e.type==this._cmdTypeEnum.Implicit);this.redoRealCmdCount--;this._onRedoRealCmdCountChange&&this._onRedoRealCmdCountChange(this.redoRealCmdCount);this.undoRealCmdCount++;this._onUndoRealCmdCountChange&&this._onUndoRealCmdCountChange(this.undoRealCmdCount)}catch(t){if(t instanceof r.InvalidChangeKeyError){this.ClearRedoStack();throw new u("Failed to Redo command with Name:"+e.name+" and Type:"+e.type+" due to Invalid change key: "+e.cmd.GetChangeKey().GetVersionNumber().toString())}throw t}finally{this.bApplyingOrUndoing=!1}return!0};e.prototype.CanUndo=function(){return this.undoRealCmdCount>0};e.prototype.CanRedo=function(){return this.redoRealCmdCount>0};e.prototype.GetUndoStack=function(){return this.undoStack};e.prototype.GetRedoStack=function(){return this.redoStack};e.prototype.ClearUndoStack=function(){this.CleanUpUndoStack()};e.prototype.ClearRedoStack=function(){this.CleanUpRedoStack()};e.prototype.Lock=function(){this.lockCount++};e.prototype.Unlock=function(){this.lockCount=Math.max(this.lockCount-1,0)};e.prototype.AddPreExecuteNotifier=function(e){this.preExecuteNotifiers.push(e)};e.prototype.RemovePreExecuteNotifier=function(e){for(var t=!1,n=0;n<this.preExecuteNotifiers.length;n++)if(this.preExecuteNotifiers[n]==e){this.preExecuteNotifiers.splice(n,1);n--;t=!0;break}return t};e.prototype.PreExecuteNotify=function(){for(var e=[].concat(this.preExecuteNotifiers),t=0;t<e.length;t++)e[t]()};e.prototype.CleanUpUndoStack=function(){if(0!==this.undoStack.length){for(var e=0;e<this.undoStack.length;e++)this.DisposeCmd(this.undoStack[e].cmd,i.DisposeState.Applied);this.undoStack=[];this.undoRealCmdCount=0;this._onUndoRealCmdCountChange&&this._onUndoRealCmdCountChange(this.undoRealCmdCount)}};e.prototype.CleanUpRedoStack=function(){if(0!==this.redoStack.length){for(var e=this.redoStack.length-1;e>=0;e--)this.DisposeCmd(this.redoStack[e].cmd,i.DisposeState.Unapplied);this.redoStack=[];this.redoRealCmdCount=0;this._onRedoRealCmdCountChange&&this._onRedoRealCmdCountChange(this.redoRealCmdCount)}};e.prototype.AppendToUndoStack=function(e,t,n){if(0!==this.groupStack.length)this.groupStack[this.groupStack.length-1].push(e);else if(0!==this.undoRealCmdCount||n!==this._cmdTypeEnum.Implicit){this.undoStack.push({cmd:e,name:t,type:n});this.undoRealCmdCount+=n!==this._cmdTypeEnum.Implicit?1:0;if(this.undoStack.length>this._maxUndoDepth){this.undoStack[0].type!==this._cmdTypeEnum.Implicit&&this.undoRealCmdCount--;this.DisposeCmd(this.undoStack.shift().cmd,i.DisposeState.Applied);for(;this.undoStack.length&&this.undoStack[0].type==this._cmdTypeEnum.Implicit;)this.DisposeCmd(this.undoStack.shift().cmd,i.DisposeState.Applied)}this._onUndoRealCmdCountChange&&this._onUndoRealCmdCountChange(this.undoRealCmdCount)}};e.prototype.DisposeCmd=function(e,t){n.JsGridUtil.Internal.IsNullOrUndefined(e.Dispose)||e.Dispose(t)};return e})();t.CommandManager=s;(function(e){e.CommandType={Explicit:0,Implicit:1};e.DisposeState={Applied:0,Unapplied:1}})(i=t.CommandManagerConstants||(t.CommandManagerConstants={}));var o=(function(){function e(e,t){n.JsGridUtil.DebugAssert(!n.JsGridUtil.Internal.IsNullOrUndefined(e)&&0!==e.length);this.cmdArray=e;this.bReverseOnUndo=t}e.prototype.Apply=function(){for(var e=this.cmdArray.length,t=0;t<e;t++)this.cmdArray[t].Apply()};e.prototype.Undo=function(){var e,t=this.cmdArray.length;if(this.bReverseOnUndo)for(e=t-1;e>=0;e--)this.cmdArray[e].Undo();else for(e=0;e<t;e++)this.cmdArray[e].Undo()};e.prototype.Dispose=function(e){for(var t=this.cmdArray.length,r=0;r<t;r++){var i=this.cmdArray[r];n.JsGridUtil.Internal.IsNullOrUndefined(i.Dispose)||i.Dispose(e)}};return e})();t.AggregateCommand=o;var u=function(e){this.message=e||"Command Manager Error";this.name="CommandManagerError"};t.CommandManagerError=u});
define("OGe",["require","exports","cGe","eGe","jGe","sGe","BGe","NGe","HGe","FGe","UGe","TGe","AGe","BGe","oGe","hGe","EGe","bGe","YGe","tGe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";w=w.panemgr_9;Object.defineProperty(t,"__esModule",{value:!0});var E={ODB:1725},S={ODB:1170},x=(function(){function e(e,t,s,h,p,d,v){var m=this;this.CONST_minPaneWidth=o.GetMinScrollBarLength();this.CONST_minControlWidth=2*this.CONST_minPaneWidth+r.JsGridConstants.Internal.SplitterWidth+o.GetSystemScrollBarThickness();this.CONST_minControlHeight=o.GetMinScrollBarLength()+o.GetSystemScrollBarThickness();this.rowData=[];this.recordCount=0;this.keyToViewIdxMap={};this.bHandlersSet=!1;this.bHorizontalScrollBarVisible=!0;this.cleared=!0;this.mostRecentMouseDownCoords=null;this.bResizingScrollbar=!1;this.bRefreshingAllRows=!1;this.bDeletingOrInsertingRows=!1;this.OnFocus_Window=function(e){m.cutcopypasteMgr.CheckClipboard()};this.OnResize_Window=function(e){m.HandleParentResize()};this.OnMouseDown=function(e){m.mostRecentMouseDownCoords={x:e.clientX,y:e.clientY};if(m._fnIsGridEnabled()){n.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);m.Focus()}};this._jsGridElementId=e;this._objBag=t;this._fnGetLocStr=s;this._parentNode=h;this._minHeaderHeight=p;this._minRowHeight=d;this._fnIsGridEnabled=v;this.lastParentSize={height:h.offsetHeight,width:h.offsetWidth};this.selectionMgr=this._objBag.selectionMgr=new i.SelectionManager(function(e){null!=m.eventSinks.OnFocusedCellChanged&&m.eventSinks.OnFocusedCellChanged(e)});this.changeHighlightMgr=new u.ChangeHighlightManager;this.editMgr=new a.EditManager(this._objBag,function(e,t,n,r){m.eventSinks.OnPropertiesChanged(e,t,n,r)},this.GetCellValue.bind(this));this.cutcopypasteMgr=this._objBag.cutcopypasteMgr=new f.CutCopyPasteManager(this._objBag,s);this.fillDownMgr=new l.FillDownManager(this._objBag.intDelegateMgr,this._objBag.styleMgr);this.focusMgr=this._objBag.focusMgr=new c.FocusManager(e,this._objBag,h,s,v,this.IsGridVisible.bind(this),this.selectionMgr,this.editMgr,this.GetCellValue.bind(this),this.RetryErrorRows.bind(this),this.ScrollIntoViewVertically.bind(this));this.Init()}e.prototype.SetEventSinks=function(e){this.eventSinks=e};e.prototype.Dispose=function(){var e=this,t=function(){e.vertScrollBarContainer=e.leftPaneParent=e.rightPaneParent=e._parentNode=e.borderElement=null;e.editMgr.Dispose();e.focusMgr.Dispose();null!=e.touchMgr&&e.touchMgr.Dispose()};if(null!=this.panes){this.cutcopypasteMgr.CancelMode();this.editMgr.StopEditing(!0);this.editMgr.Unbind(function(){e.UpdatePanes(0,e.rowData.length,0,0,!0);e.panes.each("Dispose");e.vertScrollBar.Dispose();e._parentNode.removeEventListener("mousedown",e.OnMouseDown);window.removeEventListener("focus",e.OnFocus_Window);window.removeEventListener("resize",e.OnResize_Window);t()})}else t()};e.prototype.ClearView=function(){this.cleared=!0;this._objBag.entryRecordMgr.NotifyTableViewCleared();this.editMgr.Unbind();this.selectionMgr.Clear();this.cutcopypasteMgr.CancelMode();this.RefreshAllRows(0);null!=this.panes&&this.panes.each("ClearView")};e.prototype.NotifyCreateEntryRow=function(e,t){if(null!=this.posConverter){var n=e+this.posConverter.GetViewRecordCount(),r=this.posConverter.ViewIdxToRelViewIdx(n);this.UpdateRecordCount(1);this.vertScrollBar.GetItemDisplayCapacity()>r?this.UpdatePanes(0,0,r,1,!0):t&&this.ScrollIntoViewVertically(n)}};e.prototype.NotifyRemoveEntryRow=function(e){null!=this.posConverter&&this.NotifyDeleteRows(e+this.posConverter.GetViewRecordCount(),1)};e.prototype.GetLastRecordKey=function(){return null!=this.posConverter?this.posConverter.GetLastRecordKey():null};e.prototype.ChangeKeys=function(e,t){this.panes.each("ChangeKeys",e,t);if(e in this.keyToViewIdxMap){this.keyToViewIdxMap[t]=this.keyToViewIdxMap[e];delete this.keyToViewIdxMap[e]}};e.prototype.GetVirtualRowCount=function(){return this.gridPane.GetGridPaneConverter().GetVirtualRowCount()};e.prototype.GetVisibleRecordCount=function(){return Math.min(this.recordCount-this.vertScrollBar.GetTopItemIdx(),this.vertScrollBar.GetItemDisplayCapacity())};e.prototype.GetPartialRecordMap=function(e,t){var n,i=this.gridPane.GetGridPaneConverter();this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(t){return n=i.GetRecordsInvolved(e.begin,e.Size(),function(e){n=e;t()})},function(){t(n)})};e.prototype.GetRawRecordMap=function(e,t){var n,i=this;this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(){i._objBag.tableCache.GetRawDataRecords();return n=i._objBag.tableCache.GetRecordCache()},function(){t(n)})};e.prototype.GetRecordMap=function(e){var t=this.gridPane.GetGridPaneConverter(),n=new s.Range(0,t.GetVirtualRowCount()-1);this.GetPartialRecordMap(n,e)};e.prototype.GetGridPaneRowRange=function(){return new s.Range(0,this.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1)};e.prototype.AddColumn=function(e,t){var n=this.gridPane.GetAllColumns(),r=t||"JSGrid_NewColumn",i=n.GetColumnPosition(r);t&&i++;n.InsertColumnAt(i,e)};e.prototype.GetAllDataJson=function(e,t){this.GenerateGridDataJson(e,t,!1)};e.prototype.GetAllDataAfterExpansionJson=function(e,t){this.GenerateGridDataJson(e,t,!0)};e.prototype.GenerateGridDataJson=function(e,t,n){var r=this;this._objBag.jsGridObj.Disable();var i=this.gridPane.GetGridPaneConverter(),o=n?new s.Range(0,this._objBag.tableCache.GetRecordCacheSize()-1):new s.Range(0,i.GetVirtualRowCount()-1),u=new s.Range(0,i.GetVirtualColumnCount()-1),a=null!=this.pivotedGridPane?this.pivotedGridPane.GetGridPaneConverter():null,f=null!=this.pivotedGridPane?a.GetRowMultiple():0,l=null!=this.pivotedGridPane?new s.Range(0,a.GetVirtualColumnCount()-1):null,c=function(e){for(var t=e.GetColumnArray(!0),n=[],r=0;r<t.length;++r)n.push(e.GetColumnByKey(t[r].columnKey).name);return n},h={gridPaneData:null,gridPaneColumns:null,gridPaneStyleData:{cellStyleData:[]},pivotedGridPaneData:null,pivotedGridPaneColumns:null,pivotedGridPaneStyleData:{cellStyleData:[]}},p=[],d=0,v=0,m=[],g=0,y=0,b=this.gridPane.GetAllColumns(),w=b.GetColumnArray();h.gridPaneColumns=c(b);null!=this.pivotedGridPane&&(h.pivotedGridPaneColumns=c(this.pivotedGridPane.GetAllColumns()));var E=function(e){var t=e,i=null;if(e.end-e.begin+1>128){t=new s.Range(e.begin,e.begin+128-1);i=new s.Range(e.begin+128,e.end)}n?r.GetRawRecordMap(t,function(e){return S(e,t,i)}):r.GetPartialRecordMap(t,function(e){return S(e,t,i)})},S=function(i,o,a){var c=r.gridPane.GetData(i,o,u,n);if(null!=t)for(var b in i)for(var S=r._objBag.paneMgr.RecordKeyToViewIdx(b),x=i[b],T=0;T<w.length;++T){var N=w[T].columnKey,C=t(x,N);null!=C&&h.gridPaneStyleData.cellStyleData.push({matrixRow:S,matrixColumn:T,styleText:C})}var k=JSON.stringify(c.matrix);p.push(k.substr(1,k.length-2));d+=c.height;v=c.width;var L=null;if(null!=r.pivotedGridPane){var A=new s.Range(o.begin*f,o.end*f+f-1);L=r.pivotedGridPane.GetData(i,A,l,n);var O=JSON.stringify(L.matrix);m.push(O.substr(1,O.length-2));g+=L.height;y=L.width}null!=a?setTimeout(function(){E(a)},0):setTimeout(function(){var t=["{",'"gridPaneData":{"matrix":',"[",p.join(","),"]",',"height":',d,',"width":',v,"},",'"gridPaneColumns":',JSON.stringify(h.gridPaneColumns),",",'"gridPaneStyleData":',JSON.stringify(h.gridPaneStyleData),",",'"pivotedGridPaneData":',null!=r.pivotedGridPane?['{"matrix":',"[",m.join(","),"]",',"height":',g,',"width":',y,"}"].join(""):"null",",",'"pivotedGridPaneColumns":',null!=r.pivotedGridPane?JSON.stringify(h.pivotedGridPaneColumns):"null",",",'"pivotedGridPaneStyleData":',JSON.stringify(h.pivotedGridPaneStyleData),",",'"pivotedGridPaneRowMultiple":',f,"}"].join("");r._objBag.jsGridObj.Enable();setTimeout(function(){e(t)},0)},0)};E(o)};e.prototype.SetView=function(e,t,i,s,o,u,a,f,l,c,d,v,m,g,y,b,w,E,S){this.lastParentSize={height:this._parentNode.offsetHeight,width:this._parentNode.offsetWidth};0==this._parentNode.offsetHeight&&0==this._parentNode.offsetWidth&&(this.lastParentSize={height:this._parentNode.clientHeight,width:this._parentNode.clientWidth});this.cleared=!1;this.posConverter=e;this.paneLayout=y;this.gridFieldMap=i;this.splitterPos=u;this.bNewRowEnabled=this._objBag.editUtil.IsNewRowEnabled();this.posConverter.SetPaneMgrObj(this);this.posConverter.SetScrollBarObj(this.vertScrollBar);this.selectionMgr.SetAllowedSelectionTypes(f);this.cutcopypasteMgr.CancelMode();n.JsGridUtil.DebugAssert(this.paneLayout==r.JsGridConstants.PaneLayout.GridOnly||this.paneLayout==r.JsGridConstants.PaneLayout.GridAndGantt&&null!=b||this.paneLayout==r.JsGridConstants.PaneLayout.GridAndPivotedGrid&&null!=w);if(null==this.gridPane){this.CreateBorderHtmlElements();this.CreateSelectionBorderHtmlElements();this.CreateLeftPaneHtmlElements();var x=new T(this.leftPaneParent,this);this.gridPane=new h.GridPane(this.leftPaneParent,this._objBag,this.ScrollIntoViewVertically.bind(this),this.ScrollVerticallyByTouch.bind(this),this.paneLayout==r.JsGridConstants.PaneLayout.GridOnly?this.OnHorizontalGridPaneScrollBarVisibilityChange:null,this._objBag.commandMgr,this.selectionMgr,this.changeHighlightMgr,this.editMgr,this.cutcopypasteMgr,this.fillDownMgr,x,this.GetCellValue.bind(this),this._fnGetLocStr,this.RetryErrorRows,this.visualSelectionHtmlElements);this.gridPane.paneSize=x;this.panes=[this.gridPane];this.panes.each=N;this.touchMgr.RegisterTouchableAction("left",{element:this.leftPaneParent,control:this.gridPane})}else this.borderElement.style.display="none";null==this.vertScrollBar&&(this.vertScrollBar=new p.ScrollBar(p.ScrollBarType.Vertical,this.vertScrollBarContainer,!0,null,this._objBag.styleMgr.scrollBarStyle,this._objBag.RTL.bEnabled,this._objBag));this.posConverter.SetScrollBarObj(this.vertScrollBar);this.vertScrollBar.Update({topItemIdx:0,bScrollNotifiy:!1});this.CoordinateHeights();this.LayoutChildElements(!0);this.gridPane.SetView(e,o,this.AddSentinalColumns(t,E),this.gridFieldMap,a,l,c,d,v,m,g,S);null!=this.pivotedGridPane&&this.pivotedGridPane.SetView(e,o,w.columns,this.gridFieldMap,a,!1,!1,!1,!1,!1,!1,null);this.CoordinateHeights();this.panes.each("SetEventSinks",this.eventSinks);this.RefreshAllRows(s);if(!this.bHandlersSet){this.vertScrollBar.SetOnScroll(this.OnVerticalScroll.bind(this));this.vertScrollBar.SetOnVisibilityChanged(this.OnVerticalScrollbarVisibilityChanged.bind(this),!0);this._parentNode.addEventListener("mousedown",this.OnMouseDown);window.addEventListener("focus",this.OnFocus_Window);window.addEventListener("resize",this.OnResize_Window);this.bHandlersSet=!0}this.panes.each("OnResize");this.focusMgr.SetView(this.paneLayout,this.gridPane,this.pivotedGridPane,this.gridFieldMap,l,c,d,v,m,g,S);this._objBag.entryRecordMgr.NotifyTableViewChangeCompleted();this.borderElement.style.display=""};e.prototype.SetFilterState=function(e){this.gridPane.SetFilterState(e)};e.prototype.SetSortState=function(e){this.gridPane.SetSortState(e)};e.prototype.RecordKeyToViewIdx=function(e){return this.keyToViewIdxMap[e]};e.prototype.RefreshAllRows=function(e,t){this.bRefreshingAllRows=!0;if(null!=this.posConverter){this.SetRecordCount(this.posConverter.GetViewRecordCount(),e);this.UpdatePanes(0,this.rowData.length,0,this.GetVisibleRecordCount(),!t)}else this.UpdatePanes(0,this.rowData.length,0,this.rowData.length,!t);this.bRefreshingAllRows=!1};e.prototype.NotifyNewRowStateChanged=function(e){this.cutcopypasteMgr.CancelMode();var t=this.bNewRowEnabled;this.bNewRowEnabled=this._objBag.editUtil.IsNewRowEnabled();if(t!==this.bNewRowEnabled){this._objBag.entryRecordMgr.EnsureLastEntryRowExists();e||this.RefreshAllRows()}};e.prototype.NotifyChangedRowByKey=function(e){e in this.keyToViewIdxMap&&this.NotifyChangedRows(this.keyToViewIdxMap[e],1)};e.prototype.NotifyChangedRows=function(e,t){n.JsGridUtil.DebugAssert(e+t<=this.recordCount);var r=this.GetClippedRangeInfo(e,t);r.clippedCount<1||this.UpdatePanes(r.clippedRelViewIdx,r.clippedCount,r.clippedRelViewIdx,r.clippedCount,!1)};e.prototype.NotifyUpdateProperty=function(e,t,n,r,i,s){if(null!=e)this.panes.each("NotifyUpdateProperty",e,t,n,r,i,s);else for(var o=0;o<this.rowData.length;o++){var u=this.rowData[o];null!=u&&this.panes.each("NotifyUpdateProperty",u.recordKey,t,n,r,i,s)}};e.prototype.NotifyInsertRows=function(e,t,r,i){var s=this;n.JsGridUtil.DebugAssert(e<=this.recordCount&&t>=0);this.editMgr.Unbind(function(){s.bDeletingOrInsertingRows=!0;var n=s.vertScrollBar.GetTopItemIdx(),o=n+(e<n?t:0);s.UpdateRecordCount(t,o);s.bDeletingOrInsertingRows=!1;var u=s.GetClippedRangeInfo(e,t);if(u.clippedCount<1)s.RebuildKeyToPosMap();else{var a=u.clippedRelViewIdx,f=u.clippedCount,l=s.vertScrollBar.GetItemDisplayCapacity()-s.rowData.length,c=Math.max(f-l,0),h=s.rowData.length-c;s.UpdatePanes(h,c,a,f,!0);r&&s.UpdateFocusAfterInsertOrDeleteRows(e,t-1,!0);null!=i&&i()}})};e.prototype.NotifyDeleteRows=function(e,t){var r=this;this.editMgr.Unbind(function(){var i=r.GetClippedRangeInfo(e,t);r.bDeletingOrInsertingRows=!0;var s=r.vertScrollBar.GetTopItemIdx(),o=s+Math.max(Math.min(e-s,0),-t);r.UpdateRecordCount(-t,o);n.JsGridUtil.DebugAssert(r.vertScrollBar.GetTopItemIdx()<=o,"the scroll bar should never auto scroll down");var u=Math.max(o-r.vertScrollBar.GetTopItemIdx(),0);o=r.vertScrollBar.GetTopItemIdx();r.bDeletingOrInsertingRows=!1;if(i.clippedCount<1)r.RebuildKeyToPosMap();else{var a=r.vertScrollBar.GetItemDisplayCapacity(),f=o+a==r.recordCount+1&&r.vertScrollBar.PartialRowPresent(),l=r.rowData.length!==a,c=i.clippedRelViewIdx,h=Math.max(Math.min(c+i.clippedCount,r.rowData.length)-c,0);r.UpdatePanes(c,h,0,u,!0);var p=Math.max(Math.min(i.clippedCount,r.recordCount-r.rowData.length+u),0),d=Math.min(r.recordCount-(o+r.rowData.length),p);n.JsGridUtil.DebugAssert(d>=0,"Insert bottom count should not be negative.");r.UpdatePanes(0,0,r.rowData.length,d,!0);var v=p-d-u;v>0&&!l&&f&&v--;r.UpdatePanes(0,0,0,v,!0);r.UpdateFocusAfterInsertOrDeleteRows(e,t,!1)}})};e.prototype.UpdateFocusAfterInsertOrDeleteRows=function(e,t,n){this.panes.each("UpdateFocusAfterInsertOrDeleteRows",e,t,n)};e.prototype.ScrollCellIntoView=function(e,t,n){var r=this.GetPane(n);null!=e&&this.vertScrollBar.ScrollIntoView(r.GetGridPaneConverter().RowIdxToViewIdx(e));null!=t&&r.ScrollColumnIntoViewHorizontally(t)};e.prototype.ScrollUpByOne=function(){this.vertScrollBar.ScrollUpByOne()};e.prototype.ScrollDownByOne=function(){this.vertScrollBar.ScrollDownByOne()};e.prototype.IsCellEditable=function(e,t,n){var r=this.GetPane(n).GetGridPaneConverter(),i=r.GetColumnByIdx(r.FieldKeyToColIdx(t));return this._objBag.editUtil.CanEditField(e,i,t)};e.prototype.Focus=function(){this.focusMgr.Focus()};e.prototype.GetMostRecentMouseDownCoordinates=function(){return this.mostRecentMouseDownCoords};e.prototype.StopEditing=function(e){this.editMgr.StopEditing(e)};e.prototype.UnbindEditing=function(e){this.editMgr.Unbind(e)};e.prototype.NotifyResize=function(){this.HandleParentResize()};e.prototype.GetTopRowIndex=function(e){return this.GetPane(e).BeginRowIdx()};e.prototype.GetLeftColumnIndex=function(e){return this.GetPane(e).BeginColIdx()};e.prototype.ShowColumn=function(e,t){this.gridPane.ShowColumn(e,t)};e.prototype.EnsurePaneWidth=function(){this.gridPane.EnsurePaneWidth()};e.prototype.HideColumn=function(e){this.gridPane.HideColumn(e)};e.prototype.RenameColumn=function(e,t){this.gridPane.RenameColumn(e,t)};e.prototype.DeleteColumn=function(e){this.gridPane.DeleteColumn(e)};e.prototype.UpdateColumns=function(e){this.gridPane.UpdateColumns(e)};e.prototype.GetColumns=function(e){return this.FilterColumns(this.GetPane(e).GetColumns(),[r.JsGridConstants.RecordIndicatorCheckboxColumnKey,"JSGrid_NewColumn"])};e.prototype.GetRecordIndicatorCheckBoxColumnIndex=function(){var e=this.GetPane(null);return e&&n.JsGridUtil.Internal.FindInArray(e.GetColumns(),function(e){return e.columnKey==r.JsGridConstants.RecordIndicatorCheckboxColumnKey})};e.prototype.ScrollToAndExpandNextError=function(e,t,n,i){var s=this,o=null==t?this._objBag.errorMgr.GetNextError(e,n):this._objBag.errorMgr.GetNextErrorForRecord(e,t,n);if(null!=o){var u,a=this.posConverter.RecordKeyToViewIdx(o.recordKey);if(null!=a){for(var f=0;f<this.panes.length&&null==u;f++){var l=this.panes[f];if((l.Id==r.JsGridConstants.PaneId.MainGrid||l.Id==r.JsGridConstants.PaneId.PivotedGrid)&&null==(u=o.type==y.ErrorType.Row?0:l.GetGridPaneConverter().FieldKeyToColIdx(o.fieldKey))){var c=l.FieldKeyToColumnKey(o.fieldKey);if(null!=c){l.ShowColumn(c,null);u=l.GetGridPaneConverter().FieldKeyToColIdx(o.fieldKey)}}}this.ScrollCellIntoView(a,u,l.Id);if(o.type==y.ErrorType.Cell&&null!=u){this.selectionMgr.SetFocusByKey(l,o.recordKey,o.fieldKey);!0!==i&&setTimeout(function(){s.editMgr.ExpandWidget(r.JsGridConstants.ErrorWidgetId)},0)}return o.id}}return null};e.prototype.FilterColumns=function(e,t){for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)if(e[r].columnKey==t[n]){e.splice(r,1);break}return e};e.prototype.ClearAllChangeIndications=function(){this.panes.each("NotifyChangeIndicatorsClearing");this.changeHighlightMgr.Clear()};e.prototype.GetFocusedItemInfo=function(){var e=this.selectionMgr.GetFocus();return null==e?null:{recordKey:e.recordKey,fieldKey:e.fieldKey,paneId:e.gridPane.Id}};e.prototype.JumpToEntryRecord=function(){if(this.bNewRowEnabled){var e=this._objBag.entryRecordMgr.GetLastEntryKey(),t=this.gridPane.GetColumns()[0].columnKey;this.gridPane.SelectByKey(e,e,t,t,!1);this.ScrollCellIntoView(this.posConverter.RecordKeyToViewIdx(e),0,this.gridPane.Id)}};e.prototype.GetSplitterPosition=function(){return null!=this.rightPane?this.splitterPos:0};e.prototype.SetSplitterPosition=function(e){this.SetSplitterPositionCore(e);this.LayoutChildElements()};e.prototype.Select=function(e,t,n,r,i,s){this.GetPane(s).Select(e,t,n,r,i)};e.prototype.SelectByKey=function(e,t,n,r,i,s){this.GetPane(s).SelectByKey(e,t,n,r,i)};e.prototype.GetOrderedSelections=function(e,t){return this.selectionMgr.GetOrderedSelections(this.GetPane(e),t)};e.prototype.NotifyCanEditUpdated=function(){this.panes.each("NotifyCanEditUpdated")};e.prototype.GetGridPane=function(){return this.gridPane};e.prototype.GetPane=function(e){var t=e==r.JsGridConstants.PaneId.MainGrid||null==e?this.gridPane:null;n.JsGridUtil.DebugAssert(null!=t,"Invalid PaneId ("+e+")");return t};e.prototype.SetSplitterPositionCore=function(e){null!=this.rightPane&&(this.splitterPos=Math.min(Math.max(e,this.CONST_minPaneWidth),this.GetControlWidth()-o.GetSystemScrollBarThickness()-(this.rightPane?this.CONST_minPaneWidth+r.JsGridConstants.Internal.SplitterWidth:0)))};e.prototype.GetControlWidth=function(){return Math.max(this.lastParentSize.width-2,this.CONST_minControlWidth)};e.prototype.GetControlHeight=function(){return Math.max(this.lastParentSize.height-2,this.CONST_minControlHeight)};e.prototype.AddSentinalColumns=function(e,t){var n=e;this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn&&(n=this.AddCreateColumn(n));return this.TryAddRecordIndicatorCheckboxesToColumns(n,t)};e.prototype.AddCreateColumn=function(e){var t="JSGrid_NewColumn";(this.gridFieldMap[t]=new v.GridField(t,!1,!1,r.JsGridConstants.TextDirection.Default,null,r.JsGridConstants.EditMode.ReadOnly)).SetSingleValuePropType(d.PropertyType.Utils.GetPropType("String"));if(n.JsGridUtil.Internal.IsFeatureEnabled(S)){var i;(i=new v.ColumnInfo("",null,t,150)).isResizable=!0;i.isSortable=!1;i.isHidable=!1;i.isAutoFilterable=!1;i.isFooter=!0;i.name="+ "+b.default.L_AddColumn_Text;i.bOpenMenuOnContentClick=!0;return new v.ColumnInfoCollection(e.GetColumnArray().concat([i]))}(i=new v.ColumnInfo("",null,t,r.JsGridConstants.Internal.IconColumnWidth)).isResizable=!1;i.isSortable=!1;i.isHidable=!1;i.isAutoFilterable=!1;i.isFooter=!0;i.name=this._fnGetLocStr("AddColumn");i.imgSrc=n.JsGridUtil.Internal.SiteUrl+"/_layouts/images/createview.gif";i.iconName="CalculatorAddition";i.isIconOnly=!0;i.bOpenMenuOnContentClick=!0;return new v.ColumnInfoCollection(e.GetColumnArray().concat([i]))};e.prototype.TryAddRecordIndicatorCheckboxesToColumns=function(e,t){var i=this,s=e;if(t){var o=r.JsGridConstants.RecordIndicatorCheckboxColumnKey,u=this.gridFieldMap[o]=new v.GridField(o,!1,!1,r.JsGridConstants.TextDirection.Default,null,r.JsGridConstants.EditMode.ReadOnly),a=n.JsGridUtil.Internal.object(d.PropertyType.Utils.GetPropType("CheckBoxBoolean"));a.ID="RecordIndicatorCheckBoxBoolean";a.GetDisplayValue=function(e,t,n){return i._objBag.checkSelMgr.IsRecordIndicatorCheckboxChecked(e.key())?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};d.PropertyType.RegisterNewDerivedCustomPropType(a,"CheckBoxBoolean");u.SetSingleValuePropType(a);var f=new v.ColumnInfo("",null,o,r.JsGridConstants.Internal.MinColumnWidth);f.isResizable=f.isSortable=f.isHidable=f.isAutoFilterable=f.isAutoFilterable=!1;f.fnGetDisplayControlName=function(){return i._objBag.gridControls[r.JsGridConstants.RecordIndicatorControlId].Id};s=new v.ColumnInfoCollection([f].concat(e.GetColumnArray()))}return s};e.prototype.Init=function(){};e.prototype.ScrollIntoViewVertically=function(e){return this.vertScrollBar.ScrollIntoView(e)};e.prototype.ScrollVerticallyByTouch=function(e){e?this.ScrollUpByOne():this.ScrollDownByOne()};e.prototype.SetRecordCount=function(e,t){this.recordCount=this.cleared?0:e+(this.bNewRowEnabled?this._objBag.entryRecordMgr.GetEntryRecords().length:0);this.vertScrollBar.Update({itemCount:this.recordCount,topItemIdx:t});return this.recordCount};e.prototype.UpdateRecordCount=function(e,t){this.recordCount+=e;this.vertScrollBar.Update({itemCount:this.recordCount,topItemIdx:t});return this.recordCount};e.prototype.GetClippedRangeInfo=function(e,t){var n=e,r=e+t-1;n=Math.max(0,Math.min(this.recordCount-1,n));r=Math.max(0,Math.min(this.recordCount-1,r));var i=this.posConverter.ViewIdxToRelViewIdx(n),s=this.posConverter.ViewIdxToRelViewIdx(r);return{clippedRelViewIdx:i=Math.max(i,0),clippedCount:(s=Math.min(s,this.vertScrollBar.GetItemDisplayCapacity()-1))-i+1}};e.prototype.CreateBorderHtmlElements=function(){this._parentNode.style.direction=this._objBag.RTL.ltr;this.borderElement=document.createElement("div");this.borderElement.style.width="100%";this._parentNode.appendChild(this.borderElement);this.touchMgr=new m.GridTouchManager(this.borderElement)};e.prototype.CreateLeftPaneHtmlElements=function(){this.leftPaneParent=document.createElement("div");this.leftPaneParent.id=this._jsGridElementId+"_leftpane";this.leftPaneParent.gridItem=!0;this.borderElement.appendChild(this.leftPaneParent);this.vertScrollBarContainer=document.createElement("div");this.vertScrollBarContainer.gridItem=!0;this.vertScrollBarContainer.style.cssText="display:none;";this.borderElement.appendChild(this.vertScrollBarContainer)};e.prototype.CreateDragHandle=function(){var e=n.JsGridUtil.Internal.IsFeatureEnabled(E),t=document.createElement("div");t.style.cssText=n.JsGridUtil.Internal.IsStickyColumnEnabled()?"":"position:absolute; visibility:hidden; top:0px; left:0px; width:0px; height:0px;";if(e){t.style.width=t.style.height="6px";t.classList.add(w.selectionDragHandle)}else{t.style.width=t.style.height="5px";t.style.cursor="crosshair"}if(n.JsGridUtil.Internal.IsStickyColumnEnabled()){var r=document.createElement("div");r.classList.add(w.selectionDragHandleContents);t.classList.add(w.selectionDragHandleContainer);t.classList.remove(w.selectionDragHandle);t.style.height=null;t.style.width="1px";t.appendChild(r);this._objBag.parentNode.insertBefore(t,this._objBag.parentNode.children[0])}else this._objBag.parentNode.appendChild(t);return t};e.prototype.CreateSelectionBorderHtmlElements=function(){var e=n.JsGridUtil.Internal.IsFeatureEnabled(E),t="position:absolute; visibility:hidden; top:0px; left:0px; width:0px; height:0px;",r=this.CreateDragHandle(),i={Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")};for(var s in i){var o=i[s];o.style.cssText=t;e&&this.AddFrameElementClassName(o,s);this._objBag.parentNode.appendChild(o)}var u={Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")};for(var s in u){var a=u[s];a.style.cssText=t;if(e){this.AddFrameElementClassName(a,s);a.style.borderWidth="2px";a.style.cursor="default"}else a.style["border"+s]=g.StyleUtil.MakeBorderString(1,"solid",this._objBag.styleMgr.gridPaneStyle.selectionRectBorderColor);this._objBag.parentNode.appendChild(a)}var f={Back:{Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")},Fore:{Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")}};for(var s in f){var l=void 0,c=void 0;e?c="Back"===s?w.solidBorder:w.dashedBorder:l="Back"==s?g.StyleUtil.MakeBorderString(2,"solid",this._objBag.styleMgr.gridPaneStyle.copyRectBackBorderColor):g.StyleUtil.MakeBorderString(2,"dashed",this._objBag.styleMgr.gridPaneStyle.copyRectForeBorderColor);for(var h in f[s]){var p=f[s][h];p.style.cssText=t;if(e){p.classList.add(c,w.copyFrame);this.AddFrameElementClassName(p,h)}else p.style["border"+h]=l;this._objBag.parentNode.appendChild(p)}}this.visualSelectionHtmlElements={selectionDragHandle:r,selectionFrames:i,focusFrames:u,copyFrames:f}};e.prototype.AddFrameElementClassName=function(e,t){switch(t){case"Top":e.classList.add(w.topFrameElement);break;case"Bottom":e.classList.add(w.bottomFrameElement);break;case"Left":e.classList.add(w.leftFrameElement);break;case"Right":e.classList.add(w.rightFrameElement)}};e.prototype.GetEffectiveHorizontalScrollBarHeight=function(){return this.bHorizontalScrollBarVisible?o.GetSystemScrollBarThickness():0};e.prototype.GetEffectiveVerticalScrollBarWidth=function(){return"none"!==this.vertScrollBarContainer.style.display?o.GetSystemScrollBarThickness():0};e.prototype.LayoutChildElements=function(e){this.SetSplitterPositionCore(this.splitterPos);var t=this.GetControlHeight();null!=this.vertScrollBar&&this.vertScrollBar.Update({physicalViewportSize:t-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),scrollbarSize:t});var n=this.GetControlWidth();if(null!=this.rightPaneParent){var i=this.splitterPos,s=n-(this.splitterPos+r.JsGridConstants.Internal.SplitterWidth+this.GetEffectiveVerticalScrollBarWidth());if(this._objBag.RTL.bEnabled){this.rightPane.paneSize.SetValues(s,this.GetEffectiveVerticalScrollBarWidth());this.gridPane.paneSize.SetValues(i,n-i)}else{this.gridPane.paneSize.SetValues(i,0);this.rightPane.paneSize.SetValues(s,n-this.GetEffectiveVerticalScrollBarWidth()-s)}}else{i=n-this.GetEffectiveVerticalScrollBarWidth();this.gridPane.paneSize.SetValues(i,this._objBag.RTL.bEnabled?this.GetEffectiveVerticalScrollBarWidth():0)}this.cleared||e||this.panes.each("OnResize");this.editMgr.NotifyMove()};e.prototype.HandleParentResize=function(){this.borderElement.style.display="none";if(!this.IsGridVisible()||this._parentNode.offsetHeight==this.lastParentSize.height&&this._parentNode.offsetWidth==this.lastParentSize.width)this.borderElement.style.display="";else{this.lastParentSize={height:this._parentNode.offsetHeight,width:this._parentNode.offsetWidth};this.borderElement.style.display="";n.JsGridUtil.Internal.DomElement.GetInstance().ForceIEZoomFactorRecomputation();var e=this.vertScrollBar.GetItemDisplayCapacity(),t=this.vertScrollBar.GetTopItemIdx();this.bResizingScrollbar=!0;this.LayoutChildElements();var r=this.GetControlHeight();this.vertScrollBar.SetViewportSize(r-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),!0,r-this.GetEffectiveHorizontalScrollBarHeight());this.bResizingScrollbar=!1;this.ModifyRowsForNewViewport(e,t)}};e.prototype.CoordinateHeights=function(){var e=this.headerHeight,t=this.rowHeight;this.headerHeight=this._minHeaderHeight?this._minHeaderHeight:0;this.headerHeight=Math.max(this.headerHeight,this.gridPane.GetMinHeaderHeight());if(this.rightPane){this.headerHeight=Math.max(this.headerHeight,this.rightPane.GetMinHeaderHeight());this.rightPane.SetHeaderHeight(this.headerHeight)}this.gridPane.SetHeaderHeight(this.headerHeight);this.rowHeight=this._minRowHeight?this._minRowHeight:0;this.rowHeight=Math.max(this.rowHeight,this.gridPane.GetMinRowHeight());if(this.rightPane){this.rowHeight=Math.max(this.rowHeight,this.rightPane.GetMinRowHeight());this.rightPane.SetRowHeight(this.rowHeight)}this.gridPane.SetRowHeight(this.rowHeight);e===this.headerHeight&&t===this.rowHeight||null==this.vertScrollBar||this.vertScrollBar.Update({physicalViewportSize:this.GetControlHeight()-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),scrollbarSize:this.GetControlHeight(),itemSize:this.rowHeight})};e.prototype.OnVerticalScrollbarVisibilityChanged=function(e){this.vertScrollBarContainer.style.display=e?"":"none";this.LayoutChildElements()};e.prototype.OnHorizontalGridPaneScrollBarVisibilityChange=function(e){this.bHorizontalScrollBarVisible=e;this.vertScrollBar.Update({bOtherScrollMeets:e,physicalViewportSize:this.GetControlHeight()-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight()})};e.prototype.OnVerticalScroll=function(e,t){var n=e.topIdx-t;0===n||this.bResizingScrollbar||this.bRefreshingAllRows||this.bDeletingOrInsertingRows||(n<0?this.ScrollUp(e.topIdx,-n):this.ScrollDown(e.topIdx,n))};e.prototype.ScrollDown=function(e,t){var n=this.vertScrollBar.GetItemDisplayCapacity(),r=e+n==this.recordCount+1&&this.vertScrollBar.PartialRowPresent(),i=Math.min(t,n),s=i-(r?1:0),o=n-i;this.UpdatePanes(0,i,o,s,!1)};e.prototype.ScrollUp=function(e,t){var n=this.vertScrollBar.GetItemDisplayCapacity(),r=this.rowData.length!==n,i=Math.min(Math.min(t,this.recordCount),n),s=i-(r?1:0),o=n-i;this.UpdatePanes(o,s,0,i,!1)};e.prototype.ModifyRowsForNewViewport=function(e,t){var r=this.vertScrollBar.GetItemDisplayCapacity(),i=r-e,s=this.vertScrollBar.GetTopItemIdx();if(i<0){var o=Math.max(this.rowData.length-r,0),u=this.rowData.length-o;this.UpdatePanes(u,o,null,0,!1)}else if(i>0){var a=t-s;n.JsGridUtil.DebugAssert(a>=0);this.UpdatePanes(null,0,0,a,!1);n.JsGridUtil.DebugAssert(i>=a);var f=i-a,l=this.rowData.length,c=this.posConverter.RelViewIdxToViewIdx(l);f=Math.min(c+f,this.recordCount)-c;this.UpdatePanes(null,0,l,f,!1)}};e.prototype.UpdatePanes=function(e,t,r,i,s){n.JsGridUtil.DebugAssert(t>=0&&i>=0);var o=null!=e&&t>0,u=null!=r&&i>0;if(o||u){var a=u&&i>0?this.posConverter.GetViewRecords(this.posConverter.RelViewIdxToViewIdx(r),i,this.RenderMissingRows).records:[];o&&this.rowData.splice(e,t);if(u){n.JsGridUtil.DebugAssert(null==this.rowData||0==this.rowData.length||null==a[0]||null==this.rowData[0]||this.rowData[0].recordKey!=a[0].recordKey,"Inserting duplicate key in rowData!");Array.prototype.splice.apply(this.rowData,[r,0].concat(a))}this.RebuildKeyToPosMap();this.panes.each("SpliceRows",e,t,r,a,s);this.editMgr.NotifyMove()}};e.prototype.RetryErrorRows=function(){this.RenderMissingRows(this.vertScrollBar.GetTopItemIdx(),this.rowData.length,!0)};e.prototype.RenderMissingRows=function(e,t,i,o){var u=this;if(void 0!==n.JsGridUtil.Internal.FindKey(this.rowData,function(e){return null==e})){var a=this.vertScrollBar.GetTopItemIdx(),f={};if(i&&a!=o){var l=this.posConverter.GetViewRecords(a,this.rowData.length,function(e,t,n){u.RenderMissingRows(e,t,n,a)}).records;for(h=0;h<this.rowData.length;h++)null==this.rowData[h]&&(f[h]=this.rowData[h]=l[h]);this.rowData=[].concat(this.rowData);this.RebuildKeyToPosMap()}else for(var c=new s.Range(e,e+t-1),h=0;h<this.rowData.length;h++)null==this.rowData[h]&&c.Contains(a+h)&&(f[h]=r.JsGridConstants.Internal.LoadErrorState);this.panes.each("RenderRows",f)}};e.prototype.RebuildKeyToPosMap=function(){this.keyToViewIdxMap={};for(var e=this.posConverter.GetTopViewIdx(),t=0;t<this.rowData.length;t++)null!=this.rowData[t]&&(this.keyToViewIdxMap[this.rowData[t].key()]=t+e)};e.prototype.GetCellValue=function(e,t,r){return{data:e.HasDataValue(t)?e.GetDataValue(t):n.JsGridUtil.EmptyValue,localized:null!=r&&null!=r.GetDisplayValue?r.GetDisplayValue(e,e.HasDataValue(t)?e.GetDataValue(t):null,e.HasLocalizedValue(t)?e.GetLocalizedValue(t):null):e.HasLocalizedValue(t)?e.GetLocalizedValue(t):n.JsGridUtil.EmptyValue}};e.prototype.IsGridVisible=function(){return this._parentNode.offsetHeight>0&&this._parentNode.offsetWidth>0};return e})();t.PaneManager=x;var T=(function(){function e(e,t){this._pangeMgr=t}e.prototype.SetValues=function(e,t){this.width=e;this.leftOffset=t};e.prototype.GetHeight=function(){return this._pangeMgr.GetControlHeight()};e.prototype.GetWidth=function(){return this.width};e.prototype.GetLeftOffset=function(){return this.leftOffset};e.prototype.Dispose=function(){};return e})();function N(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<this.length;++n){var r=this[n][e];r&&r.apply(this[n],t)}}});
define("jGe",["require","exports","eGe","cGe","sGe","ce","A"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SelectionType=n.JsGridConstants.SelectionType;t.SelectOp={Set:0,Append:1,ReplaceLast:2};t.RowSelectOp={Select:3,Unselect:4};var u=s.Killswitch.isActivated("86CDDB78-0503-4987-9214-48BC92A7E039","8/1/2019","Allow more commands in command bar in quick edit"),a={ODB:1725},f={ODB:1439},l=(function(){function e(e){this._fnOnFocusedCellChanged=e;this.Clear(!0)}e.prototype.SetAllowedSelectionTypes=function(e){this._allowedSelectionTypes=e};e.prototype.GetLastSelectionEndpoints=function(){return{rowIdx1:this._lastSelEndpt1.rowIdx,colIdx1:this._lastSelEndpt1.colIdx,rowIdx2:this._lastSelEndpt2.rowIdx,colIdx2:this._lastSelEndpt2.colIdx}};e.prototype.GetLastSelectionRangeNormalized=function(){return this._lastSelectionType==t.SelectionType.None?null:{rowRange:new i.Range(this._lastSelectionType!==t.SelectionType.ColumnRange?Math.min(this._lastSelEndpt1.rowIdx,this._lastSelEndpt2.rowIdx):0,this._lastSelectionType!==t.SelectionType.ColumnRange?Math.max(this._lastSelEndpt1.rowIdx,this._lastSelEndpt2.rowIdx):this._curFocus.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1),colRange:new i.Range(this._lastSelectionType!==t.SelectionType.RowRange?Math.min(this._lastSelEndpt1.colIdx,this._lastSelEndpt2.colIdx):0,this._lastSelectionType!==t.SelectionType.RowRange?Math.max(this._lastSelEndpt1.colIdx,this._lastSelEndpt2.colIdx):this._curFocus.gridPane.GetGridPaneConverter().GetVirtualColumnCount()-1)}};e.prototype.GetFocus=function(){return this.GetFocusForPaneInternal(null)};e.prototype.GetFocusForPane=function(e){return this.GetFocusForPaneInternal(e)};e.prototype.GetFocusedPane=function(){return this._curFocus.gridPane};e.prototype.SetFocusByKey=function(e,t,n){var r=e.GetGridPaneConverter().KeyToIdx(t,n);null!=r&&this.SetFocusByPos(e,r.rowIdx,r.colIdx)};e.prototype.SetFocusByPos=function(e,n,r){this.SelectRange(e,n,n,r,r,t.SelectOp.Set,!0,!1)};e.prototype.IsCellSelected=function(e,t,n){if(e!==this._curFocus.gridPane)return!1;for(var r=0;r<this._selectedRowRanges.length;r++)if(this._selectedRowRanges[r].Contains(t))return!0;for(r=0;r<this._selectedColRanges.length;r++)if(this._selectedColRanges[r].Contains(n))return!0;for(r=0;r<this._selectedCellRanges.length;r++)if(this._selectedCellRanges[r].rowRange.Contains(t)&&this._selectedCellRanges[r].colRange.Contains(n))return!0;return!1};e.prototype.IsRowSelected=function(e,t){if(e!==this._curFocus.gridPane)return!1;for(var n=0;n<this._selectedRowRanges.length;n++)if(this._selectedRowRanges[n].Contains(t))return!0;return!1};e.prototype.isRowContainsSelectedCell=function(e,t){if(e!==this._curFocus.gridPane)return!1;if(this.IsRowSelected(e,t))return!0;for(var n=0;n<this._selectedCellRanges.length;n++)if(this._selectedCellRanges[n].rowRange.Contains(t))return!0};e.prototype.IsOneCellSelected=function(e){return null!=e&&e.rowRange.begin==e.rowRange.end&&e.colRange.begin==e.colRange.end};e.prototype.GetComponentsWithin=function(e,t,n){if(e!==this._curFocus.gridPane)return new i.Set;for(var s={},o=function(e,t){if(!e.IsEmpty()&&!t.IsEmpty())for(var n=e.begin;n<=e.end;n++)for(var i=t.begin;i<=t.end;i++)s[r.JsGridUtil.Internal.MakeCellKey(n,i)]=1},u=0;u<this._selectedRowRanges.length;u++)o(this._selectedRowRanges[u].Intersect(t),n);for(u=0;u<this._selectedColRanges.length;u++)o(t,this._selectedColRanges[u].Intersect(n));for(u=0;u<this._selectedCellRanges.length;u++)o(this._selectedCellRanges[u].rowRange.Intersect(t),this._selectedCellRanges[u].colRange.Intersect(n));return new i.Set(s)};e.prototype.SelectRange=function(e,s,l,c,h,p,d,v){var m,g=this,y=!0;e.GetDelegateMgr().Apply(n.JsGridConstants.DelegateType.AllowSelectionChange,function(e){y=e});if(!y)return!1;null!=s&&s==l&&null!=c&&c==h&&d&&p==t.SelectOp.Set&&(m={rowIdx:s,colIdx:c});if(!(function(){var e=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._RowMask,r=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._ColMask,i=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._CellMask;do{var o=!1;switch(g.ComputeSelectionType(s,l,c,h)){case t.SelectionType.RowRange:switch(e){case n.JsGridConstants.SelectionTypeFlags.SingleRow:l=s;case n.JsGridConstants.SelectionTypeFlags.SingleRowRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoRows:return!1}break;case t.SelectionType.ColumnRange:switch(r){case n.JsGridConstants.SelectionTypeFlags.SingleCol:h=c;case n.JsGridConstants.SelectionTypeFlags.SingleColRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoCols:return!1}break;case t.SelectionType.CellRange:switch(i){case n.JsGridConstants.SelectionTypeFlags.SingleCell:l=s;h=c;case n.JsGridConstants.SelectionTypeFlags.SingleCellRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoCells:if(e!==n.JsGridConstants.SelectionTypeFlags.NoRows){c=h=null;o=!0}else{if(r===n.JsGridConstants.SelectionTypeFlags.NoCols)return!1;s=l=null;o=!0}}}}while(o);return!0})())return!1;g.ComputeSelectionType(s,l,c,h)==t.SelectionType.CellRange&&(Math.abs(c-h)+1==e.GetGridPaneConverter().GetVirtualColumnCount()?c=h=null:Math.abs(s-l)+1==e.GetGridPaneConverter().GetVirtualRowCount()&&(s=l=null));this._lastSelEndpt1={rowIdx:s,colIdx:c};this._lastSelEndpt2={rowIdx:l,colIdx:h};this.FirePreChangeNotifications(this._curFocus.gridPane,e);var b=this.GetFocus(),w=this.ComputeSelectionType(s,l,c,h);(function(n,i){if(e!==g._curFocus.gridPane){p=t.SelectOp.Set;g._curFocus.gridPane=e}if(v){var o=e.GetGridPaneConverter().KeyToIdx(n.recordKey,n.fieldKey);g._curFocus.rowIdx=o.rowIdx;g._curFocus.colIdx=o.colIdx}else if(null!=m){g._curFocus.rowIdx=m.rowIdx;g._curFocus.colIdx=m.colIdx}else{g._curFocus.rowIdx=i==t.SelectionType.ColumnRange?e.BeginRowIdx():s;g._curFocus.colIdx=i==t.SelectionType.RowRange?e.BeginColIdx():c}if(r.JsGridUtil.Internal.IsFeatureEnabled(a)&&r.JsGridUtil.Internal.IsFeatureEnabled(f))if(p===t.SelectOp.Set&&i===t.SelectionType.RowRange){g._rowSelectionFocusOrder=[];if(s<=l)for(var u=l;u>=s;u--)g._rowSelectionFocusOrder.push(u);else for(u=l;u<=s;u++)g._rowSelectionFocusOrder.push(u)}else if(p===t.RowSelectOp.Select)g._rowSelectionFocusOrder.push(s);else if(p===t.RowSelectOp.Unselect)if(n.rowIdx!==s){g._curFocus.rowIdx=n.rowIdx;g._rowSelectionFocusOrder.splice(g._rowSelectionFocusOrder.indexOf(s),1)}else{g._rowSelectionFocusOrder.pop();g._curFocus.rowIdx=g._rowSelectionFocusOrder[g._rowSelectionFocusOrder.length-1]}else g._rowSelectionFocusOrder=[]})(b,w);(function(n){r.JsGridUtil.DebugAssert(n!==t.SelectionType.None);var d,v=n==t.SelectionType.ColumnRange?null:new i.Range(s,l).Normalize(),m=n==t.SelectionType.RowRange?null:new i.Range(c,h).Normalize();if(p==t.SelectOp.Set){g._selectedRowRanges=[];g._selectedColRanges=[];g._selectedCellRanges=[];g._orderedSelections=[]}else if(p==t.SelectOp.ReplaceLast){g._lastSelectionType==t.SelectionType.RowRange?g._selectedRowRanges.pop():g._lastSelectionType==t.SelectionType.ColumnRange?g._selectedColRanges.pop():g._lastSelectionType==t.SelectionType.CellRange&&g._selectedCellRanges.pop();g._orderedSelections.pop()}if(n==t.SelectionType.RowRange){d=v;if(r.JsGridUtil.Internal.IsFeatureEnabled(a)&&r.JsGridUtil.Internal.IsFeatureEnabled(f))if(p===t.RowSelectOp.Select){g._selectedCellRanges=[];g._selectedRowRanges.push(d)}else if(p===t.RowSelectOp.Unselect){var y=v.begin;if(1===g._selectedRowRanges.length){var b=g._selectedRowRanges[0];if(y===b.begin){var w=new i.Range(b.begin+1,b.end);g._selectedRowRanges=[w];g._lastSelEndpt1.rowIdx=w.begin;g._lastSelEndpt2.rowIdx=w.end}else if(y===b.end){w=new i.Range(b.begin,b.end-1);g._selectedRowRanges=[w];g._lastSelEndpt1.rowIdx=w.begin;g._lastSelEndpt2.rowIdx=w.end}else g._selectedRowRanges=[new i.Range(b.begin,y-1),new i.Range(y+1,b.end)]}else{for(var E=void 0,S=0;S<g._selectedRowRanges.length;S++)if(g._selectedRowRanges[S].Contains(y)){E=S;break}var x=g._selectedRowRanges[E];g._selectedRowRanges.splice(E,1);if(x.Size()>1){w=void 0;x.begin===y?w=new i.Range(x.begin+1,x.end):x.end===y&&(w=new i.Range(x.begin,x.end-1));w?g._selectedRowRanges.push(w):g._selectedRowRanges.push(new i.Range(x.begin,y-1),new i.Range(y+1,x.end))}if(1===g._selectedRowRanges.length){g._lastSelEndpt1.rowIdx=g._selectedRowRanges[0].begin;g._lastSelEndpt2.rowIdx=g._selectedRowRanges[0].end}}}else g._selectedRowRanges.push(d);else g._selectedRowRanges.push(d)}else if(n==t.SelectionType.ColumnRange){d=m;g._selectedColRanges.push(d)}else if(n==t.SelectionType.CellRange){d={rowRange:v,colRange:m};g._selectedCellRanges.push(d)}g._orderedSelections.push({type:n,range:d});g._lastSelectionType=n;if(!u&&e._objBag&&e._objBag.onSelectionChanged&&e.tableMgr){var T=e._objBag.jsGridParams.telemetry,N=void 0;T&&(N=new(T(o.Qos))({name:"QuickEditUpdateSelectionForCommandBar"}));try{var C=[],k=e.GetGridPaneConverter();for(S=0;S<g._selectedRowRanges.length;S++)for(var L=g._selectedRowRanges[S],A=L.begin;A<=L.end;A++){var O=k.RowIdxToRecordKey(A),M=e.tableMgr.GetRecordByKey(O);M&&M.fieldRawDataMap&&M.fieldRawDataMap.csrInfo&&C.push(M.fieldRawDataMap.csrInfo.ID)}e._objBag.onSelectionChanged(C);N&&N.end({resultType:o.ResultTypeEnum.Success})}catch(e){N&&N.end({resultType:o.ResultTypeEnum.Failure,resultCode:"FailToUpdateSelection",error:e.message})}}})(w);this.FirePostChangeNotifications(b,d);return!0};e.prototype.GetRowRanges=function(e){return e==this._curFocus.gridPane?this._selectedRowRanges:[]};e.prototype.GetColumnRanges=function(e){return e==this._curFocus.gridPane?this._selectedColRanges:[]};e.prototype.GetCellRanges=function(e){return e==this._curFocus.gridPane?this._selectedCellRanges:[]};e.prototype.Clear=function(e){var n;if(!e){this.FirePreChangeNotifications(this._curFocus.gridPane,null);n=this.GetFocus()}this._selectedRowRanges=[];this._selectedColRanges=[];this._selectedCellRanges=[];this._orderedSelections=[];this._curFocus={};this._rowSelectionFocusOrder=[];this._lastSelEndpt1=this._lastSelEndpt2=null;this._lastSelectionType=t.SelectionType.None;e||this.FirePostChangeNotifications(n,!1)};e.prototype.GetLastSelectionType=function(){return this._lastSelectionType};e.prototype.GetOrderedSelections=function(e,n){var i=function(e){for(var t=new Array(e.Size()),n=e.begin;n<=e.end;n++)t[n-e.begin]=u.RowIdxToRecordKey(n);return{begin:e.begin,end:e.end,keys:t}},s=function(e){for(var t=new Array(e.Size()),n=e.begin;n<=e.end;n++)-1===n&&r.JsGridUtil.Internal.IsFeatureEnabled(a)&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?t[n-e.begin]="SelectionRowHeaderCell":t[n-e.begin]=u.ColIdxToColKey(n);return{begin:e.begin,end:e.end,keys:t}},o=[];if(e==this._curFocus.gridPane)for(var u=e.GetGridPaneConverter(),f=0;f<this._orderedSelections.length;f++){var l=this._orderedSelections[f].type,c=this._orderedSelections[f].range;if(null==n||n==l)switch(l){case t.SelectionType.RowRange:o.push(i(c));break;case t.SelectionType.ColumnRange:o.push(s(c));break;case t.SelectionType.CellRange:var h=c;o.push({rowRange:i(h.rowRange),colRange:s(h.colRange)})}}return o};e.prototype.FirePreChangeNotifications=function(e,t){this._updatingReturnOld=null!=e?e.NotifySelectionUpdating():null;this._updatingReturnNew=null!=t?t!==e?t.NotifySelectionUpdating():this._updatingReturnOld:null};e.prototype.FirePostChangeNotifications=function(e,t){var n=this.GetFocus();null!=e&&e.gridPane.NotifySelectionUpdated(this._updatingReturnOld,t);null==n||null!=e&&n.gridPane===e.gridPane||n.gridPane.NotifySelectionUpdated(this._updatingReturnNew,t);(null==e&&null!=n||null!=e&&null==n||null!=e&&null!=n&&(e.recordKey!=n.recordKey||e.fieldKey!=n.fieldKey))&&this._fnOnFocusedCellChanged(r.JsGridUtil.EventArgs.CellFocusChanged(n&&n.recordKey,n&&n.fieldKey,e&&e.recordKey,e&&e.fieldKey))};e.prototype.ComputeSelectionType=function(e,n,r,i){return null==e||null==n?t.SelectionType.ColumnRange:null==r||null==i?t.SelectionType.RowRange:t.SelectionType.CellRange};e.prototype.GetFocusForPaneInternal=function(e){if(null==this._curFocus.gridPane||null!=e&&this._curFocus.gridPane!==e||this._curFocus.colIdx>=this._curFocus.gridPane.GetGridPaneConverter().GetVirtualColumnCount())return null;var t=this._curFocus.colIdx,n=!1;if(r.JsGridUtil.Internal.IsFeatureEnabled(a)&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===t){t=0;n=!0}var i=this._curFocus.gridPane.GetGridPaneConverter().IdxToKey(this._curFocus.rowIdx,t);return null==i.recordKey||null==i.fieldKey||null==i.columnKey?null:{rowIdx:this._curFocus.rowIdx,colIdx:this._curFocus.colIdx,recordKey:i.recordKey,fieldKey:n?"SelectionRowHeaderCell":i.fieldKey,columnKey:n?"SelectionRowHeaderCell":i.columnKey,gridPane:this._curFocus.gridPane,isSelectionCellFocused:n}};return e})();t.SelectionManager=l});
define("BGe",["require","exports","cGe","eGe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,n,r,i,o,u,a){this._thickness=f();this._arrowBoxSize=this._thickness-1;this._itemSizes=[];this._disabled=!1;this._partialRowPresent=!1;this._middleBoxLength=0;this._middleBoxLocation=0;this._topItemIdx=0;this._primitiveMgr=new s(e==t.ScrollBarType.Vertical,this);this._bOtherScrollMeets=r;this._type=e;this._optUpdateParams=i;this._bRTL=u;this.Init()}e.prototype.Init=function(){null!=this._optUpdateParams&&this.Update(this._optUpdateParams)};e.prototype.ComputeValidTopItemIdx=function(e){return Math.max(0,Math.min(e,null!=this._scrollableRows?this._scrollableRows:0))};e.prototype.ComputeValidTopItemIdxFromBottomIdx=function(e){var t=Math.max(Math.min(e,this._itemCount-1),0);return t-this.ComputeNumberOfRowsOnPage(null,t).count};e.prototype.ScrollToIdx=function(e,t,n,r){var i=this._topItemIdx;if(this._topItemIdx!==e||n){this._topItemIdx=e;this.ComputeScrollPosition(this._topItemIdx);null==this._fnOnScroll||i===this._topItemIdx&&!n||r||this._fnOnScroll(t,i);return!0}return!1};e.prototype.ScrollToBottomIdx=function(e,t,n){var r=this.ComputeValidTopItemIdxFromBottomIdx(e);return this.ScrollToIdx(r,new o(r,e,u.Bottom),t,n)};e.prototype.ScrollToTopIdx=function(e,t,n){var r=this.ComputeValidTopItemIdx(e);return this.ScrollToIdx(r,new o(r,this.ComputeNumberOfRowsOnPage(r,null),u.Top),t,n)};e.prototype.ComputeRemainingSpace=function(){return Math.max(0,this.GetTotalScrollableDistance()-this._middleBoxLocation-this._middleBoxLength)};e.prototype.GetTotalScrollableDistance=function(){return this._length-2*this._arrowBoxSize-4};e.prototype.ComputeNumberOfRowsOnPage=function(e,t){for(var r,i=null!=e?e:t,s=null==e,o=0,u=0!==this._itemSizes.length?n.JsGridUtil.Internal.UpperBound(this._itemSizes,i,"pos")-1:-1;o<this._physicalViewportSize&&i>=0&&i<this._itemCount;){null==r&&-1!==u&&u<this._itemSizes.length&&(r=this._itemSizes[u]);o+=null!=r&&i==r.pos?r.size:this._itemSize;if(null!=r&&i==r.pos){u+=s?-1:1;r=null}i+=s?-1:1}var a=o!==this._physicalViewportSize;return{count:Math.max(Math.abs((null!=e?e:t)-i)-(a?1:0),0),partial:a}};e.prototype.GetPartialItemDisplayCapacity=function(){return this._itemCount};e.prototype.GetWholeItemDisplayCapacityInternal=function(){return this._itemCount};e.prototype.ComputeBottomIdx=function(){return this.ComputeNumberOfRowsOnPage(this._topItemIdx,null).count};e.prototype.TopIndexToPixelOffset=function(e){this._bRTL&&this._type==t.ScrollBarType.Horizontal&&(e=this._scrollableRows-e);return Math.floor(this._scrollablePixels/this._scrollableRows*e)};e.prototype.PixelOffsetToTopIndex=function(e){this._bRTL&&this._type==t.ScrollBarType.Horizontal&&(e=this._scrollablePixels-e);return this._scrollablePixels>0?this.ComputeValidTopItemIdx(Math.round(e/(this._scrollablePixels/this._scrollableRows))):0};e.prototype.ComputeScrollPosition=function(e){this._middleBoxLocation=this._scrollableRows>0?this.TopIndexToPixelOffset(e):0;this._primitiveMgr.UpdateBGDiv("bgAboveBox",this._middleBoxLocation+1);this._primitiveMgr.SetTop("middleBoxDiv",this._middleBoxLocation+this._arrowBoxSize);this._primitiveMgr.UpdateBGDiv("bgBelowBox",this.ComputeRemainingSpace()+1)};e.prototype.Dispose=function(){this._renderedBar&&n.JsGridUtil.ClearEventListeners(this._renderedBar);this._eventToDispose&&document.body.removeEventListener("mousemove",this._eventToDispose);this._primitiveMgr.Dispose();this._renderedBar=null};e.prototype.SetOnVisibilityChanged=function(e,t){this._fnOnVisibilityChanged=e;null!=this._fnOnVisibilityChanged&&t!==!this._disabled&&this._fnOnVisibilityChanged(!this._disabled)};e.prototype.Update=function(e){this._itemCount=null==e.itemCount?this._itemCount:e.itemCount;this._itemSize=null==e.itemSize?this._itemSize:e.itemSize;this._bOtherScrollMeets=null==e.bOtherScrollMeets?this._bOtherScrollMeets:e.bOtherScrollMeets;return!1};e.prototype.GetItemDisplayCapacity=function(){return this.GetPartialItemDisplayCapacity()};e.prototype.GetWholeItemDisplayCapacity=function(){return this.GetWholeItemDisplayCapacityInternal()};e.prototype.GetTopItemIdx=function(){return this._topItemIdx};e.prototype.Refresh=function(){this.ComputeScrollPosition(this._topItemIdx)};e.prototype.ScrollIntoView=function(e){e=Math.max(0,Math.min(this._itemCount-1,e));var n=this.GetItemDisplayInfo(e);if(n==t.ScrollBarRowDisplayInfo.Before){this.ScrollToTopIdx(e);return!0}if(n==t.ScrollBarRowDisplayInfo.After||n==t.ScrollBarRowDisplayInfo.Partial){this.ScrollToTopIdx(e+1-this.GetWholeItemDisplayCapacity());return!0}return!1};e.prototype.ScrollUpByOne=function(){this.Update({topItemIdx:this._topItemIdx-1})};e.prototype.ScrollDownByOne=function(){this.Update({topItemIdx:this._topItemIdx+1})};e.prototype.PartialRowPresent=function(){return this._partialRowPresent};e.prototype.GetVisibleItemCount=function(){};e.prototype.SetOnScroll=function(e){this._fnOnScroll=e};e.prototype.SetViewportSize=function(){};e.prototype.GetItemDisplayInfo=function(e){var n=this.GetWholeItemDisplayCapacity(),r=this.GetPartialItemDisplayCapacity();return n!==r?e<this._topItemIdx?t.ScrollBarRowDisplayInfo.Before:e>this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.After:e==this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.Partial:t.ScrollBarRowDisplayInfo.InView:e<this._topItemIdx?t.ScrollBarRowDisplayInfo.Before:e>this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.After:t.ScrollBarRowDisplayInfo.InView};return e})();t.ScrollBar=i;var s=(function(){function e(e,t){this._activeColors={outerBorder:{mouseDown:"#737A83",mouseOver:"#8A8D91",mouseOut:"#B7BABE"},innerBorder:{mouseDown:"#C3C6CA",mouseOver:"#DADBDD",mouseOut:"#F0F1F4"},shade:{mouseDown:"#969BA2",mouseOver:"#CACCD0",mouseOut:"#E8EBEE"},main:{mouseDown:"#868C93",mouseOver:"#B3B6BB",mouseOut:"#DFE3E8"}};this._renderedItemDivs={};this._bIsVert=e;this._scrollBar=t;this._thicknessCssString=e?"width":"height";this._lengthCssString=e?"height":"width";this._cssNamePreFix=e?"vert-":"horiz-";this._upSideCssName=e?"top":"left";this._leftSideCssName=e?"left":"top";this._arrowDivClass=e?"clip9x6":"clip6x9";this._upArrowInactiveImgClass="jsgridcluster_scrollbar-mouseout-"+(e?"uparrow":"leftarrow");this._downArrowInactiveImgClass="jsgridcluster_scrollbar-mouseout-"+(e?"downarrow":"rightarrow");this._upArrowActiveImgClass="jsgridcluster_scrollbar-mousein-"+(e?"uparrow":"leftarrow");this._downArrowActiveImgClass="jsgridcluster_scrollbar-mousein-"+(e?"downarrow":"rightarrow")}e.prototype.Dispose=function(){this._renderedItemDivs=null};e.prototype.GetThicknessCssString=function(e){return this._thicknessCssString+":"+e+"px;"};e.prototype.GetLengthCssString=function(e){return this._lengthCssString+":"+e+"px;"};e.prototype.GetLengthAndThicknessCssString=function(e,t){return this.GetLengthCssString(e)+this.GetThicknessCssString(t)};e.prototype.GetCssName=function(e,t){return this._cssNamePreFix+e+(t?" "+e:"")};e.prototype.RegisterPrimitives=function(e){for(var t=0;t<e.length;t++){var r=n.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(e[t],"elemid");null!=r&&(this._renderedItemDivs[r]=e[t])}};e.prototype.GetLocation=function(e){return n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._renderedItemDivs[e])};e.prototype.GetHeight=function(e){return this._renderedItemDivs[e].offsetHeight};e.prototype.GetWidth=function(e){return this._renderedItemDivs[e].offsetWidth};e.prototype.GetDomElem=function(e){return this._renderedItemDivs[e]};e.prototype.AppendItem=function(e,t){this._renderedItemDivs[e].appendChild(t);this.RegisterPrimitives(n.JsGridUtil.Internal.DomElement.GetInstance().FindChildrenWithProperty(this._renderedItemDivs[e],"id"))};e.prototype.GenerateBGDivHTML=function(e,t,n){var r=(this._scrollBar._thickness-4)/2;return['<div class="'+this.GetCssName("scroll-bar-bg-block",null)+'" style="'+(n?"position:relative;":"")+this.GetLengthCssString(e)+'" '+this.GetOptionalElemString("elemid",t,null)+">",'<div class="'+this.GetCssName("scroll-bar-background-shade",!0)+'" style="'+this.GetLengthAndThicknessCssString(e,Math.ceil(r))+'" '+this.GetOptionalElemString("elemid",t,"_shade")+"></div>",'<div class="'+this.GetCssName("scroll-bar-background-main",!0)+'" style="'+this.GetLengthAndThicknessCssString(e,Math.floor(r))+'" '+this.GetOptionalElemString("elemid",t,"_main")+"></div></div>"].join("")};e.prototype.GetOptionalElemString=function(e,t,n){return null==t?"":e+'="'+t+(null==n?"":n)+'"'};e.prototype.GenerateMiddleScroll=function(e){var t=document.createElement("div"),n=(this._scrollBar._thickness-6)/2,r=(this._scrollBar._thickness-6-5)/2;t.innerHTML=['<div style="position:relative;',this.GetThicknessCssString(this._scrollBar._thickness-6),';margin-top:1px;margin-left:1px;">','<div elemid="',e,'_shade" class="',this.GetCssName("scroll-bar-inner-box-shade",!0),'" style="',this.GetThicknessCssString(Math.floor(n)),';"></div>','<div elemid="',e,'_main" class="',this.GetCssName("scroll-bar-inner-box-main",!0),'" style="',this.GetThicknessCssString(Math.ceil(n)),';"></div>','<div elemid="',e,'_gripTop" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px"></div>','<div elemid="',e,'_gripMiddle" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px;"></div>','<div elemid="',e,'_gripBottom" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px"></div></div>'].join("");t.elemid=e;t.className=this.GetCssName("scroll-bar-outer-box",!0);t.style.cssText=this.GetThicknessCssString(this._scrollBar._thickness-4);return t};e.prototype.GenerateArrowDiv=function(e,t,i){var s=document.createElement("div"),o=(this._scrollBar._thickness-4-(this._bIsVert?6:9))/2,u=(this._scrollBar._thickness-4-(this._bIsVert?9:6))/2,a=this._bIsVert?i?SP.JsGrid.Res.upScrollbarLabel:SP.JsGrid.Res.downScrollbarLabel:i?SP.JsGrid.Res.leftScrollbarLabel:SP.JsGrid.Res.rightScrollbarLabel;s.innerHTML=['<div elemid="'+e+'_inner" class="scroll-bar-inner-arrow-cell" style="'+this.GetLengthAndThicknessCssString(this._scrollBar._thickness-4,this._scrollBar._thickness-4)+'">','<div class="'+this._arrowDivClass+'" style="margin-top:'+(this._bIsVert?i?Math.floor(o):Math.ceil(o):Math.round(o))+"px;margin-left:"+(this._bIsVert?Math.round(u):i?Math.floor(u):Math.ceil(u))+'px;"><img elemid="'+e+'_img" src="'+n.JsGridUtil.Internal.SiteUrl+r.JsGridConstants.ImagesDirectory+'jsgridcluster.png" class="'+this.GetCssName("scroll-bar-arrow",null)+" "+(i?this._upArrowInactiveImgClass:this._downArrowInactiveImgClass)+'" role="button" aria-label="'+a+'" />',"</div>","</div>"].join("");s.elemid=e;s.className=this.GetCssName("scroll-bar-arrow-cell",!0);s.style.cssText=(this._bIsVert?"top:":"left:")+t+"px;"+this.GetLengthAndThicknessCssString(this._scrollBar._thickness-2,this._scrollBar._thickness-2);return s};e.prototype.UpdateBGDiv=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t+"px";this._renderedItemDivs[e+"_shade"].style[this._lengthCssString]=t+"px";this._renderedItemDivs[e+"_main"].style[this._lengthCssString]=t+"px"};e.prototype.UpdateMiddleScroll=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t-2+"px";var n=t-4;this._renderedItemDivs[e+"_main"].style[this._lengthCssString]=n+"px";this._renderedItemDivs[e+"_shade"].style[this._lengthCssString]=n+"px";var r=Math.round(Math.max(n-8,0)/2);this._renderedItemDivs[e+"_gripTop"].style[this._upSideCssName]=r+"px";this._renderedItemDivs[e+"_gripMiddle"].style[this._upSideCssName]=r+3+"px";this._renderedItemDivs[e+"_gripBottom"].style[this._upSideCssName]=r+6+"px"};e.prototype.UpdateDisplay=function(e,t){this._renderedItemDivs[e].style.display=t?"block":"none"};e.prototype.ActivateArrowDiv=function(e,t,n,r){this._renderedItemDivs[e+"_img"].className=this.GetCssName("scroll-bar-arrow",null)+" "+(n?this._upArrowActiveImgClass:this._downArrowActiveImgClass);this.ActivateDiv(e,r,t)};e.prototype.DeactivateArrowDiv=function(e,t,n){this._renderedItemDivs[e+"_img"].className=this.GetCssName("scroll-bar-arrow",null)+" "+(n?this._upArrowInactiveImgClass:this._downArrowInactiveImgClass);this.DeactivateDiv(e,t)};e.prototype.MarkMouseDown=function(e,t){this._renderedItemDivs[e].curStateName="mouseDownPending"};e.prototype.RemoveMouseDown=function(e,t,n){this._renderedItemDivs[e].curStateName=""};e.prototype.ActivateDiv=function(e,t,r){var i=this._renderedItemDivs[e];if("mouseDown"!=i.curStateName){var s="mouseDownPending"==i.curStateName?"mouseDown":n.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,i,null)?"mouseOver":"mouseOut";if(i.curStateName!==s){i.style.borderColor=this._activeColors.outerBorder[s];e+"_inner"in this._renderedItemDivs?this._renderedItemDivs[e+"_inner"].style.borderColor=this._activeColors.innerBorder[s]:this._renderedItemDivs[e].style.backgroundColor=this._activeColors.innerBorder[s];this._renderedItemDivs[(null!=r?r:e)+"_shade"].style.backgroundColor=this._activeColors.shade[s];this._renderedItemDivs[(null!=r?r:e)+"_main"].style.backgroundColor=this._activeColors.main[s];i.curStateName=s}}};e.prototype.DeactivateDiv=function(e,t){this._renderedItemDivs[e].curStateName="";this._renderedItemDivs[e].style.borderColor="";e+"_inner"in this._renderedItemDivs?this._renderedItemDivs[e+"_inner"].style.borderColor="":this._renderedItemDivs[e].style.backgroundColor="";this._renderedItemDivs[(null!=t?t:e)+"_shade"].style.backgroundColor="";this._renderedItemDivs[(null!=t?t:e)+"_main"].style.backgroundColor=""};e.prototype.HighlightBGDiv=function(e){this._renderedItemDivs[e+"_main"].style.backgroundColor="#DEDFE2";this._renderedItemDivs[e+"_shade"].style.backgroundColor="#DEDFE2"};e.prototype.RestoreBGDiv=function(e){this._renderedItemDivs[e+"_shade"].style.backgroundColor="";this._renderedItemDivs[e+"_main"].style.backgroundColor=""};e.prototype.SetTop=function(e,t){this._renderedItemDivs[e].style[this._upSideCssName]=t+"px"};e.prototype.SetLength=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t+"px"};return e})(),o=function(e,t,n){this.topIdx=e;this.bottomIdx=t;this.userSetType=n},u={Bottom:0,Top:1},a=function(){this.itemSizes={};this.bClearItemSizes=!1;this.bMergeItemSizes=!1;this.bUpdateWhileDragging=!1};t.UpdateParams=a;t.ScrollBarType={Horizontal:0,Vertical:1};t.ScrollBarRowDisplayInfo={Before:-1,InView:0,Partial:1,After:2};function f(){var e=document.createElement("div"),t=document.createElement("div");e.style.cssText="overflow-x:scroll;position:absolute;visibility:hidden";t.style.cssText="height:50px;width:50px";e.appendChild(t);document.body.appendChild(e);var n=Math.max(e.offsetHeight-50,13);document.body.removeChild(e);f=function(){return n};return n}t.GetSystemScrollBarThickness=f;t.GetMinScrollBarLength=function(){return 2*f()+12+8+2}});
define("NGe",["require","exports","sGe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this.Clear()}e.prototype.AddCell=function(e,t){var n=this.Hash(e,t);this._cells.Add(n)};e.prototype.Clear=function(){this._cells=new n.Set};e.prototype.IsCellIn=function(e,t){return this._cells.Contains(this.Hash(e,t))};e.prototype.Hash=function(e,t){return[e,t].join()};return e})();t.ChangeHighlightManager=r});
define("HGe",["require","exports","lC","cGe","eGe","RGe","dGe","ce","Ih","qr","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c=l.panemgr_9;l=l.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var h=1,p=2,d=3,v={ODB:1725},m={ODB:1892},g={ODB:1507},y=u.Killswitch.isActivated("7735945e-c4b7-4456-bc23-590e84ff2ae8","4/09/2020","fix escape to actually close editors"),b=u.Killswitch.isActivated("8a1e846d-3209-4f04-b6f5-2b40e35f5724","4/09/2020","fix escape to close hyperlink editor"),w=u.Killswitch.isActivated("7e38e73e-5d98-4a58-859f-384c19175e94","4/09/2020","fix escape to close multiperson editor"),E=(function(){function e(e,t,n){this._curState=h;this._widgetIcons={};this._stateTransitionManager=new x(this);this._objBag=e;this._fnUpdateProperties=t;this._fnGetCellValue=n;this._telemetry=e&&e.jsGridParams&&e.jsGridParams.telemetry;this._baseEngagementData=e&&e.jsGridParams&&e.jsGridParams.baseEngagementData;this.errorMgr=e.errorMgr;this.actorsParentNode=e.parentNode;this._widgetDock=this.CreateWidgetDock();this._actorRegistrationManager=new s.EditActorsRegistrationManager(e,this.actorsParentNode,this.GetEditControlManagerAPI.bind(this),this.GetWidgetControlManagerAPI.bind(this),this.OnRegisterWidgetControl.bind(this));e.eventMgr.AttachEvent(i.JsGridConstants.EventType.OnCellErrorStateChanged,this.RecalculateWidgets.bind(this))}e.prototype.unBindEditors=function(){if(null!==this._curActorsAPI&&void 0!==this._curActorsAPI)for(var e=0;e<this._curActorsAPI.length;e++)this._curActorsAPI[e].actor.Unbind()};e.prototype.logEngagement=function(e){this._telemetry&&this._telemetry(a.default).logData(n.__assign(n.__assign({},this._baseEngagementData),{name:e,extraData:f.graft(this._baseEngagementData.extraData,{fieldType:this._curField.csrInfo.FieldType})}))};e.prototype.WidgetControlGridContext=function(e){return new T(e,this._objBag,this)};e.prototype.WidgetControlCellContext=function(e){var t=this,n=new N(e,this);n.NotifyExpandWidget=function(){t.NotifyExpandWidget(e)};n.NotifyCollapseWidget=function(){t.NotifyCollapseWidget(e)};n.NotifyEditComplete=function(n){n?t.NotifyWidgetEditCancel(e):t.NotifyEditCompleteInternal(n)};return n};e.prototype.GetWidgetControlManagerAPI=function(e,t){var n=this;return new C(e,t,function(){return n.WidgetControlGridContext(e)},function(){return n.WidgetControlCellContext(e)},this)};e.prototype.EditControlGridContext=function(e){var t=this,n=new T(e,this._objBag,this);n.OnActivateActor=function(){t.OnActivateActorInternal(e)};n.OnDeactivateActor=function(){t.OnDeactivateActorInternal(e)};return n};e.prototype.EditControlCellContext=function(e){var t=this,n=new N(e,this);n.NotifyExpandControl=function(){t.NotifyExpandControl(e)};n.NotifyEditComplete=function(e){t.NotifyEditCompleteInternal(e)};n.Show=function(e,n){r.JsGridUtil.DebugAssert(null!=t._curGridPane&&null!=t._curTd,"Show edit html element only after actor has been bound to a cell.");e.style.position="absolute";r.JsGridUtil.DebugAssert(e.offsetParent==t.actorsParentNode,"Edit control element needs to be added to the parentNode sent through OnGridAttach, and positioned relative to it.");t._objBag.RTL.bEnabled&&(e.style.right=e.offsetParent.offsetWidth-(t._curTdRect.x+t._curTdRect.width)+1+"px");if(r.JsGridUtil.Internal.IsFeatureEnabled(v)){var i=n?0:2;e.style.left=t._curTdRect.x+i+"px";e.style.top=t._curTdRect.y+i+"px"}else{e.style.left=t._curTdRect.x+1+"px";e.style.top=t._curTdRect.y+1+"px"}e.style.visibility="inherit"};n.Hide=function(e){t._objBag.focusMgr.ChangeTextInputElementToFocusElement()||(e.style.visibility="hidden")};n.GetCurrentRect=function(){return t._curTdRect};n.GetCurrentTd=function(){return t._curTd};return n};e.prototype.GetEditControlManagerAPI=function(e,t){var n=this;return new C(e,t,function(){return n.EditControlGridContext(e)},function(){return n.EditControlCellContext(e)},this)};e.prototype.NotifyEditCompleteInternal=function(e){if(this.IsEditing()||this._stateTransitionManager.GetCurrentEndingState()==d){this._curGridPane.useCustomSelFrames=!1;this._stateTransitionManager.HandleStateTransition(p,!0,null,[e])}else if(this.IsBound()){this.CollapseAll(null);if(!e){this.logEngagement("QuickEdit.OnCellEditBegin");this._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditBegin,r.JsGridUtil.EventArgs.CellEditBegin(this._curRecord.key(),this._curField.key));var t=this.ApplyUserUpdatedValue();this.logEngagement("QuickEdit.onCellEditCompleted");this._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditCompleted,r.JsGridUtil.EventArgs.CellEditCompleted(this._curRecord.key(),this._curField.key,t,e))}var n=r.JsGridUtil.Internal.IsFeatureEnabled(m),s=r.JsGridUtil.Internal.IsFeatureEnabled(g);if("SPUser"===this._curPropType.ID||s&&"SPDateTime"===this._curPropType.ID||"DropdownBoolean"===this._curPropType.ID||this._curPropType.ID.endsWith("_Choice")||n&&this._curPropType.ID.endsWith("_Choice_MultiValue")||this._curPropType.ID.endsWith("_Lookup")||"Hyperlink"===this._curPropType.ID&&!b||"SPUser_MultiValue"===this._curPropType.ID&&!w){this._curGridPane.useCustomSelFrames=!1;this._curGridPane.HideSelectionFrames();this.Unbind(null);this._objBag.focusMgr.Focus()}}this._curActiveActorName=null};e.prototype.SetCellInfo=function(e,t){e.propType=this._curPropType;e.originalValue=this._originalValue;e.record=this._curRecord;e.column=this._curColumn;e.field=this._curField;e.fieldKey=this._curField.key;e.cellExpandSpace=this._curExpandSpace;if(t)e.cellRect=this._curTdRect;else{e.cellWidth=this._curTdRect.width-2;e.cellHeight=this._curTdRect.height-2;e.cellStyle=this._curStyle}};e.prototype.OnRegisterWidgetControl=function(e,t){var n=document.createElement("div");n.className=r.JsGridUtil.Internal.IsFeatureEnabled(v)?l.msGridWidgetCell:"jsgrid-widget-cell";n.appendChild(t.GetIcon());this._widgetIcons[e]=n;this._widgetDock.appendChild(n)};e.prototype.GetCurrentTdRect=function(){var e=null!=this._curTd.parentNode?this._curGridPane.GetTdCoordsRelativeToParentNode(this._curTd):null;return null!=e?{x:e.left,y:e.top,width:e.width,height:e.height}:null};e.prototype.GetCurrentViewportCoord=function(){return this._curGridPane.GetTableViewportRelativeToParentNode()};e.prototype.GetExpandSpace=function(e,t){return{top:e.y-t.top,right:t.right-e.x-e.width,bottom:t.bottom-e.y-e.height,left:e.x-t.left}};e.prototype.ApplyUserUpdatedValue=function(){var e,t=this,n=this.HaveNewLocalizedValue(),r=this.HaveNewDataValue();if(n||r){var i;i=n&&r?o.CreateValidatedPropertyUpdate(this._curRecord.key(),this._curField.key,this._userUpdatedValue.data,this._userUpdatedValue.localized):o.CreateUnvalidatedPropertyUpdate(this._curRecord.key(),this._curField.key,n?this._userUpdatedValue.localized:this._userUpdatedValue.data,n);this._userUpdatedValue={};e=this._fnUpdateProperties([i],"User Edit",null,function(e){t._lastChangeKey=e});this.RecalculateWidgets();this.UpdateOriginalValue(this.GetValueFromRecord())}else this._userUpdatedValue={};return e};e.prototype.HaveNewLocalizedValue=function(){var e=!1;if(this._originalValue.localized!==r.JsGridUtil.EmptyValue&&"localized"in this._userUpdatedValue){e=(null!=this._originalValue.localized?this._originalValue.localized:"")!==this._userUpdatedValue.localized}return e};e.prototype.HaveNewDataValue=function(){var e=!1;this._originalValue.data!==r.JsGridUtil.EmptyValue&&"data"in this._userUpdatedValue&&(e=!this._curField.CompareSingleDataEqual(this._userUpdatedValue.data,this._originalValue.data));return e};e.prototype.RecalculateWidgets=function(){if(this._curState>=p){var e=this._curWidgetControlsAPI.length>0&&this._curWidgetControlsAPI[0].name==i.JsGridConstants.ErrorWidgetId;if(e&&!this.errorMgr.CellHasError(this._curRecord.key(),this._curField.key)){(t=this._curWidgetControlsAPI[0]).name==this._expandedWidgetName&&this.CollapseWidget(t.name);t.actor.Unbind();this._curWidgetControlsAPI.splice(0,1);this.LayoutWidgets()&&(this._widgetIcons[t.name].style.visibility="hidden")}else if(!e&&this.TryAddErrorWidget(this._curRecord.key(),this._curField.key)){var t;(t=this._actorRegistrationManager.GetWidgetControlAPI(i.JsGridConstants.ErrorWidgetId)).SetCellInfo();t.actor.BindToCell(t.GetCellContext());this.LayoutWidgets()}}};e.prototype.UpdateOriginalValue=function(e){this._originalValue=e;this._curEditControlAPI.UpdateOriginalValue(e);for(var t in this._curWidgetControlsAPI)this._curWidgetControlsAPI[t].UpdateOriginalValue(e)};e.prototype.CreateWidgetDock=function(){var e=document.createElement("div");e.className=r.JsGridUtil.Internal.IsFeatureEnabled(v)?l.msGridWidgetDock:"jsgrid-widget-dock";e.style.display="none";this.actorsParentNode.appendChild(e);this._fnDisposeWidgetDockHandlers=r.JsGridUtil.Internal.DomElement.GetInstance().SetMouseHover(e,this.HighlightBorder.bind(this),this.ClearHighlightedWidgets.bind(this),this.HighlightWidgets.bind(this));e.addEventListener("click",this.OnClickWidgetDock.bind(this));e.addEventListener("mousedown",this.OnMouseDownWidgetDock.bind(this));return e};e.prototype.OnClickWidgetDock=function(e){if(e.button==i.JsGridConstants.MouseButton.leftButton)for(var t=r.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=0;n<this._curWidgetControlsAPI.length;n++){var s=this._widgetIcons[this._curWidgetControlsAPI[n].name];if(r.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,s,null)){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);this._expandedWidgetName!==this._curWidgetControlsAPI[n].name?this.ExpandWidgetInternal(this._curWidgetControlsAPI[n].actor):this.CollapseWidget(this._expandedWidgetName);break}}};e.prototype.OnCellSelectExpandWidget=function(){for(var e=0;e<this._curWidgetControlsAPI.length;e++)this._expandedWidgetName!==this._curWidgetControlsAPI[e].name?this.ExpandWidgetInternal(this._curWidgetControlsAPI[e].actor):this.CollapseWidget(this._expandedWidgetName)};e.prototype.OnMouseDownWidgetDock=function(e){e.stopPropagation()};e.prototype.HighlightBorder=function(){this._widgetDock.style.borderColor=null!=this._objBag.styleMgr.widgetDockHoverStyle.borderColor?this._objBag.styleMgr.widgetDockHoverStyle.borderColor:"#768290"};e.prototype.ClearHighlightedWidgets=function(){null==this._expandedWidgetName&&(this._widgetDock.style.borderColor=null!=this._objBag.styleMgr.widgetDockStyle.borderColor?this._objBag.styleMgr.widgetDockStyle.borderColor:"");for(var e=0;e<this._curWidgetControlsAPI.length;e++)this._curWidgetControlsAPI[e].name!==this._expandedWidgetName&&(this._widgetIcons[this._curWidgetControlsAPI[e].name].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"");this._highlightedWidgetName=null};e.prototype.HighlightWidgets=function(e){for(var t=r.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=0;n<this._curWidgetControlsAPI.length;n++){var i=this._widgetIcons[this._curWidgetControlsAPI[n].name];if(r.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,i,null)){if(this._highlightedWidgetName!==this._curWidgetControlsAPI[n].name){null!=this._highlightedWidgetName&&this._highlightedWidgetName!==this._expandedWidgetName&&(this._widgetIcons[this._highlightedWidgetName].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"");this._highlightedWidgetName=this._curWidgetControlsAPI[n].name;this._curWidgetControlsAPI[n].name!==this._expandedWidgetName&&(i.style.backgroundColor=null!=this._objBag.styleMgr.widgetDockHoverStyle.backgroundColor?this._objBag.styleMgr.widgetDockHoverStyle.backgroundColor:"#C4C9CF")}break}}};e.prototype.LayoutWidgets=function(){if(null!=this._curTdRect&&null!=this._curPaneRect){var e=this._curTdRect,t=this._curPaneRect;if(this._curWidgetControlsAPI.length>0)if(r.JsGridUtil.Internal.IsFeatureEnabled(v)&&!r.JsGridUtil._errorWidgetInstantOpenKillSwitchIsActive&&this._curWidgetControlsAPI[0].name===i.JsGridConstants.ErrorWidgetId)this.OnCellSelectExpandWidget();else{for(var n=20*this._curWidgetControlsAPI.length,s=this._objBag.RTL.bEnabled?e.x-(n+2)>=t.left:e.x+e.width+5+(n+2)>t.right,o=e.y+Math.floor((e.height-22)/2),u=s?e.x-(n+2+5):e.x+5+e.width,a=0;a<this._curWidgetControlsAPI.length;a++){var f=this._widgetIcons[this._curWidgetControlsAPI[a].name];f.style.left=20*a+"px";f.style.visibility=""}this._widgetDock.style.top=o+"px";this._widgetDock.style.left=u+"px";this._widgetDock.style.width=n+"px";this._widgetDock.style.display="block"}else this._widgetDock.style.display="none";return!0}return!1};e.prototype.GetValueFromRecord=function(){return this._curField&&this._fnGetCellValue(this._curRecord,this._curField.key,this._curPropType)};e.prototype.TryAddErrorWidget=function(e,t){var n=!1;if(this.errorMgr.CellHasError(e,t)){this._curWidgetControlsAPI.unshift(this._actorRegistrationManager.RegisterWidgetControl(i.JsGridConstants.ErrorWidgetId));n=!0}return n};e.prototype.ExpandActor=function(e){return this._actorRegistrationManager.IsActorWidget(e.name)?this.ExpandWidgetInternal(e.actor):this.ExpandControlInternal(e.actor)};e.prototype.PrepareForExpandWidget=function(e){this._valueBeforeWidgetEdit=this._updatedValue;this.CollapseAll(e);null!=this._expandedWidgetName&&this._expandedWidgetName!==e&&(this._widgetIcons[this._expandedWidgetName].style.backgroundColor="");this._widgetIcons[e].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockPressedStyle.backgroundColor?this._objBag.styleMgr.widgetDockPressedStyle.backgroundColor:"#8C8F93";null!=this._objBag.styleMgr.widgetDockPressedStyle.borderColor&&(this._widgetIcons[e].style.borderColor=this._objBag.styleMgr.widgetDockPressedStyle.borderColor);this._expandedWidgetName=this._lastExpandedActorName=e};e.prototype.CollapseWidget=function(e){this.ClearExpandedWidget(e);this._actorRegistrationManager.GetWidgetControlAPI(e).actor.Collapse()};e.prototype.ClearExpandedWidget=function(e){if(e==this._expandedWidgetName){this._widgetIcons[e].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"";null!=this._objBag.styleMgr.widgetDockStyle.borderColor&&(this._widgetIcons[e].style.borderColor=this._objBag.styleMgr.widgetDockStyle.borderColor);this._expandedWidgetName=null}};e.prototype.ExpandWidgetInternal=function(e){if(null!=e.Expand){e.Expand();return!0}return!1};e.prototype.PrepareForExpandControl=function(e){this.CollapseAll(e);this._lastExpandedActorName=e};e.prototype.ExpandControlInternal=function(e){if(null!=e.Expand){e.Expand();return!0}return!1};e.prototype.CollapseAll=function(e){for(var t=0;t<this._curWidgetControlsAPI.length;t++)this._curWidgetControlsAPI[t].name!==e&&this.CollapseWidget(this._curWidgetControlsAPI[t].name);null!=this._curEditControlAPI.actor.Collapse&&this._curEditControlAPI.name!==e&&this._curEditControlAPI.actor.Collapse()};e.prototype.SetCurrentValueInternal=function(e,t,n){this._userUpdatedValue={};if("localized"in e&&e.localized!==r.JsGridUtil.EmptyValue){this._updatedValue.localized=e.localized;t==i.JsGridConstants.EditActorUpdateType.Uncommitted&&(this._userUpdatedValue.localized=e.localized)}if("data"in e&&e.data!==r.JsGridUtil.EmptyValue){this._updatedValue.data=e.data;t==i.JsGridConstants.EditActorUpdateType.Uncommitted&&(this._userUpdatedValue.data=e.data)}if(null!=this._curActorsAPI)for(var s=0;s<this._curActorsAPI.length;s++)n!==this._curActorsAPI[s].name&&this._curActorsAPI[s].actor.OnValueChanged(this._updatedValue,t)};e.prototype.OnActivateActorInternal=function(e){this.TrackActiveActor(!0,e)};e.prototype.OnDeactivateActorInternal=function(e){var t=this;setTimeout(function(){t.TrackActiveActor(!1,e)},0)};e.prototype.TrackActiveActor=function(e,t){e||null==this._curActiveActorName||t!=this._curActiveActorName?e&&(this._curActiveActorName=t):this.StopEditing(!1)};e.prototype.Unbind=function(e){this._stateTransitionManager.HandleStateTransition(h,!0,e,null)};e.prototype.StopEditing=function(e){var t=this._actorRegistrationManager.GetActorAPI(this._curActiveActorName)||this._curEditControlAPI;if(null!=t){t.NotifyEditComplete(e);r.JsGridUtil.Internal.IsFeatureEnabled(v)&&this._curGridPane&&this._curGridPane.selectionDragHandle.classList.remove(c.editorIsActive)}};e.prototype.BindToCell=function(e,t,n,r,i,s,o,u){this._stateTransitionManager.HandleStateTransition(p,!1,u,[e,t,n,r,i,s,o])};e.prototype.BeginEdit=function(e,t){this._isInQuickEditMode="keypress"==e.type;this._stateTransitionManager.HandleStateTransition(d,!1,t,[e]);r.JsGridUtil.Internal.IsFeatureEnabled(v)&&this._curGridPane.selectionDragHandle.classList.add(c.editorIsActive)};e.prototype.IsBoundToCell=function(e,t,n){return this._curState>=p&&this._curGridPane==e&&this._curRecord.key()==t&&this._curField.key==n};e.prototype.IsBound=function(){return this._curState>=p};e.prototype.IsEditing=function(){return this._curState>=d};e.prototype.NotifyMove=function(e){if(!this._objBag.jsGridObj.paneMgr.gridPane.dontReflow&&(null==e||e===this._curGridPane)&&this._curState>=p){var t=this._curGridPane.GetFocusedCell(),n=t&&t.GetTd();if(null!=n&&null!=this._curTd&&this._curRecord.key()==t.GetRecordKey()&&this._curField.key==t.GetFieldKey()){this._curTd=n;this._curTdRect=this.GetCurrentTdRect();if(null!=this._curTdRect){this._curPaneRect=this.GetCurrentViewportCoord();this._curExpandSpace=this.GetExpandSpace(this._curTdRect,this._curPaneRect);this._curEditControlAPI.SetCellInfo();this._curEditControlAPI.actor.OnCellMove();for(var r=0;r<this._curWidgetControlsAPI.length;r++){this.CollapseWidget(this._curWidgetControlsAPI[r].name);this._curWidgetControlsAPI[r].SetCellInfo()}this.LayoutWidgets()}}else null==n&&null!=this._curTd&&this.Unbind(null)}};e.prototype.NotifyUpdateProperty=function(e,t,n,r,s){if(this.IsBoundToCell(e,t,n)){var o={};r.HasDataValue()&&(o.data=r.data);r.HasLocalizedValue()&&(o.localized=r.localized);this.UpdateOriginalValue(o);(null==this._lastChangeKey||null!=s&&0!==s.CompareTo(this._lastChangeKey))&&this.SetCurrentValueInternal(o,i.JsGridConstants.EditActorUpdateType.Committed,null)}};e.prototype.ExpandWidget=function(e){var t=r.JsGridUtil.Internal.FindInArray(this._curWidgetControlsAPI,function(t){return t.name==e});null!=t&&this.ExpandWidgetInternal(this._curWidgetControlsAPI[t].actor)};e.prototype.ExpandNextActor=function(){var e=this;if(this._curState>=p&&(null!=this._curEditControlAPI.actor.Expand||this._curWidgetControlsAPI.length)){var t=(function(t){if(0==e._curActorsAPI.length||null==e._curActorsAPI[0].actor.Expand&&1==e._curActorsAPI.length)return null;var n,r=null!=e._curActorsAPI[0].actor.Expand?0:1;if(null==e._lastExpandedActorName)n=e._curActorsAPI[r];else for(var i=r;i<e._curActorsAPI.length;i++)if(e._curActorsAPI[i].name==e._lastExpandedActorName){n=t?i==e._curActorsAPI.length-1?e._curActorsAPI[r]:e._curActorsAPI[i+1]:i==r?e._curActorsAPI[e._curActorsAPI.length-1]:e._curActorsAPI[i-1];break}return n})(!0);r.JsGridUtil.DebugAssert(null!=t&&null!=t.actor.Expand);return this.ExpandActor(t)}return!1};e.prototype.NotifyExpandWidget=function(e){this.OnActivateActorInternal(e);this.PrepareForExpandWidget(e)};e.prototype.NotifyCollapseWidget=function(e){this.OnDeactivateActorInternal(e);this.ClearExpandedWidget(e)};e.prototype.NotifyWidgetEditCancel=function(e){this._updatedValue=this._valueBeforeWidgetEdit;this._curActiveActorName=null;this.CollapseWidget(e);this.IsEditing()?this._curEditControlAPI.actor.Focus():this._objBag.focusMgr.Focus()};e.prototype.NotifyExpandControl=function(e){this.PrepareForExpandControl(e)};e.prototype.SetCurrentValue=function(e,t){this.SetCurrentValueInternal(t,i.JsGridConstants.EditActorUpdateType.Uncommitted,e)};e.prototype.OnActorKeyDown=function(e,t){var n=this;r.JsGridUtil.DebugAssert(this._curState>=p);if((function(){var t=!1;if(e.keyCode==i.JsGridConstants.Key.tab||e.keyCode==i.JsGridConstants.Key.enter){n.StopEditing(!1);n._objBag.focusMgr.HandleKeyDown(e);t=!0}else if(e.keyCode==i.JsGridConstants.Key.esc){n.StopEditing(!0);y||n.StopEditing(!0);t=!0}return t})())r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);else if(this._curState==p&&t==this._curEditControlAPI.name)this.BeginEdit(e,null);else{var s=!1,o=t==this._curEditControlAPI.name?this._curEditControlAPI:this._actorRegistrationManager.GetWidgetControlAPI(t);null!=o&&null!=o.actor&&null!=o.actor.OnKeyDown&&(e.StopInfiniteKeyDownLoop||(s=o.actor.OnKeyDown(e)));var u=this._isInQuickEditMode||null==o||o.IsLightFocus();!s&&u&&this._objBag.focusMgr.HandleKeyDown(e,!0)&&null!=this._curActiveActorName&&this._curActiveActorName==t&&this.StopEditing(!1)}};e.prototype.GetCurrentEditControlName=function(){return this._curEditControlAPI.name};e.prototype.IsCurrentEditControlUsingGridTextInputElement=function(){return this._curEditControlAPI.actor.IsCurrentlyUsingGridTextInputElement()};e.prototype.Dispose=function(){var e=this;this.Unbind(function(){e._actorRegistrationManager.Dispose();null!=e._fnDisposeWidgetDockHandlers&&e._fnDisposeWidgetDockHandlers();r.JsGridUtil.ClearEventListeners(e._widgetDock);e._widgetDock.innerHTML="";e._widgetDock=null})};return e})();t.EditManager=E;var S=function(e,t){this.fn=e;this.bArgsRequired=t},x=(function(){function e(e){this.rawStateMap=[[h,{promote:new S(this.ProcessBind.bind(this),!0)}],[p,{demote:new S(this.ProcessUnbind.bind(this),!1),promote:new S(this.ProcessBeginEdit.bind(this),!0)}],[d,{demote:new S(this.ProcessStopEdit.bind(this),!1)}]];this.stateMap=r.JsGridUtil.Internal.ConvertTableToMap(this.rawStateMap,"0","1");this._stateQueue=[];this.emptyArgs=[];this._editMgr=e}e.prototype.ProcessUnbind=function(){for(var e=0;e<this._editMgr._curWidgetControlsAPI.length;e++)this._editMgr.CollapseWidget(this._editMgr._curWidgetControlsAPI[e].name);this._editMgr._widgetDock.style.display="none";for(e=0;e<this._editMgr._widgetDock.childNodes.length;e++)this._editMgr._widgetDock.childNodes[e].style.visibility="hidden";this._editMgr._lastExpandedActorName=null;for(e=0;e<this._editMgr._curActorsAPI.length;e++)this._editMgr._curActorsAPI[e].actor.Unbind();this._editMgr._curRecord=null;this._editMgr._curColumn=null;this._editMgr._curField=null;this._editMgr._curGridPane=null;this._editMgr._curActorsAPI=null;this._editMgr._curEditControlAPI=null;this._editMgr._curWidgetControlsAPI=null;this._editMgr._curPropType=null;this._editMgr._curTd=null;this._editMgr._curTdRect=null;this._editMgr._curExpandSpace=null;this._editMgr._curPaneRect=null;this._editMgr._curStyle=null;this._editMgr._curActiveActorName=null;this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};this._editMgr._originalValue=null;this._editMgr._lastExpandedActorName=null};e.prototype.ProcessStopEdit=function(e){var t;this._editMgr._curEditControlAPI.actor.OnEndEdit();this._editMgr.CollapseAll();e||(t=this._editMgr.ApplyUserUpdatedValue());this._editMgr._isInQuickEditMode=!1;this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};this._editMgr._objBag.focusMgr.Focus();this._editMgr.logEngagement("QuickEdit.onCellEditCompleted");this._editMgr._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditCompleted,r.JsGridUtil.EventArgs.CellEditCompleted(this._editMgr._curRecord.key(),this._editMgr._curField.key,t,e))};e.prototype.ProcessBind=function(e,t,n,r,i,s,o,u){this._editMgr._curRecord=t;this._editMgr._curColumn=n;this._editMgr._curField=i[r];this._editMgr._curGridPane=e;this._editMgr._curPropType=null!=t.GetProp(r)?t.GetProp(r).propType:i[r].GetPropType();this._editMgr._originalValue=this._editMgr.GetValueFromRecord();this._editMgr._curActorsAPI=this._editMgr._actorRegistrationManager.GetEditAndWidgetControlsAPI(this._editMgr._curRecord,this._editMgr._curColumn,this._editMgr._curField.key,this._editMgr._curPropType);this._editMgr._curEditControlAPI=this._editMgr._curActorsAPI.editControlAPI;this._editMgr._curWidgetControlsAPI=this._editMgr._curActorsAPI.widgetControlsAPI;this._editMgr.TryAddErrorWidget(t.key(),r);this._editMgr._curActorsAPI=[this._editMgr._curEditControlAPI].concat(this._editMgr._curWidgetControlsAPI);this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};null!=s&&(this._editMgr._curTd=s.GetTd());null!=o&&(this._editMgr._curStyle=o);this._editMgr._curTdRect=this._editMgr.GetCurrentTdRect();this._editMgr._curPaneRect=this._editMgr.GetCurrentViewportCoord();this._editMgr._curExpandSpace=this._editMgr.GetExpandSpace(this._editMgr._curTdRect,this._editMgr._curPaneRect);this._editMgr._curEditControlAPI.SetCellInfo();this._editMgr._curEditControlAPI.actor.BindToCell(this._editMgr._curEditControlAPI.GetCellContext());for(var a in this._editMgr._curWidgetControlsAPI){this._editMgr._curWidgetControlsAPI[a].SetCellInfo();this._editMgr._curWidgetControlsAPI[a].actor.BindToCell(this._editMgr._curWidgetControlsAPI[a].GetCellContext())}this._editMgr.LayoutWidgets()};e.prototype.ProcessBeginEdit=function(e){this._editMgr._curActiveActorName=r.JsGridUtil.EmptyValue;this._editMgr.UpdateOriginalValue(this._editMgr.GetValueFromRecord());this._editMgr.logEngagement("QuickEdit.OnCellEditBegin");this._editMgr._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditBegin,r.JsGridUtil.EventArgs.CellEditBegin(this._editMgr._curRecord.key(),this._editMgr._curField.key));this._editMgr._curEditControlAPI.actor.OnBeginEdit(e);null==this._editMgr._curEditControlAPI.actor.OnKeyDown||"keypress"!=e.type&&"keydown"!=e.type||this._editMgr._curEditControlAPI.actor.OnKeyDown(e)};e.prototype.HandleStateTransition=function(e,t,n,i){var s=this,o=this._stateQueue.length>0?this._stateQueue[0].newState:this._editMgr._curState;if(t&&o<=e||!t&&o>=e)(function(e,t,n){for(var i=0;i<s._stateQueue.length;i++)if(s._stateQueue[i]==e){null!=t&&s._stateQueue[i].callbacks.push(t);r.JsGridUtil.DebugAssert(!s.stateMap[e].bArgsRequired||null==n);null!=n&&(s._stateQueue[i].args=n);return}null!=t&&t()})(e,n,i);else{for(var u=Math.abs(o-e),a=1;a<=u;a++){e=o+a*(t?-1:1);var f=1==a&&null!=i?i:this.emptyArgs,l=null!=n&&u==a?[n]:this.emptyArgs;r.JsGridUtil.DebugAssert(!this.stateMap[e].bArgsRequired||f==this.emptyArgs);this._stateQueue.unshift({newState:e,args:f,callbacks:l})}this._stateQueue.length==u&&(function(){for(;s._stateQueue.length>0;){var e=s._stateQueue[s._stateQueue.length-1];(s._editMgr._curState<e.newState?s.stateMap[s._editMgr._curState].promote.fn:s.stateMap[s._editMgr._curState].demote.fn).apply(null,e.args);s._editMgr._curState=e.newState;s._stateQueue.pop();for(var t=0;t<e.callbacks.length;t++)e.callbacks[t]()}})()}};e.prototype.GetCurrentEndingState=function(){return this._stateQueue.length>0?this._stateQueue[0].newState:this._editMgr._curState};return e})(),T=function(e,t,n){this.jsGridObj=t.jsGridObj;this.parentNode=n.actorsParentNode;this.styleManager=t.styleMgr;this.RTL=t.RTL;this.emptyValue=r.JsGridUtil.EmptyValue;this.bLightFocus=!1;this.peoplePickerDataSource=t.jsGridParams.peoplePickerDataSource;this.portalManager=t.jsGridParams.portalManager;this.locationDataSource=t.jsGridParams.locationDataSource;this.taxonomyPickerDataSource=t.jsGridParams.taxonomyDataSource;this.pageContext=t.jsGridParams.pageContext;this.OnKeyDown=function(t){n.OnActorKeyDown(t,e)}};t.EditActorGridContext=T;var N=(function(){function e(e,t){this._name=e;this._editMgr=t}e.prototype.SetCurrentValue=function(e){this._editMgr.SetCurrentValue(this._name,e)};return e})(),C=function(e,t,n,r,i){var s=this;this._gridContext=n();this._cellContext=r();this.name=e;this.actor=t;this.SetCellInfo=function(){i.SetCellInfo(s._cellContext,i._actorRegistrationManager.IsActorWidget(s.name))};this.UpdateOriginalValue=function(e){s._cellContext.originalValue=e};this.IsLightFocus=function(){return s._gridContext.bLightFocus};this.NotifyEditComplete=function(e){s._cellContext.NotifyEditComplete(e)};this.GetGridContext=function(){return s._gridContext};this.GetCellContext=function(){return s._cellContext}};t.EditActorManagerAPI=C});
define("RGe",["require","exports","eGe","oGe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t,n,r,i){this._registeredEditControlsAPI={};this._registeredWidgetControlsAPI={};this._objBag=e;this._fnGetEditControlManagerAPI=n;this._fnGetWidgetControlManagerAPI=r;this._fnOnRegisterWidgetControl=i}e.prototype.RegisterEditControl=function(e){e in this._registeredEditControlsAPI||this.CreateEditControlInstance(e);return this._registeredEditControlsAPI[e]};e.prototype.RegisterWidgetControl=function(e){e in this._registeredWidgetControlsAPI||this.CreateWidgetControlInstance(e);return this._registeredWidgetControlsAPI[e]};e.prototype.GetEditControlAPI=function(e){return this._registeredEditControlsAPI[e]};e.prototype.GetWidgetControlAPI=function(e){return this._registeredWidgetControlsAPI[e]};e.prototype.GetActorAPI=function(e){return this._registeredEditControlsAPI[e]||this._registeredWidgetControlsAPI[e]};e.prototype.IsActorWidget=function(e){return e in this._registeredWidgetControlsAPI};e.prototype.GetEditAndWidgetControlsAPI=function(e,t,n,i){var s={editControlAPI:null,widgetControlsAPI:[]},o=r.PropertyType.Internal.Property.GetInstance().GetEditAndWidgetControlNamesForProperty(e,t,n,i);s.editControlAPI=this.RegisterEditControl(o.editControlName);for(var u=0;u<o.widgetControlNames.length;u++)s.widgetControlsAPI.push(this.RegisterWidgetControl(o.widgetControlNames[u]));return s};e.prototype.Dispose=function(){for(var e in this._registeredEditControlsAPI)this._registeredEditControlsAPI[e].actor.Dispose();for(var e in this._registeredWidgetControlsAPI)this._registeredWidgetControlsAPI[e].actor.Dispose()};e.prototype.CreateEditControlInstance=function(e){var t=this._fnGetEditControlManagerAPI(e),n=[t.GetGridContext()],i=this._objBag.focusMgr.GetFocusElementForTextInput(e);null!=i&&n.push(i);t.actor=r.PropertyType.Internal.Property.GetInstance().GetEditControl(e,n);this._registeredEditControlsAPI[e]=t};e.prototype.CreateWidgetControlInstance=function(e){var t=this._fnGetWidgetControlManagerAPI(e),i=[t.GetGridContext()];e==n.JsGridConstants.ErrorWidgetId&&i.push(this._objBag.errorMgr);t.actor=r.PropertyType.Internal.Property.GetInstance().GetWidgetControl(e,i);this._fnOnRegisterWidgetControl(e,t.actor);this._registeredWidgetControlsAPI[e]=t};return e})();t.EditActorsRegistrationManager=i});
define("FGe",["require","exports","eGe","DGe","cGe","dGe","jGe","sGe","ce"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=a.Killswitch.isActivated("FAFFB0A4-381F-4ADF-A597-87E8C524145C","9/27/2019","Enable copy in non-IE browsers"),l={ODB:1725},c=(function(){function e(e,t){this.SelectionType=n.JsGridConstants.SelectionType;this.hasClipBoardData=function(){return!!this._clipboardMgr.GetData()};this._objBag=e;this._fnGetLocStr=t;this._clipboardMgr=new h}e.prototype.GetLastOperation=function(){return this.copyOp&&{gridPane:this.copyOp.gridPane,rowRange:this.copyOp.rowRange,colRange:this.copyOp.colRange,selType:this.copyOp.selType,opType:this.copyOp.opType}};e.prototype.CheckClipboard=function(){null==this.copyOp||this.IsClipboardDataFromLastCopyOperation()||this.CancelMode()};e.prototype.IsSelectionCopyable=function(e){return this._objBag.selectionMgr.GetRowRanges(e).length+this._objBag.selectionMgr.GetColumnRanges(e).length+this._objBag.selectionMgr.GetCellRanges(e).length==1};e.prototype.CancelMode=function(){var e=this.copyOp&&this.copyOp.gridPane;this.copyOp=null;null!=e&&e.NotifyCopyOperationUpdated()};e.prototype.OnCopy=function(e){var t,r=this,s=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=s){i.JsGridUtil.Internal.IsFeatureEnabled(l)&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===(null===(t=s.colRange)||void 0===t?void 0:t.begin)&&(s.colRange.begin=0);var o,u=s.rowRange,a=s.colRange,f=e.GetGridPaneConverter();this._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return o=f.GetRecordsInvolved(u.begin,u.Size(),function(t){o=t;e()})},function(){r.BaseCopy(e,o,u,a,"copy",!1)})}};e.prototype.OnCut=function(e){var t,r=this;if(this._objBag.editUtil.IsEditingEnabled()){var s=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=s){i.JsGridUtil.Internal.IsFeatureEnabled(l)&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===(null===(t=s.colRange)||void 0===t?void 0:t.begin)&&(s.colRange.begin=0);var o,u=s.rowRange,a=s.colRange,f=e.GetGridPaneConverter(),c=this._objBag.editUtil.IsNewRowEnabled()&&u.end==f.GetVirtualRowCount()-this._objBag.entryRecordMgr.GetEntryRecords().length,h=f.GetRecordKeysInvolved(u.begin,u.Size());if(c)alert(this._fnGetLocStr("OpNotSupportedOnEntryRow"));else{var p=this._objBag.selectionMgr.GetLastSelectionType()==this.SelectionType.RowRange&&this._objBag.delegateMgr.DelegatePresent(n.JsGridConstants.DelegateType.DeleteRecords);if(p){if(e.Id!==n.JsGridConstants.PaneId.MainGrid){alert(this._fnGetLocStr("NoCuttingRowsInPane"));return}var d=this._objBag.editUtil.ValidateAndExpandKeyList(h);if(null!=d){if(!d.bAllChildKeysInView){alert(this._fnGetLocStr("NoDeletingParentWithMissingChildren"));return}if(d.expandedKeys.length!==h.length){alert(this._fnGetLocStr("NoCuttingParentWithoutChildren"));return}}}this._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return o=f.GetRecordsInvolved(u.begin,u.Size(),function(t){o=t;e()})},function(){if(p){if(r.ContainsReadOnlyRows(o)){alert(r._fnGetLocStr("NoCuttingReadOnlyRows"));return}}else if(r.ContainsReadOnlyCells(e,o,u,a)){alert(r._fnGetLocStr("NoCuttingReadOnlyCells"));return}r.BaseCopy(e,o,u,a,"cut",p)})}}}else alert(this._fnGetLocStr("GridNotEditable"))};e.prototype.OnPaste=function(e,t){var s=this,a=function(e){g?e():s._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return T=w.GetRecordsInvolved(O.begin,O.Size(),function(t){T=t;e()})},e)},f=function(e){s._objBag.delegateMgr.DelegatePresent(n.JsGridConstants.DelegateType.TryBeginPaste)?s._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.TryBeginPaste,O.end-O.begin+1,l,e):l(e)},l=function(t){s._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnPasteBegin);if(!i.JsGridUtil._fixPasteNewRowPerfKillSwitchIsActive){s._objBag.jsGridObj.paneMgr.gridPane.dontReflow=!0;s._objBag.jsGridObj.paneMgr.gridPane.afterReflowScrollGoal=O.begin}s.CancelMode();if(null!=d)if(d.causesRowDelete){s._objBag.jsGridObj.DeleteRecords(i.JsGridUtil.Internal.ConvertSetKeysToArray(x));O.begin-=v;O.end-=v}else s._objBag.jsGridObj.UpdateProperties(s.BuildPropertyUpdatesForCut(d.gridPane,x,d.rowRange,d.colRange),n.JsGridConstants.UserAction.Paste);e.PutData(h,T,n.JsGridConstants.UserAction.Paste,"TL",O,M,t,g)},c=function(t){i.JsGridUtil.hasPasteStarted=!1;s._objBag.selectionMgr.SelectRange(e,O.begin,O.begin+Math.min(t,O.end-O.begin),M.begin,M.end,o.SelectOp.Set,!0,!1);s._objBag.commandMgr.CloseGroup(null!=d?"SP.JsGrid.UserAction.CutPaste":n.JsGridConstants.UserAction.Paste,r.CommandManagerConstants.CommandType.Explicit,!0);s._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnPasteEnd)};if(this._objBag.editUtil.IsEditingEnabled()){if(!this.IsSelectionCopyable(e)){alert(this._fnGetLocStr("MultipleSelections"));return!1}var h=this.GetParsedClipboardData(t);if(null!=h){var p=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=p){i.JsGridUtil.hasPasteStarted=!0;var d,v=0,m=0;if(null!=this.copyOp&&"cut"==this.copyOp.opType&&this.IsClipboardDataFromLastCopyOperation()&&(d={gridPane:this.copyOp.gridPane,rowRange:this.copyOp.rowRange,colRange:this.copyOp.colRange,causesRowDelete:this.copyOp.bCutCausesRowDelete}).causesRowDelete){v=d.gridPane==e&&d.rowRange.begin<p.rowRange.begin?d.rowRange.Size():0;m=d.rowRange.Size();if(e.Id!==n.JsGridConstants.PaneId.MainGrid){alert(this._fnGetLocStr("NoPastingRowsInPane"));return}if(new u.Range(p.rowRange.begin,p.rowRange.begin+d.rowRange.Size()-1).Overlaps(d.rowRange)){alert(this._fnGetLocStr("CutPasteRowOverlap"));return}}var g,y=p.colRange.Size(),b=p.rowRange.Size(),w=e.GetGridPaneConverter(),E=w.GetVirtualRowCount();if(this._objBag.editUtil.IsNewRowEnabled()){var S=this._objBag.entryRecordMgr.GetEntryRecords().length;g=p.rowRange.begin>=E-S;E-=S}if(p.colRange.begin+h.width>w.GetVirtualColumnCount()||!g&&p.rowRange.begin-v+h.height>E-m)alert(this._fnGetLocStr("NoRoomToPaste"));else{var x,T,N,C=y%h.width==0,k=b%h.height==0,L=null==d&&C&&(k||b<h.height)?y:h.width,A=null==d&&k&&(C||y<h.width)?b:h.height,O=new u.Range(p.rowRange.begin,p.rowRange.begin+A-1),M=new u.Range(p.colRange.begin,p.colRange.begin+L-1);this._objBag.commandMgr.OpenGroup();null!=d?(N=function(){a(function(){f(c)})},s._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return x=d.gridPane.GetGridPaneConverter().GetRecordsInvolved(d.rowRange.begin,d.rowRange.Size(),function(t){x=t;e()})},N)):a(function(){f(c)})}}}}else alert(this._fnGetLocStr("GridNotEditable"))};e.prototype.BaseCopy=function(e,t,n,r,i,s){if(!this.IsSelectionCopyable(e)){alert(this._fnGetLocStr("MultipleSelections"));return!1}for(var o=e.GetData(t,n,r,!1),u=new Array(n.Size()),a=0;a<u.length;a++){u[a]=o.matrix[a].join("\t");u[a]=this.NormalizeCRLF(u[a]);u[a]=u[a].replace(/\n/g,"<br>")}this.CancelMode();var f=u.join("\r\n");if(this._clipboardMgr.SetData(f)){this.copyOp={clipboardText:f,rowRange:n,colRange:r,selType:this._objBag.selectionMgr.GetLastSelectionType(),gridPane:e,opType:i,bCutCausesRowDelete:s};e.NotifyCopyOperationUpdated();return!0}return!1};e.prototype.GetParsedClipboardData=function(e){var t=e||this._clipboardMgr.GetData();if(null==t||""==t)return null;var n=t.replace(/(\\r)(?!\\n)/g,"\n").split("\r\n");1===n.length&&(n=this.NormalizeCRLF(t).split("\n"));n.length>1&&""==n[n.length-1]&&n.pop();for(var r,s=n.length,o=0;o<s;o++){n[o]=n[o].split("\t");if(null==r)r=n[o].length;else if(r!==n[o].length){if(o==s-1&&1==n[o].length&&""==n[o][0]){s--;break}break}for(var u=0;u<n[o].length;u++){var a=n[o][u];if(a.indexOf("\n")>=0){a=(a=a.replace(/^\"+|\"+$/gm,"")).replace(/\"\"/gm,'"');a=(a=i.JsGridUtil.Internal.Encoding_STSHtmlEncode(a)).replace(/\n/g,"<br>");n[o][u]=a}}}if(o!==s){alert(this._fnGetLocStr("ClipboardDataNotSquare"));return null}return{matrix:n,width:r,height:s}};e.prototype.ContainsReadOnlyCells=function(e,t,n,r){for(var i=e.GetGridPaneConverter(),s=n.begin;s<=n.end;s++)for(var o=r.begin;o<=r.end;o++){var u=i.IdxToKey(s,o);if(!this._objBag.editUtil.CanEditField(t[u.recordKey],i.GetColumnByIdx(o),u.fieldKey))return!0}return!1};e.prototype.ContainsReadOnlyRows=function(e){for(var t in e)if(!this._objBag.editUtil.CanEditField(e[t],null,null))return!0;return!1};e.prototype.BuildPropertyUpdatesForCut=function(e,t,n,r){for(var i=e.GetGridPaneConverter(),o=new Array(n.Size()*r.Size()),u=0,a=n.begin;a<=n.end;a++)for(var f=r.begin;f<=r.end;f++){var l=i.IdxToKey(a,f);o[u++]=s.CreateUnvalidatedPropertyUpdate(l.recordKey,l.fieldKey,"",!0)}return o};e.prototype.NormalizeCRLF=function(e){return e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")};e.prototype.IsClipboardDataFromLastCopyOperation=function(){var e=this._clipboardMgr.GetData();return null==this.copyOp.clipboardText?null==e:(e&&this.NormalizeCRLF(e))==this.NormalizeCRLF(this.copyOp.clipboardText)};return e})();t.CutCopyPasteManager=c;var h=function(){var e=this;this.GetMimeType=function(){return null!=window.clipboardData&&null!=window.clipboardData.getData?"text":Sys.Browser.agent==Sys.Browser.Safari||Sys.Browser.agent==Sys.Browser.AppleWebKit?"text/plain":Sys.Browser.agent==Sys.Browser.Firefox?"text/unicode":"text"};this._mimeType=this.GetMimeType();this.SetData=function(t){if(window.clipboardData&&window.clipboardData.setData)window.clipboardData.setData(e._mimeType,t);else{e._clipboardContext={};e._clipboardContext[e._mimeType]=t;if(!f){i.JsGridUtil.Internal.GetFocusElement().addEventListener("copy",e.EventBasedCopy,!1);document.execCommand("copy")}}return!0};this.EventBasedCopy=function(t){t.stopImmediatePropagation();t.stopPropagation();t.preventDefault();t.clipboardData&&t.clipboardData.setData&&t.clipboardData.setData(e._mimeType,e._clipboardContext[e._mimeType])};this.GetData=function(){return null!=window.clipboardData&&null!=window.clipboardData.getData?window.clipboardData.getData(e._mimeType):e._clipboardContext&&e._clipboardContext[e._mimeType]}};t.ClipboardManager=h});
define("UGe",["require","exports","cGe","eGe","jGe","bGe","sGe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";var a=u.panemgr_9;u=u.tablemgr_9;Object.defineProperty(t,"__esModule",{value:!0});var f={ODB:1725},l=(function(){function e(e,t){this._cellsWithBorder=[];this._intDelegateMgr=e;this._styles=t;this._quickEditVisualRefreshFlightEnabled=n.JsGridUtil.Internal.IsFeatureEnabled(f)}e.prototype.OnMouseDown=function(e,t,r,i,o,f){e.preventDefault();this._tableMgr=o;this._selectionMgr=f;this._gridPane=t;this._parentNode=r;this._selDragHandle=i;this._selectionFrames=t.selectionFrames;this._mouseDownPos=n.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);this._selDragHandlePos=n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(i);this._finalRange=null;this._fillFrame=document.createElement("div");this._fillFrame.style.cssText="position:absolute;visibility:hidden;overflow:hidden;top:0px;left:0px";if(this._quickEditVisualRefreshFlightEnabled){this._gridPane.tableDiv.classList.add(u.tableHasMouseDown);this._fillFrame.classList.add(a.dragToFillFrame)}else this._fillFrame.style.border=s.StyleUtil.MakeBorderString(2,"solid",this._styles.gridPaneStyle.fillRectBorderColor);this._parentNode.appendChild(this._fillFrame);n.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(i,this.OnMouseMove.bind(this),this.OnMouseUp.bind(this));this.OnMouseMove(e)};e.prototype.OnMouseMove=function(e){var t=this._selectionMgr.GetLastSelectionRangeNormalized(),i=this._selectionMgr.GetLastSelectionType(),s=this._tableMgr.GetRowIdxColIdxFromCoord(e);this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(s.colIdx=0);if(null!=s.rowIdx&&null!=s.colIdx){var a=n.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);if(!(a.x>=this._selDragHandlePos.x&&a.x<=this._selDragHandlePos.x+this._selDragHandle.offsetWidth&&a.y>=this._selDragHandlePos.y&&a.y<=this._selDragHandlePos.y+this._selDragHandle.offsetHeight)){this._bFillHorizVsVert=Math.abs(a.x-this._mouseDownPos.x)>Math.abs(a.y-this._mouseDownPos.y);var f;if(this._bFillHorizVsVert){this._finalRange=new o.Range(Math.min(t.colRange.begin,s.colIdx),Math.max(t.colRange.end,s.colIdx));this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(n.JsGridUtil._lastColumnVisibilityKillSwitchIsActive||this._gridPane._objBag.showAddColumnMenu&&this._gridPane._objBag.canUserAddColumn)&&(this._finalRange.end=this._finalRange.end-1);f=this._gridPane.GetCellRangeBorderDrawingInfo(t.rowRange,this._finalRange,i)}else{this._finalRange=new o.Range(Math.min(t.rowRange.begin,s.rowIdx),Math.max(t.rowRange.end,s.rowIdx));this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(n.JsGridUtil._lastColumnVisibilityKillSwitchIsActive||this._gridPane._objBag.showAddColumnMenu&&this._gridPane._objBag.canUserAddColumn)&&(t.colRange.end=t.colRange.end-1);f=this._gridPane.GetCellRangeBorderDrawingInfo(this._finalRange,t.colRange,i)}if(null!=f){if(this._quickEditVisualRefreshFlightEnabled){this._fillFrame.style.left=f.left+"px";this._fillFrame.style.top=f.top+"px";this._fillFrame.style.width=f.width-4+"px";this._fillFrame.style.height=f.height-6+"px";n.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._gridPane.ClearPseudoElementFrame(this._cellsWithBorder,u.cellHasSelectionBorder);if(i===r.JsGridConstants.SelectionType.CellRange)if(n.JsGridUtil.Internal.IsStickyColumnEnabled()){var l=void 0;l=this._bFillHorizVsVert?{rowRange:t.rowRange,colRange:this._finalRange}:{rowRange:this._finalRange,colRange:t.colRange};this._gridPane.ApplyPseudoElementFrame(l,this._cellsWithBorder,u.cellHasFillDownBorder,i===r.JsGridConstants.SelectionType.RowRange);var c=f.top+f.height-6,h=void 0;h=this._gridPane._objBag.RTL.bEnabled?f.left-2:f.right-3;if(l.colRange.end<=n.JsGridUtil.Internal.stickyLastColIdx){c+=6;h+=30}this._selDragHandle.children[0].style.top=c+"px";this._selDragHandle.style.left=h+"px"}else{this._selDragHandle.style.top=f.top+f.height-6+"px";this._gridPane._objBag.RTL.bEnabled?this._selDragHandle.style.left=f.left-2+"px":this._selDragHandle.style.left=f.right-5+"px"}else if(i===r.JsGridConstants.SelectionType.RowRange)if(n.JsGridUtil.Internal.IsStickyColumnEnabled()){this._gridPane.ApplyPseudoElementFrame({rowRange:this._finalRange,colRange:t.colRange},this._cellsWithBorder,u.cellHasFillDownBorder,i===r.JsGridConstants.SelectionType.RowRange);this._selDragHandle.children[0].style.top=f.top+f.height+"px";this._gridPane._objBag.RTL.bEnabled?this._selDragHandle.style.left=f.right-7+"px":this._selDragHandle.style.left=f.left+"px"}else{this._selDragHandle.style.top=f.top+f.height-8+"px";this._gridPane._objBag.RTL.bEnabled?this._selDragHandle.style.left=f.right-7+"px":this._selDragHandle.style.left=f.left+"px"}for(var p in this._selectionFrames){this._selectionFrames[p].style.visibility="hidden"}}else{this._fillFrame.style.left=f.left-1+"px";this._fillFrame.style.top=f.top-1+"px";this._fillFrame.style.width=f.width-2+"px";this._fillFrame.style.height=f.height-2+"px"}n.JsGridUtil.Internal.IsStickyColumnEnabled()||(this._fillFrame.style.visibility="")}else this._fillFrame.style.visibility="hidden"}}};e.prototype.OnMouseUp=function(e){var t=this;if(null!=this._finalRange){this._quickEditVisualRefreshFlightEnabled&&this._gridPane.tableDiv.classList.remove(u.tableHasMouseDown);var i=this.ComputeFillParameters(),s=function(){t.Fill(i.repeatOrigin,i.srcRowRange,i.srcColRange,i.destRowRange,i.destColRange,i.trimmedDestRowRange,i.trimmedDestColRange)};if(n.JsGridUtil._lookupFieldCopyPasteKillSwitchIsActive)s();else{var o=[n.JsGridUtil.taxonomyLoadCallback],a=n.JsGridUtil.Internal.SiteUrl+"/",f=r.JsGridConstants.csomFiles.map(function(e){return a+e});n.JsGridUtil.csomJsFilesLoader._ensureExternalJsFilesLoaded(f,s,o)}this._parentNode.removeChild(this._fillFrame);this._fillFrame=null}};e.prototype.ComputeFillParameters=function(){var e,t,r,i,s,u,a,f,l=this._selectionMgr.GetLastSelectionRangeNormalized();this._quickEditVisualRefreshFlightEnabled&&!n.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===(null===(e=l.colRange)||void 0===e?void 0:e.begin)&&(l.colRange.begin=0);if(this._bFillHorizVsVert){r=s=a=l.rowRange;u=this._finalRange;var c=l.colRange.begin!==u.begin;t=c?"TR":"TL";var h=l.colRange.Size();i=c?new o.Range(u.end-h+1,u.end):new o.Range(u.begin,u.begin+h-1);f=c?new o.Range(u.begin,u.end-h):new o.Range(u.begin+h,u.end)}else{i=u=f=l.colRange;s=this._finalRange;var p=l.rowRange.begin!==s.begin;t=p?"BL":"TL";var d=l.rowRange.Size();r=p?new o.Range(s.end-d+1,s.end):new o.Range(s.begin,s.begin+d-1);a=p?new o.Range(s.begin,s.end-d):new o.Range(s.begin+d,s.end)}return{repeatOrigin:t,srcRowRange:r,srcColRange:i,destRowRange:s,destColRange:u,trimmedDestRowRange:a,trimmedDestColRange:f}};e.prototype.Fill=function(e,t,s,o,a,f,l){var c,h=this;if(t.Size()!=o.Size()||s.Size()!=a.Size()){var p=this._selectionMgr.GetLastSelectionRangeNormalized();n.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._quickEditVisualRefreshFlightEnabled&&!n.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===(null===(c=p)||void 0===c?void 0:c.colRange.begin)&&this._gridPane.ClearPseudoElementFrame(this._cellsWithBorder,u.cellHasFillDownBorder);var d,v=this._gridPane.GetGridPaneConverter();this._intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return d=v.GetRecordsInvolved(o.begin,o.Size(),function(t){d=t;e()})},function(){var n=h._gridPane.GetData(d,t,s,!1);h._gridPane.PutData(n,d,r.JsGridConstants.UserAction.Fill,e,f,l,function(){h._selectionMgr.SelectRange(h._gridPane,o.begin,o.end,a.begin,a.end,i.SelectOp.Set,!0,!1)})})}else if(this._quickEditVisualRefreshFlightEnabled)for(var m in this._selectionFrames){this._selectionFrames[m].style.visibility=""}};return e})();t.FillDownManager=l});
define("TGe",["require","exports","eGe","cGe","pze","oGe","dGe","jGe","IA","MGe","me","ce","iGe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d=p.tablemgr_9;p=p.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var v=c.Killswitch.isActivated("CAF8B57F-023A-49B5-B7B6-A92006D95286","10/11/2019","Fix several issues with items positioned far off to the left causing RTL bugs."),m=c.Killswitch.isActivated("412EE39D-F6D7-4C5A-ABE0-499D90CC520E","12/09/2019","Fix flashing input on cell click by using hide css styles."),g=c.Killswitch.isActivated("9340DEC3-CF41-4D00-BDD8-2AA84E33D2C2","2/05/2020","Make headers accessible with keyboard only."),y=c.Killswitch.isActivated("E2B8D098-22B3-4FF6-973C-1CA708C3F688","03/06/2020","When changing focus from cell to cell clear contenteditable attribute to fix cursor styles."),b=c.Killswitch.isActivated("4EBDFA82-3637-4E42-9416-99D77B1E1CF0","07/02/2020","Append hidden focus input after grid container, rather than before, to support tabbing out of grid."),w=c.Killswitch.isActivated("94D1C283-66A1-43E6-A223-FA801BFD0A7E","07/13/2020","Remove from DOM skip grid anchor elements as they are not needed with changing Tab keyboard behavior in the grid"),E=c.Killswitch.isActivated("CF0631CE-5CB5-4AD4-B272-B737F7CDB26A","07/15/2020","Remove contenteditable attribute on focusing a cell because it is causing screen reader to announce the content twice"),S={ODB:1725},x={ODB:1024},T={ODB:988},N=(function(){function e(e,t,i,s,o,u,a,l,c,h,p){var d=this;this.FocusElementType={anchor:0,input:1,parentNode:2};this._focusElementType=this.FocusElementType.input;this._bUseInputFocusElementForTextInput=!0;this._supportChromePaste=!0;this.OnBlur=function(e){d._gridPane.HideFocusStyles()};this.OnFocusEntryPointKeyDown=function(e){if(e.keyCode===n.JsGridConstants.Key.enter){e.preventDefault();e.stopPropagation();var t=d._gridPane.tableMgr.GetColumnHeaderTr(),r=f.extraSpacerColumnsKillswitchIsActive?0:2;if(t)for(var i=0;i<t.children.length-r;i++)t.children[i].setAttribute("tabindex","0");var s=d._selectionMgr.GetFocusForPane(d._gridPane);d._gridPane.ScrollCellIntoView(s.rowIdx,s.colIdx);d._focusElement.removeAttribute("tabindex");d.Focus()}};this.OnFocusEntryPointFocus=function(e){var t=d._gridPane.tableMgr.GetColumnHeaderTr(),n=f.extraSpacerColumnsKillswitchIsActive?0:2;if(t)for(var r=0;r<t.children.length-n;r++)t.children[r].setAttribute("tabindex","-1");d._focusElement.setAttribute("tabindex","-1")};this._jsGridElementId=e;this._objBag=t;this._fnGetLocStr=s;this._fnIsGridEnabled=o;this._fnIsGridVisible=u;this._selectionMgr=a;this._editMgr=l;this._fnGetCellValue=c;this._fnRetryErrorRows=h;this._fnScrollIntoViewVertically=p;this._parentNode=i;this._gridFocusEntryPoint=document.getElementById("gridFocusEntryPoint"+r.JsGridUtil.privateWpq);this._outerGridParentNode=i.parentNode;this.Init()}e.prototype.SetView=function(e,t,n,r){this._paneLayout=e;this._gridPane=t;this._pivotedGridPane=n;this._gridFieldMap=r;this._ariaMgr.NotifyViewChange()};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this._skippedGridContentElement);this._focusElement.removeEventListener("focus",this.OnFocus);this._focusElement.removeEventListener("paste",this.onPaste);this._focusElement.removeEventListener("keydown",this.OnKeyDown);this._focusElement.removeEventListener("keypress",this.OnKeyPress);this._focusElement.removeEventListener("keyup",this.OnKeyUp);r.JsGridUtil.Internal.IsFeatureEnabled(T)&&this._focusElement.removeEventListener("blur",this.OnBlur);this._focusElement=this._skippedGridContentElement=null;if(r.JsGridUtil.Internal.IsFeatureEnabled(T)){this._gridFocusEntryPoint.removeEventListener("keydown",this.OnFocusEntryPointKeyDown);this._gridFocusEntryPoint.removeEventListener("focus",this.OnFocusEntryPointFocus);this._gridFocusEntryPoint=null}};e.prototype.Focus=function(){try{this._editMgr.IsEditing()&&this._editMgr.StopEditing(!1);this.SetStyleForFocusElementInput(!0)}catch(e){r.JsGridUtil.DebugAssert(!1,"The grid cannot be focused because it is hidden. Possible scenario: if the grid was editable, it might have been in edit; call grid.NotifyHide() or hide the grid using the fnContinue of grid.FinalizeEditing(fnContinue, fnError).")}};e.prototype.GetFocusElementForTextInput=function(e){return!this._bUseInputFocusElementForTextInput||this._focusElementType!=this.FocusElementType.input||e!=i.EditControlType.EditBox&&e!=i.EditControlType.PeoplePicker&&e!=i.EditControlType.LocationPicker?null:this._focusElement};e.prototype.ChangeTextInputElementToFocusElement=function(){if(this.FocusElementIsBeingUsedForTextInput()){this._focusElement.blur();this.SetStyleForFocusElementInput();return!0}return!1};e.prototype.HandleKeyDown=function(e,t){var i=this,f=r.JsGridUtil.Internal.IsFeatureEnabled(S),l=f?-1:0;!f||r.JsGridUtil._lastColumnVisibilityKillSwitchIsActive||this._objBag.showAddColumnMenu||this._objBag.canUserAddColumn||(l=0);var c=e.ctrlKey&&!e.altKey&&!e.shiftKey,h=!e.ctrlKey&&e.altKey&&!e.shiftKey,p=!e.ctrlKey&&!e.altKey&&e.shiftKey,v=!e.ctrlKey&&e.altKey&&e.shiftKey,m=e.ctrlKey&&!e.altKey&&e.shiftKey,y=!e.ctrlKey&&!e.altKey&&!e.shiftKey,b=this._selectionMgr.GetFocus();if(!this._fnIsGridEnabled()||null==b)return!1;var w=b.gridPane,E=w.GetGridPaneConverter();if((function(){if(null==i._curFocusedDisplayControlInfo)return!1;if(e.target==i._curFocusedDisplayControlInfo.DOMElement&&(e.keyCode==n.JsGridConstants.Key.tab||e.keyCode==n.JsGridConstants.Key.shift)){if(e.keyCode==n.JsGridConstants.Key.tab){y?i._curFocusedDisplayControlInfo.DOMElement=i._curFocusedDisplayControlInfo.displayControl.FocusNext(i._curFocusedDisplayControlInfo.displayControlContent,i._curFocusedDisplayControlInfo.DOMElement):p&&(i._curFocusedDisplayControlInfo.DOMElement=i._curFocusedDisplayControlInfo.displayControl.FocusPrevious(i._curFocusedDisplayControlInfo.displayControlContent,i._curFocusedDisplayControlInfo.DOMElement));null==i._curFocusedDisplayControlInfo.DOMElement&&i.Focus()}return!0}i.Focus();return!1})()){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}if(e.keyCode==n.JsGridConstants.Key.IMEInput&&w.TryBeginEdit(e))return!0;var N=(function(){if(e.keyCode==n.JsGridConstants.Key.esc){i._objBag.cutcopypasteMgr.CancelMode();i._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowEscape,r.JsGridUtil.EventArgs.OnRowEscape(b.recordKey));if(r.JsGridUtil.Internal.IsFeatureEnabled(T)){w.UpdateRowClassesOnSingleCellSelection(b.rowIdx,-1);w.HideFocusStyles();w.ScrollCellIntoView(0,0);i._gridFocusEntryPoint.focus()}return!0}return!1})()||(function(){var t=function(e){var t=i._objBag.jsGridObj.GetContiguousRowSelectionWithoutEntryRecords(),n=null!=t?t.keys:[];if(n.length>0)if(e){if(i._objBag.jsGridObj.CanMoveRecordsDownByOne(n)){i._objBag.jsGridObj.MoveRecordsDownByOne(n);return!0}}else if(i._objBag.jsGridObj.CanMoveRecordsUpByOne(n)){i._objBag.jsGridObj.MoveRecordsUpByOne(n);return!0}};if(r.JsGridUtil.Internal.IsFeatureEnabled(x)&&i._objBag&&i._objBag.eventMgr){var p=String.fromCharCode(e.keyCode).toUpperCase();if(c&&"Z"===p){i._objBag.eventMgr.FireEvent(a.default.undoChangeEventName);return!0}if(c&&"Y"===p){i._objBag.eventMgr.FireEvent(a.default.redoChangeEventName);return!0}}switch(e.keyCode){case n.JsGridConstants.Key.del:if(y||c){if(i._objBag.editUtil.IsEditingEnabled()){var d=i._objBag.jsGridObj.GetSelectedRowRanges();y&&0==d.length?(function(){var e=i._objBag.tableCache.GetCachedRecord(b.recordKey);null==e&&(e=i._objBag.jsGridObj.GetRecord(b.recordKey));if(null!=e&&i._objBag.editUtil.CanEditField(e,E.GetColumnByIdx(b.colIdx),b.fieldKey)){var t=o.CreateUnvalidatedPropertyUpdate(b.recordKey,b.fieldKey,null,!0);i._objBag.jsGridObj.UpdateProperties([t],n.JsGridConstants.UserAction.UserEdit)}})():i._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.DeleteRecords)}else alert(i._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.insert:if(y){i._objBag.editUtil.IsEditingEnabled()?i._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.InsertRecord):alert(i._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.down:if(h){w.ScrollCellIntoView(b.rowIdx,b.colIdx);var g=w.GetCellByIdx(b.rowIdx,b.colIdx);null!=g&&null!=g.GetRecord()&&i._editMgr.IsBound()&&i._editMgr.ExpandNextActor();return!0}if(v)return t(!0);break;case n.JsGridConstants.Key.up:if(h){(function(){w.ScrollCellIntoView(b.rowIdx,b.colIdx);var e=w.GetCellByIdx(b.rowIdx,b.colIdx);if(null!=e){var t=(function(e){var t=e.GetColumn(),n=e.GetRecord(),r=e.GetFieldKey();if(null!=n){var o=n.GetProp(r),u=null==o?i._gridFieldMap[r].GetPropType():o.propType;return s.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(u,t.fnGetDisplayControlName&&t.fnGetDisplayControlName(n,r))}return null})(e),n=e.GetTd().childNodes;if(n&&t&&t.FocusNext&&t.FocusPrevious){var r=t.FocusNext(n,null);if(null!=r){i._curFocusedDisplayControlInfo={};i._curFocusedDisplayControlInfo.displayControl=t;i._curFocusedDisplayControlInfo.displayControlContent=n;i._curFocusedDisplayControlInfo.DOMElement=r;i._focusElementType==i.FocusElementType.input&&i._parentNode.addEventListener("keydown",i.OnKeyDown.bind(i))}}}})();return!0}if(v)return t(!1);break;case n.JsGridConstants.Key.right:if(v){i._objBag.editUtil.IsEditingEnabled()?i._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.IndentRecords):alert(i._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.left:if(v){i._objBag.editUtil.IsEditingEnabled()?i._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.OutdentRecords):alert(i._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.comma:if(m)return w.TryShiftColumnSelectionGroup(b.rowIdx,b.colIdx,-1);break;case n.JsGridConstants.Key.dot:if(m)return w.TryShiftColumnSelectionGroup(b.rowIdx,b.colIdx,1);break;case n.JsGridConstants.Key.back_slash:if(h)return w.ExpandColumnMenu(b.colIdx);if(m){i._fnRetryErrorRows();return!0}break;case n.JsGridConstants.Key.F2:if(y)return w.TryBeginEdit(e);break;case n.JsGridConstants.Key.enter:case n.JsGridConstants.Key.space:if(f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){if(-1===b.colIdx){i._selectionMgr.SelectRange(w,b.rowIdx,b.rowIdx,b.colIdx,E.GetVirtualColumnCount()-1+l,u.SelectOp.Set,!1,!1);return!0}if(i._selectionMgr.GetLastSelectionType()===u.SelectionType.RowRange){i._selectionMgr.SetFocusByPos(w,b.rowIdx,-1);return!0}}}return!1})()||(function(){var t=function(t,s){switch(e.keyCode){case n.JsGridConstants.Key.enter:if(f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===s)break;if(y)null!=t&&t++;else{if(!p)return null;null!=t&&--t}break;case n.JsGridConstants.Key.down:if(!(y||p||c||m))return null;e.ctrlKey?t=E.GetVirtualRowCount()-1:null!=t&&t++;f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&i._selectionMgr.GetLastSelectionType()===u.SelectionType.RowRange&&(s=-1);break;case n.JsGridConstants.Key.up:if(!(y||p||c||m))return null;e.ctrlKey?t=0:null!=t&&t--;f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&i._selectionMgr.GetLastSelectionType()===u.SelectionType.RowRange&&(s=-1);break;case n.JsGridConstants.Key.pageDown:if(!y&&!p)return null;if(null!=t){o=(o=E.RowIdxToRelRowIdx(t))!==(a=E.GetWholeRowDisplayCapacity()-1)?a:2*a;t=E.RelRowIdxToRowIdx(o)}break;case n.JsGridConstants.Key.pageUp:if(!y&&!p)return null;if(null!=t){var o=E.RowIdxToRelRowIdx(t),a=E.GetWholeRowDisplayCapacity()-1;o=0!==o?0:-a;t=E.RelRowIdxToRowIdx(o)}break;case n.JsGridConstants.Key.home:if(!(y||p||c||m))return null;s=0;e.ctrlKey&&(t=0);f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&(s=-1);break;case n.JsGridConstants.Key.end:if(!(y||p||c||m))return null;s=E.GetVirtualColumnCount()-1+l;e.ctrlKey&&(t=E.GetVirtualRowCount()-1+l);break;case n.JsGridConstants.Key.right:if(!y&&!p)return null;if(null!=s){s+=i._objBag.RTL.bEnabled?-1:1;s=E.GetVirtualColumnCount()-1!==s||i._objBag.RTL.bEnabled?s:s+l;f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&i._selectionMgr.GetLastSelectionType()===u.SelectionType.RowRange&&(s=0)}break;case n.JsGridConstants.Key.left:if(!y&&!p)return null;if(null!=s){s-=i._objBag.RTL.bEnabled?-1:1;s=E.GetVirtualColumnCount()-1===s&&i._objBag.RTL.bEnabled?s+l:s}break;case n.JsGridConstants.Key.six:if(!m)return null;s=0;t=E.GetVirtualRowCount()-1;break;default:return null}if(null!=t){g||-1!==Math.min(E.GetVirtualRowCount()-1,t)||e.shiftKey||i._gridPane.SetFocusToHeader(s+1);t=f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?Math.max(-1,Math.min(E.GetVirtualRowCount()-1,t)):Math.max(0,Math.min(E.GetVirtualRowCount()-1,t))}null!=s&&(s=f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?Math.max(-1,Math.min(E.GetVirtualColumnCount()-1,s)):Math.max(0,Math.min(E.GetVirtualColumnCount()-1,s)));return{rowIdx:t,colIdx:s}};if(c||h||p||v||y||m)if(e.keyCode==n.JsGridConstants.Key.tab){if(null!=(s=(function(t,n){var s=n,o=t;if(e.shiftKey){if(--n==(f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?-1:0)-1){n=E.GetVirtualColumnCount()-1+l;if(-1==--t){if(!f||r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive)return null;i._gridPane.SetFocusToHeader(E.GetVirtualColumnCount())}}}else if(++n==E.GetVirtualColumnCount()+l){n=f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?-1:0;if(++t==E.GetVirtualRowCount()){if(!r.JsGridUtil.Internal.IsFeatureEnabled(T))return null;n=s;t=o}}return{rowIdx:t,colIdx:n}})(b.rowIdx,b.colIdx))){if(f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){w.UpdateRowClassesOnSingleCellSelection(b.rowIdx,s.rowIdx);w._selectAllCell.GetTd().classList.remove(d.allRowsSelected)}-1===s.rowIdx?w.HideFocusStyles():i._selectionMgr.SetFocusByPos(w,s.rowIdx,s.colIdx);return!0}}else if(!e.shiftKey||p&&e.keyCode==n.JsGridConstants.Key.enter){if(null!=(s=t(b.rowIdx,b.colIdx))){if(f&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){w.UpdateRowClassesOnSingleCellSelection(b.rowIdx,s.rowIdx);w._selectAllCell.GetTd().classList.remove(d.allRowsSelected)}-1===s.rowIdx?w.HideFocusStyles():i._selectionMgr.SetFocusByPos(w,s.rowIdx,s.colIdx);return!0}}else{var s,o=i._selectionMgr.GetLastSelectionEndpoints();if(null!=(s=t(o.rowIdx2,o.colIdx2))){if(-1===s.colIdx&&-1===o.colIdx1&&-1===o.colIdx2||-1===s.rowIdx)return!0;null!=s.rowIdx&&null!=s.colIdx?w.ScrollCellIntoView(s.rowIdx,s.colIdx):null!=s.rowIdx?i._fnScrollIntoViewVertically(s.rowIdx):null!=s.colIdx&&w.ScrollColumnIntoViewHorizontally(s.colIdx);i._selectionMgr.SelectRange(w,o.rowIdx1,s.rowIdx,o.colIdx1,s.colIdx,u.SelectOp.Set,!1,!1);return!0}}return!1})()||(function(){var t=i._gridPane.GetGridPaneConverter();if(e.keyCode==n.JsGridConstants.Key.tab){if(i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid)if(y){if(w.Id==n.JsGridConstants.PaneId.MainGrid){i._selectionMgr.SetFocusByPos(i._pivotedGridPane,0,0);return!0}}else if(p&&w.Id==n.JsGridConstants.PaneId.PivotedGrid){var r=t.GetVirtualRowCount()-1,s=t.GetVirtualColumnCount()-1;i._selectionMgr.SetFocusByPos(i._gridPane,r,s);return!0}i._selectionMgr.Clear()}else if(e.keyCode==n.JsGridConstants.Key.F6&&!e.ctrlKey&&i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid){if(w.Id==n.JsGridConstants.PaneId.MainGrid){i._selectionMgr.SetFocusByPos(i._pivotedGridPane,i._pivotedGridPane.GetGridPaneConverter().GetTopRowIdxForKey(b.recordKey),0);return!0}if(w.Id==n.JsGridConstants.PaneId.PivotedGrid){i._selectionMgr.SetFocusByPos(i._gridPane,t.GetTopRowIdxForKey(b.recordKey),0);return!0}}return!1})();N||t||(N=(function(){var t=i._objBag.cutcopypasteMgr;if((e.ctrlKey||e.rawEvent&&e.rawEvent.metaKey)&&!e.altKey&&!e.shiftKey)switch(String.fromCharCode(e.keyCode).toUpperCase()){case"X":t.OnCut(w);return!0;case"C":t.OnCopy(w);return!0;case"V":t.OnPaste(w);return!i._supportChromePaste||t.hasClipBoardData()}return!1})()||(function(){var t=w.GetCellByIdx(b.rowIdx,b.colIdx);if(null!=t){var n=t.GetRecord();if(null!=n){var r=t.GetColumn(),o=t.GetFieldKey(),u=i._gridFieldMap[o],a=n.GetProp(o),f=null==a?u.GetPropType():a.propType,l=s.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(f,r.fnGetDisplayControlName&&r.fnGetDisplayControlName(n,o));if(null!=l.OnKeyDown)return l.OnKeyDown(e,i._fnGetCellValue(n,o,f),n,r,u,f,i._objBag.jsGridObj)}}return!1})());N||(N=(function(t){if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&"Y"==String.fromCharCode(e.keyCode).toUpperCase()){var r=w.IsRowHeadersEnabled()?1:0;if(i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid&&w.Id==n.JsGridConstants.PaneId.PivotedGrid){var s=w.GetVisibleColumns().length;i._pivotedGridPane.SetFocusToHeader(s+t+r)}else i._gridPane.SetFocusToHeader(t+r);return!0}return!1})(b.colIdx-w.BeginColIdx()));if(N){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}!i._editMgr.IsEditing()&&i._selectionMgr.IsOneCellSelected(i._selectionMgr.GetLastSelectionRangeNormalized())&&i._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnSingleCellKeyDown,r.JsGridUtil.EventArgs.SingleCellKeyDown(e,b.recordKey,b.fieldKey));return!1};e.prototype.FocusElementIsBeingUsedForTextInput=function(){return this._editMgr.IsEditing()&&null!=this.GetFocusElementForTextInput(this._editMgr.GetCurrentEditControlName())&&this._editMgr.IsCurrentEditControlUsingGridTextInputElement()};e.prototype.OnFocus=function(){if(!this.FocusElementIsBeingUsedForTextInput()&&this._fnIsGridVisible()){var e=this._selectionMgr.GetFocus();if(null==e){if(null==this._gridPane)return;var t=this._gridPane.GetGridPaneConverter();if(0==t.GetVirtualRowCount())return;this._selectionMgr.SetFocusByPos(this._gridPane,t.GetTopRowIdx(),this._gridPane.GetLeftMostColumnIdx())}else e.gridPane.ShowFocus(!0);if(null!=this._curFocusedDisplayControlInfo){this._curFocusedDisplayControlInfo=null;this._focusElementType==this.FocusElementType.input&&this._parentNode.removeEventListener("keydown",this.OnKeyDown)}}};e.prototype.OnKeyDown=function(e){var t=this;if(this.FocusElementIsBeingUsedForTextInput())this._editMgr.OnActorKeyDown(e,this._editMgr.GetCurrentEditControlName());else if(this._editMgr.IsEditing()){if(this._focusElementType!=this.FocusElementType.input)return;this._editMgr.StopEditing();this.HandleKeyDown(e)}else{var i=e.ctrlKey||e.rawEvent&&e.rawEvent.metaKey;if(r.JsGridUtil._lookupFieldCopyPasteKillSwitchIsActive||!i||e.altKey||e.shiftKey||"V"!==String.fromCharCode(e.keyCode).toUpperCase())this.HandleKeyDown(e);else{var s=[r.JsGridUtil.taxonomyLoadCallback],o=r.JsGridUtil.Internal.SiteUrl+"/",u=n.JsGridConstants.csomFiles.map(function(e){return o+e});r.JsGridUtil.csomJsFilesLoader._ensureExternalJsFilesLoaded(u,function(){return t.HandleKeyDown(e)},s)}}};e.prototype.OnKeyPress=function(e){var t=this;if(!this._editMgr.IsEditing()){var n=this._selectionMgr.GetFocus();if(this._fnIsGridEnabled()&&null!=n){var i=n.gridPane;if(!r.JsGridUtil.Internal.IsFeatureEnabled(S)||r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive||-1!==n.colIdx&&this._selectionMgr.GetLastSelectionType()!==u.SelectionType.RowRange){!r.JsGridUtil.Utility.IsChar(e)||e.altKey||e.ctrlKey||i.TryBeginEdit(e)&&!t.FocusElementIsBeingUsedForTextInput()&&r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)}}}};e.prototype.OnKeyUp=function(e){this._editMgr.IsEditing()||this._focusElementType===this.FocusElementType.input&&(this._focusElement.value="")};e.prototype.CreateFocusElement=function(){switch(this._focusElementType){case this.FocusElementType.anchor:this._focusElement=this.CreateFocusElementAnchor();this.CreateSkipGridHtmlElements(this._focusElement,this._focusElement);break;case this.FocusElementType.input:this._focusElement=this.CreateFocusElementInput();this.SetStyleForFocusElementInput();w&&this.CreateSkipGridHtmlElements(this._parentNode,this._parentNode);break;case this.FocusElementType.parentNode:this._focusElement=this.CreateFocusElementParentNode();this.CreateSkipGridHtmlElements(this._parentNode,this._parentNode);break;default:r.JsGridUtil.DebugAssert(!1,"Invalid focus element type")}r.JsGridUtil._removeExtraPasteListenerKillSwitchIsActive&&this._focusElement.addEventListener("paste",this.onPaste.bind(this))};e.prototype.onPaste=function(e){if(!this._supportChromePaste)return!0;var t;e.rawEvent&&(e=e.rawEvent);if(e&&e.clipboardData&&e.clipboardData.types&&e.clipboardData.getData){var n=this._selectionMgr.GetFocus();t=e.clipboardData.getData("text/plain");this._objBag.cutcopypasteMgr.OnPaste(n.gridPane,t);return!1}return!0};e.prototype.CreateFocusElementAnchor=function(){var e=document.createElement("a");e.id=this._jsGridElementId+"_focusElement";e.href="#";this._outerGridParentNode.insertBefore(e,this._parentNode);e.appendChild(this._parentNode);return e};e.prototype.CreateFocusElementInput=function(){var e=document.createElement("input");e.id=this._jsGridElementId+"_focusElement";var t=r.JsGridUtil.Internal.IsFeatureEnabled(S)?p.spGridControlFocusElement:"jsgrid-control-editbox jsgrid-control-focuselement";e.className=t;!b&&this._parentNode.parentNode?this._parentNode.parentNode.appendChild(e):this._parentNode.insertBefore(e,this._parentNode.firstChild);return e};e.prototype.SetStyleForFocusElementInput=function(e){var t=this,n=this._focusElement.style;if(!m){n.background="transparent";n.borderColor="transparent";n.color="transparent";n.outlineColor="transparent";n.borderWidth="0px";n.outlineWidth="0px";n.outline="none"}n.position="fixed";n.top="0px";n[this._objBag.RTL.left]="-10000px";n[this._objBag.RTL.right]="";this._focusElement.value="";if(e){var i=r.JsGridUtil.Internal.GetScrollParent(this._focusElement),s={x:i.scrollLeft+document.body.clientWidth/3,y:i.scrollTop+document.body.clientHeight/3};if(null!=s){n.top=String(s.y)+"px";v?n.left=String(s.x)+"px":n[this._objBag.RTL.left]=String(s.x)+"px"}this._focusElement.focus();null!=s&&window.setTimeout(function(){n.top="0px";v?n.left="-10000px":n[t._objBag.RTL.left]="-10000px"},0)}};e.prototype.CreateFocusElementParentNode=function(){this._parentNode.tabIndex=0;return this._parentNode};e.prototype.CreateSkipGridHtmlElements=function(e,t){var i=this;this._skipGridContentElement=document.createElement("a");this._skipGridContentElement.id=this._jsGridElementId+"_skipGridContent";this._skipGridContentElement.href="javascript:;";this._skipGridContentElement.className=v?"ms-accessible ms-acc-button":"ms-accessible-quickedit ms-acc-button";r.JsGridUtil.Internal.IsFeatureEnabled(S)&&(this._skipGridContentElement.className=p.skipGridContentButton);this._skipGridContentElement.onclick=function(){document.getElementById(i._jsGridElementId+"_skippedGridContent").focus()};r.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._skipGridContentElement,SP.JsGrid.Res.skipGridContent);this._outerGridParentNode.insertBefore(this._skipGridContentElement,e);this._skippedGridContentElement=document.createElement("a");this._skippedGridContentElement.id=this._jsGridElementId+"_skippedGridContent";this._skippedGridContentElement.href="javascript:;";this._skippedGridContentElement.className=v?"ms-accessible ms-acc-button":"ms-accessible-quickedit ms-acc-button";r.JsGridUtil.Internal.IsFeatureEnabled(S)&&(this._skippedGridContentElement.className=p.skipGridContentButton);this._skippedGridContentElement.onclick=function(){document.getElementById(i._jsGridElementId+"_skipGridContent").focus()};r.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._skippedGridContentElement,SP.JsGrid.Res.backToTopOfGridContent);this._outerGridParentNode.insertBefore(this._skippedGridContentElement,t.nextSibling);this._skippedGridContentElement.addEventListener("keydown",function(e){if(e.shiftKey&&e.keyCode==n.JsGridConstants.Key.tab){if(null==i._selectionMgr.GetFocus()){var t=i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid?i._pivotedGridPane:i._gridPane,r=t.GetGridPaneConverter(),s=r.GetVirtualRowCount()-1,o=r.GetVirtualColumnCount()-1;i._selectionMgr.SetFocusByPos(t,s,o)}}})};e.prototype.Init=function(){r.JsGridUtil.DebugAssert(this._focusElementType==this.FocusElementType.input,"Focus element needs to be an input (see xbrowser+IME support req). This may change only if code branches to use the parentNode or the TDs for More Access. Mode.");this.CreateFocusElement();this._ariaMgr=this._objBag.ariaMgr=new C(this);this._focusElement.addEventListener("focus",this.OnFocus.bind(this));this._focusElement.addEventListener("keydown",this.OnKeyDown.bind(this));this._focusElement.addEventListener("keypress",this.OnKeyPress.bind(this));this._focusElement.addEventListener("keyup",this.OnKeyUp.bind(this));if(r.JsGridUtil.Internal.IsFeatureEnabled(T)){this._gridFocusEntryPoint.addEventListener("keydown",this.OnFocusEntryPointKeyDown);this._gridFocusEntryPoint.addEventListener("focus",this.OnFocusEntryPointFocus);this._focusElement.addEventListener("blur",this.OnBlur)}r.JsGridUtil._removeExtraPasteListenerKillSwitchIsActive&&this._focusElement.addEventListener("paste",this.onPaste.bind(this))};return e})();t.FocusManager=N;var C=(function(){function e(e){this._focusMgr=e;this.Init()}e.prototype.Init=function(){this._focusMgr._focusElement.setAttribute("role","grid");var e=document.createElement("label");e.id=this._focusMgr._focusElement.id+"_labelFor";e.setAttribute("for",this._focusMgr._focusElement.id);e.appendChild(document.createTextNode(this._focusMgr._objBag.jsGridObj.name));e.style.cssText="display:none;";this._focusMgr._parentNode.appendChild(e);this._focusMgr._focusElement.setAttribute("aria-label",this._focusMgr._objBag.jsGridObj.name);this._focusMgr._focusElement.setAttribute("aria-labelledby",this._focusMgr._focusElement.id+"_labelFor");this._focusMgr._focusElement.setAttribute("aria-multiselectable","true");this._focusMgr._focusElementType==this._focusMgr.FocusElementType.input&&this._focusMgr._focusElement.setAttribute("aria-owns",this._focusMgr._jsGridElementId)};e.prototype.NotifyViewChange=function(){this.EnableGrid(this._focusMgr._fnIsGridEnabled());this.EnableGridEditing(this._focusMgr._objBag.editUtil.IsEditingEnabled())};e.prototype.EnableGrid=function(e){this._focusMgr._focusElement.setAttribute("aria-disabled",(!e).toString())};e.prototype.EnableGridEditing=function(e){this._focusMgr._focusElement.setAttribute("aria-readonly",(!e).toString())};e.prototype.OnFocusCell=function(e,t,n,r,i){var s,o;if(null!=t){(u=t.GetTd()).removeAttribute("id");u.removeAttribute("aria-describedby");y||u.removeAttribute("contenteditable");this.SetSelected(u,!1);if(null!=n){(h=n.GetTd()).removeAttribute("id")}}if(null!=r){var u=r.GetTd(),a=l.format("{0}_{1}_{2}_{3}",this._focusMgr._jsGridElementId,e,r.GetRowIdx(),null!=(s=r.GetColIdx())?s:"selectionCell");u.setAttribute("id",a);this._focusMgr._focusElement.setAttribute("aria-activedescendant",a);this.SetSelected(u,!0);var f=r.GetRecord(),c=null!=f&&this._focusMgr._objBag.editUtil.CanEditField(f,r.GetColumn(),r.GetFieldKey());u.setAttribute("aria-readonly",(!c).toString());E&&u.setAttribute("contenteditable",c.toString());if(null!=i){var h=i.GetTd(),p=l.format("{0}_{1}_{2}",this._focusMgr._jsGridElementId,e,null!=(o=i.GetColIdx())?o:"selectionCell");h.setAttribute("id",p);u.setAttribute("aria-describedby",p)}}else this._focusMgr._focusElement.removeAttribute("aria-activedescendant")};e.prototype.OnInsertTableRow=function(e,t,r){e.setAttribute("role","row");if(null!=t||-1!=r){null!=t&&t!==n.JsGridConstants.Internal.LoadErrorState||e.setAttribute("aria-busy",null==t?"true":"error");var i=this._focusMgr._selectionMgr.GetFocusedPane(),s=this._focusMgr._selectionMgr.IsRowSelected(i,r);this.SetSelected(e,s)}else e.setAttribute("aria-label",h.default.columnHeaderOperationAriaLabel)};e.prototype.OnInsertRowHeaderCell=function(e){e.setAttribute("role","presentation")};e.prototype.OnInsertColHeaderCell=function(e){e.setAttribute("scope","col");e.setAttribute("role","columnheader");e.setAttribute("tabindex","0")};e.prototype.OnInsertGridCell=function(e){e.setAttribute("role","gridcell")};e.prototype.SetSelected=function(e,t){e.setAttribute("aria-selected",t.toString())};return e})();t.ARIAManager=C});
define("MGe",["require","exports","o","r","cGe","eGe","PGe","oGe","bGe","nc","oc","HN","ce","iGe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";d=d.tablemgr_9;Object.defineProperty(t,"__esModule",{value:!0});t.addNewItemVisualRefreshKillswitchIsActive=h.Killswitch.isActivated("0599934F-435D-4947-863A-B165DD60BCF5","04/09/2020","update inline new item row style");t.tearDownStickyColumnKillswitchIsActive=h.Killswitch.isActivated("240CA0AF-7931-4C5F-A2E8-5970CC5D1434","07/10/2020","turn off sticky column if the window becomes too small to support it");t.extraSpacerColumnsKillswitchIsActive=h.Killswitch.isActivated("d53e19a7-5114-4a07-b430-991910d21dac","07/24/2020","add extra columns to quickedit for spacing for WebViewList, aka List App view");var v=h.Killswitch.isActivated("0A111CEE-8DE5-4D5A-8ABF-564CA178EE70","8/05/2020","Adding a data-error-message attribute for required fields with errors."),m=h.Killswitch.isActivated("61E4C9DD-4B72-4C41-B0FC-3E843EF4D2E7","8/20/2020","Fix the sticky left edge in Lists home."),g={ODB:1725},y={ODB:1439},b={ODB:1757},w={ODB:1198},E={ODB:988};t.FIELD_TITLE_SPAN_CLASSNAME="ms-DetailsHeader-cellName";var S=(function(){function e(e,t,n,r,s,u,a,f,c,h,p,v,g){var y=this;this.leftmostColIdx=0;this.columns=[];this.rowRecords=[];this.tableColCount=0;this.loadingRects=[];this.errorDivs={};this.rowHeaderStateDivs={};this.tableMgr=this;this.tdCoordsHorizontalAdjustment=null;this.rowCoordCache=[];this.colCoordCache=[];this.fieldsWithErrors={};this.CellType={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3};this._assessedTableHeight=!1;this.HandleWindowResize=function(){var e=i.JsGridUtil.Internal.noSizeForSticky;if(i.JsGridUtil.Internal.GetStickyDataColumnsWidth(y.columns)+i.JsGridUtil.Internal.stickyLeftEdgeOffset>i.JsGridUtil.Internal.GetScrollParent(y._parentDiv).clientWidth/2){i.JsGridUtil.Internal.noSizeForSticky=!0;if(e!=i.JsGridUtil.Internal.noSizeForSticky){y._stickyLeftEdgeKeeperContainer.parentElement.removeChild(y._stickyLeftEdgeKeeperContainer);y._objBag.paneMgr.UpdateColumns(y._objBag.paneMgr.gridPane.allColumns);for(var t=document.getElementsByClassName(d.gridStickyCheckColumn);t.length>0;){t[0].classList.remove(d.gridStickyChromeLeft);t[0].classList.remove(d.gridStickyCheckColumn)}var n=y._objBag.paneMgr.gridPane.selectionDragHandle,r=n.parentElement;r.removeChild(n);var s=y._objBag.paneMgr.CreateDragHandle();r.insertBefore(s,r.children[0]);y._objBag.paneMgr.gridPane.selectionDragHandle=s;y._objBag.paneMgr.gridPane.UpdateSelectionFrames()}}if(!m){var o=y.GetProperTableHeight().toString()+"px";y._stickyLeftEdgeKeeper.style.height=o;y._stickyColumnShadow.style.height=o}};this._parentDiv=e;this._baseId=t;this._paneSize=n;this._fnGetLocStr=r;this._objBag=s;this._fnInsertedRow=u;this._fnInsertedColumns=a;this._fnRemovedColumns=f;this._fnRemovedHeaderCell=c;this._fnSetHeaderHeight=h;this._fnPopulateCell=p;this._fnRetryErrorRows=v;this._fnTryDisposeRow=g;this.cellErrorJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.AddOrUpdateCellError.bind(this));this.paneConverter=new o.GridPaneConverter(s);this.ariaMgr=s.ariaMgr;this.renderCtx=s.jsGridObj.GetSpCsrRenderCtx();this.selectionMgr=s.selectionMgr;this._selectionCircleIcon=l.getIcon("CircleRing");this._selectionCheckmarkIcon=l.getIcon("StatusCircleCheckmark");this._addNewItemIcon=l.getIcon("Add");this.Init()}e.prototype.GetGridPaneConverter=function(){return this.paneConverter};e.prototype.Dispose=function(){i.JsGridUtil.Internal.IsStickyColumnFlightEnabled()&&(t.tearDownStickyColumnKillswitchIsActive||window.removeEventListener("resize",this.HandleWindowResize));this.DisposeLoadingRects();this.tableElem=this._parentDiv=null};e.prototype.SetPosConverterObj=function(e){this.posConverter=e;this.paneConverter.SetPosConverterObj(e)};e.prototype.GetHeaderHeight=function(){i.JsGridUtil.DebugAssert(0!==this.tableElem.rows.length);return this.tableElem.rows[0].offsetHeight};e.prototype.SetHeaderHeight=function(e){this.headerHeight=e;if(this.tableElem.rows.length>0){this.tableElem.rows[0].style.height=this.headerHeight-1+"px";this._fnSetHeaderHeight(this.headerHeight)}};e.prototype.SetRowHeight=function(e){this.rowHeight=i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7?e-1:e};e.prototype.GetTdDefaultCssText=function(){return this.styleForTd};e.prototype.InitTable=function(e){var o=this;this.ClearTable();this.tableColCount=0;this.bRowHeadersEnabled=e;this.tableColIdxOfFirstDataCol=this.bRowHeadersEnabled?1:0;var u,a=i.JsGridUtil.Internal.IsFeatureEnabled(g),l=i.JsGridUtil.Internal.IsFeatureEnabled(y),c=this.tableElem.insertRow(-1);c.recordKey="__colheaders";this.ariaMgr.OnInsertTableRow(c,null,-1);if(this.bRowHeadersEnabled){var h=document.createElement("th");h.scope="col";h.nowrap="nowrap";if(a){h.className=d.gridSelectAllIconContainer;var v=this.renderCtx&&this.renderCtx.ListSchema&&this.renderCtx.ListSchema.Field,m=(v?v.length:0)+2,b=s.JsGridConstants.Internal.zIndex.tableHeader+m;h.style.zIndex=b}else{h.className=d.spGridSelectAllIconContainer;h.style.borderBottom="1px solid "+this._objBag.styleMgr.gridPaneStyle.horizontalBorderColor}if(l&&a){h.classList.add(d.selectAllCheckMarkCell);h.innerHTML=this.GetSelectionCheckElement("all")}else n.render(r.createElement(f.Icon,{iconName:"CheckMark",className:d.spGridSelectAllIcon}),h);var w=document.createElement("div");w.setAttribute("colid","dropHint");if(a){w.style.position="absolute";w.style.right="1px";w.style.top="2px"}else{w.style.cssFloat=this._objBag.RTL.right;w.style.position="relative";w.style.left="1px";w.style.top="7px"}w.style.zIndex="1";n.render(this._objBag.dragDropMgr.renderDropHint(0),w);h.appendChild(w);if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){h.classList.add(d.gridStickyCheckColumn);h.classList.add(d.gridStickyCheckColumnHeader);i.JsGridUtil.Internal.stickyChromeless?h.classList.add(d.gridStickyChromelessLeft):h.classList.add(d.gridStickyChromeLeft)}this.tableElem.rows[0].appendChild(h);this.tableColCount++;u=new x(0,0,this);if(a&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){this.ariaMgr.OnInsertColHeaderCell(h);h.setAttribute("aria-label",p.default.selectAllRowsCell);h.addEventListener("keydown",function(e){var t,n=o._objBag.focusMgr,r=null===(t=n)||void 0===t?void 0:t._gridPane;if(r){if(e.keyCode===s.JsGridConstants.Key.enter||e.keyCode===s.JsGridConstants.Key.space){r.SelectAllRows();n.Focus()}(e.keyCode===s.JsGridConstants.Key.right||e.keyCode===s.JsGridConstants.Key.tab&&!e.shiftKey)&&r.SetFocusToHeader(1);if(e.keyCode===s.JsGridConstants.Key.down){o.selectionMgr.SetFocusByPos(r,0,-1);n.Focus()}i.JsGridUtil.Internal.IsFeatureEnabled(E)&&e.keyCode===s.JsGridConstants.Key.tab&&e.shiftKey&&e.preventDefault();if(i.JsGridUtil.Internal.IsFeatureEnabled(E)&&e.keyCode===s.JsGridConstants.Key.esc){r.HideFocusStyles();r.ScrollCellIntoView(0,0);n._gridFocusEntryPoint.focus()}if(e.keyCode===s.JsGridConstants.Key.enter||e.keyCode===s.JsGridConstants.Key.space||e.keyCode===s.JsGridConstants.Key.right||e.keyCode===s.JsGridConstants.Key.down||e.keyCode===s.JsGridConstants.Key.tab&&!e.shiftKey){e.preventDefault();e.stopPropagation()}}})}else this.ariaMgr.OnInsertRowHeaderCell(h)}c.className="ms-viewheadertr ms-vhltr";c.classList.add(d.tableColumnHeadersRow);c.vAlign="top";if(!t.extraSpacerColumnsKillswitchIsActive){var S=document.createElement("th");S.setAttribute("role","presentation");S.classList.add("ms-listview-columnSpacer");var T=document.createElement("th");T.setAttribute("role","presentation");T.classList.add("ms-listview-lastColumn");this.tableElem.rows[0].appendChild(S);this.tableElem.rows[0].appendChild(T)}return u};e.prototype.SetColumns=function(e,t){i.JsGridUtil.Internal.IsStickyColumnEnabled()&&(e.length&&"DocIcon"===e[0].internalName?i.JsGridUtil.Internal.stickyLastColIdx=1:i.JsGridUtil.Internal.stickyLastColIdx=0);if(this.columns.length){this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,this.GetDataColCount());this.leftmostColIdx=0}this.columns=e;t?this.paneConverter.SetView(this.columns):this.paneConverter.NotifyColumnsChanged(this.columns);this.OptimizeTableColumns()};e.prototype.ClearTable=function(){this.rowRecords.length>0&&this.SpliceRows(0,this.rowRecords.length,null,0);this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,this.GetDataColCount());this.leftmostColIdx=0;for(;this.tableElem.rows.length>0;)this.tableElem.deleteRow(0);i.JsGridUtil.DebugAssert(0==this.tableElem.rows.length)};e.prototype.SpliceRows=function(e,t,n,r){var i=r.length,s=i>1;s&&this._parentDiv.removeChild(this.tableElem);if(null!=e&&0!==t){this.rowRecords.splice(e,t);for(var o=t-1;o>=0;o--)this.DeleteTableRow(e+o)}if(null!=n&&0!==i){Array.prototype.splice.apply(this.rowRecords,[n,0].concat(r));for(o=0;o<i;o++)this.InsertTableRow(n+o,this.rowRecords[n+o],s)}s&&this._parentDiv.appendChild(this.tableElem);this.RefreshLoadingRects()};e.prototype.RenderRows=function(e){for(var t in e){var n=e[t],r=parseInt(t,10);this.DeleteTableRow(r);this.rowRecords[r]=n;this.InsertTableRow(r,n)}i.JsGridUtil.Internal.IsAssocArrayEmpty(e)||(this.rowRecords=[].concat(this.rowRecords));this.RefreshLoadingRects()};e.prototype.InsertColumns=function(e,t){var n=this.ColIdxToTableColIdx(e);Array.prototype.splice.apply(this.columns,[e,0].concat(t));this.paneConverter.NotifyColumnsChanged(this.columns);n>=this.tableColIdxOfFirstDataCol&&n<=this.tableColCount&&this.InsertTableColumns(n,t.length);for(var r=0;r<t.length;r++)for(var i=t[r],s=0;s<this.rowRecords.length;s++)if(null==this.rowRecords[s].properties[i.columnKey]){var o=this._objBag.tableCache.GetCachedRecord(s);if(null!=o){var a=o.GetProp(i.columnKey);null!=a&&(this.rowRecords[s].properties[i.columnKey]=u.PropertyType.Property.prototype.MakeProperty(void 0,void 0,a.HasDataValue(),a.HasLocalizedValue(),a.propType))}}this.OptimizeTableColumns()};e.prototype.RefreshCell=function(e){var t=e.GetRecordKey(),n=e.GetFieldKey();this.ClearCellError(t,n);e.GetTd().innerHTML="";this._fnPopulateCell(e);this.UpdateCoordCache();this._objBag.errorMgr.CellHasError(t,n)&&this.AddOrUpdateCellError(t,n)};e.prototype.RemoveColumns=function(e,t){var n=this.ColIdxToTableColIdx(e);if(n>=this.tableColIdxOfFirstDataCol&&n<this.tableColCount){var r=t;n+t>this.tableColCount&&(r-=n+t-this.tableColCount);this.RemoveTableColumns(n,r)}this.columns.splice(e,t);this.paneConverter.NotifyColumnsChanged(this.columns);this.OptimizeTableColumns()};e.prototype.ScrollColumns=function(e){var t=this.CalcOptimalDataColumnCount(e),n=this.GetDataColCount(),r=this.leftmostColIdx;this.UpdateCoordCache();if(e>r){this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,Math.min(n,e-r));this.leftmostColIdx=e}else if(e<r){this.leftmostColIdx=e;this.InsertTableColumns(this.tableColIdxOfFirstDataCol,Math.min(t,r-e))}this.OptimizeTableColumns()};e.prototype.ChangeKeys=function(e,t){if(this.paneConverter.IsRecordOnScreen(e))for(var n=this.tableElem.rows.length-1;n>=0;n--)if(this.tableElem.rows[n].recordKey==e){this.tableElem.rows[n].recordKey=t;break}if(e in this.errorDivs){this.errorDivs[t]=this.errorDivs[e];delete this.errorDivs[e]}if(e in this.rowHeaderStateDivs){this.rowHeaderStateDivs[t]=this.rowHeaderStateDivs[e];delete this.rowHeaderStateDivs[e]}};e.prototype.OptimizeTableColumns=function(){var e=this.CalcOptimalDataColumnCount(this.leftmostColIdx),n=this.GetDataColCount()-e;if(n<0)this.InsertTableColumns(this.tableColCount,-n);else if(n>0)this.RemoveTableColumns(this.tableColCount-n,n);else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){if(!this._stickyLeftEdgeKeeperContainer){this._stickyLeftEdgeKeeperContainer=document.createElement("DIV");this._stickyLeftEdgeKeeperContainer.id="StickyLeftEdgeKeeperContainer";this._stickyLeftEdgeKeeperContainer.classList.add(d.stickyLeftEdgeKeeperContainer);i.JsGridUtil.Internal.stickyChromeless?this._stickyLeftEdgeKeeperContainer.classList.add(d.stickyLeftEdgeKeeperContainerChromeless):this._stickyLeftEdgeKeeperContainer.classList.add(d.stickyLeftEdgeKeeperContainerWithChrome);this._stickyLeftEdgeKeeper=document.createElement("DIV");this._stickyLeftEdgeKeeper.id="StickyLeftEdgeKeeper";this._stickyLeftEdgeKeeper.classList.add(d.stickyLeftEdgeKeeper);i.JsGridUtil.Internal.stickyChromeless?this._stickyLeftEdgeKeeper.classList.add(d.stickyLeftEdgeKeeperChromeless):this._stickyLeftEdgeKeeper.classList.add(d.stickyLeftEdgeKeeperWithChrome);this._stickyLeftEdgeKeeper.style.height=this.GetProperTableHeight().toString()+"px";this._stickyLeftEdgeKeeperContainer.appendChild(this._stickyLeftEdgeKeeper);this._stickyColumnShadow=document.createElement("DIV");this._stickyColumnShadow.id="StickyColumnShadow";this._objBag.RTL.bEnabled?this._stickyColumnShadow.className=d.stickyColumnShadowRtl:this._stickyColumnShadow.className=d.stickyColumnShadow;this._stickyColumnShadow.style.height=this.GetProperTableHeight().toString()+"px";this._stickyColumnShadow.style.opacity="0";this._stickyColumnShadow.style.visibility="hidden";this._stickyLeftEdgeKeeperContainer.appendChild(this._stickyColumnShadow);this._parentDiv.insertBefore(this._stickyLeftEdgeKeeperContainer,this._parentDiv.children[0])}this.UpdateLeftEdgeKeeperSizes()}else i.JsGridUtil.Internal.IsStickyColumnFlightEnabled()&&i.JsGridUtil.Internal.noSizeForSticky&&(t.tearDownStickyColumnKillswitchIsActive||this._stickyLeftEdgeKeeperContainer&&this._stickyLeftEdgeKeeperContainer.parentElement.removeChild(this._stickyLeftEdgeKeeperContainer));this.RefreshLoadingRects()};e.prototype.UpdateErrorFrames=function(){for(var e in this.errorDivs)for(var t in this.errorDivs[e])this.AddOrUpdateCellError(e,t,!0)};e.prototype.GetAllDataCells=function(){for(var e=[],t=1;t<this.tableElem.rows.length;t++)for(var n=this.tableColIdxOfFirstDataCol;n<this.tableColCount;n++)e.push(new x(t,n,this));return e};e.prototype.GetSelectAllSquare=function(){return this.bRowHeadersEnabled?new x(0,0,this):null};e.prototype.GetRowHeaderByKey=function(e){if(this.bRowHeadersEnabled&&this.paneConverter.IsRecordOnScreen(e))return new x(this.RowIdxToTableRowIdx(this.paneConverter.GetTopRowIdxForKey(e)),0,this)};e.prototype.GetRowHeader=function(e){if(this.bRowHeadersEnabled){var t=new x(this.RowIdxToTableRowIdx(e),0,this,!0,!1);return t.bIsInvalid?null:t}return null};e.prototype.GetRowHeaders=function(){var e=[];if(this.bRowHeadersEnabled)for(var t=this.tableElem.rows.length,n=1;n<t;n++)e.push(new x(n,0,this));return e};e.prototype.GetColumnHeader=function(e){var t=new x(0,this.ColIdxToTableColIdx(e),this,!0,!1);return t.bIsInvalid||null==t.GetColIdx()?null:t};e.prototype.GetColumnHeaders=function(){for(var e=[],t=this.tableColIdxOfFirstDataCol;t<this.tableColCount;t++)e.push(new x(0,t,this));return e};e.prototype.GetColumnHeaderTr=function(){return this.tableElem.rows[0]};e.prototype.GetRowHeaderWidth=function(){return this.bRowHeadersEnabled?i.JsGridUtil.Internal.IsFeatureEnabled(g)?s.JsGridConstants.Internal.RowHeaderWidthNewStyles:s.JsGridConstants.Internal.RowHeaderWidth:0};e.prototype.GetRowIdxColIdxFromCoord=function(e){for(var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n={},r=this.tableElem.rows,s=1;s<r.length;s++){var o=r[s],u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(o);if(t.y>=u.y&&t.y<u.y+o.offsetHeight){n.rowIdx=this.TableRowIdxToRowIdx(s);n.top=u.y;n.bottom=u.y+o.offsetHeight;break}}var a=this.tableElem.rows[0].cells;for(s=this.bRowHeadersEnabled?1:0;s<a.length;s++){var f=a[s];u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(f);if(t.x>=u.x&&t.x<u.x+f.offsetWidth){n.colIdx=this.TableColIdxToColIdx(s);n.left=u.x;n.right=u.x+f.offsetWidth;break}}return n};e.prototype.UpdateCoordCache=function(){this._objBag.bUpdateCoordCache=!0};e.prototype.ResizeColCoordCache=function(e,t){var n,r=this.colCoordCache[e];if(null!=r){if(0!=(n=(t+=1)-r.width)){r.width=t;this._objBag.RTL.bEnabled?r.left+=n:r.right+=n;for(var s=e+1;s<this.colCoordCache.length;s++)if(null!=(r=this.colCoordCache[s])){r.left+=n;r.right+=n}i.JsGridUtil.Internal.IsStickyColumnEnabled()&&1===e&&this._stickyLeftEdgeKeeper&&this.tableElem&&this.UpdateLeftEdgeKeeperSizes()}}else this.ClearColCoordCache(e)};e.prototype.GetTdCoords=function(e){var t={},n=e.cellIndex,r=e.parentNode.rowIndex;this.UpdateCoordCacheInternal();if(!0!==window.disableGetTdCoordsCache&&null!=this.rowCoordCache[r])this.CopyRowCoords(r,t);else{t.top=this.tableElem.offsetTop+e.offsetTop-1;t.bottom=this.tableElem.offsetTop+e.offsetTop+e.offsetHeight;t.height=t.bottom-t.top;this.InsertIntoCoordCacheArray(this.rowCoordCache,r,this.CloneRowCoords(t))}if(!0!==window.disableGetTdCoordsCache&&null!=this.colCoordCache[n])this.CopyColCoords(n,t);else{if(this._objBag.RTL.bEnabled)if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n==i.JsGridUtil.Internal.stickyLastColIdx+1&&e.nextElementSibling){var s=e.nextElementSibling;t.left=this.tableElem.offsetLeft+(s.offsetLeft-e.offsetWidth);t.right=this.tableElem.offsetLeft+s.offsetLeft+1}else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&1==n&&e.nextElementSibling&&e.nextElementSibling.nextElementSibling){var o=(u=e.nextElementSibling).nextElementSibling;t.left=this.tableElem.offsetLeft+(o.offsetLeft-u.offsetWidth-e.offsetWidth);t.right=t.left+e.offsetWidth+1}else{t.left=this.tableElem.offsetLeft+e.offsetLeft;t.right=this.tableElem.offsetLeft+e.offsetLeft+e.offsetWidth+1}else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n==i.JsGridUtil.Internal.stickyLastColIdx+1&&e.nextElementSibling){s=e.nextElementSibling;t.left=this.tableElem.offsetLeft+(s.offsetLeft-e.offsetWidth-2);t.right=this.tableElem.offsetLeft+s.offsetLeft}else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&1==n&&e.nextElementSibling&&e.nextElementSibling.nextElementSibling){var u;o=(u=e.nextElementSibling).nextElementSibling;t.left=this.tableElem.offsetLeft+(o.offsetLeft-u.offsetWidth-e.offsetWidth);t.right=t.left+e.offsetWidth+1}else{t.left=this.tableElem.offsetLeft+e.offsetLeft-1;t.right=this.tableElem.offsetLeft+e.offsetLeft+e.offsetWidth}if(null!=e.previousSibling){if(null==this.tdCoordsHorizontalAdjustment){var a=this.tableElem.rows[0].cells,f=a[this._objBag.RTL.bEnabled?0:a.length-1],l=f.offsetWidth-(i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7&&!this._objBag.RTL.bEnabled?1:0);this.tdCoordsHorizontalAdjustment=this.tableElem.offsetWidth-(f.offsetLeft+l)}t.left+=this.tdCoordsHorizontalAdjustment;t.right+=this.tdCoordsHorizontalAdjustment}t.width=t.right-t.left;this.InsertIntoCoordCacheArray(this.colCoordCache,n,this.CloneColCoords(t))}return t};e.prototype.GetCellByKey=function(e,t){if(!this.posConverter.IsRecordOnScreen(e))return null;var n=this.paneConverter.KeyToIdx(e,t);return n&&this.GetCellByIdx(n.rowIdx,n.colIdx)};e.prototype.GetCellByIdx=function(e,t){var n=new x(this.RowIdxToTableRowIdx(e),this.ColIdxToTableColIdx(t),this,!0,!0);return n.bIsInvalid?null:n};e.prototype.GetCellByChildElement=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e,"recordKey");if(null==t)return null;var n=t.elem,r=t.child,s=(function(e,t){return i.JsGridUtil.Internal.FindInArray(e.rows,function(e){return e==t})})(this.tableElem,n),o=(function(e,t){for(var n=null,r=e.cells.length-1;r>=0;r--)if(e.cells[r]==t){n=r;break}return n})(n,r);return null!=s&&null!=o?new x(s,o,this):null};e.prototype.GetRowCount=function(){return this.rowRecords.length};e.prototype.GetColumnCount=function(){return this.GetDataColCount()};e.prototype.BeginRowIdx=function(){return this.paneConverter.RelRowIdxToRowIdx(0)};e.prototype.EndRowIdx=function(){return this.BeginRowIdx()+this.rowRecords.length};e.prototype.BeginColIdx=function(){return this.leftmostColIdx};e.prototype.EndColIdx=function(){return this.leftmostColIdx+this.GetDataColCount()};e.prototype.GetRecordByKey=function(e){for(var t in this.rowRecords)if(this.rowRecords[t].recordKey===e)return this.rowRecords[t];return null};e.prototype.GetColumnAutoResizeWidth=function(e){for(var t=this.ColIdxToTableColIdx(e),n=this.tableElem.rows,r=0,i=0;i<n.length;i++)r=Math.max(r,n[i].cells[t].scrollWidth);return r};e.prototype.GetTableWidth=function(){for(var e=this.tableMgr.GetRowHeaderWidth(),t=this.tableMgr.BeginColIdx();t<this.tableMgr.EndColIdx();t++)e+=this.columns[t].width;return e};e.prototype.GetColumnSchema=function(){return this.renderCtx.ListSchema.Field};e.prototype.GetProperTableHeight=function(){if(m)return this.tableElem.clientHeight;if(!this._assessedTableHeight){for(var e=this.tableElem.parentElement;null!=e;){if(-1!=e.className.indexOf("quickEditParentDiv"))this._quickEditParentDiv=e;else if(-1!=e.className.indexOf("layoutPositiningContainer")){this._positiningContainer=e;break}e=e.parentElement}this._assessedTableHeight=!0}return this._positiningContainer&&this._quickEditParentDiv&&this._positiningContainer.clientHeight>this._quickEditParentDiv.clientHeight?this._positiningContainer.clientHeight-(this._quickEditParentDiv.clientHeight-this.tableElem.clientHeight):this.tableElem.clientHeight};e.prototype.InitStyleRules=function(e){var t=e.defaultCellStyle,n=e.gridPaneStyle;this.styleForTd=";vertical-align:middle;border-"+this._objBag.RTL.right+":"+a.StyleUtil.MakeBorderString(1,n.verticalBorderStyle,n.verticalBorderColor)+";border-bottom:"+a.StyleUtil.MakeBorderString(1,n.horizontalBorderStyle,n.horizontalBorderColor)+";color:"+t.textColor+(null!=t.font?";font-family:"+t.font:"")+";font-size:"+t.fontSize+";font-weight:"+t.fontWeight+";font-style:"+t.fontStyle+";text-align:"+t.textAlign+";overflow:hidden;text-overflow:ellipsis"};e.prototype.InsertIntoCoordCacheArray=function(e,t,n){if(t>=e.length){for(var r=e.length;r<t;r++)e.push(null);e.push(n)}else e[t]=n};e.prototype.Init=function(){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){for(var e=0,n=this._parentDiv.offsetParent;n;){e+=n.offsetLeft;if(-1!=n.className.indexOf("layoutPositiningContainer"))break;n=n.offsetParent}this._objBag.RTL.bEnabled?e>0&&(i.JsGridUtil.Internal.stickyLeftEdgeOffset=32):i.JsGridUtil.Internal.stickyLeftEdgeOffset=e;e>0&&(i.JsGridUtil.Internal.stickyChromeless=!1)}this._objBag.eventMgr.AttachEvent(s.JsGridConstants.EventType.OnCellErrorStateChanged,this.DispatchCellError.bind(this));this._objBag.intEventMgr.AttachEvent(s.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,this.DispatchRowStateChange.bind(this));this.InitStyleRules(this._objBag.styleMgr);this.tableElem=document.createElement("table");this.tableElem.cellPadding=this.tableElem.cellSpacing=0;this.tableElem.style.width="1px";this.tableElem.border="0";this.tableElem.cellSpacing="0";this.tableElem.cellPadding="1";this.tableElem.className="ms-listviewtable ms-listviewgrid";this.tableElem.style.borderCollapse="separate";this.tableElem.style.tableLayout="fixed";this.tableElem.id=this._baseId+"_mainTable";this._parentDiv.style.marginRight="3px";this._parentDiv.appendChild(this.tableElem);i.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t.tearDownStickyColumnKillswitchIsActive||window.addEventListener("resize",this.HandleWindowResize))};e.prototype.DispatchCellError=function(e){this.paneConverter.IsRecordOnScreen(e.recordKey)&&(!e.bCellCurrentlyHasError||e.recordKey in this.errorDivs&&e.fieldKey in this.errorDivs[e.recordKey]?e.bCellCurrentlyHasError||this.ClearCellError(e.recordKey,e.fieldKey):this.AddOrUpdateCellError(e.recordKey,e.fieldKey))};e.prototype.AddOrUpdateCellError=function(e,t,n){var r,s=this.tableMgr.GetCellByKey(e,t);if(null!=s){var o=s.GetTd();e in this.errorDivs||(this.errorDivs[e]={});null==this.errorDivs[e][t]&&(this.errorDivs[e][t]=n?null:this.CreateCellErrorFrames(o));null!=this.errorDivs[e][t]&&(i.JsGridUtil.Internal.IsFeatureEnabled(g)||this.PositionCellErrorFrames(o,this.errorDivs[e][t]));if(!v){if("TRUE"===(null===(r=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t].csrInfo)||void 0===r?void 0:r.Required)){o.setAttribute("data-error-message",this._objBag.errorMgr.GetMessageForCell(e,t));o.classList.add(d.hasErrorData)}}i.JsGridUtil._columnHeaderErrorIndicatorKillSwitchIsActive||this.UpdateColumnHeaderCellError(t,s,!0)}};e.prototype.CreateCellErrorFrames=function(e){var t={};if(i.JsGridUtil.Internal.IsFeatureEnabled(g)){e.classList.add(d.cellHasError);return e}t.Top=document.createElement("div");t.Right=document.createElement("div");t.Bottom=document.createElement("div");t.Left=document.createElement("div");for(var n in t){var r=t[n];r.style.cssText="position:absolute; top:0px; left:0px; width:0px; height:0px;";r.style["border"+n]=a.StyleUtil.MakeBorderString(1,"solid",this._objBag.styleMgr.gridPaneStyle.errorRectBorderColor);e.appendChild(r)}return t};e.prototype.PositionCellErrorFrames=function(e,t){var n=this.tableMgr.GetTdCoords(e),r={Top:{left:n.left+1,top:n.top+1,width:n.width-2},Right:{left:n.right-2,top:n.top+1,height:n.height-2},Bottom:{left:n.left+1,top:n.bottom-2,width:n.width-2},Left:{left:n.left+1,top:n.top+1,height:n.height-2}};for(var i in t){var s=t[i];for(var o in r[i])s.style[o]=r[i][o]+"px"}};e.prototype.ClearAllErrorsForRecord=function(e){var t=this.errorDivs[e];if(null!=t){for(var n in t)this.ClearErrorCore(e,n,!1);delete this.errorDivs[e]}};e.prototype.ClearCellError=function(e,t){var n,r,s,o;if(e in this.errorDivs&&t in this.errorDivs[e]){this.ClearErrorCore(e,t,!0);if(!v){var u=null===(n=this.tableMgr.GetCellByKey(e,t))||void 0===n?void 0:n.GetTd();if("TRUE"===(null===(r=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t].csrInfo)||void 0===r?void 0:r.Required)){null===(s=u)||void 0===s||s.removeAttribute("data-error-message");null===(o=u)||void 0===o||o.classList.remove(d.hasErrorData)}}if(!i.JsGridUtil._columnHeaderErrorIndicatorKillSwitchIsActive){var a=this.tableMgr.GetCellByKey(e,t);a&&this.UpdateColumnHeaderCellError(t,a,!1)}}};e.prototype.ClearErrorCore=function(e,t,n){if(i.JsGridUtil.Internal.IsFeatureEnabled(g))this.errorDivs[e][t].classList.remove(d.cellHasError);else for(var r in this.errorDivs[e][t])if(null!=r){var s=i.JsGridUtil.Internal.DomElement.GetInstance().GetParentElement(this.errorDivs[e][t][r]);i.JsGridUtil.DebugAssert(null!=s);null!=s&&s.removeChild(this.errorDivs[e][t][r])}delete this.errorDivs[e][t];n&&i.JsGridUtil.Internal.IsAssocArrayEmpty(this.errorDivs[e])&&delete this.errorDivs[e]};e.prototype.DispatchRowStateChange=function(e){this.bRowHeadersEnabled&&this.paneConverter.IsRecordOnScreen(e.recordKey)&&(null!=e.rowHeaderState?this.SetRowHeaderState(e.recordKey,e.rowHeaderState):this.ClearRowHeaderState(e.recordKey))};e.prototype.SetRowHeaderState=function(e,t){null!=this.rowHeaderStateDivs[e]&&this.ClearRowHeaderState(e);var n=this.tableMgr.GetRowHeaderByKey(e);i.JsGridUtil.DebugAssert(null!=n);var r=n.GetTd(),s=t.GetOnClick(),o=t.GetImg().Render(t.GetTooltip(),null!=s?function(t){s(t,e);t.stopPropagation();t.preventDefault()}:null,!0);if(i.JsGridUtil.Internal.IsFeatureEnabled(g)){var u=r.firstElementChild;if(u){u.classList.add(d.hasStateElements);u.appendChild(o)}}else{r.innerHTML="";r.appendChild(o)}this.rowHeaderStateDivs[e]=o};e.prototype.ClearRowHeaderState=function(e,t){if(e in this.rowHeaderStateDivs){var n=this.tableMgr.GetRowHeaderByKey(e);i.JsGridUtil.DebugAssert(null!=t||null!=n);var r=null==t?n.GetTd():t;this.ClearHandlers(r);if(i.JsGridUtil.Internal.IsFeatureEnabled(g)){var s=r.firstElementChild;if(s){s.classList.remove(d.hasStateElements);s.removeChild(this.rowHeaderStateDivs[e])}}else r.removeChild(this.rowHeaderStateDivs[e]);delete this.rowHeaderStateDivs[e]}};e.prototype.UpdateColumnHeaderCellError=function(e,n,r){var i,s,o=n.GetColIdx(),u=null===(s=null===(i=this.GetColumnHeader(o))||void 0===i?void 0:i.GetTd())||void 0===s?void 0:s.querySelector("."+t.FIELD_TITLE_SPAN_CLASSNAME);if(r){if(!this.fieldsWithErrors[e]&&u){var a=document.createElement("span");a.className=d.errorAsterisk;a.innerHTML="*";u.parentNode.insertBefore(a,u.nextSibling);this.fieldsWithErrors[e]=a}}else{if(!this._objBag.errorMgr.AnyErrorsInField(e)&&this.fieldsWithErrors[e]&&u&&u.parentNode===this.fieldsWithErrors[e].parentNode){u.parentNode.removeChild(this.fieldsWithErrors[e]);delete this.fieldsWithErrors[e]}}};e.prototype.GetDataColCount=function(){return this.tableColCount-this.tableColIdxOfFirstDataCol};e.prototype.TableRowIdxToRowIdx=function(e){return this.paneConverter.RelRowIdxToRowIdx(e-1)};e.prototype.RowIdxToTableRowIdx=function(e){return this.paneConverter.RowIdxToRelRowIdx(e)+1};e.prototype.TableColIdxToColIdx=function(e){return this.leftmostColIdx+e-this.tableColIdxOfFirstDataCol};e.prototype.ColIdxToTableColIdx=function(e){return e-this.leftmostColIdx+this.tableColIdxOfFirstDataCol};e.prototype.InsertTableRow=function(e,n,r){var o,u=this,f=i.JsGridUtil.Internal.IsFeatureEnabled(g),l=[];i.JsGridUtil.Internal.IsFeatureEnabled(w)&&!n.HasUpdatedValues()&&n.UpdateLocalizedValuesWithColumnData(this.GetColumnSchema());var h=e+1,v=this.tableElem.insertRow(h);v.style.height=this.rowHeight+"px";var m=null!=n&&n!==s.JsGridConstants.Internal.LoadErrorState,y=m?n.key():null;v.recordKey=m?y.toString():null;var b,E="";if(m&&!n.bIsNewRow){n.rowIndex=e;var S=this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.customFormatterProps,T=S?S.additionalRowClass:"";if(T){var N=S&&S.customFormatterSchema,C=this._objBag.jsGridParams.pageContext,k=n&&n.fieldRawDataMap&&n.fieldRawDataMap.csrInfo;(E=new c.CustomFormatter({rowIndex:n?n.rowIndex:-1,fieldRendererFormat:void 0,row:k,currentFieldName:"Title",rowSchema:N,errorStrings:{},pageContextInfo:C}).evalExpression(T))&&(v.className+=E)}}if(f){v.classList.add(d.gridRow,"ms-gridRow");!t.addNewItemVisualRefreshKillswitchIsActive&&n.bIsNewRow&&v.classList.add(d.inLineNewItemRow);i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive||0!==e||v.classList.add(d.rowHasOnlyOneCellSelected)}this.ariaMgr.OnInsertTableRow(v,n,this.TableRowIdxToRowIdx(h));if(this.bRowHeadersEnabled){var L=v.insertCell(-1);if(f){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){L.className="ms-vb-itmcbx ms-vb-firstCell "+d.gridCell+" "+d.firstCell+" "+d.gridStickyCheckColumn+" "+E;i.JsGridUtil.Internal.stickyChromeless?L.className+=" "+d.gridStickyChromelessLeft:L.className+=" "+d.gridStickyChromeLeft}else L.className="ms-vb-itmcbx ms-vb-firstCell "+d.gridCell+" "+d.firstCell;L.setAttribute("aria-label",p.default.selectRowCell);var A=this.selectionMgr.GetFocusedPane();this.selectionMgr.IsRowSelected(A,e)&&v.classList.add(d.rowIsSelected,"is-selected")}else{L.className="ms-vb-itmcbx ms-vb-firstCell "+d.spGridCell;L.style.cssText=this.styleForTd+";border-"+this._objBag.RTL.left+":"+a.StyleUtil.MakeBorderString(1,this._objBag.styleMgr.gridPaneStyle.verticalBorderStyle,this._objBag.styleMgr.gridPaneStyle.verticalBorderColor)+";padding-"+this._objBag.RTL.left+":4px"}L.setAttribute("data-automationid","spgridcell_"+e.toString()+"_firstCell");o=new x(h,0,this);if(f){var O=document.createElement("div");O.classList.add(d.headerStateContainer);var M=document.createElement("div");M.classList.add(d.headerStateBar);O.appendChild(M);var _=document.createElement("div");_.classList.add(d.selectionCheckMark);_.innerHTML=this.GetSelectionCheckElement(e.toString());L.appendChild(O);L.appendChild(_);if(!t.addNewItemVisualRefreshKillswitchIsActive&&n.bIsNewRow){var D=v.previousSibling;D&&D.classList.remove(d.inLineNewItemRow);var P=document.createElement("div");P.classList.add(d.inlineNewItemAddIconContainer);P.innerHTML=this.GetAddNewItemIconElement();L.appendChild(P)}if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._stickyLeftEdgeKeeper){this._lastShadowHeightUpdate=Date.now();window.setTimeout(function(){if(Date.now()-u._lastShadowHeightUpdate>250){u._lastShadowHeightUpdate=Date.now();var e=u.GetProperTableHeight().toString()+"px";u._stickyLeftEdgeKeeper.style.height=e;u._stickyColumnShadow.style.height=e}},300)}this.ariaMgr.OnInsertGridCell(L)}else this.ariaMgr.OnInsertRowHeaderCell(L)}for(var H=this.tableColIdxOfFirstDataCol;H<this.tableColCount;H++){(L=v.insertCell(-1)).setAttribute("data-automationid","spgridcell_"+e.toString()+"_"+H.toString());b=new x(h,H,this);l.push(b);var B=H-1,j="ms-vb2";if(B>=0&&B<this.columns.length){var F=this.columns[B].fieldKeys[0],I=this._objBag.jsGridParams.tableViewParams.gridFieldMap[F].csrInfo;i.JsGridUtil.DebugAssert(null!=this.renderCtx);null!=I&&(j=i.JsGridUtil.Internal.GetCSSClassForFieldTd(I))}if(f){L.className=d.gridCell+" "+j;if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&B<=i.JsGridUtil.Internal.stickyLastColIdx){L.className+=" "+d.gridStickyDataColumn+" "+E;B>0&&(L.className+=" "+d.gridStickySecondDataColumn);i.JsGridUtil.Internal.stickyChromeless?L.className+=" "+d.gridStickyDataLeftChromeless:L.className+=" "+d.gridStickyDataLeft;if(B>0){var q=i.JsGridUtil.Internal.stickyLeftEdgeOffset+i.JsGridUtil.Internal.stickyCheckColumnSize+this.columns[0].width;this._objBag.RTL.bEnabled?L.style.right=q+"px":L.style.left=q+"px"}}}else{L.style.cssText=this.styleForTd;L.className=d.spGridCell+" "+j}if(H===this.tableColCount-1){L.className+=" ms-vb-lastCell";f&&(i.JsGridUtil._lastColumnVisibilityKillSwitchIsActive||this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn)&&(L.className+=" "+d.lastCell)}this.ariaMgr.OnInsertGridCell(L)}this._fnInsertedRow(o,l);var R=!1;for(H=0;H<l.length;H++){R=this._fnPopulateCell(l[H])||R;if(null!=y&&this._objBag.errorMgr.CellHasError(y,l[H].GetFieldKey())){this.AddOrUpdateCellError(y,l[H].GetFieldKey(),r);r&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.cellErrorJobKey,y,l[H].GetFieldKey())}}var U=this._objBag.rowHeaderStateMgr.GetRowHeaderState(y);this.bRowHeadersEnabled&&null!=U&&this.SetRowHeaderState(y,U);if(!R&&i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7){var z=v.cells.length>0?v.cells[0]:null;null!=z&&null!=z.innerHTML&&0==z.innerHTML.length&&(z.innerHTML="&nbsp;")}};e.prototype.ClearHandlers=function(e){i.JsGridUtil.ClearEventListeners(e);for(var t=e.childNodes,n=0;n<t.length;n++)this.ClearHandlers(t[n])};e.prototype.DeleteTableRow=function(e){var t=this.tableElem.rows[e+1].recordKey;this.bRowHeadersEnabled&&null!=this.rowHeaderStateDivs[t]&&this.ClearRowHeaderState(t,this.tableElem.rows[e+1].cells[0]);this.ClearAllErrorsForRecord(t);var n=this.tableElem.rows[e+1];this._fnTryDisposeRow(n.recordKey);n.recordKey=null;this.ClearRowCoordCache(e+1);this.tableElem.deleteRow(e+1);if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._stickyLeftEdgeKeeper){var r=this.GetProperTableHeight().toString()+"px";this._stickyLeftEdgeKeeper.style.height=r;this._stickyColumnShadow.style.height=r}};e.prototype.CalcOptimalDataColumnCount=function(e){return this.paneConverter.GetVirtualColumnCount()};e.prototype.InsertTableColumns=function(e,t){var n=[],r=[],o=this.tableElem.rows[0],u=s.JsGridConstants.Internal.zIndex.tableHeader+t;this.ClearColCoordCache(e);this.ClearRowCoordCache(0);for(var a=0;a<t;a++){var f=document.createElement("th");f.style.textOverflow="ellipsis";e+a==o.cells.length?o.appendChild(f):o.insertBefore(f,o.cells[e+a]);this.tableColCount++;var l=new x(0,e+a,this);n.push(l);var c=l.GetColumn();if(c&&c.width){var h=c.width;f.style.width=h+"px"}if(i.JsGridUtil.Internal.IsFeatureEnabled(b)&&i.JsGridUtil.Internal.IsFeatureEnabled(g)){f.style.zIndex=u;u--}this.ariaMgr.OnInsertColHeaderCell(f);for(var p=0;p<this.rowRecords.length;p++){var d=this.tableElem.rows[p+1].insertCell(e+a);d.style.cssText=this.styleForTd;r.push(new x(p+1,e+a,this));this.ariaMgr.OnInsertGridCell(d)}}this._fnInsertedColumns(n,r,this.headerHeight);for(a=0;a<r.length;a++){this._fnPopulateCell(r[a]);this._objBag.errorMgr.CellHasError(r[a].GetRecordKey(),r[a].GetFieldKey())&&this.AddOrUpdateCellError(r[a].GetRecordKey(),r[a].GetFieldKey())}};e.prototype.RemoveTableColumns=function(e,t){var n=this.TableColIdxToColIdx(e);this.ClearColCoordCache(e);this.ClearRowCoordCache(0);for(;t-- >0;){for(var r=this.columns[n].fieldKeys,i=this.rowRecords.length;i>=0;i--){var s=this.tableElem.rows[i],o=s.cells[e];if(s.recordKey in this.errorDivs)for(var u=0;u<r.length;u++)this.ClearCellError(s.recordKey,r[u]);0==i&&this._fnRemovedHeaderCell(o,n);s.removeChild(o)}n++;this.tableColCount--}this._fnRemovedColumns()};e.prototype.RefreshLoadingRects=function(){var e=this;if(!this._objBag.jsGridObj.paneMgr.gridPane.dontReflow){this.DisposeLoadingRects();for(var t=null,n=[],r=-1,o=0;o<this.rowRecords.length;o++){var u=null==this.rowRecords[o]?1:this.rowRecords[o]==s.JsGridConstants.Internal.LoadErrorState?2:0;if(0!==u)if(u!==r){t={type:u,startIdx:o,count:1};n.push(t)}else t.count++;r=u}if(n.length){var a=this.tableMgr.GetRowHeaderWidth(),f=this._objBag.RTL.bEnabled?Math.max(0,this.tableElem.offsetLeft+1):a,l=Math.min(this.tableMgr.GetTableWidth()-1,this._paneSize.GetWidth())-a,c='<table cellpadding="0" cellspacing="0" style="height:100%;width:100%"><tr><td style="border:0px;text-align:center">',h=c+this._fnGetLocStr("LoadingMsg")+"</td></tr></table>",p=c+'<a href="#" tabIndex="-1" title="'+this._fnGetLocStr("RecordFetchError")+'">'+this._fnGetLocStr("RecordFetchError")+"</a></td></tr></table>";for(o=0;o<n.length;o++){t=n[o];var d=document.createElement("div");i.JsGridUtil.Internal.DomElement.GetInstance().SetOpacity(d,.75);d.style.position="absolute";d.style.top=this.rowHeight*t.startIdx+this.headerHeight+2-this._parentDiv.offsetTop+"px";d.style.left=f+"px";d.style.width=l+"px";d.style.height=this.rowHeight*t.count-1+"px";d.style.zIndex="100";if(1==t.type){d.innerHTML=h;this.loadingRects.push({div:d})}else{d.innerHTML=p;var v=d.firstChild.firstChild.firstChild.firstChild.firstChild;v.addEventListener("click",function(){e._fnRetryErrorRows();return!1});this.loadingRects.push({div:d,anchor:v})}this._parentDiv.appendChild(d)}}if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._stickyLeftEdgeKeeper&&this.tableElem){var m=this.GetProperTableHeight().toString()+"px";this._stickyLeftEdgeKeeper.style.height=m;this._stickyColumnShadow.style.height=m;this.UpdateLeftEdgeKeeperSizes()}}};e.prototype.DisposeLoadingRects=function(){for(var e=0;e<this.loadingRects.length;e++){this.loadingRects[e].anchor&&i.JsGridUtil.ClearEventListeners(this.loadingRects[e].anchor);this._parentDiv.removeChild(this.loadingRects[e].div)}this.loadingRects=[]};e.prototype.UpdateCoordCacheInternal=function(){if(this._objBag.bUpdateCoordCache){this.UpdateColCoordCache();this.UpdateRowCoordCache()}this._objBag.bUpdateCoordCache=!1};e.prototype.UpdateRowCoordCache=function(){for(var e,t,n,r=0,i=this.tableElem.rows,s=0;s<this.rowCoordCache.length;s++){if(null==(t=this.rowCoordCache[s])){this.ClearRowCoordCache(s);break}if(0!==(e=(n=i[s].cells[0].offsetHeight+1)-t.height)){t.height=n;t.bottom+=e}if(0!==r){t.top+=r;t.bottom+=r}0!==e&&(r+=e)}};e.prototype.UpdateColCoordCache=function(){for(var e,t,n=0,r=this.tableElem.rows[0],i=0;i<this.colCoordCache.length;i++)if(null!=(e=this.colCoordCache[i])){t=r.cells[i].offsetWidth;t+=1;e.width=t;0!==(n+=t-e.width)&&(this._objBag.RTL.bEnabled?e.left+=n:e.right+=n)}else if(this._objBag.bUpdateCoordCache){this.ClearColCoordCache(i);break}};e.prototype.ClearColCoordCache=function(e){this.colCoordCache.length>e&&this.colCoordCache.splice(e,this.colCoordCache.length-e)};e.prototype.ClearRowCoordCache=function(e){this.rowCoordCache.length>e&&this.rowCoordCache.splice(e,this.rowCoordCache.length-e)};e.prototype.CloneRowCoords=function(e){return{top:e.top,bottom:e.bottom,height:e.height}};e.prototype.CopyRowCoords=function(e,t){var n=this.rowCoordCache[e];t.top=n.top;t.bottom=n.bottom;t.height=n.height};e.prototype.CloneColCoords=function(e){return{left:e.left,right:e.right,width:e.width}};e.prototype.CopyColCoords=function(e,t){var n=this.colCoordCache[e];t.left=n.left;t.right=n.right;t.width=n.width};e.prototype.GetSelectionCheckElement=function(e){var t=this._selectionCircleIcon,n=this._selectionCheckmarkIcon,r='<i class="'+t.subset.className+" "+d.selectionCircleIcon+'">'+t.code+"</i>",i='<i class="'+n.subset.className+" "+d.selectionCheckIcon+'">'+n.code+"</i>";return['<div class="'+d.selectionCheckIconsWrapper+'" data-automationid="row-selection-checkmark-'+e+'">',r,i,"</div>"].join("")};e.prototype.GetAddNewItemIconElement=function(){var e=this._addNewItemIcon;return'<i class="'+e.subset.className+" "+d.inlineNewItemAddIcon+'">'+e.code+"</i>"};e.prototype.UpdateLeftEdgeKeeperSizes=function(){var e=i.JsGridUtil.Internal.GetStickyDataColumnsWidth(this.columns)+(32+i.JsGridUtil.Internal.stickyLeftEdgeOffset);this._stickyLeftEdgeKeeperContainer.style.width=e.toString()+"px";this._objBag.RTL.bEnabled?this._stickyColumnShadow.style.right=((i.JsGridUtil.Internal.stickyChromeless?32:0)+(e-4)).toString()+"px":this._stickyColumnShadow.style.left=((i.JsGridUtil.Internal.stickyChromeless?32:0)+(e-4)).toString()+"px"};e.prototype.IsTableRowIdxValid=function(e,t){return e>=(t?1:0)&&e<this.tableElem.rows.length};e.prototype.IsTableColIdxValid=function(e,t){return e>=(t&&this.bRowHeadersEnabled?1:0)&&e<this.tableColCount};return e})();t.TableManager=S;var x=(function(){function e(e,t,n,r,i){this.fieldKey=null;this.tableRowIdx=e;this.tableColIdx=t;this._tableMgr=n;if(!r||this._tableMgr.IsTableRowIdxValid(e,i)&&this._tableMgr.IsTableColIdxValid(t,i)){this.tableRowIdx=e;this.tableColIdx=t}else this.bIsInvalid=!0}e.prototype.GetTr=function(){return this._tableMgr.tableElem.rows[this.tableRowIdx]};e.prototype.GetTd=function(){return this._tableMgr.tableElem.rows[this.tableRowIdx].cells[this.tableColIdx]};e.prototype.GetRecordKey=function(){if(this.tableRowIdx<1)return null;var e=this._tableMgr.rowRecords[this.tableRowIdx-1];return null!=e&&null!=e.recordKey?e.recordKey:this.GetTr().recordKey};e.prototype.GetRecord=function(){var e=0==this.tableRowIdx?null:this._tableMgr.rowRecords[this.tableRowIdx-1];return e==s.JsGridConstants.Internal.LoadErrorState?null:e};e.prototype.GetFieldKey=function(){if(0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled||this.tableRowIdx<1)return null;this.fieldKey||(this.fieldKey=this._tableMgr.paneConverter.IdxToFieldKey(this._tableMgr.TableRowIdxToRowIdx(this.tableRowIdx),this._tableMgr.TableColIdxToColIdx(this.tableColIdx)));return this.fieldKey};e.prototype.GetColumn=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?null:this._tableMgr.columns[this.GetColIdx()]};e.prototype.GetColIdx=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?null:this._tableMgr.TableColIdxToColIdx(this.tableColIdx)};e.prototype.GetRowIdx=function(){return this.tableRowIdx<1?null:this._tableMgr.TableRowIdxToRowIdx(this.tableRowIdx)};e.prototype.Equals=function(e){return this.tableRowIdx==e.tableRowIdx&&this.tableColIdx==e.tableColIdx};e.prototype.GetCellType=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?this.tableRowIdx<1?this._tableMgr.CellType.SelectAllSquare:this._tableMgr.CellType.RowHeader:this.tableRowIdx<1?this._tableMgr.CellType.ColumnHeader:this._tableMgr.CellType.Cell};return e})();t.CellInfo=x});
define("PGe",["require","exports","cGe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._objBag=e}e.prototype.SetPosConverterObj=function(e){this._posConverter=e};e.prototype.SetView=function(e){this.UpdateColumns(e,!0)};e.prototype.NotifyColumnsChanged=function(e){this.UpdateColumns(e,!1)};e.prototype.FullDataIdxToKey=function(e,t){return{recordKey:this._posConverter.RecordIdxToRecordKey(Math.floor(e/this._rowMultiple)),fieldKey:this.IdxToFieldKey(e,t),columnKey:this._columns[t].columnKey}};e.prototype.IdxToKey=function(e,t){return{recordKey:this._posConverter.ViewIdxToRecordKey(Math.floor(e/this._rowMultiple)),fieldKey:this.IdxToFieldKey(e,t),columnKey:this._columns[t].columnKey}};e.prototype.IdxToFieldKey=function(e,t){return this._columns[t].fieldKeys[e%this._rowMultiple]};e.prototype.KeyToIdx=function(e,t){var n=this._fieldKeyToRowOffset[t];if(null!=n){var r=this._posConverter.RecordKeyToViewIdx(e)*this._rowMultiple+n,i=this._fieldKeyToColIdx[t];if(null!=i)return{rowIdx:r,colIdx:i}}return null};e.prototype.GetTopRowIdxForKey=function(e){return this._posConverter.RecordKeyToViewIdx(e)*this._rowMultiple};e.prototype.GetTopRowIdx=function(){return this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.RowIdxToViewIdx=function(e){return Math.floor(e/this._rowMultiple)};e.prototype.RowIdxToRelRowIdx=function(e){return e-this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.RowIdxToRecordKey=function(e){return this._posConverter.ViewIdxToRecordKey(this.RowIdxToViewIdx(e))};e.prototype.RelRowIdxToRowIdx=function(e){return e+this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.ColKeyToColIdx=function(e){return this._colKeyToColIdx[e]};e.prototype.ColIdxToColKey=function(e){return this._columns[e].columnKey};e.prototype.ColKeyToFieldKeys=function(e){return this._columns[this._colKeyToColIdx[e]].fieldKeys};e.prototype.FieldKeyToColIdx=function(e){return this._fieldKeyToColIdx[e]};e.prototype.GetWholeRowDisplayCapacity=function(){return this._posConverter.GetWholeRowDisplayCapacity()*this._rowMultiple};e.prototype.GetRowMultiple=function(){return this._rowMultiple};e.prototype.GetRecordsInvolved=function(e,t,n){var r=this,i=(e-e%this._rowMultiple)/this._rowMultiple,s=Math.ceil((t+e%this._rowMultiple)/this._rowMultiple),o=this._posConverter.GetViewRecords(i,s,function(){var i=r.GetRecordsInvolved(e,t,n);null!=i&&n(i)});return o.recordSetComplete?(function(e){for(var t={},n=0;n<e.length;n++)t[e[n].key()]=e[n];return t})(o.records):null};e.prototype.IsRecordOnScreen=function(e){return this._posConverter.IsRecordOnScreen(e)};e.prototype.GetRecordKeysInvolved=function(e,t){for(var n=(e-e%this._rowMultiple)/this._rowMultiple,r=Math.ceil((t+e%this._rowMultiple)/this._rowMultiple),i=new Array(r),s=0;s<r;s++)i[s]=this._posConverter.ViewIdxToRecordKey(n+s);return i};e.prototype.GetVirtualRowCount=function(){return(this._posConverter.GetViewRecordCount()+this._objBag.entryRecordMgr.GetEntryRecords().length)*this._rowMultiple};e.prototype.GetVirtualColumnCount=function(){return this._columns.length};e.prototype.GetColumnByIdx=function(e){return this._columns[e]};e.prototype.GetColumnByKey=function(e){var t=this._colKeyToColIdx[e];return null==t?null:this._columns[t]};e.prototype.UpdateColumns=function(e,t){this._columns=e;this._fieldKeyToColIdx={};this._fieldKeyToRowOffset={};this._colKeyToColIdx={};for(var r=0;r<e.length;r++){this._colKeyToColIdx[e[r].columnKey]=r;var i=e[r].fieldKeys;t&&(this._rowMultiple=i.length);n.JsGridUtil.DebugAssert(i.length==this._rowMultiple);for(var s=0;s<this._rowMultiple;s++){this._fieldKeyToColIdx[i[s]]=r;this._fieldKeyToRowOffset[i[s]]=s}this._objBag.columnKeys&&("JSGrid_NewColumn"!=e[r].columnKey&&"Title"!=e[r].columnKey?this._objBag.columnKeys[r]='{"spField_216":["'+e[r].columnKey+'"]}':"Title"==e[r].columnKey&&(this._objBag.columnKeys[r]='{"spField_216":["LinkTitle"]}'))}};return e})();t.GridPaneConverter=r});
define("AGe",["require","exports","lC","eGe","cGe","jGe","bGe","sGe","DGe","dGe","MGe","LGe","BGe","oGe","Ih","ce","A","iGe","SPListItemsScopeDeferred_IS_mini_css","Ee"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,E){"use strict";var b=y.tablemgr_9,w=y.panemgr_9;y=y.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var S=v.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),x=v.Killswitch.isActivated("DF3D86D3-26B1-480B-A71B-8E0F3C310A1A","3/12/2020","update columns after a resize so that pictures fix their size"),T=v.Killswitch.isActivated("FD94E2D1-B4A1-486C-A34E-AF51AEF22FA2","4/13/2020","Prevent unnecessary updates when just clicking on the resize bar without moving"),N=v.Killswitch.isActivated("50078F9D-8871-4D6D-94D7-0069D13DF879","6/1/2020","Do not show custom formatters on the New Row row."),C=v.Killswitch.isActivated("131A6565-43B4-49D3-9638-D5B15B41D592","8/05/2020","Do not add a highlight class to the cells that were just recently edited."),k=v.Killswitch.isActivated("02A08EFA-638C-4A27-9079-1B4472CE9560","8/3/2020","Fix vertical scrolling issue in sp-client."),L=v.Killswitch.isActivated("C449D68D-440C-40B3-97E5-19B92696735C","8/05/2020","Hide the drag handle on cells that have errors to prevent copying of errors."),A={ODB:1725},O={ODB:1439},M=r.JsGridConstants.Internal.zIndex.selectionFrame,_={ChangeHighlight:"jsgrid-changehighlight"},D=(function(){function e(e,t,n,s,o,a,f,l,c,h,p,d,v,m,g,y){this.const_BlurBorderColor="#B0B5BA";this.gridPane=this;this.bIsDisposed=!1;this.focusedColHeaderIndex=0;this.lastClientSize={width:-1,height:-1};this.reorderableRows=new u.Set;this.disposeMap={};this.dontReflow=!1;this.afterReflowScrollGoal=0;this.Id=r.JsGridConstants.PaneId.MainGrid;this.ExecuteTouchAction=null;this.ShouldUpdateTouchStartPosition=null;this._lastSelectionRangeNormalized=null;this._parentNode=e;this._objBag=t;this.ScrollVerticallyByTouch=s;this._fnNotifyScrollBarVisibilityChange=o;this._commandMgr=a;this._selectionMgr=f;this._changeHighlightMgr=l;this._editMgr=c;this._cutcopypasteMgr=h;this._fillDownMgr=p;this._paneSize=d;this._fnGetCellValue=v;this._fnGetLocStr=m;this._fnRetryErrorRows=g;this.styles=t.styleMgr;this.jsGridObj=t.jsGridObj;this.delegateMgr=t.delegateMgr;this.ariaMgr=t.ariaMgr;this.selectionDragHandle=y.selectionDragHandle;this.selectionFrames=y.selectionFrames;this.focusFrames=y.focusFrames;this.copyFrames=y.copyFrames;this.quickEditVisualRefreshFlightEnabled=i.JsGridUtil.Internal.IsFeatureEnabled(A);this._cellsWithBorder=[];this._cellsWithCopyBorder=[];this._cellsWithFocusBorder=[];this.Init()}e.prototype.GetDelegateMgr=function(){return this.delegateMgr};e.prototype.SetEventSinks=function(e){};e.prototype.GetLeftMostColumnIdx=function(){return this.horizScrollBar.GetTopItemIdx()};e.prototype.GetLeftMostColHeaderIdx=function(){return-1};e.prototype.Dispose=function(){this.bIsDisposed=!0;null!=this.disposeRenderedObjectsJobKey&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().FlushJob(this.disposeRenderedObjectsJobKey);this.gridPane.ClearView();i.JsGridUtil.ClearEventListeners(this._parentNode);i.JsGridUtil.ClearEventListeners(this.tableDiv);this.mouseHandlers.Dispose();this.headerMgr.Dispose();this.tableMgr.Dispose();this.horizScrollBar.Dispose();this._paneSize.Dispose();this.tableDiv=this.selectionDragHandle=this.selectionFrames=this.focusFrames=this.copyFrames=this.ghostHeader=this.ghostHeader.textDiv=this.columnDropIndic=this.ghostCells=this.rowDropIndic=this._parentNode=null};e.prototype.ClearView=function(){this.UpdatePositionedElements();this.mouseHandlers.ClearHeaderEvents();this.tableMgr.ClearTable()};e.prototype.SetView=function(e,t,n,r,i,s,o,u,a,f,l,c){var h=Math.max(0,this._paneSize.GetHeight()-this.GetEffectiveHorizontalScrollBarHeight());this.operationalUtil=t;this.fnGetGridRowStyleId=i;this.bMovableColumns=s;this.bResizableColumns=o;this.bHidableColumns=u;this.bSortableColumns=a;this.bAutoFilterableColumns=f;this.bRowHeadersEnabled=l;this.gridFieldMap=r;this.tableMgr.SetPosConverterObj(e);this._selectAllCell=this.tableMgr.InitTable(this.bRowHeadersEnabled);this.InitColumns(n,!0);var p=this._paneSize.GetWidth();this.horizScrollBar.Update({physicalViewportSize:p-this.tableMgr.GetRowHeaderWidth(),scrollbarSize:p,topItemIdx:0,bScrollNotifiy:!1});this.RecomputeTableViewportRelativeToParentNode(h);this.mouseHandlers.SetupHeaderEvents()};e.prototype.GetGridPaneConverter=function(){return this.paneConverter};e.prototype.ShowFocus=function(e){this.UpdateSelectionFrames(!e)};e.prototype.OnResize=function(){var e={width:this._paneSize.GetWidth(),height:this._paneSize.GetHeight()};if(e.width!==this.lastClientSize.width||e.height!==this.lastClientSize.height){this.tableMgr.OptimizeTableColumns();var t=this._paneSize.GetWidth();this.horizScrollBar.Update({physicalViewportSize:t-this.tableMgr.GetRowHeaderWidth(),scrollbarSize:t});this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane);this.lastClientSize=e}};e.prototype.SetRowHeight=function(e){this.rowHeight=e;this.tableMgr.SetRowHeight(this.rowHeight)};e.prototype.GetMinRowHeight=function(){return 30};e.prototype.SpliceRows=function(e,t,n,r,i){this.tableMgr.SpliceRows(e,t,n,r);null!=this.activeRowIdx&&this.activeRowIdx>=e&&this.activeRowIdx<=e+t-1&&(this.activeRowIdx=null);i?this.ResetSelection():this.UpdatePositionedElements(!0)};e.prototype.SetSortState=function(e){this.headerMgr.SetSortState(e)};e.prototype.SetFilterState=function(e){this.headerMgr.SetFilterState(e)};e.prototype.NotifyCanEditUpdated=function(){this.BindEditControl();this.UpdateSelectionFrames(!1)};e.prototype.NotifyCopyOperationUpdated=function(){this.UpdateCopyFrames(!0);this.HideSelectionFrames()};e.prototype.UpdateFocusAfterInsertOrDeleteRows=function(e,t,n){var r=this._selectionMgr.GetFocusForPane(this.gridPane);null!=r&&(n?r.rowIdx>=e&&this._selectionMgr.SetFocusByPos(this.gridPane,r.rowIdx+t,r.colIdx):r.rowIdx>=e&&r.rowIdx<e+t?this._selectionMgr.SetFocusByPos(this.gridPane,Math.max(e-1,0),r.colIdx):r.rowIdx>=e+t&&this._selectionMgr.SetFocusByPos(this.gridPane,r.rowIdx-t,r.colIdx))};e.prototype.ChangeKeys=function(e,t){this.tableMgr.ChangeKeys(e,t)};e.prototype.RenderRows=function(e){this.bIsDisposed||this.tableMgr.RenderRows(e)};e.prototype.NotifyChangeIndicatorsClearing=function(){for(var e=this.tableMgr.GetAllDataCells(),t=0;t<e.length;t++){var n=e[t];null!=n.GetRecord()&&this._changeHighlightMgr.IsCellIn(n.GetRecordKey(),n.GetFieldKey())&&this.RefreshCellStyle(n,!0,!1)}};e.prototype.Select=function(e,t,n,r,i){this._selectionMgr.SelectRange(this.gridPane,e,t,n,r,i?s.SelectOp.Append:s.SelectOp.Set,!0,!1)};e.prototype.SelectByKey=function(e,t,n,r,i){var s,o,u,a;if(null!=e&&null!=t){s=null!=n?this.paneConverter.KeyToIdx(e,n).rowIdx:this.paneConverter.GetTopRowIdxForKey(e);o=null!=r?this.paneConverter.KeyToIdx(t,r).rowIdx:this.paneConverter.GetTopRowIdxForKey(t)}if(null!=n&&null!=r){u=this.paneConverter.FieldKeyToColIdx(n);a=this.paneConverter.FieldKeyToColIdx(r)}this.Select(s,o,u,a,i)};e.prototype.NotifySelectionUpdating=function(){var e;e=this.quickEditVisualRefreshFlightEnabled&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?-1:this.tableMgr.BeginColIdx();var t={rowRange:new u.Range(this.tableMgr.BeginRowIdx(),this.tableMgr.EndRowIdx()-1),colRange:new u.Range(e,this.tableMgr.EndColIdx()-1)};return{visibleRanges:t,clearedCells:this._selectionMgr.GetComponentsWithin(this.gridPane,t.rowRange,t.colRange),oldFocus:this._selectionMgr.GetFocusForPane(this.gridPane)}};e.prototype.ScrollCellIntoView=function(e,t){if(!this.dontReflow){var n=this.gridPane.GetCellByIdx(e,t);if(n){var r=n.GetTd();if(r){var s=r.offsetTop,o=r.offsetLeft,u=r.offsetHeight,a=r.offsetWidth,f=document.getElementById("s4-workspace"),l=i.JsGridUtil.Internal.GetScrollParent(r);if(l){if(f){s-=i.JsGridUtil.Internal.DOM_AbsTop(f);o-=i.JsGridUtil.Internal.DOM_AbsLeft(f);l=f}s<l.scrollTop?l.scrollTop=s-45:s+u>l.scrollTop+l.clientHeight-10&&(l.scrollTop=s+u+45-l.clientHeight);if(!k&&l.clientHeight==l.scrollHeight&&l.clientHeight>document.body.clientHeight&&l.parentElement){var c=i.JsGridUtil.Internal.GetScrollParent(l.parentElement);if(c){var h=c,p=i.JsGridUtil.Internal.DOM_AbsTop(r)-l.scrollTop-i.JsGridUtil.Internal.DOM_AbsTop(h);p<h.scrollTop?h.scrollTop=p-45:p+u>h.scrollTop+h.clientHeight-10&&(h.scrollTop=p+u+45-h.clientHeight)}}if(this._objBag.RTL.bEnabled){if(this._objBag.RTL.bEnabled)if(i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIE)o<0&&(0==l.scrollLeft||l.scrollLeft>0&&Math.abs(o)>l.scrollLeft)?l.scrollLeft=Math.abs(o+45):l.clientWidth-o-a<l.scrollLeft&&(l.scrollLeft=l.clientWidth-o-a-45);else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){var d=i.JsGridUtil.Internal.GetStickyDataColumnsWidth(this.allColumns.GetColumnArray());o<l.scrollLeft?l.scrollLeft=o-45:o+a>l.scrollLeft+l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)+d&&(l.scrollLeft=o+a+45-(l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)+45+d))}else o<l.scrollLeft?l.scrollLeft=o-45:o+a>l.scrollLeft+l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)&&(l.scrollLeft=o+a+45-(l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)))}else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){var v=this.allColumns.GetColumnArray()[0].width;t<=1||o<l.scrollLeft+v?l.scrollLeft=Math.max(0,o-90-v):o+a>l.scrollLeft+l.clientWidth&&(l.scrollLeft=o+a+45-l.clientWidth)}else o<l.scrollLeft?l.scrollLeft=o-45:o+a>l.scrollLeft+l.clientWidth&&(l.scrollLeft=o+a+45-l.clientWidth)}}}return!1}};e.prototype.GetCellByIdx=function(e,t){return this.tableMgr.GetCellByIdx(e,t)};e.prototype.NotifySelectionUpdated=function(e,t){var n=this,r=this._selectionMgr.GetFocusForPane(this.gridPane),s=this._selectionMgr.GetComponentsWithin(this.gridPane,e.visibleRanges.rowRange,e.visibleRanges.colRange),u=function(e,t){if(n._objBag.editUtil.IsEditingEnabled()&&n._objBag.editUtil.CanEditField(e.GetRecord(),e.GetColumn(),e.GetFieldKey())){var r=e.GetTd(),s=n.quickEditVisualRefreshFlightEnabled?y.msGridCellSelectedEditable:"ms-jsgrid-cell-selected-editable";t?i.JsGridUtil.Internal.AddCssClass(r,s):i.JsGridUtil.Internal.RemoveCssClass(r,s)}};(function(e,t,r,s){var o=e.SymmetricDifference(t),u=function(e){var t=n.tableMgr.GetCellByIdx(e.rowIdx,e.colIdx);null!=t?n.RefreshCellStyle(t,!1,!0):n.ApplyGridComputedCellStyle(e.recordKey,e.fieldKey,null,!1)};if(null!=r){o.Remove(i.JsGridUtil.Internal.MakeCellKey(r.rowIdx,r.colIdx));u(r)}if(null!=s){o.Remove(i.JsGridUtil.Internal.MakeCellKey(s.rowIdx,s.colIdx));u(s)}for(var a in o.GetCollection()){var f=i.JsGridUtil.Internal.CrackCellKey(a),l=n.tableMgr.GetCellByIdx(f.rowIdx,f.colIdx);null!=l&&n.RefreshCellStyle(l,!1,!0)}})(e.clearedCells,s,e.oldFocus,r);(function(){var e;e=n.tableMgr.GetColumnHeaders();if(n.quickEditVisualRefreshFlightEnabled)for(var t=0;t<e.length-1;t++)n.headerMgr.ApplyHeaderClassnames(e[t]);else for(t=0;t<e.length;t++)n.headerMgr.ApplyHeaderStyle(e[t].GetTd(),n.GetHeaderStyle(e[t].GetColIdx(),!1),e[t].GetColIdx()==n.activeColIdx);e=n.tableMgr.GetRowHeaders();for(t=0;t<e.length;t++){var r=e[t].GetTd();n.quickEditVisualRefreshFlightEnabled||o.StyleUtil.ApplyRowHeaderStyle(r,n.GetHeaderStyle(e[t].GetRowIdx(),!0),n.GetRowHeaderSibling);var i=n._selectionMgr.IsRowSelected(n.gridPane,e[t].GetRowIdx());if(n.quickEditVisualRefreshFlightEnabled&&i){r.classList.add(b.cellIsSelected);r.parentNode.classList.add(b.rowIsSelected,"is-selected")}else{r.classList.remove(b.cellIsSelected);r.parentNode.classList.remove(b.rowIsSelected,"is-selected")}n.ariaMgr.SetSelected(r.parentNode,i)}})();var a,f,l,c,h=!1;r&&t&&(h=this.gridPane.ScrollCellIntoView(r.rowIdx,r.colIdx));h||this.UpdatePositionedElements();this.BindEditControl();if(this.quickEditVisualRefreshFlightEnabled)for(var p in this.copyFrames)for(var d in this.copyFrames[p])"Fore"===p&&this.copyFrames[p][d].classList.add(w.dashedBorderUnfocused);if(null!=e.oldFocus){if(this.quickEditVisualRefreshFlightEnabled&&-1===e.oldFocus.colIdx){a=this.tableMgr.GetRowHeader(e.oldFocus.rowIdx);f=this.tableMgr.GetSelectAllSquare()}else{a=this.tableMgr.GetCellByIdx(e.oldFocus.rowIdx,e.oldFocus.colIdx);f=this.tableMgr.GetColumnHeader(e.oldFocus.colIdx)}null!=a&&u(a,!1)}if(null!=r){if(this.quickEditVisualRefreshFlightEnabled&&-1===r.colIdx){l=this.tableMgr.GetRowHeader(r.rowIdx);c=this.tableMgr.GetSelectAllSquare()}else{l=this.tableMgr.GetCellByIdx(r.rowIdx,r.colIdx);c=this.tableMgr.GetColumnHeader(r.colIdx)}null!=l&&u(l,!0)}this.ariaMgr.OnFocusCell(this.Id,a,f,l,c)};e.prototype.GetMinHeaderHeight=function(){return 31};e.prototype.SetHeaderHeight=function(e){this.tableMgr.SetHeaderHeight(e)};e.prototype.ScrollColumnIntoViewHorizontally=function(e){if(e<=this.tableMgr.BeginColIdx())return this.horizScrollBar.Update({topItemIdx:e});var t=this.tableMgr.GetColumnHeader(e),n=t&&t.GetTd(),r=n&&(this._objBag.RTL.bEnabled?this.tableMgr.GetTdCoords(n).left<0:this.tableMgr.GetTdCoords(n).right>this._paneSize.GetWidth());if(!n||r){for(var i=this.tableMgr.GetSelectAllSquare()?this.tableMgr.GetSelectAllSquare().GetTd().offsetWidth:0,s=this._paneSize.GetWidth()-i-this.paneConverter.GetColumnByIdx(e).width;e>0&&(s-=this.paneConverter.GetColumnByIdx(e-1).width)>=0;e--);return this.horizScrollBar.Update({topItemIdx:e})}return!1};e.prototype.NotifyUpdateProperty=function(e,t,n,i,s,o){n&&this._changeHighlightMgr.AddCell(e,t);var u=this.tableMgr.GetCellByKey(e,t);if(null!=u){null!=i&&s==r.JsGridConstants.ValidationState.Valid&&this._editMgr.NotifyUpdateProperty(this,e,t,i,o);this.tableMgr.RefreshCell(u);this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane)}};e.prototype.BeginRowIdx=function(){return this.tableMgr.BeginRowIdx()};e.prototype.BeginColIdx=function(){return this.tableMgr.BeginColIdx()};e.prototype.ShowColumn=function(e,t){null==this.paneConverter.GetColumnByKey(e)&&this.ShowColumnInternal(this.allColumns.GetColumnByKey(e),t)};e.prototype.HideColumn=function(e){var t=this.paneConverter.GetColumnByKey(e);null!=t&&this.HideColumnInternal(t)};e.prototype.RenameColumn=function(e,t){this._editMgr.Unbind();this.headerMgr.RenameColumn(e,t)};e.prototype.DeleteColumn=function(e){var t=this.paneConverter.GetColumnByKey(e);if(null!=t){this.HideColumn(t);this.allColumns.RemoveColumn(e)}};e.prototype.UpdateColumns=function(e){this.InitColumns(e,!1)};e.prototype.GetVisibleColumns=function(){for(var e=[],t=this.GetAllColumns().GetColumnArray(),n=0;n<t.length;n++)t[n].isVisible&&e.push({columnKey:t[n].columnKey,width:t[n].width});return e};e.prototype.GetAllColumns=function(){return this.allColumns};e.prototype.GetColumns=function(){for(var e=[],t=this.allColumns.GetColumnArray(),n=0;n<t.length;n++)e.push(t[n]);return e};e.prototype.GetFocusedCell=function(){var e=this._selectionMgr.GetFocusForPane(this.gridPane),t=e&&this.tableMgr.GetCellByIdx(e.rowIdx,e.colIdx);return null!=t&&t.GetCellType()==this.tableMgr.CellType.Cell?t:null};e.prototype.GetData=function(e,t,n,r){for(var i=new Array(t.Size()),s=t.begin;s<=t.end;s++){for(var o=new Array(n.Size()),u=n.begin;u<=n.end;u++){var a;null!=(a=r?this.paneConverter.FullDataIdxToKey(s,u):this.paneConverter.IdxToKey(s,u)).recordKey&&(o[u-n.begin]=this._objBag.editUtil.GetFieldValueForCopy(e[a.recordKey],a.fieldKey))}i[s-t.begin]=o}return{matrix:i,height:t.Size(),width:n.Size()}};e.prototype.PutData=function(e,t,n,s,o,u,l,c){var h=this,p=new Array(o.Size()*u.Size()),d=e.height,v=e.width,m=-o.begin+("TL"==s||"TR"==s?0:d-o.Size()%d),g=-u.begin+("TL"==s||"BL"==s?0:v-u.Size()%v),y=this._objBag.controller.CreateDataUpdateCmd(!0),b=y.GetChangeKey();this._objBag.commandMgr.Execute(y,n,a.CommandManagerConstants.CommandType.Explicit);var w=o.begin,E=o.begin,S=o.Size()*u.Size(),x=0;this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.DoLargeTask,S,100,function(n,r){for(var s;E<=o.end;){s=!1;for(var a=u.begin;a<=u.end;a++){var l=h.paneConverter.IdxToKey(w,a);if(h._objBag.editUtil.CanEditField(c?h._objBag.entryRecordMgr.GetEntryRecord(l.recordKey):t[l.recordKey],h.paneConverter.GetColumnByIdx(a),l.fieldKey)){var y=i.JsGridUtil._locationFilldownKillswitchIsActive||!h._objBag.controller.GetPropType(l.recordKey,l.fieldKey).ForceDataCopy;p[x++]=f.CreateUnvalidatedPropertyUpdate(l.recordKey,l.fieldKey,e.matrix[(E+m)%d][(a+g)%v],y);!s&&c&&l.recordKey==h._objBag.entryRecordMgr.GetLastEntryKey()&&h._objBag.entryRecordMgr.CreateEntryRows(1,E!==o.end,b);s=!0}}c&&!s||w++;E++;if((n+=u.Size())>=r)break}return n},function(){x>0&&h._objBag.controller.UpdateProperties(p.slice(0,x),n,b);y.NotifyInitialUpdateComplete();l(w-o.begin)},r.JsGridConstants.Priority.SuperHigh)};e.prototype.FieldKeyToColumnKey=function(e){for(var t=this.allColumns.GetColumnArray(),n=0;n<t.length;n++)if(null!=i.JsGridUtil.Internal.FindInArray(t[n].fieldKeys,function(t){return t==e},null))return t[n].columnKey;return null};e.prototype.EnsurePaneWidth=function(){var e=this.tableMgr.GetTableWidth()+40;e>this.gridPane._paneSize.GetWidth()&&this.gridPane._paneSize.SetValues(e,this.gridPane._paneSize.GetLeftOffset())};e.prototype.ScrollHorizontallyByTouch=function(e){e?this.horizScrollBar.ScrollUpByOne():this.horizScrollBar.ScrollDownByOne()};e.prototype.SetFocusToHeader=function(e){var t=this._objBag.parentNode.id;document.getElementById(t).getElementsByTagName("th")[e+1].focus()};e.prototype.IsRowHeadersEnabled=function(){return this.bRowHeadersEnabled};e.prototype.SelectAllRows=function(){var e=this._objBag.paneMgr,t=this.jsGridObj,n=this._selectionMgr.GetLastSelectionType(),i=e.RecordKeyToViewIdx(e.GetLastRecordKey());if(void 0!==i){var s=t.GetSelectedRecordKeys();if(null==s||0===i&&n!==r.JsGridConstants.SelectionType.RowRange||s.length!==i-0+1){t.SelectRowRange(0,i,!1);this._selectAllCell.GetTd().classList.add(b.allRowsSelected)}else{t.SelectCellRange(0,0,0,0,!1);this._selectAllCell.GetTd().classList.remove(b.allRowsSelected)}}};e.prototype.UpdateRowClassesOnSingleCellSelection=function(e,t){var n=this.GetCellByIdx(e,0),r=this.GetCellByIdx(t,0),i=n&&n.GetTr(),s=r&&r.GetTr();e!==t&&i&&i.classList.remove(b.rowHasOnlyOneCellSelected);s&&s.classList.add(b.rowHasOnlyOneCellSelected)};e.prototype.HideFocusStyles=function(){this.HideSelectionFrames();this.ClearPseudoElementFrame(this._cellsWithBorder,b.cellHasSelectionBorder,b.cellIsFocusedAndSelected)};e.prototype.Init=function(){var e,t=this;this.headerMgr=new c.HeaderManager(this._objBag,this.styles,this._fnGetLocStr,this.UpdatePositionedElements.bind(this));var n=function(n){null!=e&&clearTimeout(e);e=setTimeout(function(){if(!t.bIsDisposed){t.tableMgr.UpdateCoordCache();t.UpdatePositionedElements()}},75)};this.computeGridCellStyleJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.ApplyGridComputedCellStyle.bind(this));this.computeGridROStyleJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.ApplyReadOnlyStyle.bind(this));this.disposeRenderedObjectsJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.DisposeContents.bind(this));this.CreateTopLevelHtmlElements();this.CreateColumnConfigurationHtmlElements();this.tableMgr=new l.TableManager(this.tableDiv,this._parentNode.id,this._paneSize,this._fnGetLocStr,this._objBag,this.OnInsertedRow.bind(this),this.OnInsertedColumns.bind(this),function(){null==t.curColUpdateTimeOut&&(t.curColUpdateTimeOut=setTimeout(t.UpdateFirstDisplayColumn.bind(t),0))}.bind(this),function(e){t.headerMgr.DisposeHeader(e)}.bind(this),function(){},this.BuildCellContent.bind(this),this._fnRetryErrorRows,this.TryDisposeRow.bind(this));this.paneConverter=this.tableMgr.GetGridPaneConverter();this.mouseHandlers=new P(this.gridPane);window.addEventListener("resize",n);this.onResizeHandler=n};e.prototype.CreateTopLevelHtmlElements=function(){this._parentNode.style.verticalAlign="top";this.tableDiv=document.createElement("div");this.tableDiv.style.cssText="position:relative;text-align:"+this._objBag.RTL.left;this.tableDiv.name="tableDiv";this._parentNode.appendChild(this.tableDiv);this.horizScrollBarContainer=document.createElement("div");this.horizScrollBarContainer.style.height=h.GetSystemScrollBarThickness()+"px";this.horizScrollBarContainer.style.display="none";this._parentNode.appendChild(this.horizScrollBarContainer);this.horizScrollBar=new h.ScrollBar(h.ScrollBarType.Horizontal,this.horizScrollBarContainer,!1,{itemSize:100},this.styles.scrollBarStyle,this._objBag.RTL.bEnabled,this._objBag);null!=this._fnNotifyScrollBarVisibilityChange&&this.horizScrollBar.SetOnVisibilityChanged(this.OnHorizontalScrollbarVisibilityChanged.bind(this),!0)};e.prototype.GetEffectiveHorizontalScrollBarHeight=function(){return"none"==this.horizScrollBarContainer.style.display?0:h.GetSystemScrollBarThickness()};e.prototype.OnHorizontalScrollbarVisibilityChanged=function(e){this.horizScrollBarContainer.style.display=e?"":"none";this._fnNotifyScrollBarVisibilityChange(e)};e.prototype.InitColumns=function(e,t){var n=this._selectionMgr.GetFocusForPane(this.gridPane);this.allColumns=e;var r=this.allColumns.GetColumnArray();this.itemSizes=[];for(var i=[],s=0;s<r.length;s++){var o=r[s];this.headerMgr.AdjustColumnWidth(o);this.itemSizes.push(o.width);i.push(o)}this.horizScrollBar.Update({itemCount:i.length,itemSizes:this.itemSizes});this.tableMgr.SetColumns(i,t);if(!t){this.TryRestoreFocusAfterInsertOrDeleteColumns(n);this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane)}};e.prototype.ActivateRow=function(e){null!=this.activeRowIdx&&this.DeactivateRow();this.activeRowIdx=e};e.prototype.DeactivateRow=function(){null!=this.activeRowIdx&&(this.activeRowIdx=null)};e.prototype.ActivateColumn=function(e){if(this.activeColIdx!==e){this.DeactivateColumn();this.activeColIdx=e;this.headerMgr.ApplyHeaderStyle(this.tableMgr.GetColumnHeader(e).GetTd(),this.GetHeaderStyle(e,!1),!0)}var t=this.tableMgr.GetColumnHeader(e),n=t.GetColumn(),r=t.GetTd(),s=n.columnKey,o=this.headerMgr.GetChildObjects(s);PositionCtxImg&&PositionCtxImg(o.menu,r);var u=this.getWidthFromPxString(o.menu.style.height);o.menuImg.style.top=(u-6)/2+"px";var a=this.getWidthFromPxString(i.JsGridUtil.Internal.GetCurrentStyle(o.menu,"width","width"));o.menuImg.style.left=(a-9)/2+"px";i.JsGridUtil.Internal.AddCssClass(o.menu,"s4-ctx-show");if(!n.bOpenMenuOnContentClick){o.menu.style.visibility="visible";o.menuImg.style.visibility="visible"}};e.prototype.getWidthFromPxString=function(e){if("string"!=typeof e)return 0;var t=e.trim(),n=Number(t.substring(0,t.length-2).trim());return isNaN(n)?0:n};e.prototype.DeactivateColumn=function(){if(null!=this.activeColIdx&&(null==this.lockedColIdx||this.activeColIdx!==this.lockedColIdx)){var e=this.activeColIdx;this.activeColIdx=null;var t=this.tableMgr.GetColumnHeader(e);null!=t&&this.headerMgr.ApplyHeaderStyle(t.GetTd(),this.GetHeaderStyle(e,!1));var n=this.tableMgr.GetColumnHeader(e).GetColumn().columnKey,r=this.headerMgr.GetChildObjects(n);if(r.menu&&r.menuImg){i.JsGridUtil.Internal.RemoveCssClass(r.menu,"s4-ctx-show");r.menuImg.style.visibility="hidden";r.menu.style.visibility="hidden"}}};e.prototype.CreateColumnConfigurationHtmlElements=function(){this.ghostHeader=document.createElement("table");this.ghostHeader.style.cssText="position:absolute; visibility:hidden; table-layout:fixed;z-index:1;padding-"+this._objBag.RTL.left+":7px;";this.tableDiv.appendChild(this.ghostHeader);this.ghostHeader.cellPadding=this.ghostHeader.cellSpacing=0;var e=this.ghostHeader.insertRow(-1).appendChild(document.createElement("th"));this.ghostHeader.textDiv=e.appendChild(document.createElement("div"));this.ghostHeader.textDiv.style.cssText="text-overflow:none; width:100%; margin-"+this._objBag.RTL.left+":-1px;";this.columnDropIndic=document.createElement("div");this.columnDropIndic.style.cssText="visibility:hidden; width:3px; position:absolute";this.tableDiv.appendChild(this.columnDropIndic);this.rowDropIndic=document.createElement("div");this.rowDropIndic.style.cssText="visibility:hidden; height:3px; background-color:"+this.styles.gridPaneStyle.rowDropIndicatorColor+"; position:absolute";this.tableDiv.appendChild(this.rowDropIndic)};e.prototype.DisposeContents=function(e,t,n){if(n)for(var r=0;r<n.length;r++)n[r]()};e.prototype.ApplyReadOnlyStyle=function(e,t,n){var s=this.tableMgr.GetCellByKey(e,t);if(null!=s&&this._objBag.editUtil.IsEditingEnabled()&&!this._objBag.editUtil.CanEditField(s.GetRecord(),s.GetColumn(),t)&&(null==this.focusedReadOnlyCell||this.focusedReadOnlyCell.rk!==e||this.focusedReadOnlyCell.fk!==t)){if(this._objBag.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState)&&this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,t)==r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive)return;var u=o.StyleUtil.MergeCellStyles(n,this.styles.readOnlyCellStyle);if(null!=u.backgroundColor){var a=s.GetTd(),f=i.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(a,"backgroundColor","background-color"),l=a.computedBackgroundColor;a.computedBackgroundColor=u.backgroundColor;this.quickEditVisualRefreshFlightEnabled&&delete u.textColor;if(l!==f){this.ApplyGridComputedCellStyle(e,t,s);delete u.backgroundColor}o.StyleUtil.ApplyCellStyle(s.GetTd(),u)}else o.StyleUtil.ApplyCellStyle(s.GetTd(),u)}};e.prototype.RemoveComputedCellStyles=function(e){for(var t=Object.keys(_),n=0;n<t.length;n++)e.classList.remove(_[t[n]])};e.prototype.ApplyGridComputedCellStyle=function(e,t,n,s){var u,a,f,c=null==n?this.tableMgr.GetCellByKey(e,t):n;if(null!=c){u=c.GetTd();!S&&C&&this.RemoveComputedCellStyles(u)}if(null!=this.focusedReadOnlyCell&&this.focusedReadOnlyCell.rk==e&&this.focusedReadOnlyCell.fk==t){f=this.focusedReadOnlyCell;this.focusedReadOnlyCell=null}if(null!=u&&null!=c){var h=this.tableMgr.GetRowHeader(c.GetRowIdx()),p=i.JsGridUtil.Internal.DomElement.GetInstance().GetPrevElement(u),d=c.GetRecord();a=c.GetTr();if(this.quickEditVisualRefreshFlightEnabled){u.classList.remove(b.cellIsSelected);u.classList.remove(b.cellIsFocusedAndSelected,"is-focusedAndSelected");h&&h.GetTd()===p&&p.classList.remove(b.cellIsFocusedAndSelected,"is-focusedAndSelected");!l.addNewItemVisualRefreshKillswitchIsActive&&a&&d.bIsNewRow&&a.classList.remove(b.rowIsActive)}var v=this._changeHighlightMgr.IsCellIn(e,t),m=this.paneConverter.KeyToIdx(e,t),g=this._selectionMgr.GetFocusForPane(this.gridPane),y=null!=m&&this._selectionMgr.IsCellSelected(this.gridPane,m.rowIdx,m.colIdx),w=null!=m&&null!=g&&m.rowIdx==g.rowIdx&&m.colIdx==g.colIdx,E=y&&!w,x=null;if(this.quickEditVisualRefreshFlightEnabled&&y&&w){h&&h.GetTd()===p&&p.classList.add(b.cellIsFocusedAndSelected,"is-focusedAndSelected");u.classList.add(b.cellIsFocusedAndSelected,"is-focusedAndSelected")}if(this.quickEditVisualRefreshFlightEnabled&&!l.addNewItemVisualRefreshKillswitchIsActive&&a&&d.bIsNewRow){var T=null!=m&&this._selectionMgr.isRowContainsSelectedCell(this.gridPane,m.rowIdx),N=null!=m&&null!=g&&m.rowIdx==g.rowIdx;T&&N&&a.classList.add(b.rowIsActive)}if(null==u.computedBackgroundColor&&w&&this._objBag.editUtil.IsEditingEnabled()&&!this._objBag.editUtil.CanEditField(c.GetRecord(),c.GetColumn(),c.GetFieldKey())){this.focusedReadOnlyCell={rk:e,fk:t,textColor:null!=f?f.textColor:u.style.color,backgroundColor:null!=f?f.backgroudColor:u.style.backgroundColor};if(!this._objBag.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState)||this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,t)!==r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive){u.style.backgroundColor=this.styles.readOnlyFocusedCellStyle.backgroundColor;u.style.color=this.styles.readOnlyFocusedCellStyle.textColor;x=!0}}else if(null!=f){u.style.color=f.textColor;u.style.backgroundColor=f.backgroundColor}if(!x&&(v||E)){var k=u.computedBackgroundColor,L=i.JsGridUtil.Internal.Color.HexStringToColor("transparent"==k||null==k?null!=this.styles.defaultCellStyle.backgroundColor?this.styles.defaultCellStyle.backgroundColor:o.StyleUtil.GetCellStyleDefaultBackgroundColor():k);if(v&&!s){null!=(A=this.styles.gridPaneStyle.changeHighlightCellBgColor)&&(L=A);if(!S){L=null;C&&u.classList.add(_.ChangeHighlight)}}if(E){var A;null!=(A=this.styles.gridPaneStyle.selectedCellBgColor)&&(L=A)}null!=L&&(this.quickEditVisualRefreshFlightEnabled?u.classList.add(b.cellIsSelected):u.style.backgroundColor=i.JsGridUtil.Internal.Color.ColorToHexString(i.JsGridUtil.Internal.Color.RemoveAlphaChannel(L)))}this.ariaMgr.SetSelected(u,y)}};e.prototype.GetCurrentCellStyle=function(e,t,n,i){var s={};i&&(s=o.StyleUtil.MergeCellStyles(this.styles.defaultCellStyle,s));var u,a=null==e;if(a)u=this.gridFieldMap[n].GetPropType();else{var f=e.GetProp(n);u=null!=f?f.propType:null}if(null!=u&&null!=u.GetStyleId){null!=(d=u.GetStyleId(a?null:e.GetDataValue(n)))&&(s=o.StyleUtil.MergeCellStyles(this.styles.GetCellStyle(d),s))}if(!a){var l=this.fnGetGridRowStyleId&&this.fnGetGridRowStyleId(e);if(null!=(l=null!=l?l:this.operationalUtil.GetValue(e,r.JsGridConstants.OperationalConstants.GridRowStyleId))){var c=this.styles.GetCellStyle(l);null!=c&&(s=o.StyleUtil.MergeCellStyles(c,s))}}var h=this.gridFieldMap[n].GetDefaultCellStyleId();null!=h&&(s=o.StyleUtil.MergeCellStyles(this.styles.GetCellStyle(h),s));if(null!=t.fnGetCellStyleId&&!a){var p=t.fnGetCellStyleId(e,n,e.HasDataValue(n)?e.GetDataValue(n):null);if(null!=p){var d;null!=(d=this.styles.GetCellStyle(p))&&(s=o.StyleUtil.MergeCellStyles(d,s))}}return s};e.prototype.RefreshCellStyle=function(e,t,n){var r=e.GetRecord(),s=e.GetColumn(),u=e.GetFieldKey(),a=e.GetTd(),f=null!=r?r.recordKey:e.GetRecordKey();""!==a.style.backgroundColor&&(a.style.backgroundColor="");var l=this.GetCurrentCellStyle(r,s,u,!1);if(!i.JsGridUtil.Internal.IsAssocArrayEmpty(l)){o.StyleUtil.ApplyCellStyle(a,l);if(null!=this.focusedReadOnlyCell&&this.focusedReadOnlyCell.rk==f&&this.focusedReadOnlyCell.fk==u){this.focusedReadOnlyCell.textColor=null!=l.textColor?l.textColor:null!=this.styles.defaultCellStyle.textColor?this.styles.defaultCellStyle.textColor:"";this.focusedReadOnlyCell.backgroundColor=null!=l.backgroundColor?l.backgroundColor:null!=this.styles.defaultCellStyle.backgroundColor?this.styles.defaultCellStyle.backgroundColor:""}}a.computedBackgroundColor=l.backgroundColor;n?this.ApplyGridComputedCellStyle(f,u,e,t):i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.computeGridCellStyleJobKey,f,u);this._objBag.editUtil.IsEditingEnabled()&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.computeGridROStyleJobKey,f,u);return l};e.prototype.ResetSelection=function(){var e=this._selectionMgr.GetFocusForPane(this.gridPane);this._objBag.bUpdateCoordCache=!0;null!=e&&this._selectionMgr.SelectRange(this.gridPane,e.rowIdx,e.rowIdx,e.colIdx,e.colIdx,s.SelectOp.Set,!1,!1)};e.prototype.BindEditControl=function(){var e=this,t=this._selectionMgr.GetFocusForPane(this.gridPane),n=function(t,n,r,i){if(!e._editMgr.IsBound()&&null!=n&&e._objBag.editUtil.CanBindToField(n,r,i)){e.useCustomSelFrames=!1;e._editMgr.BindToCell(e.gridPane,n,r,i,e.gridFieldMap,t,e.RefreshCellStyle(t,!1,!0))}};if(null!=t){var r=this.tableMgr.GetCellByIdx(t.rowIdx,t.colIdx);if(null!=r&&r.GetCellType()==this.tableMgr.CellType.Cell){var i=r.GetRecord(),s=r.GetColumn(),o=r.GetFieldKey();if(!this._editMgr.IsBound()||null!=i&&this._editMgr.IsBoundToCell(this.gridPane,i.key(),o))n(r,i,s,o);else{this.useCustomSelFrames=!1;this._editMgr.Unbind(function(){n(r,i,s,o)})}}}};e.prototype.TryShiftColumnSelectionGroup=function(e,t,n){var s=!1;if(this.bMovableColumns){i.JsGridUtil.DebugAssert(0!==n);var o=this._selectionMgr.GetRowRanges(this.gridPane),u=this._selectionMgr.GetColumnRanges(this.gridPane),f=this._selectionMgr.GetCellRanges(this.gridPane),l=null==o||0==o.length,c=null==u||0==u.length,h=null==f||0==f.length;if(l&&(c||h)&&(c||1==u.length)&&(h||1==f.length)){var p=c?f[0].colRange:u[0],d=n>0?p.end+1:p.begin-1;if(d>=0&&d<this.paneConverter.GetVirtualColumnCount()){for(var v=c?r.JsGridConstants.SelectionType.CellRange:r.JsGridConstants.SelectionType.ColumnRange,m=[this.CreateSingleSelectionCmd(e,t,c?f[0]:u[0],v,!0,!1)],g=p.begin;g<=p.end;g++){var y=d+(n>0?-1:1);m.push(this.CreateMoveColumnCommand(d,y));d=y}var b=n>0?1:-1;p.begin+=b;p.end+=b;t+=b;m.push(this.CreateSingleSelectionCmd(e,t,c?f[0]:u[0],v,!1,!0));this._commandMgr.Execute(new a.AggregateCommand(m,!0),"Column Reorder",a.CommandManagerConstants.CommandType.Explicit);s=!0}}}return s};e.prototype.CreateSingleSelectionCmd=function(e,t,n,i,o,u){var a,f,l,c,h=this;if(i==r.JsGridConstants.SelectionType.ColumnRange){l=n.begin;c=n.end}if(i==r.JsGridConstants.SelectionType.CellRange){l=n.colRange.begin;c=n.colRange.end;a=n.rowRange.begin;f=n.rowRange.end}var p=function(){h._selectionMgr.SetFocusByPos(h.gridPane,e,t);h._selectionMgr.SelectRange(h.gridPane,a,f,l,c,s.SelectOp.Set,!0)};return{Apply:o?function(){}:p,Undo:u?function(){}:p}};e.prototype.RecomputeTableViewportRelativeToParentNode=function(e){this.tableViewportRelativeToParentNode={left:1+this._paneSize.GetLeftOffset(),top:1+this.tableMgr.GetHeaderHeight(),right:1+this._paneSize.GetLeftOffset()+this._paneSize.GetWidth(),bottom:1+e};var t=this.tableMgr.GetRowHeaderWidth()?this.tableMgr.GetRowHeaderWidth():0;this._objBag.RTL.bEnabled?this.tableViewportRelativeToParentNode.right-=t:this.tableViewportRelativeToParentNode.left+=t};e.prototype.GetTdCoordsRelativeToParentNode=function(e){var t;if(null!=e.parentNode){(t=this.tableMgr.GetTdCoords(e)).left+=1+this._paneSize.GetLeftOffset();t.right+=1+this._paneSize.GetLeftOffset();t.top+=1;t.bottom+=1}return t};e.prototype.GetTableViewportRelativeToParentNode=function(){if(this.dontReflow)return this.tableViewportRelativeToParentNode;var e=Math.max(this.tableDiv.offsetHeight,400);this.RecomputeTableViewportRelativeToParentNode(e);return this.tableViewportRelativeToParentNode};e.prototype.GetCellRangeBorderDrawingInfo=function(e,t,n){var s=!1,o=0;if(this.quickEditVisualRefreshFlightEnabled&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&n===r.JsGridConstants.SelectionType.CellRange&&e.begin===e.end&&t.begin===t.end&&-1===t.begin){s=!0;o=-1}var u,a,f=this.tableMgr.BeginRowIdx(),l=this.tableMgr.EndRowIdx()-1,c=this.tableMgr.BeginColIdx()+o,h=this.tableMgr.EndColIdx()-1,p=e.begin<f,d=t.begin<c,v=e.begin>l,m=t.begin>h,g=e.end<f,y=e.end>l,b=t.end<c;if(v||m||g||b)return null;u=this.quickEditVisualRefreshFlightEnabled&&n===r.JsGridConstants.SelectionType.RowRange?this._objBag.RTL.bEnabled?this.tableMgr.GetCellByIdx(Math.max(f,e.begin),Math.min(h,t.end)):this.tableMgr.GetRowHeader(e.begin):s?this.tableMgr.GetRowHeader(e.begin):this.tableMgr.GetCellByIdx(Math.max(f,e.begin),this._objBag.RTL.bEnabled?Math.min(h,t.end):Math.max(c,t.begin));a=this.quickEditVisualRefreshFlightEnabled&&n===r.JsGridConstants.SelectionType.RowRange?this._objBag.RTL.bEnabled?this.tableMgr.GetRowHeader(e.end):this.tableMgr.GetCellByIdx(Math.min(l,e.end),Math.min(h,t.end)):s?this.tableMgr.GetRowHeader(e.end):this.tableMgr.GetCellByIdx(Math.min(l,e.end),this._objBag.RTL.bEnabled?Math.max(c,t.begin):Math.min(h,t.end));var w=this.GetTdCoordsRelativeToParentNode(u.GetTd()),E=this.GetTdCoordsRelativeToParentNode(a.GetTd()),S=this.quickEditVisualRefreshFlightEnabled&&this._objBag.RTL.bEnabled?1:0,x=w.left-S,T=w.top,N=E.right-S,C=y?T+this._paneSize.GetHeight()+1:E.bottom;return{left:x,top:T,right:N,bottom:C,width:N-x-(this.quickEditVisualRefreshFlightEnabled?1:2),height:C-T-(this.quickEditVisualRefreshFlightEnabled?1:2),bBeginsBeforeColumnHeader:p,bBeginsBeforeRowHeader:d,isSelectionCellSelected:s}};e.prototype.UpdatePositionedElements=function(e){e&&(this._objBag.bUpdateCoordCache=!0);this.UpdateSelectionFrames(!1);this.UpdateFocusFrames();this.UpdateCopyFrames();this.tableMgr.UpdateErrorFrames()};e.prototype.SetSelectionFrameOnNonTdElement=function(e,t){this.useCustomSelFrames=!0;this.ClearPseudoElementFrame(this._cellsWithBorder,b.cellHasSelectionBorder);this._cellsWithBorder.push(e);e.classList.add(b.selectedEditor);var n=e.getBoundingClientRect();this.PositionGridSelectionDragHandle(t.y+n.height-5,t.x+(n.width-3),"")};e.prototype.PositionGridSelectionFrameAroundNonstandardElement=function(e,t){var n=this.quickEditVisualRefreshFlightEnabled,r={Top:{top:t.y,left:t.x,width:e.width-(n?0:1),zIndex:n?"":M},Bottom:{top:t.y+e.height-1,left:t.x,width:e.width-(n?0:4),zIndex:n?"":M},Right:{top:t.y,left:t.x+e.width-(n?2:1),height:e.height-(n?-1:4),zIndex:n?"":M},Left:{top:t.y,left:t.x,height:e.height-(n?-1:1),zIndex:n?"":M}};this.useCustomSelFrames=!0;this.PositionGridSelectionFrame(r);n?this.PositionGridSelectionDragHandle(t.y+e.height-5,t.x+(e.width-3),""):this.PositionGridSelectionDragHandle(t.y+e.height-1-1,t.x+e.width-1-1,(M+1).toString());this.UnhideSelectionFrames()};e.prototype.PositionGridSelectionFrame=function(e,t){for(var n in this.selectionFrames){this.selectionFrames[n].style.visibility=e[n].visibility;delete e[n].visibility;for(var r in e[n])"zIndex"!==r&&e[n][r]?this.selectionFrames[n].style[r]=e[n][r]+"px":this.selectionFrames[n].style[r]=e[n][r];this.quickEditVisualRefreshFlightEnabled?t?this.selectionFrames[n].classList.add(w.readonlySelectionRect):this.selectionFrames[n].classList.remove(w.readonlySelectionRect):this.selectionFrames[n].style["border"+n]=o.StyleUtil.MakeBorderString(2,"solid",t?this.styles.gridPaneStyle.readonlySelectionRectBorderColor:this.styles.gridPaneStyle.selectionRectBorderColor)}};e.prototype.PositionGridSelectionDragHandle=function(e,t,n){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){this.selectionDragHandle.style.top=null;this.selectionDragHandle.style.bottom=null;this.selectionDragHandle.children[0].style.left=null;this.selectionDragHandle.children[0].style.right=null;this.selectionDragHandle.children[0].style.top=e+"px";if(this._lastSelectionRangeNormalized.colRange.begin<=i.JsGridUtil.Internal.stickyLastColIdx&&this._lastSelectionRangeNormalized.colRange.end<=i.JsGridUtil.Internal.stickyLastColIdx){this.selectionDragHandle.classList.add(w.stickyHandle);this.selectionDragHandle.style.position="sticky";t+=i.JsGridUtil.Internal.stickyLeftEdgeOffset-2}}else{this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=e+"px"}this.selectionDragHandle.style.left=t+"px";n&&(this.selectionDragHandle.style.zIndex=n)};e.prototype.HideSelectionFrames=function(e){if(this.selectionDragHandle&&this.selectionFrames){e||(this.selectionDragHandle.style.visibility="hidden");for(var t in this.selectionFrames)this.selectionFrames[t].style.visibility="hidden"}};e.prototype.UnhideSelectionFrames=function(){this.selectionDragHandle.style.visibility="";for(var e in this.selectionFrames)this.selectionFrames[e].style.visibility=""};e.prototype.UpdatePseudoStickyElementsForScroll=function(e){var t=0,n=0;if(this.selectionDragHandle&&this._cellsWithBorder&&this._cellsWithBorder.length&&this._lastSelectionRangeNormalized&&this._lastSelectionRangeNormalized.colRange&&this._lastSelectionRangeNormalized.rowRange&&this._lastSelectionRangeNormalized.colRange.begin==this._lastSelectionRangeNormalized.colRange.end&&this._lastSelectionRangeNormalized.rowRange.begin==this._lastSelectionRangeNormalized.rowRange.end){t=this._cellsWithBorder[0].offsetLeft;n=this._cellsWithBorder[0].clientWidth}for(var r=document.getElementsByClassName(y.stickyEditor),s=0;s<r.length;s++)this.jsGridObj.objBag.RTL.bEnabled?r[s].style.right=(e.scrollWidth-(t+n)-(i.JsGridUtil.Internal.stickyLeftEdgeOffset-2)).toString()+"px":r[s].style.left=(t+2).toString()+"px"};e.prototype.ClearPseudoElementFrame=function(e,t,n){for(;e.length>0;){e[0].classList.remove(b.readOnlySelectionFrame);e[0].classList.remove(t);n&&e[0].classList.remove(n);e[0].classList.remove(b.cellTopBorder);e[0].classList.remove(b.cellBottomBorder);e[0].classList.remove(b.cellLeftBorder);e[0].classList.remove(b.cellRightBorder);e.splice(0,1)}};e.prototype.ApplyPseudoElementFrame=function(e,t,n,r){var i=E.deepCopy(e.colRange);r&&(i.begin=-1);for(var s=i.begin;s<=i.end;s++){var o=void 0;if(-1!=s)o=this.GetCellByIdx(e.rowRange.begin,s).GetTd();else{o=this.GetCellByIdx(e.rowRange.begin,0).GetTd().previousElementSibling}o.classList.add(b.cellTopBorder);o.classList.add(n);t.push(o);if(-1!=s)o=this.GetCellByIdx(e.rowRange.end,s).GetTd();else{o=this.GetCellByIdx(e.rowRange.end,0).GetTd().previousElementSibling}o.classList.add(b.cellBottomBorder);o.classList.add(n);t.push(o)}for(s=e.rowRange.begin;s<=e.rowRange.end;s++){o=void 0;if(-1!=i.begin)o=this.GetCellByIdx(s,i.begin).GetTd();else{o=this.GetCellByIdx(s,0).GetTd().previousElementSibling}this._objBag.RTL.bEnabled?o.classList.add(b.cellRightBorder):o.classList.add(b.cellLeftBorder);o.classList.add(n);t.push(o);if(-1!=i.end)o=this.GetCellByIdx(s,i.end).GetTd();else{o=this.GetCellByIdx(s,0).GetTd().previousElementSibling}this._objBag.RTL.bEnabled?o.classList.add(b.cellLeftBorder):o.classList.add(b.cellRightBorder);o.classList.add(n);t.push(o)}};e.prototype.UpdateSelectionFrames=function(e){var t=this;if(!this.dontReflow){i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ClearPseudoElementFrame(this._cellsWithBorder,b.cellHasSelectionBorder);if(e)(function(){t.selectionDragHandle.style.backgroundColor=t.const_BlurBorderColor;for(var e in t.selectionFrames)t.selectionFrames[e].style.borderColor=t.const_BlurBorderColor})();else if(null!=this._selectionMgr.GetFocusForPane(this.gridPane)&&this.paneConverter.GetVirtualRowCount()&&this.paneConverter.GetVirtualColumnCount()&&this._cutcopypasteMgr.IsSelectionCopyable(this.gridPane)){var n=this._selectionMgr.GetLastSelectionRangeNormalized();if(null!=n){var s=!1;if(this._objBag.editUtil.IsEditingEnabled()&&this._selectionMgr.IsOneCellSelected(n)){null==(h=this.tableMgr.GetCellByIdx(n.rowRange.begin,n.colRange.begin))||this._objBag.editUtil.CanEditField(h.GetRecord(),h.GetColumn(),h.GetFieldKey())||this._objBag.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState)&&this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,h.GetFieldKey())===r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive||(s=!0)}var o=this._selectionMgr.GetLastSelectionType();this.quickEditVisualRefreshFlightEnabled&&o===r.JsGridConstants.SelectionType.RowRange&&(i.JsGridUtil._lastColumnVisibilityKillSwitchIsActive||this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn)&&(n.colRange.end=n.colRange.end-1);var u=this.gridPane.GetCellRangeBorderDrawingInfo(n.rowRange,n.colRange,o);if(null!=u){var a=this.quickEditVisualRefreshFlightEnabled?u.width:u.width+2+2,f=this.quickEditVisualRefreshFlightEnabled?u.height:u.height+2+2,l=this.quickEditVisualRefreshFlightEnabled?{Top:{left:u.left,top:u.top,width:a,visibility:""},Right:{left:u.right-3,top:u.top,height:f-2,visibility:""},Bottom:{left:u.left,top:u.bottom-5,width:a,visibility:""},Left:{left:u.left,top:u.top,height:f-2,visibility:""}}:{Top:{left:u.left-1,top:u.top-1,width:a-2,visibility:""},Right:{left:u.right-3,top:u.top-1,height:f-2,visibility:""},Bottom:{left:u.left-1,top:u.bottom-3,width:a-2,visibility:""},Left:{left:u.left-1,top:u.top-1,height:f-2,visibility:""}};u.bBeginsBeforeRowHeader&&(l[this._objBag.RTL.Left].visibility="hidden");u.bBeginsBeforeColumnHeader&&(l.Top.visibility="hidden");if(!this.useCustomSelFrames||!this._lastSelectionRangeNormalized||this._lastSelectionRangeNormalized.rowRange&&this._lastSelectionRangeNormalized.colRange&&(this._lastSelectionRangeNormalized.rowRange.IsDifferent(n.rowRange)||this._lastSelectionRangeNormalized.colRange.IsDifferent(n.colRange))){this.selectionDragHandle.style.visibility="hidden";if(this._objBag.editUtil.IsEditingEnabled()&&this._objBag.jsGridParams.tableViewParams.bFillControlEnabled){if(this.quickEditVisualRefreshFlightEnabled){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n){this.ApplyPseudoElementFrame(n,this._cellsWithBorder,b.cellHasSelectionBorder,o===r.JsGridConstants.SelectionType.RowRange);s&&n.colRange.begin===n.colRange.end&&n.rowRange.begin===n.rowRange.end&&this._cellsWithBorder[0].classList.add(b.readOnlySelectionFrame)}s?i.JsGridUtil.Internal.IsStickyColumnEnabled()?this.selectionDragHandle.children[0].classList.add(w.readonlySelectionRect):this.selectionDragHandle.classList.add(w.readonlySelectionRect):i.JsGridUtil.Internal.IsStickyColumnEnabled()?this.selectionDragHandle.children[0].classList.remove(w.readonlySelectionRect):this.selectionDragHandle.classList.remove(w.readonlySelectionRect);if(o===r.JsGridConstants.SelectionType.RowRange){this.selectionDragHandle.classList.add(w.rowSelectionHandle);this.selectionDragHandle.style.visibility="";i.JsGridUtil.Internal.IsStickyColumnEnabled()||(this.selectionDragHandle.style.top=u.bottom-9+"px");this._objBag.RTL.bEnabled?this.selectionDragHandle.style.left=u.right-7+"px":this.selectionDragHandle.style.left=u.left+"px";if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){this.selectionDragHandle.style.top=null;this.selectionDragHandle.style.bottom=null;this.selectionDragHandle.children[0].style.left=null;this.selectionDragHandle.children[0].style.right=null;this.selectionDragHandle.classList.add(w.stickyHandle);this.selectionDragHandle.style.position="sticky";if(this._objBag.RTL.bEnabled){this.selectionDragHandle.style.left=null;this.selectionDragHandle.style.right=i.JsGridUtil.Internal.stickyLeftEdgeOffset.toString()+"px"}else{this.selectionDragHandle.style.right=null;this.selectionDragHandle.style.left=i.JsGridUtil.Internal.stickyLeftEdgeOffset.toString()+"px"}this.selectionDragHandle.children[0].style.top=u.bottom-9+"px"}}else if(o===r.JsGridConstants.SelectionType.CellRange){this.selectionDragHandle.classList.remove(w.rowSelectionHandle);this.selectionDragHandle.style.visibility=u.isSelectionCellSelected?"hidden":"";if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){this.selectionDragHandle.style.top=null;this.selectionDragHandle.style.bottom=null;this.selectionDragHandle.children[0].style.left=null;this.selectionDragHandle.children[0].style.right=null;this.selectionDragHandle.children[0].style.top=u.bottom-7+"px";var c=0;c=this._objBag.RTL.bEnabled?u.left-35:u.right-3;if(n.colRange.begin<=i.JsGridUtil.Internal.stickyLastColIdx&&n.colRange.end<=i.JsGridUtil.Internal.stickyLastColIdx){this.selectionDragHandle.classList.add(w.stickyHandle);this.selectionDragHandle.style.position="sticky";c+=i.JsGridUtil.Internal.stickyLeftEdgeOffset-2;if(this._objBag.RTL.bEnabled){this.selectionDragHandle.style.left=null;this.selectionDragHandle.style.right=u.width+86+"px"}else this.selectionDragHandle.style.left=c+"px"}else{this.selectionDragHandle.classList.remove(w.stickyHandle);this.selectionDragHandle.style.position="absolute";this.selectionDragHandle.style.left=c+"px";this.selectionDragHandle.style.right=null}}else{this.selectionDragHandle.style.top=u.bottom-7+"px";this._objBag.RTL.bEnabled?this.selectionDragHandle.style.left=u.left-2+"px":this.selectionDragHandle.style.left=u.right-5+"px"}if(!L&&this._objBag.editUtil.IsEditingEnabled()&&this._selectionMgr.IsOneCellSelected(n)){var h,p=this._objBag.errorMgr;(h=this.tableMgr.GetCellByIdx(n.rowRange.begin,n.colRange.begin))&&p&&p.CellHasError(h.GetRecordKey(),h.GetFieldKey())&&(this.selectionDragHandle.style.visibility="hidden")}}}else{this.selectionDragHandle.style.backgroundColor=s?this.styles.gridPaneStyle.readonlySelectionRectBorderColor:this.styles.gridPaneStyle.selectionRectBorderColor;if(o==r.JsGridConstants.SelectionType.RowRange){this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=u.bottom-3+"px";l[this._objBag.RTL.Left].height-=5;l.Bottom.width-=9;if(this._objBag.RTL.bEnabled)this.selectionDragHandle.style.left=u.right-7+"px";else{this.selectionDragHandle.style.left=u.left+2+"px";l.Bottom.left+=9}}else if(o==r.JsGridConstants.SelectionType.ColumnRange);else{this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=u.bottom-4+"px";l[this._objBag.RTL.Right].height-=5;l.Bottom.width-=5;if(this._objBag.RTL.bEnabled){this.selectionDragHandle.style.left=u.left-2+"px";l.Bottom.left+=5}else this.selectionDragHandle.style.left=u.right-4+"px"}}this.PositionGridSelectionFrame(l,s)}}this._lastSelectionRangeNormalized=n;i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.HideSelectionFrames(!0)}else this.HideSelectionFrames()}else this.HideSelectionFrames()}else this.HideSelectionFrames()}};e.prototype.UpdateCopyFrames=function(e){var t=this,n=function(){for(var e in t.copyFrames)for(var n in t.copyFrames[e]){t.copyFrames[e][n].style.visibility="hidden";t.quickEditVisualRefreshFlightEnabled&&"Fore"===e&&t.copyFrames[e][n].classList.remove(w.dashedBorderUnfocused)}};i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ClearPseudoElementFrame(this._cellsWithCopyBorder,b.cellHasCopyBorder);var s=this._cutcopypasteMgr.GetLastOperation(),o=this._selectionMgr.GetLastSelectionType();this.quickEditVisualRefreshFlightEnabled&&o===r.JsGridConstants.SelectionType.RowRange&&s&&e&&(i.JsGridUtil._lastColumnVisibilityKillSwitchIsActive||this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn)&&(s.colRange.end=s.colRange.end-1);var u=null!=s&&s.gridPane==this.gridPane?this.gridPane.GetCellRangeBorderDrawingInfo(s.rowRange,s.colRange,s.selType):null;if(null!=u){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){var a=s;o===r.JsGridConstants.SelectionType.RowRange&&(a.colRange.begin=-1);this.ApplyPseudoElementFrame(s,this._cellsWithCopyBorder,b.cellHasCopyBorder)}var f=u.width+2,l=u.height+2,c=this.quickEditVisualRefreshFlightEnabled?{Top:{left:u.left,top:u.top,width:f-2,visibility:""},Right:{left:u.right-3,top:u.top,height:l-4,visibility:""},Bottom:{left:u.left,top:u.bottom-5,width:f-2,visibility:""},Left:{left:u.left,top:u.top,height:l-4,visibility:""}}:{Top:{left:u.left,top:u.top,width:f,visibility:""},Right:{left:u.right-2,top:u.top,height:l,visibility:""},Bottom:{left:u.left,top:u.bottom-2,width:f,visibility:""},Left:{left:u.left,top:u.top,height:l,visibility:""}};u.bBeginsBeforeRowHeader&&(c[this._objBag.RTL.Left].visibility="hidden");u.bBeginsBeforeColumnHeader&&(c.Top.visibility="hidden");for(var h in this.copyFrames)for(var p in this.copyFrames[h])for(var d in c[p]){this.copyFrames[h][p].style[d]="visibility"==d?c[p][d]:c[p][d]+"px";this.quickEditVisualRefreshFlightEnabled&&"Fore"===h&&this.copyFrames[h][p].classList.remove(w.dashedBorderUnfocused)}i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n()}else n()};e.prototype.UpdateFocusFrames=function(){var e=this,t=function(){for(var t in e.focusFrames)e.focusFrames[t].style.visibility="hidden"};i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ClearPseudoElementFrame(this._cellsWithFocusBorder,b.cellHasSelectionBorder);var n=this._selectionMgr.GetFocusForPane(this.gridPane);if(null==n||this._cutcopypasteMgr.IsSelectionCopyable(this.gridPane))t();else{var r,o=new u.Range(n.rowIdx,n.rowIdx).Normalize(),a=new u.Range(n.colIdx,n.colIdx).Normalize(),f=this._selectionMgr.GetLastSelectionType();if(null!=(r=this.quickEditVisualRefreshFlightEnabled&&i.JsGridUtil.Internal.IsFeatureEnabled(O)?this.gridPane.GetCellRangeBorderDrawingInfo(o,a,f):this.gridPane.GetCellRangeBorderDrawingInfo(o,a))){var l=r.width,c=r.height,h=this.quickEditVisualRefreshFlightEnabled?{Top:{left:r.left,top:r.top,width:l},Right:{left:r.right-3,top:r.top,height:c-2},Bottom:{left:r.left,top:r.bottom-5,width:l},Left:{left:r.left,top:r.top,height:c-2}}:{Top:{left:r.left+1,top:r.top+1,width:l},Right:{left:r.right-2,top:r.top+1,height:c},Bottom:{left:r.left+1,top:r.bottom-2,width:l},Left:{left:r.left+1,top:r.top+1,height:c}};for(var p in this.focusFrames){for(var d in h[p])this.focusFrames[p].style[d]=h[p][d]+"px";this.focusFrames[p].style.visibility=""}if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n){var v={rowRange:o,colRange:a};f===s.SelectionType.RowRange&&(v.colRange.begin=-1);this.ApplyPseudoElementFrame({rowRange:o,colRange:a},this._cellsWithFocusBorder,b.cellHasSelectionBorder,!1);t()}}else t()}};e.prototype.CreateHideShowColumnCommand=function(e,t,n){var r=this;n=null!=n?n:this.paneConverter.ColKeyToColIdx(t.columnKey);var i=function(){var e=r._selectionMgr.GetFocusForPane(r.gridPane);r.HideImpl(t,n);r.TryRestoreFocusAfterInsertOrDeleteColumns(e);r.UpdatePositionedElements();r._editMgr.NotifyMove(r.gridPane)},s=function(){var e=r._selectionMgr.GetFocusForPane(r.gridPane);r.ShowImpl(t,n);r.TryRestoreFocusAfterInsertOrDeleteColumns(e);r.gridPane.ScrollColumnIntoViewHorizontally(n);r.UpdatePositionedElements();r._editMgr.NotifyMove(r.gridPane)};return"hide"==e?{Apply:i,Undo:s}:{Apply:s,Undo:i}};e.prototype.TryRestoreFocusAfterInsertOrDeleteColumns=function(e){if(null!=e)if(null!=this.paneConverter.KeyToIdx(e.recordKey,e.fieldKey))this._selectionMgr.SetFocusByKey(this.gridPane,e.recordKey,e.fieldKey);else{var t=e.colIdx>=this.paneConverter.GetVirtualColumnCount()?this.paneConverter.GetVirtualColumnCount()-1:e.colIdx;this._selectionMgr.Clear();this._selectionMgr.SetFocusByPos(this.gridPane,e.rowIdx,t)}};e.prototype.HideImpl=function(e,t){this.ResetSelection();this.tableMgr.RemoveColumns(t,1);this.itemSizes.splice(t,1);this.horizScrollBar.Update({itemCount:this.itemSizes.length,itemSizes:this.itemSizes});e.isVisible=!1};e.prototype.ShowImpl=function(e,t){t<this.paneConverter.GetVirtualColumnCount()&&this.gridPane.ScrollColumnIntoViewHorizontally(t);this.ResetSelection();this.headerMgr.AdjustColumnWidth(e);this.tableMgr.InsertColumns(t,[e]);this.itemSizes.splice(t,0,e.width);this.horizScrollBar.Update({itemCount:this.itemSizes.length,itemSizes:this.itemSizes});e.isVisible=!0};e.prototype.HandleUpdateInAllColumns=function(e,t){for(var n=this.allColumns.GetColumnArray(),r=0;r<n.length&&!(r>e&&r>t);r++)if(!n[r].isVisible){r<=e&&e++;r<=t&&t++}i.JsGridUtil.Internal.MoveItemInArray(n,e,t)};e.prototype.CreateMoveColumnCommand=function(e,t){var n=this,r=function(e,t){if(e!==t){var r=n._selectionMgr.GetFocusForPane(n.gridPane),i=n.horizScrollBar.GetTopItemIdx(),s=n.paneConverter.GetColumnByIdx(e);n.HideImpl(s,e);n.ShowImpl(s,t);null!=r&&n._selectionMgr.SetFocusByKey(n.gridPane,r.recordKey,r.fieldKey);n.UpdatePositionedElements();n.horizScrollBar.Update({topItemIdx:i});n.HandleUpdateInAllColumns(e,t);n._editMgr.NotifyMove(n.gridPane)}};return{Apply:function(){r(e,t)},Undo:function(){r(t,e)}}};e.prototype.ShowColumnInternal=function(e,t){if(null==t)for(var n=0,r=this.allColumns.GetColumnArray(),s=0;s<r.length;s++){if(r[s]==e){t=s-n;break}r[s].isVisible||n++}i.JsGridUtil.DebugAssert(null!=t);this._commandMgr.Execute(this.CreateHideShowColumnCommand("show",e,t),"Show Column",a.CommandManagerConstants.CommandType.Implicit)};e.prototype.HideColumnInternal=function(e){1!==this.paneConverter.GetVirtualColumnCount()&&this._commandMgr.Execute(this.CreateHideShowColumnCommand("hide",e,null),"Hide Column",a.CommandManagerConstants.CommandType.Implicit)};e.prototype.MoveColumn=function(e,t){var n=e<t?t-1:t;this._commandMgr.Execute(this.CreateMoveColumnCommand(e,n),"Move Column",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.ExpandColumnMenuInternal=function(e){var t=this,n=function(){t.lockedColIdx=null;t.headerMgr.SetColumnMenuCollapsed(e);t.DeactivateColumn();t._objBag.focusMgr.Focus()};if(null==this.lockedColIdx){var i=this.paneConverter.GetColumnByKey(e);if(null==i)return!1;var s;if(null==(s=this.headerMgr.GetColumnHeaderPosition(e)))return!1;this.lockedColIdx=this.paneConverter.ColKeyToColIdx(e);var o=this.headerMgr.GetColumnHeaderElement(e);if(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandColumnMenu)){this.delegateMgr.Apply(r.JsGridConstants.DelegateType.ExpandColumnMenu,e,s,n);this.headerMgr.SetColumnMenuExpanded(e)}else this._objBag.columnMenuMgr.ExpandMenu(i,s,n,this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,o)&&this.headerMgr.SetColumnMenuExpanded(e);return!0}return!1};e.prototype.OnColumnMenuClick=function(e,t){this.ExpandColumnMenuInternal(t)&&i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.ExpandColumnMenu=function(e){if(this._objBag.columnMenuMgr.CanExpandMenu(this.paneConverter.GetColumnByIdx(e),this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,this.bResizableColumns)){this.gridPane.ScrollColumnIntoViewHorizontally(e);this.ActivateColumn(e);return this.ExpandColumnMenuInternal(this.paneConverter.ColIdxToColKey(e))}return!1};e.prototype.OnInsertedRow=function(e,t){null!=e&&this.reorderableRows.Contains(e.GetRecordKey())&&(e.GetTd().style.cursor="move")};e.prototype.OnInsertedColumns=function(e,t,n){for(var r=0;r<e.length;r++){var i=this._objBag.columnMenuMgr.CanExpandMenu(e[r].GetColumn(),this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,this.bResizableColumns),s=e[r].GetTd();this.headerMgr.CreateTableHeaderCell(e[r].GetColumn(),s,n,this.bMovableColumns,this.bResizableColumns,this.bSortableColumns,!0,i?this.OnColumnMenuClick.bind(this):null,this.GetColumnHeaderSibling.bind(this),e[r].GetColIdx());this.headerMgr.ShowMenuOnColumn(this.tableMgr.GetColumnHeader(e[r].GetColIdx()).GetTd());this.headerMgr.ApplyHeaderStyle(s,this.GetHeaderStyle(e[r].GetColIdx(),!1))}null==this.curColUpdateTimeOut&&(this.curColUpdateTimeOut=setTimeout(this.UpdateFirstDisplayColumn.bind(this),0))};e.prototype.UpdateFirstDisplayColumn=function(){if(!this.bIsDisposed){var e=this.tableMgr.GetColumnHeader(this.tableMgr.BeginColIdx());null!=e&&this.headerMgr.NotifyColumnHeaderOrderSet(e.GetTd())}this.curColUpdateTimeOut=null};e.prototype.GetDisplayControlAndContentForCell=function(e,t,n,r,i){var s=t.GetProp(n);if(s){var o=null==s?this.gridFieldMap[n].GetPropType():s.propType;if(o){var u=p.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(o,!N&&t.bIsNewRow?null:i);return{content:u.Render(this._fnGetCellValue(t,n,o),t,e,this.gridFieldMap[n],o,r,this.jsGridObj,this._objBag.RTL,this.tableMgr.GetCellByKey(t.key(),n).GetTd()),displayControl:u}}}return{content:null,displayControl:null}};e.prototype.GetContentForCell=function(e,t,n,r,i){return this.GetDisplayControlAndContentForCell(e,t,n,r,i).content};e.prototype.BuildCellContent=function(e){var t,n,r=this,s=e.GetRecord(),o=function(e){if(null!=e.fnDispose){null==r.disposeMap[c]&&(r.disposeMap[c]={});null==r.disposeMap[c][a]&&(r.disposeMap[c][a]=[]);r.disposeMap[c][a].push(e.fnDispose);e=e.elem}n.appendChild(e)};if(null!=s){var u=e.GetColumn(),a=e.GetFieldKey(),f=u.fnGetDisplayControlName&&u.fnGetDisplayControlName(s,a);t=this.GetDisplayControlAndContentForCell(u,s,a,this.RefreshCellStyle(e),f).content}if(null!=t){n=e.GetTd();var c=s.key();if(null!=t.multipleChildren)for(var h=0;h<t.multipleChildren.length;h++)o(t.multipleChildren[h]);else o(t);return!0}if(!l.addNewItemVisualRefreshKillswitchIsActive&&this.quickEditVisualRefreshFlightEnabled&&s.bIsNewRow&&e&&e.tableColIdx<=2&&"DocIcon"!==e.fieldKey){n=e.GetTd();if(2===e.tableColIdx){if(i.JsGridUtil.Internal.DomElement.GetInstance().GetPrevElement(n).firstChild)return!1}var p=document.createElement("span");p.classList.add(b.inlineNewItemPlaceHolder);p.textContent=g.default.addNewItemPlaceHolder;n.appendChild(p);return!0}return!1};e.prototype.TryDisposeRow=function(e){if(e in this.disposeMap){for(var t in this.disposeMap[e])i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.disposeRenderedObjectsJobKey,e,t);delete this.disposeMap[e]}};e.prototype.TryBeginEdit=function(e){i.JsGridUtil.DebugAssert("keypress"==e.type||"mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&(e.keyCode==r.JsGridConstants.Key.F2||e.keyCode==r.JsGridConstants.Key.IMEInput));var t=this._selectionMgr.GetFocusForPane(this.gridPane);if(null==t)return!1;this.gridPane.ScrollCellIntoView(t.rowIdx,t.colIdx);if(this._editMgr.IsBound()){this._cutcopypasteMgr.CancelMode();this._editMgr.BeginEdit(e);return!0}return!1};e.prototype.GetColumnHeaderSibling=function(e,t){if(l.extraSpacerColumnsKillswitchIsActive)return t?e.previousSibling:e.nextSibling;var n=e.previousSibling;t||(n=e.nextSibling);n&&"presentation"===n.getAttribute("role")&&(n=void 0);return n};e.prototype.GetRowHeaderSibling=function(e,t){var n=t?e.parentNode.previousSibling:e.parentNode.nextSibling;return n&&n.firstChild};e.prototype.GetHeaderStyle=function(e,t,n){var r=t?this.styles.rowHeaderStyleCollection:this.styles.columnHeaderStyleCollection;if(n)return r.normal;for(var i=e==(t?this.activeRowIdx:this.activeColIdx),s=t?[this._selectionMgr.GetRowRanges(this.gridPane),this._selectionMgr.GetColumnRanges(this.gridPane)]:[this._selectionMgr.GetColumnRanges(this.gridPane),this._selectionMgr.GetRowRanges(this.gridPane)],o=0;o<s[0].length;o++)if(s[0][o].Contains(e))return i?r.allSelectedHover:r.allSelected;if(0!==s[1].length)return i?r.partSelectedHover:r.partSelected;var u=this._selectionMgr.GetCellRanges(this.gridPane);for(o=0;o<u.length;o++)if((t?u[o].rowRange:u[o].colRange).Contains(e))return i?r.partSelectedHover:r.partSelected;return i?r.normalHover:r.normal};return e})();t.GridPane=D;var P=(function(){function e(e){this.resizingColIdx=null;this.movingColIdx=null;this.startMovingColIdx=null;this.bColumnSelection=!1;this.bRowReordering=!1;this.bHeaderEventHandlersSetup=!1;this.bScrollTimerActive=!1;this.cachedMouseMoveEventInfo=null;this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};this._lastResize=Date.now();this._resizeDeltaOnMouseMove=0;this._gridPane=e;this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};this._gridPane.tableDiv.addEventListener("mousedown",this.OnTableMouseDown.bind(this));this._gridPane.tableDiv.addEventListener("mousemove",this.OnTableMouseMove.bind(this));this._gridPane.tableDiv.addEventListener("mouseup",this.OnTableMouseUp.bind(this));this._gridPane.tableDiv.addEventListener("dblclick",this.OnTableDoubleClick.bind(this));this._gridPane.selectionDragHandle.addEventListener("mousedown",this.OnFillHandleMouseDown.bind(this));this._gridPane.tableDiv.addEventListener("contextmenu",this.onContextMenu.bind(this))}e.prototype.SetupHeaderEvents=function(){if(!this.bHeaderEventHandlersSetup){this.topTr=this._gridPane.tableMgr.GetColumnHeaderTr();this.topTr.addEventListener("mousedown",this.OnColumnHeaderMouseDown.bind(this));this.topTr.addEventListener("mousemove",this.OnColumnHeaderMouseMove.bind(this));this.topTr.addEventListener("mouseout",this.OnColumnHeaderMouseOut.bind(this));this.topTr.addEventListener("keydown",this.OnColumnHeaderKeyDown.bind(this))}this.bHeaderEventHandlersSetup=!0};e.prototype.ClearHeaderEvents=function(){this.bHeaderEventHandlersSetup&&i.JsGridUtil.ClearEventListeners(this.topTr);this.bHeaderEventHandlersSetup=!1};e.prototype.Dispose=function(){window.removeEventListener("resize",this._gridPane.onResizeHandler);this.ClearHeaderEvents();i.JsGridUtil.ClearEventListeners(this._gridPane.tableDiv);i.JsGridUtil.ClearEventListeners(this._gridPane.selectionDragHandle);this.topTr=null};e.prototype.ShiftSelect=function(e,t){var n=t.GetCellType(),r=e.ctrlKey?s.SelectOp.ReplaceLast:s.SelectOp.Set,i=this._gridPane._selectionMgr.GetFocusForPane(this._gridPane);null!=i&&(this.cachedMouseDownCellInfo.cellType!=this._gridPane.tableMgr.CellType.RowHeader||n!=this._gridPane.tableMgr.CellType.RowHeader&&n!=this._gridPane.tableMgr.CellType.Cell?this.cachedMouseDownCellInfo.cellType!=this._gridPane.tableMgr.CellType.ColumnHeader||n!=this._gridPane.tableMgr.CellType.ColumnHeader&&n!=this._gridPane.tableMgr.CellType.Cell?this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&n==this._gridPane.tableMgr.CellType.Cell&&this._gridPane._selectionMgr.SelectRange(this._gridPane,i.rowIdx,t.GetRowIdx(),i.colIdx,t.GetColIdx(),r,!1,!0):this._gridPane._selectionMgr.SelectRange(this._gridPane,null,null,i.colIdx,t.GetColIdx(),r,!1,!0):this._gridPane._selectionMgr.SelectRange(this._gridPane,i.rowIdx,t.GetRowIdx(),null,null,r,!1,!0))};e.prototype.OnFillHandleMouseDown=function(e){if(i.JsGridUtil.Internal.IsFeatureEnabled(A)&&this._gridPane._editMgr.IsEditing()){e.preventDefault();e.stopPropagation()}else e.button==r.JsGridConstants.MouseButton.leftButton&&this._gridPane._selectionMgr.GetFocusedPane()==this._gridPane&&this._gridPane._fillDownMgr.OnMouseDown(e,this._gridPane,this._gridPane._objBag.parentNode,this._gridPane.selectionDragHandle,this._gridPane.tableMgr,this._gridPane._selectionMgr)};e.prototype.OnTableDoubleClick=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);(t&&t.GetCellType())==this._gridPane.tableMgr.CellType.ColumnHeader&&this.AutoResizeActiveColumn();this.FireClickEvent(e,t,r.JsGridConstants.EventType.OnDoubleClick)};e.prototype.OnTableMouseDown=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};if(!i.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")&&e.button==r.JsGridConstants.MouseButton.leftButton){if(t&&null==t.GetRowIdx()&&!this.bColumnSelection)return;if(i.JsGridUtil.Internal.IsFeatureEnabled(A)){this._gridPane.tableDiv.classList.add(b.tableParentDiv);this._gridPane.tableDiv.classList.add(b.tableHasMouseDown)}this.bColumnSelection=!1;this.HandleTableLeftClick(t,e)}};e.prototype.onContextMenu=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};if(!i.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")){this.FireClickEvent(e,t,r.JsGridConstants.EventType.OnRightClick);return!1}};e.prototype.HandleTableLeftClick=function(e,t){var n,r,o,u,a=this;if(null!=e){this.cachedMouseDownCellInfo.cellType=e.GetCellType();this.cachedMouseDownCellInfo.recordKey=e.GetRecordKey();this.cachedMouseDownCellInfo.fieldKey=e.GetFieldKey();i.JsGridUtil.Internal.IsFeatureEnabled(A)&&i.JsGridUtil.Internal.IsFeatureEnabled(O)&&this._gridPane._selectAllCell.GetTd().classList.remove(b.allRowsSelected);if(this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader&&this._gridPane.reorderableRows.Contains(this.cachedMouseDownCellInfo.recordKey)){this.StartRowReorder(t);return}var f=this._gridPane._selectionMgr.GetFocusForPane(this._gridPane);if(i.JsGridUtil.Internal.IsFeatureEnabled(A)&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&f){var l=null===(n=this._gridPane.GetCellByIdx(f.rowIdx,0))||void 0===n?void 0:n.GetTr(),c=null===(r=this._gridPane.GetCellByIdx(e.GetRowIdx(),0))||void 0===r?void 0:r.GetTr();null===(o=l)||void 0===o||o.classList.remove(b.rowHasOnlyOneCellSelected);null===(u=c)||void 0===u||u.classList.add(b.rowHasOnlyOneCellSelected)}if(this.cachedMouseDownCellInfo.cellType!==this._gridPane.tableMgr.CellType.SelectAllSquare){t.preventDefault();this.lastMouseMoveCell=e;i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(this._gridPane.tableDiv,this.OnTableMouseMoveForSelect.bind(this),function(){setTimeout(a.UpdateRowHeadersForReorder.bind(a),0)})}if(t.shiftKey)this.ShiftSelect(t,e);else{var h=e.GetRowIdx(),p=e.GetColIdx(),d=t.ctrlKey?s.SelectOp.Append:s.SelectOp.Set;this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader?i.JsGridUtil.Internal.IsFeatureEnabled(A)&&i.JsGridUtil.Internal.IsFeatureEnabled(O)?this.FilterRowHeaderSelection(h,e):this._gridPane._selectionMgr.SelectRange(this._gridPane,h,h,null,null,d,!0,!1):this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.ColumnHeader?this._gridPane._selectionMgr.SelectRange(this._gridPane,null,null,p,p,d,!0,!1):this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&this._gridPane._selectionMgr.SelectRange(this._gridPane,h,h,p,p,d,!0,!1);i.JsGridUtil.Internal.IsFeatureEnabled(A)&&i.JsGridUtil.Internal.IsFeatureEnabled(O)&&this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader?this.lastMouseMoveCell=e=this._gridPane.tableMgr.GetRowHeaderByKey(this.cachedMouseDownCellInfo.recordKey):this.lastMouseMoveCell=e=this._gridPane.tableMgr.GetCellByKey(this.cachedMouseDownCellInfo.recordKey,this.cachedMouseDownCellInfo.fieldKey);this.cachedMouseDownCellInfo.bPendingClick=this.cachedMouseDownCellInfo.bPendingDoubleClick=!0}if(this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&null!=f&&f.recordKey==this.cachedMouseDownCellInfo.recordKey&&f.fieldKey==this.cachedMouseDownCellInfo.fieldKey&&this._gridPane.TryBeginEdit(t)){i.JsGridUtil.Internal.IsFeatureEnabled(A)&&this._gridPane.tableDiv.classList.remove(b.tableHasMouseDown);t.stopPropagation()}}};e.prototype.FilterRowHeaderSelection=function(e,t){var n=t.GetRecord();if(!l.addNewItemVisualRefreshKillswitchIsActive&&n&&n.bIsNewRow){var r=t.GetTr();if(r&&r.classList&&!r.classList.contains(b.rowIsActive))return}var i=this._gridPane._selectionMgr,o=i.GetRowRanges(this._gridPane),u=i.IsRowSelected(this._gridPane,e),a=u?s.RowSelectOp.Unselect:s.RowSelectOp.Select,f=a!==s.RowSelectOp.Unselect;1===o.length&&o[0].begin===o[0].end&&u?i.SelectRange(this._gridPane,e,e,0,0,s.SelectOp.Set,!0,!1):i.SelectRange(this._gridPane,e,e,null,null,a,f,!1)};e.prototype.OnTableMouseUp=function(e){if(this.cachedMouseDownCellInfo.bPendingClick){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);null!=t&&!this._gridPane._editMgr.IsEditing()&&this._gridPane._selectionMgr.IsOneCellSelected(this._gridPane._selectionMgr.GetLastSelectionRangeNormalized())&&t.GetCellType()==this._gridPane.tableMgr.CellType.Cell&&this.cachedMouseDownCellInfo.recordKey==t.GetRecordKey()&&this.cachedMouseDownCellInfo.fieldKey==t.GetFieldKey()&&this._gridPane._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnSingleCellClick,i.JsGridUtil.EventArgs.SingleCellClick(e,this.cachedMouseDownCellInfo.recordKey,this.cachedMouseDownCellInfo.fieldKey));this.cachedMouseDownCellInfo.bPendingClick=!1}i.JsGridUtil.Internal.IsFeatureEnabled(A)&&this._gridPane.tableDiv.classList.remove(b.tableHasMouseDown)};e.prototype.FireClickEvent=function(e,t,n){var s=t&&t.GetCellType(),o=t&&t.GetRecord(),u=o&&o.key(),a=t&&t.GetFieldKey(),f=s==this._gridPane.tableMgr.CellType.SelectAllSquare?r.JsGridConstants.ClickContext.SelectAllSquare:s==this._gridPane.tableMgr.CellType.RowHeader?r.JsGridConstants.ClickContext.RowHeader:s==this._gridPane.tableMgr.CellType.ColumnHeader?r.JsGridConstants.ClickContext.ColumnHeader:s==this._gridPane.tableMgr.CellType.Cell?r.JsGridConstants.ClickContext.Cell:r.JsGridConstants.ClickContext.Other;if(n==r.JsGridConstants.EventType.OnRightClick||f!==r.JsGridConstants.ClickContext.Cell||this.cachedMouseDownCellInfo.bPendingDoubleClick&&this.cachedMouseDownCellInfo.cellType==s&&this.cachedMouseDownCellInfo.recordKey==u&&this.cachedMouseDownCellInfo.fieldKey==a){this._gridPane._objBag.eventMgr.FireEvent(n,i.JsGridUtil.EventArgs.Click(e,f,u,a));this.cachedMouseDownCellInfo.bPendingDoubleClick=!1}i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.OnTableMouseMoveForSelect=function(e){var t,n,r=this._gridPane.tableMgr.GetCellByChildElement(e.target);if(null!=r&&(null==this.lastMouseMoveCell||!this.lastMouseMoveCell.Equals(r))){if(i.JsGridUtil.Internal.IsFeatureEnabled(A)&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){var s=this.lastMouseMoveCell;null===(n=null===(t=this._gridPane.GetCellByIdx(s.GetRowIdx(),0))||void 0===t?void 0:t.GetTr())||void 0===n||n.classList.remove(b.rowHasOnlyOneCellSelected)}this.ShiftSelect(e,r);this.lastMouseMoveCell=r}};e.prototype.OnTableMouseMove=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);t&&t.GetCellType()==this._gridPane.tableMgr.CellType.RowHeader&&!this.bRowReordering?this._gridPane.ActivateRow(t.GetRowIdx()):this._gridPane.DeactivateRow()};e.prototype.GetActiveReorderableRecordKeys=function(e){var t=this._gridPane.jsGridObj.GetSelectedRowRanges();if(1==t.length){var n,i,s=t[0].keys;null==i&&(i={bAllChildKeysInView:!0,bGroupingRowFound:!1,bLevelZeroFound:!1,expandedKeys:s});if(i.bGroupingRowFound||i.bLevelZeroFound)return[];for(var o=0;o<i.expandedKeys.length;o++)if(this._gridPane.jsGridObj.IsEntryRecordKey(i.expandedKeys[o])||this._gridPane.jsGridObj.IsProvisionalRecordKey(i.expandedKeys[o]))return[];n=i.expandedKeys;if(this._gridPane.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)&&this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,n))return e?i.expandedKeys:s}return[]};e.prototype.UpdateRowHeadersForReorder=function(){if(!this._gridPane.bIsDisposed){for(var e=this._gridPane.tableMgr.GetRowHeaders(),t=0;t<e.length;t++)e[t].GetTd().style.cursor="";var n=this.GetActiveReorderableRecordKeys(!1);for(t=0;t<n.length;t++)this._gridPane.tableMgr.GetRowHeaderByKey(n[t]).GetTd().style.cursor="move";this._gridPane.reorderableRows.Clear();this._gridPane.reorderableRows.AddArray(n)}};e.prototype.StartRowReorder=function(e){if(this.ExpandSelectionForReorder()){this.bRowReordering=!0;this.mouseDownY=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e).y;var t=e.target,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(t),r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv);this.origGhostY=n.y-r.y;this._gridPane.rowDropIndic.style.top=this.origGhostY+"px";this._gridPane.rowDropIndic.style.width=t.offsetWidth+"px";this._gridPane.rowDropIndic.style.visibility="";this._gridPane.tableDiv.style.cursor="move";i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(t,this.OnRowReorderMouseMove.bind(this),this.OnRowReorderMouseUp.bind(this));this.OnRowReorderMouseMove(e)}};e.prototype.PositionReorderElements=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv),n=this.RowHeaderHitTest(e);if(n.insertRowIdx!==this._gridPane.tableMgr.EndRowIdx()&&null!=n.insertRowIdx){var r=this._gridPane.tableMgr.GetRowHeader(n.insertRowIdx).GetTd(),s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r).y;this._gridPane.rowDropIndic.style.top=s-t.y-2+"px";this._gridPane.rowDropIndic.style.visibility=""}};e.prototype.OnRowReorderMouseMove=function(e){this.cachedMouseMoveEventInfo=e;this.PositionReorderElements(e);var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv);t.y>=n.y+this._gridPane.tableDiv.offsetHeight-50?this.StartTimerScroll(!1):t.y<=n.y+50?this.StartTimerScroll(!0):this.StopTimerScroll()};e.prototype.TimerScroll=function(e){var t=this;e?this._gridPane._objBag.paneMgr.ScrollUpByOne():this._gridPane._objBag.paneMgr.ScrollDownByOne();this.PositionReorderElements(this.cachedMouseMoveEventInfo);this.bScrollTimerActive&&(this.timer=setTimeout(function(){t.TimerScroll(e)},100))};e.prototype.StartTimerScroll=function(e){var t=this;if(!this.bScrollTimerActive){this.bScrollTimerActive=!0;this.timer=setTimeout(function(){t.TimerScroll(e)},0)}};e.prototype.StopTimerScroll=function(){clearTimeout(this.timer);this.bScrollTimerActive=!1};e.prototype.OnRowReorderMouseUp=function(e){this.StopTimerScroll();this._gridPane.rowDropIndic.style.visibility="hidden";this.bRowReordering=!1;this._gridPane.tableDiv.style.cursor="";var t=this.RowHeaderHitTest(e);if(t.insertRowIdx!==this._gridPane.tableMgr.EndRowIdx()&&null!=t.insertRowIdx){var n=this._gridPane.tableMgr.GetRowHeader(t.insertRowIdx).GetRecordKey();if(this._gridPane.reorderableRows.Contains(n))return;this._gridPane.jsGridObj.IsEntryRecordKey(n)&&(n=null);var s=this.GetSelectionRange();i.JsGridUtil.DebugAssert(!s.bInvalid);this._gridPane.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,s.selectedKeys)||this._gridPane.jsGridObj.ReorderRecords(s.topRecordKey,s.bottomRecordKey,n,!0)}};e.prototype.RowHeaderHitTest=function(e){for(var t,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e).y,r=this._gridPane.tableMgr.GetRowHeaders(),s=0;s<r.length;s++){var o=r[s].GetTd(),u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(o);if(0==s&&n<u.y||n>=u.y&&n<u.y+o.offsetHeight){if(this._gridPane.reorderableRows.Contains(r[s].GetRecordKey())||s>0&&this._gridPane.reorderableRows.Contains(r[s-1].GetRecordKey())){var a=this._gridPane.tableMgr.GetRowHeaderByKey(this._gridPane.jsGridObj.GetSelectedRowRanges()[0].keys[0]);t=null!=a?a.GetRowIdx():r[s].GetRowIdx()}else t=r[s].GetRowIdx();break}}null==t&&(t=this._gridPane.tableMgr.EndRowIdx());return{insertRowIdx:t}};e.prototype.GetSelectionRange=function(){var e=this.GetActiveReorderableRecordKeys(!0);if(null==e||0==e.length)return{bInvalid:!0};for(var t=[],n=0;n<e.length;n++)this._gridPane.paneConverter.IsRecordOnScreen(e[n])&&t.push(e[n]);var r=this._gridPane.paneConverter.GetTopRowIdxForKey(t[0]),i=r,s=r,o=t[0],u=t[0];for(n=1;n<t.length;n++)if((r=this._gridPane.paneConverter.GetTopRowIdxForKey(t[n]))<i){i=r;o=t[n]}else if(r>s){s=r;u=t[n]}return{topIdx:i,bottomIdx:s,topRecordKey:o,bottomRecordKey:u,selectedKeys:e}};e.prototype.ExpandSelectionForReorder=function(){var e=this.GetSelectionRange();if(e.bInvalid)return!1;this._gridPane.jsGridObj.SelectRowRange(e.topIdx,e.bottomIdx,!1);this._gridPane.reorderableRows.Clear();this._gridPane.reorderableRows.AddArray(e.selectedKeys);return!0};e.prototype.DetermineHeaderElementInfo=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colAction",null),n=null;null!=t&&(n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(t.elem,"thColumnKey",null));return{colAction:null!=t?i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t.elem,"colAction"):null,thElem:null!=n?n.elem:null}};e.prototype.OnColumnHeaderMouseDown=function(e){if(e.button===r.JsGridConstants.MouseButton.leftButton){this._gridPane._editMgr.StopEditing(!1);this._gridPane._editMgr.StopEditing(!1);this._gridPane.headerMgr.HeaderMouseDown(e);var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);this.mouseDownX=t.x;var n=this.DetermineHeaderElementInfo(e),s=this._gridPane.headerMgr.InColumnHeaderEditMode()&&"sort"!==n.colAction;if(null==this._gridPane.lockedColIdx&&!s)if("sort"==n.colAction){var o=this.HeaderHitTest(e,!0);if(null!=o.colIdx){var u=this._gridPane.tableMgr.GetColumnHeader(o.colIdx).GetColumn();this._gridPane.headerMgr.OnSort(e,u.columnKey)}}else if("resize"==n.colAction||"resize-current"==n.colAction){e.preventDefault();var a=this._gridPane._objBag.jsGridParams.telemetry;a&&(this._qos=new(a(m.Qos))({name:"QuickEditColumnResize"}));var f="resize"==n.colAction?this._gridPane.GetColumnHeaderSibling(n.thElem,!0):n.thElem;if(null!=f&&null!=f.thColumnKey){i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(this.topTr,this.OnColumnHeaderMouseMoveForColumnResize.bind(this),this.OnColumnHeaderMouseUpForColumnResize.bind(this));this.resizingColIdx=this._gridPane.paneConverter.ColKeyToColIdx(f.thColumnKey);this.origWidth=parseInt(this._gridPane.paneConverter.GetColumnByKey(f.thColumnKey).width,10);this._gridPane.headerMgr.SetColumnResizing(f.thColumnKey)}}else if("select"==n.colAction)this.bColumnSelection=!0;else if(i.JsGridUtil.Internal.IsFeatureEnabled(A)&&i.JsGridUtil.Internal.IsFeatureEnabled(O)){var l=this._gridPane.tableMgr.GetCellByChildElement(e.target);(l&&l.GetCellType())===this._gridPane.tableMgr.CellType.SelectAllSquare&&this._gridPane.SelectAllRows()}}};e.prototype.OnColumnHeaderKeyDown=function(e){if(!i.JsGridUtil.Internal.IsFeatureEnabled(A)||i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==r.JsGridConstants.Key.tab){e.preventDefault();e.stopPropagation();this._gridPane._objBag.focusMgr.Focus()}}e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==r.JsGridConstants.Key.space&&this._gridPane.ExpandColumnMenu(this._gridPane.focusedColHeaderIndex-1)};e.prototype.OnColumnHeaderMouseMoveForColumnResize=function(e){try{var t,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane._parentNode).x,s=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),o=Math.max(n,s.x);this._resizeDeltaOnMouseMove=(o-this.mouseDownX)*(this._gridPane._objBag.RTL.bEnabled?-1:1);t="Title"===this._gridPane.tableMgr.columns[this.resizingColIdx].columnKey?Math.max(this.origWidth+this._resizeDeltaOnMouseMove,200):Math.max(this.origWidth+this._resizeDeltaOnMouseMove,r.JsGridConstants.Internal.MinColumnWidth);var u=this._gridPane.tableMgr.GetColumnHeader(this.resizingColIdx).GetTd();this._gridPane.paneConverter.GetColumnByKey(u.thColumnKey).width=t;this._gridPane.headerMgr.ResizeColumn(u,t);this._gridPane.itemSizes[this.resizingColIdx]=t;this._gridPane.tableMgr.columns[this.resizingColIdx].width=t;u.style.width=t+"px";this._gridPane.tableMgr.ResizeColCoordCache(u.cellIndex,t);this._gridPane.UpdatePositionedElements();this._gridPane._editMgr.NotifyMove(this._gridPane)}catch(e){if(this._qos){this._qos.end({resultType:m.ResultTypeEnum.Failure,resultCode:"FailToMoveElementForColumnResize",error:e.message});this._qos=void 0}}};e.prototype.OnColumnHeaderMouseUpForColumnResize=function(e){var t=this;try{if(null!=this.resizingColIdx){var i=this._gridPane.tableMgr.GetColumnHeader(this.resizingColIdx).GetTd();this._gridPane.headerMgr.SetColumnResized(i.thColumnKey);this._gridPane.tableMgr.OptimizeTableColumns();this._gridPane.horizScrollBar.Update({itemSizes:this._gridPane.itemSizes});if(this._gridPane._objBag.setColumnWidthsToLocalStorage){var s=this._gridPane.GetAllColumns().GetColumnByKey(i.thColumnKey);this._gridPane._objBag.setColumnWidthsToLocalStorage(s.name,s.width-r.JsGridConstants.Internal.ColumnWidthOffset)}var o=this._gridPane._objBag.jsGridParams,u=o.telemetry,a=o.baseEngagementData;u&&a&&u(d.Engagement).logData(n.__assign(n.__assign({},a),{component:"SPGrid",name:"ColumnResize",isIntentional:!0}));if(this._qos){this._qos.end({resultType:m.ResultTypeEnum.Success});this._qos=void 0}this.resizingColIdx=null;if(!T&&!this._resizeDeltaOnMouseMove)return;if(!x){this._lastResize=Date.now();window.setTimeout(function(){if(Date.now()-t._lastResize>450){t._gridPane.UpdateColumns(t._gridPane.allColumns);t._gridPane.jsGridObj.EnsurePaneWidth();t._gridPane.jsGridObj.NotifyDataAvailable()}},500)}}}catch(e){if(this._qos){this._qos.end({resultType:m.ResultTypeEnum.Failure,resultCode:"FailToDropElementForColumnResize",error:e.message});this._qos=void 0}}};e.prototype.AutoResizeActiveColumn=function(){if(null!=this._gridPane.activeColIdx&&this._gridPane.activeColIdx!==this._gridPane.lockedColIdx){var e=this._gridPane.paneConverter.GetColumnByIdx(this._gridPane.activeColIdx);if(e.isResizable){this._gridPane.headerMgr.SetColumnResizing(e.columnKey);var t=this._gridPane.tableMgr.GetColumnHeader(this._gridPane.activeColIdx).GetTd(),n=Math.max(this._gridPane.headerMgr.GetColumnHeaderAutoResizeWidth(t),this._gridPane.tableMgr.GetColumnAutoResizeWidth(this._gridPane.activeColIdx));if(n!==e.width){e.width=n;this._gridPane.headerMgr.ResizeColumn(t,n);this._gridPane.itemSizes[this._gridPane.activeColIdx]=n;this._gridPane.UpdatePositionedElements();this._gridPane._editMgr.NotifyMove(this._gridPane);this._gridPane.tableMgr.OptimizeTableColumns();this._gridPane.horizScrollBar.Update({itemSizes:this._gridPane.itemSizes})}this._gridPane.headerMgr.SetColumnResized(t.thColumnKey)}}};e.prototype.OnCellsMouseMoveForCopy=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=t.x-this.mouseDownX,r=t.y-this.mouseDownY;this._gridPane.ghostCells.style.top=this.origGhostY+r+"px";this._gridPane.ghostCells.style.left=this.origGhostX+n+"px"};e.prototype.OnColumnHeaderMouseUpForColumnMove=function(e){this._gridPane.ghostHeader.style.visibility=this._gridPane.columnDropIndic.style.visibility="hidden";var t=this._gridPane.tableMgr.GetColumnHeader(this.movingColIdx).GetTd().thColumnKey;this._gridPane.headerMgr.SetColumnMoved(t);if(this.startMovingColIdx!==this.movingColIdx){var n=this.startMovingColIdx<this.movingColIdx?this.movingColIdx+1:this.movingColIdx;this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.ReorderColumnPositionInView,t,n)}this.movingColIdx=this.startMovingColIdx=null};e.prototype.OnCellsMouseUpForCopy=function(e){this._gridPane._cutcopypasteMgr.OnCopy(this._gridPane);this.hitTest=this.RowHitTest(e);this._gridPane._selectionMgr.SetFocusByPos(this._gridPane,this.hitTest.row,this.hitTest.col);this._gridPane._cutcopypasteMgr.OnPaste(this._gridPane);if(null!=this._gridPane.ghostCells){this._gridPane.ghostCells.parentNode.removeChild(this._gridPane.ghostCells);this._gridPane.ghostCells=null}this._gridPane.UpdatePositionedElements()};e.prototype.OnColumnHeaderMouseMove=function(e){if(null==this.resizingColIdx&&null==this.movingColIdx){var t=this.HeaderHitTest(e,!0);if(null!=t.colIdx){var n=this._gridPane.tableMgr.GetColumnHeader(t.colIdx).GetColumn().columnKey;if(this._gridPane.headerMgr.ColumnCurrentlyEditing(n))return}null!=t.colIdx&&t.bInVertical&&null==this._gridPane.lockedColIdx&&this._gridPane.headerMgr.HeaderMouseMove(e)}};e.prototype.OnColumnHeaderMouseOut=function(e){var t=this.HeaderHitTest(e,!0);if(null!=t.colIdx){var n=this._gridPane.tableMgr.GetColumnHeader(t.colIdx).GetColumn().columnKey;if(this._gridPane.headerMgr.ColumnCurrentlyEditing(n)||t.bInVertical&&t.colIdx==this._gridPane.activeColIdx)return}this._gridPane.headerMgr.HeaderMouseOut(e)};e.prototype.RowHitTest=function(e){for(var t,n,r,s,o=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane._parentNode),u=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),a=u.x,f=u.y,l=t=0,c=n=0,h=this._gridPane.tableMgr.GetRowHeaders(),p=0;p<h.length;p++){var d=h[p].GetTd(),v=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(d);if(d.offsetHeight+v.y>f){t=p;n=v.y-o.y;break}}var m=this._gridPane.tableMgr.GetColumnHeaders();for(p=0;p<m.length;p++){r=m[p].GetTd();if((s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r)).x+r.offsetWidth>a){l=p;c=s.x-o.x;break}}return{row:t,col:l,x:c,y:n}};e.prototype.HeaderHitTest=function(e,t){var n,r,s,o,u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv),a=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),f=a.x,l=a.y,c=this._gridPane.tableMgr.GetColumnHeaders(),h=c.length>0&&l>=u.y+c[0].GetTd().offsetTop&&l<=u.y+c[0].GetTd().offsetHeight,p=h&&l-u.y<this._gridPane.headerMgr.constEyeBrowHeight?0:(this._gridPane.headerMgr.constResizeWidth+2)*(this._gridPane._objBag.RTL.bEnabled?-1:1);if(!t||h&&i.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(f,l,this._gridPane._parentNode,null)){for(var d=0;d<c.length;d++){r=c[d].GetTd();if(f>=(s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r)).x+(0!==d?p:0)&&f<s.x+r.offsetWidth+(d!==c.length?p:0)){n=c[d].GetColIdx();break}}var v=0;if(null!=r){var m=f-s.x;v=s.x+r.offsetWidth-f<m?this._gridPane._objBag.RTL.bEnabled?0:1:this._gridPane._objBag.RTL.bEnabled?1:0}var g=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(c[0].GetTd());o=null!=n?n+v:(this._gridPane._objBag.RTL.bEnabled?f>g.x+r.offsetWidth:f<g.x)?this._gridPane.tableMgr.BeginColIdx():this._gridPane.tableMgr.EndColIdx()}return{colIdx:n,insertColIdx:o,bInVertical:h}};return e})()});
define("LGe",["require","exports","o","r","cGe","eGe","bGe","me","gl","zc","MGe","ce","Qze","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d=p.tablemgr_9;p=p.headermgr_6;Object.defineProperty(t,"__esModule",{value:!0});var v={ODB:1725},m={ODB:988},g=s.JsGridConstants.Internal.ColumnHeaderHeight,y=c.Killswitch.isActivated("9340DEC3-CF41-4D00-BDD8-2AA84E33D2C2","2/05/2020","Make headers accessible with keyboard only."),b=c.Killswitch.isActivated("D132AFD6-52B6-4C09-98A9-18CE1F461F78","4/13/2020","Making sure not to hide the resize bar to early on mouse move."),w=(function(){function e(e,t,s,o){var u=this;this.ElementState={Normal:1,Hover:2,Clicked:3};this._headerChildObjects={};this._columnInfoMap={};this._partsEnabled={};this._initalColorMap={};this._styles={};this._lockedElements={};this._sortStates={};this._filterStates={};this._activeColumn=null;this._dropDownMenuVisible=!1;this._currentEditColumnKey=null;this.constMenuWidth=15;this.constEyeBrowHeight=5;this.constResizeWidth=5;this.RenderDetailsColumn=function(e){var t,s=u._columnInfoMap[e],o=u._headerChildObjects[e],c=null===(t=o)||void 0===t?void 0:t.th,h=o?o.coreContent:null,p=o?o.dropHint:null;if(s&&h){var d=s.column,m=s.columnIndex,g=d.isSortable?u._sortStates[e]:void 0,y=!!g,b=-1===g,w=u._filterStates.hasOwnProperty(e);n.render(r.createElement(a.DetailsColumn,{column:{name:d.name,key:d.columnKey,columnActionsMode:f.ColumnActionsMode.hasDropdown,minWidth:d.width,isSorted:y,isSortedDescending:b,isFiltered:w,isIconOnly:d.isIconOnly,iconName:d.iconName,headerClassName:"QuickEditHeaderColumn"},columnIndex:m+1,styles:{root:[{padding:0,lineHeight:32,width:"100%",overflow:d.isIconOnly?"hidden":void 0},i.JsGridUtil.Internal.IsFeatureEnabled(v)&&{display:"flex",alignItems:"center"}],cellTooltip:[{position:"relative"},i.JsGridUtil.Internal.IsFeatureEnabled(v)&&{minWidth:0}],cellTitle:{paddingLeft:d.isFooter?4:12,paddingRight:8}},isDraggable:!d.isFooter,updateDragInfo:u._dragDropMgr._updateDragInfo,dragDropHelper:u._dragDropMgr.getDragDropHelper(),isDropped:u._dragDropMgr._onDropIndexInfo?u._dragDropMgr._onDropIndexInfo.targetIndex===m:null}),h,function(){var t,n,r,s,o;if(!i.JsGridUtil._headerScreenreaderKillSwitchIsActive){var a=null===(t=h)||void 0===t?void 0:t.querySelector(".QuickEditHeaderColumn");if(a){a.removeAttribute("role");a.removeAttribute("aria-colindex");a.removeAttribute("aria-sort")}var f=y?b?"descending":"ascending":"none";null===(n=c)||void 0===n||n.setAttribute("aria-sort",f)}if(!i.JsGridUtil._columnHeaderErrorIndicatorKillSwitchIsActive){var p=(null===(s=null===(r=u._focusMgr)||void 0===r?void 0:r._gridPane)||void 0===s?void 0:s.tableMgr).fieldsWithErrors[e];if(p){var d=null===(o=c)||void 0===o?void 0:o.querySelector("."+l.FIELD_TITLE_SPAN_CLASSNAME);d.parentNode.contains(p)||d.parentNode.insertBefore(p,d.nextSibling)}}});p&&u._dragDropMgr.renderDropHint&&n.render(u._dragDropMgr.renderDropHint(m+1),p)}};this.GetLargestColumnIdx=function(){for(var e=0,t=Object.keys(u._columnInfoMap),n=0;n<t.length;n++)u._columnInfoMap.hasOwnProperty(t[n])&&u._columnInfoMap[t[n]].columnIndex>e&&(e=u._columnInfoMap[t[n]].columnIndex);return e};this.constCoreContentPadding=0;this.borderMap={menu:e.RTL.Left,resize:e.RTL.Right,eyeBrow:"Bottom"};this._objBag=e;this._styleMgr=t;this._fnGetLocStr=s;this._fnUpdatePositionedElements=o;this._dragDropMgr=this._objBag.dragDropMgr;this._focusMgr=this._objBag.focusMgr;this.CreateCoreContentMeasuringElement()}e.prototype.CreateCoreContentMeasuringElement=function(){var e=this._styleMgr.columnHeaderStyleCollection.normal,t=null!=e.font?"font-family:"+e.font+";":"";this._coreContentBaseCssText=u.format("text-align:{0};padding-{0}:{1}px;{2}font-size:{3};font-weight:{4};",this._objBag.RTL.left,this.constCoreContentPadding,t,e.fontSize,e.fontWeight);var n=document.createElement("table");n.style.cssText="position:absolute;visibility:hidden;top:0px;left:0px;width:0px;height:0px;";n.insertRow(-1);var r=document.createElement("th");n.rows[0].appendChild(r);this._coreContentWidthMeasuringElement=document.createElement("div");this._coreContentWidthMeasuringElement.className=i.JsGridUtil.Internal.IsFeatureEnabled(v)?p.spGridHeaderCoreContent:"jsgrid-header-core-content";this._coreContentWidthMeasuringElement.style.cssText=this._coreContentBaseCssText;r.appendChild(this._coreContentWidthMeasuringElement);this._objBag.parentNode.appendChild(n)};e.prototype.CalculateChildObjects=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetChildrenWithCustomAttribute(e,"colid");t.th=e;return t};e.prototype.CreateTableHeaderCell=function(e,t,n,r,o,u,a,f,l,c){var h=this,b=i.JsGridUtil.Internal.IsFeatureEnabled(v),w=r&&!e.bOpenMenuOnContentClick&&!e.isFooter,E=w?"move":"default",S=o&&e.isResizable,x=e.bOpenMenuOnContentClick,T=(null!=e.imgSrc||!!e.iconName)&&x;this._columnInfoMap[e.columnKey]={column:e,columnIndex:c};var N,C,k,L,A,O=[];if(i.JsGridUtil.Internal.IsFeatureEnabled(v)){N=g;C="position:absolute;right:1px";k='class="'+p.resizeContainer+'" ';L="";A="height:"+g+"px"}else{N=32;C="float:"+this._objBag.RTL.right+";position:relative";L='<div style="width:1px;height:100%;left:9px;position:relative;background-color:#c8c8c8;"></div>';k="";A="left:1px;top:7px"}O.push('<div colid="resizeRight" ');O.push(k);O.push((S?'colAction="resize-current"':"")+'style="'+C);O.push(";cursor:"+(S?"w-resize":"default"));O.push(S?";width:16px;height:"+N+"px;margin-left:-8px;margin-right:-8px":"");O.push(';z-index:1;opacity:0">');O.push((S?L:"")+"</div>");if(!e.isFooter){O.push('<div colid="dropHint" ');O.push('style="float:');O.push(this._objBag.RTL.right);O.push(";z-index:1;position:relative;"+A+'">');O.push("</div>")}O.push('<div colid="move" '+(w?'colAction="move"':"")+' style="white-space:nowrap;overflow:auto;" class="ms-positionRelative">');O.push('<div colid="resize" ');O.push('style="float:');O.push(this._objBag.RTL.left+";");O.push("position:absolute;");O.push('"></div>');O.push('<div colid="content" ');O.push('style="cursor:'+E+';"><div colid="coreContent" coltype="text" ');O.push('style="'+this._coreContentBaseCssText+"cursor:"+E+';" unselectable="true">');O.push("</div>");O.push("</div></div>");O.push("</div>");t.innerHTML=O.join("");var M=e.columnKey,_=this._headerChildObjects[M]=this.CalculateChildObjects(t);this._partsEnabled[M]={selection:a,move:w,resize:S};if(null!=f){t.addEventListener("click",function(e){var t=i.JsGridUtil.Internal.GetEventSrcElement(e);if(null!=t&&null==t.getAttribute("colAction")){var n=t.getAttribute("colid");"resize"!=n&&"resizeRight"!=n&&f(e,M)}});if(!y){t.addEventListener("keydown",function(e){if(null===document.getElementById(M+"_"+h._focusMgr._gridPane.Id+"_focusElement")){var t=h._focusMgr._gridPane;e.keyCode!==s.JsGridConstants.Key.enter&&e.keyCode!==s.JsGridConstants.Key.space||f(e,M);if(e.keyCode===s.JsGridConstants.Key.right||b&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&e.keyCode===s.JsGridConstants.Key.tab&&!e.shiftKey){var n=h.GetLargestColumnIdx();if(c<n)h._focusMgr._gridPane.SetFocusToHeader(c+2);else if(e.keyCode===s.JsGridConstants.Key.tab){var r=h._focusMgr._selectionMgr,o=h._focusMgr._gridPane;r.SetFocusByPos(o,0,-1);h._focusMgr.Focus()}e.preventDefault();e.stopPropagation()}if(e.keyCode===s.JsGridConstants.Key.left||b&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&e.keyCode===s.JsGridConstants.Key.tab&&e.shiftKey){var u=b&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?0:1;if(c>=u){h._focusMgr._gridPane.SetFocusToHeader(c);e.preventDefault();e.stopPropagation()}}if(e.keyCode===s.JsGridConstants.Key.down){b&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?(function(){var e;if(h.GetLargestColumnIdx()!==c||!i.JsGridUtil._lastColumnVisibilityKillSwitchIsActive&&(!h._objBag.showAddColumnMenu||!h._objBag.canUserAddColumn)){var n=h._focusMgr._selectionMgr,r=null===(e=t.GetCellByIdx(0,0))||void 0===e?void 0:e.GetTr();r&&r.classList.add(d.rowHasOnlyOneCellSelected);n.SetFocusByPos(t,0,c);h._focusMgr.Focus();return!0}})():h._focusMgr.Focus()}if(i.JsGridUtil.Internal.IsFeatureEnabled(m)&&e.keyCode===s.JsGridConstants.Key.esc){t.HideFocusStyles();t.ScrollCellIntoView(0,0);h._focusMgr._gridFocusEntryPoint.focus()}}})}}if(T){_.menuImg&&(_.menuImg.style.display="none");_.menu&&(_.menu.style.visibility="hidden")}if("DocIcon"===e.columnKey){e.iconName="page";e.isIconOnly=!0}this.RenderDetailsColumn(e.columnKey);null!=e.name&&(t.title=e.name);this._fnGetHeaderSibling=l;i.JsGridUtil.DebugAssert(null!=e.width&&e.width>=e.isIconOnly?s.JsGridConstants.Internal.IconColumnWidth:s.JsGridConstants.Internal.MinColumnWidth,"Column width should have been adjusted via headerMgr.AdjustColumnWidth(column)!");t.thColumnKey=M;t.nowrap="nowrap";null!=this._activeColumn&&this._activeColumn.thColumnKey==M&&(this._activeColumn=null);if(i.JsGridUtil.Internal.IsStickyColumnEnabled())if(c<=i.JsGridUtil.Internal.stickyLastColIdx){t.classList.add(d.gridStickyDataColumn);t.classList.add(d.gridStickyDataColumnHeader);i.JsGridUtil.Internal.stickyChromeless?t.classList.add(d.gridStickyDataLeftChromeless):t.classList.add(d.gridStickyDataLeft);e.isSticky=!0;if(c>0){var D=i.JsGridUtil.Internal.stickyLeftEdgeOffset+i.JsGridUtil.Internal.stickyCheckColumnSize+this._objBag.paneMgr.gridPane.allColumns.GetColumnArray()[0].width;this._objBag.RTL.bEnabled?t.style.right=D+"px":t.style.left=D+"px"}}else e.isSticky=!1;return t=_=null};e.prototype.UpdateHeader=function(e,t){var n=this._headerChildObjects[e.thColumnKey].resize;if(null!=t&&this._partsEnabled[t.thColumnKey].resize){n.colAction="resize";n.style.cursor="w-resize"}else if(this._partsEnabled[e.thColumnKey].move){n.colAction="move";n.style.cursor="move"}else{n.colAction=null;n.style.cursor="default"}};e.prototype.NotifyColumnHeaderOrderSet=function(e){for(var t=e,n=null;null!=t;){this.UpdateHeader(t,n);n=t;t=this._fnGetHeaderSibling(t,!1)}};e.prototype.DisposeHeader=function(e){null!=this._curHighlightedElem&&this._curHighlightedElem.columnKey==e.thColumnKey&&(this._curHighlightedElem=null);null!=this._curActingColumnInfo&&this._curActingColumnInfo.key==e.thColumnKey&&(this._curActingColumnInfo=null);var t=this._headerChildObjects[e.thColumnKey]&&this._headerChildObjects[e.thColumnKey].menu;null!=t&&i.JsGridUtil.ClearEventListeners(t);delete this._headerChildObjects[e.thColumnKey];delete this._styles[e.thColumnKey];delete this._initalColorMap[e.thColumnKey];delete this._partsEnabled[e.thColumnKey];delete this._lockedElements[e.thColumnKey];e.thColumnKey=null};e.prototype.Dispose=function(){var e=[];for(var t in this._headerChildObjects)e.push(this._headerChildObjects[t].th);for(var n=e.length-1;n>=0;n--){delete this._sortStates[e[n].thColumnKey];this.DisposeHeader(e[n])}this._activeColumn=this._headerChildObjects=this._curActingColumnInfo=this._curHighlightedElem=this._lockedElements=this._partsEnabled=this._sortStates=null};e.prototype.ApplyHeaderStyle=function(e,t,n){var r=this._headerChildObjects[e.thColumnKey],s=i.JsGridUtil.Internal.IsFeatureEnabled(v);if(null==this._curActingColumnInfo||this._curActingColumnInfo.key!=e.thColumnKey){if(e.headerStyleType!==t.type){this._initalColorMap[e.thColumnKey]={};s?e.className+=" "+p.gridHeaderCell:e.style["border"+this._objBag.RTL.Right]=o.StyleUtil.MakeBorderString(1,"solid ",t.innerBorderColor);if(null!=r){null!=t.font&&(r.coreContent.style.fontFamily=t.font);r.coreContent.style.fontSize=t.fontSize;r.coreContent.style.fontWeight=t.fontWeight;r.coreContent.style.color=t.textColor;null!=r.sortA&&null!=r.sortA.style&&(r.sortA.style.color=t.textColor);e.style.backgroundColor=r.resize.style.backgroundColor=t.backgroundColor;r.resize.style["border"+this._objBag.RTL.Right]=o.StyleUtil.MakeBorderString(1,"solid ",t.backgroundColor)}if(null!=r&&null!=r.eyeBrow){this._initalColorMap[e.thColumnKey].eyeBrow={};this._initalColorMap[e.thColumnKey].eyeBrow.bg=r.eyeBrow.style.backgroundColor=t.eyeBrowColor;this._initalColorMap[e.thColumnKey].eyeBrow.border=r.eyeBrow.style["border"+this.borderMap.eyeBrow+"Color"]=t.eyeBrowBorderColor}else{delete this._initalColorMap[e.thColumnKey].eyeBrow;null!=t.innerBorderColor&&(e.style.borderTop=o.StyleUtil.MakeBorderString(1,"solid ",t.innerBorderColor))}s||(e.style.borderBottom=o.StyleUtil.MakeBorderString(1,"solid ",t.outerBorderColor));this._initalColorMap[e.thColumnKey].move=e.style.backgroundColor=t.backgroundColor;if(null!=r&&null!=r.menu){this._initalColorMap[e.thColumnKey].menu={};this._initalColorMap[e.thColumnKey].menu.bg=r.menu.style.backgroundColor=t.menuColor;null!=t.menuBorderColor&&(this._initalColorMap[e.thColumnKey].menu.border=r.menu.style.borderColor=t.menuBorderColor)}else delete this._initalColorMap[e.thColumnKey].menu;null!=r&&(r.resizeRight.style.backgroundColor=null!=r.menu&&"inline-block"==r.menu.style.display?t.menuColor:t.backgroundColor);this._styles[e.thColumnKey]=t}e.headerStyleType=t.type;e.headerStyleBorderString=o.StyleUtil.MakeBorderString(1,"solid",t.outerBorderColor);e.headerStyleInnerBorderString=o.StyleUtil.MakeBorderString(1,"solid",t.innerBorderColor);var u=this._fnGetHeaderSibling(e,!0);null==u||s||(null!=t.innerBorderColor?u.style["border"+this._objBag.RTL.Right]=l(u,e).headerStyleInnerBorderString:u.style["border"+this._objBag.RTL.Right]=l(u,e).headerStyleBorderString);if(null!=this._partsEnabled[e.thColumnKey]&&null!=this._partsEnabled[e.thColumnKey].resize){var a=this._fnGetHeaderSibling(e,!1);if(null!=a&&null!=this._headerChildObjects[a.thColumnKey]&&null!=this._initalColorMap[a.thColumnKey]){s||(null!=t.innerBorderColor?e.style["border"+this._objBag.RTL.Right]=l(a,e).headerStyleInnerBorderString:e.style["border"+this._objBag.RTL.Right]=l(a,e).headerStyleBorderString);var f=this._headerChildObjects[a.thColumnKey].resize;if(n){this._initalColorMap[a.thColumnKey].resize={};this._initalColorMap[a.thColumnKey].resize.bg=f.style.backgroundColor=this._styles[a.thColumnKey].resizeColor;this._initalColorMap[a.thColumnKey].resize.border=f.style["border"+this.borderMap.resize+"Color"]=this._styles[a.thColumnKey].resizeBorderColor}else{this._initalColorMap[a.thColumnKey].resize={};this._initalColorMap[a.thColumnKey].resize=f.style.backgroundColor=f.style["border"+this.borderMap.resize+"Color"]=this._styles[a.thColumnKey].backgroundColor}}}}else this._curActingColumnInfo.curStyle=t;function l(e,t){i.JsGridUtil.DebugAssert(null!=e.headerStyleType||null!=t.headerStyleType);return null==e.headerStyleType?t:null==t.headerStyleType||e.headerStyleType>t.headerStyleType?e:t}};e.prototype.ApplyHeaderClassnames=function(e){for(var t=this._objBag.paneMgr.GetGridPane(),n=this._objBag.selectionMgr,r=e.GetColIdx(),i=n.GetRowRanges(t),s=!1,o=0;o<i.length;o++)i[o].Contains(0)&&(s=!0);if(0===i.length||s){for(var u=n.GetCellRanges(t),a=0;a<u.length;a++)if(u[a].colRange.Contains(r)&&!u[a].rowRange.Contains(0)){e.GetTd().classList.add(p.columnIsActive);return}e.GetTd().classList.remove(p.columnIsActive)}else e.GetTd().classList.add(p.columnIsActive)};e.prototype.GetColumnHeaderAutoResizeWidth=function(e){var t=this._headerChildObjects[e.thColumnKey];return null!=t.coreContent?e.offsetWidth+Math.max(t.coreContent.scrollWidth-t.coreContent.offsetWidth,0):e.offsetWidth};e.prototype.AdjustColumnWidth=function(e){if(null==e.width||e.width<=0){e.width=s.JsGridConstants.Internal.MinColumnWidth;if(null!=e.name){i.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._coreContentWidthMeasuringElement,e.name);var t=this._dropDownMenuVisible?this.constMenuWidth+10:0;e.width=this._coreContentWidthMeasuringElement.scrollWidth+this.constResizeWidth+this.constResizeWidth+t}}"JSGrid_NewColumn"===e.columnKey?e.width=Math.max(e.width,s.JsGridConstants.Internal.IconColumnWidth):i.JsGridUtil.Internal.IsFeatureEnabled(v)&&"DocIcon"===e.columnKey?e.width=Math.max(e.width,s.JsGridConstants.Internal.IconColumnNewWidth):e.width=Math.max(e.width,s.JsGridConstants.Internal.MinColumnWidth)};e.prototype.ResizeColumn=function(e,t){this._objBag.bUpdateCoordCache=!0};e.prototype.ShowMenuOnColumn=function(e){if(this._activeColumn!==e&&null!=e.thColumnKey){null!=this._headerChildObjects[e.thColumnKey].menu&&(this._activeColumn=e)}};e.prototype.GetChildObjects=function(e){return this._headerChildObjects[e]};e.prototype.GetColumnHeaderElement=function(e){var t=this._headerChildObjects[e];return null!=t?t.th:null};e.prototype.GetColumnHeaderPosition=function(e){var t=this._headerChildObjects[e],n=null;null!=t&&(n=t.th);if(null==n)return null;var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(n);return{left:r.x,width:n.offsetWidth,top:r.y+(this._objBag.RTL.bEnabled?4:0),height:n.offsetHeight}};e.prototype.GetColumnMenuElementPosition=function(e){var t=this._headerChildObjects[e].menu;if(null==t)return null;var n=this._headerChildObjects[e].resizeRight,r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(t),s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(n);return{left:Math.min(r.x,s.x),width:t.offsetWidth+n.offsetWidth,top:r.y+(this._objBag.RTL.bEnabled?4:0),height:t.offsetHeight}};e.prototype.OnSort=function(e,t){i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);e.preventDefault();this._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.Sort,[{columnName:t,isDescending:1==this._sortStates[t]}])};e.prototype.RenameColumn=function(e,t){var n,r=this,o=i.JsGridUtil.Internal.IsFeatureEnabled(v),u=null,a=function(e){null==u&&(u=setTimeout(function(){f(e)},50))},f=function(o){var u=h.TrimSpaces(n.value);r.SetColumnEdited(e);n.removeEventListener("blur",a);n.removeEventListener("keydown",l);if(u.length<1){alert(r._fnGetLocStr("RenameColumn_BlankColumnName"));u=N}T.name=u;r._columnInfoMap[T.columnKey].column.name=u;r.RenderDetailsColumn(T.columnKey);E.title=u;E.style.width=S;E.style.minWidth=x;y.className=b;n.parentNode.replaceChild(w,n);if(u!==N){T.width=null;r.AdjustColumnWidth(T);r.ResizeColumn(E,T.width)}r._objBag.bUpdateCoordCache=!0;i.JsGridUtil.DebugAssert(null!=r._fnUpdatePositionedElements);null!=r._fnUpdatePositionedElements&&r._fnUpdatePositionedElements();r._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnEndRenameColumn,i.JsGridUtil.EventArgs.OnEndRenameColumn(e,N,u));t&&t();E.focus()},l=function(e){e&&e.keyCode==s.JsGridConstants.Key.esc&&(n.value=N);!e||e.keyCode!=s.JsGridConstants.Key.tab&&e.keyCode!=s.JsGridConstants.Key.enter||n.blur()},c=function(e){null!=u&&clearTimeout(u);e.stopPropagation()};this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginRenameColumn);this._objBag.selectionMgr.Clear(!1);var d=this._objBag.paneMgr.GetGridPane(),m=d.GetGridPaneConverter(),g=this._headerChildObjects[e],y=g.content,b=y.className,w=g.coreContent,E=(function(e){for(;e&&"TH"!==e.tagName;)e=e.parentNode;return e})(w),S=E.style.width,x=E.style.minWidth,T=m.GetColumnByKey(e),N=T.name;this.SetColumnEditing(e);(function(){(n=document.createElement("input")).id=e+"_"+d.Id+"_focusElement";n.className="jsgrid-control-header-editbox";n.value=N;n.style.width=E.clientWidth-(o?24:20)+"px";n.setAttribute("type","text");n.setAttribute("colAction","rename");n.addEventListener("blur",a.bind(r));n.addEventListener("keydown",l.bind(r));n.addEventListener("mousedown",c.bind(r));n.addEventListener("mouseup",c.bind(r));n.addEventListener("click",c.bind(r));var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(E,"width","width");E.style.width=t;E.style.minWidth=t;y.className=o?p.renameInputContainer:"ms-spGrid-HeaderContentStyle-Rename";w.parentNode.replaceChild(n,w);n.focus()})();n.select()};e.prototype.ColumnIsPresent=function(e){return e in this._headerChildObjects};e.prototype.UpdateColorFromEventInfo=function(e,t){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=n&&this.ColumnIsPresent(n.elem.thColumnKey)){var r=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=r&&this.UpdateColor(n.elem.thColumnKey,r.elem,t))return r.elem}return null};e.prototype.UpdateColor=function(e,t,n){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t,"colid");if("move"==i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t,"colAction"))return!1;if("resizeRight"==r){var s=this._fnGetHeaderSibling(this._headerChildObjects[e].th,!1);if(null!=s){r="resize";e=s.thColumnKey}else r="menu"}null==r||!(e in this._initalColorMap)||!(r in this._initalColorMap[e])||e in this._lockedElements&&r in this._lockedElements[e]||("eyeBrow"!==r||this._partsEnabled[e].selection)&&(n==this.ElementState.Normal?this.ApplyColorToElem(e,r,this._initalColorMap[e][r].bg,this._initalColorMap[e][r].border):n==this.ElementState.Hover?this.ApplyColorToElem(e,r,this._styles[e][r+"HoverColor"],this._styles[e][r+"HoverBorderColor"]):n==this.ElementState.Clicked&&this.ApplyColorToElem(e,r,this._styles[e].elementClickColor,this._styles[e].elementClickBorderColor));return!0};e.prototype.ApplyColorToElem=function(e,t,n,r){if(null!=n){this._headerChildObjects[e][t].style.backgroundColor=n;"menu"==t&&(this._headerChildObjects[e].resizeRight.style.backgroundColor=n)}null!=r&&(this._headerChildObjects[e][t].style["border"+this.borderMap[t]+"Color"]=r)};e.prototype.ClearSort=function(e){delete this._sortStates[e];this.RenderDetailsColumn(e)};e.prototype.SetColumnSortState=function(e,t){delete this._sortStates[e];if(1==t||-1==t){this._sortStates[e]=t;null!=this._headerChildObjects[e]&&this.RenderDetailsColumn(e)}else this.ClearSort(e)};e.prototype.ClearColumnFiltered=function(e){delete this._filterStates[e];this.RenderDetailsColumn(e)};e.prototype.SetColumnFiltered=function(e){this._filterStates[e]=null;this.RenderDetailsColumn(e)};e.prototype.SetSortState=function(e){for(var t in this._sortStates)this.ClearSort(t);if(null!=e)for(var n=0;n<e.length;n++)this.SetColumnSortState(e[n].fieldKey,e[n].isDescending?-1:1)};e.prototype.SetFilterState=function(e){for(var t in this._filterStates)this.ClearColumnFiltered(t);if(null!=e)for(var n=0;n<e.length;n++)this.SetColumnFiltered(e[n])};e.prototype.HeaderMouseDown=function(e){this.UpdateColorFromEventInfo(e,this.ElementState.Clicked)};e.prototype.HeaderMouseUp=function(e){this.UpdateColorFromEventInfo(e,this.ElementState.Normal)};e.prototype.HeaderMouseMove=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=t&&this.ColumnIsPresent(t.elem.thColumnKey)){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=n&&null!=n.elem){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(n.elem,"colid");"resizeRight"===r&&(this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=1)}}};e.prototype.HeaderMouseOut=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=t&&this.ColumnIsPresent(t.elem.thColumnKey)){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=n&&null!=n.elem){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(n.elem,"colid");"resizeRight"===r&&(b?this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=0:this._columnIsResizing||(this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=0))}}};e.prototype.InColumnHeaderEditMode=function(){return null!=this._currentEditColumnKey};e.prototype.ColumnCurrentlyEditing=function(e){return this._currentEditColumnKey==e};e.prototype.SetColumnSelected=function(e){this.LockItem(e,"eyebrow")};e.prototype.SetColumnUnselected=function(e){this.UnlockItem(e,"eyebrow")};e.prototype.SetColumnMenuExpanded=function(e){};e.prototype.SetColumnMenuCollapsed=function(e){};e.prototype.SetColumnMoving=function(e){this.LockItem(e,"move",!0)};e.prototype.SetColumnMoved=function(e){this.UnlockItem(e,"move",!0)};e.prototype.SetColumnResizing=function(e){this._columnIsResizing=!0;this.LockItem(e,"resize",!0)};e.prototype.SetColumnEdited=function(e){this._currentEditColumnKey=null;this.UnlockItem(e,"coreContent",!0)};e.prototype.SetColumnEditing=function(e){this._currentEditColumnKey=e;this.LockItem(e,"coreContent",!0)};e.prototype.SetColumnResized=function(e){this._columnIsResizing=!1;this.UnlockItem(e,"resize",!0)};e.prototype.LockColumn=function(e){null!=this._curActingColumnInfo&&i.JsGridUtil.DebugAssert(!1);this._curActingColumnInfo={};this._curActingColumnInfo.key=e};e.prototype.UnLockColumn=function(){if(null!=this._curActingColumnInfo){var e=this._curActingColumnInfo;this._curActingColumnInfo=null;null!=e.curStyle&&this.ApplyHeaderStyle(this._headerChildObjects[e.key].th,e.curStyle)}};e.prototype.LockItem=function(e,t,n){this.UpdateColor(e,this._headerChildObjects[e][t],this.ElementState.Clicked);null==this._lockedElements[e]&&(this._lockedElements[e]={});this._lockedElements[e][t]="";n&&this.LockColumn(e)};e.prototype.UnlockItem=function(e,t,n){i.JsGridUtil.DebugAssert(e in this._lockedElements&&t in this._lockedElements[e]);if(e in this._lockedElements&&t in this._lockedElements[e]){delete this._lockedElements[e][t];i.JsGridUtil.Internal.IsAssocArrayEmpty(this._lockedElements[e])&&delete this._lockedElements[e];null!=this._curActingColumnInfo&&this._curActingColumnInfo.key==e&&this.UnLockColumn();this.ColumnIsPresent(e)&&this.UpdateColor(e,this._headerChildObjects[e][t],this._headerChildObjects[e][t]==this._curHighlightedElem?this.ElementState.Hover:this.ElementState.Normal)}};return e})();t.HeaderManager=w});
define("EGe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._touchableActions=t||{};this.Init()}e.prototype.Init=function(){};e.prototype.RegisterTouchableAction=function(e,t){this._touchableActions[e]=t};e.prototype.UnregisterTouchableAction=function(e){delete this._touchableActions[e]};e.prototype.Dispose=function(){null!=this._touchManager&&this._touchManager.Dispose()};return e})();t.GridTouchManager=n});
define("CGe",["require","exports","cGe","eGe","oGe","SGe","yGe","me"],function(require,exports,gridutil_1,constants_1,property_1,jsgridobj_1,tablecache_1,StringHelper){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var QuickEditVisualRefreshFlight={ODB:1725};function AdjustPrintPreviewGridDivWidth(e,t,n,r){for(var i=0,s=0;s<e.length;++s)e[s].isVisible&&(i+=e[s].width);i+=t?gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(QuickEditVisualRefreshFlight)?constants_1.JsGridConstants.Internal.RowHeaderWidthNewStyles:constants_1.JsGridConstants.Internal.RowHeaderWidth:0;i+=n?constants_1.JsGridConstants.Internal.SplitterWidth+r:0;i+=2;document.getElementById("jsgrid_div_element").style.width=i+"px";return i}var PrintPreviewGrid=(function(){function e(){this._bLimitRecordSize=!1;this._enableGantt=!1;this._ganttDelegateNames=null}e.prototype.Init=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=this;this._enableGantt=c;this._ganttDelegateNames=h;this._ganttPaneWidth=p;this._ganttZoomLevel=d;this._groupingStyles=n;property_1.PropertyType.Internal.Property.GetInstance().RegisterDefaultPropTypesFromDefaultDisplayControlMap(s,o);var y=this.CallGlobalFunc(u,[a]);this._jsGridControl=e;this._jsGridParams=new jsgridobj_1.JsGridControlParameters({});this._jsGridParams.name=StringHelper.format(SP.JsGrid.Res.printPreviewName,this._jsGridControl.name);this._jsGridParams.tableViewParams=t;for(var b in this._jsGridParams.tableViewParams.gridFieldMap){var w=this._jsGridParams.tableViewParams.gridFieldMap[b];null!=w._propType&&(w._propType.ID in o||!w._propType.bMultiValue?property_1.PropertyType.Internal.Property.GetInstance().PropTypeExists(w._propType.ID)&&(w._propType=property_1.PropertyType.Internal.Property.GetInstance().GetPropType(w._propType.ID)):w._propType.bMultiValue&&(w._propType=new property_1.PropertyType.MultiValuePropType(w._propType.singleValuePropType.ID,w._propType.separator,!property_1.PropertyType.Internal.Property.GetInstance().PropTypeExists(w._propType.singleValuePropType.ID))))}null!=y&&"function"==typeof y&&y(this._jsGridParams,this._jsGridControl);this.CallGlobalFunc(f,[this._jsGridParams.tableViewParams,l]);this.CallGlobalFunc(v,[this._jsGridParams.tableViewParams,this._jsGridControl,m]);this._tableCache=new tablecache_1.TableCache(null,function(e,t){var n=new Array(t.length);for(var r in t){var i=e[t[r]],s=g._recordFactory.MakeRecord(i.data,i.localized,g._bLimitRecordSize);s.fieldRawDataMap=i.fieldRawDataMap;s.fieldRawLocMap=i.fieldRawLocMap;n[t[r]]=s}return n});this.LoadDataIntoTableCache(r,t.gridFieldMap,i);this._jsGridParams.tableCache=this._tableCache;this.SetJsGridParameters();this._jsGridControl.Init(this._jsGridParams);window.document.body.addEventListener("mouseup",function(){var e=document.getElementById("jsgrid_div_element").clientWidth,t=AdjustPrintPreviewGridDivWidth(g._jsGridControl.GetColumns(),g._jsGridParams.tableViewParams.bRowHeadersEnabled,g._enableGantt,g._ganttPaneWidth);g._jsGridControl.NotifyResize();if(g._enableGantt){var n=g._jsGridControl.GetSplitterPosition();g._jsGridControl.SetSplitterPosition(n+(t-e))}});setTimeout(function(){window.print()},0)};e.prototype.CallGlobalFunc=function(e,t){if(null==e)return null;for(var n=e.split("."),r=window,i=0;i<n.length;++i){if(i==n.length-1&&n[i]in r&&"function"==typeof r[n[i]])return r[n[i]].apply(null,t);if(!(n[i]in r))break;r=r[n[i]]}return null};e.prototype.LoadDataIntoTableCache=function(e,t,n){this._tableCache.Clear();this._tableCache.AddRawDataToCache(gridutil_1.JsGridUtil.Internal.ConvertSetKeysToArray(e),e);this._recordFactory=new property_1.PropertyType.RecordFactory(t,n)};e.prototype.SetJsGridParameters=function(){this._jsGridParams.styleManager.groupingStyles=this._groupingStyles;if(this._enableGantt){this._jsGridParams.tableViewParams.splitterPos=document.getElementById("jsgrid_div_element").clientWidth,this._ganttPaneWidth,constants_1.JsGridConstants.Internal.SplitterWidth;this._jsGridParams.tableViewParams.ganttParams.ganttZoomLevel=this._ganttZoomLevel;if(null!=this._ganttDelegateNames){null!=this._ganttDelegateNames.fnGetGanttBarDate&&this._ganttDelegateNames.fnGetGanttBarDate in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetGanttBarDate=window[this._ganttDelegateNames.fnGetGanttBarDate]);null!=this._ganttDelegateNames.fnGetGanttBarStyleIds&&this._ganttDelegateNames.fnGetGanttBarStyleIds in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetGanttBarStyleIds=window[this._ganttDelegateNames.fnGetGanttBarStyleIds]);null!=this._ganttDelegateNames.fnRenderGanttRow&&this._ganttDelegateNames.fnRenderGanttRow in window&&(this._jsGridParams.tableViewParams.ganttParams.fnRenderGanttRow=window[this._ganttDelegateNames.fnRenderGanttRow]);null!=this._ganttDelegateNames.fnGetPredecessors&&this._ganttDelegateNames.fnGetPredecessors in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetPredecessors=window[this._ganttDelegateNames.fnGetPredecessors])}}else{this._jsGridParams.tableViewParams.ganttParams=null;this._jsGridParams.tableViewParams.paneLayout=constants_1.JsGridConstants.PaneLayout.GridOnly}this._jsGridParams.tableViewParams.bMovableColumns=!0;this._jsGridParams.tableViewParams.bResizableColumns=!0;this._jsGridParams.tableViewParams.bEditingEnabled=!1;this._jsGridParams.tableViewParams.allowedSelectionTypes=0;this._jsGridParams.tableViewParams.bNewRowEnabled=!1;this._jsGridParams.tableViewParams.bSortableColumns=!1;this._jsGridParams.tableViewParams.bHidableColumns=!1;this._jsGridParams.tableViewParams.bAutoFilterableColumns=!1;this._jsGridParams.tableViewParams.bRecordIndicatorCheckboxesEnabled=!1};return e})();exports.PrintPreviewGrid=PrintPreviewGrid;function CreatePrintPreviewBlobFromRecords(e){for(var t={},n=0;n<e.length;++n){var r=e[n],i={},s={};for(var o in r.properties){i[o]=r.properties[o].dataValue;r.properties[o].HasLocalizedValue()&&(s[o]=r.properties[o].localizedValue)}t[r.key()]={data:i,localized:s,fieldRawDataMap:r.fieldRawDataMap,fieldRawLocMap:r.fieldRawLocMap}}return t}function GetSerializedUnfilteredHierarchyManagerClone(e){return JSON.stringify({unfilteredHierMap:e.rowViewParams.unfilteredHierarchyMgr.GetUnfilteredHierarchyMap(),topNodeKey:e.rowViewParams.unfilteredHierarchyMgr.GetTopNodeKey()})}function GetSerializedTableViewParametersClone(e){var t={};for(var n in e.gridFieldMap)t[n]=GetSerializedGridFieldClone(e.gridFieldMap[n]);return JSON.stringify({simpleFields:{messageOverrides:e.messageOverrides,operationalConstantsFieldKeyMap:e.operationalConstantsFieldKeyMap,defaultEditMode:e.defaultEditMode,allowedSelectionTypes:e.allowedSelectionTypes,bMovableColumns:e.bMovableColumns,bResizableColumns:e.bResizableColumns,bHidableColumns:e.bHidableColumns,bSortableColumns:e.bSortableColumns,bAutoFilterableColumns:e.bAutoFilterableColumns,bRowHeadersEnabled:e.bRowHeadersEnabled,bRecordIndicatorCheckboxesEnabled:e.bRecordIndicatorCheckboxesEnabled,checkSelectionCheckboxHiddenRecordKeys:e.checkSelectionCheckboxHiddenRecordKeys,checkSelectionCheckboxDisabledRecordKeys:e.checkSelectionCheckboxDisabledRecordKeys,checkSelectionCheckedRecordKeys:e.checkSelectionCheckedRecordKeys,bEditingEnabled:e.bEditingEnabled,bNewRowEnabled:e.bNewRowEnabled,hierarchyKey:e.hierarchyKey,splitterPos:e.splitterPos,paneLayout:e.paneLayout,rowViewParams:e.rowViewParams},gridFieldMap:JSON.stringify(t),columns:GetSerializedColumnInfoCollectionClone(e.columns),pivotedGridParams_columns:null==e.pivotedGridParams?null:GetSerializedColumnInfoCollectionClone(e.pivotedGridParams.columns),ganttParams:null==e.ganttParams?null:GetSerializedGanttParametersClone(e.ganttParams),unfilteredHierarchyMgr:null==e.rowViewParams.unfilteredHierarchyMgr?null:GetSerializedUnfilteredHierarchyManagerClone(e)})}function GetSerializedGanttParametersClone(e){return JSON.stringify({dateRange:e.dateRange,ganttBarStyles:e.ganttBarStyles,ganttZoomLevel:e.ganttZoomLevel})}function GetSerializedGridFieldClone(e){return JSON.stringify({key:e.key,hasDataValue:e.hasDataValue,hasLocalizedValue:e.hasLocalizedValue,textDirection:e.textDirection,_defaultCellStyleId:e._defaultCellStyleId,_editMode:e._editMode,_propType:e._propType,_multiValue:e._multiValue})}function GetSerializedCloneFromColumnInfo(e){return"column"==e.ColumnType()?JSON.stringify({name:e.name,imgSrc:e.imgSrc,columnKey:e.columnKey,fieldKeys:e.fieldKeys,width:e.width,isVisible:e.isVisible,isHidable:e.isHidable,isResizable:e.isResizable,isSortable:e.isSortable,isAutoFilterable:e.isAutoFilterable,pivoted:!1}):"pivotedColumn"==e.ColumnType()?JSON.stringify({name:e.name,imgSrc:e.imgSrc,columnKey:e.columnKey,fieldKeys:e.fieldKeys,width:e.width,pivoted:!0}):void 0}function GetSerializedColumnInfoCollectionClone(e){for(var t=[],n=e.GetColumnArray(),r=0;r<n.length;++r)t.push(GetSerializedCloneFromColumnInfo(n[r]));return JSON.stringify(t)}function FinishLaunchPrintPreview(records,jsGridParams,additionalScriptFiles,beforeInitFnName,beforeInitFnArgsObj,initTableViewParamsFnName,initTableViewParamsFnArgsObj,title,bEnableGantt,optGanttDelegateNames,ganttPaneWidth,ganttZoomLevel,initGanttStylesFnName,initGanttStylesFnArgsObj){var newWin,cssLinkScripts=[],AJAXScripts=[],scripts=[],requiredScriptFiles=["scriptresx.ashx","SP.JsGrid.Res.js","jsgrid.js","sp.datetimeutil.js","jsgrid.gantt.js","init.js","strings.js"],requiredAJAXFiles=["scriptresource.axd","webresource.axd","msajaxbundle.js","msformbundle.js"];function MatchNodeWithSourceFiles(node,requiredFilesArray,htmlElementArray,attrib){var nodeStr=eval("node."+attrib).toLowerCase();if(null!=requiredFilesArray)for(var idx=0;idx<requiredFilesArray.length;++idx){var fileName=requiredFilesArray[idx].toLowerCase();if(-1!==nodeStr.indexOf(fileName)||fileName.indexOf(".js")==fileName.length-3&&-1!==nodeStr.indexOf(fileName.substr(0,fileName.length-3)+".debug.js")){htmlElementArray.push(gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetOuterHtml(node));return!0}}}function CopyRequiredDOMElements(e){for(var t=0;t<e.childNodes.length;++t){var n=e.childNodes[t];1==n.nodeType&&CopyRequiredDOMElements(n)}"stylesheet"==e.rel||e.type;if("LINK"==e.nodeName)cssLinkScripts.push(gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetOuterHtml(e));else if("SCRIPT"==e.nodeName){if(MatchNodeWithSourceFiles(e,requiredScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(e,additionalScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(e,requiredAJAXFiles,AJAXScripts,"src"))return}}function RenderHTMLElementArray(e){for(var t=0;t<e.length;++t)newWin.document.writeln(e[t])}function RenderPrintPreviewDocument(){(newWin=window.open()).document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"');newWin.document.writeln('"http www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">');newWin.document.writeln('<html style="height:100%;margin:0px;">');newWin.document.writeln("<head>");newWin.document.writeln("<title>"+gridutil_1.JsGridUtil.Utility.HTMLEncode(title)+"</title>");RenderHTMLElementArray(cssLinkScripts);RenderHTMLElementArray(AJAXScripts);newWin.document.writeln("</head>");newWin.document.writeln('<body style="overflow:auto;height:100%;margin:0px;">');newWin.document.writeln('<div id="jsgrid_div_element" style="width:100%; min-height:100%;height:570px;" display="block"/>');newWin.document.writeln(StringHelper.format(["<script>","var JsGridUtil.SpRegionalSettings={0}","<\/script>"].join("\n"),JSON.stringify(gridutil_1.JsGridUtil.SpRegionalSettings)));RenderHTMLElementArray(scripts);newWin.document.writeln(StringHelper.format(["<script>","Sys.Application.initialize();","var printPreviewGrid = new SP.JsGrid.PrintPreviewGrid();","Sys.Application.add_init(function()","{{",'    var jsGridDiv = $get("jsgrid_div_element");','    jsGridDiv.style.backgroundColor = "white";','    var defaultDisplayControlMap = SP.JsGrid.Internal.JSONParse(unescape("{0}"));','    var lookupPropTypeMap = SP.JsGrid.Internal.JSONParse(unescape("{8}"));','    var tableViewParams = new SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone(unescape("{1}"));','    var dataBlob = SP.JsGrid.Internal.JSONParse(unescape("{2}"));',"    var recordCount = {3};",'    jsGridDiv.style.height = (recordCount * 22 + 50) + "px";',"    AdjustPrintPreviewGridDivWidth(tableViewParams.columns.GetColumnArray(), tableViewParams.bRowHeadersEnabled, {9}, {11});",'    var keyColumnName = unescape("{4}");',"    printPreviewGrid.Init(","        new SP.JsGrid.JsGridControl(jsGridDiv, false),","        tableViewParams,",'        SP.JsGrid.Internal.JSONParse(unescape("{7}")),',"        dataBlob,","        keyColumnName,","        defaultDisplayControlMap,","        lookupPropTypeMap,","        {5},",'        SP.JsGrid.Internal.JSONParse(unescape("{6}")),',"        {13},",'        SP.JsGrid.Internal.JSONParse(unescape("{14}")),',"        {9},",'        SP.JsGrid.Internal.JSONParse(unescape("{10}")),',"        {11},","        {12},","        {16},",'        SP.JsGrid.Internal.JSONParse(unescape("{17}"))',"    );","}});","Sys.CultureInfo.CurrentCulture = (","function(a)","{{","   return new Sys.CultureInfo(a.name,a.numberFormat,a.dateTimeFormat)","}}",')(SP.JsGrid.Internal.JSONParse(unescape("{15}")));',"<\/script>","</body>","</html>"].join("\n"),escape(JSON.stringify(property_1.PropertyType.Internal.Property.GetInstance().GetDefaultDisplayControlMap())),escape(GetSerializedTableViewParametersClone(jsGridParams.tableViewParams)),escape(JSON.stringify(CreatePrintPreviewBlobFromRecords(records))),records.length,escape(jsGridParams.tableViewParams.keyFieldName),beforeInitFnName?['"',beforeInitFnName,'"'].join(""):"null",escape(JSON.stringify(beforeInitFnArgsObj)),escape(JSON.stringify(jsGridParams.styleManager.groupingStyles)),escape(JSON.stringify(property_1.PropertyType.Internal.Property.GetInstance().GetLookupPropTypeMap())),bEnableGantt?"true":"false",escape(JSON.stringify(optGanttDelegateNames)),ganttPaneWidth,ganttZoomLevel,initTableViewParamsFnName?['"',initTableViewParamsFnName,'"'].join(""):"null",escape(JSON.stringify(initTableViewParamsFnArgsObj)),escape(constants_1.JsGridConstants.SUPERTEMPORARY_defaultCultureStringify),initGanttStylesFnName?['"',initGanttStylesFnName,'"'].join(""):"null",escape(JSON.stringify(initGanttStylesFnArgsObj))));newWin.document.close()}CopyRequiredDOMElements(document);RenderPrintPreviewDocument()}exports.FinishLaunchPrintPreview=FinishLaunchPrintPreview});
define("yGe",["require","exports","cGe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t,n){this.dataPageSize=300;this.optMaxRecordCount=null;this.bConvertAllBlobsToRecords=!1;this.bKeepDataInBlobCache=!1;this.backgroundConversionSize=10;this.blobKeys=[];this.curRequestGeneration=0;this.blobConvertIdx=0;this._fnRequestData=e;this._fnConvertDataToRecords=t;this._fnComputeDataRangeRequest=n;this.InitCache()}e.prototype.ChangeKeys=function(e,t){if(e in this.recordCache){this.recordCache[t]=this.recordCache[e];delete this.recordCache[e]}if(e in this.blobCache){this.blobCache[t]=this.blobCache[e];delete this.blobCache[e]}if(e in this.columnCache){this.columnCache[t]=this.columnCache[e];delete this.columnCache[e]}for(var n=0;n<this.blobKeys.length;n++)if(e in this.blobKeys[n]){this.blobKeys[n][t]=this.blobKeys[n][e];delete this.blobKeys[n][e]}this.view.ChangeKeys(e,t);null!=this.sizeMgr&&this.sizeMgr.ChangeKeys(e,t)};e.prototype.SetDataPageSize=function(e){this.dataPageSize=e};e.prototype.GetDataPageSize=function(){return this.dataPageSize};e.prototype.GetRecordCacheSize=function(){var e,t=0;for(e in this.recordCache)t++;return t};e.prototype.GetRecordCache=function(){return this.recordCache};e.prototype.GetRawDataRecords=function(){this.ConvertBlobsToRecords()};e.prototype.SetMaxRecordCount=function(e){this.optMaxRecordCount=e;n.JsGridUtil.DebugAssert(null==this.sizeMgr||null==this.optMaxRecordCount||n.JsGridUtil.Internal.IsAssocArrayEmpty(this.recordCache));this.TryInitSizeMgr(!1)};e.prototype.GetMaxRecordCount=function(){return this.optMaxRecordCount};e.prototype.SetConvertAllBlobsToRecords=function(e){this.bConvertAllBlobsToRecords=e};e.prototype.GetConvertAllBlobsToRecords=function(){return this.bConvertAllBlobsToRecords};e.prototype.SetBackgroundConversionSize=function(e){this.backgroundConversionSize=e};e.prototype.GetBackgroundConversionSize=function(){return this.backgroundConversionSize};e.prototype.SetKeepDataInBlobCache=function(e){this.bKeepDataInBlobCache=e};e.prototype.GetKeepDataInBlobCache=function(){return this.bKeepDataInBlobCache};e.prototype.MakeRange=function(e,t){return{pos:e,count:t}};e.prototype.GetCachedRecord=function(e){e in this.blobCache&&!(e in this.recordCache)&&this.AddRecordsToCache(this._fnConvertDataToRecords(this.blobCache[e],[e]));return this.recordCache[e]};e.prototype.GetRecordsByKey=function(e,t){var r=this,i=function(){for(var t=new Array(e.length),n=0;n<e.length;n++){var i=r.view.GetPosFromKey(e[n]);if(null==i)return null;t[n]={pos:i,count:1}}return t},s=function(i){var s=r.GetRecords(i,o);if(s.recordSetComplete){var u=n.JsGridUtil.Internal.Flatten2LevelArray(s.records);setTimeout(function(){t(e,u,!0)},0)}},o=function(n,r){var o=i();r&&null!=n?s(o):t(e,null,!1)},u=i();if(null==u)return!1;s(u);return!0};e.prototype.GetRecords=function(e,t){var n=this,r=[],i=[],s=[];for(var o in e)r[o]=this.GetAvailability(e[o],s,i);this.LoadBlobs(s);if(i.length>0){var u,a,f=!0;a=function(n){f=f&&n;0==--u&&null!=t&&setTimeout(function(){t(e,f)},0)};if("function"==typeof this._fnComputeDataRangeRequest){var l=this._fnComputeDataRangeRequest(a);this.outstandingRequestRanges.AppendRangeObject(l.totalRanges[0])}else l=this.FindAndRegisterRanges(i,a);u=l.rangesToFillRequest;var c=l.totalRanges;if(c.length>0){var h=this.curRequestGeneration;this._fnRequestData(c,function(e){n.RequestResultDispatch(c,e,h)})}}return{recordSetComplete:0==i.length,records:r}};e.prototype.AddRecordsToCache=function(e){for(var t in e){var n=e[t];this.recordCache[t]=n;null!=this.sizeMgr&&this.sizeMgr.AddRecord(t);null!=this.fnApplyUpdatesToNewRecord&&this.fnApplyUpdatesToNewRecord(n);if((null==this.optMaxRecordCount||!this.bKeepDataInBlobCache)&&t in this.blobCache){delete this.blobCache[t];t in this.columnCache&&delete this.columnCache[t]}}};e.prototype.AddColumn=function(e,t,n){this.IncrementRequestGeneration();for(var r in this.recordCache)null!=t[r]?this.recordCache[r].AddFieldValue(e,t[r]):null!=n&&this.recordCache[r].AddFieldValue(e,n());for(var r in this.blobCache)if(null!=t[r]){null==this.columnCache[r]&&(this.columnCache[r]={});this.columnCache[r][e]=t[r]}};e.prototype.RemoveColumn=function(e){this.IncrementRequestGeneration();for(var t in this.recordCache)this.recordCache[t].RemoveFieldValue(e);for(var t in this.columnCache){delete this.columnCache[t][e];n.JsGridUtil.Internal.IsAssocArrayEmpty(this.columnCache[t])&&delete this.columnCache[t]}};e.prototype.ClearRecords=function(e){for(var t=0;t<e.length;t++){delete this.recordCache[e[t]];delete this.blobCache[e[t]]}};e.prototype.SetView=function(e,t){this.ClearOutstandingRequestRanges();this.view.SetViewMap(e,t)};e.prototype.GetView=function(){return this.view.GetKeys(0,this.view.GetRecordCount())};e.prototype.RecordIdxToKey=function(e){return this.view.GetKeyFromPos(e)};e.prototype.KeyToRecordIdx=function(e){return this.view.GetPosFromKey(e)};e.prototype.UpdateProperty=function(e,t,n){e.SetProp(t,n)};e.prototype.SeedInsertedRecord=function(e){e.key()in this.recordCache||(this.recordCache[e.key()]=e)};e.prototype.InsertRecord=function(e,t){this.ClearOutstandingRequestRanges();this.view.InsertRecord(e,t)};e.prototype.DeleteRecord=function(e){this.ClearOutstandingRequestRanges();this.view.DeleteRecord(e)};e.prototype.GetRecordCount=function(){return this.view.GetRecordCount()};e.prototype.IsKeyInView=function(e){return this.view.IsKeyPresent(e)};e.prototype.BulkMoveRecords=function(e,t,n){this.ClearOutstandingRequestRanges();null==n&&(n=this.view.GetRecordCount());this.view.BulkMoveRecords(e,t,n)};e.prototype.AddRawDataToCache=function(e,t,n){var r=!1;for(var i in e)if(!(e[i]in this.recordCache)){this.blobCache[e[i]]=t;r=!0}if(this.bConvertAllBlobsToRecords&&r){this.blobKeys.push(e);null!=n&&this.ConvertBlobsToRecords()}};e.prototype.AddRawViewToCache=function(e,t,n){this.AddRawDataToCache(e,t,n);this.view.SpliceView(n)};e.prototype.Clear=function(){this.InitCache()};e.prototype.ConvertBlobsToRecords=function(){if(this.blobKeys.length>0){for(var e=[];this.blobConvertIdx<this.blobKeys[0].length&&e.length<this.backgroundConversionSize;this.blobConvertIdx++)this.blobKeys[0][this.blobConvertIdx]in this.blobCache&&e.push(this.blobKeys[0][this.blobConvertIdx]);if(this.blobConvertIdx==this.blobKeys[0].length){this.blobConvertIdx=0;this.blobKeys.shift()}e.length>0&&this.AddRecordsToCache(this._fnConvertDataToRecords(this.blobCache[e[0]],e))}return this.blobKeys.length>0};e.prototype.IncrementRequestGeneration=function(){this.ClearOutstandingRequestRanges();this.curRequestGeneration++};e.prototype.ClearOutstandingRequestRanges=function(){if(null!=this.outstandingRequestRanges)for(var e=this.outstandingRequestRanges.GetAllCallbacks(),t=0;t<e.length;t++)e[t](!1);this.outstandingRequestRanges=new i};e.prototype.InitCache=function(){this.recordCache={};this.blobCache={};this.columnCache={};this.IncrementRequestGeneration();this.view=new o;this.TryInitSizeMgr(!0)};e.prototype.TryInitSizeMgr=function(e){null==this.sizeMgr||null==this.optMaxRecordCount||e?this.sizeMgr=null!=this.optMaxRecordCount?new u(20,this.optMaxRecordCount,this):null:this.sizeMgr.SetMaxSize(this.optMaxRecordCount)};e.prototype.GetAvailability=function(e,t,r){var i=e.pos,s=e.count,o=this.view.GetKeys(i,s),u=new Array(s);n.JsGridUtil.DebugAssert(i>=0&&i+s<=this.view.GetRecordCount());for(var a=0;a<s;a++){var f=o[a],l=this.recordCache[f];null!=this.sizeMgr&&this.sizeMgr.TouchRecord(f);if(null!=l)u[a]=l;else{u[a]=null;var c=this.blobCache[f];null!=c?t.push({key:f,blob:c,destArray:u,destIdx:a}):r.push({pos:i+a,key:f})}}return u};e.prototype.LoadBlobs=function(e){var t,r=[];for(var i in e){t=e[i];var s=n.JsGridUtil.Internal.Find(r,function(e){return e.blob==t.blob});if(null==s){s={blob:t.blob,keys:[]};r.push(s)}s.keys.push(t.key)}for(var i in r)this.AddRecordsToCache(this._fnConvertDataToRecords(r[i].blob,r[i].keys));for(var i in e)(t=e[i]).destArray[t.destIdx]=this.recordCache[t.key]};e.prototype.RequestResultDispatch=function(e,t,n){if(n==this.curRequestGeneration){if(null!=t)for(var r=0;r<t.length;r++)this.AddRawDataToCache(t[r].keys,t[r].data,null);for(r=0;r<e.length;r++){var i=this.outstandingRequestRanges.FindRangeObject(e[r].pos);if(null!=i){for(var s in i.callbacks)i.callbacks[s](null!=t);this.outstandingRequestRanges.RemoveRangeObject(i)}}}};e.prototype.FindAndRegisterRanges=function(e,t){for(var n,r=0,i=[],s=null,o=0;o<e.length;o++){n=e[o].pos;if(null==(s=this.outstandingRequestRanges.FindRangeObject(n))){var u=this.CreateRanges(n,.75);for(var a in u)this.outstandingRequestRanges.AppendRangeObject(u[a]);i=i.concat(u)}}s=null;for(o=0;o<e.length;o++){n=e[o].pos;if(null==s||!this.outstandingRequestRanges.IsPosInRange(n,s)){r++;null==(s=this.outstandingRequestRanges.FindRangeObject(n))&&(s={});null==s.callbacks?s.callbacks=[t]:s.callbacks.push(t)}}return{rangesToFillRequest:r,totalRanges:i}};e.prototype.CreateRanges=function(e,t){for(var n,r=250,i=250,s=e-1,o=e,u=[],a=this.dataPageSize*(1-t),f=!0,l=!0,c=!0;c&&u.length<this.dataPageSize;){c=!1;if(f&&r>0){r-=(n=this.FindMissingRecords(s,a,r,-1)).scanned;s-=n.scanned+1;f=n.shouldContinue;u=u.concat(n.positions);a=this.dataPageSize-u.length;c=!0}if(l&&i>0){i-=(n=this.FindMissingRecords(o,a,i,1)).scanned;o+=n.scanned+1;l=n.shouldContinue;u=u.concat(n.positions);a=this.dataPageSize-u.length;c=!0}}return this.MakeRangesFromList(u)};e.prototype.MakeRangesFromList=function(e){var t=[];e.sort(function(e,t){return e-t});for(var n=e.length,r=Number.NEGATIVE_INFINITY,i=null,s=0;s<n;s++){if(e[s]!==r+1){i=this.MakeRange(e[s],1);t.push(i)}else i.count++;r=e[s]}return t};e.prototype.FindMissingRecords=function(e,t,n,r){for(var i,s={positions:[],shouldContinue:!0,scanned:0},o=this.view.GetRecordCount(),u=0;u<n;u++){if((i=e+u*r)<0||i>o){s.shouldContinue=!1;break}var a=this.view.GetKeyFromPos(i);if(!(a in this.recordCache)&&!(a in this.blobCache)&&null==this.outstandingRequestRanges.FindRangeObject(i)){s.positions.push(i);if(--t<=0)break}}s.scanned=u;return s};return e})();t.TableCache=r;var i=(function(){function e(){this.ranges=[]}e.prototype.FindRangeObject=function(e){var t=null,n=this.FindRangeIdx(e);n<this.ranges.length&&this.IsPosInRange(e,this.ranges[n])&&(t=this.ranges[n]);return t};e.prototype.AppendRangeObject=function(e){var t=this.FindRangeIdx(e.pos);this.ranges.splice(t,0,e)};e.prototype.RemoveRangeObject=function(e){var t=this.FindRangeIdx(e.pos);n.JsGridUtil.DebugAssert(0==this.GetRangePosInfo(e.pos,this.ranges[t]));this.ranges.splice(t,1)};e.prototype.IsPosInRange=function(e,t){return 0==this.GetRangePosInfo(e,t)};e.prototype.IsEmpty=function(){return 0==this.ranges.length};e.prototype.GetAllCallbacks=function(){for(var e=[],t=0;t<this.ranges.length;t++)null!=this.ranges[t].callbacks&&(e=e.concat(this.ranges[t].callbacks));return e};e.prototype.FindRangeIdx=function(e){var t=this;return n.JsGridUtil.Internal.LowerBoundCompare(this.ranges,e,function(e,n){return t.GetRangePosInfo(n,t.ranges[e])})};e.prototype.GetRangePosInfo=function(e,t){return e<t.pos?1:t.pos+t.count<=e?-1:0};return e})(),s=(function(){function e(){this.bIsFakeKey=1}e.prototype.toString=function(){null==this.tempKey&&(this.tempKey="TempKey"+this.tempKeyIdx++);return this.tempKey};return e})(),o=(function(){function e(){}e.prototype.SetViewMap=function(e,t){this.keyPosMap=null;if(null!=t){n.JsGridUtil.DebugAssert(e.length<=t);this.posKeyMap=new Array(t);for(var r=0;r<e.length;r++)this.posKeyMap[r]=e[r];for(r=e.length;r<t;r++)this.posKeyMap[r]=new s}else this.posKeyMap=e};e.prototype.ChangeKeys=function(e,t){null==this.keyPosMap&&this.InitKeyPosMap();if(e in this.keyPosMap){this.keyPosMap[t]=this.keyPosMap[e];delete this.keyPosMap[e];this.posKeyMap[this.keyPosMap[t]]=t}};e.prototype.GetKeys=function(e,t){for(var n=new Array(t),r=0;r<t;r++)n[r]=this.GetKeyFromPos(e+r);return n};e.prototype.InsertRecord=function(e,t){this.posKeyMap.splice(e,0,t);this.keyPosMap=null};e.prototype.DeleteRecord=function(e){this.posKeyMap.splice(e,1);this.keyPosMap=null};e.prototype.BulkMoveRecords=function(e,t,n){var r=t-e+1,i=this.posKeyMap.splice(e,r);n=n<e?n:n-r;Array.prototype.splice.apply(this.posKeyMap,[n,0].concat(i));this.keyPosMap=null};e.prototype.SpliceView=function(e){for(var t in e)this.InsertRecord(t+this.GetRecordCount(),e[t])};e.prototype.GetRecordCount=function(){return null!=this.posKeyMap?this.posKeyMap.length:0};e.prototype.IsKeyPresent=function(e){null==this.keyPosMap&&this.InitKeyPosMap();return e in this.keyPosMap};e.prototype.GetKeyFromPos=function(e){var t;null!=this.posKeyMap&&(t=this.posKeyMap[e]);return t};e.prototype.GetPosFromKey=function(e){null==this.keyPosMap&&this.InitKeyPosMap();return e in this.keyPosMap?this.keyPosMap[e]:null};e.prototype.InitKeyPosMap=function(){this.keyPosMap={};for(var e=this.posKeyMap.length-1;e>=0;e--)this.keyPosMap[this.posKeyMap[e]]=e};return e})(),u=(function(){function e(e,t,r){this.generationOrder=[];this.generationCountMap={};this.numberOfRecordsToProcessPerTimeout=10;this.recordList=[];this.recordGenerationMap={};this.pageCount=0;n.JsGridUtil.DebugAssert(e<=t/5);this._genSize=e;this._maxSize=t;this.tableCache=r;this.Init()}e.prototype.ChangeKeys=function(e,t){if(e in this.recordGenerationMap){this.recordGenerationMap[t]=this.recordGenerationMap[e];delete this.recordGenerationMap[e]}};e.prototype.Init=function(){var e=this,t=function(t){var n=e.GenerateGenerationName();e.generationOrder.push(n);e.generationCountMap[n]=0};this.deleteQuota=new a(this.RemoveFromGeneration,this);t();t();this.curInsertIdx=0};e.prototype.GenerateGenerationName=function(){return this.pageCount++};e.prototype.IncrementRecordCount=function(e){var t=this.deleteQuota.TotalRemaingToDelete(),n=this.recordList.length-this._maxSize-t;n>0&&this.deleteQuota.AddToDeleteCount(n+this._genSize);this.recordList.push(e)};e.prototype.AddRecord=function(e){if(null==this.recordGenerationMap[e]){this.curInsertIdx=this.AddToGeneration(e,this.curInsertIdx,Math.ceil((this.generationOrder.length-1)/2));this.IncrementRecordCount(e)}};e.prototype.SetMaxSize=function(e){this._maxSize=e};e.prototype.TouchRecord=function(e){if(this.recordGenerationMap[e]!==this.generationOrder[this.generationOrder.length-1]){null!=this.recordGenerationMap[e]?this.RemoveFromGeneration(e):this.IncrementRecordCount(e);this.AddToGeneration(e,this.generationOrder.length-1,null)}};e.prototype.AddToGeneration=function(e,t,n){if(this.generationCountMap[this.generationOrder[t]]==this._genSize){var r=this.GenerateGenerationName();t=null!=n?n:t+1;this.generationOrder.splice(t,0,r);this.generationCountMap[r]=0}this.generationCountMap[this.generationOrder[t]]++;this.recordGenerationMap[e]=this.generationOrder[t];return t};e.prototype.RemoveFromGeneration=function(e){var t=this.recordGenerationMap[e];if(1==this.generationCountMap[t]){for(var r=0;r<this.generationOrder.length&&this.generationOrder[r]!=t;r++);n.JsGridUtil.DebugAssert(r!==this.generationOrder.length);delete this.generationCountMap[t];this.generationOrder.splice(r,1);this.recordGenerationMap[e]=-1}else this.generationCountMap[t]--};return e})(),a=(function(){function e(e,t){this.toDeleteCount=0;this.nScheduledForDeletion=0;this.curPos=0;this._fnRemoveRecordFromGen=e;this._tableSizeManager=t}e.prototype.AddToDeleteCount=function(e){n.JsGridUtil.AsynchronousTaskManager.GetInstance().TaskRegistered(this.processKey)||(this.processKey=n.JsGridUtil.AsynchronousTaskManager.GetInstance().RegisterTask(this.DeleteRecords));this.toDeleteCount=this.ComputeGensToDelete(this.nScheduledForDeletion+e)};e.prototype.TotalRemaingToDelete=function(){return this.nScheduledForDeletion};e.prototype.ComputeGensToDelete=function(e){this.gensToDelete={};this.nScheduledForDeletion=0;for(var t=0;t<this._tableSizeManager.generationOrder.length-3&&this.nScheduledForDeletion<e;t++){this.nScheduledForDeletion+=this._tableSizeManager.generationCountMap[this._tableSizeManager.generationOrder[t]];this.gensToDelete[this._tableSizeManager.generationOrder[t]]=null}};e.prototype.DeleteRecords=function(){for(var e=0;e<this._tableSizeManager.numberOfRecordsToProcessPerTimeout;e++)if(this._tableSizeManager.recordGenerationMap[this._tableSizeManager.recordList[this.curPos]]in this.gensToDelete){var t=this._tableSizeManager.recordList[this.curPos],n=this._tableSizeManager.recordGenerationMap[t];delete this._tableSizeManager.tableCache.recordCache[t];1==this._tableSizeManager.generationCountMap[n]&&delete this.gensToDelete[n];this._fnRemoveRecordFromGen(t);delete this._tableSizeManager.recordGenerationMap[t];this._tableSizeManager.recordList.splice(this.curPos,1);this.nScheduledForDeletion--}else this.curPos=(this.curPos+1)%(this._tableSizeManager.recordList.length-1);return 0!==this.nScheduledForDeletion};return e})()});
define("xGe",["require","exports","cGe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this._tableCache=e;this._objBag=t}e.prototype.SetScrollBarObj=function(e){this.vertScrollBar=e};e.prototype.SetPaneMgrObj=function(e){this.paneMgr=e};e.prototype.GetTopViewIdx=function(){return this.vertScrollBar.GetTopItemIdx()};e.prototype.GetWholeRowDisplayCapacity=function(){return this.vertScrollBar.GetWholeItemDisplayCapacity()};e.prototype.RecordIdxToRecordKey=function(e){var t;if(this._objBag.editUtil.IsNewRowEnabled()&&e>=this._tableCache.GetRecordCount()){var n=this._objBag.entryRecordMgr.GetEntryRecords();n.length>0&&(t=n[Math.min(e-this._tableCache.GetRecordCount(),n.length-1)].key())}else t=this._tableCache.RecordIdxToKey(e);return t};e.prototype.RecordIdxToViewIdx=function(e){return e};e.prototype.ViewIdxToRecordIdx=function(e){return e};e.prototype.ViewIdxToRelViewIdx=function(e){return e-this.vertScrollBar.GetTopItemIdx()};e.prototype.RelViewIdxToViewIdx=function(e){return e+this.vertScrollBar.GetTopItemIdx()};e.prototype.IsRecordOnScreen=function(e){return null!=this.paneMgr.RecordKeyToViewIdx(e)};e.prototype.GetLastRecordKey=function(){return this._tableCache.RecordIdxToKey(this._tableCache.GetRecordCount()-1)};e.prototype.RecordKeyToViewIdx=function(e){var t,n=this.paneMgr.RecordKeyToViewIdx(e);return null!=n?n:null==(t=this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.entryRecordMgr.GetEntryRecordIdx(e)+this.GetViewRecordCount():this._tableCache.KeyToRecordIdx(e))?null:this.RecordIdxToViewIdx(t)};e.prototype.RecordKeyToRelViewIdx=function(e){var t=this.RecordKeyToViewIdx(e);return null!=t?this.ViewIdxToRelViewIdx(t):null};e.prototype.RecordKeyToRecordIdx=function(e){var t=this.paneMgr.RecordKeyToViewIdx(e);return null!=t?this.ViewIdxToRecordIdx(t):this._tableCache.KeyToRecordIdx(e)};e.prototype.ViewIdxToRecordKey=function(e){return this.RecordIdxToRecordKey(this.ViewIdxToRecordIdx(e))};e.prototype.GetViewRecordCount=function(){return this._tableCache.GetRecordCount()};e.prototype.GetViewRecords=function(e,t,r){var i=0;this._objBag.editUtil.IsNewRowEnabled()&&(i=Math.min(Math.max(e+t-this.GetViewRecordCount(),0),t));var s=0==(t-=i)?null:this._tableCache.GetRecords([{pos:e,count:t}],function(n,i){r(e,t,i)});null==s?s={recordSetComplete:!0,records:[]}:s.records=n.JsGridUtil.Internal.Flatten2LevelArray(s.records);if(i>0){var o=Math.max(e-this.GetViewRecordCount(),0);s.records=s.records.concat(this._objBag.entryRecordMgr.GetEntryRecords().slice(o,o+i))}return s};return e})();t.PositionConverter=r});
define("XGe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.JSONParse=function(e){var t=!1,n=JSON.parse(e,r);t&&(function e(t,n){if(null!=t&&"object"==typeof t)for(var r in t)if(t.hasOwnProperty(r)){e(t[r],n);t[r]=n(r,t[r])}})(n,r);return n;function r(e,n){(function(e,n){t=t||null==n&&/^\d+$/.test(e)})(e,n);if("string"==typeof n){var r=/^\/Date\((-?\d+\))\/$/g.exec(n);if(null!=r){var i=parseInt(r[1]);return new Date(i)}}return n}}});
define("lGe",["require","exports","r","cGe","eGe","vGe","oGe","sGe","pze","SGe","bGe","dGe","hGe","Qn","_Ge","Ih","qr","TE","mGe","IA","ce","Zze","Jze","A","pGe","fGe","tGe","LPe","Le","de","I4","qze","uGe","dVe","Ov"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H={ODB:1310},B={ODB:1746},j={ODB:1806},F={ODB:1170},I={ODB:1725},q={ODB:1507},R={ODB:1892},U={ODB:1024},z={ODB:1740},W={ODB:1300},X={ODB:1843},V=w.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),$=w.Killswitch.isActivated("91C4DDB5-64CC-4DD8-A3E5-BB6D7E38971E","10/2/2019","Batch the csom calls so that they dont hit the csom limit."),J=w.Killswitch.isActivated("0432E43E-C631-4773-A94E-2E508B1B7769","11/20/2019","Add some QOS to SPGantt."),K=w.Killswitch.isActivated("D1EB03FD-9CB4-47AA-83E2-BC9D730B6DB1","12/31/2019","Add a better check for an email being null."),Q=w.Killswitch.isActivated("79AF3379-785D-4527-8C2E-79CAC8F796D2","3/12/2020","Get rid of open editors when a column moves"),G=w.Killswitch.isActivated("ED34ADB5-14FC-4DD4-8D87-300A2C21200F","5/15/2020","write changed fieldTypes in Engagement log"),Y=w.Killswitch.isActivated("C4807DCB-BAA4-421D-B130-BD340C0B259D","6/2/2020","rebind column functions after edit"),Z=w.Killswitch.isActivated("A886E7B9-6E94-4486-B7D4-65AA7916EB0B","8/20/2020","Break loop when new field is found"),ee=w.Killswitch.isActivated("81D986A7-7828-4B05-8F08-2209F0ED1D9B","8/31/2020","Convert csom SP.FieldUserValue data into email and displayText format"),te="QuickEditWriteChange",ne="QuickEditRenameColumn",re="QuickEditDeleteItems",ie="QuickEditMoveColumn",se="QuickEditAddColumn",oe="QuickEditCreateItem",ue="QuickEditUndoChange",ae="QuickEditRedoChange",fe={};t.OnJsGridIframeLoad=function(e){fe[e].OnAutoFilterReturn()};var le=function(e,t){this.name=e;this.fnGenerateArgs=t};t.WebMethod=le;var ce=(function(){function t(t,n){var i=this;this._serverWriteTimeout=null;this._hierarchyEnabled=!1;this._rowLevelErrors={};this._GridValueToSPListValueConverters={};this._SPListValueToGridValueConverters={};this._selfReferencingLookupPropTypes={};this._propChangesPendingValidation=new u.Set;this._changeKeysPendingValidation={};this._changesToSend={};this._currentlyRenamingColumn=!1;this._fnCallbacksByChangeKey=new r.JsGridUtil.ChangeKeyOnCompleteMap;this._isFullLoadCompleted=!1;this._fnCallbackCompleteFullLoad=[];this._fnRowChanged=[];this._isUsingDataSync=!1;this.Undo=function(){var e=new(i._telemetry(x.Qos))({name:ue});try{i._commandMgr.Undo();e.end({resultType:x.ResultTypeEnum.Success})}catch(n){var t=M.getErrorMessage(n);e.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToUndoChange",error:t})}};this.Redo=function(){var e=new(i._telemetry(x.Qos))({name:ae});try{i._commandMgr.Redo();e.end({resultType:x.ResultTypeEnum.Success})}catch(n){var t=M.getErrorMessage(n);e.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToRedoChange",error:t})}};this._onBeginUndoDataUpdateChange=function(e){e.changeKey;i._logEngagement("QuickEditOnBeginUndoDataUpdateChange")};this._onBeginRedoDataUpdateChange=function(e){e.changeKey;i._logEngagement("QuickEditOnBeginRedoDataUpdateChange")};this.addColumnOnCompleteCallback=function(){var e=i._jsGridControl.GetSpCsrRenderCtx();i._ensureExternalJsFilesLoaded(function(){S.SPGridFetchSchema(e.listName,e.view,function(e){for(var t,n,r,s,o=i._jsGridControl.GetSpCsrRenderCtx(),u=e.Field.length,a=function(u){t=e.Field[u];n=!1;for(var a=0;a<o.ListSchema.Field.length;a++)if(t.RealFieldName===o.ListSchema.Field[a].RealFieldName){n=!0;break}if(!n){if("Choice"===t.FieldType||"MultiChoice"===t.FieldType){var f;r=function(){var e,n=f.get_schemaXml();if(n){var r=(new DOMParser).parseFromString(n,"text/xml");e=i.createNewColumn(t,r)}else e=i.createNewColumn(t);i._dataSource.AddColumn(e);var s=i.createColumnInfo(t);i._jsGridControl.AddColumn(s,e,i._currentAddColumnInternalName);i._jsGridControl.ShowColumn(t.RealFieldName);i._jsGridControl.EnsurePaneWidth();i._jsGridControl.NotifyDataAvailable()};i.runQuery(function(e){var n=i.InitContext(r,{},e),s=n.list.get_fields();f=s.getByInternalNameOrTitle(t.Name);n.context.load(f);n.context.executeQueryAsync()})}else{s=i.createNewColumn(t);i._dataSource.AddColumn(s);var l=i.createColumnInfo(t);i._jsGridControl.AddColumn(l,s,i._currentAddColumnInternalName);i._jsGridControl.ShowColumn(t.RealFieldName);i._jsGridControl.EnsurePaneWidth();i._jsGridControl.NotifyDataAvailable()}if(!Z)return"break"}},f=0;f<u;f++){if("break"===a(f))break}o.ListSchema=e})})};this.editColumnOnCompleteCallback=function(){var e=i._jsGridControl.GetSpCsrRenderCtx();i._ensureExternalJsFilesLoaded(function(){S.SPGridFetchSchema(e.listName,e.view,function(e){var t=i._jsGridControl.GetSpCsrRenderCtx();if(i._currentEditColumnInternalName){for(var n,r=!1,s=0;s<e.Field.length;s++)if(e.Field[s].RealFieldName===i._currentEditColumnInternalName){r=!0;n=e.Field[s];break}r?i.editColumnInternal(e,t,n):i.deleteColumnInternal(t)}})})};window.OnJsGridIframeLoad=function(e){fe[e].OnAutoFilterReturn()};this._disposeDialogContainer=document.createElement("div");this._aadUserId=n;J||(this._telemetry=t);var s=function(e){return r.JsGridUtil.Internal.IsFeatureEnabled(e)};this._isUsingDataSync=P.isDataSyncEnabled(s,P.DataSyncEntityType.SharePointList);this._getDataSyncClientImport=i._isUsingDataSync?new Promise(function(t,n){e(["dVe"],t,n)}).then(function(e){return function(t){return e.getDataSyncClient(t,s)}}):Promise.resolve(function(e){})}Object.defineProperty(t,"Instances",{get:function(){return this._instances},enumerable:!0,configurable:!0});Object.defineProperty(t,"FnGanttCreationCallback",{get:function(){return this._FnGanttCreationCallback},enumerable:!0,configurable:!0});t.WaitForGanttCreation=function(e){for(var t=this.Instances,n=0;n<t.length;n++)e(t[n]);this.FnGanttCreationCallback.push(e)};t.prototype.get_Api=function(){return this._api};t.prototype.AttachFullLoadCallback=function(e){this._fnCallbackCompleteFullLoad.push(e);this._isFullLoadCompleted&&e(this._gridFieldMap)};t.prototype.AttachRowChanged=function(e){this._fnRowChanged.push(e)};t.prototype.GetListId=function(){return this._params.listId};t.prototype.UpdateProperties=function(e){this._jsGridControl.UpdateProperties(e,null,null)};t.prototype.IsParseAndSetFields=function(e){return e in this._params.parseAndSetFields};t.prototype.UpdateDisplayAndEditControls=function(){o.PropertyType.Utils.UpdateEditControlForPropType("String",this._editBoxControlId);o.PropertyType.Utils.UpdateEditControlForPropType("Hyperlink",this._hyperlinkControlId);var e=1==r.JsGridUtil.SpRegionalSettings.calendarType;r.JsGridUtil.Internal.IsFeatureEnabled(q)&&e&&o.PropertyType.Utils.UpdateEditControlForPropType("SPDateTime",this._datePickerControlId);for(var t=o.PropertyType.Utils.GetPropTypes(),n=0;n<t.length;n++){var i=t[n];"SPUser"===i||"SPUser_MultiValue"==i?o.PropertyType.Utils.UpdateDisplayControlForPropType(i,a.DisplayControlType.User):"SPImageThumbnail"===i?o.PropertyType.Utils.UpdateDisplayControlForPropType(i,a.DisplayControlType.ImageThumbnail):o.PropertyType.Utils.UpdateDisplayControlForPropType(i,a.DisplayControlType.CSR)}};t.prototype.Init=function(e,n,u){var l=this;this._jsGridControl=e;fe[this._jsGridControl.parentNode.id]=this;this._params=u;if(this._params.viewSelectorId){var c=RenderViewSelectorPivotMenu({wpq:this._params.viewSelectorId,viewTitle:this._params.viewTitle,ListSchema:{ViewSelectorPivotMenuOptions:this._params.ViewSelectorPivotMenuOptions}});document.getElementById(this._params.viewSelectorId).innerHTML='<div class="ms-csrlistview-controldiv">'+c+"</div>"}if(null!=n){if(null!=n.SortState&&1==n.SortState.length){var h=n.SortState;this._sortState={sortField:h[0].fieldKey,isDescending:h[0].isDescending}}this.ResolveAutoFilterState(n.AutoFilterState);var p=u.spCsrRenderCtx;if(p){p.inGridMode=!1;var d=new r.JsGridUtil.Internal.List_QstringStruct(p.clvp.PagingString());for(var v in d.filterParams)delete d.filterParams[v];for(var m in d.nonFilterParams)"Paged"!==m&&"PagedPrev"!==m&&"PageFirstRow"!==m&&"PageLastRow"!==m&&"FirstRow"!==m&&0!==m.indexOf("p_")&&delete d.nonFilterParams[m];this._pagingInfo=d.toString();p.inGridMode=!0}}this._infoFetched=new Array(this._params.totalItemCount);this.InitSPListValueConversion(this._params.splookupFieldInfo);this.customFieldInfo=this._params.customFieldInfo;this._gridParams=new f.JsGridControlParameters({commandManagerParams:{maxUndoDepth:100,onUndoRealCmdCountChange:this._params.onUndoRealCmdCountChange,onRedoRealCmdCountChange:this._params.onRedoRealCmdCountChange}});this._gridParams.canUserAddColumn=this._params.canUserAddColumn;this._gridParams.showAddColumn=this._params.showAddColumn;this._gridParams.spGrid=this._params.spGrid;this._gridParams.spCsrRenderCtx=this._params.spCsrRenderCtx;this._gridParams.qualifier=this._params.qualifier;this._gridParams.peoplePickerDataSource=this._params.peoplePickerDataSource;this._gridParams.portalManager=this._params.portalManager||_.defaultPortalManger;this._gridParams.locationDataSource=this._params.locationDataSource;this._gridParams.taxonomyPickerDataSource=this._params.taxonomyPickerDataSource;this._gridParams.pageContext=this._params.pageContext;this._gridParams.customFormatterProps=this._params.customFormatterProps;this._gridParams.telemetry=this._params.telemetry;this._gridParams.onLaunchFilterPanel=this._params.onLaunchFilterPanel;this._gridParams.onSort=this._params.onSort;this._gridParams.launchColumnCustomization=this._params.launchColumnCustomization;this._gridParams.launchColumnsEditor=this._params.launchColumnsEditor;this._gridParams.onLaunchColumnManagementPanel=this._params.onLaunchColumnManagementPanel;this._gridParams.onColumnChangeSucceeded=this._params.onColumnChangeSucceeded;this._gridParams.baseEngagementData=this._params.baseEngagementData;this._gridParams.onPinToFiltersPane=this._params.onPinToFiltersPane;if(null!=this._gridParams.tableViewParams){"boolean"==typeof this._params.bHidableColumns&&(this._gridParams.tableViewParams.bHidableColumns=this._params.bHidableColumns);"boolean"==typeof this._params.bMovableColumns&&(this._gridParams.tableViewParams.bMovableColumns=this._params.bMovableColumns)}this._editBoxControlId=a.EditControlType.EditBox;this._peoplePickerControlId=a.EditControlType.PeoplePicker;this._locationPickerControlId=a.EditControlType.LocationPicker;this._datePickerControlId=a.EditControlType.DatePicker;this._checkBoxControlId=a.EditControlType.Checkbox;this._numberBoxControlId=a.EditControlType.NumberBox;this._editBoxControlId="EDIT_SPGRIDEDITBOX";o.PropertyType.Utils.RegisterEditControl(this._editBoxControlId,function(e){return N.GetEditBoxEditControl(e)},[]);this._peoplePickerControlId="EDIT_SPGPEOPLEPICKER";o.PropertyType.Utils.RegisterEditControl(this._peoplePickerControlId,function(e){return N.GetPeoplePickerEditControl(e)},[]);this._locationPickerControlId="EDIT_SPGLOCATIONPICKER";o.PropertyType.Utils.RegisterEditControl(this._locationPickerControlId,function(e){return N.GetLocationPickerEditControl(e)},[]);r.JsGridUtil.Internal.IsFeatureEnabled(z)&&o.PropertyType.Utils.RegisterEditControl(this._checkBoxControlId,function(e){return N.GetCheckBoxEditControl(e)},[]);r.JsGridUtil.Internal.IsFeatureEnabled(W)&&o.PropertyType.Utils.RegisterDisplayControl(this._numberBoxControlId,function(e){return N.GetNumberBoxEditControl(e)},[]);o.PropertyType.RegisterNewCustomPropType(new T.TextMaxLengthPropertyType(this.BuildMaxLengthTable(this._params.customFieldInfo)),a.DisplayControlType.Text,this._editBoxControlId);var g,y,b=1==r.JsGridUtil.SpRegionalSettings.calendarType;if(r.JsGridUtil.Internal.IsFeatureEnabled(q)&&b){o.PropertyType.Utils.RegisterEditControl(this._datePickerControlId,function(e){return N.GetDatePickerEditControl(e)},[]);o.PropertyType.RegisterNewCustomPropType(new T.DatePropertyType,a.DisplayControlType.Text,this._editBoxControlId)}else o.PropertyType.RegisterNewCustomPropType(new T.DatePropertyType,a.DisplayControlType.Text,this._editBoxControlId,[a.WidgetControlType.Date]);o.PropertyType.RegisterNewCustomPropType(new T.EditPropertyType,a.DisplayControlType.Image,this._editBoxControlId);o.PropertyType.RegisterNewCustomPropType(new T.UserPropertyType(this),a.DisplayControlType.Text,this._peoplePickerControlId);o.PropertyType.RegisterNewCustomPropType(new T.PercentCompletePropertyType,a.DisplayControlType.Text,this._editBoxControlId);r.JsGridUtil.Internal.IsFeatureEnabled(W)&&o.PropertyType.RegisterNewCustomPropType(new T.NumberPropertyType,a.DisplayControlType.Text,this._numberBoxControlId);if(r.JsGridUtil.Internal.IsFeatureEnabled(j)){this._hyperlinkControlId=a.EditControlType.Hyperlink;o.PropertyType.Utils.RegisterEditControl(this._hyperlinkControlId,function(e){return N.GetHyperlinkEditControl(e)},[])}else{this._hyperlinkControlId="EDIT_SPGHYPERLINK";o.PropertyType.Utils.RegisterEditControl(this._hyperlinkControlId,function(e){return N.GetEditBoxEditControl(e,!0)},[])}var S=null!=this._params.spCsrRenderCtx;if(S){g="EDIT_SPGMULTILINEPLAINTEXT";o.PropertyType.Utils.RegisterEditControl(g,function(e){return new N.MultilinePlainTextEditControl(e)},[]);y="EDIT_SPGENHANCEDRICHTEXT";o.PropertyType.Utils.RegisterEditControl(y,function(e){return new N.EnhancedRichTextEditControl(e,l._params.qualifier)},[])}o.PropertyType.RegisterNewCustomPropType(new T.MultilineTextPropertyType,a.DisplayControlType.Text,S?g:this._editBoxControlId);o.PropertyType.RegisterNewCustomPropType(new T.EnhancedRichTextPropertyType,a.DisplayControlType.Text,S?y:this._editBoxControlId);w.Killswitch.isActivated("9328df4d-1b7a-4a12-a64f-036d20af969b","01/10/2020","Render thumbnail in quick edit")||o.PropertyType.RegisterNewCustomPropType(new T.ImageThumbnailPropertyType,a.DisplayControlType.ImageThumbnail,this._editBoxControlId);if(V)SP.UI.Taxonomy.ControlRegistration.RegisterGridControls(this,this.customFieldInfo,S);else{if(r.JsGridUtil.Internal.IsFeatureEnabled(B)){o.PropertyType.RegisterNewCustomPropType(new E.Taxonomy.TaxonomyFieldPropertyType(this.customFieldInfo),"","EDIT_TAXONOMY");this.RegisterGridValueToSPListValueConverter("TaxonomyField",E.Taxonomy.DataConverters.GridValueToInputValue);this.RegisterSPListValueToGridValueConverter("TaxonomyField",E.Taxonomy.DataConverters.SPListValueToGridValue);this.RegisterGridValueToSPListValueConverter("TaxonomyField_MultiValue",E.Taxonomy.DataConverters.GridValueToInputValue);this.RegisterSPListValueToGridValueConverter("TaxonomyField_MultiValue",E.Taxonomy.DataConverters.SPListValueCollectionToGridValue)}else SP.UI.Taxonomy.ControlRegistration.RegisterGridControls(this,this.customFieldInfo,S);this._taxonomyPickerControlId="EDIT_TAXONOMY";o.PropertyType.Utils.RegisterEditControl(this._taxonomyPickerControlId,function(e){return N.GetTaxonomyPickerEditControl(e,l.customFieldInfo)},[]);o.PropertyType.Internal.Property.GetInstance().UpdateWidgetControlsForPropType("TaxonomyField",[])}var x=this._params.siteUrl+"/",C=r.JsGridUtil.Internal.IsFeatureEnabled(R);for(var k in this._params.splookupFieldInfo){var L=this._params.splookupFieldInfo[k],A=new T.LookupPropertyType(k,L,x);o.PropertyType.RegisterNewCustomPropType(A,a.DisplayControlType.Text,C?a.EditControlType.BooleanComboBox:a.EditControlType.ComboBox);if(L.listId.toUpperCase()==this._params.listId.toUpperCase()){null==this._selfReferencingLookupPropTypes[L.field]&&(this._selfReferencingLookupPropTypes[L.field]=[]);this._selfReferencingLookupPropTypes[L.field].push(A)}}this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetFieldEditMode,this.GetFieldEditMode.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,this.GetFieldReadOnlyActiveState.bind(this));var O=this._gridParams.styleManager,M=O.columnHeaderStyleCollection;O.UpdateHeaderStyleFromCss(M,{normal:{base:"ms-spgrid-col-header-normal"},normalHover:{base:"ms-spgrid-col-header-normal-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-normal-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-normal-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-normal-hover"},partSelected:{base:"ms-spgrid-col-header-part-selected"},partSelectedHover:{base:"ms-spgrid-col-header-part-selected-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-part-selected-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-part-selected-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-part-selected-hover"},allSelected:{base:"ms-spgrid-col-header-all-selected"},allSelectedHover:{base:"ms-spgrid-col-header-all-selected-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-all-selected-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-all-selected-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-all-selected-hover"}});this._dataSource=new s.SharePointDataSource(new le("Populate",function(){return{}}),new le("Init",function(){return{}}),new le("ComputeDataRange",function(){return{}}),{Populate:function(e,t,n){var r=l.GetCLVPQString().toArray();r.push("ShowInGrid=True");var i=l._jsGridControl.GetSpCsrRenderCtx(),s="?"+r.join("&");i.queryString=s;i.clvp.RefreshPaging(s)},Init:function(e,t,r){t(n);l.SetItemInfoPresent(l._jsGridControl.GetTopRowIndex())},ComputeDataRange:function(e){return l.ComputeSPDataRange(e)}},this._jsGridControl,function(){},this.UpdateDisplayAndEditControls.bind(this));this._dataSource.BeginFullLoad(this.FinishFullLoad.bind(this),function(){},this._gridParams);t.Instances.push(this);for(var D=t.FnGanttCreationCallback,P=0;P<D.length;P++)D[P](this)};t.prototype.GetUnfilteredHierarchyMap=function(){return null};t.prototype.GetCLVPQString=function(){var e=this._jsGridControl.GetSpCsrRenderCtx();r.JsGridUtil.DebugAssert(null!=e);var t=null;null!=this._sortState&&(t="SortField="+this._sortState.sortField+"&SortDir="+(this._sortState.isDescending?"Desc":"Asc"));var n=new r.JsGridUtil.Internal.List_QstringStruct(r.JsGridUtil.Internal.List_ReconcileQstringFilters(r.JsGridUtil.Internal.List_ReconcileQstringFilters(this._pagingInfo,this._filterUrl),t));null!=n.nonFilterParams.SortField&&(n.nonFilterParams.SortField=this.GetCSRFieldKeyFromJsGridFieldKey(n.nonFilterParams.SortField));for(var i in n.filterParams){var s="FilterField",o=n.filterParams[i][s];if(null==o){s="FilterFields";o=n.filterParams[i][s]}r.JsGridUtil.DebugAssert(null!=o);n.filterParams[i][s]=this.GetCSRFieldKeyFromJsGridFieldKey(o)}this._params.viewRootFolder&&(n.nonFilterParams.RootFolder=r.JsGridUtil.Internal.EscapeProperly(this._params.viewRootFolder));return n};t.prototype.TryDispose=function(e){var t=this,n=function(){t.TryDisposeInternal(e)};this._jsGridControl.FinalizeEditing(n,n)};t.prototype.TryDisposeInternal=function(e,t){var n=this,i=function(){n._currentlyShowingDisposeDialog=!1;n.Dispose();e();n._gridParams.portalManager.unmount(n._disposeDialogContainer)},s=this._currentlyWritingChangesToList||this._currentlyCreatingNewListItem||this._currentlyDeletingListItems||this._currentlyRenamingColumn;if(!(t&&!this._currentlyDisposing||this._isDisposed)){if(this._jsGridControl.AnyUncomittedEntryRecords()){this._jsGridControl.JumpToEntryRecord();s=!0}if(!r.JsGridUtil.Internal.IsAssocArrayEmpty(this._changesToSend)){$?this.WriteChangesToListCore():this.BatchedWriteChangesToListCore();s=!0}if(this._jsGridControl.AnyErrors()){this._currentlyShowingDisposeDialog&&this._gridParams.portalManager.unmount(this._disposeDialogContainer);this._currentlyShowingDisposeDialog=!0;this._showDisposeDialog(Strings.STS.L_SPGanttDisposeErrorDialogTitle,Strings.STS.L_SPGanttDisposeErrorDialogBody,Strings.STS.L_SPGanttDisposeErrorDialogFixButton,Strings.STS.L_SPGanttDisposeDialogDiscardButton,function(){n._currentlyShowingDisposeDialog=!1;n._currentlyDisposing=!1;n._gridParams.portalManager.unmount(n._disposeDialogContainer)},i)}else if(s){if(!this._currentlyShowingDisposeDialog){this._currentlyDisposing=!0;this._currentlyShowingDisposeDialog=!0;this._showWarningDialog(Strings.STS.L_SPGanttDisposeSavingDialogTitle,Strings.STS.L_SPGanttDisposeSavingDialogBody,Strings.STS.L_SPGanttDisposeDialogLeaveButton,i)}this._currentlyDisposing&&setTimeout(function(){n.TryDisposeInternal(e,!0)},200)}else{var o=SP.UI.ModalDialog.get_childDialog();if(this._currentlyShowingDisposeDialog){r.JsGridUtil.DebugAssert(null!=o);i()}else{r.JsGridUtil.DebugAssert(null==o);i()}}}};t.prototype.Dispose=function(){this._isDisposed=!0;this._jsGridControl.Dispose();this._api=null};t.prototype._showDisposeDialog=function(e,t,r,i,s,o){this._gridParams.portalManager.render(n.createElement(g.ConfirmationDialog,{title:e,prompt:t,noText:r,yesText:i,onCancel:s,onConfirm:o,maxWidth:"450px"}),this._disposeDialogContainer)};t.prototype._showWarningDialog=function(e,t,r,i){this._gridParams.portalManager.render(n.createElement(y.WaitingDialog,{title:e,prompt:t,maxWidth:"450px"}),this._disposeDialogContainer)};t.prototype._logEngagement=function(e,t){this._gridParams.telemetry&&this._gridParams.telemetry(v.default).logData(m.graft(this._gridParams.baseEngagementData,{name:e,extraData:t}))};t.prototype.FinishFullLoad=function(e,t){var n=this;this._tableViewParams=e.tableViewParams;this._bGrouped=!1;this._gridFieldMap=e.tableViewParams.gridFieldMap;SP.Res?e.name=SP.Res.ganttListName:e.name="";r.JsGridUtil.Internal.IsFeatureEnabled(I)||e.enabledRowHeaderAutoStates.Add(i.JsGridConstants.RowHeaderAutoStyleId.Dirty);this._newRowEnabled=e.tableViewParams.bNewRowEnabled=!this._bGrouped&&this._params.listPermissions&i.JsGridConstants.SPGPermissions.addListItems&&(null==this._params.spCsrRenderCtx||"1"!==this._params.spCsrRenderCtx.ListSchema.IsDocLib);if(null!=e.tableViewParams.ganttParams){e.tableViewParams.ganttParams.fnGetGanttBarDate=this.GetGanttBarDate.bind(this);e.tableViewParams.ganttParams.fnGetGanttBarStyleIds=function(){r.JsGridUtil.DebugAssert(!1,"Oh no!  We've disabled hierarchy")};e.tableViewParams.ganttParams.fnGetPredecessors=this.GetPredecessors.bind(this)}e.styleManager.RegisterCellStyle("CheckmarkStyle",l.StyleUtil.CreateStyle(l.StyleType.Cell,{textAlign:"center"}));var s=e.tableViewParams.columns.GetColumnByKey("Checkmark");null!=s&&(s.fnGetCellStyleId=function(){return"CheckmarkStyle"});null!=e.tableViewParams.ganttParams&&e.styleManager.RegisterCellStyle("Summary",l.StyleUtil.CreateStyle(l.StyleType.Cell,{fontWeight:"bold"}));this._editRowEnabled=e.tableViewParams.bEditingEnabled=this._params.listPermissions&i.JsGridConstants.SPGPermissions.editListItems;this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetRecordEditMode,this.GetRecordEditMode.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRightClick,this.OnRightClick.bind(this));var o=e.tableViewParams.columns.GetColumnByKey("Edit");if(null!=o){o.fnShouldLinkSingleValue=function(){return!0};o.fnSingleValueClicked=this.OnEditCellContentsClicked}var u=e.tableViewParams.columns.GetColumnByKey("Title");if(null!=u){u.fnShouldLinkSingleValue=this.ShouldLinkTitleCell;u.fnSingleValueClicked=this.OnTitleCellContentsClicked}this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.AutoFilter,this.OnAutoFilter.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.Sort,this.OnSort.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.MoveColumn,this.MoveColumn.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.NextPage,this.OnNextPage.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.AddNewColumn,this.AddNewColumn.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetAutoFilterEntries,this.GetAutoFilterEntries.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.LaunchFilterDialog,this.LaunchFilterDialog.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.CreateEntryRecord,this.CreateEntryRecord.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.TryInsertEntryRecord,this.CreateNewListItem.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.TryCreateProvisionalRecord,this.CreateNewListItem.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.DeleteRecords,this.DeleteSelectedRecords.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.RemoveColumnFromView,this.RemoveColumnFromView.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetGridRowStyleId,null);this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.CanReorderRecords,function(){return n._params.canShowReorderUI});this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.OnBeforeRecordReordered,function(){r.JsGridUtil.DebugAssert("Oh no!  We've disabled hierarchy.")});this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.EditColumn,this.EditColumn.bind(this));r.JsGridUtil.Internal.IsFeatureEnabled(F)?this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.AddNewColumnMenuItems,this.PopulateAddNewColumnMenuItemsV2.bind(this)):this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.AddNewColumnMenuItems,this.PopulateAddNewColumnMenuItems.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRowEscape,this.OnRowEscape.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInsertedOrDeleted.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordInsertedOrDeleted.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRecordsReordered,function(){r.JsGridUtil.DebugAssert("Oh no!  We've disabled hierarchy.")});this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnBeforePropertyChanged,this.OnBeforePropertyChanged.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnBeginRenameColumn,this.OnBeginRenameColumn.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnEndRenameColumn,this.OnEndRenameColumn.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnSingleCellKeyDown,this.OnSingleCellKeyDown.bind(this));if(r.JsGridUtil.Internal.IsFeatureEnabled(U)){this._jsGridControl.AttachEvent(b.SPGridEvents.redoChangeEventName,this.Redo);this._jsGridControl.AttachEvent(b.SPGridEvents.undoChangeEventName,this.Undo);this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnBeginUndoDataUpdateChange,this._onBeginUndoDataUpdateChange);this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnBeginRedoDataUpdateChange,this._onBeginRedoDataUpdateChange)}if(null!=this._params.spCsrRenderCtx&&null!=this._params.spCsrRenderCtx.ListData&&this._params.spCsrRenderCtx.ListData.ForceNoHierarchy){this._hierarchyEnabled=!1;e.tableViewParams.rowViewParams.hierarchyMode=i.JsGridConstants.HierarchyMode.None}"rtl"==this._params.listDirection?e.isRTL=!0:"ltr"==this._params.listDirection&&(e.isRTL=!1);this.CustomizeGridStyles(e);this._jsGridControl.Init(e);this._commandMgr=e.commandMgr;for(var a=0;a<this._fnCallbackCompleteFullLoad.length;a++)this._fnCallbackCompleteFullLoad[a](this._gridFieldMap);this._isFullLoadCompleted=!0};t.prototype.CustomizeGridStyles=function(e){var t=e.styleManager;t.groupingStyles=null;t.gridPaneStyle.backgroundColor="transparent";t.defaultCellStyle.textAlign=e.isRTL?"right":"left";t.defaultCellStyle.backgroundColor="transparent";var n=t.columnHeaderStyleCollection;n.normal.innerBorderColor="transparent";n.normal.eyeBrowColor="transparent";n.partSelected.innerBorderColor="transparent";n.partSelected.eyeBrowColor="transparent";n.allSelected.innerBorderColor="transparent";n.allSelected.eyeBrowColor="transparent"};t.prototype.ZoomInGantt=function(){this._jsGridControl.SetGanttZoomLevel(this._jsGridControl.GetGanttZoomLevel()-1)};t.prototype.ZoomOutGantt=function(){this._jsGridControl.SetGanttZoomLevel(this._jsGridControl.GetGanttZoomLevel()+1)};t.prototype.ScrollGanttToFocusedItem=function(){var e=this.GetFocusedRecord();if(null!=e){var t=e.GetDataValue(this._params.startColumnName);null==t&&(t=e.GetDataValue(this._params.finishColumnName));null!=t&&this._jsGridControl.ScrollGanttToDate(t)}};t.prototype.get_SelectedItems=function(){for(var e=this._jsGridControl.GetSelectedRecordKeys(),t=[],n=0;n<e.length;n++){var r=e[n];this._jsGridControl.IsGroupingRecordKey(r)||this._jsGridControl.IsEntryRecordKey(r)||this._jsGridControl.IsProvisionalRecordKey(r)||t.push(e[n])}return t};t.prototype.get_SelectedItemsIncludingProvisionalItems=function(){for(var e=this._jsGridControl.GetSelectedRecordKeys(),t=[],n=0;n<e.length;n++){var r=e[n];this._jsGridControl.IsGroupingRecordKey(r)||this._jsGridControl.IsEntryRecordKey(r)||t.push(e[n])}return t};t.prototype.AddItemsToTimeline=function(e){if(null!=e&&e.length&&e.length>0){for(var t=[],n=0;n<e.length;n++){var r={};r.id=e[n];t.push(r)}this.AddItemsToTimeline(t)}};t.prototype.DeleteSelectedItems=function(){this.DeleteSelectedRecords()};t.prototype.LaunchEditItemFormForItem=function(e){this.ViewOrEditItem(!0,e)};t.prototype.LaunchViewItemFormForItem=function(e){this.ViewOrEditItem(!1,e)};t.prototype.ViewOrEditItem=function(e,t){var n=GetCurrentCtx(),r=e?n.editFormUrl:n.displayFormUrl,i=-1==r.indexOf("?")?"?":"&",s=this._dataSource.tableCache.GetCachedRecord(t).GetDataValue("_ContentTypeId");r=r+i+"ID="+t+(null!=s&&""!==s?"&ContentTypeID="+s:"");r=AddSourceToUrl(r)+GetRootFolder(n);EditItem2(null,r)};t.prototype.GetCSRFieldFromJsGridFieldKey=function(e){for(var t=this._jsGridControl.GetSpCsrRenderCtx().ListSchema.Field,n=0;n<t.length;n++){var i=t[n];if(i.RealFieldName==r.JsGridUtil.Internal.UnescapeProperly(e))return i}};t.prototype.GetCSRFieldKeyFromJsGridFieldKey=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t?e:r.JsGridUtil.Internal.EscapeProperly(t.Name)};t.prototype.GetFocusedRecord=function(){var e,t=this._jsGridControl.GetFocusedItem();null!=t&&(e=this._dataSource.tableCache.GetCachedRecord(t.recordKey));return e};t.prototype.GetRecordKeysToSend=function(){var e=new u.Set;for(var t in this._changesToSend)if(!this._jsGridControl.AnyErrorsInRecord(t)||t in this._rowLevelErrors&&this._rowLevelErrors[t].bCommunicationsError){var n=this._changesToSend[t];for(var r in n)if(n[r].changeKey.GetVersionNumber()in this._changeKeysPendingValidation){e.Add(t);break}}else e.Add(t);return new u.Set(this._changesToSend).Difference(e).GetCollection()};t.prototype.CanDiscardChangesForRow=function(e){return e in this._changesToSend};t.prototype.DiscardChangesForRow=function(e){var t=this;if(e in this._changesToSend){this._showDisposeDialog(Strings.STS.L_SPGanttDiscardChangesDialogTitle,Strings.STS.L_SPGanttDiscardChangesDialogMessage,Strings.STS.L_SPNo,Strings.STS.L_SPYes,function(){t._jsGridControl.Focus();t._gridParams.portalManager.unmount(t._disposeDialogContainer)},function(){t._jsGridControl.Focus();var n=t._changesToSend[e];delete t._changesToSend[e];var r=t.GetMostRecentChangeKey(n),i=[];for(var s in n){var o=n[s];i.push(c.CreateValidatedPropertyUpdate(e,s,o.oldProp.data,o.oldProp.localized))}t._jsGridControl.UpdateProperties(i,null,r);t._gridParams.portalManager.unmount(t._disposeDialogContainer)})}};t.prototype.OnRowEscape=function(e){var t=e.recordKey;this.CanDiscardChangesForRow(t)&&this.DiscardChangesForRow(t)};t.prototype.OnBeforePropertyChanged=function(e){var t=e.recordKey,n=this._jsGridControl.GetRecord(t),i=e.fieldKey;if(null!=n.properties[i]){var s=n.properties[i].propType;if("SPMultilineText"!=s.ID&&"SPEnhancedRichText"!=s.ID&&"TaxonomyField"!=s.ID&&"TaxonomyField_MultiValue"!=s.ID){var o=n.fieldRawDataMap.csrInfo;if(null!=o&&(null==this._changesBeingSent||null==this._changesBeingSent[t])&&!r.JsGridUtil.Internal.IsNoOpChange(e,n)){o.stale=o.stale||{};o.stale[i]=!0}}}};t.prototype.OnPropertyChanged=function(e,t){var n=this;if(!this._jsGridControl.IsProvisionalRecordKey(e.recordKey)&&!(e.fieldKey in this._params.computedFields)){(function(t){var r=n._selfReferencingLookupPropTypes[e.fieldKey];if(null!=r)for(var i=0;i<r.length;i++)r[i].InvalidateCache()})();if(e.changeKey!=this._cascadingChangeKey){null==this._rowLevelErrors[e.recordKey]||this._rowLevelErrors[e.recordKey].bCommunicationsError||this.ClearRowLevelError(e.recordKey);t||(function(e){var t={},r=n._jsGridControl.GetRecord(e.recordKey).fieldRawDataMap._ContentTypeId;if(null!=r&&r in n._params.contentTypes)for(var s=n._params.contentTypes[r].RequiredFields,o=0;o<s.length;o++){t[s[o]]=1}e.validationState==i.JsGridConstants.ValidationState.Valid&&(e.fieldKey in n._params.requiredFields||e.fieldKey in t)&&(e.newProp.HasLocalizedValue()&&(""==e.newProp.localized||null==e.newProp.localized)||e.newProp.HasDataValue()&&null==e.newProp.data)&&n._jsGridControl.SetCellError(e.recordKey,e.fieldKey,SP.Res.requiredField15)})(e);(function(e){if(e.validationState==i.JsGridConstants.ValidationState.Valid&&"Title"==e.fieldKey&&n._dataSource.tableCache.GetCachedRecord(e.recordKey).GetDataValue("_FolderLink")){var t=c.CreateValidatedPropertyUpdate(e.recordKey,"FileLeafRef",e.newProp.data,e.newProp.localized);n._jsGridControl.UpdateProperties([t],null,e.changeKey)}})(e);(function(e){var t=e.changeKey.GetVersionNumber(),r=[e.recordKey,e.fieldKey,t].join();if(e.validationState==i.JsGridConstants.ValidationState.Pending){n._propChangesPendingValidation.Add(r);t in n._changeKeysPendingValidation||(n._changeKeysPendingValidation[t]=0);n._changeKeysPendingValidation[t]++}else if(n._propChangesPendingValidation.Contains(r)){n._propChangesPendingValidation.Remove(r);n._changeKeysPendingValidation[t]--;0==n._changeKeysPendingValidation[t]&&delete n._changeKeysPendingValidation[t]}})(e);(function(e){if(e.validationState==i.JsGridConstants.ValidationState.Pending||e.validationState==i.JsGridConstants.ValidationState.Valid){null==(t=n._changesToSend[e.recordKey])&&(n._changesToSend[e.recordKey]=t={});null!=t[e.fieldKey]&&t[e.fieldKey].changeKey.Release();t[e.fieldKey]=e;e.changeKey.Reserve()}else{var t;if(null!=(t=n._changesToSend[e.recordKey])&&null!=t[e.fieldKey]){t[e.fieldKey].changeKey.Release();delete t[e.fieldKey]}}})(e);var r=this._jsGridControl.GetFocusedItem();e.validationState==i.JsGridConstants.ValidationState.Valid&&(null!=r&&e.recordKey!=r.recordKey||this._dataSource.tableCache.GetRecordCount()+(this._tableViewParams.bNewRowEnabled?1:0)==1)&&this.WriteChangesToList()}}};t.prototype.OnRecordInsertedOrDeleted=function(){for(var e in this._selfReferencingLookupPropTypes)for(var t=this._selfReferencingLookupPropTypes[e],n=0;n<t.length;n++)t[n].InvalidateCache()};t.prototype.OnRowFocusChanged=function(e){this.WriteChangesToList()};t.prototype.OnSort=function(e){this._pagingInfo=null;this._sortState={sortField:e[0].columnName,isDescending:e[0].isDescending};this.ClearItemInfoPresent();this._dataSource.RefreshRowView(!1,this.RefreshRowView.bind(this))};t.prototype.RefreshRowView=function(e,t){this._jsGridControl.SetRowView(e);RefreshCommandUI&&RefreshCommandUI()};t.prototype.RemoveColumnFromView=function(e){var t=this,n=function(){var e=t._jsGridControl.GetSpCsrRenderCtx();null!=e&&S.SPGridFetchSchema(e.listName,e.view,function(t){e.ListSchema=t});t._gridParams.onColumnChangeSucceeded&&t._gridParams.onColumnChangeSucceeded()};function r(){throw"Failed to delete column "+e}this._ensureExternalJsFilesLoaded(function(){var i=t._jsGridControl._GetPaneManager(),s=i.GetGridPane().GetAllColumns();s.RemoveColumn(e);i.UpdateColumns(s);t._jsGridControl.EnsurePaneWidth();t._jsGridControl.NotifyDataAvailable();t.runQuery(function(i){var s=t.InitContext(n,r,i);s.view.get_viewFields().remove(e);s.view.update();s.context.executeQueryAsync()})})};t.prototype.runQuery=function(e){var t=this;return this._isUsingDataSync&&this._aadUserId&&this._params.listId&&this._params.siteUrl?this._getDataSyncClientImport.then(function(n){var r=n(t._aadUserId);return r?r.getData({siteUrl:t._params.siteUrl,listId:t._params.listId,siteId:t._params.siteId,operation:D.DataSyncOperationType.ListQuickEdit},function(t){e(t);return Promise.resolve(void 0)},function(){e();return Promise.resolve(void 0)}):e()}):e()};t.prototype.OnBeginRenameColumn=function(){this._currentlyRenamingColumn=!0};t.prototype.OnSingleCellKeyDown=function(e){if("Checkmark"==e.fieldKey&&window.CheckMarkFieldTemplate&&e&&e.eventInfo&&32==e.eventInfo.keyCode){var t=document.getElementById(window.CheckMarkFieldTemplate.GetCheckMarkId(this._jsGridControl.GetSpCsrRenderCtx(),e.recordKey));t&&t.OnClickCheckmark()}};t.prototype.OnEndRenameColumn=function(e){var t,n=this;J||(t=new(this._telemetry(x.Qos))({name:ne}));var r=function(){n._currentlyRenamingColumn=!1;var e=n._jsGridControl.GetSpCsrRenderCtx();null!=e&&S.SPGridFetchSchema(e.listName,e.view,function(t){e.ListSchema=t});J||t.end({resultType:x.ResultTypeEnum.Success})},i=function(){n._currentlyRenamingColumn=!1;if(J)throw"Failed to rename column "+s+" with name "+o;var e="Failed to rename column "+s+" with name "+o;t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToRenameColumn",error:e});throw e},s=e.columnKey,o=e.newColumnTitle,u=e.originalColumnTitle;o!=u?this._ensureExternalJsFilesLoaded(function(){n.runQuery(function(e){var t=n.InitContext(r,i,e),u=t.list.get_fields().getByInternalNameOrTitle(s);u.set_title(o);u.update();t.context.executeQueryAsync()})}):this._currentlyRenamingColumn=!1};t.prototype.MoveColumn=function(e){var t,n=this;Q||this._jsGridControl.StopEditing();J||(t=new(this._telemetry(x.Qos))({name:ie}));var r=e.columnInfo,i=e.dragDropDetails,s=e.onColumnChangeSucceeded,o=i.draggedIndex,u=i.targetIndex,a=r.columnKey,f=function(){var e=n._jsGridControl.GetSpCsrRenderCtx();null!=e&&S.SPGridFetchSchema(e.listName,e.view,function(t){e.ListSchema=t});s&&s();J||t.end({resultType:x.ResultTypeEnum.Success})},l=function(){if(J)throw"Failed to move column "+a+" to position "+u;var e="Failed to move column "+a+" to position "+u;t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToMoveColumn",error:e});throw MessageChannel};this._ensureExternalJsFilesLoaded(function(){var e=n._jsGridControl._GetPaneManager(),t=e.GetGridPane().GetAllColumns();t.RemoveColumn(a);t.InsertColumnAt(u,r);e.UpdateColumns(t);n._jsGridControl.EnsurePaneWidth();n._jsGridControl.NotifyDataAvailable();n.runQuery(function(e){var t=n.InitContext(f,l,e),r=t.view;r.get_viewFields().moveFieldTo("Title"===a?"LinkTitle":a,u>o?u+1:u);r.update();t.context.executeQueryAsync()})})};t.prototype.AddNewColumn=function(e,t,n,s){var u,a,f=this;J||(a=new(this._telemetry(x.Qos))({name:se}));var l=function(){var e,n=function(){var t=f._jsGridControl.GetSpCsrRenderCtx();if(null!=t){S.SPGridFetchSchema(t.listName,t.view,function(n){for(var i=n.Field.length,s=0;s<i&&(u=n.Field[s]).RealFieldName!=r;s++);e.csrInfo=u;t.ListSchema=n});s&&s()}},r=u.get_internalName(),i=o.PropertyType.Internal.Property.GetInstance().GetPropType(t.propType);if("SPDateTime"==i.ID){e=new h.GridField(r,t.hasData,t.hasLocalized,null,null,null,!1,null);f._params.parseAndSetFields[r]=1}else e=new h.GridField(r,t.hasData,t.hasLocalized);"SPUser"==i.ID&&i.SetPeoplePickerDefaultSettings(r);e.SetSingleValuePropType(i);f._dataSource.AddColumn(e);var l=new h.ColumnInfo(v,null,r,100);f._jsGridControl.AddColumn(l,e);f._jsGridControl.ShowColumn(r);f._jsGridControl.EnsurePaneWidth();f._jsGridControl.NotifyDataAvailable();f._jsGridControl.RenameColumn(r);null!=m?f.runQuery(function(e){var t=f.InitContext(n,c,e),i=t.view;i.get_viewFields().add(r);i.update();t.context.executeQueryAsync()}):n();J||a.end({resultType:x.ResultTypeEnum.Success})},c=function(){if(J)throw"Failed to add new column "+v+" to view";var e="Failed to add new column "+v+" to view";a.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToAddColumn",error:e});throw e},p=function(e){if(e==i.JsGridConstants.DialogResult.OK){var t=f._jsGridControl.GetSpCsrRenderCtx();S.SPGridFetchSchema(t.listName,t.view,function(e){for(var t=f._jsGridControl.GetSpCsrRenderCtx(),n=e.Field.length,r=0;r<n;r++){for(var s=e.Field[r],u=!1,a=0;a<t.ListSchema.Field.length;a++)s.RealFieldName===t.ListSchema.Field[a].RealFieldName&&(u=!0);if(!u){var l,c=s.RealFieldName,p=o.PropertyType.Internal.Property.GetInstance().GetPropType(i.JsGridConstants.FieldTypeToJsGridType[s.Type]);if("SPDateTime"==p.ID){l=new h.GridField(c,!0,!0,null,null,null,!1,null);f._params.parseAndSetFields[c]=1}else l=new h.GridField(c,!0,!0);"SPUser"==p.ID&&p.SetPeoplePickerDefaultSettings(c);"1"==s.AllowMultipleValues?l.SetIsMultiValue(";"):l.SetSingleValuePropType(p);l.csrInfo=s;f._dataSource.AddColumn(l);var d=new h.ColumnInfo(v,null,c,100);d.name=s.Name;f._jsGridControl.AddColumn(d,l);f._jsGridControl.ShowColumn(c);f._jsGridControl.EnsurePaneWidth();f._jsGridControl.NotifyDataAvailable()}}t.ListSchema=e})}},d=function(e,t){var n=[];n.push(r.JsGridUtil.Internal.SiteUrl+"/_layouts/15/"+e);n.push("?List=");n.push(f._params.listId);n.push("&AddToView=");n.push(f._params.viewId);n.push("&FieldTypeParam=");n.push(t);n.push("&IsDlg=");n.push(1);return n.join("")},v=null!=n&&n.length>0?n:e,m=null,g=String.fromCharCode(97+Math.floor(26*Math.random()))+Math.random().toString(36).substring(2,5);this._ensureExternalJsFilesLoaded(function(){switch(e){case"Text":case"Note":case"Number":case"Currency":case"DateTime":case"Boolean":case"URL":case"User":case"Location":f.runQuery(function(t){var n=f.InitContext(l,c,t),s="<Field Name='"+g+"' DisplayName='"+r.JsGridUtil.Internal.Encoding_STSHtmlEncode(v)+"' Type='"+e+"'";"User"==e&&(s+=" List='UserInfo'");s+=" />";u=n.list.get_fields().addFieldAsXml(s,!1,i.JsGridConstants.AddFieldOptions.defaultValue|i.JsGridConstants.AddFieldOptions.addFieldInternalNameHint);m=n.view;u.update();n.context.load(u);n.context.load(m);n.context.executeQueryAsync()});return;case"Choice":case"Lookup":case"Calculated":case"BusinessData":case"MoreColumnTypes":var t="Choice"==e||"Calculated"==e?"FldNew.aspx":"FldNewEx.aspx",n={title:SP.JsGrid.Res.addColumnName,dialogReturnValueCallback:p,url:d(t,e)};SP.UI.ModalDialog.showModalDialog(n);return}})};t.prototype.onClickMoreColumnOptions=function(){this._navigation||(this._navigation=new k.Navigation);var e=r.JsGridUtil.Internal.SiteUrl+"/_layouts/15/fldNew.aspx?List="+L.default.encodeURIComponent(A.default.normalizeUpper(this._params.listId,!0))+"&Source="+L.default.encodeURIComponent(window.location.href)+"&AddToView="+L.default.encodeURIComponent(this._params.viewId);this._navigation.navigateTo({url:e})};t.prototype.onLaunchColumnManagementPanelAction=function(e,t,n){this.onLaunchColumnManagementPanelActionInternal(e,!1,t,n)};t.prototype.onLaunchColumnManagementPanelActionWithLink=function(e,t,n){this.onLaunchColumnManagementPanelActionInternal(e,!0,t,n)};t.prototype.onLaunchColumnManagementPanelActionInternal=function(e,t,n,i){r.JsGridUtil.Internal.IsFeatureEnabled(X)&&(this._currentAddColumnInternalName=i);n({createField:{fieldType:e,fieldToInsertAfter:i},isHyperlink:t},this.addColumnOnCompleteCallback)};t.prototype.editColumnInternal=function(e,t,n){for(var r,i,s,o,f,l,c,h,p,d,v=this,m=this._jsGridControl._GetPaneManager(),g=m.GetGridPane().GetAllColumns(),y=function(y){if(t.ListSchema.Field[y].RealFieldName!==b._currentEditColumnInternalName)return"continue";var w=t.ListSchema.Field[y];r=g.RemoveColumn(w.RealFieldName);if("Location"!==n.FieldType){var E;i=function(){var i,s=E.get_schemaXml();if(s){var o=(new DOMParser).parseFromString(s,"text/xml");i=v.createNewColumn(n,o)}else i=v.createNewColumn(n);v._dataSource.AddColumn(i);var u=v.createColumnInfo(n);if(!Y&&n.customFormatter){u.customFormatter=n.customFormatter;u.fnGetDisplayControlName=function(){return a.DisplayControlType.CustomFormatter}}g.InsertColumnAt(r,u);m.UpdateColumns(g);v._jsGridControl.EnsurePaneWidth();v._jsGridControl.NotifyDataAvailable();t.ListSchema=e};b.runQuery(function(e){var t=v.InitContext(i,{},e),r=t.list.get_fields();E=r.getByInternalNameOrTitle(n.Name);t.context.load(E);t.context.executeQueryAsync()});return"break"}var S=b.createColumnInfo(n);if(!Y&&n.customFormatter){S.customFormatter=n.customFormatter;S.fnGetDisplayControlName=function(){return a.DisplayControlType.CustomFormatter}}g.InsertColumnAt(r,S);s=new u.Set;o=new u.Set;for(var x=n.ID,T=0;T<t.ListSchema.Field.length;T++)(f=t.ListSchema.Field[T].StaticName)&&f.indexOf(x)>=0&&s.Add(f);for(T=0;T<e.Field.length;T++)(f=e.Field[T].StaticName)&&f.indexOf(x)>=0&&o.Add(f);l=s.Difference(o);for(var N=0;N<t.ListSchema.Field.length;N++){c=t.ListSchema.Field[N];l.Contains(c.StaticName)&&g.RemoveColumn(c.RealFieldName)}h=o.Difference(s);for(var C=0;C<e.Field.length;C++){p=e.Field[C];if(h.Contains(p.StaticName)){d=b.createNewColumn(p);b._dataSource.AddColumn(d);var k=b.createColumnInfo(p);b._jsGridControl.AddColumn(k,d);b._jsGridControl.ShowColumn(p.RealFieldName)}}m.UpdateColumns(g);b._jsGridControl.EnsurePaneWidth();b._jsGridControl.NotifyDataAvailable();t.ListSchema=e;return{value:void 0}},b=this,w=0;w<t.ListSchema.Field.length;w++){var E=y(w);if("object"==typeof E)return E.value;if("break"===E)break}};t.prototype.deleteColumnInternal=function(e){for(var t=0;t<e.ListSchema.Field.length;t++)if(e.ListSchema.Field[t].RealFieldName===this._currentEditColumnInternalName){var n=this._jsGridControl._GetPaneManager(),r=n.GetGridPane().GetAllColumns(),i=e.ListSchema.Field[t],s=i.ID;r.RemoveColumn(i.RealFieldName);if("Location"===i.FieldType)for(var o=0;o<e.ListSchema.Field.length;o++){var u=e.ListSchema.Field[o].StaticName;u&&u.indexOf(s)>=0&&r.RemoveColumn(e.ListSchema.Field[o].RealFieldName)}n.UpdateColumns(r);this._jsGridControl.EnsurePaneWidth();this._jsGridControl.NotifyDataAvailable();break}};t.prototype.createNewColumn=function(e,t){var n=e.Name,r=i.JsGridConstants.FieldTypeToJsGridType[e.Type];if("Lookup"===r){var s=!0,u=[];if(t){s="false"===t.firstElementChild.getAttribute("FillInChoice").toLowerCase();var f=[];t.firstElementChild.children&&t.firstElementChild.children[0]&&t.firstElementChild.children[0].children&&(f=t.firstElementChild.children[0].children);if(f&&f.length>0)for(var l=0;l<f.length;l++)u.push({value:f[l].textContent,localString:f[l].textContent});else if(e.Choices)for(l=0;l<e.Choices.length;l++)u.push({value:e.Choices[l],localString:e.Choices[l]});"MultiChoice"===e.Type&&(e.AllowMultipleValues="1")}else if(e.Choices)for(l=0;l<e.Choices.length;l++)u.push({value:e.Choices[l],localString:e.Choices[l]});var c=n;"Choice"!==e.FieldType&&"MultiChoice"!==e.FieldType||(c=n+"_Choice");o.PropertyType.RegisterNewLookupPropType(c,u,a.DisplayControlType.CSR,s);r=c}var p,d=o.PropertyType.Internal.Property.GetInstance().GetPropType(r);if(d&&"SPDateTime"==d.ID){p=new h.GridField(n,!0,!0,null,null,null,!1,null);this._params.parseAndSetFields[n]=1}else p=new h.GridField(n,!0,!0);d&&"SPUser"==d.ID&&d.SetPeoplePickerDefaultSettings(n);if("1"==e.AllowMultipleValues){p.SetSingleValuePropType(d);p.SetIsMultiValue(";")}else p.SetSingleValuePropType(d);p.csrInfo=e;return p};t.prototype.createColumnInfo=function(e){var t=new h.ColumnInfo(e.DisplayName,null,e.RealFieldName,100),n=!("FALSE"===e.Filterable||"TRUE"===e.FilterDisable||"Note"===e.FieldType||"URL"===e.FieldType||"FileSizeDisplay"===e.Name||"_IsRecord"===e.Name),r=e.Name,i="TRUE"!==e.FromBaseType,s=e.FieldType,o="Calculated"===e.role;t.isFilterable=n;t.internalName=r;t.isEditable=i;t.fieldType=s;t.isCalculated=o;return t};t.prototype.PopulateAddNewColumnMenuItems=function(e,t){var n=this,r={propType:"SPUser",hasData:!0,hasLocalized:!0},i={propType:"String",hasData:!1,hasLocalized:!0},s={propType:"SPDateTime",hasData:!1,hasLocalized:!0},o={propType:"Location",hasData:!0,hasLocalized:!0},u={Text:{Desc:Strings.STS.L_AddColumnDefaultName_Text,FnOnClick:function(){n.AddNewColumn("Text",i,Strings.STS.L_AddColumnDefaultName_Text,t)}},Number:{Desc:Strings.STS.L_AddColumnDefaultName_Number,FnOnClick:function(){n.AddNewColumn("Number",i,Strings.STS.L_AddColumnDefaultName_Number,t)}},DateTime:{Desc:Strings.STS.L_AddColumnDefaultName_DateAndTime,FnOnClick:function(){n.AddNewColumn("DateTime",s,Strings.STS.L_AddColumnDefaultName_DateAndTime,t)}},User:{Desc:Strings.STS.L_AddColumnDefaultName_PersonOrGroup,FnOnClick:function(){n.AddNewColumn("User",r,Strings.STS.L_AddColumnDefaultName_PersonOrGroup,t)}},Location:{Desc:C.default.L_AddColumnDefaultName_Location,FnOnClick:function(){n.AddNewColumn("Location",o,C.default.L_AddColumnDefaultName_Location,t)}},MoreColumnTypes:{Desc:Strings.STS.L_AddColumnDefaultName_MoreColumnTypes,FnOnClick:function(){n.AddNewColumn("MoreColumnTypes",null,null,t)}}};for(var a in u){var f=u[a];e.InsertMenuItem({key:f.Desc,text:f.Desc,onClick:f.FnOnClick})}};t.prototype.PopulateAddNewColumnMenuItemsV2=function(e,t,n,i,s){var o=this,u={Text:{Desc:C.default.L_AddColumnDefaultName_Text,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Text,n,i)}},Note:{Desc:C.default.L_AddColumnDefaultName_Note,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Note,n,i)}},Location:{Desc:C.default.L_AddColumnDefaultName_Location,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Location,n,i)}},Number:{Desc:C.default.L_AddColumnDefaultName_Number,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Number,n,i)}},Boolean:{Desc:C.default.L_AddColumnDefaultName_Boolean,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Boolean,n,i)}},User:{Desc:C.default.L_AddColumnDefaultName_PersonOrGroup,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.User,n,i)}},DateTime:{Desc:C.default.L_AddColumnDefaultName_DateAndTime,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.DateTime,n,i)}},Choice:{Desc:C.default.L_AddColumnDefaultName_Choice,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Choice,n,i)}},URL:{Desc:C.default.L_AddColumnDefaultName_URL,FnOnClick:function(){o.onLaunchColumnManagementPanelActionWithLink(O.default.URL,n,i)}},Picture:{Desc:C.default.L_AddColumnDefaultName_Picture,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.URL,n,i)}},Currency:{Desc:C.default.L_AddColumnDefaultName_Currency,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Currency,n,i)}},Thumbnail:{Desc:C.default.L_AddColumnDefaultName_Thumbnail,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Thumbnail,n,i)}},MoreColumnTypes:{Desc:C.default.L_AddColumnDefaultName_MoreColumnTypes,FnOnClick:function(){o.onClickMoreColumnOptions()}}},a=[];for(var f in u){var l=u[f];if("Thumbnail"!==f||r.JsGridUtil.Internal.IsFeatureEnabled(H)){var c={key:l.Desc,text:l.Desc,onClick:l.FnOnClick};s||e.InsertMenuItem(c);a.push(c)}}return a};t.prototype.EditColumn=function(e,t,n,i){var s=this;if(r.JsGridUtil.Internal.IsFeatureEnabled(F)){this._currentEditColumnInternalName=i;e.InsertMenuItem({key:"ColumnManagement",text:C.default.L_EditColumn,onClick:function(){s._ensureExternalJsFilesLoaded(function(){t({editField:{fieldName:i,fieldType:O.default[n]},isHyperlink:"Hyperlink"===n.toString()},s.editColumnOnCompleteCallback)})}})}};t.prototype.OnNextPage=function(e){var t=this._jsGridControl.GetTopRowIndex(),n=this._jsGridControl.GetVisibleRecordCount(),r=t+n-1;if(r!=this._params.totalItemCount){var i=r+n;this._jsGridControl.ScrollCellIntoView(Math.min(i,this._params.totalItemCount))}};t.prototype.ResolveAutoFilterState=function(e){var t=1;for(var n in e){var i="FilterField",s="FilterValue";if(-1!==e[n].indexOf(";#")){i="FilterFields";s="FilterValues"}null==this._filterUrl&&(this._filterUrl="");this._filterUrl+="&"+i+t+"="+r.JsGridUtil.Internal.EscapeProperly(n)+"&"+s+t+"="+r.JsGridUtil.Internal.EscapeProperly(e[n]);t++}};t.prototype.OnAutoFilter=function(e){this._filterUrl=null;this._pagingInfo=null;this.ResolveAutoFilterState(e);this.ClearItemInfoPresent();this._dataSource.RefreshRowView(!1,this.RefreshRowView.bind(this))};t.prototype.GetAutoFilterEntries=function(e,t,n,i,s){var o,u=document.getElementById(this._params.iframeId),a="",f=0,l=this._params.filterLink;l||(l=null!=this._params.spCsrRenderCtx?this._params.spCsrRenderCtx.queryString:window.location.href);do{f++;null!=(o=l.match("FilterField"+f+"=[^&]*&FilterValue"+f+"=[^&]*"))&&(a=a+"&"+o)}while(o);var c=l.match("MembershipGroupId=[^&]*");null!=c&&(a+="&"+c);var h=l.match("RootFolder=[^&]*");null!=h&&(a+="&"+h);var p=l.match("InstanceID=[^&]*");null!=p&&(a+="&"+p);this._autoFilterContext={FieldName:t,OnSuccess:i,OnFailure:s};u.src=this._params.siteUrl+"/_layouts/15/filter.aspx?ListId="+this._params.listId+"&FieldInternalName="+r.JsGridUtil.Internal.EscapeProperly(t)+"&ViewId="+this._params.viewId+"&FilterOnly=1&Filter=1"+a+"&CallbackFn=OnJsGridIframeLoad&CallbackParam="+this._jsGridControl.parentNode.id};t.prototype.OnAutoFilterReturn=function(){var e;if(null!=(e=document.getElementById(this._params.iframeId))){var t=null;e.contentDocument?t=e.contentDocument:e.contentWindow&&e.contentWindow.document?t=e.contentWindow.document:e.document&&(t=e.document);if(null!=t){var n=t.getElementById("diidFilter"+this._autoFilterContext.FieldName);if(null!=n){var r=n.childNodes.length;if(r<=500){for(var i=n.childNodes,s=void 0,o=[],u=1;u<r;u++){s=i[u].innerText?i[u].innerText:i[u].textContent?i[u].textContent:i[u].innerHTML;o.push({displayString:s,dataValue:i[u].value})}var a={};a[this._autoFilterContext.FieldName]=o;this._autoFilterContext.OnSuccess(a);this._autoFilterContext=null;return}}}}this._autoFilterContext.OnFailure();this._autoFilterContext=null};t.prototype.LaunchFilterDialog=function(e){alert("launch filter dialog here")};t.prototype.WriteChangesToList=function(){if(this._jsGridControl.paneMgr.gridPane.dontReflow){this._jsGridControl.paneMgr.gridPane.dontReflow=!1;this._jsGridControl.paneMgr.gridPane.ScrollCellIntoView(this._jsGridControl.paneMgr.gridPane.afterReflowScrollGoal,0)}null!=this._serverWriteTimeout&&clearTimeout(this._serverWriteTimeout);this._serverWriteTimeout=$?setTimeout(this.WriteChangesToListCore.bind(this),500):setTimeout(this.BatchedWriteChangesToListCore.bind(this),500)};t.prototype.RetrieveCSRData=function(e,t){var n=null,r=this._jsGridControl.GetSpCsrRenderCtx();if(null!=r){for(var i=['<FieldRef Name="ID"/>'],s=r.ListSchema.Field,o=0;o<s.length;o++)i.push('<FieldRef Name="'+s[o].Name+'"/>');var u=[],a=0,f=0;for(var l in e){a++;u.push(["<Eq>",'<FieldRef Name="ID" />','<Value Type="Number">',l,"</Value>","</Eq>"].join(""));if(a>1){u.push("</Or>");f++}}for(var c=[];f>0;){c.push("<Or>");f--}u=c.concat(u).join("");var h=['<View Scope="RecursiveAll">',"<ViewFields>"].concat(i).concat(["</ViewFields>","<Query>","<OrderBy>",'<FieldRef Name="ID"/>',"</OrderBy>","<Where>"]).concat(u).concat(["</Where>","</Query>","</View>"]).join("");n=t.renderListData(h)}return n};t.prototype.HandleCSRData=function(e,t,n){for(var i=e.get_value(),s=JSON.parse(i),o=null,u=0;u<s.Row.length;u++)if(s.Row[u].ID==n){o=s.Row[u];break}r.JsGridUtil.DebugAssert(null!=o,"Should be able to find the row we're querying for");this._jsGridControl.GetRecord(t).fieldRawDataMap.csrInfo=o;var a=this._jsGridControl.GetSpCsrRenderCtx();a.ListData=S.MergeListData(a.ListData,s)};t.prototype.PostCSRRender=function(){this._jsGridControl.GetSpCsrRenderCtx()};t.prototype.GetMostRecentChangeKey=function(e){var t=null;for(var n in e){var r=e[n].changeKey;t=null==t||r.GetVersionNumber()>t.GetVersionNumber()?r:t}return t};t.prototype.SetErrorFromCSOMException=function(e,t,n,s,o){var u=null;switch(t){case i.JsGridConstants.ClientErrorCodes.InvalidFieldValue:this._jsGridControl.SetCellError(e,n.split(",")[1],s);break;case i.JsGridConstants.ClientErrorCodes.DocAlreadyExists:this._jsGridControl.SetCellError(e,"Title",SP.Res.docAlreadyExists);break;case i.JsGridConstants.ClientErrorCodes.FieldValueFailedValidation:var a=o.get_fieldFailures();r.JsGridUtil.DebugAssert(a.length>0);for(var f=0;f<a.length;f++)this._jsGridControl.SetCellError(e,a[f].get_name(),a[f].get_message());break;case i.JsGridConstants.ClientErrorCodes.ItemValueFailedValidation:var l=o.get_itemFailure(),c=l?l.get_message():s;u=this.SetRowLevelError(e,c,!1);break;default:u=this.SetRowLevelError(e,s,!1)}return u};t.prototype.WriteChangesToListCore=function(){var e=this,t=function(){for(var t in o){var n=f[t].scope;if(n.get_hasException()){e.SetErrorFromCSOMException(t,n.get_serverErrorCode(),n.get_serverErrorValue(),n.get_errorMessage(),n.get_serverErrorDetails());for(var a in e._changesBeingSent[t])e._fnCallbacksByChangeKey.CallFunctions(e._changesBeingSent[t][a].changeKey.GetVersionNumber(),!1)}else{var l=f[t].item,h=l.get_fieldValuesAsText().get_fieldValues();null!=e._jsGridControl.GetSpCsrRenderCtx()&&e.HandleCSRData(u,t,l.get_id());var p=e._changesBeingSent[t],d=e.GetMostRecentChangeKey(p),v={};for(var a in e._gridFieldMap)if(a in h){var m=p[a]&&p[a].changeKey,g=e._gridFieldMap[a].csrInfo?e._gridFieldMap[a].csrInfo.StaticName:"",y=!1;for(var b in p)if(0===g.indexOf(e._gridFieldMap[b].csrInfo.ID)){y=!0;break}var w=null!=m;if(w||y||a in e._params.computedFields){var E=e.SPListValueToGridValue(l.get_item(a),l.get_fieldValuesAsText().get_item(a),e._gridFieldMap[a].GetPropType(),a),S=c.CreateValidatedPropertyUpdate(t,a,E&&E.data,E&&E.localized);e._cascadingChangeKey=w?m:d;e._jsGridControl.UpdateProperties([S],null,e._cascadingChangeKey);if(w){e._cascadingChangeKey.Release();var x=void 0;if("SPDateTime"==e._gridFieldMap[a].GetPropType().ID){x=null==l.get_item(a)?h[a]:SP.DateTimeUtil.IntlDate.createFromJsUtcDate(E.data,r.JsGridUtil.SpRegionalSettings.calendarType).toJsDate()._toFormattedString("s",JSON.parse(i.JsGridConstants.SUPERTEMPORARY_invariantCultureStringify))}else x=h[a];v[a]={localizedValue:x}}e._cascadingChangeKey=null}}for(var a in p)e._fnCallbacksByChangeKey.CallFunctions(p[a].changeKey.GetVersionNumber(),!0,l.get_id());e._jsGridControl.GetRecord(t);for(var T=0;T<e._fnRowChanged.length;T++)e._fnRowChanged[T](t,v,!1);delete e._changesBeingSent[t];e.ClearRowLevelError(t)}}s(o);e.PostCSRRender()},n=function(t,n){for(var r in o)e.SetRowLevelError(r,SP.Res.serverCommError,!0);for(var r in e._changesBeingSent)for(var i in e._changesBeingSent[r])e._fnCallbacksByChangeKey.CallFunctions(a[i].changeKey.GetVersionNumber(),!1);s(o)},s=function(t){e._currentlyWritingChangesToList=!1;e._queuedWriteChangesRequest&&setTimeout(e.WriteChangesToList.bind(e),0);for(var n in t)e._jsGridControl.RemoveRowHeaderState(n,i.JsGridConstants.RowHeaderStyleId.Transfer);if(r.JsGridUtil.Internal.IsAssocArrayEmpty(e._changesToSend))e._changesToSend=e._changesBeingSent;else for(var n in e._changesBeingSent)if(null==e._changesToSend[n])e._changesToSend[n]=e._changesBeingSent[n];else for(var s in e._changesBeingSent[n]){null!=e._changesToSend[n][s]&&e._changesToSend[n][s].changeKey.Release();e._changesToSend[n][s]=e._changesBeingSent[n][s]}e._changesBeingSent=null},o=this.GetRecordKeysToSend();if(!r.JsGridUtil.Internal.IsAssocArrayEmpty(o)&&(function(t){if(e._currentlyWritingChangesToList){e._queuedWriteChangesRequest=!0;return!1}e._currentlyWritingChangesToList=!0;e._queuedWriteChangesRequest=!1;for(var n in t){e._jsGridControl.RemoveRowHeaderState(n,i.JsGridConstants.RowHeaderAutoStyleId.Dirty);e._jsGridControl.AddBuiltInRowHeaderState(n,i.JsGridConstants.RowHeaderStyleId.Transfer)}e._changesBeingSent=e._changesToSend;e._changesToSend={};return!0})(o)){var u,a,f={};this._ensureExternalJsFilesLoaded(function(){e.runQuery(function(r){var i=e.InitContext(t,n,r);for(var s in o){var l=new SP.ExceptionHandlingScope(i.context),c=l.startScope(),h=i.list.getItemById(s);a=e._changesBeingSent[s];for(var p in a){var d=a[p],v=e.GridValueToSPListValue(d.newProp,d.propType);if(p in e._params.parseAndSetFields){h.parseAndSetFieldValue(p,v);null!=e._params.spCsrRenderCtx&&106===e._params.spCsrRenderCtx.ListTemplateType&&("EndDate"===p&&!a.EventDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EventDate?h.parseAndSetFieldValue("EventDate",e._params.spCsrRenderCtx.CurrentItem.EventDate):"EventDate"===p&&!a.EndDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EndDate&&h.parseAndSetFieldValue("EndDate",e._params.spCsrRenderCtx.CurrentItem.EndDate))}else if(null==d.propType||"TaxonomyField"!=d.propType.ID&&"TaxonomyField_MultiValue"!=d.propType.ID)h.set_item(p,v);else{i.list.get_fields().getByInternalNameOrTitle(p).validateSetValue(h,v)}}h.update();h.get_fieldValuesAsText().retrieve();h.retrieve();c.dispose();f[s]={item:h,scope:l}}u=e.RetrieveCSRData(o,i.list);i.context.executeQueryAsync()});var r=Object.keys(o);p.EventGroup.raise(document,b.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:r});e._logEngagement("QuickEdit.WriteChangesToListCore",{itemIds:r})})}};t.prototype.BatchedWriteChangesToListCore=function(){var e=this,t=this.GetRecordKeysToSend();if(!r.JsGridUtil.Internal.IsAssocArrayEmpty(t)&&(function(t){if(e._currentlyWritingChangesToList){e._queuedWriteChangesRequest=!0;return!1}e._currentlyWritingChangesToList=!0;e._queuedWriteChangesRequest=!1;for(var n in t){e._jsGridControl.RemoveRowHeaderState(n,i.JsGridConstants.RowHeaderAutoStyleId.Dirty);e._jsGridControl.AddBuiltInRowHeaderState(n,i.JsGridConstants.RowHeaderStyleId.Transfer)}e._changesBeingSent=e._changesToSend;e._changesToSend={};return!0})(t)){var n=Object.keys(t),s=0;this._ensureExternalJsFilesLoaded(function(){for(var o=function(o){var u;J||(u=new(e._telemetry(x.Qos))({name:te}));for(var a={},f=0;f<50&&o+f<n.length;f++){var l=n[o+f];a[l]=t[l]}var h,d,v=function(){s+=Object.keys(a).length;for(var o in a){var f=y[o].scope;if(f.get_hasException()){e.SetErrorFromCSOMException(o,f.get_serverErrorCode(),f.get_serverErrorValue(),f.get_errorMessage(),f.get_serverErrorDetails());for(var l in e._changesBeingSent[o])e._fnCallbacksByChangeKey.CallFunctions(e._changesBeingSent[o][l].changeKey.GetVersionNumber(),!1)}else{var p=y[o].item,d=p.get_fieldValuesAsText().get_fieldValues();null!=e._jsGridControl.GetSpCsrRenderCtx()&&e.HandleCSRData(h,o,p.get_id());var v=e._changesBeingSent[o],m=e.GetMostRecentChangeKey(v),b={};for(var l in e._gridFieldMap)if(l in d){var w=v[l]&&v[l].changeKey,E=e._gridFieldMap[l].csrInfo?e._gridFieldMap[l].csrInfo.StaticName:"",S=!1;for(var T in v)if(0===E.indexOf(e._gridFieldMap[T].csrInfo.ID)){S=!0;break}var N=null!=w;if(N||S||l in e._params.computedFields){var C=e.SPListValueToGridValue(p.get_item(l),p.get_fieldValuesAsText().get_item(l),e._gridFieldMap[l].GetPropType(),l),k=c.CreateValidatedPropertyUpdate(o,l,C&&C.data,C&&C.localized);e._cascadingChangeKey=N?w:m;e._jsGridControl.UpdateProperties([k],null,e._cascadingChangeKey);if(N){e._cascadingChangeKey.Release();var L=void 0;if("SPDateTime"==e._gridFieldMap[l].GetPropType().ID){L=null==p.get_item(l)?d[l]:SP.DateTimeUtil.IntlDate.createFromJsUtcDate(C.data,r.JsGridUtil.SpRegionalSettings.calendarType).toJsDate()._toFormattedString("s",JSON.parse(i.JsGridConstants.SUPERTEMPORARY_invariantCultureStringify))}else L=d[l];b[l]={localizedValue:L}}e._cascadingChangeKey=null}}for(var l in v)e._fnCallbacksByChangeKey.CallFunctions(v[l].changeKey.GetVersionNumber(),!0,p.get_id());e._jsGridControl.GetRecord(o);for(var A=0;A<e._fnRowChanged.length;A++)e._fnRowChanged[A](o,b,!1);delete e._changesBeingSent[o];e.ClearRowLevelError(o)}}s>=n.length&&g(t);e.PostCSRRender();J||u.end({resultType:x.ResultTypeEnum.Success})},m=function(r,i){s+=Object.keys(a).length;for(var o in a)e.SetRowLevelError(o,SP.Res.serverCommError,!0);if(s>=n.length){for(var o in e._changesBeingSent)for(var f in e._changesBeingSent[o])e._fnCallbacksByChangeKey.CallFunctions(d[f].changeKey.GetVersionNumber(),!1);g(t)}J||u.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToWriteChange",error:SP.Res.serverCommError})},g=function(t){e._currentlyWritingChangesToList=!1;e._queuedWriteChangesRequest&&setTimeout(e.WriteChangesToList.bind(e),0);for(var n in t)e._jsGridControl.RemoveRowHeaderState(n,i.JsGridConstants.RowHeaderStyleId.Transfer);if(r.JsGridUtil.Internal.IsAssocArrayEmpty(e._changesToSend))e._changesToSend=e._changesBeingSent;else for(var n in e._changesBeingSent)if(null==e._changesToSend[n])e._changesToSend[n]=e._changesBeingSent[n];else for(var s in e._changesBeingSent[n]){null!=e._changesToSend[n][s]&&e._changesToSend[n][s].changeKey.Release();e._changesToSend[n][s]=e._changesBeingSent[n][s]}e._changesBeingSent=null},y={},w={};e.runQuery(function(t){var n=e.InitContext(v,m,t);for(var r in a){var i=new SP.ExceptionHandlingScope(n.context),s=i.startScope(),o=n.list.getItemById(r);d=e._changesBeingSent[r];for(var u in d){if(!G){var f=e.GetCSRFieldFromJsGridFieldKey(u);f&&f.FieldType&&(w.hasOwnProperty(f.FieldType)?w[f.FieldType]++:w[f.FieldType]=1)}var l=d[u],c=e.GridValueToSPListValue(l.newProp,l.propType);if(u in e._params.parseAndSetFields){o.parseAndSetFieldValue(u,c);null!=e._params.spCsrRenderCtx&&106===e._params.spCsrRenderCtx.ListTemplateType&&("EndDate"===u&&!d.EventDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EventDate?o.parseAndSetFieldValue("EventDate",e._params.spCsrRenderCtx.CurrentItem.EventDate):"EventDate"===u&&!d.EndDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EndDate&&o.parseAndSetFieldValue("EndDate",e._params.spCsrRenderCtx.CurrentItem.EndDate))}else if(null==l.propType||"TaxonomyField"!=l.propType.ID&&"TaxonomyField_MultiValue"!=l.propType.ID)o.set_item(u,c);else{n.list.get_fields().getByInternalNameOrTitle(u).validateSetValue(o,c)}}o.update();o.get_fieldValuesAsText().retrieve();o.retrieve();s.dispose();y[r]={item:o,scope:i}}h=e.RetrieveCSRData(a,n.list);n.context.executeQueryAsync()});var E=Object.keys(a);p.EventGroup.raise(document,b.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:E});G?e._logEngagement("QuickEdit.WriteChangesToListCore",{itemIds:E}):e._logEngagement("QuickEdit.WriteChangesToListCore",{itemIds:E,fieldTypes:w})},u=0;u<n.length;u+=50)o(u)})}};t.prototype._ensureExternalJsFilesLoaded=function(e){if(!V&&r.JsGridUtil.Internal.IsFeatureEnabled(B)){var t=[r.JsGridUtil.taxonomyLoadCallback],n=this._params.siteUrl+"/",s=i.JsGridConstants.csomFiles.map(function(e){return n+e});r.JsGridUtil.csomJsFilesLoader._ensureExternalJsFilesLoaded(s,e,t)}else e()};t.prototype.SetRowLevelError=function(e,t,n){this.ClearRowLevelError(e);var r=this._jsGridControl.SetRowError(e,t);this._rowLevelErrors[e]={id:r,bCommunicationsError:n};return r};t.prototype.ClearRowLevelError=function(e){if(e in this._rowLevelErrors){this._jsGridControl.ClearRowError(e,this._rowLevelErrors[e].id);delete this._rowLevelErrors[e]}};t.prototype.SetItemInfoPresent=function(e){for(var t=this._jsGridControl._GetPaneManager().GetGridPane().GetGridPaneConverter(),n=Math.min(e+this._params.viewRowLimit,this._infoFetched.length),r=e;r<n;r++)this._infoFetched[r]=t.RowIdxToRecordKey(r)};t.prototype.ClearItemInfoPresent=function(){this._infoFetched=new Array(this._params.totalItemCount)};t.prototype.ComputeSPDataRange=function(e){var t,n={pos:-1,count:0},r={rangesToFillRequest:1,totalRanges:[]},i=this._params.viewRowLimit,s=this._params.totalItemCount,o=this._jsGridControl.GetTopRowIndex(),u=this._jsGridControl.GetVisibleRecordCount(),a=Math.min(o+u,s);for(t=o;t<a;t++)if(!this._infoFetched[t]){n.pos=t;break}if(t==o)for(var f=a;f>=o;f--)if(!this._infoFetched[f]){n.pos=Math.max(0,f-i+1);for(;n.pos<this._infoFetched.length&&this._infoFetched[n.pos];)n.pos++;break}n.callbacks=[e];n.count=Math.min(s-n.pos,i);r.totalRanges.push(n);return r};t.prototype.CreateEntryRecord=function(){return this._dataSource.recordFactory.MakeRecord({},{})};t.prototype.CreateNewListItem=function(e,t,n,r){var s,o,u=this;if(this._jsGridControl.paneMgr.gridPane.dontReflow){this._jsGridControl.paneMgr.gridPane.dontReflow=!1;this._jsGridControl.paneMgr.gridPane.ScrollCellIntoView(this._jsGridControl.paneMgr.gridPane.afterReflowScrollGoal,0)}J||(o=new(this._telemetry(x.Qos))({name:oe}));var a=function(){var r=s.get_fieldValues(),a=s.get_fieldValuesAsText().get_fieldValues();r&&r.ID&&p.EventGroup.raise(document,b.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:[r.ID]});var f=function(s){var f={},l={},c=w.Killswitch.isActivated("EC4AE4F1-A4D6-4A7D-B010-0F14A2EFA541","10/15/2019","Fix issue with sending raw CSOM objects down into cell renderers.");for(var h in u._gridFieldMap)if(h in r){var p=null==e[h]?null:u.SPListValueToGridValue(c?r[h]:e[h].data,c?a[h]:e[h].value,u._gridFieldMap[h].GetPropType(),h);p&&p.hasOwnProperty("data")&&(l[h]=p.data);p&&p.hasOwnProperty("localized")&&(f[h]=p.localized)}var d=s.get_id();l.ID=f.ID=d;l.ContentType=f.ContentType=s.get_contentType().get_name();l.Edit=i.JsGridConstants.SPGPermissions.editListItems|i.JsGridConstants.SPGPermissions.deleteListItems;u._jsGridControl.RemoveRowHeaderState(e.key(),i.JsGridConstants.RowHeaderStyleId.Transfer);null!=n&&n(d,f,l);u._currentlyCreatingNewListItem=!1;u._jsGridControl.GetRecord(d);for(h=0;h<u._fnRowChanged.length;h++)u._fnRowChanged[h](d,f,!1);if(null!=t)for(var v=0;v<t.length;v++)u._fnCallbacksByChangeKey.CallFunctions(t[v].changeKey.GetVersionNumber(),!0,d);J||o.end({resultType:x.ResultTypeEnum.Success})},l=u._jsGridControl.GetSpCsrRenderCtx();null!=l?(function(e,t){u.runQuery(function(n){var r=u.InitContext(function(){u.HandleCSRData(s,t.recordKey,e.get_id());f(e);var n=t.fieldRawDataMap.csrInfo;l.ListData.Row.push(n);u.PostCSRRender()},void 0,n),i={};i[e.get_id()]=1;var s=u.RetrieveCSRData(i,r.list);r.context.executeQueryAsync()})})(s,e):f(s)},f=function(n,s,a){u._jsGridControl.RemoveRowHeaderState(e.key(),i.JsGridConstants.RowHeaderStyleId.Transfer);var f=a;null!=s&&(f=u.SetErrorFromCSOMException(e.key(),s.get_errorCode(),s.get_errorValue(),s.get_message(),s.get_errorDetails()));null!=r&&r(s&&s.get_message(),f);u._currentlyCreatingNewListItem=!1;if(null!=t)for(var l=0;l<t.length;l++)u._fnCallbacksByChangeKey.CallFunctions(t[l].changeKey.GetVersionNumber(),!1);J||o.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToCreateItem",error:s&&s.get_message()})};this._jsGridControl.RemoveRowHeaderState(e.key(),i.JsGridConstants.RowHeaderAutoStyleId.Dirty);this._jsGridControl.AddBuiltInRowHeaderState(e.key(),i.JsGridConstants.RowHeaderStyleId.Transfer);var l={},c={};if(null!=t)for(var h=0;h<t.length;h++){c[t[h].fieldKey]=t[h];l[t[h].fieldKey]=t[h].newProp}var d=(function(t){var n,r=!1,i=null,s=function(t){null==u._jsGridControl.GetColumnByFieldKey(t)?i=u.SetRowLevelError(e.recordKey,SP.Res.requiredFieldNotInEditView,!1):u._jsGridControl.SetCellError(e.recordKey,t,SP.Res.requiredField15);r=!0};for(var o in u._params.requiredFields)(null==(n=t[o])||n.HasLocalizedValue()&&(""==n.localized||null==n.localized)||n.HasDataValue()&&null==n.data)&&s(o);if(null!=e.fieldRawDataMap&&null!=e.fieldRawDataMap._ContentTypeId){var a=e.fieldRawDataMap._ContentTypeId;if(null!=a&&a in u._params.contentTypes)for(var f=u._params.contentTypes[a].RequiredFields,l=0;l<f.length;l++){(null==(n=t[o=f[l]])||n.HasLocalizedValue()&&(""==n.localized||null==n.localized)||n.HasDataValue()&&null==n.data)&&s(o)}}return{fieldsMissing:r,errorId:i}})(l);d.fieldsMissing?f(0,null,d.errorId):this._ensureExternalJsFilesLoaded(function(){u.runQuery(function(e){var t,n=u.InitContext(a,f,e);null!=u._params.viewRootFolder&&(t=new SP.ListItemCreationInformation).set_folderUrl(u._params.viewRootFolder);s=n.list.addItem(t);for(var r in c){var i=c[r],o=u.GridValueToSPListValue(i.newProp,i.propType);if(r in u._params.parseAndSetFields)s.parseAndSetFieldValue(r,o);else if(null==i.propType||"TaxonomyField"!=i.propType.ID&&"TaxonomyField_MultiValue"!=i.propType.ID)s.set_item(r,o);else{n.list.get_fields().getByInternalNameOrTitle(r).validateSetValue(s,o)}}s.update();s.get_fieldValuesAsText().retrieve();s.retrieve();s.get_contentType().retrieve();n.context.executeQueryAsync();u._currentlyCreatingNewListItem=!0})})};t.prototype.InitContext=function(e,t,n){var r=this,i=new SP.ClientContext(this._isUsingDataSync&&n&&n.url||this._params.siteUrl);i.add_requestSucceeded(function(t,i){setTimeout(function(){r._isUsingDataSync&&n&&n.client.onRequestComplete({succeeded:!0,endpoint:n});e(t,i)},0)});i.add_requestFailed(function(e,i){setTimeout(function(){r._isUsingDataSync&&n&&n.client.onRequestComplete({succeeded:!1,endpoint:n});t&&t(e,i)},0)});this._isUsingDataSync&&n&&n.authToken&&i.add_executingWebRequest(function(e,t){t.get_webRequest().get_headers().Authorization=n.authToken});var s=i.get_web(),o=s.get_lists().getById(this._params.listId),u=o.get_views().getById(this._params.viewId);return{context:i,web:s,list:o,view:u}};t.prototype.InitSPListValueConversion=function(e){var t=this;this._GridValueToSPListValueConverters.Hyperlink=function(e){if(null==e.data)return null;var t=new SP.FieldUrlValue;t.set_url(e.data.address);t.set_description(e.data.display);return t};this._SPListValueToGridValueConverters.Hyperlink=function(e,t,n){return null==e?null:{data:{address:e.get_url(),display:e.get_description()},localized:e.get_description()}};this._SPListValueToGridValueConverters.SPEnhancedRichText=function(e,t,n){return null==e||""==e?null:{data:e,localized:e}};this._GridValueToSPListValueHelper=function(e){return K?null!=e&&e.hasOwnProperty("email")&&""!==e.email?-1==e.email.indexOf("@")&&e.email!==e.display?e.email+";#"+e.display:"-1;#"+e.email:"-1;#"+e.display:null!=e&&e.hasOwnProperty("email")&&e.email?-1==e.email.indexOf("@")&&e.email!==e.display?e.email+";#"+e.display:"-1;#"+e.email:"-1;#"+e.display};this._GridValueToSPListValueConverters.SPUser=function(e){var n=e.data;!ee&&n&&t.isArray(n)&&(n=0===n.length?null:n[0]);var i=null==n||n==r.JsGridUtil.EmptyValue?"":t._GridValueToSPListValueHelper(n);return""!==i?i:null==e.localized||""==e.localized?null:"-1;#"+e.localized};this._SPListValueToGridValueConverters.SPUser=function(e,t,n){if(ee)return{data:[e],localized:e.get_lookupValue()};var r=he(e);return{data:[r],localized:r.display}};this._GridValueToSPListValueConverters.SPUser_MultiValue=function(e){var n=e.localized,i=e.data,s="";if(!(null==i||i==r.JsGridUtil.EmptyValue))if(i.hasOwnProperty("email"));else if("undefined"!==i.length)for(var o=0;o<i.length;o++){s=s+(""==s?"":";#")+t._GridValueToSPListValueHelper(i[o])}return""!==s?s:null==n||""==n?null:"-1;#"+r.JsGridUtil.Internal.TokenizeString(n,";").join(";#-1;#")};this._SPListValueToGridValueConverters.SPUser_MultiValue=function(e,t,n){var r=[];if(ee){for(s=0;s<e.length;s++)r.push(e[s].get_lookupValue());return{data:e,localized:r.join("; ")}}for(var i=[],s=0;s<e.length;s++){var o=he(e[s]);i.push(o);r.push(o.display)}return{data:i,localized:r.join("; ")}};this._GridValueToSPListValueConverters.Location=function(e){return e.data?JSON.stringify(e.data):null};this._SPListValueToGridValueConverters.Location=function(e,t,n){var r=JSON.parse(e);return{data:r,localized:r.DisplayName}};this._GridValueToSPListValueConverters.DropdownBoolean=function(e){return e.data?1:0};this._SPListValueToGridValueConverters.SPDateTime=function(e,t,n){return{data:new Date(e.valueOf()+60*r.JsGridUtil.SpRegionalSettings.timeZoneInHours*60*1e3),localized:t}};var n=function(e){return e.data&&e.data+";#"},i=function(e,t,n){return{data:e.get_lookupId(),localized:t}},s=function(e){return e.data&&e.data.join(";#;#")+";#"},o=function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(e[i].get_lookupId());return{data:r,localized:t}};for(var u in e){var a=u+"_Lookup";this._GridValueToSPListValueConverters[a]=n;this._SPListValueToGridValueConverters[a]=i;a=u+"_Lookup_MultiValue";this._GridValueToSPListValueConverters[a]=s;this._SPListValueToGridValueConverters[a]=o}};t.prototype.RegisterSPListValueToGridValueConverter=function(e,t){this._SPListValueToGridValueConverters[e]=t};t.prototype.RegisterGridValueToSPListValueConverter=function(e,t){this._GridValueToSPListValueConverters[e]=t};t.prototype.GridValueToSPListValue=function(e,t){var n;return""===(n=null==t?e.HasDataValue()?e.data:e.localized:null!=this._GridValueToSPListValueConverters[t.ID]?this._GridValueToSPListValueConverters[t.ID](e):t.bMultiValue?t.LocStrToLocStrArray(e.localized).join(";#"):e.localized)?null:n};t.prototype.SPListValueToGridValue=function(e,t,n,i){return null==e?null:n&&null!=this._SPListValueToGridValueConverters[n.ID]?this._SPListValueToGridValueConverters[n.ID](e,t,i):{data:e,localized:n&&n.bMultiValue?n.LocStrArrayToLocStr(this.isArray(e)?e:r.JsGridUtil.Internal.TokenizeString(e,";#")):t}};t.prototype.isArray=function(e){return e&&e.constructor==Array};t.prototype.GetGanttBarDate=function(e,t,n){var r,s=e.GetDataValue(this._params.startColumnName),o=e.GetDataValue(this._params.finishColumnName);if(null!=s&&null!=o&&s>o){var u=s;s=o;o=u}if(n==i.JsGridConstants.GanttBarDateType.End&&1==t&&null!=s&&null!=o){var a=null!=this._params.pctCompleteColumnName?e.GetDataValue(this._params.pctCompleteColumnName):null;a=Math.min(null==a?0:a,1);if(isNaN(a))r=null;else{o instanceof Date||(o=new Date(o));s instanceof Date||(s=new Date(s));var f=Math.abs(o.getTime()-s.getTime());r=0!==a?new Date(s.getTime()+f*a):null}}else r=n==i.JsGridConstants.GanttBarDateType.Start?s:o;return r};t.prototype.GetPredecessors=function(e,t){if(null==t)return null;for(var n=[],r=0;r<t.length;r++)n.push({key:t[r],type:i.JsGridConstants.LinkType.FinishStart});return n};t.prototype.GetFieldReadOnlyActiveState=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t||null==t.GridActiveAndReadOnly?null:"TRUE"==t.GridActiveAndReadOnly?i.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive:i.JsGridConstants.ReadOnlyActiveState.ReadOnlyDisabled};t.prototype.GetFieldEditMode=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t?i.JsGridConstants.EditMode.ReadOnly:(w.Killswitch.isActivated("ae71ac90-2661-4917-9476-c1542f2e6849","12/23/2019","Make new image columns read only in quick edit")||"Thumbnail"!==t.FieldType||"Thumbnail"===t.RealFieldName||"ThumbnailOnForm"===t.RealFieldName)&&"TRUE"==t.AllowGridEditing&&"TRUE"!==t.ReadOnly&&"1"!==t.XSLRender?i.JsGridConstants.EditMode.ReadWriteDefer:i.JsGridConstants.EditMode.ReadOnly};t.prototype.GetRecordEditMode=function(e){return e.GetDataValue("Edit")&i.JsGridConstants.SPGPermissions.editListItems?i.JsGridConstants.EditMode.ReadWriteDefer:i.JsGridConstants.EditMode.ReadOnly};t.prototype.ShouldLinkTitleCell=function(e,t,n,r){return null!=e.GetDataValue("_FolderLink")};t.prototype.OnTitleCellContentsClicked=function(e,t,n,i){var s=SP.Utilities.UrlBuilder.urlCombine(SP.PageContextInfo.get_webServerRelativeUrl(),e.GetDataValue("_FolderLink"));window.location.href=SP.Utilities.UrlBuilder.urlCombine(SP.PageContextInfo.get_webServerRelativeUrl(),this._params.viewUrl+"?RootFolder="+r.JsGridUtil.Internal.EscapeProperly(s)+"&FolderCTID="+this._params.folderContentTypeId)};t.prototype.OnEditCellContentsClicked=function(e,t,n,i){var s=GetCurrentCtx().editFormUrl,o=-1==s.indexOf("?")?"?":"&";window.location.href=s+o+"ID="+e.GetDataValue("ID")+"&Source="+r.JsGridUtil.Internal.EscapeProperly(window.location.href)};t.prototype.DeleteSelectedRecords=function(e){for(var t=this._jsGridControl.GetSelectedRecordKeys(),n=!1,r=0;r<t.length;r++)if(t[r]==e){n=!0;break}n&&0!=t.length||null==e||(t=[e]);this.DeleteItems(t)};t.prototype.IsParent=function(e){return!1};t.prototype.DeleteItems=function(e,t){var n,s=this,o=[];J||(n=new(this._telemetry(x.Qos))({name:re}));var u=function(e){return function(){for(var e=0;e<o.length;e++)for(var r=o[e],i=s._jsGridControl.GetRecord(r),u=0;u<s._fnRowChanged.length;u++)s._fnRowChanged[u](r,i.properties,!0);null!=o&&s._jsGridControl.DeleteRecords(o);s._currentlyDeletingListItems=!1;null!=t&&t(!0);J||n.end({resultType:x.ResultTypeEnum.Success})}},a=function(e){return function(){e&&alert(SP.Res.deleteFailed);s._currentlyDeletingListItems=!1;null!=t&&t(!1);J||n.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToDeleteItemsd",error:SP.Res.deleteFailed})}};this._ensureExternalJsFilesLoaded(function(){for(var n=0;n<e.length;n++)s._jsGridControl.IsEntryRecordKey(e[n])||o.push(e[n]);var f=[];for(n=0;n<o.length;n++)s._jsGridControl.IsProvisionalRecordKey(o[n])?s._jsGridControl.DeleteRecords([o[n]]):f.push(o[n]);for(n=0;n<o.length;n++){var l=o[n];null!=s._changesToSend[l]&&delete s._changesToSend[l]}var c=s._jsGridControl.GetSpCsrRenderCtx();if(null==c){if(null!=s._jsGridControl.DeleteRecords(o))if(0!==f.length){s._currentlyDeletingListItems=!0;s.runQuery(function(e){for(var t=s.InitContext(u(),a(!0),e),n="1"==ctx.RecycleBinEnabled&&!ctx.ExternalDataList,r=0;r<f.length;r++){if(s._dataSource.tableCache.GetCachedRecord(f[r]).GetDataValue("Edit")&i.JsGridConstants.SPGPermissions.deleteListItems){var o=t.list.getItemById(f[r]);n?o.recycle():o.deleteObject()}}t.context.executeQueryAsync()})}else null!=t&&t(!0)}else r.JsGridUtil.Internal.IsFeatureEnabled(B)?S.inplview.DeleteSelectedItemsCore(c,f,u(),a(!1)):window.inplview.DeleteSelectedItemsCore(c,f,u(),a(!1))})};t.prototype.get_ItemCount=function(){return this._jsGridControl.GetViewRecordCount()};t.prototype.GetViewIndexOfItem=function(e){return this._jsGridControl.GetViewIndexOfRecord(e)};t.prototype.TrySelectItem=function(e){this._jsGridControl.SelectRowRangeByKey(e,e,!1)};t.prototype.ToggleAllItems=function(){var e=this._jsGridControl._GetPaneManager().RecordKeyToViewIdx(this._jsGridControl.GetLastRecordKey()),t=this._jsGridControl.GetSelectedRecordKeys();null==t||t.length!==e-0+1?this._jsGridControl.SelectRowRange(0,e,!1):this._jsGridControl.SelectCellRange(0,0,0,0,!1)};t.prototype.ReadValue=function(e,t,n){this._dataSource.tableCache.GetRecordsByKey([e],function(e,r,i){if(i){var s=r[0],o={hasDataValue:s.HasDataValue(t),hasLocalizedValue:s.HasLocalizedValue(t)};o.hasDataValue&&(o.dataValue=s.GetDataValue(t));o.hasLocalizedValue&&(o.localizedValue=s.GetLocalizedValue(t));if(n)return n(!0,o)}else null!=n&&n(!1)})};t.prototype.GetOutlineLevel=function(e,t){var n=this;this._dataSource.tableCache.GetRecordsByKey([e],function(e,r,i){if(i){var s=n._jsGridControl.GetOutlineLevel(r[0]);if(t)return t(!0,s)}else null!=t&&t(!1)})};t.prototype.get_Columns=function(){return this._jsGridControl.GetColumns()};t.prototype.get_RequiredColumnKeys=function(){var e=[];for(var t in this._params.requiredFields)e.push(t);return e};t.prototype.get_IsInsertProvisionalChildOfFocusedItemEnabled=function(){return!!(null!=this._jsGridControl.GetFocusedItem()&&this._hierarchyEnabled&&this._params.listPermissions&i.JsGridConstants.SPGPermissions.addListItems)};t.prototype.get_IsReadOnly=function(){return(this._params.listPermissions&i.JsGridConstants.SPGPermissions.editListItems)!==i.JsGridConstants.SPGPermissions.editListItems};t.prototype.get_ContiguousSelectedItemsWithoutEntryItems=function(){var e=this._jsGridControl.GetContiguousRowSelectionWithoutEntryRecords();return null==e?null:e.keys};t.prototype.GetNodeExpandCollapseState=function(e){return this._jsGridControl.GetNodeExpandCollapseState(e)};t.prototype.ToggleExpandCollapse=function(e){this._jsGridControl.ToggleExpandCollapse(e)};t.prototype.MakeRecord=function(e,t){return this._dataSource.recordFactory.MakeRecord(e,t)};t.prototype.IsRWTimelineAwareOfList=function(e,t){if(void 0===SP.UI.Timeline)return!1;var n=!1;RunOperationOnTimelineData(function(){n=SP.UI.Timeline.ListTimelineDatasource.IsRWTimelineAwareOfList(e,t)});return n};t.prototype.OnRightClick=function(e){var t=this;if(e.context==i.JsGridConstants.ClickContext.RowHeader&&(this._params.listPermissions&i.JsGridConstants.SPGPermissions.deleteListItems||this._params.listPermissions&i.JsGridConstants.SPGPermissions.addListItems||this._params.listPermissions&i.JsGridConstants.SPGPermissions.editListItems)){var n=new d.ContextMenuWrapper({target:e.eventInfo,id:this._jsGridControl.parentNode.id+"_rowcontextmenu",portalManager:this._jsGridControl.objBag?this._jsGridControl.objBag.portalManager:void 0});this._params.listPermissions&i.JsGridConstants.SPGPermissions.deleteListItems&&n.InsertMenuItem({key:"deleteItem",text:SP.Res.deleteText,onClick:function(){t.DeleteSelectedRecords(e.recordKey)},disabled:this._jsGridControl.IsGroupingRecordKey(e.recordKey)||this._jsGridControl.IsEntryRecordKey(e.recordKey)});if(this._params.listPermissions&i.JsGridConstants.SPGPermissions.editListItems){this._jsGridControl.GetSpCsrRenderCtx();this.IsRWTimelineAwareOfList(this._params.listId,this._params.selectedTimelineView)&&n.InsertMenuItem({key:"addToTimeLine",text:Strings.STS.L_TimelineAddToTimeline,onClick:function(){var n=!1,r=t._jsGridControl.GetSelectedRecordKeys(),i=[];if(null!=r&&r.length&&r.length>0)for(var s=0;s<r.length;s++){(o={}).id=r[s];i.push(o);o.id==e.recordKey&&(n=!0)}if(0==n){var o;(o={}).id=e.recordKey.toString();i=[o]}t.AddItemsToTimeline(i)},disabled:this._bGrouped||this._jsGridControl.IsEntryRecordKey(e.recordKey)});this.CanDiscardChangesForRow(e.recordKey)&&n.InsertMenuItem({key:"discardChange",text:Strings.STS.L_SPGanttDiscardChangesMenuItem,onClick:function(){t.DiscardChangesForRow(e.recordKey)}})}n.Show()}};t.prototype.BuildMaxLengthTable=function(e){var t={};for(var n in e)"number"==typeof e[n]&&(t[n]=e[n]);return t};t._instances=[];t._FnGanttCreationCallback=[];return t})();t.GanttControl=ce;function he(e){return e?{email:e.get_email(),display:e.get_lookupValue()}:{email:"",display:""}}});
define("vGe",["require","exports","eGe","cGe","SGe","JGe","yGe","oGe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t,n,r,i,s,o){this.groupingRecords=null;this.rememberedRecordKeyHash=null;this.inVirtualMode=!1;this.populatingWebMethod=e;this.initWebMethod=t;this.computeDataRangeWebMethod=n;this._webMethodMgr=r;this._jsGridControl=i;this._fnRefreshRowViewCallback=s;this._fnUpdateDisplayAndEditControls=o}e.prototype.RefreshTableView=function(e,t,r){var o=this,u=new i.TableViewParameters,a=n.JsGridConstants.DeserializationMode.TableView;return this._webMethodMgr[this.initWebMethod.name](this.GetArguments(this.initWebMethod,a),function(n){var r=new s.Deserializer(n,a,o.keyColumnName);o.rememberedRecordKeyHash=r.recordKeyHash;if(!e){o._jsGridControl.ClearTableView();o.tableCache.Clear()}o.ProcessNewTableView(r,u,!0);null!=t&&t(u,r.additionalParams)},r)};e.prototype.RefreshRowView=function(e,t,r){var i=this,o=n.JsGridConstants.DeserializationMode.RowView;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,o),function(n){var r=new s.Deserializer(n,o,i.keyColumnName);i.rememberedRecordKeyHash=r.recordKeyHash;var u=r.InitJsGridRowViewParams();e||i.tableCache.Clear();i.ProcessNewRowView(r,u);null!=t&&t(u,r.additionalParams)},r)};e.prototype.GetAutoFilterEntries=function(e,t,r){var i=this,o=n.JsGridConstants.DeserializationMode.AutoFilter;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,o,e),function(e){var n=new s.Deserializer(e,o,i.keyColumnName);t(n.autoFilterEntries)},r)};e.prototype.BeginFullLoad=function(e,t,r){var i=this,u=n.JsGridConstants.DeserializationMode.Full;return this._webMethodMgr[this.initWebMethod.name](this.GetArguments(this.initWebMethod,u),function(t){var n=new s.Deserializer(t,u);null!=n.minimalInfo&&(i.inVirtualMode=!0);i.rememberedRecordKeyHash=n.recordKeyHash;i.keyColumnName=n.keyColumnName;i.jsGridParams=n.InitJsGridParams(r);i.jsGridParams.tableCache=i.tableCache=new o.TableCache(i.GetData.bind(i),i.ConvertDataToRecords.bind(i),i._webMethodMgr[i.computeDataRangeWebMethod.name]);i.tableCache.SetConvertAllBlobsToRecords(!0);i.tableCache.SetKeepDataInBlobCache(!1);i.tableCache.SetMaxRecordCount(1e3);i.ProcessNewTableView(n,i.jsGridParams.tableViewParams,!1);e(i.jsGridParams,n.additionalParams)},t)};e.prototype.HasColumnName=function(e){return null!=this.recordFactory.gridFieldMap[e]};e.prototype.AddColumn=function(e){this.recordFactory.gridFieldMap[e.key]=e;var t={},n=this.tableCache.GetView(),r=function(){return{isProp:!0,prop:u.PropertyType.Property.prototype.MakeProperty(void 0,void 0,e.hasDataValue,e.hasLocalizedValue,e.GetPropType())}};for(var i in n)t[n[i]]=r();this.tableCache.AddColumn(e.key,t,r)};e.prototype.ProcessNewTableView=function(e,t,n){n&&e.InitJsGridTableViewParams(t);this.keyColumnName!=e.keyColumnName&&(this.keyColumnName=e.keyColumnName);this.recordFactory=new u.PropertyType.RecordFactory(e.gridFieldMap,this.keyColumnName);this.ProcessNewRowView(e,t.rowViewParams)};e.prototype.ProcessNewRowView=function(e,t){null!=this.groupingRecords&&this.tableCache.ClearRecords(this.groupingRecords);this.tableCache.AddRawDataToCache(r.JsGridUtil.Internal.ConvertSetKeysToArray(e.data),e.data);this.groupingRecords=e.viewDependentKeys;e.InitCellStyles(this.jsGridParams.styleManager);this._fnUpdateDisplayAndEditControls()};e.prototype.GetArguments=function(e,t,n,r){var i=e.fnGenerateArgs(t),s=null==i.gridSerializerArgs?{}:i.gridSerializerArgs;this.inVirtualMode?null==s.PagingInfo&&(s.PagingInfo=null!=r?{pos:r[0].pos,count:r[0].count}:{pos:0,count:100}):null==s.PagingInfo&&(s.PagingInfo=null!=r?this.GenerateRangeStrings(r):["FirstVisible:100"]);s.RequestType=t;null!=this.rememberedRecordKeyHash&&(s.RememberedRecordKeyHash=this.rememberedRecordKeyHash);null!=n&&(s.AutoFilterColumnKeys=n);i.gridSerializerArgs=s;return i};e.prototype.ConvertDataToRecords=function(e,t){var n={};for(var r in t)if(t[r]in e){var i=e[t[r]];n[t[r]]=this.recordFactory.MakeRecord(i.data,i.localized)}return n};e.prototype.GetData=function(e,t){var i=this;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,n.JsGridConstants.DeserializationMode.Slice,null,e),function(o){var u=new s.Deserializer(o,n.JsGridConstants.DeserializationMode.Slice,i.keyColumnName);i.rememberedRecordKeyHash=u.recordKeyHash;if(u.recordKeyOrderChanged){var a=(u=new s.Deserializer(o,n.JsGridConstants.DeserializationMode.RowView,i.keyColumnName)).InitJsGridRowViewParams();i.ProcessNewRowView(u,a);null!=i._fnRefreshRowViewCallback&&i._fnRefreshRowViewCallback(a,u.additionalParams)}else null==u.minimalInfo&&null!=u.viewDependentKeys&&(i.groupingRecords=null==i.groupingRecords?u.viewDependentKeys:i.groupingRecords.concat(u.viewDependentKeys));var f=r.JsGridUtil.Internal.ConvertSetKeysToArray(u.data);if(i.inVirtualMode)for(var l=0;l<f.length;l++){var c=i.tableCache.RecordIdxToKey(e[0].pos+l);i._jsGridControl.ChangeKeys(c,f[l])}t([{data:u.data,keys:f}])},function(){t(null)})};e.prototype.GenerateRangeStrings=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].pos+","+e[n].count);return t};return e})();t.SharePointDataSource=a});
define("mGe",["require","exports","r","kw","Xw","Zd"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WaitingDialog=function(e){var t=e.title,o=e.prompt;return n.createElement(r.Dialog,{hidden:!1,title:t,maxWidth:e.maxWidth},n.createElement(i.Label,null,o),n.createElement(r.DialogFooter,null,n.createElement(s.Spinner,{size:s.SpinnerSize.large})))}});
define("Jze",["require","exports","cGe","Yze","Qze","Xze","ce"],function(require,exports,gridutil_1,core_1,init_1,clienttemplates_1,Killswitch_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var reconcileQstringFiltersKillSwitchIsActive=Killswitch_1.Killswitch.isActivated("B05B33FA-F6BB-43C4-9503-F2BD4EF272A6","4/23/2020","Use existing reconcileQstringFilters function in JsGridUtil rather then rely on a global variable"),focusAcc,SPListOperationType;function global_inplview(){window.g_SPGridInitInfo={};ServerData.prototype.GetValue=function(e){};ServerData.prototype.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",SPRequestDuration:"SPRequestDuration",SPIisLatency:"SPIisLatency"};CLVP_InitializePrototype();FocusInfo_InitializePrototype();focusAcc=null;SPListOperationType={Default:0,Sort:1,PagingRight:2,PagingLeft:3};exports.inplview={CLVPFromCtx:CLVPFromCtx,InitAllClvps:InitAllClvps,DeleteSelectedItemsCore:DeleteSelectedItemsCore};ListModule.Settings.SupportsInplHash&&init_1.AjaxNavAddNavigate(RestoreAllClvpsNavigation);InitAllClvps()}exports.global_inplview=global_inplview;function SPGridMakeInplviewRequest(e,t,n,r,i,s,o){var u=new XMLHttpRequest,a=[];a.push(SP.Utilities.Utility.getLayoutsPageUrl("inplview.aspx"));a.push("?Cmd=");a.push(e);a.push("&List=");a.push(t);a.push("&View=");a.push(n);a.push("&IsXslView=TRUE&Grid=True");if(Boolean(r)){a.push("&");a.push(r)}else{if(i){a.push("&SortField=");a.push(URI_Encoding.encodeURIComponent(i.sortField));a.push("&SortDir=");a.push(i.isDescending?"Desc":"Asc")}Boolean(s)&&a.push(s)}u.open("POST",a.join(""),!0);u.onreadystatechange=o(u);u.send(null)}function SPGridFetchSchema(e,t,n){window.g_SPGridInitInfo[t].stale=!0;SPGridMakeInplviewRequest("Schema",e,t,null,null,null,function(e){return function(){if(4==e.readyState&&!init_1.IsXhrAborted(e)){try{e.onreadystatechange=null}catch(e){}var t=e.responseText;if(601==e.status)throw t;var r=JSON.parse(t);n(r)}}})}exports.SPGridFetchSchema=SPGridFetchSchema;function GetCtxFromView(e){var t=null;for(var n in g_ctxDict){var r=g_ctxDict[n];if(r.view==e){t=r;break}}return t}function ExitGrid(e,t,n,r){var i=window.g_SPGridInitInfo[e],s=GetCtxFromView(e),o=window[i.controllerId],u=o.GetCLVPQString(),a=o.GetUnfilteredHierarchyMap();o.TryDispose(function(e){if(null==window.OffSwitch||OffSwitch.IsActive("7265707D-3E1D-4281-8FF2-B3AB155897ED")||!PageMinimized()||r){i.initialized=!1;s.inGridMode=!1;s.leavingGridMode=!0;var o=null;if(null!=e&&e.markGridSerializerAsStale)i.stale=!0;else if(null!=a){var f=[{Key:0}],l={0:0},c=function(e){for(var t=0;t<e.length;t++){var n=e[t],r={};r.Key=Number(n);if(null!=a[n].parentKey){var i=l[a[n].parentKey];Sys.Debug.assert(null!=i);r.Parent=i}null!=a[n].tag&&(r.Tag=a[n].tag);Sys.Debug.assert(null==l[n]);l[n]=f.length;f.push(r);null!=a[n].childKeys&&c(a[n].childKeys)}};c(a[0].childKeys);o=f}window[i.controllerId]=null;i.unfilteredHierarchyInfo=o;var h=document.getElementById("js-listviewthead-"+s.wpq);null!=h&&(h.style.display="");var p=document.getElementById("agg"+s.wpq);null!=p&&(p.style.display="");t||s.clvp.RefreshPaging(u.toString());null!=n&&n()}else parent.postMessage("ExitGrid","*")})}function ServerData(){}function ServerConnection(){var e=null,t=null;this.abort=function(){if(null!=e){e.isCancelled;e.abort();e=null}if(null!=t){t.Abort();t=null}};this.isRequestActive=function(){return Boolean(e)||Boolean(t)};this.getServerData=function(s,o,u,a,f,l){var c=s();return ListModule.Settings.SupportsDatapipes&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)?(function(e,n,s,o){var u=new r(e,n,s),a=new i(e,o),f="";"undefined"!=typeof MSOWebPartPageFormName&&(f=document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value);var l=new SPTouchData.DatapipeFactoryParameters("",f,"/"),c=new SPTouchData.DatapipeFactory(l).GetDatapipe(SPTouchData.DatapipeType.ObjectDatapipe);c.Initialize(a);c.SetCallbackObj(u);var h=c.CreateSession();h.GetData();t=h;return})(c,o,u,f):(function(t,r,i,s,o,u){var a=new s;a.open("POST",t,!0);u?a.setRequestHeader("Content-Type","application/json;odata=verbose"):a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");u&&("undefined"!=typeof MSOWebPartPageFormName?a.setRequestHeader("x-requestdigest",document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value):"string"==typeof pageDigest&&a.setRequestHeader("x-requestdigest",pageDigest));a.onreadystatechange=function(){n(a,t,r,i)};e=a;a.send(o);return})(c,o,u,a,f,l)};var n=function(e,t,n,r){if(4==e.readyState){this._currentXhrRequest=null;if(!init_1.IsXhrAborted(e)&&(void 0===e.isCancelled||1!=e.isCancelled)){var i=new ServerData;i.GetValue=function(n){var r=void 0,s=i;switch(n){case s.DataValueKeys.SourceURL:r=t;break;case s.DataValueKeys.CorrelationId:r=e.getResponseHeader("SPRequestGuid");break;case s.DataValueKeys.Status:try{r=e.status}catch(e){}break;case s.DataValueKeys.AuthenticationRedirect:r=e.getResponseHeader("X-Forms_Based_Auth_Required");break;case s.DataValueKeys.ResponseText:r=e.responseText;break;case s.DataValueKeys.SPRequestDuration:r=e.getResponseHeader(s.DataValueKeys.SPRequestDuration);break;case s.DataValueKeys.SPIisLatency:r=e.getResponseHeader(s.DataValueKeys.SPIisLatency)}return r};200===e.status?n(i):r(i);try{e.onreadystatechange=null}catch(e){}}}};function r(e,n,r){this.OnDataAvailable=function(r){t=null;var i=new ServerData;i.GetValue=function(t){var n=void 0,s=i;switch(t){case s.DataValueKeys.SourceURL:n=e;break;case s.DataValueKeys.CorrelationId:n=void 0;break;case s.DataValueKeys.Status:n=200;break;case s.DataValueKeys.AuthenticationRedirect:n=void 0;break;case s.DataValueKeys.ResponseText:n=r.GetValue("json")}return n};n(i)};this.OnDataError=function(e){t=null;var n=new ServerData;n.GetValue=function(t){var r=void 0,i=n;switch(t){case i.DataValueKeys.SourceURL:r=e.Url;break;case i.DataValueKeys.CorrelationId:r=e.ServerCorrelationId;break;case i.DataValueKeys.Status:r=e.XHRResponseStatus;break;case i.DataValueKeys.AuthenticationRedirect:r=void 0;break;case i.DataValueKeys.ResponseText:r=e.ErrorMessage}return r};r(n)};this.OnPreAuthenticationRedirect=function(){return!1}}function i(e,t){this.RestUrl=e;this.MakeData=function(e){return new s(e)};this.AdditionalHeaders={};this.HttpMethod="POST";this.IsWrite=!1;this.PostBody=t}function s(e){this.GetValue=function(t){var n;"json"==t&&(n=JSON.stringify(e));return n}}}function SharePointListRestUrlBuilder(){var e;this.setHttpRoot=function(t){e=t};var t=!1;this.setUseRest=function(e){t=e};var n=!1;this.setIsClientRendering=function(e){n=e};var r,i,s,o,u=!1;this.setIsEcbInfo=function(e){u=e};this.setListName=function(e){r=e};this.setListUrl=function(e){i=e};this.setView=function(e){s=e};this.setCtxId=function(e){o=e};var a,f,l,c,h=!1;this.setIsXslView=function(e){h=e};this.setOverrideSelectCommand=function(e){a=e};this.setOverrideFilterQstring=function(e){f=e};this.setOverrideScope=function(e){l=e};this.setSearchTerm=function(e){c=e};var p=!1;this.setIsFullListSearch=function(e){p=e};var d,v,m,g=!1;this.setIsRealHttpRoot=function(e){g=e};this.setRootFolder=function(e){d=e};this.setInGridMode=function(e){v=e};this.setCmd=function(e){m=e};var y,b,w,E,S,x=!1;this.setShouldCascadeDeleteWarningMessage=function(e){x=e};this.setWebPartID=function(e){y=e};this.setGroupString=function(e){b=e};this.setPagingParams=function(e){w=e};this.setSortField=function(e){E=e};this.setSortDir=function(e){S=e};var T=!1;this.setIgnoreQString=function(e){T=e};this.buildUrl=function(){var N=new URI(URI_Encoding.escapeUrlForCallback(e)),C=N.getPath();if(t)if(g)N.setPath(C+"/_api/SP.Requestcontext.Current/GetRemoteContext/list/RenderListDataAsStream");else{Boolean(r)?C+="/_api/web/lists/getById('"+r:C+="/_api/web/GetList('"+i;N.setPath(C+"')/RenderListDataAsStream");Boolean(s)&&N.setQueryParameter("View",s)}else{N.setPath(C+"/_layouts/15/inplview.aspx");N.setQueryParameter("List",r);null!=s&&N.setQueryParameter("View",s);N.setQueryParameter("ViewCount",o);h&&N.setQueryParameter("IsXslView","TRUE");n&&N.setQueryParameter("IsCSR","TRUE")}a&&N.setQueryParameter("HasOverrideSelectCommand","TRUE");var k=null;void 0!==f&&(k=f.match(RegExp("OverrideScope=[^&]*")));void 0!==l&&null==k&&N.setQueryParameter("OverrideScope",l);void 0!==f&&M(N,f);if(n){var L=new URI(Nav.ajaxNavigate.get_href(),{disableEncodingDecodingForLegacyCode:!0});N.setQueryParameter("ListViewPageUrl",URI_Encoding.encodeURIComponent(L.getStringWithoutQueryAndFragment(),!1))}void 0!==c&&null!=c&&N.setQueryParameter("InplaceSearchQuery",URI_Encoding.encodeURIComponent(c,!0));p&&N.setQueryParameter("InplaceFullListSearch","true");if(g){M(N,ListModule.Util.makeMountedFolderQueryStrParams(!0,!1))}n&&u&&N.setQueryParameter("IsRibbon","TRUE");Boolean(d)&&N.setQueryParameter("RootFolder",URI_Encoding.encodeURIComponent(d,!0));Boolean(m)&&N.setQueryParameter("Cmd",m);var A=!1;if(Boolean(w))for(var O in w)if("List"!=O&&"View"!=O&&"ID"!=O)if("ShowInGrid"==O){A=!0;N.setQueryParameter("ShowInGrid",Boolean(v)?"True":"False")}else"GroupString"!=O||!Boolean(b)&&""!=b?N.setQueryParameter(O,w[O]):N.setQueryParameter("GroupString",b);Boolean(v)&&!A&&N.setQueryParameter("ShowInGrid","True");Boolean(y)&&N.setQueryParameter("WebPartID",y);x&&N.setQueryParameter("CascDelWarnMessage","1");if(Boolean(b)||""==b){w.hasOwnProperty("IsGroupRender")||N.setQueryParameter("IsGroupRender","TRUE");N.setQueryParameter("DrillDown","1");w.hasOwnProperty("GroupString")||N.setQueryParameter("GroupString",b)}Boolean(E)&&N.setQueryParameter("SortField",E);Boolean(S)&&N.setQueryParameter("SortDir",S);T&&N.setQueryParameter("IgnoreQString","TRUE");return N.getString();function M(e,t){if(Boolean(t))for(var n=t.split("&"),r=0,i=n.length;r<i;r++){var s=n[r].split("=");Boolean(s[0])&&e.setQueryParameter(s[0],s[1])}}}}function CLVP_InitializePrototype(){CLVP.prototype={outstandingServerConnection:void 0,cctx:void 0,ctx:void 0,dsrc:null,fnEcbCallbacks:{},fRestore:!1,inplUrl_deprecated:null,cachedUrlBuilder:null,fRest:!1,isEcbInfo:!1,hasEcbInfo:!1,isInserting:!1,pagingTab:null,queueEcbInfo:[],rgehs:void 0,rgpag:null,rgpaging:null,rootFolder:null,rootFolderGuid:null,strGroupCache:null,strGroupName:null,tBody:null,currentTBody:null,tab:null,trEmpty:null,wpid:null,wpq:null,strHash:"",xmlHttpCtr:window.XMLHttpRequest,CancelAnyOutstandingRequest:CLVPCancelAnyOutstandingRequest,Init:CLVPInit,PagingString:CLVPPagingString,RefreshPagingEx:CLVPRefreshPagingEx,IsServerConnectionRequestActive:CLVPIsServerConnectionRequestActive,FindTab:CLVPFindTab,EnsureChangeContext:CLVPEnsureChangeContext,DeleteItemCore:CLVPDeleteItemCore,ShowErrorDialog:CLVPShowErrorDialog,InplViewUrl:CLVPInplViewUrl}}function CLVP(e){this.ctx=e;e.clvp=this}function CLVPInit(){if(null!=this.FindTab()){this.pagingTab=document.getElementById("bottomPagingCell"+this.wpq.substr(7));if(null!=this.tab&&"ms-emptyView"==this.tab.className){var e=gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetAncestorByTag(this.tab,"TR");this.trEmpty=e.nextSibling}null!=this.ctx.rootFolder&&(this.rootFolder=URI.decodeURIComponent(this.ctx.rootFolder));Boolean(this.rootFolder)||(this.rootFolder=Nav.getUrlKeyValue("RootFolder"));0==this.rootFolder.length&&(this.rootFolder=null);var t=this.GetQueryStringFromHash();null===t&&void 0===t||(this.ctx.queryString=t)}}function CLVPFindTab(){var e=1==this.ctx.listBaseType,t=this.ctx.listName+"-"+this.ctx.view,n=DOM.GetElementsByName(t);if(0==n.length&&e){t="onetidDoclibViewTbl0";n=DOM.GetElementsByName(t)}var r,i=null;0!=n.length||e||(n=DOM.GetElementsByName("onetidDoclibViewTbl0"));0==n.length&&(n=DOM.GetElementsByName("onetidDoclibViewTbl"+this.ctx.ctxId));for(r=0;r<n.length;r++){var s=n[r],o=(i=s).getAttribute("view");if(!Boolean(o))for(;null!=i&&("DIV"!=i.tagName||null==(o=i.getAttribute("WebPartID")))&&null!=i.parentNode;)i=i.parentNode;if(null!=i&&null!=o&&1==this.ctx.view.indexOf(o.toUpperCase())){this.tab=s;this.wpq="WebPart"+this.ctx.wpq;break}}if(null==i||null==this.tab)return null;this.tab.clvp=this;return i}function CLVPPagingString(e){if(null==this.rgpaging)return null;var t,n=[],r=!0;for(t in this.rgpaging){var i=!1;if(null==e)i=!0;else for(var s in e)if(0==t.indexOf(s)){i=!0;break}if(i)if(r)r=!1;else{n.push("&");n.push(t);n.push("=");n.push(this.rgpaging[t])}}return n.join("")}function CLVPIsServerConnectionRequestActive(){var e=this.outstandingServerConnection;return Boolean(e)&&e.isRequestActive()}function CLVPRefreshPagingEx(e,t,n,r,i){var s=this;"1"==Nav.getUrlKeyValue("PageFirstRow",!1,e)&&(e=ListModule.Util.removeOnlyPagingArgs(e));var o=new URI(Boolean(i)?i:e,{disableEncodingDecodingForLegacyCode:!0}),u=document.getElementById("GroupByWebPartID"+s.ctx.ctxId),a=null;null!=u&&(a=u.getAttribute("webPartID"));var f=1==s.ctx.HasRelatedCascadeLists&&null==s.ctx.CascadeDeleteWarningMessage,l=null;null!=s.strGroupName&&(l=ListModule.Util.groupStringFromGroupName(s.strGroupName));var c=Nav.getUrlKeyValue("RootFolder",!0,e);s.ctx.startTime=(new Date).getTime();var h,p,d,v,m=o.getQuery();(t||void 0===s.rgpaging||null==s.rgpaging)&&(s.rgpaging=getPagingQueryParams(m));h=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)?(function(){var e=Nav.getUrlKeyValue("SortField",!0,window.location.href),t=Nav.getUrlKeyValue("SortDir",!0,window.location.href);s.fRest=ListModule.Settings.SupportsRest&&!s.isEcbInfo;var r=__CreateSharePointListRestUrlBuilder(s);Boolean(s.rgpaging.RootFolder)||r.setRootFolder(c);r.setInGridMode(s.ctx.inGridMode);r.setCmd(n);r.setShouldCascadeDeleteWarningMessage(f);r.setWebPartID(a);r.setGroupString(l);r.setSortField(e);r.setSortDir(t);r.setPagingParams(s.rgpaging);return r})():(p=buildQueryParams(s.rgpaging,n,f,a,l),d=buildServerDataEndpoint(s.InplViewUrl(!0),o,c,p,s.ctx.inGridMode),v={buildUrl:function(){var e=d;v._ignoreQString&&(e=SetUrlKeyValue("IgnoreQString","TRUE",!1,e));null==v._rootFolder&&(e=URI.removeKeyValue("RootFolder",e));return e},setIgnoreQString:function(e){v._ignoreQString=e},_ignoreQString:!1,setRootFolder:function(e){v._rootFolder=e},_rootFolder:""});if(r)return h.buildUrl();var g=new ServerConnection;ListModule.Settings.SupportsPopup&&void 0!==window.ctxFilter&&null==window.ctxFilter&&MenuHtc_hide&&MenuHtc_hide();var y="",b=!1,w=!1;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(168)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&null!=window.groupContextData){b=Boolean(s.ctx.hasRootFolder);w=Boolean(s.ctx.mountPointUrl)}if(s.fRest){y="{'parameters': {'__metadata': { 'type': 'SP.RenderListDataParameters' }, 'ViewXml': ''";w&&(y+=", 'RenderOptions': '7'");y+="}}"}else{if(void 0!==s.ctx.overrideSelectCommand){y="&OverrideSelectCommand="+s.ctx.overrideSelectCommand;h.setIgnoreQString(!0)}if(c.length>0){y=y+"&InplRootFolder="+c;h.setRootFolder(null)}}s.ctx.hasRootFolder=!1;s.ctx.mountPointUrl=null;var E=!1;if(s.isEcbInfo){E=!0;s.isEcbInfo=!1;s.hasEcbInfo=!0}var S=s.tBody,x=s.currentTBody;s.tBody=null;s.CancelAnyOutstandingRequest();var T=null;null!=focusAcc&&null!=focusAcc.focusInCLVPTab&&(T=focusAcc);if(!s.ctx.enteringGridMode||s.fRestore){var N={},C=h.buildUrl().indexOf("?");N.action=h.buildUrl().substr(C+1);var k=function(){var e=function(e){var t=e.GetValue(e.DataValueKeys.Status),n=e.GetValue(e.DataValueKeys.ResponseText),r=e.GetValue(e.DataValueKeys.AuthenticationRedirect),i=e.GetValue(e.DataValueKeys.SourceURL);s.OnReadyStateChangeCallback(t,n,i,r,E,x,S,T,c,b,w)};g.getServerData(h.buildUrl,function(t){var n=t.GetValue(t.DataValueKeys.CorrelationId);N.correlationId=n;e(t)},function(t){var n=t.GetValue(t.DataValueKeys.CorrelationId);N.correlationId=n;e(t)},s.xmlHttpCtr,y,s.fRest);s.outstandingServerConnection=g};s.ctx.inGridMode&&!s.ctx.enteringGridMode&&!E&&ListModule.Settings.SupportsInPlaceEdit?ExitGrid(s.ctx.view,!0,function(){s.ctx.inGridMode=!0;s.ctx.leavingGridMode=!1;k()},!0):k()}else window.ReRenderListView(s.ctx,h.buildUrl(),null,null)}exports.CLVPRefreshPagingEx=CLVPRefreshPagingEx;function CLVPInplViewUrl(e){var t=this;return Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)&&!Boolean(e)?(function(){if(null!=t.cachedUrlBuilder){t.cachedUrlBuilder.setIsClientRendering(t.ctx.IsClientRendering);t.cachedUrlBuilder.setIsEcbInfo(t.isEcbInfo)}else{t.fRest=ListModule.Settings.SupportsRest&&!t.isEcbInfo;t.cachedUrlBuilder=__CreateSharePointListRestUrlBuilder(t)}return t.cachedUrlBuilder})():(function(){var e="undefined"!=typeof ctx?ctx:t.ctx,n=ListModule.Settings.SupportsRest&&!t.isEcbInfo,r=void 0!==t.ctx.IsClientRendering&&t.ctx.IsClientRendering,i=t.isEcbInfo;if(null==t.inplUrl_deprecated){var s=new SharePointListRestUrlBuilder;s.setHttpRoot(Boolean(e.RealHttpRoot)?e.RealHttpRoot:e.HttpRoot);s.setUseRest(n);s.setIsClientRendering(r);s.setListName(t.ctx.listName);s.setView(t.ctx.view);s.setCtxId(String(t.ctx.ctxId));s.setIsXslView(void 0!==t.ctx.isXslView&&t.ctx.isXslView);s.setOverrideSelectCommand(void 0!==t.ctx.overrideSelectCommand);s.setOverrideFilterQstring(t.ctx.overrideFilterQstring);s.setOverrideScope(t.ctx.overrideScope);s.setSearchTerm(t.ctx.searchTerm);s.setIsFullListSearch(void 0!==t.ctx.fullListSearch&&null!=t.ctx.fullListSearch&&t.ctx.fullListSearch);s.setIsRealHttpRoot(Boolean(t.ctx.RealHttpRoot));t.inplUrl_deprecated=s.buildUrl();t.fRest=n}return t.inplUrl_deprecated+(r&&i?"&IsRibbon=TRUE":"")})()}function CLVPCancelAnyOutstandingRequest(){if(this.IsServerConnectionRequestActive()){if(this.isEcbInfo){this.isEcbInfo=!1;this.strGroupName=null}this.outstandingServerConnection.abort();this.outstandingServerConnection=void 0}return!1}function CLVPEnsureChangeContext(){null==this.cctx&&(this.cctx=new SP.ClientContext(null))}function CLVPDeleteItemCore(e,t){ListModule.Settings.SupportsItemDelete&&core_1._CLVPDeleteItemCore(this,e,t)}function CLVPShowErrorDialog(e,t){ListModule.Settings.SupportsErrorDlg&&core_1._CLVPShowErrorDialog(this,e,t)}function __CreateSharePointListRestUrlBuilder(e){var t="undefined"!=typeof ctx?ctx:e.ctx,n=void 0!==e.ctx.IsClientRendering&&e.ctx.IsClientRendering,r=e.isEcbInfo,i=new SharePointListRestUrlBuilder;i.setHttpRoot(Boolean(t.RealHttpRoot)?t.RealHttpRoot:t.HttpRoot);i.setUseRest(e.fRest);i.setIsClientRendering(n);i.setIsEcbInfo(r);i.setListName(e.ctx.listName);i.setView(e.ctx.view);i.setCtxId(String(e.ctx.ctxId));i.setIsXslView(void 0!==e.ctx.isXslView&&e.ctx.isXslView);i.setOverrideSelectCommand(void 0!==e.ctx.overrideSelectCommand);i.setOverrideFilterQstring(e.ctx.overrideFilterQstring);i.setOverrideScope(e.ctx.overrideScope);i.setSearchTerm(e.ctx.searchTerm);i.setIsFullListSearch(void 0!==e.ctx.fullListSearch&&null!=e.ctx.fullListSearch&&e.ctx.fullListSearch);i.setIsRealHttpRoot(Boolean(e.ctx.RealHttpRoot));return i}function InitCLVPs(){if("undefined"!=typeof g_ViewIdToViewCounterMap){var e;for(e in g_ViewIdToViewCounterMap){var t=window["ctx"+g_ViewIdToViewCounterMap[e]];if(Boolean(t)){new CLVP(t).Init()}}}}function getPagingQueryParams(e){var t=e.split("&"),n=[],r=0;for(r=0;r<t.length;r++){var i=t[r].split("=");"List"!=i[0]&&"View"!=i[0]&&"ID"!=i[0]&&(i.length>1&&(n[i[0]]=i[1]))}return n}function buildQueryParams(e,t,n,r,i){var s,o=[];null!=t&&o.push("&Cmd="+t);n&&o.push("&CascDelWarnMessage=1");for(s in e)if("List"!=s&&"View"!=s&&"ID"!=s){o.push("&");o.push(s);o.push("=");o.push(e[s])}Boolean(r)&&o.push("&WebPartID="+r);null!=i&&o.push("&IsGroupRender=TRUE&DrillDown=1&GroupString="+i);return o.join("")}function buildServerDataEndpoint(e,t,n,r,i){var s,o=new URI(e,{disableEncodingDecodingForLegacyCode:!0}),u=o.getStringWithoutQueryAndFragment(),a=o.getQuery();s=reconcileQstringFiltersKillSwitchIsActive?u+"?"+ListModule.Util.reconcileQstringFilters(a,r):u+"?"+gridutil_1.JsGridUtil.Internal.List_ReconcileQstringFilters(a,r);if(0==Nav.getUrlKeyValue("SortField",!0,s).length){var f=Nav.getUrlKeyValue("SortField",!0,window.location.href);f.length>0&&(s=SetUrlKeyValue("SortField",f,!1,s));var l=Nav.getUrlKeyValue("SortDir",!0,window.location.href);l.length>0&&(s=SetUrlKeyValue("SortDir",l,!1,s))}n.length>0&&0==Nav.getUrlKeyValue("RootFolder",!0,s).length&&(s=SetUrlKeyValue("RootFolder",n,!1,s));var c=Nav.getUrlKeyValue("ShowInGrid",!0,s);"True"!=c||i?"True"!=c&&i&&(s=SetUrlKeyValue("ShowInGrid","True",!0,s)):s=SetUrlKeyValue("ShowInGrid","False",!0,s);return s}function SetUrlKeyValue(e,t,n,r){null==r&&(r=window.location.href+"");var i=t,s=new URI(r,{disableEncodingDecodingForLegacyCode:!0});r=s.getQuery();n&&(i=URI_Encoding.encodeURIComponent(i));if(r.indexOf(e+"=")<0){r.length>1?r+="&":0==r.length&&(r+="?");r+=e+"="+i}else{var o=new RegExp(e+"=[^&]*");r=r.replace(o,e+"="+i)}s.setQuery(r);return s.getString()}function ReRenderListView(e,t,n,r){var i=e.clvp,s=EnableListAnimation(e),o=!1,u=!1;s&&(o=0==e.ListData.Row.length||Boolean(e.ListData.NextHref));var a=e.bNoDelete?n:null;s&&(u=0==e.ListData.Row.length||Boolean(e.ListData.NextHref));var f=s&&u&&!o,l=null;null!=i&&i.fRestore||e.enteringGridMode||e.leavingGridMode||(l=document.getElementById("scriptBody"+e.wpq));"function"==typeof RenderListView&&RenderListView(e,e.wpq,l,s,f);FixSortOrderIcon(e,e.ListData,e.ListSchema);FixAggregate(e,e.ListData,e.ListSchema);if(null==i){i=new CLVP(e);e.clvp=i}null==i.tab?i.Init():null==l&&i.FindTab();if(i.fRestore||e.enteringGridMode||e.leavingGridMode){i.fRestore=!1;null!=i.tab&&init_1.CSSUtil.RemoveClass(i.tab,"s4-hide-tr")}if(!Boolean(i.ctx.loadingAsyncData)&&!i.fRestore&&!Boolean(i.ctx.bNoDelete)||i.ctx.enteringGridMode||i.ctx.leavingGridMode||null!=r&&!Boolean(i.ctx.bNoDelete)){var c={},h=i.InplViewUrlHash(t,r);c["InplviewHash"+i.WebPartId()]=h;ListModule.Settings.SupportsInplHash&&"function"==typeof AjaxNavUpdate&&AjaxNavUpdate(c);i.strHash=h}i.ctx.bNoDelete=!1;Boolean(i.ctx.loadingAsyncData)&&(i.ctx.loadingAsyncData=!1);if(null==a){ListModule.Util.ctxInitItemState(e);ListModule.Util.clearSelectedItemsDict(e)}null==i.tab||void 0!==i.tab.onmouseover&&null!=i.tab.onmouseover||(i.tab.onmouseover=i.ctx.TableMouseoverHandler);null==e.SelectAllCbx||void 0!==e.SelectAllCbx.onfocus&&null!=e.SelectAllCbx.onfocus||(e.SelectAllCbx.onfocus=e.TableCbxFocusHandler);if(null==a){i.InvalidateEcbInfo();i.ResetSelection();i.SyncPagingTables()}if(ListModule.Settings.SupportsAnimation&&s&&null!=l)AnimateListDelta(e,l.parentNode);else if("undefined"!=typeof ProcessImn&&"undefined"!=typeof imnCount&&"undefined"!=typeof bIMNOnloadAttached){imnCount=0;bIMNOnloadAttached=!1;ProcessImn()}var p=e.qcb;Boolean(p)&&p.Poll();if("function"==typeof i.ctx.onViewReRenderCompleted){var d=i.ctx.onViewReRenderCompleted;i.ctx.onViewReRenderCompleted=null;null!=d&&d(i.ctx)}e.operationType=SPListOperationType.Default;e.leavingGridMode&&(e.leavingGridMode=!1);if(null!=a){e.ListData=MergeListData(a,e.ListData);"function"==typeof window.scrollManager.ScrollHandler&&["scrollManager"].ScrollHandler();null!=l&&null!=(l=l.parentNode.lastChild)&&l.setAttribute("url",t)}}exports.ReRenderListView=ReRenderListView;function FixAggregate(e,t,n){if(null!=t&&null!=n){var r=n.Aggregate;if(null!=r&&!n.groupRender&&!e.inGridMode){var i=document.getElementById("aggr"+e.wpq),s="<table>"+clienttemplates_1.RenderAggregate(e,null,t.Row[0],n,null,!0,r)+"</table>",o=document.createElement("div");o.innerHTML=s;var u=o.firstChild.firstChild;i.replaceChild(u.firstChild,i.firstChild)}}}function FixSortOrderIcon(e,t,n){if(null!=e&&null!=t&&null!=n)if(e.IsClientRendering){var r,i,s;if(null!=t.SortField&&null!=(r=document.getElementById("diidSortArrowSpan"+e.ctxId+t.SortField))){var o=r.getElementsByTagName("img")[0];if(null!=o){if("ascending"==t.SortDir){r.className="ms-sortarrowup-iconouter";o.className="ms-sortarrowup-icon";o.alt=window.ListView.Strings.L_viewedit_onetidSortAsc}else{r.className="ms-sortarrowdown-iconouter";o.className="ms-sortarrowdown-icon";o.alt=window.ListView.Strings.L_viewedit_onetidSortDesc}r.style.display=""}}for(var u in n.Field){var a=n.Field[u];if(null==a.GroupField){a.Name!=t.SortField&&null!=(r=document.getElementById("diidSortArrowSpan"+e.ctxId+a.Name))&&(r.style.display="none");if(null!=(s=document.getElementById("diidFilterSpan"+e.ctxId+a.Name))){i=null!=t.FilterFields&&t.FilterFields.indexOf(";"+a.Name+";")>=0;s.style.display=i?"":"none"}}}}else FixSortOrderIcon_NonCSR(e,t,n)}function FixSortOrderIcon_NonCSR(e,t,n){var r="/_layouts/15/images/sort.gif",i="/_layouts/15/images/rsort.gif";if(null!=t&&null!=n){if(null!=t.SortField){var s=document.getElementById("diidSort"+e.ctxId+t.SortField);if(null!=s){var o=s.lastChild;if(null!=o){var u=o.previousSibling;null==u||"IMG"!=u.tagName||u.src.substr(u.src.length-r.length)!=r&&u.src.substr(u.src.length-i.length)!=i||u.parentNode.removeChild(u);var a=document.createElement("IMG");a.border=0;if("ascending"==t.SortDir){a.alt=window.ListView.Strings.L_viewedit_onetidSortAsc;a.src="/_layouts/15/images/sort.gif?rev=47"}else{a.alt=window.ListView.Strings.L_viewedit_onetidSortDesc;a.src="/_layouts/15/images/rsort.gif?rev=47"}if("IMG"!=o.tagName){var f=document.createElement("IMG");f.border=0;f.src="/_layouts/15/images/blank.gif";o=s.appendChild(f)}s.insertBefore(a,o)}}}for(var l in n.Field){var c=n.Field[l];if(null==c.GroupField){s=document.getElementById("diidSort"+e.ctxId+c.Name);c.Name!=t.SortField&&null!=s&&null!=(o=s.lastChild)&&(null==(u=o.previousSibling)||"IMG"!=u.tagName||u.src.substr(u.src.length-r.length)!=r&&u.src.substr(u.src.length-i.length)!=i||u.parentNode.removeChild(u));if(null!=s){var h=s.nextSibling;if(null==h){(h=document.createElement("IMG")).border=0;s.parentNode.appendChild(h)}var p=null!=t.FilterFields&&t.FilterFields.indexOf(";"+c.Name+";")>=0;h.src=p?"/_layouts/15/images/filter.gif":"/_layouts/15/images/blank.gif"}}}}}function AnimateListDelta(e,t){var n=e.ctxId,r=FetchTableBodies(t),i=r.oldbody,s=r.newbody,o=document.getElementById("scriptPaging"+e.wpq);if(null!=i||null!=s){e.operationType==SPListOperationType.PagingRight||(e.operationType,SPListOperationType.PagingLeft),FixupTable(i,s,o,n);ListModule.Settings.SupportsAnimation&&(g_fAnimateListCSR=!0)}}function FixupTable(e,t,n,r){var i=Boolean(e)?e.parentNode:t.parentNode;if(null!=i&&"TABLE"==i.nodeName){Boolean(e)&&"TBODY"==e.nodeName&&i.removeChild(e);Boolean(t)&&"TBODY"==t.nodeName&&(t.style.display="");"function"==typeof window.EnsureSelectionHandler&&window.EnsureSelectionHandler(null,i,r)}if("undefined"!=typeof ProcessImn&&"undefined"!=typeof imnCount&&"undefined"!=typeof bIMNOnloadAttached){imnCount=0;bIMNOnloadAttached=!1;ProcessImn()}null!=n&&"none"==n.style.display&&(n.style.display="")}function FetchTableBodies(e){for(var t,n=e.firstChild;null!=n&&"TBODY"!=n.nodeName;)n=n.nextSibling;if(null==n)t=null;else if("none"==n.style.display){t=n;n=null}else t=n.nextSibling;return{oldbody:n,newbody:t}}function FocusInfo_InitializePrototype(){FocusInfo.prototype={elem:null,id:null,tagName:null,focusInCLVPTab:null,fromRibbon:void 0,setActive:void 0}}function FocusInfo(){}function MergeListData(e,t){if(ListModule.Settings.SupportsMQuery)for(var n in t.Row){var r=!1;for(var i in e.Row)if(t.Row[n].ID!=e.Row[i].ID);else{r=!0;window.m$.extend(e.Row[i],t.Row[n])}r||e.Row.push(t.Row[n])}return e}exports.MergeListData=MergeListData;function EnableListAnimation(e){var t=!1;if(ListModule.Settings.SupportsAnimation){t=SPAnimation.Settings.IsAnimationEnabled()&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.group1)&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.group2)&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.Aggregate)&&e.Templates.Body===RenderBodyTemplate&&(1==e.BaseViewID||101==e.ListTemplateType&&"1"==e.ListSchema.IsDocLib&&50==e.BaseViewID||700==e.ListTemplateType&&(51==e.BaseViewID||52==e.BaseViewID)||Boolean(e.RealHttpRoot)&&51==e.BaseViewID&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Boolean(e.RealHttpRoot)&&56==e.BaseViewID&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&!e.clvp.fRestore&&!e.skipNextAnimation&&!e.bNoDelete&&!e.inGridMode&&!e.leavingGridMode;e.skipNextAnimation=!1}return t}function InitAllClvps(){InitCLVPs()}function DeleteSelectedItemsCore(e,t,n,r,i){ListModule.Settings.SupportsItemDelete&&core_1.deleteSelectedItemsCore(e,t,n,r,i)}function RestoreAllClvpsNavigation(){EnumCLVPs(RestoreClvpNavigation)}function CLVPFromCtx(e,t){Boolean(t)&&EnsureCLVP(e);return void 0!==e.clvp?e.clvp:null}function EnsureCLVP(e){if(void 0===e.clvp){e.clvp=new CLVP(e);e.clvp.Init()}}function CLVPFromEventReal(e){return null==e?null:void 0!==e.currentCtx&&Boolean(e.currentCtx)?CLVPFromCtx(e.currentCtx,!0):"function"==typeof CLVPFromEventToolbar?CLVPFromEventToolbar(e):null}exports.CLVPFromEventReal=CLVPFromEventReal;function EnumCLVPs(callback){var fRet=!1;if("undefined"!=typeof g_ViewIdToViewCounterMap){var vid;for(vid in g_ViewIdToViewCounterMap){var ctxT;eval("ctxT = ctx"+g_ViewIdToViewCounterMap[vid]+";");var clvp=ctxT.clvp;if(null!=clvp){callback(clvp);fRet=!0}}}return fRet}function RestoreClvpNavigation(e){e.RestoreNavigation()}});
define("Yze",["require","exports","cGe","Xze","Qze","me"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.global_core=function(){(function(){var e=null,t=null,r=-1;function s(){if(null===e){e=new a;(function(){if(null!=t)return t;var e=(function(){var e=document.getElementById("notificationArea");if(null==e){(e=document.createElement("div")).id="notificationArea";var t=document.getElementById("contentBox");null!=t?t.appendChild(e):document.body.appendChild(e)}e.style.display="none";return(function(e){var t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");t.className="ms-trcnoti-border";n.className="ms-fullWidth";r.className="ms-trcnoti-host ms-fullWidth";n.appendChild(r);t.appendChild(n);e.appendChild(t);return{ctr:e,root:t,host:r}})(e)})(),r=e.ctr,i=e.host;t=new l(u.ContainerID.Basic,i,50);var s=function(e){((function(e,t){var r=e.elm,i=e.onclickHandler,s=e.strTooltip,o=e.bNoAnimate;r.className="ms-trcnoti-base";e.bNoAnimate||n.JsGridUtil.Internal.DomElement.GetInstance().SetOpacity(r,0);var u=document.createElement("div");u.className="ms-trcnoti-bg";"function"==typeof AttachEvent&&AttachEvent("click",function(){null!=i&&i();c(r.id,o);return!1},u);var a=document.createElement("div");a.className=t;u.appendChild(a);r.appendChild(u);Boolean(s)&&(r.title=s);r.setAttribute("role","alert");if(Boolean(e.ariaLiveAttribute)&&Boolean(e.container)){var f=e.container.element;Boolean(f)&&f.setAttribute("aria-live",e.ariaLiveAttribute)}return a})(e,"ms-trcnoti-toast")).innerHTML=e.strHtml};t.SetEventHandler(u.EventID.OnHide,function(e){r.style.display="none";e()});t.SetEventHandler(u.EventID.OnShow,function(e){r.setAttribute("aria-live","polite");r.setAttribute("aria-relevant","all");r.style.display="block";e()});t.SetEventHandler(u.EventID.OnDisplayNotification,function(e,t){s(e);var n=e.elm;n.style.top="0px";i.appendChild(n);t()});t.SetEventHandler(u.EventID.OnRemoveNotification,function(e,t){t()})})()}return e}a.prototype={Initialized:!1,Notifications:void 0,Containers:void 0,Initialize:void 0,AddNotification:void 0,AddContainer:void 0,DisposeNotification:void 0,SetExpireTimer:void 0,RetireNotificationInternal:void 0};a.prototype.Initialize=function(){if(!this.Initialized){this.Notifications={};this.Containers={};this.Initialized=!0}};a.prototype.Reset=function(){var e,t;for(t in this.Containers){(e=this.Containers[t]).Dispose();e.UnblockUpdatesInternal()}var n=r;r=-1;window.clearInterval(n)};a.prototype.AddNotification=function(e,t){var n=this.Containers[e];Sys.Debug.assert(null!=n,"[NotificationEngine.AddNotification] : Container ID is invalid ("+String(e)+")");t.container=n;this.Notifications[t.id]=t};a.prototype.AddContainer=function(e){this.Containers[e.id]=e};a.prototype.DisposeNotification=function(e){null!=this.Notifications[e.id]&&delete this.Notifications[e.id]};a.prototype.SetExpireTimer=function(e,t){var n=new Date;e.expires=n.valueOf()+t;-1==r&&(r=window.setInterval(function(){s().RetireNotificationInternal()},750))};a.prototype.RetireNotificationInternal=function(){var e=(new Date).valueOf(),t=!0,n=[];for(var i in this.Notifications){null!=(s=this.Notifications[i]).expires&&(e>s.expires?n.push(s):t=!1)}for(;n.length>0;){var s;(o=(s=n.shift()).container).RemoveNotification(s);o.pendingUpdate=!0}for(var i in this.Containers){var o;(o=this.Containers[i]).items.length>0&&(t=!1);if(Boolean(o.pendingUpdate)){o.Update();delete o.pendingUpdate}}if(t){var u=r;r=-1;window.clearInterval(u)}};f.prototype={id:void 0,elm:void 0,strHtml:void 0,strTooltip:void 0,bSticky:void 0,bIsAdd:void 0,bNoAnimate:void 0,bHidden:void 0,onclickHandler:void 0,container:void 0,extraData:void 0,expires:void 0,ariaLiveAttribute:void 0};f.prototype.Initialize=function(e,t,n,r,o,u,a){var f="notification_"+String(i.getUniqueIndex()),l=document.createElement("span");l.id=f;this.id=f;this.bIsAdd=!0;this.elm=l;this.strHtml=t;this.extraData=u;this.bSticky=n;this.strTooltip=r;this.onclickHandler=o;this.bHidden=!1;this.ariaLiveAttribute=a;s().AddNotification(e,this)};f.prototype.Show=function(e){1==Boolean(e)&&(this.bNoAnimate=!0);this.container.AddNotification(this)};f.prototype.Hide=function(e){1==Boolean(e)&&(this.bNoAnimate=!0);this.container.RemoveNotification(this)};l.prototype={id:void 0,element:void 0,bIsShown:void 0,bIsBlocked:void 0,nDisposalState:void 0,nNotificationLayer:25,notificationDisplayDuration:7e3,nMaxNotifications:20,events:void 0,items:void 0,pending:void 0,blockedUpdates:void 0};l.prototype.Initialize=function(e,t,n,r){this.id=e;this.element=t;this.events=new Array(o);this.bIsShown=!1;this.nNotificationLayer=n;this.bIsBlocked=!1;this.items=[];this.pending=[];this.blockedUpdates=[];this.nDisposalState=0;var i=this;this.items.add=function(e){this.push(e);i.FireEvent(u.EventID.OnNotificationCountChanged)};this.items.remove=function(e){var t,n;for(t=0,n=this.length;t<n;t++)if(e.id==this[t].id){this.splice(t,1);i.FireEvent(u.EventID.OnNotificationCountChanged);return!0}return!1};null!=r&&(this.nMaxNotifications=r);s().AddContainer(this)};l.prototype.Dispose=function(){if(!(this.nDisposalState>0)){this.nDisposalState=1;this.Clear()}};l.prototype.AddNotification=function(e){Sys.Debug.assert(e.container.id==this.id,"[AddNotification] : Notification does not match container! Expected: "+String(this.id)+"; Actual: "+String(e.container.id));var t,n;for(t=0,n=this.items.length;t<n;t++)if(e.id==this.items[t].id)return;if(this.GetCount()<this.nMaxNotifications){e.bHidden=!1;e.elm.style.display=""}else{e.bHidden=!0;e.elm.style.display="none"}this.items.add(e);var r=this,i=function(){Boolean(e.bSticky)||s().SetExpireTimer(e,r.notificationDisplayDuration);r.bIsShown||r.Show();r.FireEvent(u.EventID.OnDisplayNotification,e,function(){r.Update();return!0});r.Update()};this.bIsBlocked&&0===this.nDisposalState?this.pending.push(i):i()};l.prototype.RemoveNotification=function(e){if(!1!==e.bIsAdd){e.bIsAdd=!1;Sys.Debug.assert(e.container.id==this.id,"[RemoveNotification] : Notification does not match container! Expected: "+String(this.id)+"; Actual: "+String(e.container.id));var t,n,r=!1;for(t=0,n=this.pending.length;t<n;t++)if(e.id==this.pending[t].id){this.pending.splice(t,1);r=!0}if(r)this.items.remove(e);else{var i=this,o=function(){i.FireEvent(u.EventID.OnRemoveNotification,e,function(){try{i.items.remove(e);var t=e.elm;i.element.removeChild(t)}catch(e){}s().DisposeNotification(e);i.Update();return!0});i.Update()};this.bIsBlocked&&0===this.nDisposalState?this.pending.push(o):o()}}};l.prototype.ShowAllNotifications=function(){var e,t,n=this.items;for(e=0,t=n.length;e<t;e++){var r=n[e];if(r.bHidden){r.bHidden=!1;r.elm.style.display=""}}};l.prototype.Update=function(){this.element.hasChildNodes()||0!=this.items.length||this.Hide();if(this.bIsShown)for(var e in s().Containers)this.BlockUpdatesInternal(s().Containers[e])};l.prototype.Clear=function(e){for(var t=this.items,n=t.length-1;n>=0;n--){var r=t[n];if(Boolean(r)&&r.bIsAdd){Boolean(e)&&(r.bNoAnimate=!0);this.RemoveNotification(r)}}};l.prototype.GetCount=function(){return this.items.length};l.prototype.GetHiddenCount=function(){var e,t,n=0,r=this.items;for(e=0,t=r.length;e<t;e++){r[e].bHidden&&n++}return n};l.prototype.SetEventHandler=function(e,t){if(null!=this.events[e])throw"Event handler already specified for eventId "+String(e)+". ContainerId: "+String(this.id);this.events[e]=t};l.prototype.FireEvent=function(e){if(e>o)throw"Invalid eventId "+String(e)+". ContainerId: "+String(this.id);if(null!=this.events[e]){var t=this.events[e];Array.prototype.shift.call(arguments);Sys.Debug.assert(arguments.length<=2,"[FireEvent] : Too many arguments passed to callback. Expected <= 2; Actual: "+String(arguments.length));t.apply(null,arguments)}};l.prototype.Show=function(){if(!this.bIsShown){this.bIsShown=!0;var e=this;this.FireEvent(u.EventID.OnShow,function(){e.Update();return!0})}};l.prototype.Hide=function(){if(this.bIsShown){this.bIsShown=!1;for(;this.element.hasChildNodes();)this.element.removeChild(this.element.firstChild);var e=this;this.FireEvent(u.EventID.OnHide,function(){if(0==e.nDisposalState){e.UnblockUpdatesInternal();e.Update()}else if(1==e.nDisposalState){e.nDisposalState=2;e.FireEvent(u.EventID.OnDisposing)}return!0})}};l.prototype.BlockUpdatesInternal=function(e){if(!(e.nNotificationLayer>this.nNotificationLayer||e.id==this.id)){var t,n,r=!1;for(t=0,n=this.blockedUpdates.length;t<n;t++)if(e.id==this.blockedUpdates[t].id){r=!0;break}if(!r){e.bIsBlocked=!0;this.blockedUpdates.push(e)}}};l.prototype.UnblockUpdatesInternal=function(){for(;this.blockedUpdates.length>0;){var e=this.blockedUpdates.shift();e.bIsBlocked=!1;for(;e.pending.length>0;){e.pending.shift()()}e.Update()}};function c(e,t){var n=s().Notifications[e];Boolean(n)&&n.Hide(t)}window.addNotification=function(e,t,n,r,i){var s=new f(u.ContainerID.Basic,e,t,n,r);s.Show(i);return s.id};window.removeNotification=c})()};var o=5,u={ContainerID:{Basic:0,Status:1},EventID:{OnShow:0,OnHide:1,OnDisplayNotification:2,OnRemoveNotification:3,OnNotificationCountChanged:4,OnDisposing:5}};function a(){this.Initialize()}function f(e,t,n,r,i,s,o){this.Initialize(e,t,n,r,i,s,o)}function l(e,t,n,r){this.Initialize(e,t,n,r)}t.deleteSelectedItemsCore=function(e,t,n,o,u){e=(function(e){if(Boolean(e)&&void 0===e.clvp&&void 0!==e.ctxId){var t=window["ctx"+e.ctxId];if(t)return t}return e})(e);var a=t.length,f=e.clvp;f.EnsureChangeContext();var l=null,c=null;if(!((function(e){for(var t in e){var n=e[t];if(Boolean(n)&&void 0!==n.id&&Boolean(n.id)){var r=n.id;if(-1!=r.indexOf(".0.")||-1!=r.indexOf(".1.")||-1!=r.indexOf(".2."))return!0}}return!1})(t)||a<=0)){if(!Boolean(u)){var h="undefined"!=typeof Strings?Strings.STS.L_STSRecycleConfirm_Text:"";Boolean(e.RecycleBinEnabled)&&!e.ExternalDataList||(h="undefined"!=typeof Strings?Strings.STS.L_STSDelConfirm_Text:"");null!=e.overrideDeleteConfirmation&&(h=e.overrideDeleteConfirmation);Boolean(e.HasRelatedCascadeLists)&&null!=e.CascadeDeleteWarningMessage&&(h=e.CascadeDeleteWarningMessage+h);if(Boolean(e.HasRelatedCascadeLists)&&171==e.listTemplate){var p=!1,d=0;if(e.inGridMode){var v=window[g_SPGridInitInfo[e.view].controllerId];Sys.Debug.assert(null!=v);for(d=0;d<a;d++)if(v.IsParent(t[d])){p=!0;break}}else{var m=null!=r.GetClientHierarchyManagerForWebpart?r.GetClientHierarchyManagerForWebpart(e.wpq):null;if(null!=m)for(d=0;d<a;d++)if(m.IsParent(t[d])){p=!0;break}}h=p?"undefined"!=typeof Strings?Strings.STS.L_STSDelConfirmParentTask:"":"undefined"!=typeof Strings?Strings.STS.L_STSDelConfirm_Text:""}var g=(function(e,t){if(Boolean(ctx)&&Boolean(t)&&t.length>0&&Boolean(e)&&Boolean(e.ListData)){var n={},r=e.ListData.Row;if(Boolean(r)){for(var s=0;s<r.length;s++){var o=r[s];i.IsMountPoint(o)&&(n[o.ID]=o["FileLeafRef.Name"])}var u=null;for(var a in t){var f=t[a];if(Boolean(n[f])){null==u&&(u={});u[f]=n[f]}}return u}}return null})(f.ctx,t);if(Boolean(g)&&1===a){var y=g[t[0]];h=s.format("undefined"!=typeof Strings?Strings.STS.L_RemoveMountPointConfirmation:"",y)}if(!confirm(h))return}if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(f.ctx.RealHttpRoot)){c=new SP.ExceptionHandlingScope(f.cctx).startScope();l=new SP.RemoteWeb(f.cctx,f.ctx.HttpRoot);c.dispose()}for(var b=0;b<a;b++){var w=t[b];f.DeleteItemCore(String(w),l)}f.pendingItems=[];if(a>0){var E="undefined"!=typeof Strings?Strings.STS.L_Notification_Delete:"",S=addNotification(E,!0);f.cctx.executeQueryAsync(function(){if(void 0!==f.rgehs){if(1==f.rgehs.length&&f.rgehs[0].get_serverErrorCode()==SP.ClientErrorCodes.redirect&&"function"==typeof GoToPage){GoToPage(f.rgehs[0].get_serverErrorValue());return}removeNotification(S);f.ShowErrorDialog(n)}else null!=n&&n()},function(e,t){removeNotification(S);void 0!==f.rgehs&&f.ShowErrorDialog(o)})}}};t._CLVPDeleteItemCore=function(e,t,n){var r=1==e.ctx.listBaseType;e.EnsureChangeContext();var i,s,o=null;void 0===e.rgehs&&(e.rgehs=[]);i=new SP.ExceptionHandlingScope(e.cctx);e.rgehs.push(i);s=i.startScope();e.cctx.get_pendingRequest().set_navigateWhenServerRedirect(!0);var u=null;u=(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(e.ctx.RealHttpRoot)?n.getListById(e.ctx.listName):e.cctx.get_web().get_lists().getById(e.ctx.listName);o=e.ctx.ExternalDataList?u.getItemById(String(t)):u.getItemById(parseInt(t));if(r){o.retrieve("FileLeafRef");i.itmContext=o}Boolean(e.ctx.RecycleBinEnabled)&&!e.ctx.ExternalDataList?o.recycle():o.deleteObject();e.changePending=!0;s.dispose()};t._CLVPShowErrorDialog=function(e,t,n){var r,i=[],s=null,o=!1;function u(e,t,n){var r="s4-dlg-err-itm";if(!t){r="s4-dlg-err-firstitm";n.push(SP.Res.dlgTitleError)}var i=e.get_errorMessage();n.push('<div class="'+r+'">');if(void 0!==e.itmContext)try{n.push('<div class="s4-dlg-err-itmName">');n.push(e.itmContext.get_item("FileLeafRef"));n.push("</div>")}catch(e){n.push("</div>")}n.push('<div class="s4-dlg-err-itmMsg">');n.push(i);n.push("</div>");n.push("</div>")}if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(n)&&n.get_hasException()){u(n,o,i);o=!0}for(r in e.rgehs){var a=e.rgehs[r];if(a.get_hasException()&&(171!=e.ctx.listTemplate||-2147024809!=a.get_serverErrorCode())){u(a,o,i);o=!0}}if(o){i.push("<div class='ms-core-form-bottomButtonBox' id='dlgDivButton'><button id='ms-OKBtnDismissDlg' class='ms-ButtonHeightWidth' onclick='DismissErrDlg(this)'>");i.push(SP.Res.okButtonCaption);i.push("</button></div>")}var f=i.join("");if(f.length>0){var l=document.createElement("DIV");l.className="s4-dlg-err";l.innerHTML=f;var c={html:l,title:"undefined"!=typeof Strings?Strings.STS.L_ErrorDialog_Title:"",dialogReturnValueCallback:t};SP.UI.ModalDialog.showModalDialog(c);s=document.getElementById("ms-OKBtnDismissDlg");Boolean(s)&&s.focus()}else"function"==typeof t&&t();e.rgehs=[]}});
define("pGe",["require","exports","cGe","eGe","oGe","me","ce"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),a=o.Killswitch.isActivated("7B1ACA6D-A5F4-4412-BE1E-93F3F72B1A4F","3/10/2020","Fix XSS issue in some text columns."),f={ODB:1746},l=(function(){function e(e){this.ID="SPTextMaxLength";this.maxLengthTable=e;a||(this.LocalizedValueToCSRValue=function(e){return null==e?null:n.JsGridUtil.Internal.Encoding_STSHtmlEncode(e.replace(/\n/g,"<br>"))})}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;r=n.JsGridUtil.SPUserValueOnPasteFixup(r);var u=this.maxLengthTable[t];null!=r&&null!=u&&0!==u&&(r=r.substr(0,u));s({isValid:!0,dataValue:r,normalizedLocValue:r})};e.prototype.GetMaxLength=function(e){return this.maxLengthTable[e]};e.prototype.toString=function(){return this.ID};return e})();t.TextMaxLengthPropertyType=l;var c=(function(){function e(){this.ID="Number"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.DebugAssert(i);n.JsGridUtil.DebugAssert("string"==typeof r);r=n.JsGridUtil.SPUserValueOnPasteFixup(r);s({isValid:!0,dataValue:n.JsGridUtil.EmptyValue,normalizedLocValue:r.toUpperCase()})};return e})();t.NumberPropertyType=c;var h=(function(){function e(){this.ID="SPDateTime"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.DebugAssert(i);n.JsGridUtil.DebugAssert("string"==typeof r);r=n.JsGridUtil.SPUserValueOnPasteFixup(r);s({isValid:!0,dataValue:n.JsGridUtil.EmptyValue,normalizedLocValue:r.toUpperCase()})};return e})();t.DatePropertyType=h;var p=(function(){function e(){this.ID="SPPercentComplete"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.DebugAssert(i);s({isValid:!0,dataValue:null,normalizedLocValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r)})};return e})();t.PercentCompletePropertyType=p;var d=(function(){function e(){this.ID="SPEdit"}e.prototype.GetImageSource=function(e,t){return t&r.JsGridConstants.SPGPermissions.editListItems?n.JsGridUtil.Internal.SiteUrl+"/_layouts/images/edititem.gif":null};e.prototype.DataToLocalized=function(e){return e&r.JsGridConstants.SPGPermissions.editListItems?SP.Res.editColEditable:SP.Res.editColReadOnly};return e})();t.EditPropertyType=d;var v=(function(){function e(e){this.ID="SPUser";this.spGanttControl=e}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.hasPasteStarted=!1;var u=i?this.LocalizedToData(r):r,a=null!=u&&u!==n.JsGridUtil.EmptyValue&&u!==n.JsGridUtil.InvalidValue&&(Boolean(u.display!==u.email)||Boolean(u.length>1));s({isValid:!0,dataValue:u,normalizedLocValue:i&&!a?r:this.DataToLocalized(u)})};e.prototype.GetPeoplePickerSettings=function(e){return this.spGanttControl.customFieldInfo[e]};e.prototype.SetPeoplePickerDefaultSettings=function(e){this.spGanttControl.customFieldInfo[e]="User,SecGroup,SPGroup;#0;#false"};e.prototype.LocalizedToData=function(e){return this.Deserialize(e)};e.prototype.DataToLocalized=function(e){if(null==e)return null;var t=null;if(void 0===e.length)t=e.display;else{for(var r=[],i=0;i<e.length;i++)r.push(e[i].display);t=n.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(r,n.JsGridUtil.multiValSeparator,!1)}return t};e.prototype.IsDataEqual=function(e,t){if(null==e||null==t)return e==t;var n=function(e,t){return e.display==t.display&&e.email==t.email},r=!1;if(!e.hasOwnProperty("length")||!t.hasOwnProperty("length"))return n(e,t);if(e.length!==t.length)return!1;for(var i=0;i<e.length&&(r=n(e[i],t[i]));i++);return r};e.prototype.GetCopyValue=function(e,t,r){n.JsGridUtil.lastCopiedValueType_SPUser=!0;return null==t?r:this.Serialize(t)};e.prototype.SetSeparator=function(e){null!=e&&(n.JsGridUtil.multiValSeparator=1==e.length?e+" ":e)};e.prototype.deserializeSingleVal=function(e){var t=e.split(n.JsGridUtil.serializedFieldSeparator);return{display:t[0],email:void 0!==t[1]?t[1]:t[0]}};e.prototype.Deserialize=function(e){if(e==n.JsGridUtil.EmptyValue||""==e)return null;var t=e.split(n.JsGridUtil.multiValSeparator);if(1==t.length)return this.deserializeSingleVal(t[0]);for(var r=[],i=0;i<t.length;i++)r.push(this.deserializeSingleVal(t[i]));return r};e.prototype.svSerialize=function(e){return void 0===e.display||void 0===e.email?s.format("{0}{1}{2}",e.get_lookupValue(),n.JsGridUtil.serializedFieldSeparator,e.get_email()):s.format("{0}{1}{2}",e.display,n.JsGridUtil.serializedFieldSeparator,e.email)};e.prototype.Serialize=function(e){if(null==e)return null;var t=[];if(e.hasOwnProperty("email"))t.push(this.svSerialize(e));else if(e.hasOwnProperty("length"))for(var r=0;r<e.length;r++)null!=e[r].data?t.push(this.svSerialize(e[r].data)):t.push(this.svSerialize(e[r]));return n.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(t,n.JsGridUtil.multiValSeparator,!1)};return e})();t.UserPropertyType=v;var m=(function(){function e(e,t,n){var r=this;this.GetItems=function(e){r.EnsureEntriesCached(function(){for(var t=[],n=0;n<r._entries.length;n++)t.push(i.PropertyType.Property.prototype.MakeProperty(r._entries[n].id,r._entries[n].locValue,!0,!0,r));e(t)},function(){e(null)})};this.ID=e+"_Lookup";this._lookupFieldInfo=t;this._fileLoadUrl=n}e.prototype.InvalidateCache=function(){this._entries=null};e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){var u=this;this.EnsureEntriesCached(function(){if(!u._lookupFieldInfo.required&&i&&""==r||!i&&null==r)s({isValid:!0,dataValue:[],normalizedLocValue:""});else{var e=n.JsGridUtil.Internal.FindInArray(u._entries,i?function(e){return r==e.locValue}:function(e){return r==e.id});s(null==e?{isValid:!1}:{isValid:!0,dataValue:u._entries[e].id,normalizedLocValue:u._entries[e].locValue})}},o)};e.prototype.EnsureEntriesCached=function(e,t){var n=this;null==this._entries?this.GetFieldValues(this._lookupFieldInfo.webUrl,this._lookupFieldInfo.listId,this._lookupFieldInfo.field,function(r){if(null==r)t();else{n._entries=r;e()}}):e()};e.prototype.GetFieldValues=function(e,t,i,s){var o,a=this,l=function(){for(var e=[],t=o.get_count(),r=0;r<t;r++){var u=o.itemAt(r),a=u.get_fieldValues(),f=u.get_fieldValuesAsText().get_fieldValues();n.JsGridUtil.Internal.IsStrNullOrEmpty(f[i])||e.push({id:a.ID,locValue:f[i]})}s(e)},c=function(){s(null)},h=['<View Scope="RecursiveAll">',"<ViewFields>",'<FieldRef Name="ID"/>','<FieldRef Name="'+escape(i)+'"/>',"</ViewFields>",'<Query><OrderBy><FieldRef Name="'+escape(i)+'"/></OrderBy></Query>',"</View>"].join(""),p=function(){var n=new SP.ClientContext(e),r=n.get_web().get_lists().getById(t),s=new SP.CamlQuery;s.set_viewXml(h);var u=(o=r.getItems(s)).retrieveItems();u.retrieve("ID");u.retrieveObject("FieldValuesAsText").retrieve(i);n.add_requestSucceeded(l);n.add_requestFailed(c);n.executeQueryAsync()};if(!u&&n.JsGridUtil.Internal.IsFeatureEnabled(f)){var d=[n.JsGridUtil.taxonomyLoadCallback],v=r.JsGridConstants.csomFiles.map(function(e){return a._fileLoadUrl+e});n.JsGridUtil.csomJsFilesLoader._ensureExternalJsFilesLoaded(v,p,d)}else p()};return e})();t.LookupPropertyType=m;var g=(function(){function e(){this.ID="SPMultilineText"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r.replace(/<br>/g,"\n");s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return null==e?null:n.JsGridUtil.Internal.Encoding_STSHtmlEncode(e.replace(/\n/g,"<br>"))};return e})();t.MultilineTextPropertyType=g;var y=(function(){function e(){this.ID="SPEnhancedRichText"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return e};return e})();t.EnhancedRichTextPropertyType=y;var b=(function(){function e(){this.ID="SPImageThumbnail"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return e};return e})();t.ImageThumbnailPropertyType=b});
define("fGe",["require","exports","eGe","cGe","pze","ce","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o){"use strict";o=o.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var u=s.Killswitch.isActivated("CAF8B57F-023A-49B5-B7B6-A92006D95286","10/11/2019","Fix several issues with items positioned far off to the left causing RTL bugs."),a=s.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),f=s.Killswitch.isActivated("6BD41586-EA3C-4EDB-B381-53736E836DEA","03/04/2020","Fix when first element in a RTE editor is a <p> tag that collapses margins causing the editor to shift down in relation to the cell."),l={ODB:1725},c=(function(){function e(e){var t=this;this.SupportedWriteMode=n.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=n.JsGridConstants.EditActorReadType.LocalizedOnly;this.id="jsgrid_multilineeditbox";this.OnMouseDown=function(e){e.stopPropagation()};this.OnKeyDown=function(e){if(13!=e.keyCode&&"function"==typeof t.gridContext.OnKeyDown){e.StopInfiniteKeyDownLoop=!0;t.gridContext.OnKeyDown(e)}};this.gridContext=e;this.parentNode=e.parentNode;this.textArea=document.createElement("textarea");this.textArea.id=this.id;this.textArea.className=a?"jsgrid-control-multiline":r.JsGridUtil.Internal.IsFeatureEnabled(l)?o.jsgridControlMultilineTextarea:"jsgrid-control-multiline-quickedit";this.textArea.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;";this.textArea.tabIndex=-1;this.textArea.style.direction=e.RTL.ltr;this.parentNode.appendChild(this.textArea)}e.prototype.SizeToCellOrDefault=function(){var e,t;if(r.JsGridUtil.Internal.IsFeatureEnabled(l)){e=this.cellContext.cellWidth-3;t=this.cellContext.cellHeight-5}else{e=this.cellContext.cellWidth-6;t=this.cellContext.cellHeight-6}this.textArea.style.width=e+"px";this.textArea.style.height=t+"px"};e.prototype.SetupHandlers=function(e){if(e){this.textArea.addEventListener("focus",this.gridContext.OnActivateActor);this.textArea.addEventListener("blur",this.gridContext.OnDeactivateActor);this.textArea.addEventListener("keydown",this.OnKeyDown);this.textArea.addEventListener("mousedown",this.OnMouseDown)}else{this.textArea.removeEventListener("focus",this.gridContext.OnActivateActor);this.textArea.removeEventListener("blur",this.gridContext.OnDeactivateActor);this.textArea.removeEventListener("keydown",this.OnKeyDown);this.textArea.removeEventListener("mousedown",this.OnMouseDown)}};e.prototype.GetCSRFieldValue=function(){var e=this.cellContext.field.key;if(null!=this.cellContext.record.fieldRawDataMap.csrInfo){var t=this.cellContext.record.fieldRawDataMap.csrInfo[e];null!=t&&(t=(t=r.JsGridUtil.Internal.Encoding_STSHtmlDecode(t)).replace(/<br>/g,"\n"));return t}return null};e.prototype.SetCSRFieldValue=function(e){var t=e;null!=e&&(t=(t=r.JsGridUtil.Internal.Encoding_STSHtmlDecode(t)).replace(/\n/g,"<br>"));var n=this.cellContext.field.key;null==this.cellContext.record.fieldRawDataMap.csrInfo&&(this.cellContext.record.fieldRawDataMap.csrInfo={});this.cellContext.record.fieldRawDataMap.csrInfo[n]=t;this.cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this.textArea)};e.prototype.Focus=function(e){var t,i=this;try{this.textArea.focus();if(null==e)this.textArea.value=this.textArea.value;else if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==n.JsGridConstants.Key.F2)t=i.GetCSRFieldValue(),i.textArea.value=null==t||t==r.JsGridUtil.EmptyValue?"":t;else if(r.JsGridUtil.Utility.IsChar(e)){this.textArea.value=String.fromCharCode(e.charCode);this.SetCSRFieldValue(this.textArea.value)}}catch(e){r.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the MultilineEditControl while hidden?")}};e.prototype.BindToCell=function(e){this.cellContext=e;this.SizeToCellOrDefault();this.cellContext.field.textDirection!==n.JsGridConstants.TextDirection.Default&&(this.textArea.style.direction=this.cellContext.field.textDirection==n.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var t=this.GetCSRFieldValue();this.textArea.value=null==t||t==r.JsGridUtil.EmptyValue?"":t};e.prototype.OnBeginEdit=function(e){var t=this;this.cellContext.Show(this.textArea);this.bInEdit=!0;this.SetupHandlers(!0);"mousedown"==e.type?setTimeout(function(){t.Focus(e)},0):this.Focus(e)};e.prototype.Unbind=function(){this.textArea.value=""};e.prototype.OnEndEdit=function(){this.SetupHandlers(!1);var e=this.GetCSRFieldValue();e=null==e||e==r.JsGridUtil.EmptyValue?"":e;this.textArea.value!==e&&this.SetCSRFieldValue(this.textArea.value);this.cellContext.Hide(this.textArea);this.bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCellOrDefault();this.bInEdit&&this.cellContext.Show(this.textArea)};e.prototype.OnValueChanged=function(e){this.textArea.value=null==e.localized||e.localized==r.JsGridUtil.EmptyValue?"":e.localized};return e})();t.MultilinePlainTextEditControl=c;var h=(function(){function e(e,t){var i=this;this.SupportedWriteMode=n.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=n.JsGridConstants.EditActorReadType.LocalizedOnly;this.id="jsgrid_richtexteditbox";this.rteMinHeight=84;this.OnMouseDown=function(e){e.stopPropagation()};this.OnKeyDown=function(e){if(13!=e.keyCode&&"function"==typeof i.gridContext.OnKeyDown){e.StopInfiniteKeyDownLoop=!0;i.gridContext.OnKeyDown(e)}};this.gridContext=e;this.parentNode=e.parentNode;this.outerSpan=document.createElement("span");this.outerSpan.id=this.id;this.outerSpan.className=a?"jsgrid-control-rte":r.JsGridUtil.Internal.IsFeatureEnabled(l)?o.jsgridControlRteContainer:"jsgrid-control-rte-quickedit";this.outerSpan.style.cssText=u?"visibility:hidden;position:absolute;top:-10000px;left:-10000px;":"visibility:hidden;position:absolute;top:-10000px;"+e.RTL.left+":-10000px;";this.outerSpan.tabIndex=-1;this.divRteStateField=document.createElement("div");this.divRteStateField.className="ms-rtestate-field ms-rtefield ms-shadow";this.divRteStateField.style.minWidth="0px";this.divRteStateField.id=this.id+"_topDiv";var s=document.createElement("div");s.id=this.id+"_label";s.style.display="none";this.divRteStateWriteId=this.id="_rte"+(t||"");this.divRteStateWrite=null;this.divRteExtra=document.createElement("div");this.divRteExtra.style.clear="both";this.divRteStateField.appendChild(s);this.divRteStateField.appendChild(this.divRteExtra);this.outerSpan.appendChild(this.divRteStateField);var f=document.createElement("span");this.saveInputId=this.id+"_saveInput";this.saveInput=document.createElement("input");this.saveInput.id=this.saveInputId;this.saveInput.type="hidden";var c=document.createElement("input");c.id="ms-rtefocuselementid";c.name="ms-rtefocuselementid";c.type="hidden";f.appendChild(this.saveInput);f.appendChild(c);this.outerSpan.appendChild(f);this.parentNode.appendChild(this.outerSpan)}e.prototype.SizeToCellOrDefault=function(){var e,t;if(r.JsGridUtil.Internal.IsFeatureEnabled(l)){e=this.cellContext.cellWidth-5+"px";t=this.cellContext.cellHeight+"px"}else{e=this.cellContext.cellWidth-6+"px";t=this.cellContext.cellHeight-6+"px"}this.outerSpan.style.minWidth=e;this.outerSpan.style.minHeight=t;this.divRteStateWrite.style.minWidth=e;this.divRteStateWrite.style.minHeight=t};e.prototype.SetupHandlers=function(e){if(e){this.divRteStateWrite.addEventListener("focus",this.gridContext.OnActivateActor);this.divRteStateWrite.addEventListener("keydown",this.OnKeyDown);this.divRteStateWrite.addEventListener("mousedown",this.OnMouseDown)}else{this.divRteStateWrite.removeEventListener("focus",this.gridContext.OnActivateActor);this.divRteStateWrite.removeEventListener("keydown",this.OnKeyDown);this.divRteStateWrite.removeEventListener("mousedown",this.OnMouseDown)}};e.prototype.GetCSRFieldValue=function(){var e=this.cellContext.field.key;return null!=this.cellContext.record.fieldRawDataMap.csrInfo?this.cellContext.record.fieldRawDataMap.csrInfo[e]:null};e.prototype.SetCSRFieldValue=function(e){var t=this.cellContext.field.key;null==this.cellContext.record.fieldRawDataMap.csrInfo&&(this.cellContext.record.fieldRawDataMap.csrInfo={});this.cellContext.record.fieldRawDataMap.csrInfo[t]=e;this.cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this.divRteStateWrite)};e.prototype.Focus=function(e){var t=this;try{this.divRteStateWrite.focus();if(null==e){RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.update()}else if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==n.JsGridConstants.Key.F2)(function(){var e=t.GetCSRFieldValue();t.saveInput.value=null==e||e==r.JsGridUtil.EmptyValue?"":e;t.divRteStateWrite.innerHTML=t.saveInput.value;RTE.Cursor.get_range().moveToEndOfNode(t.divRteStateWrite);RTE.Cursor.update()})();else if(r.JsGridUtil.Utility.IsChar(e)){this.divRteStateWrite.innerHTML="";this.saveInput.value=String.fromCharCode(e.charCode);this.SetCSRFieldValue(this.saveInput.value);var i=document.createTextNode(this.saveInput.value);RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.get_range().insertNode(i);RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.update()}}catch(e){r.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the MultilineEditControl while hidden?")}};e.prototype.BindToCell=function(e){this.cellContext=e;this.RecreateDivRteStateWrite();this.SizeToCellOrDefault();this.cellContext.field.textDirection!==n.JsGridConstants.TextDirection.Default&&(this.divRteStateWrite.style.direction=this.cellContext.field.textDirection==n.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var t=this.GetCSRFieldValue();this.saveInput.value=null==t||t==r.JsGridUtil.EmptyValue?"":t;this.divRteStateWrite.innerHTML=this.saveInput.value};e.prototype.OnBeginEdit=function(e){var t=this;r.JsGridUtil.Internal.IsFeatureEnabled(l)?this.cellContext.Show(this.outerSpan,!0):this.cellContext.Show(this.outerSpan);this.bInEdit=!0;this.SetupHandlers(!0);"mousedown"==e.type?setTimeout(function(){t.Focus(e)},0):this.Focus(e)};e.prototype.Unbind=function(){this.saveInput.value="";this.divRteStateWrite.innerHTML=""};e.prototype.OnEndEdit=function(){this.SetupHandlers(!1);var e=this.GetCSRFieldValue();e=null==e||e==r.JsGridUtil.EmptyValue?"":e;RTE.RichTextEditor.transferContentsToInputField(this.divRteStateWriteId,!1);this.saveInput.value!==e&&this.SetCSRFieldValue(this.saveInput.value);this.cellContext.Hide(this.outerSpan);this.outerSpan.style.top="-10000px";u?this.outerSpan.style.left="-10000px":this.outerSpan.style[this.gridContext.RTL.left]="-10000px";this.bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCellOrDefault();this.bInEdit&&(r.JsGridUtil.Internal.IsFeatureEnabled(l)?this.cellContext.Show(this.outerSpan,!0):this.cellContext.Show(this.outerSpan))};e.prototype.OnValueChanged=function(e){this.saveInput.value=null==e.localized||e.localized==r.JsGridUtil.EmptyValue?"":e.localized;this.divRteStateWrite.innerHTML=this.saveInput.value};e.prototype.RecreateDivRteStateWrite=function(){if(null!=this.divRteStateWrite){this.divRteStateField.removeChild(this.divRteStateWrite);this.divRteStateWrite=null}this.divRteStateWrite=document.createElement("div");this.divRteStateWrite.className="ms-rtestate-write ms-rteflags-0 "+(f?"":o.msRteStateField);this.divRteStateWrite.id=this.divRteStateWriteId;this.divRteStateWrite.style.minHeight=this.rteMinHeight+"px";this.divRteStateWrite.setAttribute("aria-labelledby",this.id+"_label");this.divRteStateWrite.setAttribute("contentEditable","true");this.divRteStateWrite.style.direction=this.gridContext.RTL.ltr;this.divRteStateWrite.style.paddingLeft="3px";this.divRteStateWrite.style.paddingRight="3px";this.divRteStateField.appendChild(this.divRteStateWrite);null!=this.divRteStateWrite&&(this.divRteStateWrite.InputFieldId=this.saveInputId);null!=this.saveInput&&""==this.saveInput.value&&(this.saveInput.value=this.divRteStateWrite.innerHTML);RTE.Canvas.fixRegion(this.divRteStateWriteId,!1)};return e})();t.EnhancedRichTextEditControl=h;t.GetEditBoxEditControl=function(e,t){var n=t?i.EditControl.GetHyperlinkEditControl(e):new i.EditControl.EditBoxEditControl(e),r=n.BindToCell;n.BindToCell=function(e){r.call(this,e);var t=this.GetInputElement();"function"==typeof e.propType.GetMaxLength&&t.setAttribute("MaxLength",e.propType.GetMaxLength(e.fieldKey))};var s=n.Unbind;n.Unbind=function(){s.call(this);this.GetInputElement().setAttribute("MaxLength",null)};return n};t.GetPeoplePickerEditControl=function(e){var t=new i.EditControl.PeoplePickerEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetLocationPickerEditControl=function(e){var t=new i.EditControl.LocationPickerEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetCheckBoxEditControl=function(e){var t=new i.EditControl.CheckboxEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetTaxonomyPickerEditControl=function(e,t){var n=new i.EditControl.TaxonomyPickerEditControl(e,t),r=n.BindToCell;n.BindToCell=function(e){r.call(this,e)};var s=n.Unbind;n.Unbind=function(){s.call(this)};return n};t.GetHyperlinkEditControl=function(e){var t=new i.EditControl.HyperlinkEditControlV2(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetNumberBoxEditControl=function(e){var t=new i.EditControl.NumberEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetDatePickerEditControl=function(e){var t=new i.EditControl.DateEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t}});
define("LPe",["require","exports","lC","Kx","pv","Gx","kPe","eh"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=window.history,f=window.applicationCache,l=a&&!!a.pushState&&(!f||f.status===f.UNCACHED),c=(function(){function e(e){void 0===e&&(e={});this._viewParamsString="";this._dontBlockNextNav=!1;this._prevHash="";var t=e.disableHashConversion,n=void 0!==t&&t;this._performHashConversion=!n;this.viewParams={};this._scope=new u.default;this.beforeUnload=new r.default;this._scope.attach(this.beforeUnload);this._events=new i.default(this);this._events.declare("change");this._events.on(window,"hashchange",this._updateUrlState);this._events.on(window,"popstate",this._updateUrlState);this._updateUrlState()}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.navigateTo=function(e){var t=this;if(this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)})){var n="string"==typeof e?{url:e}:e,r=n.url,i=e.hasOwnProperty("viewParams")?e.viewParams:null,s=e.hasOwnProperty("directOpen")?e.directOpen:null,o=void 0,u=void 0;if(i&&"#"===i[0]){o=i.substr(1);u=r}else{o="#"===r[0]?r.substr(1):void 0;u=void 0}if(o)n.ignoreHistory?this._replaceState(o,!1,u):this._pushState(o,u);else{var a=void 0,f=!1;if(n&&n.frameId&&"_self"!==n.frameId)try{(a=window.open(s?r:"",n.frameId))&&"_blank"===n.frameId&&(a.opener=null);a&&!s&&(a.location.href=r);f=!0}catch(e){}if(!a&&!f)try{window.location.href=r}catch(e){}}}};e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var r="string"==typeof e?o.deserializeQuery(e):e,i=n.__assign(n.__assign({},t.clearOtherParams?{}:this.viewParams),r);t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)};e.prototype.reload=function(){window.location.reload()};e.prototype._updateUrlState=function(e){var t=this,n=!1,r=window.document.location,i=!1;if(this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var u="";if(r.href.indexOf("#")>-1){u=r.hash.substr(1);i=!0}else r.search.length&&(u=r.search.substr(1));var a=this._tryGetViewParamsBasedOnState(e),f=o.deserializeQuery(u),c=o.deserializeQuery(a),h=c,p=a;for(var d in f)if(c[d]!==f[d]){h=f;p=u;break}if(p!==this._viewParamsString){this._viewParamsString=p||"";this.viewParams=h;n=!0}i&&this._performHashConversion&&l&&this._replaceState(p);if(n){s.Nav.logData({url:r.href,viewParams:this.viewParams});this._events.raise("change")}this._prevHash=r.hash}else{n=!1;e&&e.preventDefault()}return n};e.prototype._tryGetViewParamsBasedOnState=function(e){var t="";if(e&&"popstate"===e.type&&e.state){var n=e.state,r=n.useViewParamsFromState,i=n.viewParams;r&&i&&(t=this._getViewParamsString(i))}return t};e.prototype._resetBeforeNavBlock=function(){this._dontBlockNextNav=!0;if(l)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)};e.prototype._pushState=function(e,t){var n=this._getViewParamsString(e);if(l)try{history.pushState({},"",this._getStateUrl(n))}catch(e){this._hashNav(n)}else this._hashNav(n);this._updateUrlState();t&&this._setMaskUrl(t)};e.prototype._replaceState=function(e,t,n){var r=this._getViewParamsString(e);if(l)try{history.replaceState({},"",this._getStateUrl(r,t))}catch(e){this._hashNav(r)}else this._hashNav(r);this._updateUrlState();n&&this._setMaskUrl(n)};e.prototype._setMaskUrl=function(e){if(e&&l){var t={useViewParamsFromState:!0,viewParams:this.viewParams};history.replaceState(t,"",e)}};e.prototype._getViewParamsString=function(e){return"string"==typeof e?e:o.serializeQuery(e)};e.prototype._getStateUrl=function(e,t){return(t?"/":document.location.pathname)+(e.length>0?"?":"")+e};e.prototype._hashNav=function(e){document.location.hash=e};return e})();t.Navigation=c;t.default=c});
define("kPe",["require","exports","w","u9"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.replaceQuery=function(e,t,n){var r=new RegExp("([?|&])"+t+"=([^&]+)","i");return e.replace(r,"$1"+t+"="+n)};t.deserializeQuery=n.deserializeQuery;t.serializeQuery=r.serializeQuery});
define("qze",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getErrorMessage=function(e){return"string"==typeof e?e:e.message}});
define("$ze",["require","exports","lC","r","pl","Hl","us","Ih","qr","nc","SPListItemsScopeDeferred_IS_mini_css","A","cGe","ce"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";l=l.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var d=p.Killswitch.isActivated("9F26415E-BD34-4DD5-905E-D4067CB79A3F","3/05/2020","Correctly calculate drop hint element locations when sticky headers are on."),v=[],m={ODB:1757},g={ODB:1725},y=(function(){function e(e){var t=this;this._draggedColumnIndex=-1;this._dropHintDetails={};this._updateDroppingState=function(e,n){t._draggedColumnIndex>=0&&"drop"!==n.type&&(e||t._resetDropHints())};this._onDragOver=function(e,n){if(t._draggedColumnIndex>=0){n.stopPropagation();try{t._computeDropHintToBeShown(n.clientX)}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToComputeDropHintToShow",error:e.message});t._qos=void 0}}}};this._onDrop=function(e,n){var r=t._columnReorderProps;if(t._draggedColumnIndex>=0&&n){var i=t._draggedColumnIndex>t._currentDropHintIndex?t._currentDropHintIndex:t._currentDropHintIndex-1,s=t._isValidCurrentDropHintIndex();n.stopPropagation();if(s){t._onDropIndexInfo.sourceIndex=t._draggedColumnIndex;t._onDropIndexInfo.targetIndex=i;if(r&&r.onColumnDrop){var o={draggedIndex:t._draggedColumnIndex,targetIndex:i};try{r.onColumnDrop(o);if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Success});t._qos=void 0}}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToDropColumn",error:e.message});t._qos=void 0}}}else r&&r.handleColumnReorder&&r.handleColumnReorder(t._draggedColumnIndex,i)}}t._resetDropHints();t._dropHintDetails={};t._draggedColumnIndex=-1};this._updateDragInfo=function(e,n){var r=t._columnReorderProps,i=e.itemIndex;if(i>=0){t._telemetry&&(t._qos=new(t._telemetry(c.Qos))({name:"QuickEditColumnReorder"}));t._draggedColumnIndex=i-1;try{t._getDropHintPositions()}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToGetDropHintPositions",error:e.message});t._qos=void 0}}r&&r.onColumnDragStart&&r.onColumnDragStart(!0)}else if(n&&t._draggedColumnIndex>=0){t._resetDropHints();t._draggedColumnIndex=-1;t._dropHintDetails={};if(r&&r.onColumnDragEnd){var s=t._isEventOnHeader(n);r.onColumnDragEnd({dropLocation:s},n)}}};this._onColumnDragStart=function(e){t.logEngagement({name:"ColumnDragStart",isIntentional:!0})};this._onColumnDragEnd=function(e,n){var r=t._columnReorderProps,i=s.ColumnDragEndLocation.outside;if(r&&r.onDragEnd){if(e.dropLocation&&e.dropLocation!==s.ColumnDragEndLocation.header)i=e.dropLocation;else if(t._rootElement){var o=t._rootElement.getBoundingClientRect();n.clientX>o.left&&n.clientX<o.right&&n.clientY>o.top&&n.clientY<o.bottom&&(i=s.ColumnDragEndLocation.surface)}r.onDragEnd(i)}};this._onDragEnd=function(e){t.logEngagement({name:"ColumnDragEnd",extraData:{DragEndLocation:s.ColumnDragEndLocation[e]},isIntentional:!0})};this._onColumnDrop=function(e,n){var r=t.getColumns()[n.draggedIndex];if(t.ganttControl){t.ganttControl.MoveColumn({columnInfo:r,dragDropDetails:n,onColumnChangeSucceeded:e.onColumnChangeSucceeded});t.logEngagement({name:"ReorderColumn",isIntentional:!0})}};this._telemetry=e.telemetry;this._baseEngagementData=e.baseEngagementData;this._events=e.events;this._dragDropHelper=new i.DragDropHelper({selection:{getSelection:function(){}}});this._currentDropHintIndex=-1;this._columnReorderProps={frozenColumnCountFromStart:0,frozenColumnCountFromEnd:0,onColumnDragStart:this._onColumnDragStart,onColumnDragEnd:this._onColumnDragEnd,onColumnDrop:this._onColumnDrop.bind(this,e),onDragEnd:this._onDragEnd};this._onDropIndexInfo={sourceIndex:-1,targetIndex:-1}}e.prototype.subscribe=function(){if(this._columnReorderProps)!this._subscriptionObject&&this._dragDropHelper&&this._rootElement&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement,this._events,this._getHeaderDragDropOptions()));else if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}};e.prototype.dispose=function(){if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}this._dragDropHelper&&this._dragDropHelper.dispose()};e.prototype.setPaneManager=function(e){this.paneMgr=e;this._rootElement=this.paneMgr.GetGridPane().tableMgr.GetColumnHeaderTr();this.subscribe()};e.prototype.setGanttControl=function(e){this.ganttControl=e};e.prototype.getDragDropHelper=function(){return this._dragDropHelper};e.prototype._getHeaderDragDropOptions=function(){return{selectionIndex:1,context:{data:this,index:0},canDrag:function(){return!1},canDrop:function(){return!0},onDragStart:function(){},updateDropState:this._updateDroppingState,onDrop:this._onDrop,onDragEnd:function(){},onDragOver:this._onDragOver}};e.prototype._isValidCurrentDropHintIndex=function(){return this._currentDropHintIndex>=0};e.prototype._resetDropHints=function(){if(this._currentDropHintIndex>=0){this._updateDropHintElement(this._dropHintDetails[this._currentDropHintIndex].dropHintElementRef,"none");this._currentDropHintIndex=-1}};e.prototype._updateDropHintElement=function(e,t){e.childNodes[1].style.display=t;e.childNodes[0].style.display=t};e.prototype._getDropHintPositions=function(){for(var e,t=this.getColumns(),n=this._columnReorderProps,r=0,i=0,s=n&&n.frozenColumnCountFromStart?n.frozenColumnCountFromStart:0,o=n&&n.frozenColumnCountFromEnd?n.frozenColumnCountFromEnd:0,u=0,a=s;a<t.length-o+1;a++)if(this._rootElement){var f=this._rootElement.querySelectorAll("#columnDropHint_"+a)[0];if(f){var l=f.offsetParent,c=f.offsetLeft+l.offsetLeft;if(a===s){r=c;i=c;e=f}else{!d&&h.JsGridUtil.Internal.IsFeatureEnabled(m)&&l&&l.parentElement&&(c=u+l.parentElement.clientWidth);var p=(c+r)/2;this._dropHintDetails[a-1]={originX:r,startX:i,endX:p,dropHintElementRef:e};i=p;e=f;r=c;a===t.length-o&&(this._dropHintDetails[a]={originX:r,startX:i,endX:c,dropHintElementRef:e})}!d&&h.JsGridUtil.Internal.IsFeatureEnabled(m)&&l&&l.parentElement&&(u+=l.parentElement.clientWidth)}}};e.prototype._liesBetween=function(e,t,n){return o.getRTL()?e<=t&&e>=n:e>=t&&e<=n};e.prototype._isBefore=function(e,t){return o.getRTL()?e>=t:e<=t};e.prototype._isAfter=function(e,t){return o.getRTL()?e<=t:e>=t};e.prototype._computeDropHintToBeShown=function(e){if(this._rootElement){var t=e-this._rootElement.getBoundingClientRect().left,n=this._currentDropHintIndex;if(this._isValidCurrentDropHintIndex()&&this._liesBetween(t,this._dropHintDetails[n].startX,this._dropHintDetails[n].endX))return;var r=this.getColumns(),i=this._columnReorderProps,s=i&&i.frozenColumnCountFromStart?i.frozenColumnCountFromStart:0,o=i&&i.frozenColumnCountFromEnd?i.frozenColumnCountFromEnd:0,u=s,a=r.length-o,f=-1;this._isBefore(t,this._dropHintDetails[u].endX)?f=u:this._isAfter(t,this._dropHintDetails[a].startX)?f=a:this._isValidCurrentDropHintIndex()&&(this._dropHintDetails[n+1]&&this._liesBetween(t,this._dropHintDetails[n+1].startX,this._dropHintDetails[n+1].endX)?f=n+1:this._dropHintDetails[n-1]&&this._liesBetween(t,this._dropHintDetails[n-1].startX,this._dropHintDetails[n-1].endX)&&(f=n-1));if(-1===f)for(var l=s,c=a;l<c;){var h=Math.ceil((c+l)/2);if(this._liesBetween(t,this._dropHintDetails[h].startX,this._dropHintDetails[h].endX)){f=h;break}this._isBefore(t,this._dropHintDetails[h].originX)?c=h:this._isAfter(t,this._dropHintDetails[h].originX)&&(l=h)}if(f===this._draggedColumnIndex||f===this._draggedColumnIndex+1)this._isValidCurrentDropHintIndex()&&this._resetDropHints();else if(n!==f&&f>=0){this._resetDropHints();this._updateDropHintElement(this._dropHintDetails[f].dropHintElementRef,"inline-block");this._currentDropHintIndex=f}}};e.prototype._isEventOnHeader=function(e){if(this._rootElement){var t=this._rootElement.getBoundingClientRect();if(e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom)return s.ColumnDragEndLocation.header}};e.prototype.logEngagement=function(e){this._telemetry&&this._telemetry(u.default).logData(n.__assign(n.__assign({},this._baseEngagementData),{component:"SPGrid",name:e.name,extraData:a.graft(this._baseEngagementData.extraData,e.extraData),isIntentional:e.isIntentional}))};e.prototype.getColumns=function(){var e=this.paneMgr.GetColumns(null);e||(e=v);return e};e.prototype.renderDropHint=function(e){var t=h.JsGridUtil.Internal.IsFeatureEnabled(g),n=t?" "+l.containerRefreshed:"",i=t?" "+l.caretRefreshed:"",s=t?" "+l.lineRefreshed:"";return r.createElement("div",{key:"dropHintKey",className:""+l.dropHintStyle+n,id:"columnDropHint_"+e},r.createElement(f.Icon,{key:"dropHintCaretKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:""+l.dropHintCaretStyle+i,iconName:"CaretUpSolid8"}),r.createElement("div",{key:"dropHintLineKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:""+l.dropHintLineStyle+s}))};return e})();t.ColumnDragDropManager=y});
define("Y7e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.newItemCreated="clientFormNewItemCreated";e.itemUpdated="clientFormItemUpdated";return e})();t.ClientFormEvents=n;t.default=n});
define("uze",["require","exports","lC","r","o","$t","Ar"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=0,a=s.createMemoizer(function(e){return""+ ++u});t.usePortalManager=function(){var e=r.useState(function(){return{}}),t=e[0],s=e[1],u=o.useEventHandler(function(e,t){s(function(r){var s,o=a(t);return n.__assign(n.__assign({},r),((s={})[o]=i.createPortal(e,t),s))})}),f=o.useEventHandler(function(e){s(function(t){var r=a(e);t[r];return n.__rest(t,["symbol"==typeof r?r:r+""])})}),l=r.useRef(),c=l.current||(l.current={render:u,unmount:f}),h=r.useMemo(function(){return r.createElement(r.Fragment,null,Object.keys(t).map(function(e){return r.createElement(r.Fragment,{key:e},t[e])}))},[t]);return r.useMemo(function(){return[c,h]},[c,h])}});
define("ZGe",["require","exports","lC","r","qh","l0","eKe","Yr","wr","GC","O1","zc","$Ge"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=u.withItemSetSelection(void 0,{isPrivate:!0})(a.withSelectedItemsContextMenu()(f.ItemSetTilesList)),d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey,t=n.__assign({},s.itemSetTilesListControl.pack(v));return r.createElement(l.ControlHandlerProvider,{controlHandlers:t},r.createElement(p,{itemKey:e,selectionMode:c.SelectionMode.multiple,doNotRenderShimmerTile:!0,disableMarqueeSelection:!0,ariaLabel:h.default.pinnedItemRegionLabel,"data-automationid":"PinnedItemsCardList"}))};return t})(r.PureComponent);t.PinnedItemCardListDefer=d;function v(e,t){var n=t.responsiveMode,r=void 0===n?i.ResponsiveMode.xxLarge:n,s=r<=i.ResponsiveMode.xLarge?216:259,u=r<=i.ResponsiveMode.xLarge?180:190;return{tileRenderer:o.PinnedItemCardRenderer,tileControlHandler:function(){return{desiredSize:{width:s,height:u}}},grid:{minRowHeight:u}}}});
define("eKe",["require","exports","lC","r","wV","qv","lO","Ec","Rs","Jf","oi","c_","SPListItemsScopeDeferred_IS_mini_css","ii","n9","i_","C1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";h=h.PinnedItemsCardRenderer_0;Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(u.WithItemCache,null,function(n){var o=n.itemCache,u=o.demandItemFacet(p.friendlyDateModifiedFacet,t),a=!1,f=m.evaluateItemCacheComponent(o,r.createElement(s.ItemActivityField,{itemKey:t,isCompact:!0,hideDate:!0}));if(null===f){a=!0;f=u?r.createElement(d.DateField,{text:u}):r.createElement("div",null)}var l=v.getLifeCycleSignals(o,t,3,!0),h=l&&l.map(function(e){return e.signal}),g=a?f:r.createElement(c.SignalField,{signalsFieldMode:"compact",after:h},f);return r.createElement(i.ItemCard,{key:t,telemetryPrefix:"PinnedItemCardRenderer",itemActivityElement:g,folderCoverElement:e._renderFolderCoverElement(),itemKey:t,cardIndex:e.props.selectionIndex||0,itemSetKey:t,selection:e.props.selection,selectionIndex:e.props.selectionIndex,isSelectable:!0,hideThumbnail:!1,inlineFileIcon:!1})})};t.prototype._renderFolderCoverElement=function(){var e=this,t=this.props.itemKey;return r.createElement(u.WithItemCache,null,function(n){var i=n.itemCache.demandItem({isFolder:a.folderFacet,count:f.countFacet,oneNote:l.oneNoteFacet,isShared:a.isSharedFacet},t),s=i.isFolder,u=i.count,c=i.oneNote,p=i.isShared;if(s&&!c){var d=r.createElement(o.FolderCover,{key:"folder",className:h.folderCover,folderCoverSize:"large",folderCoverType:"default",metadata:u,signal:e._getFolderCoverSignal(p),isFluent:!0}),v=o.getFolderCoverLayout(d).contentSize;return o.renderFolderCoverWithLayout(d,{children:u?r.createElement("span",{className:h.blankFolderCover,style:{width:v.width+"px",height:v.height+"px"}}):null})}return null})};t.prototype._getFolderCoverSignal=function(e){return e?r.createElement(c.SharedSignal,null):null};return t})(r.PureComponent);t.PinnedItemCardRenderer=g});
define("nKe",["require","exports","lC","aKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("aKe",["require","exports","lC","li","ih","ho","ii","Z0","k$","A$","Mv","Te","So","Rs","sS","Rf","N6","ce","Y"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemSyncDialogControlHandler=i.createControlHandler()(function(){return function(t){var i=(function(e){var t;t=e.isMac?"https://go.microsoft.com/fwlink/p/?LinkId=248255":e.isWindows?"https://go.microsoft.com/fwlink/p/?LinkId=248256":"https://go.microsoft.com/fwlink/?LinkID=708540";return t})(new v.PlatformDetection);return function(t,v){var w=this,E=t.demandItemFacet(r.spItemKeyFacet,v.itemKey);if(!E)return{};var S=E&&r.spPageContextKeyFacet.serialize(E),x=t.demandItemFacet(o.spPageContextFacet,S);if(!x)return{};var T=r.spListKeyFacet.serialize(E),N=t.demandItemFacet(o.listFacet,T);if(!N)return{};var C=Number(x.webTemplate)===u.WebTemplateType.mySite,k=new d.SimpleUri(E.webAbsoluteUrl).authority,L=r.spTenantKeyFacet.serialize({tenantRootUrl:k}),A=t.demandItemFacet(p.folderFacet,v.itemKey),O=t.demandItemFacet(o.spDataSourceConfigurationFacet,h.configurationItemKey);return{userLoginName:x.userLoginName,clientDownloadUrl:i,isTenantAdmin:s.createAsyncActionCreator(function(t){return function(t){return n.__awaiter(w,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,new Promise(function(t,n){e(["sA"],t,n)})];case 1:r=n.sent().demandItems;return[4,t(r(function(e){return e.demandItemFacet(o.spTenantAdminFacet,L)}))];case 2:return[2,!!n.sent()];case 3:n.sent();return[2,!1];case 4:return[2]}})})}}),getSyncInfo:s.createAsyncActionCreator(function(t){return function(t){return n.__awaiter(w,void 0,void 0,function(){var r,i,s,o,u,h,p=this;return n.__generator(this,function(d){switch(d.label){case 0:r=new a.SyncDataSource({},{pageContext:x,dataRequestorType:(function(e){n.__extends(t,e);function t(t){return e.call(this,t,{pageContext:x})||this}return t})(l.DataRequestor),getAuthToken:O&&O.ensureAuthToken,apiUrlHelperType:c.ApiUrlHelperBasic});return[4,f.getSyncQueryParams({getUserInfo:function(){return n.__awaiter(p,void 0,void 0,function(){var i,s,o,u,a,f;return n.__generator(this,function(l){switch(l.label){case 0:i=x&&g.getKillSwitch(x).isActivated("8CCCA24D-26C2-4FBD-85EF-734251D8E89A","4/20/2020","Avoid OneDrive lookup for guest users.");s=!i&&(x.isAnonymousGuestUser||x.isExternalGuestUser||x.isEmailAuthenticationGuestUser);if(!C||s)return[3,5];l.label=1;case 1:l.trys.push([1,4,,5]);return[4,new Promise(function(t,n){e(["sA"],t,n)})];case 2:u=l.sent().demandItems;return[4,t(u(function(e){return m.getUserOneDriveUrl(e,{tenantRootUrl:k})}))];case 3:o=l.sent();return[3,5];case 4:a=l.sent();y.default.logError(a);return[3,5];case 5:f=[{}];return[4,r.getSyncUserInfo({webUrl:E.webAbsoluteUrl})];case 6:return[2,n.__assign.apply(void 0,[n.__assign.apply(void 0,f.concat([l.sent()])),{oneDriveWebUrl:o}])]}})})},getWebInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){if(!x.siteId)throw new Error("Unknown siteId for Sync.");if(!x.webId)throw new Error("Unknown webId for Sync.");return[2,{onPrem:!x.isSPO,siteId:x.siteId,webId:x.webId,webLogoUrl:x.webLogoUrl,webTemplateType:Number(x.webTemplate),webTitle:x.webTitle,webUrl:E.webAbsoluteUrl}]})})},getListInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){if(!N.id)throw new Error("Unknown listId for Sync.");if(!N.title)throw new Error("Unknown list title for Sync.");return[2,{listId:N.id,listTemplateType:N.templateType,listTitle:N.title}]})})},getFolderInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return A&&E.rootFolder?[4,t(b({itemKey:v.itemKey,spItem:E}))]:[2,void 0];case 1:return[2,e.sent()]}})})}},x)];case 1:i=d.sent();s=!g.getKillSwitch(x).isActivated("7b4719be-2180-47f6-8e5e-af8d3ac9a5e4","08/23/2019","siteSubscriptionID is diff from AADtenantID");o=x&&x.siteSubscriptionId||"";u=x&&x.aadTenantId||"";return s&&o!==u?[4,f.getSyncConfigParams(u,i)]:[3,3];case 2:h=d.sent();return[3,5];case 3:return[4,f.getSyncConfigParams(o,i)];case 4:h=d.sent();d.label=5;case 5:return[2,{protocolUrl:f.getSyncProtocolUrl(i),syncConfigParams:h}]}})})}})}}}});function b(t){var r=this,i=t.itemKey,s=t.spItem;return function(t){return n.__awaiter(r,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["sA"],t,n)})];case 1:r=n.sent().demandItems;return[2,t(r(function(e){var t=e.demandItemFacet(p.fileNameFacet,i),n=t&&t.name,r=e.demandItemFacet(o.uniqueIdFacet,i),u=e.demandItemFacet(o.folderPathFacet,i);if(!r)throw new Error("Unable to determine folderId for Sync.");if(!n)throw new Error("Unable to determine folderName for Sync.");return{folderName:n,folderId:r,folderUrl:""+new d.SimpleUri(s.webAbsoluteUrl).authority+u}}))]}})})}}});
define("iKe",["require","exports","lC","$1","Hm","rKe","PD"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateFileCardAddon=i.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(i.registerOperationHandler(o.substrateRelatedFilesKeyFacet,r.getItemsOperation)(s.relatedFilesGetItemsOperationHandler));return[2]})})}})});
define("rKe",["require","exports","lC","Hm","bB","Vm","PD","oKe","Xo","Rs","de","rs","Xy","ph","ce"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.relatedFilesGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,v=o.substrateRelatedFilesKeyFacet.deserialize(r);return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,o,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H;return n.__generator(this,function(B){switch(B.label){case 0:t=r(c.readItems(function(e){return e.demandItemFacet(p.driveItemKeyFacet,v.itemKey)}));o=t&&t.itemId;m=r(c.readItems(function(e){return h.getPageContextFromItemCache(e,v.itemKey)}));g=m&&m.listId&&m.listId.replace(/{|}/g,"");y=m&&m.siteId&&m.siteId.replace(/{|}/g,"");b=m&&m.webId&&m.webId.replace(/{|}/g,"");if(!(o&&m&&g&&y&&b)){(w=new Error("Missing itemId or pageContext for Substrate related files request")).name="missingItemInformation";throw w}E=(function(e,t,n,r){var i=encodeURI(t+","+n+","+r);return"SPO_"+btoa(i).slice(0,-1)+"_"+e})(o,y,b,g);S="/search/api/v1/recommendations";return[4,r(i.getAuthToken())];case 1:x=B.sent();"FileCard.RelatedFiles";T={EntityRequests:[{EntityType:"Document",Context:{EntityId:E}}],LogicalId:l.default.generate(),Scenario:{Name:"fileinsights"}};return[4,r(i.getData({qosName:"FileCard.RelatedFiles",path:S,method:"POST",token:x,body:T,timeOut:d.Killswitch.isActivated("db63a446-a15b-418d-ad2b-9677ffaa6c0f","07/23/2020","timeout option for getData")?void 0:6e3}))];case 2:N=B.sent();C=new s.ItemResolver;k=N.EntitySets[0].ResultSets[0];L=[];if(k.Results){A=k.Results;for(O=0,M=A;O<M.length;O++)if((_=M[O]).Source.FileName&&_.Source.WebUrl){D=u.relatedFilesItemSetKeyFacet.serialize({fileId:_.Id});L.push(D);C.resolveItems({items:(P={},P[D]=n.__assign(n.__assign({},f.displayNameFacet.pack(_.Source.FileName)),f.openUrlFacet.pack(_.Source.WebUrl)),P)})}}C.resolveItems({items:(H={},H[e.itemKey]=n.__assign({},a.childItemsFacet.pack({itemKeys:L})),H)});r(C.execute());return[2]}})})}})});
define("bB",["require","exports","lC","K","Rm","xo","P1","So","ko","Io","EI","vB","gB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function p(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:e=t(f.readConfiguration({tokenFetcher:l.tokenFetcherConfigurationFacet})).tokenFetcher;return(r=e)?[4,e.getToken("https://substrate.office.com")]:[3,2];case 1:r=n.sent();n.label=2;case 2:return[2,r]}})})}}t.getAuthToken=p;t.getData=function(e){var t=this,f=e.method,l=e.path,m=e.body,g=e.timeOut;return function(y){return n.__awaiter(t,void 0,void 0,function(){var t,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return n.__generator(this,function(n){switch(n.label){case 0:t=y(s.readItem({config:h.substrateConfigurationFacet,headerConfig:c.substrateHeaderConfigurationFacet},u.configurationItemKey)),b=t.config,w=t.headerConfig;return b&&b.getData?[4,b.getData(e)]:[3,2];case 1:return[2,n.sent()];case 2:return(S=e.token)?[3,4]:[4,y(p())];case 3:S=n.sent();n.label=4;case 4:E=S;x=new Headers;m&&x.set("Content-Type","application/json");E&&x.set("Authorization","Bearer "+E);T=r.generate();x.set("X-CorrelationId",T);if(w){w.applicationId&&x.set("X-Office-Application",w.applicationId);w.aadUserId&&w.aadTenantId&&x.set("X-AnchorMailbox",w.aadUserId+"@"+w.aadTenantId)}N={headers:x,credentials:"omit",method:f,mode:"cors",cache:"default",body:m?JSON.stringify(m):void 0};C=y(i.logQoS({name:"substrate.getData."+e.qosName,extraData:{correlationId:T}}));n.label=5;case 5:n.trys.push([5,13,,14]);k=void 0;return g?[4,v("https://substrate.office.com"+l,N,g)]:[3,7];case 6:k=n.sent();return[3,9];case 7:return[4,fetch("https://substrate.office.com"+l,N)];case 8:k=n.sent();n.label=9;case 9:return k.ok?[3,11]:[4,d(k)];case 10:L=n.sent();y(C(L));throw new a.ItemOperationError({message:L.error});case 11:A=k.headers.get("x-rdl-latency");y(C({resultType:o.ResultType.success,extraData:{serverLatency:A}}));return[4,k.json()];case 12:return[2,n.sent()];case 13:O=n.sent();M=O&&O.message||"No error message given.";_="A failure occurred while trying to fetch a substrate resource ("+M+")";y(C({resultType:o.ResultType.failure,error:_}));throw O;case 14:return[2]}})})}};function d(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,e.json()];case 1:t=n.sent();return[3,3];case 2:r=n.sent();return[2,{resultType:o.ResultType.failure,error:r.message,resultCode:"["+e.status+"] ResponseParseFailure",extraData:{url:e.url}}];case 3:i=t&&t.error_data&&t.error_data.message||"Unknown substrate error response";return[2,{resultType:o.ResultType.failure,error:i,resultCode:"["+e.status+"] "+(t&&t.response_code||"UnknownError"),extraData:{url:e.url,diagnostics:JSON.stringify(t&&t.diagnostics_data)}}]}})})}t.handleSubstrateError=d;function v(e,t,n){var r=new Promise(function(e,t){setTimeout(function(){return t(new Error("Request Timeout"))},n)});return Promise.race([fetch(e,t),r]).then(function(e){return e})}});
define("vB",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateHeaderConfigurationFacet=new n.Facet("substrateHeaderConfiguration")});
define("gB",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateConfigurationFacet=new n.Facet("substrateConfiguration")});
define("PD",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateRelatedFilesKeyFacet=new n.KeyFacet("substrateRelatedFiles",{itemKey:n.stringPart()})});
define("oKe",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.relatedFilesItemSetKeyFacet=new n.KeyFacet("relatedFilesItem",{fileId:n.stringPart()})});
define("GK",["require","exports","lC","Hm","lh","J1","ih","E1","Yq","jW","G9","RW","ph","b_","py","Bm","HW","Np","TW","t4","PW","MW","Qp","kW","x1","LW","$f","AW","wW","$1","OW","CW","_c","bI","IW","gW","Sg","Y3","T1","pW","nW","KK"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var U=b.asModuleWithRetries(function(){return new Promise(function(t,n){e(["nQ"],t,n)})},{chunkName:"graphaddondeferred"});t.graphAddon=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,b;return n.__generator(this,function(n){switch(n.label){case 0:e(C.asBatch(function(){e(f.graphAddonDataOnly);e(o.registerControlHandler(m.driveItemSetKeyFacet,u.itemSetColumnsControl)(w.driveItemSetColumnsControlHandler));e(o.registerControlHandler(m.driveItemSetKeyFacet,S.sortedItemSetControl)(x.driveItemSortedItemSetControlHandler));e(o.registerControlHandler(i.sharedWithMeItemSetKeyFacet,u.itemSetColumnsControl)(a.sharedWithMeRootItemSetColumnsControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,p.itemHoverCardControl)(l.driveItemHoverCardControlHandler));e(o.registerControlHandler(m.driveItemSetKeyFacet,g.itemSetPagingControl)(y.driveItemSetPagingControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,T.moveCopyActionControl)(N.driveItemMoveCopyActionControlHandler));e(r.registerOperationHandler(k.thumbnailTokenKeyFacet,A.getItemsOperation)(L.thumbnailUrlTokenOperationHandler));e(o.registerControlHandler(h.driveItemKeyFacet,d.itemThumbnailControl)(c.driveItemThumbnailControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,_.itemFileTypeIconControl)(O.specialFolderIconControlHandler));e(o.registerControlHandler(M.specialDriveItemKeyFacet,_.itemFileTypeIconControl)(O.specialFolderIconControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,D.itemTileControl)(P.specialFolderTileControlHandler));e(o.registerControlHandler(M.specialDriveItemKeyFacet,D.itemTileControl)(P.specialFolderTileControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,F.defaultClickActionControl)(I.defaultClickActionControlHandler));e(o.registerControlHandler(j.recentRootItemKeyFacet,B.itemsCommandBarControl)(H.itemsCommandBarControlHandler));e(E.graphItemActivityAddon);e(q.graphRecentAddon);e(R.graphSavedForLaterAddon)}));return[4,e(s.waitForPageLoad({waitIndefinitely:!0}))];case 1:n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,U()];case 3:if(!(t=n.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:b=n.sent();e(v.handleError({error:b}));return[3,5];case 5:return[2]}})})}})});
define("Yq",["require","exports","ih","tW","bL","tQ","Jq"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateSharedColumn,o.sharedByColumn];function a(e,t){return{columns:u}}});
define("tW",["require","exports","lC","B_","Kv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileTypeIconColumn=n.__assign(n.__assign({},r.fileTypeIconColumn),{key:i.FILE_TYPE_ICON_COLUMN_KEY,minWidth:32,maxWidth:32})});
define("tQ",["require","exports","L7","Wv","A_","UB","n9","So","Kv"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateSharedColumn=i.createColumn({name:r.default.dateSharedColumnHeaderText,key:a.DATE_SHARED_COLUMN_KEY,fieldName:"",minWidth:i.ColumnWidth.regularMin,maxWidth:i.ColumnWidth.regularMax,isCollapsable:!0,sortProps:i.DATE_COLUMN_SORT_PROPS},o.DateField)(function(e,t){var r=e.demandItemFacet(s.sharedFacet,t),i=r&&new Date(r.sharedDateTime).getTime();if("number"!=typeof i||isNaN(i))return{text:""};var o=e.demandItemFacet(u.localeFacet,u.configurationItemKey);return o&&o.language||window.navigator.language?{text:n.getRelativeDateTimeStringPast(new Date(i),!1)}:{dateValue:i}})});
define("UB",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedFacet=new n.Facet("shared")});
define("Jq",["require","exports","Wv","A_","X4","Kv","oy","XW","JW","eQ","r","Zq","SPListItemsScopeDeferred_IS_mini_css","Xo","UB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";h=h.TopCollaborator_8;Object.defineProperty(t,"__esModule",{value:!0});t.sharedByColumn=r.createColumn({name:n.default.sharedByColumnHeaderText,key:s.SHARED_BY_COLUMN_KEY,fieldName:"",minWidth:r.ColumnWidth.regularMin,maxWidth:r.ColumnWidth.regularMax,isCollapsable:!0,sortProps:r.TEXT_COLUMN_SORT_PROPS,headerClassName:h.columnHeader},i.UserFieldRenderer)(function(e,t){var n=e.demandItem({shareByPerson:u.sharedByPersonFacet},t).shareByPerson,r=e.demandItem({sharedBy:d.sharedFacet},t).sharedBy,i=n&&n.itemKey,s=n&&n.displayValue||r&&r.sharedBy&&r.sharedBy.user&&r.sharedBy.user.displayName,v=!1;if(i&&a.userByEmailKeyFacet.matches(i)){var m=a.userByEmailKeyFacet.deserialize(i).email,g=e.demandItemFacet(p.childItemsFacet,f.topCollaboratorSetKeyFacet.serialize({endpoint:"https://graph.microsoft.com/beta"}));g&&(v=g.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(o.emailFacet,t);return!!n&&n===m}))}return i||s?{people:[{itemKey:i||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return l.createElement("div",{className:h.userWithTopCollaborator},l.createElement(c.TopCollaborator,{userName:r.title,isPlaceholder:!v}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(o.emailFacet,t)})});
define("XW",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByPersonFacet=new n.Facet("sharedBy")});
define("JW",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.userByEmailKeyFacet=new n.KeyFacet("userByEmail",{email:n.stringPart(),endpoint:n.stringPart()})});
define("eQ",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorSetKeyFacet=new n.KeyFacet("topCollaboratorSetKeyFacet",{endpoint:n.stringPart()})});
define("Zq",["require","exports","lC","r","us","nc","pe","Au","$q","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";f=f.TopCollaborator_8;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,i=r.createElement(s.Icon,{className:f.topCollaboratorIcon,iconName:"TeamFavorite"}),l=r.createElement("span",{className:f.topCollaboratorUserName},t),c=r.createElement("div",{className:f.topCollaboratorTooltip},o.formatToArray(a.default.topCollaboratorWith,l));return r.createElement("div",{className:f.topCollaPlaceHolder},n?null:t?r.createElement(u.TooltipHost,{content:c},i):i)};return t})(i.BaseComponent);t.TopCollaborator=l});
define("jW",["require","exports","lC","Hm","Xo","Rs","s6","$1","Qq","Gq","zq","Vq","jq","Mq","kq","Lq","Aq","Eq","Oq","Cq","xq","Iq","yq","ph","$7","gq","bq","CD","lh","hq","_q","Y3","K9","CW","Q3","ox","mq","Z7","X7","pq","fq","U1","ih","uq","J1","H8","lq","E0","l1","dq","cq","Bm","sq","oq","w5","FW","VW","t4","$f"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var se=re.asModuleWithRetries(function(){return new Promise(function(t,n){e(["yQ"],t,n)})},{chunkName:"graphaddondeferred"});t.graphAddonDataOnly=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,re;return n.__generator(this,function(n){switch(n.label){case 0:e(ie.asBatch(function(){e(u.supportFacets({keyFacet:x.driveItemKeyFacet,facets:[x.driveItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,s.canonicalUrlFacet,s.eTagFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:C.driveItemPageKeyFacet,facets:[C.driveItemPageKeyFacet,i.childItemsFacet,i.pageFacet]}));e(u.supportFacets({keyFacet:k.sharedWithMeRootItemKeyFacet,facets:[k.sharedWithMeRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.canonicalUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:L.sharedWithMeItemSetKeyFacet,facets:[L.sharedWithMeItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:A.sharedByMeRootItemKeyFacet,facets:[A.sharedByMeRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.canonicalUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:O.sharedByMeItemSetKeyFacet,facets:[O.sharedByMeItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:M.recentRootItemKeyFacet,facets:[M.recentRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:_.recentItemSetKeyFacet,facets:[_.recentItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:P.savedForLaterRootItemKeyFacet,facets:[P.savedForLaterRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet]}));e(u.supportFacets({keyFacet:Q.commandsItemKeyFacet,facets:[z.addToOneDriveFacet,z.createFolderFacet,z.createLinkFacet,z.deleteFacet,z.downloadFacet,z.inviteFacet,z.moveFacet,z.officeLensFacet,z.renameFacet,z.uploadFacet]}));e(N.graphAddonDriveItemSet);e(r.registerOperationHandler(x.driveItemKeyFacet,u.getItemsOperation)(a.driveItemGetItemsOperationHandler));e(r.registerOperationHandler(te.driveItemVirtualizedPageKeyFacet,u.getItemsOperation)(ne.driveItemVirtualizedPageGetItemsOperationHandler));e(r.registerOperationHandler(T.driveAnalyticsItemKeyFacet,u.getItemsOperation)(f.driveAnalyticsItemGetItemsOperationHandler));e(r.registerOperationHandler(D.specialDriveItemKeyFacet,u.getItemsOperation)(l.specialDriveItemGetItemsOperationHandler));e(r.registerOperationHandler(Y.sharesItemKeyFacet,u.getItemsOperation)(Z.sharesItemGetItemsOperationHandler));e(r.registerOperationHandler(C.driveItemPageKeyFacet,u.getItemsOperation)(c.driveItemPageGetItemsOperationHandler));e(r.registerOperationHandler(k.sharedWithMeRootItemKeyFacet,u.getItemsOperation)(h.sharedWithMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler(L.sharedWithMeItemSetKeyFacet,u.getItemsOperation)(p.sharedWithMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(A.sharedByMeRootItemKeyFacet,u.getItemsOperation)(d.sharedByMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler(O.sharedByMeItemSetKeyFacet,u.getItemsOperation)(v.sharedByMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(M.recentRootItemKeyFacet,u.getItemsOperation)(m.recentRootItemGetItemsOperationHandler));e(r.registerOperationHandler(P.savedForLaterRootItemKeyFacet,u.getItemsOperation)(g.savedForLaterRootItemGetItemsOperationHandler));e(r.registerOperationHandler(_.recentItemSetKeyFacet,u.getItemsOperation)(y.recentItemSetGetItemsOperationHandler));e(r.registerOperationHandler(H.savedForLaterItemSetKeyFacet,u.getItemsOperation)(b.savedForLaterItemSetGetItemsOperationHandler));e(r.registerOperationHandler(B.searchItemSetKeyFacet,u.getItemsOperation)(S.searchItemSetGetItemsOperationHandler));e(u.supportFacets({keyFacet:j.driveFollowedItemKeyFacet,facets:[s.isFollowedFacet]}));e(r.registerOperationHandler(j.driveFollowedItemKeyFacet,u.getItemsOperation)(E.driveFollowItemGetItemsOperationHandler));e(r.registerOperationHandler(F.driveActivityItemKeyFacet,u.getItemsOperation)(w.driveActivityItemGetItemsOperationHandler));e(r.registerOperationHandler(Q.commandsItemKeyFacet,u.getItemsOperation)(I.commandsGetItemsOperationHandler));e(U.registerControlHandler(x.driveItemKeyFacet,R.openActionControl)(q.openActionControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,X.filteredItemSetControl)(V.recentRootItemSetFilteredItemSetControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,$.itemsViewControl)(K.itemsViewControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,J.itemsViewLayoutsControl)(K.itemsViewLayoutsControlHandler));e(ee.graphFileHandlerAddon)}));return[4,e(W.waitForPageLoad({waitIndefinitely:!0}))];case 1:n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,se()];case 3:if(!(t=n.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:re=n.sent();e(G.handleError({error:re}));return[3,5];case 5:return[2]}})})}})});
define("Qq",["require","exports","lC","Hm","ph","GA","GA","qW","wo","GW"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.driveItemKeyFacet.deserialize(r);return function(c){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:t=l;return l.driveId&&"me"!==l.driveId?[3,2]:[4,c(f.getOneDriveEndpoint({endpoint:l.endpoint}))];case 1:(h=E.sent())!==l.endpoint&&(t=n.__assign(n.__assign({},l),{endpoint:h}));E.label=2;case 2:p=o.getDriveUrl(t);return[4,c(o.getRawDataWithCache({url:s.getDriveItemUrl(t)+"?$expand=thumbnails",driveUrl:p,qosName:"getItem",endpoint:t.endpoint}))];case 3:d=E.sent();v=u.processLocalOrRemoteDriveItem({driveItemResponse:d,endpoint:t.endpoint}),m=v.itemResolver,g=v.actualItemKey;m.resolveItems({items:(y={},y[e.itemKey]=n.__assign({},a.resolvedAsKeyFacetFacet.pack(i.driveItemKeyFacet)),y)});m.mapKeys({mappings:(b={},b[g]=r,b)});l.driveId&&"me"!==l.driveId||m.mapKeys({mappings:(w={},w[i.driveItemKeyFacet.serialize(n.__assign(n.__assign({},l),{driveId:"me"}))]=i.driveItemKeyFacet.serialize(n.__assign(n.__assign({},l),{driveId:""})),w)});c(m.execute());return[2]}})})}})});
define("qW",["require","exports","lC","$W","ph","YW","UW","QW","sS","Rs"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processLocalOrRemoteDriveItem=function(e){var t,l,c,h,p=e.driveItemResponse,d=e.endpoint,v=e.getDriveItemFacets,m=void 0===v?r.getDriveItemFacets:v,g=p.remoteItem,y=g&&g.parentReference,b=p.parentReference,w=b||y,E=w&&w.driveId,S=w&&w.id,x="personal"===(w&&w.driveType),T=!!p.root;if(g){h=g.id;y&&(E=y.driveId)}else h=x&&p.root?o.ROOT_ITEM_ID:p.id;var N={endpoint:d,driveId:E,itemId:h},C=i.driveItemKeyFacet.serialize(N),k=p&&(p.webDavUrl||p.webUrl),L=x&&w&&w.path===o.CONSUMER_ROOT_ITEM_PATH?o.ROOT_ITEM_ID:S||void 0,A=w&&L?i.driveItemKeyFacet.serialize({endpoint:d,driveId:w.driveId||E,itemId:L}):void 0,O=[],M="";if(k){var _=new a.SimpleUri(k);O.push.apply(O,_.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));O.unshift(_.authority);M=O.join("/")}w&&!T&&!L&&M&&(A=u.driveItemByCanonicalUrlKeyFacet.serialize({endpoint:d,driveId:w.driveId,canonicalUrl:M}));var D=s.processDriveItem(n.__assign(n.__assign({},e),{itemKey:C,driveItemKey:N,parentFolderItemKey:A})).itemResolver;D.resolveItems({items:n.__assign({},A&&(t={},t[A]=n.__assign({},M?f.openUrlFacet.pack(M):{}),t))});if(g&&y){var P=i.driveItemKeyFacet.serialize({endpoint:d,driveId:b&&b.driveId,itemId:p.id}),H=i.driveItemKeyFacet.serialize({endpoint:d,driveId:y.driveId,itemId:g.id});D.mapKeys({mappings:(l={},l[P]=H,l)});D.resolveItems({items:(c={},c[H]=n.__assign({},m({driveItem:p,endpoint:d})),c)})}return{itemResolver:D,actualDriveItemKey:N,actualItemKey:C}}});
define("$W",["require","exports","lC","oi","Rs","Xo","ph","HW","BW","iq","$7","UB","QD","ey","Jf","W9","aq","s6","bW","nq","bH","xW","NW","zm","tq","eq"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveItemFacets=function(e){var t,L=e.driveItemKey,A=e.driveItem,O=e.endpoint,M=e.parentFolderItemKey,_=e.shouldReturnShareFacets,D=void 0===_||_,P=A.file,H=A.fileSystemInfo,B=A.name,j=A.parentReference,F=A.remoteItem,I=A.root,q=A.size,R=A.thumbnails,U=A.image,z=A.video,W=A.eTag,X=A.specialFolder,V=A.lastModifiedDateTime,$=void 0===V?H&&H.lastModifiedDateTime||F&&F.lastModifiedDateTime:V,J=A.createdDateTime||H&&H.createdDateTime||F&&F.createdDateTime,K=j&&j.driveId,Q=j&&j.driveType||F&&F.parentReference&&F.parentReference.driveType,G="personal"===Q,Y=H&&H.lastAccessedDateTime||F&&F.fileSystemInfo&&F.fileSystemInfo.lastAccessedDateTime,Z=A.package||F&&F.package,ee=R||F&&F.thumbnails,te=U||F&&F.image,ne=z||F&&F.video,re=A.shared||F&&F.shared,ie={itemId:A.id,driveId:K,endpoint:O},se=H&&H.systemPath,oe=L||F&&F.parentReference&&{itemId:F.id,driveId:F.parentReference.driveId,endpoint:O}||ie,ue=o.driveItemKeyFacet.serialize(oe),ae=A.webDavUrl||F&&F.webDavUrl;t="business"!==Q&&"documentLibrary"!==Q&&"personal"!==Q||!I?B||F&&F.name||"":h.default.files;var fe=A.folder||F&&F.folder,le=q||F&&F.size,ce=fe&&fe.childCount,he=k(t,!!fe),pe=he.extension&&b.getOfficeAppFromExtension(he.extension),de=A.sharepointIds||F&&F.sharepointIds,ve=A.localItem,me=!fe&&(A.webUrl||F&&F.webUrl);return n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},o.driveItemKeyFacet.pack(oe)),i.displayNameFacet.pack(t)),void 0!==le?i.fileSizeFacet.pack(le):{}),H||A.folder||P||F&&F.folder?n.__assign({},i.folderFacet.pack(fe?{}:void 0)):{}),me?i.openUrlFacet.pack(me):{}),g.systemFilePathFacet.pack(se)),ae?i.canonicalUrlFacet.pack(ae):{}),i.dateModifiedFacet.pack($?new Date($).getTime():void 0)),i.dateCreatedFacet.pack(J?new Date(J).getTime():void 0)),Y?n.__assign({},i.dateAccessedFacet.pack(new Date(Y).getTime())):{}),r.oneNoteFacet.pack(Z&&"oneNote"===Z.type?{}:void 0)),ee?n.__assign(n.__assign(n.__assign({},a.graphThumbnailSetFacet.pack(ee)),S.hasThumbnailAuthTokenFacet.pack(!0)),T.hasPdfFacet.pack(N.isFileTransformableToPdf(he.extension))):{}),x.getInvalidationFacet().forFacet(p.thumbnailFacet).thenInvalidate(ue,a.graphThumbnailSetFacet).pack()),f.driveItemResponseFacet.pack(A)),W?i.eTagFacet.pack(W):{}),te&&te.width&&te.height?p.dimensionsFacet.pack({width:te.width,height:te.height}):{}),te&&!ne?p.photoFacet.pack({}):{}),ne?p.videoFacet.pack({}):{}),s.defaultChildItemSetFacet.pack({itemKey:u.driveItemSetKeyFacet.serialize({driveItemKey:oe,sortBy:"",isAscending:!0})})),i.analyticsItemFacet.pack({itemKey:l.driveAnalyticsItemKeyFacet.serialize({driveItemKey:oe})})),i.parentFolderItemFacet.pack(M?{itemKey:M}:void 0)),!G&&ae?n.__assign({},i.parentFolderItemNameFacet.pack(C(ae))):{}),v.driveTypeFacet.pack(Q)),G?n.__assign({},m.vaultFacet.pack(A.vault)):{}),i.fileNameFacet.pack(he)),D?n.__assign(n.__assign({},i.isSharedFacet.pack(!!re)),c.sharedFacet.pack(re)):{}),ve?g.localItemFacet.pack(ve):{}),"number"==typeof ce?d.countFacet.pack(ce):{}),g.mimeTypeFacet.pack(P&&P.mimeType)),pe?y.officeAppFacet.pack(pe):{}),de?w.sharepointIdsFacet.pack(de):{}),X?E.specialFolderFacet.pack(X.name):{})};function C(e){var t=e.split("/");return t.length>2?decodeURI(t[t.length-2]):void 0}t.getParentFolder=C;function k(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}t.getFileName=k});
define("HW",["require","exports","fi","ph","uh"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetKeyFacet=new n.KeyFacet("driveItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),sortBy:n.stringPart(),isAscending:n.booleanPart(),extFilters:n.arrayPart(n.stringPart()),filters:n.arrayPart(n.subKeyPart(i.driveFilterKeyFacet)),groupBy:n.stringPart()})});
define("BW",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphThumbnailSetFacet=new n.Facet("graphThumbnailSet")});
define("iq",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemResponseFacet=new n.Facet("driveItemResponse")});
define("aq",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.vaultFacet=new n.Facet("vault")});
define("bW",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.officeAppFacet=new n.Facet("officeApp")});
define("nq",["require","exports","eM"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOfficeAppFromExtension=function(e){var t=e.replace(".",""),r=Object.keys(n.OfficeAppToExtensionsMap);for(var i in r)if(n.OfficeAppToExtensionsMap.hasOwnProperty(r[i])){var s=r[i];if(n.OfficeAppToExtensionsMap[s].indexOf(t)>-1)return s}}});
define("bH",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharepointIdsFacet=new n.Facet("sharepointIds")});
define("xW",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialFolderFacet=new n.Facet("specialFolder")});
define("NW",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasThumbnailAuthTokenFacet=new n.Facet("hasThumbnailAuthTokenFacet")});
define("tq",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasPdfFacet=new n.Facet("hasPdfFacet")});
define("eq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[".oxps",".pdf"],r=[".doc",".docx",".dot",".dotx",".dotm",".odt",".rtf",".ods",".xls",".xlsm",".xlsx",".odp",".ppt",".pptx",".pps",".ppsx",".tiff",".tif",".dwg",".epub",".htm",".html",".eml",".msg",".md",".markdown"];t.XPS_MEDIA_TYPE="application/oxps";t.PDF_MEDIA_TYPE="application/pdf";t.isSupportedFileFormat=function(e){return-1!==n.indexOf(e)||-1!==r.indexOf(e)};t.isFileTransformableToPdf=function(e){return-1!==r.indexOf(e)}});
define("YW",["require","exports","lC","$W","zm","Rs","Xo","Vm","X7","ZW","oy","XW","JW","p_"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItem=function(e){var t,l=e.itemKey,v=e.driveItemKey,m=e.parentFolderItemKey,g=e.setItemKey,y=e.driveItemResponse,b=e.endpoint,w=e.getDriveItemFacets,E=void 0===w?r.getDriveItemFacets:w,S=new u.ItemResolver,x=a.driveActivityItemKeyFacet.serialize({driveItemKey:v}),T=g?i.getInvalidationFacet().forFacet(s.displayNameFacet).thenInvalidate(g,o.childItemsFacet).forFacet(s.deletedFacet).thenInvalidate(g,o.childItemsFacet).forFacet(s.parentFolderItemFacet).thenInvalidate(g,o.childItemsFacet).pack():void 0,N=n.__assign(n.__assign(n.__assign({},E({driveItemKey:v,driveItem:y,endpoint:b,parentFolderItemKey:m})),s.activityItemFacet.pack({itemKey:x})),T);S.resolveItems({items:(t={},t[l]=N,t)});if(y.lastModifiedBy){if(A=y.lastModifiedBy.user){var C=A.id&&f.userByIdKeyFacet.serialize({id:A.id,endpoint:b});if(C=A.email&&h.userByEmailKeyFacet.serialize({email:A.email,endpoint:b})){var k=d({itemKey:l,personFacet:s.modifiedByPersonFacet,userKey:C,user:A}).itemResolver;S.merge(k)}}}if(y.createdBy){var L=void 0;if((A=y.createdBy.user)&&A.email&&(L=h.userByEmailKeyFacet.serialize({email:A.email,endpoint:b}))){k=d({itemKey:l,personFacet:p.createdByPersonFacet,userKey:L,user:A}).itemResolver;S.merge(k)}}if(y.remoteItem&&y.remoteItem.shared&&y.remoteItem.shared.sharedBy&&y.remoteItem.shared.sharedBy.user){var A,O=void 0;if((A=y.remoteItem.shared.sharedBy.user).email&&(O=h.userByEmailKeyFacet.serialize({email:A.email,endpoint:b}))){k=d({itemKey:l,personFacet:c.sharedByPersonFacet,userKey:O,user:A}).itemResolver;S.merge(k)}}return{itemResolver:S}};function d(e){var t,r,i=e.itemKey,o=e.personFacet,a=e.userKey,f=e.user,c=new u.ItemResolver;c.resolveItems({items:n.__assign((t={},t[a]=n.__assign(n.__assign(n.__assign({},s.displayNameFacet.pack(f.displayName)),l.emailFacet.pack(f.email)),l.sipFacet.pack(f.id)),t),o&&(r={},r[i]=n.__assign({},o.pack({itemKey:a,displayValue:f.displayName})),r))});return{itemResolver:c}}t.resolveUserItems=d});
define("ZW",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.userByIdKeyFacet=new n.KeyFacet("userById",{id:n.stringPart(),endpoint:n.stringPart()})});
define("UW",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ROOT_ITEM_ID="root";t.CONSUMER_ROOT_ITEM_PATH="/drive/root:";t.DEFAULT_PAGE_SIZE=30});
define("QW",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemByCanonicalUrlKeyFacet=new n.KeyFacet("driveItem",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0}),canonicalUrl:n.stringPart()})});
define("GW",["require","exports","lC","Io","ri"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOneDriveEndpoint=function(e){var t=this;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,o,u,a,f;return n.__generator(this,function(n){switch(n.label){case 0:t=e.endpoint;o=s(r.readConfiguration({getUserOneDriveEndpoint:i.getUserOneDriveEndpointFacet,graphEndpoint:i.graphEndpointConfigurationFacet})),u=o.getUserOneDriveEndpoint;return(a=o.graphEndpoint)&&t!==a&&u?[4,s(u({endpoint:t}))]:[3,2];case 1:f=n.sent();t=f;n.label=2;case 2:return[2,t]}})})}}});
define("Gq",["require","exports","lC","Hm","$7","p_","Kq","GA","PR","$1","Po","iR","Rs","oy","JW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveAnalyticsItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,m=i.driveAnalyticsItemKeyFacet.deserialize(r).driveItemKey,g=m.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,y,b,w,E,S,x=this;return n.__generator(this,function(T){t={Caller:"HoverCard"};i="GetItemAnalytics_addon-graph";y=n.__awaiter(x,void 0,void 0,function(){var a,l,c,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:return[4,e(u.getRawDataWithCache({url:(S=u.getDriveItemUrl(m),x=v(S),T="$expand=analytics($expand=allTime($expand=activities))",N="$select=*,id,reactions,trending",C=N+"&"+T+",insights($expand=keyPoints)",k=x+"?"+C,k),qosName:i+"_GetAnalyticsSections",endpoint:g,timeout:6e3,headers:t,driveUrl:v(u.getDriveUrl(m))}))];case 1:a=E.sent();l=o.parseResponseOfAnalyticsSections(a);if(c=l.createdBy){y=d.userByEmailKeyFacet.serialize({email:c.email,endpoint:g});e(f.resolveItems({items:(b={},b[y]=n.__assign(n.__assign(n.__assign(n.__assign({},h.displayNameFacet.pack(c.displayName)),p.emailFacet.pack(c.email)),p.pictureFacet.pack(c.image)),p.sipFacet.pack(c.id)),b[r]=n.__assign({},s.createdByPersonFacet.pack({itemKey:y,displayValue:c.displayName})),b)}))}e(f.resolveItems({items:(w={},w[r]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},s.viewCountFacet.pack(l.viewCount)),s.viewerCountFacet.pack(l.viewerCount)),s.isTrendingFacet.pack(l.isTrending)),s.activitiesFacet.pack(l.activities)),s.likeCountFacet.pack(l.likeCount)),s.commentCountFacet.pack(l.commentCount)),s.lifeCycleStatusFacet.pack(l.lifeCycleStatus)),s.keyPointsFacet.pack(l.keyPointsData)),s.incompleteDataFacet.pack(l.incompleteData)),s.createdDateTimeFacet.pack(l.createdDateTime)),w)}));return[2]}var S,x,T,N,C,k})});b=[y];w=n.__awaiter(x,void 0,void 0,function(){var o,l,c,h;return n.__generator(this,function(p){switch(p.label){case 0:return[4,e(u.getRawDataWithCache({url:(d=u.getDriveItemUrl(m),y=v(d),y+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:i+"_GetRecommendedActionsAndConversations",endpoint:g,timeout:6e3,headers:t,driveUrl:v(u.getDriveUrl(m))}))];case 1:o=p.sent();l=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(o);c=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:a.ConversationType[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(o);e(f.resolveItems({items:(h={},h[r]=n.__assign(n.__assign({},s.recommendedActionsFacet.pack(l)),s.conversationsFacet.pack(c)),h)}));return[2]}var d,y})});b.push(w);if(c.isLowActivityTidbitEnabled()){E=n.__awaiter(x,void 0,void 0,function(){var o,a;return n.__generator(this,function(l){switch(l.label){case 0:return[4,e(u.getRawDataWithCache({url:(c=u.getDriveItemUrl(m),h=v(c),h+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'"),driveUrl:v(u.getDriveUrl(m)),qosName:i+"_GetShareWithPeople",endpoint:g,timeout:6e3,headers:t}))];case 1:o=l.sent();e(f.resolveItems({items:(a={},a[r]=n.__assign({},s.recommendedPeopleFacet.pack(o.value)),a)}));return[2]}var c,h})});b.push(E)}else e(f.resolveItems({items:(S={},S[r]=n.__assign({},s.recommendedPeopleFacet.pack([])),S)}));return[2,l.waitForAll(b)]})})}});function v(e){return e.replace("2.0","2.1")}});
define("Kq",["require","exports","lC","Fe","qq","Oe","E","JA","L7","Wq","ce"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IMAGE_LINK="/_layouts/15/userphoto.aspx?size=S&accountname=";var c=l.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E","1/30/2018","ItemAnalytics API transfer to vroom 2.1")?"v2.0":"v2.1",h=(function(){function e(e,n){this._eTagMap={};this._dataRequestor=n.vroomDataRequestor;var r=n.getProfileImageUrl,i=void 0===r?function(e){return l.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN")?""+t.IMAGE_LINK+e:s.getUserPhotoUrl(e)}:r,o=n.caller,u=void 0===o?"hovercard":o,a=n.useSharePointApi,f=void 0!==a&&a;this._getProfileImageUrl=i;this._caller=u;this._useSharePointApi=f}e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,i=void 0===n?c:n,s=t.skipToken,o=void 0===s?"":s,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=o?";$skiptoken="+o:"",l="GetItemAnalytics"+i+(e.queryType?"_"+e.queryType:"")+"_WithGuestUser",h=this._getBaseUrl(e);if(!h)return r.default.resolve();var p=h+"/analytics/allTime?$expand=activities"+"($filter=access%20ne%20null)"+f;return this._getAnalytics(l,p,!1,e,a)};e.prototype.getAnalyticsSections=function(e,t){void 0===t&&(t={});if(!this._useSharePointApi){var n=t.headers,i=void 0===n?{Caller:this._caller}:n,s=this._getBaseUrl(e);if(!s)return r.default.resolve();",id,reactions";"$expand=insights($expand=keyPoints)";",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention";var o="$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention",u=o+"&$expand=insights($expand=keyPoints)",a=this._useSharePointApi?s+"/driveItem?"+u:s+"?"+u;return this._getAnalytics("GetAnalyticsSections_WithReaction_WithKeyPoints_WithLifeCycle",a,!0,e,i)}};e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",i=this._getBaseUrl(e);if(!i)return r.default.resolve();var s=t.apiVersion,o=void 0===s?c:s,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=e.queryType?"_"+e.queryType:"";if(this._useSharePointApi){var l="GetItemAnalyticsSharePoint"+o+f,h=i+"/driveItem?"+n;return this._getAnalytics(l,h,!0,e,a)}var p="GetItemAnalyticsSections"+o+f+"_WithGuestUser_WithReaction_WithKeyPoints_WithLifeCycle",d=i+"?$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention&$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null))),insights($expand=keyPoints)";return this._getAnalytics(p,d,!0,e,a)};e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return r.default.resolve();var i=t+"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)";return this._getAnalytics("GetLastSevenDaysItemAnalytics",i,!1,e,n)};e.prototype.getItemAnalyticsByInterval=function(e,t,n,r){var i=c,s=t.toISOString(),o=n.toISOString(),u=this._getBaseUrl(e),a=this._getAnalyticsByIntervalPath(u,i,s,o,r);return this._getAnalyticsByInterval("GetDailyItemAnalytics",a,e.getAccessToken&&e.getAccessToken(),i)};e.prototype._getAnalytics=function(e,t,n,r,i,s){var o=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:r.getAccessToken&&r.getAccessToken(),headers:i,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1;e.eTag&&(o._eTagMap[r.itemId]=e.eTag);return n?p(e,o._getProfileImageUrl):d(e,o._getProfileImageUrl)})};e.prototype.updateItemKeyPoints=function(e,t){var n=this,r=this._getBaseUrl(e)+"/insights/keyPoints";return this._dataRequestor.send({path:r,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,qosExtraData:{Caller:this._caller},parseResponse:function(t){n._eTagMap[e.itemId]=t.getResponseHeader("eTag");return JSON.parse(t.responseText)}}).then(function(e){return e.value})};e.prototype._getAnalyticsByInterval=function(e,t,n,r){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){var t;"v2.1"===r?(e=e)&&e.value&&(t=e.value.map(g)):t=(e=e).Items;return t})};e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?""+e.graphItemUrl:null};e.prototype._getAnalyticsByIntervalPath=function(e,t,n,r,i){var s;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";s=this._useSharePointApi?"interval='"+i+"',startDateTime='"+n+"',endDateTime='"+r+"'":"v2.1"===t?"startDateTime="+n+"&endDateTime="+r+"&interval="+i:"startDateTime='"+n+"'&endDateTime='"+r+"'&interval='"+i+"'";return this._useSharePointApi?e+"/oneDrive.getActivitiesByInterval("+s+")":e+"/"+o+"?"+s};e.prototype.getFilesAnalytics=function(e,t,n){var i=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:t+"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '"+e.join("' or sharepointIds/listItemUniqueId eq '")+"'",postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return i._parseFilesAnalyticsResponse(e)}):r.default.resolve()};e.prototype.getRecommendedActions=function(e){var t=this._getBaseUrl(e)+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))";return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype.getShareWith=function(e){var t=this._getBaseUrl(e)+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'";return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var r=u.getErrorResolution(t,function(e){switch(e){case"notSupported":return{resultType:o.ResultTypeEnum.ExpectedFailure}}});return n.__assign(n.__assign({},e),r||{})};e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,r=(e.value,n.__rest(e,["value"])),i=e.value.map(function(e){var r=e.analytics,i=n.__rest(e,["analytics"]);return n.__assign(n.__assign({},i),{analytics:{lastSevenDays:v(r.lastSevenDays,t._getProfileImageUrl)}})});return n.__assign(n.__assign({},r),{value:i})};return e})();t.ItemAnalyticsService=h;function p(e,t){var n=e&&e.analytics&&e.analytics.allTime,r=n&&n.access,s=n&&n.endDateTime,o=m(n&&n.activities,t),u=(function(e){var t=[];e.malware&&t.push({status:i.AnalyticsLifeCycleStatus.MalwareDetected});e.publication&&e.publication.level.indexOf("checkout")>-1&&t.push({status:i.AnalyticsLifeCycleStatus.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user});e.dataLossPrevention&&(e.dataLossPrevention.block?t.push({status:i.AnalyticsLifeCycleStatus.DLPBlocked}):e.dataLossPrevention.notify&&t.push({status:i.AnalyticsLifeCycleStatus.DLPWarning}));e.metadataMissing&&t.push({status:i.AnalyticsLifeCycleStatus.MissingMetaData});e.awaitingApproval&&t.push({status:i.AnalyticsLifeCycleStatus.AwaitingApproval});e.trending&&t.push({status:i.AnalyticsLifeCycleStatus.Trending});if(e.createdDateTime){var n=new Date(e.createdDateTime);f.isItemLifeCycleStatusNew(n)&&t.push({status:i.AnalyticsLifeCycleStatus.New,createdRelativeTime:a.getFriendlyDateTimeStringPast(a.iso8601DateTimeToJsDate(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})}return t})(e),l=(function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}})(e),c=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:r&&r.actionCount,viewerCount:r&&r.actorCount,commentCount:c&&c.commentCount,likeCount:c&&c.likeCount,lifeCycleStatus:u,keyPointsData:l,lastActivityDateTime:s,createdBy:e.createdBy&&e.createdBy.user,createdDateTime:e.createdDateTime}}t.parseResponseOfAnalyticsSections=p;function d(e,t){var r=e.activities,i=e.access,s=e.endDateTime,o=n.__rest(e,["activities","access","endDateTime"]);return{activities:m(r,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,lastActivityDateTime:s}}t.parseResponseV21=d;function v(e,r){e.activities;var i=n.__rest(e,["activities"]),s=e.activities&&e.activities.map(function(e){var i=n.__rest(e,[]),s=i.actor&&i.actor.user&&i.actor.user.email;i.activityDateTime=a.getFriendlyDateTimeStringPast(a.iso8601DateTimeToJsDate(i.activityDateTime));i.actor.user.image=r&&r(i.actor.user.email)||""+t.IMAGE_LINK+s;return i});return n.__assign(n.__assign({},i),{activities:s})}t.parseResponse=v;function m(e,r){return e&&e.map(function(e){var i=n.__rest(e,[]),s=i.actor&&i.actor.user&&i.actor.user.email,o=n.__assign(n.__assign({},i.actor.user),{image:r?r(s):""+t.IMAGE_LINK+s,userType:i.actor.user.userType});return n.__assign(n.__assign({},i),{activityDateTime:a.getFriendlyDateTimeStringPast(a.iso8601DateTimeToJsDate(i.activityDateTime)),actor:n.__assign(n.__assign({},i.actor),{location:i.location,user:o}),activityType:i.access?"Access":"Edit"})})}function g(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},interval:void 0,isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}});
define("qq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(t.AnalyticsLifeCycleStatus||(t.AnalyticsLifeCycleStatus={}))});
define("Wq",["require","exports","be"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ODB:1146};t.isLifeCycleEnabled=function(){return n.default.isFeatureEnabled(r)};t.isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<1728e5}});
define("PR",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(t.AnalyticsLifeCycleStatus||(t.AnalyticsLifeCycleStatus={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(t.ConversationType||(t.ConversationType={}))});
define("iR",["require","exports","be","eM"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={ODB:1588,OneDrive:!0},s={ODB:1656,OneDrive:!0},o={ODB:1883,OneDrive:!0},u={ODB:1020,OneDrive:!0},a={ODB:1015,OneDrive:!0},f=[r.wordType,r.excelType,r.powerpointType,".docx",".xlsx",".pptx",".doc",".xls",".ppt",".pdf"];t.isRecommendedActionsSupported=function(e,t){var n=e||t;return!!n&&f.indexOf(n)>-1};t.isSaveForLaterOn=function(){return n.default.isFeatureEnabled(i)};t.isLowActivityTidbitEnabled=function(){return n.default.isFeatureEnabled(s)};t.isCollapsedSectionsEnabled=function(){return n.default.isFeatureEnabled(o)};t.isRelatedFilesSectionEnabled=function(){return n.default.isFeatureEnabled(u)};t.isRelatedFilesApiCallEnabled=function(){return n.default.isFeatureEnabled(a)}});
define("zq",["require","exports","lC","Hm","CW","GA","ph","$W","Xo","HW","Vm","Co"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialDriveItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.specialDriveItemKeyFacet.deserialize(r),p=h.driveId,d=h.endpoint,v=s.getDriveUrl(h);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,m,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:return[4,e(s.getRawData({url:s.getSpecialDriveItemUrl(h),driveUrl:v,qosName:"getItem",endpoint:d}))];case 1:t=x.sent();i=new l.ItemResolver;m=t&&t.parentReference;g=m&&m.driveId;y={endpoint:d,driveId:g||p,itemId:t.id};b=o.driveItemKeyFacet.serialize(y);w=m&&m.id?o.driveItemKeyFacet.serialize({endpoint:d,driveId:g,itemId:m.id}):void 0;i.resolveItems({items:(E={},E[b]=n.__assign(n.__assign(n.__assign({},u.getDriveItemFacets({driveItem:t,endpoint:d,parentFolderItemKey:w})),c.preferredKeyFacetFacet.pack(o.driveItemKeyFacet)),a.defaultChildItemSetFacet.pack({itemKey:f.driveItemSetKeyFacet.serialize({driveItemKey:y,sortBy:"",isAscending:!0})})),E)});i.mapKeys({mappings:(S={},S[b]=r,S)});e(i.execute());return[2]}})})}})});
define("CW",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialDriveItemKeyFacet=new n.KeyFacet("specialDriveItem",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0}),name:n.stringPart()})});
define("Vq",["require","exports","lC","Hm","Xo","Rs","bq","GA","ph","$W","zm","Vm","h7","Io","ri","KW","fi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,g=o.driveItemPageKeyFacet.deserialize(r),y=g.setItemKey,b=g.endpoint,w=g.token,E=m.KeyFacet.get(y).deserialize(y),S=E.extFilters,x=E.driveItemKey,T=u.getDriveUrl(x);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,E,x,N,C,k,L,A,O,M,_,D,P,H;return n.__generator(this,function(B){switch(B.label){case 0:return[4,e(u.getRawData({endpoint:b,url:w,driveUrl:T,qosName:"getChildrenPage"}))];case 1:t=B.sent();m=S&&S.length>0?v.getChildrenItemFilter(S):void 0;g=new c.ItemResolver;E=[];x=0,N=t.value;B.label=2;case 2:if(!(x<N.length))return[3,5];C=N[x];if(!!m&&m(C))return[3,4];k=C&&(C.parentReference||C.remoteItem&&C.remoteItem.parentReference);L=k&&k.driveId;A=a.driveItemKeyFacet.serialize({itemId:C.id,driveId:L,endpoint:b});O=k?a.driveItemKeyFacet.serialize({itemId:k.id,driveId:L,endpoint:b}):void 0;E.push(A);g.resolveItems({items:(H={},H[A]=n.__assign(n.__assign({},f.getDriveItemFacets({driveItem:C,endpoint:b,parentFolderItemKey:O})),l.getInvalidationFacet().forFacet(s.displayNameFacet).thenInvalidate(r,i.childItemsFacet).forFacet(s.deletedFacet).thenInvalidate(r,i.childItemsFacet).pack()),H)});return(M=e(p.readConfiguration({processDriveItemFromSharePoint:d.processDriveItemFromSharePointFacet})).processDriveItemFromSharePoint)?[4,e(M.process({itemKey:A,driveItem:C}))]:[3,4];case 3:_=B.sent().itemResolver;g.merge(_);B.label=4;case 4:x++;return[3,2];case 5:if(D=t["@odata.nextLink"]){P=o.driveItemPageKeyFacet.serialize({setItemKey:y,endpoint:b,token:D});g.merge(h.resolveNewPage({itemKey:P}).itemResolver);E.push(P)}g.merge(h.resolveExistingPage({itemKey:r,itemSetKey:y,childItemKeys:E}).itemResolver);e(g.execute());return[2]}})})}})});
define("bq",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPageKeyFacet=new n.KeyFacet("driveItemPage",{endpoint:n.stringPart(),setItemKey:n.stringPart(),token:n.stringPart()})});
define("KW",["require","exports","lC"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}t.anyOf=r;function i(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}t.allOf=i;t.getExtFiltersParams=function(e){if(!e||0===e.length)return"";for(var t=[],s=[],o=0;o<e.length;o++){var u=e[o],a=!1,f=u;if("!"===u[0]){f=u.slice(1);a=!0}if("folder"===f)!a&&t.push("folder ne null");else if("."!==f[0]);else{t=[];s=[]}}return t.length>0||s.length>0?"&$filter="+(0===s.length?r(t):0===t.length?i(s):i(n.__spreadArrays([r(t)],s))):""};t.getChildrenItemFilter=function(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}});
define("jq",["require","exports","lC","Hm","CD","Xo","lh","Rs","Vm","QD"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedWithMeRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(i={},i[r]=n.__assign(n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:o.sharedWithMeItemSetKeyFacet.serialize({driveItemKey:l,sortBy:"",isAscending:!0})})),u.displayNameFacet.pack(f.default.sharedWithMe)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),i)});e(t.execute());return[2]})})}})});
define("Mq",["require","exports","lC","Hm","lh","Dq","CD","GA","Nq","Rq","ri","Io","Pq"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=i.sharedWithMeItemSetKeyFacet.deserialize(e.itemKey),p=r.filters,d=r.sortBy,v=r.isAscending;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:t=h.getSharedGroup(e.itemKey),m=t.onProcessResponse,g=t.groupChildItems;y=i.sharedWithMeItemSetKeyFacet.deserialize(e.itemKey);b=y.driveItemKey.endpoint;w=r(c.readConfiguration({graphSharedWithMeEndpoint:l.graphSharedWithMeEndpointConfigurationFacet})).graphSharedWithMeEndpoint;b=w||b;return[4,r(u.isConsumerDirectEndpoint(b))];case 1:E=x.sent();return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"sharedWithMe",itemSetKeyFacet:i.sharedWithMeItemSetKeyFacet,parentItemKeyFacet:o.sharedWithMeRootItemKeyFacet,getUrl:function(e){return E?b+"/drive/view.sharedWithMe?allowExternal=true":b+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!a.filterItem(e,p)},sortChildItems:function(e){return f.sortItems(e,d,v,!0)},onProcessResponse:m,groupChildItems:g})))];case 2:S=x.sent().itemResolver;r(S.execute());return[2]}})})}})});
define("Dq",["require","exports","lC","GA","WW"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAndProcessDriveItemSetData=function(e){var t=this,s=e.itemKey,o=e.itemSetKeyFacet,u=e.getUrl,a=e.sortChildItems,f=e.qosName,l=e.preprocessResponse,c=e.expectedErrors,h=o.deserialize(s),p=h.driveItemKey.endpoint;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,o,d,v,m;return n.__generator(this,function(g){switch(g.label){case 0:t=r.getDriveUrl(h.driveItemKey);return[4,s(r.getRawDataWithCache({url:u(h),driveUrl:t,qosName:"getChildren"+(f?"."+f:""),endpoint:p,headers:e.additionalHeaders,expectedErrors:c}))];case 1:o=g.sent();d=n.__spreadArrays(o.value);v=l?l(d):o.value;m=a?a(v):v;return[4,s(i.processDriveItemSet(n.__assign(n.__assign({},e),{childItemsResponse:n.__assign(n.__assign({},o),{value:m})})))];case 2:return[2,{itemResolver:g.sent().itemResolver}]}})})}}});
define("WW",["require","exports","lC","rq","zm","Xo","qW","Y6","Lr"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItemSet=function(e){var t=e.itemKey,f=e.itemSetKeyFacet,l=e.parentItemKeyFacet,c=e.childItemsResponse,h=e.parentItemResponse,p=e.mapItemSetKey,d=f.deserialize(t),v=l.serialize(d.driveItemKey),m=d.driveItemKey.endpoint;return function(f){var l;a.mark(u.itemsViewPerfMarkers.processData.start);var d=f(r.processDriveItemSetChildren(n.__assign(n.__assign({},e),{response:c,parentItemKey:v}))).itemResolver;if(p){var g=p().itemResolver;d.merge(g)}if(h){var y=o.processLocalOrRemoteDriveItem({setItemKey:t,driveItemResponse:h,endpoint:m}).itemResolver;d.merge(y)}d.resolveItems({items:(l={},l[v]=n.__assign({},i.getInvalidationFacet().forFacet(s.defaultChildItemSetFacet).thenInvalidate(e.itemKey,s.childItemsFacet).pack()),l)});a.mark(u.itemsViewPerfMarkers.processData.end);return{itemResolver:d}}}});
define("rq",["require","exports","lC","zm","Xo","bq","Vm","h7","Ev","Io","ri","Rm","E","sS","qW","rs","Jf","iW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItemSetChildren=function(e){return function(t){var y,b,w,E,S,x=e.itemKey,T=e.parentItemKey,N=e.itemSetKeyFacet,C=e.filterChildItems,k=e.onProcessResponse,L=e.groupChildItems,A=e.response,O=e.skip,M=void 0===O?0:O,_=e.enableRandomAccess,D=void 0!==_&&_,P=e.totalChildCount,H=e.getDriveItemFacets,B=N.deserialize(x),j=B.driveItemKey.endpoint,F=new o.ItemResolver,I=t(c.logQoS({name:"remoteItemsMissingParentRef"})),q="number"==typeof A["@odata.count"]?A["@odata.count"]:P||A.value.length,R=A["@odata.nextLink"],U=!!R,z=t(v.readItems(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(i.childItemsFacet,x),prevChildKeys:e.demandItemFacet(i.childItemsFacet,x)}})),W=z.childItemsFacetResolved,X=z.prevChildKeys,V=X&&X.itemKeys,$=0,J=0;D&&(W&&V?S=V.slice(0):"number"==typeof q&&(S=new Array(q+(U&&q<=A.value.length?1:0))));S||(S=new Array(A.value.length+(U?1:0)));for(var K=M,Q=0,G=0,Y=A.value;G<Y.length;G++){var Z=Y[G],ee=C&&C(Z),te=Z.remoteItem,ne=!(Z.remoteItem&&Z.remoteItem.parentReference&&Z.remoteItem.parentReference.driveId),re=te&&ne;re&&Q++;if(ee||re){S.splice(K,1);q--}else{var ie=Z.webDavUrl||Z.remoteItem&&Z.remoteItem.webDavUrl||Z.webUrl,se=t(f.readConfiguration({graphEndpoint:l.graphEndpointConfigurationFacet,graphRecentEndpoint:l.graphRecentEndpointConfigurationFacet})),oe=se.graphEndpoint,ue=se.graphRecentEndpoint,ae=j.indexOf("/_api/v2.0")>-1||j.indexOf("/_api/v2.1")>-1,fe=oe||ue;if(ie&&ae){var le=ie&&decodeURIComponent(ie);j=fe?new p.SimpleUri(le).authority+"/_api/v2.0":""+new p.SimpleUri(le).authority+new p.SimpleUri(j).path}var ce=d.processLocalOrRemoteDriveItem({setItemKey:x,driveItemResponse:Z,endpoint:j,getDriveItemFacets:H}),he=ce.itemResolver,pe=ce.actualItemKey,de=ce.actualDriveItemKey,ve=Z.thumbnails,me=Z.remoteItem;$++;(ve||me&&me.thumbnails)&&J++;S[K]=pe;F.merge(he);if(k){var ge=k({itemKey:x,driveItemKey:de,item:Z});ge&&F.merge(ge.itemResolver)}var ye=t(f.readConfiguration({processDriveItemFromSharePoint:l.processDriveItemFromSharePointFacet})).processDriveItemFromSharePoint;if(ye&&(ae||fe)){var be=t(ye.process({itemKey:pe,driveItem:Z})).itemResolver;F.merge(be)}K++}}t(I(n.__assign({resultType:Q<1?h.ResultTypeEnum.Success:h.ResultTypeEnum.Failure},Q>0?{extraData:{count:Q}}:{})));if(U){var we=s.driveItemPageKeyFacet.serialize({setItemKey:x,endpoint:j,token:R});F.merge(u.resolveNewPage({itemKey:we}).itemResolver);S[K]=we}if(L){var Ee=L(B);Ee&&F.merge(Ee.itemResolver)}else F.resolveItems({items:(y={},y[x]=n.__assign({},i.childItemsFacet.pack({itemKeys:S})),y)});F.resolveItems({items:(b={},b[x]=n.__assign({},g.itemSetEngagementExtraDataFacet.pack({childCount:$,childCount_withThumbnail:J})),b)});q!==P&&F.resolveItems({items:(w={},w[T]=n.__assign({},m.countFacet.pack(q)),w)});F.resolveItems({items:(E={},E[x]=n.__assign(n.__assign({},i.parentItemFacet.pack({itemKey:T})),r.getInvalidationFacet().forFacet(i.childItemsFacet).thenInvalidate(a.clearCacheIfNotOffline).pack()),E)});return{itemResolver:F}}}});
define("iW",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetEngagementExtraDataFacet=new n.Facet("itemSetEngagementExtraData")});
define("Nq",["require","exports","se","A2","Uk","oe","se","Bq","tU"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterTypes={fileType:"fileName",sharedByUser:"sharedByName",dateModified:"dateModified"};var f=new Map([["code",n.ItemTypeFilter.text],["csv",n.ItemTypeFilter.excel],["docx",n.ItemTypeFilter.word],["dotx",n.ItemTypeFilter.word],["one",n.ItemTypeFilter.onenote],["onepkg",n.ItemTypeFilter.onenote],["onetoc",n.ItemTypeFilter.onenote],["pdf",n.ItemTypeFilter.pdf],["photo",n.ItemTypeFilter.media],["potx",n.ItemTypeFilter.powerpoint],["ppsx",n.ItemTypeFilter.powerpoint],["pptx",n.ItemTypeFilter.powerpoint],["rtf",n.ItemTypeFilter.text],["txt",n.ItemTypeFilter.text],["video",n.ItemTypeFilter.media],["xlsx",n.ItemTypeFilter.excel],["xltx",n.ItemTypeFilter.excel],["zip",n.ItemTypeFilter.zip]]);function l(e,t){var n,s,u=(n=e,s=r.getFileExtension(n,!0),i.getIconNameFromExtension(s)),a=f.get(u);return!!a&&o.containsItemTypeFilter(t.filters,a)}t.filterItem=function(e,n){void 0===n&&(n=[]);return n.every(function(n){var r,i=!(n.type===t.filterTypes.sharedByUser)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,n.values),o=!(n.type===t.filterTypes.fileType)||(function(e,t){return!!e.name&&l(e.name,t)})(e,s.getIItemTypeFilter(n.values)),f=!(n.type===t.filterTypes.dateModified)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case a.DateTimeSliderValue.today:return n;case a.DateTimeSliderValue.yesterday:return u.substractDays(n,1);case a.DateTimeSliderValue.last7Days:return u.substractDays(n,7);case a.DateTimeSliderValue.last30Days:return u.substractDays(n,30);case a.DateTimeSliderValue.last3Months:return u.substractDays(n,90);default:return new Date(0)}})((r=n.values).length<1||-1===Object.keys(a.DateTimeSliderValue).indexOf(r[0])?a.DateTimeSliderValue.none:a.DateTimeSliderValue[r[0]]));return i&&o&&f})}});
define("Bq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substractDays=function(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}});
define("Rq",["require","exports","lC","Kv","v_"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function o(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function u(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function a(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function f(e,t,r,i){return(function(e,t){return n.__spreadArrays(e).sort(t)})(e,function(e,n){var s=e.folder,o=n.folder;return r&&s&&!o?-1:r&&!s&&o?1:i(e,n,t)})}t.sortItems=function(e,t,n,l){void 0===l&&(l=!1);var c=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.DATE_SHARED_COLUMN_KEY],h=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.SHARED_BY_COLUMN_KEY],p=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[i.DISPLAY_NAME_COLUMN_KEY],d=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.ITEM_ACTIVITY_COLUMN_KEY],v=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[i.NAME_AND_PATH_COLUMN_KEY];switch(t){case c:return f(e,n,l,o);case h:return f(e,n,l,a);case p:case v:return f(e,n,l,u);case d:return f(e,n,l,s);default:return e}}});
define("Pq",["require","exports","lC","ph","Hq","lh","Vm","Rs","Jf","Xo","Fq","R7","pe","Kv","os","Tq"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharedGroup=function(e){if(s.sharedWithMeItemSetKeyFacet.matches(e)){var t=s.sharedWithMeItemSetKeyFacet.deserialize(e).groupBy;if(t===p.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[p.SHARED_BY_COLUMN_KEY])return m(e);if(t===p.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[p.DATE_SHARED_COLUMN_KEY])return g(e)}return{onProcessResponse:void 0,groupChildItems:void 0}};function m(e){var t={};return{onProcessResponse:function(e){var n,s=e.driveItemKey,o=e.item;if(o&&s){var u=o.remoteItem,a=u&&u.shared&&u.shared.sharedBy,f=a&&a.user,l=r.driveItemKeyFacet.serialize(s);if(f&&f.email){var c=i.groupBySharedByKeyFacet.serialize({displayName:f.displayName,email:f.email});if(n=c,t.hasOwnProperty(n))t[c].push(l);else{t[c]=[];t[c].push(l)}}}},groupChildItems:function(r){for(var s,l,c=new o.ItemResolver,h=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];if(!i.groupBySharedByKeyFacet.matches(s))return e;var o=i.groupBySharedByKeyFacet.deserialize(s);t.push(o)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return i.groupBySharedByKeyFacet.serialize(e)})})(Object.keys(t)),p=[],v=0,m=h;v<m.length;v++){var g=m[v];if(i.groupBySharedByKeyFacet.matches(g)){var y=i.groupBySharedByKeyFacet.deserialize(g);c.resolveItems({items:(s={},s[g]=n.__assign(n.__assign(n.__assign({},u.displayNameFacet.pack(y.displayName)),a.isGroupFacet.pack(!0)),f.childItemsFacet.pack({itemKeys:t[g]})),s)});p.push(g)}}c.resolveItems({items:(l={},l[e]=n.__assign(n.__assign({},f.childItemsFacet.pack({itemKeys:p})),d.allGroupsCollapsedFacet.pack(!0)),l)});return{itemResolver:c}}}}t.getSharedByGroup=m;function g(e){var t={};return{onProcessResponse:function(e){var n,s=e.driveItemKey,o=e.item;if(o&&s){var u=o.remoteItem,a=u&&u.shared&&u.shared.sharedDateTime,f=r.driveItemKeyFacet.serialize(s);if(a){var l=y(new Date(a),new Date),c=i.groupByDateSharedKeyFacet.serialize({relativeTime:l,sharedDateTime:a});if(n=c,t.hasOwnProperty(n))t[c].push(f);else{t[c]=[];t[c].push(f)}}}},groupChildItems:function(r){for(var s,l,c=new o.ItemResolver,h=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];if(!i.groupByDateSharedKeyFacet.matches(s))return e;var o=i.groupByDateSharedKeyFacet.deserialize(s);t.push(o)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return i.groupByDateSharedKeyFacet.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},s=0,o=n;s<o.length;s++){var u=o[s];if(i.groupByDateSharedKeyFacet.matches(u)){var a=i.groupByDateSharedKeyFacet.deserialize(u).relativeTime,f=i.groupByRelativeTimeKeyFacet.serialize({relativeTime:a});if(r(f))for(var l=e[u],c=0,h=l;c<h.length;c++){var p=h[c];t[f].push(p)}else{t[f]=[];l=e[u];for(var d=0,v=l;d<v.length;d++){p=v[d];t[f].push(p)}}}}return t})(t),p=[],v=0,m=Object.keys(h);v<m.length;v++){var g=m[v];if(i.groupByRelativeTimeKeyFacet.matches(g)){var y=i.groupByRelativeTimeKeyFacet.deserialize(g).relativeTime;c.resolveItems({items:(s={},s[g]=n.__assign(n.__assign(n.__assign({},u.displayNameFacet.pack(y)),a.isGroupFacet.pack(!0)),f.childItemsFacet.pack({itemKeys:h[g]})),s)});p.push(g)}}c.resolveItems({items:(l={},l[e]=n.__assign(n.__assign({},f.childItemsFacet.pack({itemKeys:p})),d.allGroupsCollapsedFacet.pack(!0)),l)});return{itemResolver:c}}}}t.getDateGroup=g;function y(e,t){if(!e)return l.default.older;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return c.default.today;n.setDate(n.getDate()-1);if(e>=n)return c.default.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return l.default.thisWeek;n.setDate(n.getDate()-7);if(e>n)return l.default.lastWeek;var r=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<r)return l.default.lastMonth;n.setDate(n.getDate()-7);if(e>n)return l.default.twoWeeksAgo;n.setDate(n.getDate()-7);if(e>n)return l.default.threeWeeksAgo;if(e>=r)return l.default.thisMonth;var i=t.getFullYear()===e.getFullYear(),s=v.months[e.getMonth()];return i?s:h.format(c.default.MonthAndYear,s,e.getFullYear())}t.getDateGroupName=y});
define("Hq",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupBySharedByKeyFacet=new n.KeyFacet("SharedByPersonKeyFacet",{displayName:n.stringPart(),email:n.stringPart()});t.groupByDateSharedKeyFacet=new n.KeyFacet("dateSharedGroupKeyFacet",{relativeTime:n.stringPart(),sharedDateTime:n.stringPart()});t.groupByRelativeTimeKeyFacet=new n.KeyFacet("relativeTimeGroupKeyFacet",{relativeTime:n.stringPart()})});
define("Tq",["require","exports","Uq"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.days=[n.default.sunday,n.default.monday,n.default.tuesday,n.default.wednesday,n.default.thursday,n.default.friday,n.default.saturday];t.shortDays=[n.default.shortSunday,n.default.shortMonday,n.default.shortTuesday,n.default.shortWednesday,n.default.shortThursday,n.default.shortFriday,n.default.shortSaturday];t.shortMonths=[n.default.shortJanuary,n.default.shortFebruary,n.default.shortMarch,n.default.shortApril,n.default.shortMay,n.default.shortJune,n.default.shortJuly,n.default.shortAugust,n.default.shortSeptember,n.default.shortOctober,n.default.shortNovember,n.default.shortDecember];t.months=[n.default.january,n.default.february,n.default.march,n.default.april,n.default.may,n.default.june,n.default.july,n.default.august,n.default.september,n.default.october,n.default.november,n.default.december]});
define("kq",["require","exports","lC","Hm","hq","Xo","_q","Rs","Vm","QD"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedByMeRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(i={},i[r]=n.__assign(n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:o.sharedByMeItemSetKeyFacet.serialize({driveItemKey:l})})),u.displayNameFacet.pack(f.default.sharedByMe)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),i)});e(t.execute());return[2]})})}})});
define("hq",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemKeyFacet=new n.KeyFacet("sharedByMeRootItem",{endpoint:n.stringPart()})});
define("_q",["require","exports","fi","ph"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetKeyFacet=new n.KeyFacet("sharedByMeItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet)})});
define("Lq",["require","exports","lC","Hm","_q","Dq","hq"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(u){switch(u.label){case 0:return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"sharedByMe",itemSetKeyFacet:i.sharedByMeItemSetKeyFacet,parentItemKeyFacet:o.sharedByMeRootItemKeyFacet,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=u.sent().itemResolver;r(t.execute());return[2]}})})}})});
define("Aq",["require","exports","lC","Hm","Xo","K9","Y3","Rs","Vm","QD","ri","Io"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=o.recentRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,p;return n.__generator(this,function(d){t=e(c.readConfiguration({groupBy:l.recentItemsGroupByFacet})).groupBy;(o=new a.ItemResolver).resolveItems({items:(p={},p[r]=n.__assign(n.__assign(n.__assign(n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:s.recentItemSetKeyFacet.serialize({driveItemKey:h,sortBy:"",isAscending:!0,groupBy:t||""})})),u.displayNameFacet.pack(f.default.recentTitle)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),p)});e(o.execute());return[2]})})}})});
define("Eq",["require","exports","lC","Hm","Xo","ox","Q3","Rs","Vm","QD"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=o.savedForLaterRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(o={},o[r]=n.__assign(n.__assign(n.__assign(n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:s.savedForLaterItemSetKeyFacet.serialize({driveItemKey:l,sortBy:"",isAscending:!0})})),u.displayNameFacet.pack(f.default.saved)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),o)});e(t.execute());return[2]})})}})});
define("Oq",["require","exports","lC","Hm","K9","Dq","Y3","Jf","oe","se","$n","Vm","oW","wq","Rs","Xo","ph","GA","ri","Io","KW","$W","NW","GW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterMediaContent=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})};t.recentItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var r=this,T=i.recentItemSetKeyFacet.deserialize(e.itemKey),N=T.filters,C=void 0===N?[]:N,k=T.groupBy,L=void 0===k?"":k,A=T,O=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(C),allowedMediaTypes:[f.ItemTypeFilter.photo,f.ItemTypeFilter.video],fileTypeIconMap:l.FileTypeIconMap}),M=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(C),allowedMediaTypes:[f.ItemTypeFilter.photo],fileTypeIconMap:l.FileTypeIconMap}),_=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(C),allowedMediaTypes:[f.ItemTypeFilter.video],fileTypeIconMap:l.FileTypeIconMap});return function(a){return n.__awaiter(r,void 0,void 0,function(){var r,f,l,T,N,k,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee;return n.__generator(this,function(te){switch(te.label){case 0:if(!(r=a(b.readConfiguration({graphRecentEndpoint:y.graphRecentEndpointConfigurationFacet})).graphRecentEndpoint))return[3,1];A=n.__assign(n.__assign({},A),{driveItemKey:n.__assign(n.__assign({},A.driveItemKey),{endpoint:r})});return[3,3];case 1:return[4,a(x.getOneDriveEndpoint({endpoint:A.driveItemKey.endpoint}))];case 2:(f=te.sent())!==A.driveItemKey.endpoint&&(A=n.__assign(n.__assign({},A),{driveItemKey:n.__assign(n.__assign({},A.driveItemKey),{endpoint:f})}));te.label=3;case 3:l=i.recentItemSetKeyFacet.serialize(A);T=h.recentGroupKeyFacet.serialize({relativeTime:"today"});N=h.recentGroupKeyFacet.serialize({relativeTime:"yesterday"});k=h.recentGroupKeyFacet.serialize({relativeTime:"thisWeek"});D=h.recentGroupKeyFacet.serialize({relativeTime:"lastWeek"});P=h.recentGroupKeyFacet.serialize({relativeTime:"twoWeeksAgo"});H=h.recentGroupKeyFacet.serialize({relativeTime:"threeWeeksAgo"});B=h.recentGroupKeyFacet.serialize({relativeTime:"lastMonth"});j=h.recentGroupKeyFacet.serialize({relativeTime:"twoMonthsAgo"});F=[];I=[];q=[];R=[];U=[];z=[];W=[];X=[];V="";$="date"===L;J=function(e){var t,r=e.driveItemKey,i=e.item,s=new c.ItemResolver;if(i&&r){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=m.driveItemKeyFacet.serialize(r);if($&&a){var l=new Date(a);switch(p.getRelativeDateBucketByDate(l)){case p.RelativeDateGroups.today:F.push(f);break;case p.RelativeDateGroups.yesterday:I.push(f);break;case p.RelativeDateGroups.thisWeek:q.push(f);break;case p.RelativeDateGroups.lastWeek:R.push(f);break;case p.RelativeDateGroups.twoWeeksAgo:U.push(f);break;case p.RelativeDateGroups.threeWeeksAgo:z.push(f);break;case p.RelativeDateGroups.lastMonth:W.push(f);break;case p.RelativeDateGroups.twoMonthsAgo:X.push(f);V=p.getMonthString[l.getMonth()]}}s.resolveItems({items:(t={},t[f]=n.__assign({},d.folderFacet.pack(void 0)),t)});return{itemResolver:s}}};K=!O&&$?function(t){var r,i,s=new c.ItemResolver;s.resolveItems({items:(r={},r[T]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Today")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:F})),r[N]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Yesterday")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:I})),r[k]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("This Week")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:q})),r[D]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Last Week")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:R})),r[P]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Two Weeks Ago")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:U})),r[H]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Three Weeks Ago")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:z})),r[B]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Last Month")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:W})),r[j]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack(V)),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:X})),r)});var o=[];F.length>0&&o.push(T);I.length>0&&o.push(N);q.length>0&&o.push(k);R.length>0&&o.push(D);U.length>0&&o.push(P);z.length>0&&o.push(H);W.length>0&&o.push(B);X.length>0&&o.push(j);s.resolveItems({items:(i={},i[e.itemKey]=n.__assign({},v.childItemsFacet.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;return[4,a(g.isConsumerDirectEndpoint(A.driveItemKey.endpoint))];case 4:Q=te.sent();G=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,a(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:O?"recentMedia":Q?"ODC-recent":"recent",itemKey:l,itemSetKeyFacet:i.recentItemSetKeyFacet,parentItemKeyFacet:o.recentRootItemKeyFacet,getUrl:function(e){var t=e.driveItemKey.endpoint+"/"+(e.driveItemKey.endpoint.indexOf("/v2.")>-1?"drives/me":"me/drive")+"/recent?";if(Q)t=e.driveItemKey.endpoint+"/drive/view.recent?";else if(O){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],r=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?r.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||r.length>0?"&$filter="+(0===r.length?w.anyOf(t):0===t.length?w.allOf(r):w.allOf(n.__spreadArrays([w.anyOf(t)],r))):""})(C)},getDriveItemFacets:function(e){var t=E.getDriveItemFacets(e),r=e.driveItem,i=r.thumbnails,s=r.remoteItem,o=i||s&&s.thumbnails;return n.__assign(n.__assign({},t),o?n.__assign({},S.hasThumbnailAuthTokenFacet.pack(!1)):{})},expectedErrors:G,preprocessResponse:function(e){M?e=t.filterMediaContent(e,"image"):_&&(e=t.filterMediaContent(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:O?{Prefer:"ApiVersion=2.1,RecentOnlyMediaApp,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:J,groupChildItems:K})))];case 5:Y=te.sent().itemResolver;O&&Y.resolveItems({items:(Z={},Z[e.itemKey]=n.__assign({},u.mediaGroupFacet.pack({})),Z)});Y.mapKeys({mappings:(ee={},ee[l]=e.itemKey,ee)});a(Y.execute());return[2]}})})}})});
define("oW",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupKeyFacet=new n.KeyFacet("recentGroup",{relativeTime:n.stringPart()})});
define("wq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(n=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.getRelativeDateBucketByDate=function(e){var t=new Date;return(function(e,t){return r(t,e)})(e,t)?n.today:(function(e,t){return r(new Date(t.getTime()-864e5),e)})(e,t)?n.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?n.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?n.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?n.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?n.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?n.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?n.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?n.twoMonthsAgo:""};function r(e,t){return e.toDateString()===t.toDateString()}t.getMonthString=["January","February","March","April","May","June","July","August","September","October","November","December"]});
define("Cq",["require","exports","lC","Hm","Dq","ox","Q3","ph","Z7","Vm","Rs","Xo","zm","$W","Io","QD","ri","GW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function y(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}t.savedForLaterItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:t=r(d.readConfiguration({saveForLaterGraphEndpoint:m.savedForLaterGraphEndpointConfigurationFacet})).saveForLaterGraphEndpoint;b=s.savedForLaterItemSetKeyFacet.deserialize(e.itemKey);if(!t||t===b.driveItemKey.endpoint)return[3,1];b=n.__assign(n.__assign({},b),{driveItemKey:n.__assign(n.__assign({},b.driveItemKey),{endpoint:t})});return[3,3];case 1:return[4,r(g.getOneDriveEndpoint({endpoint:b.driveItemKey.endpoint}))];case 2:(w=T.sent())!==b.driveItemKey.endpoint&&(b=n.__assign(n.__assign({},b),{driveItemKey:n.__assign(n.__assign({},b.driveItemKey),{endpoint:w})}));T.label=3;case 3:E=s.savedForLaterItemSetKeyFacet.serialize(b);S=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,r(i.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{itemKey:E,qosName:"savedForLater",itemSetKeyFacet:s.savedForLaterItemSetKeyFacet,parentItemKeyFacet:o.savedForLaterRootItemKeyFacet,getUrl:function(e){if(e.driveItemKey.endpoint===t){return e.driveItemKey.endpoint+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return e.driveItemKey.endpoint+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(e){var t,r,i=e.itemKey,s=e.driveItemKey,o=e.item,p=new f.ItemResolver;if(s&&o){var d=u.driveItemKeyFacet.serialize(s),v=a.driveFollowedItemKeyFacet.serialize({driveItemKey:s}),m=o&&(o.webDavUrl||o.webUrl);p.resolveItems({items:(t={},t[d]=n.__assign(n.__assign(n.__assign({},l.followedItemFacet.pack({itemKey:v})),l.canonicalUrlFacet.pack(m)),l.fileSizeFacet.pack(o.size)),t[v]=n.__assign(n.__assign({},l.isFollowedFacet.pack(!0)),h.getInvalidationFacet().forFacet(l.isFollowedFacet).thenInvalidate(i,c.childItemsFacet).pack()),t)});p.invalidateItems({items:(r={},r[i]=[c.childItemsFacet],r)})}return{itemResolver:p}},filterChildItems:y,getDriveItemFacets:function(e){var t=e.driveItem,r=t.root,i=t.remoteItem,s=t.name,o=r?v.default.files:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return n.__assign(n.__assign(n.__assign(n.__assign({},p.getDriveItemFacets(n.__assign(n.__assign({},e),{shouldReturnShareFacets:!1}))),l.fileNameFacet.pack(p.getFileName(o,u))),a?l.dateFollowedFacet.pack(new Date(a).getTime()):{}),l.folderFacet.pack(u?{}:void 0))},mapItemSetKey:function(){var t,n=new f.ItemResolver;n.mapKeys({mappings:(t={},t[E]=e.itemKey,t)});return{itemResolver:n}},expectedErrors:S})))];case 4:x=T.sent().itemResolver;r(x.execute());return[2]}})})}})});
define("xq",["require","exports","lC","Hm","Vm","X7","GA","sK","Jv","f7","zm","YW","JW","ph","Rs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveActivityItemGetItemsOperationHandler=r.createBatchedItemsOperationHandler({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=s.driveActivityItemKeyFacet.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,o=s.driveActivityItemKeyFacet.deserialize(t.itemKey).driveItemKey,u=o.endpoint,a=o.driveId;return!!i&&!!a&&i===a&&r===u}})(g);function v(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function m(e){var t=e[0],r={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(r[l.id]=!0)}for(var o=n.__assign(n.__assign({},t),{actors:n.__spreadArrays(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!r[l.id]){o.actors.push(l);r[l.id]=!0}}return o||t}function g(e){var t=this,r=e.items;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,h,g,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X;return n.__generator(this,function(V){switch(V.label){case 0:t=Object.keys(r);c=t[0];h=s.driveActivityItemKeyFacet.deserialize(c);g=h.driveItemKey,b=g.endpoint,w=g.driveId;if(!b)throw new Error("No endpoint to determine activity items.");E=t.map(function(e){return s.driveActivityItemKeyFacet.deserialize(e).driveItemKey.itemId});S=o.getDriveUrl({endpoint:($=b,$.replace("2.1","2.0")),driveId:w});x=S+"/ExtendedActivitiesForItems";T={driveItems:E,badgeOnly:!0};return[4,e(o.getRawData({url:x,method:"POST",body:T,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:b}))];case 1:if((N=V.sent()).value){C=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(N.value);k=0;L=0;A=0;O=0;M=new i.ItemResolver;for(_=0,D=t;_<D.length;_++){P=D[_];k++;H=s.driveActivityItemKeyFacet.deserialize(P);B=H.driveItemKey.itemId;j=B&&C[B];F=p.driveItemKeyFacet.serialize(H.driveItemKey);I=void 0;if(j){q=new u.default;R=q.processResponse({item:{name:B||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:x},response:{value:j,"@odata.nextLink":""}}).activities;U=v(R);if(z=m(R)){A++;L++;if(!U){O++;W=y(z,P).itemResolver;M.merge(W);I=z}}}M.resolveItems({items:(X={},X[P]=n.__assign({},a.itemActivityFacet.pack(I)),X[F]=n.__assign({},l.getInvalidationFacet().forFacet(d.activityItemFacet).thenInvalidate(P,a.itemActivityFacet).pack()),X)})}e(M.execute());e(f.logEngagement({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:k,activityFieldEligibleItemCount:L,activityFieldActiveItemCount:A,activityFieldBadgedItemCount:O,activityFieldBadgedPercent:k?Math.round(O/k*100):0},isIntentional:!1}))}return[2]}var $})})}}t.getActivityItems=g;function y(e,t){var r=new i.ItemResolver,o=s.driveActivityItemKeyFacet.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,r=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=n.__spreadArrays(t,r,i);s&&o.push(s);return o})(e);if(u.length>0){var a=(function(e,t){for(var n=new i.ItemResolver,r=0,s=e;r<s.length;r++){var o=b(s[r],t).itemResolver;n.merge(o)}return{itemResolver:n}})(u,o).itemResolver;r.merge(a)}return{itemResolver:r}}function b(e,t){var n=new i.ItemResolver,r={itemKey:p.driveItemKeyFacet.serialize(t),userKey:h.userByEmailKeyFacet.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},s=c.resolveUserItems(r).itemResolver;n.merge(s);return{itemResolver:n}}});
define("sK",["require","exports","cK","we"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.prototype.processResponse=function(e){var t=this,r=e.item,i=e.response;return{isPlaceholder:!1,activities:i.value.map(function(e){if(n.isOdcActivity(e))if(n.isCommentActivity(e)||n.isCommentResponseActivity(e)){var i=n.getAction(e).comment;(i.contentId||i.navigationId)&&(e.docDetails={contentId:i.contentId,navigationId:i.navigationId})}else if(n.isMentionActivity(e)){var s=n.getAction(e).mention;(s.contentId||s.navigationId)&&(e.docDetails={contentId:s.contentId,navigationId:s.navigationId})}return t._processActivityResponse(r,e)}),nextRequestToken:this._getNextRequestToken(i),success:!0}};e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}};e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}};e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}};e.prototype._processActivityResponse=function(e,t){var r=this._getItem(e,t),i=this._getParentItem(t),s=this._getAction(e,r,i,t);if(n.isOdcActivity(t)){var o=t.actor&&t.actor.user,u=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:u?[u]:[],item:r,parentItem:i,time:new Date(t.activityDateTime),action:s}}var a=t.actor&&t.actor.user,f=a&&{displayName:a.displayName,email:a.email,self:a.self,userPrincipalName:a.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[f],item:r,parentItem:i,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:s}};e.prototype._getActivityType=function(e){return n.matchActivity({Comment:function(){return 2},CommentResponse:function(){return 3},Create:function(){return 11},Delete:function(){return 10},Edit:function(){return 0},Mention:function(){return 4},Move:function(){return 1},Rename:function(){return 9},Restore:function(){return 6},RestoreVersion:function(){return 7},PointInTimeRestore:function(){return 8},Share:function(){return 12},Version:function(){return 5},Copy:function(){return 13},AddShortcutToOneDrive:function(){return 14},RemoveShortcutFromOneDrive:function(){return 15}})(e)};e.prototype._getItem=function(e,t){var r=n.getItem(t);if(n.isMoveActivity(t)){if(n.isOdbActivity(t)){var i=n.getAction(t).move;if(i&&i.to)return{name:this._getFileNameFromPath(i.to),isRoot:this._isRootItem(i.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:i.to}}}else if(n.isDeleteActivity(t)&&n.isOdbActivity(t)){var s=n.getAction(t).delete;if(s&&s.name){var o=(a=(u=r&&r.parentReference)&&this._getRelativePathFromVroomPath(u.path))&&r&&a+"/"+r.name+"/"+s.name;return{name:s.name,isRoot:this._isRootItem(s.name),graphItemUrl:void 0,relativePath:o,absolutePath:void 0,isFolder:"Folder"===s.objectType}}}if(r){t.docDetails&&(r.webUrl=this._getNavLink(r,t.docDetails));var u,a;o=(a=(u=r&&(r.parentReference||r.remoteItem&&r.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(u.path))&&a+"/"+r.name;return n.isDeleteActivity(t)?{name:r.name,isRoot:this._isRootItem(r.name),graphItemUrl:void 0,relativePath:o,absolutePath:void 0}:{name:r.name,isRoot:this._isRootItem(r.name),graphItemUrl:u&&"/drives/"+u.driveId+"/items/"+r.id,relativePath:o,absolutePath:void 0,driveItem:r,navigationId:this._getNavId(t.docDetails)}}if(!n.isOdcActivity(t))return e};e.prototype._getParentItem=function(e){var t=n.getItem(e);if(n.isMoveActivity(e)){var r=n.getAction(e).move;if(r&&r.to){var i=this._getDirNameFromPath(r.to),s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(i),isRoot:this._isRootItem(i),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+s.id,relativePath:void 0,absolutePath:this._getDirNameFromPath(i),isFolder:!0,driveItem:s&&{id:s.id}}}}else if(n.isDeleteActivity(e)&&t){if(n.isOdbActivity(e)){var o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(s=t&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var u=s.name?s.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===u||void 0===s.id)return;return{name:u,isRoot:this._isRootItem(u),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}else{if(n.isRestoreVersionActivity(e)&&t){o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t}}if(n.isPointInTimeRestoreActivity(e)&&t){var a;o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(t){if(s=t.parentReference&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var f=s.name?s.name:o&&this._getFileNameFromPath(o);return{name:f,isRoot:this._isRootItem(f),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}}};e.prototype._getNavLink=function(e,t){var n=e.webUrl,i=n&&new r.default(n),s=t.navigationId;i&&s&&i.setQueryParameter("nav",s);return i.toString()||n};e.prototype._getNavId=function(e){return e&&e.navigationId};e.prototype._getAction=function(e,t,r,i){var s={};n.isVersionActivity(i)&&(s.version={newVersion:n.getAction(i).version.newVersion});if(n.isMoveActivity(i)){var o=n.getAction(i).move;if(n.isOdcActivity(i)){var u=void 0,a=void 0;o.from&&(u=this._getDirNameFromPath(o.from));o.to&&(a=this._getDirNameFromPath(o.to));s.move={from:{name:this._getFileNameFromPath(u),isRoot:this._isRootItem(u),graphItemUrl:void 0,absolutePath:u},to:{name:this._getFileNameFromPath(a),isRoot:this._isRootItem(a),graphItemUrl:void 0,absolutePath:a}}}else if(o.From){var f=this._getDirNameFromPath(o.From);s.move={from:{name:this._getFileNameFromPath(f),isRoot:this._isRootItem(f),graphItemUrl:void 0,absolutePath:f},to:void 0}}else if(o.to){var l=this._getDirNameFromPath(o.to);s.move={from:void 0,to:{name:this._getFileNameFromPath(l),isRoot:this._isRootItem(l),graphItemUrl:void 0,absolutePath:l}}}}if(n.isRenameActivity(i)){var c=n.getAction(i).rename;s.rename={newItem:{name:c.newName,isRoot:this._isRootItem(c.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:c.oldName,isRoot:this._isRootItem(c.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(n.isCommentResponseActivity(i)){(h=n.getAction(i).comment).isReply&&(s.commentResponse={commentAuthor:h.parentAuthor&&h.parentAuthor.user})}if(n.isCommentActivity(i)){var h;(h=n.getAction(i).comment).isReply||(s.comment={commentId:h.commentId})}if(n.isMentionActivity(i)){var p=n.getAction(i).mention;s.mention={mentionees:p.mentionees&&p.mentionees.map(function(e){return e.user})||[]}}if(n.isShareActivity(i)){var d=n.getAction(i).share;s.share={recipients:d.recipients&&d.recipients.map(function(e){return e.user})||[]}}n.isAddShortcutToOneDriveActivity(i)&&(s.addShortcutToOneDrive={});if(n.isRemoveShortcutFromOneDriveActivity(i)){var v=n.getAction(i).addToOneDrive;s.removeShortcutFromOneDrive={mountPointName:v.mountPointName}}return s};e.prototype._getRelativePathFromVroomPath=function(e){if(e){return e.split(":",2)[1]}};e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))};e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)};e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e};return e})();t.default=i});
define("cK",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){return void 0!==e.action}t.isOdbActivity=n;t.isOdcActivity=function(e){return void 0!==e.activityDateTime};function r(e){var t=b(e).comment;return void 0!==t&&!t.isReply}t.isCommentActivity=r;function i(e){var t=b(e).comment;return void 0!==t&&t.isReply}t.isCommentResponseActivity=i;function s(e){return void 0!==b(e).mention}t.isMentionActivity=s;function o(e){return void 0!==b(e).edit}t.isEditActivity=o;function u(e){return void 0!==b(e).version}t.isVersionActivity=u;function a(e){return void 0!==b(e).pointInTimeRestore}t.isPointInTimeRestoreActivity=a;function f(e){return void 0!==b(e).restore}t.isRestoreActivity=f;function l(e){return void 0!==b(e).restoreVersion}t.isRestoreVersionActivity=l;function c(e){return void 0!==b(e).move}t.isMoveActivity=c;function h(e){return void 0!==b(e).rename}t.isRenameActivity=h;function p(e){return void 0!==b(e).delete}t.isDeleteActivity=p;function d(e){return void 0!==b(e).create}t.isCreateActivity=d;function v(e){return void 0!==b(e).share}t.isShareActivity=v;function m(e){return void 0!==b(e).copy}t.isCopyActivity=m;function g(e){var t=b(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}t.isAddShortcutToOneDriveActivity=g;function y(e){var t=b(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}t.isRemoveShortcutFromOneDriveActivity=y;t.matchActivity=function(e){return function(t){return r(t)?e.Comment(t):i(t)?e.CommentResponse(t):d(t)?e.Create(t):p(t)?e.Delete(t):o(t)?e.Edit(t):s(t)?e.Mention(t):c(t)?e.Move(t):h(t)?e.Rename(t):f(t)?e.Restore(t):l(t)?e.RestoreVersion(t):v(t)?e.Share(t):u(t)?e.Version(t):m(t)?e.Copy(t):a(t)?e.PointInTimeRestore(t):g(t)?e.AddShortcutToOneDrive(t):y(t)?e.RemoveShortcutFromOneDrive(t):void 0}};function b(e){return n(e)?e.action:e}t.getAction=b;t.getItem=function(e){return e.driveItem||e.listItem}});
define("Iq",["require","exports","lC","Hm","YD","rs","Vm","ox","Z7","Xo","Rs","So","zm","ph"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveFollowItemGetItemsOperationHandler=r.createBatchedItemsOperationHandler()(d);function d(e){var t=this,r=e.items;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:return[4,e(s.readItems(function(e){return e.demandItemFacet(c.enableFollowItemConfigurationFacet,c.configurationItemKey)}))];case 1:if(!O.sent())return[2];t=Object.keys(r);d=t[0];v=a.driveFollowedItemKeyFacet.deserialize(d);if(!(m=v.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");g=u.savedForLaterItemSetKeyFacet.serialize({driveItemKey:{endpoint:m},sortBy:"",isAscending:!0});return[4,e(i.demandItems(function(e){return e.demandItemFacet(f.childItemsFacet,g)}))];case 2:y=O.sent();b=y&&y.itemKeys||[];w=new o.ItemResolver;E={};for(S=0,x=b;S<x.length;S++){k=x[S];E[k]=!0}for(T=0,N=t;T<N.length;T++){C=N[T];k=a.driveFollowedItemKeyFacet.deserialize(C).driveItemKey;L=!!E[p.driveItemKeyFacet.serialize(k)];w.resolveItems({items:(A={},A[C]=n.__assign(n.__assign({},l.isFollowedFacet.pack(L||void 0)),h.getInvalidationFacet().forFacet(l.isFollowedFacet).thenInvalidate(g,f.childItemsFacet).pack()),A)})}e(w.execute());return[2]}})})}}t.getFollowedItems=d});
define("yq",["require","exports","lC","Hm","mq","Dq","GA","Sq"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a;return n.__generator(this,function(f){switch(f.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"search",itemSetKeyFacet:i.searchItemSetKeyFacet,parentItemKeyFacet:u.searchRootItemKeyFacet,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return o.getDriveItemUrl(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:a=f.sent().itemResolver;r(a.execute());return[2]}})})}})});
define("mq",["require","exports","fi","ph"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetKeyFacet=new n.KeyFacet("searchItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),searchTerm:n.stringPart()})});
define("Sq",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchRootItemKeyFacet=new n.KeyFacet("searchRootItem",{endpoint:n.stringPart()})});
define("gq",["require","exports","lC","Hm","Xo","$1","vq","HW","$f"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDriveItemSet=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(a.asBatch(function(){e(s.supportFacets({keyFacet:u.driveItemSetKeyFacet,facets:[u.driveItemSetKeyFacet,i.childItemsFacet]}));e(r.registerOperationHandler(u.driveItemSetKeyFacet,s.getItemsOperation)(o.driveItemSetGetItemsOperationHandler))}));return[2]})})}})});
define("vq",["require","exports","lC","Hm","zW","Io","ri","UW","Y6","Lr"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,l;return n.__generator(this,function(c){switch(c.label){case 0:t=r(s.readConfiguration({pageSize:o.driveItemSetPageSizeFacet})).pageSize;return[4,r(i.loadAndProcessPagedDriveItemSet(n.__assign(n.__assign({},e),{skip:0,top:t||u.DEFAULT_PAGE_SIZE})))];case 1:l=c.sent();f.mark(a.itemsViewPerfMarkers.resolveData.start);r(l.execute());f.mark(a.itemsViewPerfMarkers.resolveData.end);return[2]}})})}})});
define("zW",["require","exports","lC","HW","ph","Vm","rs","GA","Jf","WW","KW","W9","wo","GW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadAndProcessPagedDriveItemSet=function(e){var t=this;return function(d){return n.__awaiter(t,void 0,void 0,function(){var t,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$;return n.__generator(this,function(J){switch(J.label){case 0:t=e.itemKey,v=e.top,m=e.skip;g=r.driveItemSetKeyFacet.deserialize(t);y=g.driveItemKey,b=g.extFilters;w=g.sortBy,E=g.isAscending;S=g;x=y;return y.driveId&&"me"!==y.driveId?[3,2]:[4,d(p.getOneDriveEndpoint({endpoint:y.endpoint}))];case 1:if((T=J.sent())!==y.endpoint){x=n.__assign(n.__assign({},y),{endpoint:T});S=n.__assign(n.__assign({},g),{driveItemKey:x})}J.label=2;case 2:N=i.driveItemKeyFacet.serialize(x);C=u.getDriveUrl(x);return[4,d(o.readItems(function(e){return{isParentItemResolved:e.isItemFacetResolved(i.driveItemKeyFacet,N),totalChildCount:e.isItemFacetResolved(a.countFacet,N)?e.demandItemFacet(a.countFacet,N):void 0,driveType:e.isItemFacetResolved(c.driveTypeFacet,N)?e.demandItemFacet(c.driveTypeFacet,N):void 0}}))];case 3:k=J.sent(),L=k.isParentItemResolved,A=k.totalChildCount,O=k.driveType;M=Promise.resolve(void 0);L||(M=d(u.getRawDataWithCache({url:u.getDriveItemUrl(x),driveUrl:C,qosName:"getItem",endpoint:x.endpoint})));_=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"}];D=u.getDriveItemUrl(y);P=m?"&skiptoken="+(m+1)+"/"+A+"&skip="+m:"";H=w&&void 0!==E?u.getOrderByQueryParamString(w,E):"";B=l.getExtFiltersParams(b);j=d(u.getRawDataWithCache({url:D+"/children?$top="+v+P+H+"&$expand=thumbnails&select=*,webDavUrl"+B,driveUrl:C,qosName:"getChildren.folder",endpoint:x.endpoint,expectedErrors:_}));F=[j,M];return[4,Promise.all(F)];case 4:I=J.sent(),q=I[0];if(R=I[1]){R.folder&&(A=R.folder.childCount);R.parentReference&&R.parentReference.driveType&&(O=R.parentReference.driveType)}U=d(u.supportsDriveItemSetRandomAccess(x.endpoint,O));(z=new s.ItemResolver).mapKeys({mappings:(V={},V[r.driveItemSetKeyFacet.serialize(S)]=e.itemKey,V[N]=i.driveItemKeyFacet.serialize(g.driveItemKey),V)});g.driveItemKey.driveId&&"me"!==g.driveItemKey.driveId||z.mapKeys({mappings:($={},$[i.driveItemKeyFacet.serialize(n.__assign(n.__assign({},g.driveItemKey),{driveId:"me"}))]=i.driveItemKeyFacet.serialize(n.__assign(n.__assign({},g.driveItemKey),{driveId:""})),$)});X=(W=z).merge;return[4,d(f.processDriveItemSet({itemKey:t,itemSetKeyFacet:r.driveItemSetKeyFacet,parentItemKeyFacet:i.driveItemKeyFacet,parentItemResponse:R,childItemsResponse:q,filterChildItems:b&&b.length>0?l.getChildrenItemFilter(b):void 0,skip:m,enableRandomAccess:U,totalChildCount:A,onProcessResponse:function(e){var t,r=e.driveItemKey,o=new s.ItemResolver;r&&o.resolveItems({items:(t={},t[i.driveItemKeyFacet.serialize(r)]=n.__assign({},h.resolvedAsKeyFacetFacet.pack(i.driveItemKeyFacet)),t)});return{itemResolver:o}}}))];case 5:X.apply(W,[J.sent().itemResolver]);return[2,z]}})})}}});
define("pq",["require","exports","lC","Hm","Vm","uq","cq","GA"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandsGetItemsOperationHandler=r.createSingleItemOperationHandler()(a);function a(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,l,c,h,p,d;return n.__generator(this,function(v){switch(v.label){case 0:t=e.itemKey;a=o.commandsItemKeyFacet.deserialize(t);l=a.endpoint;c=u.getDriveUrl(a);return[4,r(f({url:u.getCommandsUrlFromDriveItem(a),driveUrl:c,qosName:"commands",endpoint:l}))];case 1:h=v.sent();(p=new i.ItemResolver).resolveItems({items:(d={},d[t]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},s.addToOneDriveFacet.pack(h.addToOneDrive)),s.createFolderFacet.pack(h.createFolder)),s.createLinkFacet.pack(h.createLink)),s.deleteFacet.pack(h.delete)),s.downloadFacet.pack(h.download)),s.inviteFacet.pack(h.invite)),s.moveFacet.pack(h.move)),s.officeLensFacet.pack(h.officeLens)),s.renameFacet.pack(h.rename)),s.uploadFacet.pack(h.upload)),d)});r(p.execute());return[2]}})})}}t.getCommands=a;function f(e){var t=this;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}});
define("uq",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveFacet=new n.Facet("addToOneDrive");t.createFolderFacet=new n.Facet("createFolder");t.createLinkFacet=new n.Facet("createLink");t.deleteFacet=new n.Facet("delete");t.downloadFacet=new n.Facet("download");t.inviteFacet=new n.Facet("invite");t.moveFacet=new n.Facet("move");t.officeLensFacet=new n.Facet("officeLens");t.renameFacet=new n.Facet("rename");t.uploadFacet=new n.Facet("upload")});
define("cq",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandsItemKeyFacet=new n.KeyFacet("commands",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})})});
define("fq",["require","exports","lC","ih","Ro","ho","ph","HW","Xo","$1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openActionControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=i.getCurrentItemSetKey(e),s=c(e,{folderItemKey:t.itemKey,currentItemSetKey:r}),a=s&&l(e,{parentItemKey:o.driveItemKeyFacet.serialize(s.driveItemKey),stageItem:t.stageItem});return n.__assign(n.__assign({},s?{itemKey:u.driveItemSetKeyFacet.serialize(s)}:{}),a?{stageItem:a}:{})}}});function l(e,t){var r=this,i=t.parentItemKey,o=t.stageItem;if(i)return o?s.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return n.__awaiter(r,void 0,void 0,function(){var r;return n.__generator(this,function(u){switch(u.label){case 0:e(f.resolveItems({items:(r={},r[s]=n.__assign({},a.parentItemFacet.pack({itemKey:i})),r)}));return[4,e(o({currentItemKey:s,itemsScopeItemKey:t}))];case 1:u.sent();return[2]}})})}}):void 0}t.getStageItemOverride=l;function c(e,t){var r=t.folderItemKey,i=t.currentItemSetKey;if(i&&r){var s=e.demandItemFacet(u.driveItemSetKeyFacet,i),a=e.demandItemFacet(o.driveItemKeyFacet,r);if(s&&a){var f=a.endpoint,l=a.driveId,c=a.itemId;return n.__assign(n.__assign({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}}t.getOverrideItemSetKeyForFolder=c});
define("lq",["require","exports","lC","K9","ih","U8","F8"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return u}});function u(e,t){var i=t.handlers,u=t.itemKey,a=e.demandItemFacet(r.recentItemSetKeyFacet,u);if(i&&a){for(var f=[],l=0,c=i;l<c.length;l++){var h=c[l];if(h.key===o.itemPhotoTypeFilterHandler.key)f.push("photo");else if(h.key===o.itemVideoTypeFilterHandler.key)f.push("video");else if(h.key===o.itemFolderTypeFilterHandler.key)f.push("folder");else if(h.key===o.itemOneNoteFilterHandler.key)f.push("onenote");else if(h.key===o.itemNonPhotoTypeFilterHandler.key)f.push("!photo");else if(h.key===o.itemNonVideoTypeFilterHandler.key)f.push("!video");else if(h.key===o.itemNonFolderTypeFilterHandler.key)f.push("!folder");else if(h.key===o.itemNonOneNoteFilterHandler.key)f.push("!onenote");else{var p=s.getExtensionFilterFromFilterHandler(h);p&&f.push(p)}}return{itemKey:r.recentItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{filters:f}))}}return{}}});
define("dq",["require","exports","ih","Mr","K9","oe","se","$n"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsViewControlHandler=n.createControlHandler()(a);t.itemsViewLayoutsControlHandler=n.createControlHandler()(a);function a(){return function(e){return function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(i.recentItemSetKeyFacet,n);if(a&&a.filters&&s.doExtFiltersHaveMediaTypesOnly({extFilters:s.getIItemTypeFilter(a.filters),allowedMediaTypes:[o.ItemTypeFilter.photo,o.ItemTypeFilter.video],fileTypeIconMap:u.FileTypeIconMap}))return{defaultLayout:r.tilesLayoutType,isLayoutResolved:!0}}return{}}}}});
define("sq",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharesItemKeyFacet=new n.KeyFacet("sharesItem",{endpoint:n.stringPart(),shareId:n.stringPart()})});
define("oq",["require","exports","lC","Hm","sq","GA","ph","$W","Xo","HW","Vm","Co"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharesItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.sharesItemKeyFacet.deserialize(r),p=h.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:return[4,e(s.getRawData({url:s.getSharesItemUrl(h)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:p,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:t=E.sent();i=new l.ItemResolver;d=t&&t.parentReference;v=d&&d.driveId;m={endpoint:p,driveId:v,itemId:t.id};g=o.driveItemKeyFacet.serialize(m);y=d&&d.id?o.driveItemKeyFacet.serialize({endpoint:p,driveId:v,itemId:d.id}):void 0;i.resolveItems({items:(b={},b[g]=n.__assign(n.__assign(n.__assign({},u.getDriveItemFacets({driveItem:t,endpoint:p,parentFolderItemKey:y})),c.preferredKeyFacetFacet.pack(o.driveItemKeyFacet)),a.defaultChildItemSetFacet.pack({itemKey:f.driveItemSetKeyFacet.serialize({driveItemKey:m,sortBy:"",isAscending:!0})})),b)});i.mapKeys({mappings:(w={},w[g]=r,w)});e(i.execute());return[2]}})})}})});
define("FW",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemVirtualizedPageKeyFacet=new n.KeyFacet("driveItemVirtualizedPage",{endpoint:n.stringPart(),setItemKey:n.stringPart(),skip:n.numberPart(),top:n.numberPart()})});
define("VW",["require","exports","lC","Hm","FW","zW"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemVirtualizedPageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,o=i.driveItemVirtualizedPageKeyFacet.deserialize(r),u=o.setItemKey,a=o.top,f=o.skip;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(i){switch(i.label){case 0:return[4,r(s.loadAndProcessPagedDriveItemSet(n.__assign(n.__assign({},e),{itemKey:u,skip:f,top:a})))];case 1:t=i.sent();r(t.execute());return[2]}})})}})});
define("RW",["require","exports","ih","ph","BW","AW","EW","NW","ye","Rs","w8","u9"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemThumbnailControlHandler=n.createControlHandler()(function(){return function(e){return h}});function h(e,t){var n=t.itemKey,h=t.desiredSize,d=e.demandItemFacet(r.driveItemKeyFacet,n);if(!d)return{};var v=e.demandItemFacet(u.hasThumbnailAuthTokenFacet,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,s=(function(e){return e&&p(e)?e[0]:e})(e.demandItemFacet(i.graphThumbnailSetFacet,n));if(s&&s.large)return{url:m(s.large.url,r),width:0,height:0}})(e,{itemKey:n,driveItem:d,desiredSize:h}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var u=e.demandItemFacet(f.canonicalUrlFacet,n),h=e.demandItemFacet(f.eTagFacet,n,{suppressGetItems:!0})||"";if(u){var p=new a.SimpleUri(r.endpoint).authority+"/_api/v2.1",d=s.thumbnailTokenKeyFacet.serialize({endpoint:p,driveId:r.driveId}),v=e.demandItemFacet(o.thumbnailAccessTokenFacet,d);if(v){var m=l.getDriveItemUrl({endpoint:p,driveId:r.driveId,itemId:r.itemId}),g=Math.ceil(i.width),y=Math.ceil(i.height);return{url:m+"/thumbnails/0/c"+g+"x"+y+"/content?"+c.serializeQuery({prefer:"noredirect,closestavailablesize",cb:h,access_token:v}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:d,desiredSize:h});return v?{thumbnail:v}:{}}function p(e){return e&&"number"==typeof e.length}t.isArray=p;var d=/width=[0-9]*/,v=/height=[0-9]*/;function m(e,t){var n="number"==typeof t.width?Math.ceil(t.width):t.width,r="number"==typeof t.height?Math.ceil(t.height):t.height,i=""+(n||"");d.test(e)?e=e.replace(d,"width="+i):e+=(e.indexOf("?")>-1?"&":"?")+"width="+i;var s=""+(r||"");v.test(e)?e=e.replace(v,"height="+s):e+=(e.indexOf("?")>-1?"&":"?")+"height="+s;return e}});
define("AW",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailTokenKeyFacet=new n.KeyFacet("thumbnailToken",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})})});
define("EW",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailAccessTokenFacet=new n.Facet("thumbnailAccessToken")});
define("TW",["require","exports","ih","HW","Jf","FW","ph","So","ri","UW","W9"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetPagingControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.setItemKey,c=e.demandItemFacet(r.driveItemSetKeyFacet,n);if(!n||!c)return{};var h=c.driveItemKey.endpoint,p=o.driveItemKeyFacet.serialize(c.driveItemKey),d=e.demandItemFacet(l.driveTypeFacet,p),v=e.demandItemFacet(a.driveItemSetPageSizeFacet,u.configurationItemKey)||f.DEFAULT_PAGE_SIZE,m=e.demandItemFacet(a.supportsDriveItemSetRandomAccessFacet,u.configurationItemKey);if(m&&m(h,d)){return{totalItemCount:e.demandItemFacet(i.countFacet,p),getPageKey:function(e,t){return s.driveItemVirtualizedPageKeyFacet.serialize({setItemKey:n,endpoint:c.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:v}}return{}}}})});
define("PW",["require","exports","ih","Jp","e9","B_","Q4","G4","J4"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return l}});var f=[s.fileTypeIconColumn,r.displayNameColumn,i.dateModifiedColumn,a.modifiedByColumn,o.fileSizeColumn,u.sharedColumn];function l(e,t){return{columns:f}}});
define("MW",["require","exports","lC","Hm","ih","ph","Yv","J1"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphItemActivityAddon=r.createAddon(function(){return function(t){t(i.registerControlHandler(s.driveItemKeyFacet,o.itemActivityFieldControl)(i.createDeferredControlHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(u.waitForPageLoad())];case 1:n.sent();return[4,new Promise(function(t,n){e(["sKe"],t,n)})];case 2:return[2,n.sent().driveItemActivityFieldControlHandler]}})})})))}})});
define("kW",["require","exports","lC","ih","A1","Jp","HW","ri","Kv","W9","ph","Kv"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES=c.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES;t.driveItemSortedItemSetControlHandler=r.createControlHandler()(function(){return function(e){return h}});function h(e,t){return p(e,o.driveItemSetKeyFacet,t)}function p(e,t,r){var o=r.itemSetKey,c=r.handler,h=c.columnKey,p=c.isAscending,d=e.demandItemFacet(t,o);if(!d)return{};var v=e.demandItemFacet(f.driveTypeFacet,l.driveItemKeyFacet.serialize(n.__assign({},d.driveItemKey)));if(!v||"business"===v||"documentLibrary"===v)return{};if(!d.sortBy&&h===s.displayNameColumn.key&&!0===p)return{newItemSetKey:o};var m=i.getConfiguration(e,{customColumnKeysToFieldNamesConfiguration:u.customColumnKeysToFieldNamesConfigurationFacet}).customColumnKeysToFieldNamesConfiguration,g=n.__assign(n.__assign({},a.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES),m),y=g?g[h]:void 0;return y?{newItemSetKey:t.serialize(n.__assign(n.__assign({},d),{sortBy:y,isAscending:p}))}:{}}t.getSortedItemSetKey=p});
define("LW",["require","exports","ih"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemMoveCopyActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}})});
define("wW",["require","exports","lC","qA","Vm","Hm","EW","AW","GA"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailUrlTokenOperationHandler=s.createSingleItemOperationHandler()(function(e){var t=this,s=e.itemKey,f=u.thumbnailTokenKeyFacet.deserialize(s),l=f.endpoint,c=f.driveId;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,f,h,p;return n.__generator(this,function(d){switch(d.label){case 0:t=a.getDriveUrl({endpoint:l,driveId:c});return[4,e(r.getSessionToken(l,t))];case 1:u=d.sent();f=u&&u.accessToken;(h=new i.ItemResolver).resolveItems({items:(p={},p[s]=n.__assign({},o.thumbnailAccessTokenFacet.pack(f)),p)});e(h.execute());return[2]}})})}})});
define("OW",["require","exports","lC","r","C1","G_","xW","ih"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialFolderIconControlHandler=u.createControlHandler()(function(){return function(e){return function(e,t){return{fileTypeIconAs:a}}}});var a=i.createItemCacheComponent(function(e,t){var i=t.defaultRender,u=n.__rest(t,["defaultRender"]),a=u.isFolder,f=u.itemKey,l=u.type,c=l;if(a&&void 0===l){var h=e.demandItemFacet(o.specialFolderFacet,f);void 0!==h&&("desktop"===h?c=s.FileIconType.desktopFolder:"documents"===h?c=s.FileIconType.documentsFolder:"pictures"===h&&(c=s.FileIconType.picturesFolder))}return i?r.createElement(i,n.__assign({},u,{type:c})):null})});
define("IW",["require","exports","r","ih","c_","xW"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialFolderTileControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){return{folderCoverControlHandler:function(t,r){var o=r.signalData;if(o&&o.signal)return{};var u=e.demandItem({specialFolder:s.specialFolderFacet},r.itemKey).specialFolder;if(!u)return{};var a=(function(e){var t=null;"desktop"===e?t=n.createElement(i.DesktopSignal,null):"documents"===e?t=n.createElement(i.DocumentsSignal,null):"pictures"===e&&(t=n.createElement(i.PicturesSignal,null));return{signal:t,key:e||""}})(u);return a&&a.signal?{signalData:a}:{}}}}}})});
define("gW",["require","exports","lC","ih","og","vW"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.commands,i=t.overflowCommands,s=t.farCommands,u=i?n.__spreadArrays(i):[],a=r?n.__spreadArrays(r):[],f=s;return{commands:a=o(e,{defaultCommands:a}).overrideDefaultCommands,overflowCommands:u,farCommands:f}}}});function o(e,t){for(var n=[],r=0,o=t.defaultCommands;r<o.length;r++){var u=o[r];u.key===i.openCommand.key?n.push(s.openFileCommand):n.push(u)}return{overrideDefaultCommands:n}}t.getOverrideDefaultCommands=o});
define("vW",["require","exports","lC","r","Vb","og","SW","yW"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openFileCommand={key:s.openCommand.key,automationId:s.openCommand.automationId,subMenuProps:{items:[u.openInOfficeOnlineCommand]},onRender:function(e){return r.createElement(o.OpenCommandButton,n.__assign({},e,{menuProps:e.subMenuProps}))},facets:n.__assign({},i.isReadonlyFacet.pack(!0))}});
define("SW",["require","exports","lC","r","nc","vm","bW","jM","SPListItemsScopeDeferred_IS_mini_css","_s","C1","Rs","yW","si"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";a=a.OpenCommandButton_8;Object.defineProperty(t,"__esModule",{value:!0});var d=new p.Facet("fileHandlerOpenCommand").id;t.OpenCommandSubMenuItemForContextMenu=f.withSelectedItems()(f.withExactlyOneItem()(l.connectToItemCache(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:o.officeAppFacet},n).appMap,s=r.name;r.key===h.openInOfficeOnlineCommand.key&&(s=s||(i?u.getOfficeOnlineStringMap(i,!0):u.OpenFileStrings.OpenInBrowser));return{name:s}})(function(e){return r.createElement("div",{className:a.contextualMenuItemLinkContent},r.createElement("span",{dir:"auto",className:a.contextualMenuItemTextLabel},e.name))})));t.OpenCommandButton=f.withSelectedItems()(f.withExactlyOneItem()(l.connectToItemCache(function(e,t){var r=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:o.officeAppFacet,fileName:c.fileNameFacet},r),a=s.appMap,f=s.fileName,l={};if(i&&i.items){var p=i.items[0];p&&-1!==p.key.indexOf(d)&&p.iconProps&&(l=p.iconProps)}var m=!!f&&!!f.extension&&".pdf"===f.extension.toLowerCase(),g=a&&u.getOfficeAppLogosMap(a),y={iconName:a?u.getOfficeAppIconNameMap(a):m?"PDF":"OpenFile"},b=void 0;i&&i.items&&(b=i.items.map(function(e){return e.key===h.openInOfficeOnlineCommand.key?n.__assign(n.__assign({},e),{iconProps:y,name:e.name||a&&u.getOfficeOnlineStringMap(a,!0)||(m?u.OpenFileStrings.OpenInBrowser:u.OpenFileStrings.Open),onRenderIcon:g?v.bind(void 0,g,!0):void 0}):e}));return{iconProps:l||y,onRenderIcon:g?v.bind(void 0,g,!1):void 0,text:u.OpenFileStrings.Open,menuProps:b?n.__assign(n.__assign({},i),{items:b}):i}})(s.CommandBarButton)));function v(e,t){return e?r.createElement("span",{className:t?a.menuItemIconContainer:a.iconContainer},r.createElement(i.Icon,{iconName:e.logoFill16,className:a.logoFillIcon}),r.createElement(i.Icon,{iconName:e.logo16,className:a.logoIcon})):null}});
define("yW",["require","exports","lC","r","si","Vb","_W"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeOnlineCommand={key:new i.Facet("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:r.createElement(o.OpenInOfficeOnlineAction,null),facets:n.__assign({},s.isReadonlyFacet.pack(!0))}});
define("_W",["require","exports","lC","l8","C1","ks","Rs","_s","Es","hW","rs","bW"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemOpenInOfficeOnlineAction=i.connectToItemCache(function(e,t){var i=t.itemKey,s=e.demandItem({openUrl:o.openUrlFacet,appFacet:c.officeAppFacet,isMalwareDetected:o.malwareDetectedFacet},i),u=s.openUrl,h=s.appFacet,p=s.isMalwareDetected,d=e.dispatch,v=!p&&!!h&&!!u,m=e.demandItemFacet(f.openInOfficeOnlineActionControl,i);return n.__assign({isAvailable:v,onExecute:u?function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){e=(new Date).getTime().toString();t=r.WopiHelper.AddWopiPerfMarkToTargetUrl(e,"ItemsView",u);d(l.readItems(function(e){return f.openInOfficeOnlineActionControl.evaluate(m)(e,{itemKey:i,forceInSameWindow:!1})})).forceInSameWindow?window.location.href=t:window.open(t);return[2]})})}:void 0},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(s.Action);t.OpenInOfficeOnlineAction=u.withSelectedItems()(u.withExactlyOneItem()(t.ItemOpenInOfficeOnlineAction))});
define("hW",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeOnlineActionControl=new n.ControlFacet("openInOfficeOnlineActionControl")});
define("pW",["require","exports","lC","ih","p8","mW"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClickActionControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.handlers,o=void 0===r?[]:r;return{handlers:n.__spreadArrays([i.malwareDetectedDefaultClickActionHandler,s.openInOfficeOnlineDefaultClickActionHandler],o)}}}})});
define("mW",["require","exports","r","bW","si","Rs","Ps","zb","_W"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeOnlineDefaultClickActionHandler={key:new i.Facet("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var i=t.itemKey,f=e.demandItem({openUrl:s.openUrlFacet,appMap:r.officeAppFacet},i),l=f.openUrl,c=f.appMap;return{action:!!l&&!!c?n.createElement(u.ItemShowMalwareDetectedAction,{itemKey:i,action:o.evaluateAction(e,n.createElement(a.ItemOpenInOfficeOnlineAction,{itemKey:i}))}):void 0}}}});
define("nW",["require","exports","Hm","ih","E1","K9","uW","Y3","Sg","lW","sW","d0","U1","oW","rW","aW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphRecentAddon=n.createAddon(function(){return function(e){e(r.registerControlHandler(s.recentItemSetKeyFacet,i.itemSetColumnsControl)(o.recentItemSetColumnsControlHandler));e(r.registerControlHandler(u.recentRootItemKeyFacet,a.itemsCommandBarControl)(f.recentCommandBarControlHandler));e(r.registerControlHandler(u.recentRootItemKeyFacet,c.itemsContextMenuControl)(l.recentContextMenuControlHandler));e(r.registerControlHandler(p.recentGroupKeyFacet,h.openActionControl)(d.recentGroupOpenActionControlHandler));e(v.recentRootItemEngagementAddon)}})});
define("uW",["require","exports","ih","tW","fW","bL"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,s.nameAndPathColumn,i.dateAccessedColumn];function u(e,t){return{columns:o}}});
define("fW",["require","exports","A_","N_","si","n9","Rs","So","U7"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateAccessedColumn=n.createColumn({key:new i.Facet("dateAccessedColumn").id,name:r.default.AccessedDate,fieldName:"",minWidth:n.ColumnWidth.regularMin,maxWidth:n.ColumnWidth.regularMax,isCollapsable:!0},s.DateField)(function(e,t){var n=e.demandItemFacet(o.dateAccessedFacet,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(u.localeFacet,u.configurationItemKey),s=i&&i.language||window.navigator.language;return s?{text:a.getRelativeDateTimeStringPast(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(o.dateAccessedFacet,t)})});
define("lW",["require","exports","ih","og","Jb","gW","cW"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.openCommand,o.openFileLocationCommand,i.shareCommand,i.copyLinkCommand];function a(e,t){return{commands:s.getOverrideDefaultCommands(e,{defaultCommands:u}).overrideDefaultCommands}}});
define("cW",["require","exports","dW","TS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openFileLocationCommand={key:"OpenFileLocation",name:r.default.OpenFileLocation,title:r.default.OpenFileLocation,action:n.OpenParentFolderAction,iconProps:{iconName:"FabricFolder"}}});
define("dW",["require","exports","r","_s","C1","Rs","Kf"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenParentFolderAction=r.withSelectedItems()(r.withExactlyOneItem()(i.createItemCacheComponent(function(e,t){var r=t.itemKey,i=e.demandItemFacet(s.parentFolderItemFacet,r);return i?n.createElement(o.ItemDefaultClickAction,{itemKey:i.itemKey}):null})))});
define("sW",["require","exports","ih","og","Jb","cW","sf"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return f}});var u={name:"-",key:"divider_1",itemType:o.ContextualMenuItemType.Divider},a=[r.openCommand,s.openFileLocationCommand,u,i.shareCommand,i.copyLinkCommand];function f(e,t){return{commands:a}}});
define("rW",["require","exports","ih"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("aW",["require","exports","lC","ih","u1","Ro","Hm","iW","Y3"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{datasource:"Recent",extraData:n.__assign({},"ItemsView.Load"===s?l(e,{itemsScopeItemKey:r}):{})}}}}});function l(e,t){var r=t.itemsScopeItemKey,i=s.getCurrentItemSetKey(e,r),o=e.demandItemFacet(u.itemSetEngagementExtraDataFacet,i);return n.__assign({},o)}t.recentRootItemEngagementAddon=o.createAddon(function(){return function(e){e(r.registerControlHandler(a.recentRootItemKeyFacet,i.itemEngagementControl)(f))}})});
define("KK",["require","exports","Hm","ih","l0","E1","$K","Zs","JK","QK","_0","WK","ox","Q3","gW","Sg"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphSavedForLaterAddon=n.createAddon(function(){return function(e){e(r.registerControlHandler(h.savedForLaterItemSetKeyFacet,u.itemSetDetailsListControl)(a.savedForLaterRootItemSetDetailsListControlHandler));e(r.registerControlHandler(h.savedForLaterItemSetKeyFacet,i.itemSetTilesListControl)(f.savedForLaterRootItemSetTilesListControlHandler));e(r.registerControlHandler(h.savedForLaterItemSetKeyFacet,s.itemSetColumnsControl)(o.savedForLaterRootItemSetColumnsControlHandler));e(r.registerControlHandler(h.savedForLaterItemSetKeyFacet,l.emptyFolderControl)(c.emptyFolderControlHandler));e(r.registerControlHandler(p.savedForLaterRootItemKeyFacet,v.itemsCommandBarControl)(d.itemsCommandBarControlHandler))}})});
define("$K",["require","exports","ih","tW","bL","eW","Gv"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateFollowedColumn,o.itemActivityColumn];function a(e,t){return{columns:u}}});
define("eW",["require","exports","A_","N_","si","n9","Rs","So","U7"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateFollowedColumn=n.createColumn({key:new i.Facet("dateFollowedColumn").id,name:r.default.SavedDate,fieldName:"",minWidth:n.ColumnWidth.regularMin,maxWidth:n.ColumnWidth.regularMax,isCollapsable:!0},s.DateField)(function(e,t){var n=e.demandItemFacet(o.dateFollowedFacet,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(u.localeFacet,u.configurationItemKey),s=i&&i.language||window.navigator.language;return s?{text:a.getRelativeDateTimeStringPast(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(o.dateFollowedFacet,t)})});
define("JK",["require","exports","lC","r","XK","zc","ih","O1","s_","YK"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetDetailsListControlHandler=o.createControlHandler()(function(){return function(e){return c}});var l=function(e){var t=e.defaultRender,i=n.__assign({},a.itemLifeCycleSignalsControl.pack(f.itemLifeCycleSignalsControlHandler));return t?r.createElement(u.ControlHandlerProvider,{controlHandlers:i},r.createElement(t,n.__assign({},e))):null};function c(){return{groupHeaderRenderer:i.GroupItemDetailsHeader,rowRenderer:l,groupProps:{collapseAllVisibility:s.CollapseAllVisibility.hidden}}}});
define("XK",["require","exports","lC","r","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";i=i.GroupItemDetailsHeader_0;Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?r.createElement("div",{className:i.root},this.props.group.name):null};return t})(r.PureComponent);t.GroupItemDetailsHeader=s});
define("YK",["require","exports","lC","db","i_"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemLifeCycleSignalsControlHandler=function(e,t){var s=t.signals;if(s){var o=r.findMatch(s,function(e){return e.key===i.followedSignalKey});if(o&&o.index>-1){var u=o.index;return{signals:n.__spreadArrays(s.slice(0,u),s.slice(u+1))}}}return{}}});
define("QK",["require","exports","lC","r","O1","YK","s_","ih","bI","Rs","So","U7","n9"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetTilesListControlHandler=u.createControlHandler()(function(){return function(e){return v}});function p(e,t){var n=t.itemKey,i=e.demandItemFacet(f.dateFollowedFacet,n,{suppressGetItems:!0}),s=i&&new Date(i).getTime();if("number"==typeof s&&!isNaN(s)){var o=e.demandItemFacet(l.localeFacet,l.configurationItemKey),u=o&&o.language||window.navigator.language,a=c.getRelativeDateTimeStringPast(new Date(s),u);return{itemActivity:a&&r.createElement(h.DateField,{text:a})||null}}return{}}var d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,u=n.__rest(e,["defaultRender"]),f=n.__assign(n.__assign({},o.itemLifeCycleSignalsControl.pack(s.itemLifeCycleSignalsControlHandler)),a.itemTileControl.pack(p));return t?r.createElement(i.ControlHandlerProvider,{controlHandlers:f},r.createElement(t,n.__assign({},u))):null};return t})(r.PureComponent);function v(){return{tileRenderer:d}}});
define("WK",["require","exports","ih","qK"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.emptyFolderControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:r.default.savedForLaterEmptyStateTitle}}}})});
define("nQ",["require","exports","Hm","Sg","d0","ih","WQ","yQ","CD","uQ","lh","Qp","lQ","U1","qp","dQ","cQ","sQ","Hq","oQ","rQ","$f","eQ","Ao","aQ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDeferred=n.createAddon(function(){return function(e){e(E.asBatch(function(){e(u.graphAddonDataOnlyDeferred);e(s.registerControlHandler(a.sharedWithMeRootItemKeyFacet,r.itemsCommandBarControl)(f.sharedWithMeCommandBarControlHandler));e(s.registerControlHandler(a.sharedWithMeRootItemKeyFacet,i.itemsContextMenuControl)(o.sharedWithMeContextMenuControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,c.sortedItemSetControl)(h.sharedWithMeSortedItemSetControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,p.openActionControl)(v.sharedWithMeItemSetOpenActionControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,d.groupedItemSetControl)(m.sharedWithMeGroupedItemSetControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,d.unGroupedItemSetControl)(g.sharedWithMeUngroupedItemSetControlHandler));e(s.registerControlHandler(y.groupBySharedByKeyFacet,p.openActionControl)(b.groupBySharedByOpenActionControlHandler));e(s.registerControlHandler(y.groupByRelativeTimeKeyFacet,p.openActionControl)(w.groupByRelativeTimeOpenActionControlHandler));e(n.registerOperationHandler(S.topCollaboratorSetKeyFacet,x.getItemsOperation)(T.peopleGetItemsOperationHandler))}))}})});
define("WQ",["require","exports","ih","og","Jb","vQ","fQ","pQ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return f}});var a=[r.openCommand,i.shareCommand,i.copyLinkCommand,s.addShortcutFromSharedWithMeCommand,o.removeShortcutFromSharedWithMeCommand,u.removeFromSharedListCommand];function f(e,t){return{commands:a}}});
define("vQ",["require","exports","si","r","TS","FS"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addShortcutFromSharedWithMeCommand={action:r.createElement(s.AddToOneDriveAction,null),automationId:"addShortcutFromSharedWithMeCommand",title:i.default.AddShortcutFromSharedWithMeTooltip,iconProps:{iconName:"FabricFolderLink"},key:new n.Facet("AddShortcutFromSharedWithMe").id,name:i.default.AddShortcutFromSharedWithMe}});
define("fQ",["require","exports","pb","si","r","TS","PS"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeShortcutFromSharedWithMeCommand={action:i.createElement(n.ShowOnlyWithSelection,null,i.createElement(o.RemoveFromOneDriveAction,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:s.default.RemoveShortcutFromSWMTooltip,iconProps:{iconName:"FabricFolderLink"},key:new r.Facet("RemoveShortcutFromSWM").id,name:s.default.RemoveShortcutFromSWM}});
define("pQ",["require","exports","r","si","pb","mQ","TS"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedListCommand={key:new r.Facet("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:o.default.removeFromSharedList,title:o.default.removeFromSharedListTooltip,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.RemoveFromSharedListAction,null)),iconProps:{iconName:"Cancel"}}});
define("mQ",["require","exports","lC","r","b","Ec","TE","jm","kP","Rs","gQ","bQ","hQ","_Q","C1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,u=t.resolve,a=t.reject,f=t.onItemRemoved,l=t.itemKeys,p=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:u();return[4,f()];case 1:e.sent();return[2]}})})},d=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){a(new i.CancelError);return[2]})})};return r.createElement(s.WithItemCache,null,function(e){var t=e.itemCache,n=m(t,l),i=n.title,s=n.prompt;return r.createElement(o.ConfirmationDialog,{onCancel:d,onConfirm:p,yesText:h.default.removeFromSharedListConfirmButtonText,noText:c.default.removeFromSharedListCancelButtonText,defaultToYes:!0,title:i,prompt:s})})};return t})(r.PureComponent),m=function(e,t){if(t.length>1)return{title:c.default.itemsTitleWithAccess,prompt:c.default.itemsSubTextWithAccess};if(1===t.length){var n=e.demandItemFacet(f.folderFacet,t[0]);return{title:n?c.default.folderTitleWithAccess:c.default.fileTitleWithAccess,prompt:n?c.default.folderSubTextWithAccess:c.default.fileSubTextWithAccess}}return{title:"",prompt:""}},g=u.implementOperationWithProgress({operationTypeFacet:a.removeItemsFromSharedListOperation,progressKeyFacet:a.removeFromSharedListProgressKeyFacet,initializeBatch:function(){return p.removeFromSharedListProgressAddon}});t.RemoveFromSharedListAction=d.connectToItemCache(function(){return{removeFromSharedListWizard:v,removeItemsFromSharedList:g}})(l.RemoveFromSharedListBaseAction)});
define("gQ",["require","exports","lC","r","C1","Ro","jr","Ps","ks","_s","nL","kP","Es"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRemoveFromSharedAction=i.createItemCacheComponent(function(e,t){var i=t.itemKeys,f=t.removeFromSharedListWizard,p=t.removeItemsFromSharedList,d=void 0===p?c.removeItemsFromSharedList:p,v=s.getCurrentItemSetKey(e)||"";if(0===i.length)return null;for(var m=i.length<=200,g=f,y=0,b=i;y<b.length;y++){var w=b[y],E=e.demandItemFacet(l.removeFromSharedActionListControl,w);l.removeFromSharedActionListControl.evaluate(E)(e,{itemKey:w,isAvailable:!1}).isAvailable||(m=!1)}var S=e.dispatch,x=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e={itemSetKey:v};t=o.makeObject(i,function(){return e});return[4,S(d({items:t}))];case 1:n.sent();return[2]}})})},T=u.renderComponentOnExecute(function(e){return r.createElement(g,n.__assign({},e,{onItemRemoved:x,itemKeys:i}))});return r.createElement(a.Action,n.__assign({isAvailable:m,onExecute:T},h.getItemActionEngagement(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:i.length}}})))});t.RemoveFromSharedListBaseAction=f.withSelectedItems()(t.ItemRemoveFromSharedAction)});
define("_Q",["require","exports","lC","me","Gm","Fm","jm","hQ","Hm","ih","kP"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[i.ProgressPhase.started]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeStartedItemsTitle,u.default.removeCompletedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.completed]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeCompletedItemsTitle,u.default.removeCompletedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.failed]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeFailedItemsTitle,u.default.removeFailedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.canceled]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeFailedItemsTitle,u.default.removeFailedItemsTitleIntervals,e)||"",e)},c);t.removeFromSharedListProgressAddon=a.createAddon(function(){return function(e){e(f.registerControlHandler(l.removeFromSharedListProgressKeyFacet,s.progressControl)(f.createControlHandler()(p)))}});function p(){return function(e){return d}}function d(e,t){var r,i=o.getOverallSimpleProgressBreakdown(e,t),s=i.phase,u=i.count;r=h[s](u);return n.__assign({},r&&"item"!==t.format?{title:r}:{})}});
define("yQ",["require","exports","lC","Hm","ih","ph","XS","kb","Nb","YS","yg","Rb","Lb","m1","f1","Lm","KQ","GQ","zQ","FQ","UQ","TQ","PQ","MQ","LQ","AQ","EQ","wQ","KP","BP","Z7","OQ","Mm","s5","CQ","HW","mq","H8","xQ","VD","IQ","WS","DQ","Io","ri","J1","t4","X7","Ao","xq","$f","H6","SQ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var Z=V.asModuleWithRetries(function(){return new Promise(function(t,n){e(["./handlers/operations/driveItem/deleteItemsBatchedOperationHandler"],t,n)})},{chunkName:"addon-graph-deferredoperations"});t.graphAddonDataOnlyDeferred=r.createAddon(function(){return function(e){var t=e(z.readConfiguration({useBatchedDeleteConfiguration:W.useBatchedDeleteConfigurationFacet})).useBatchedDeleteConfiguration;e(Q.asBatch(function(){e(i.registerControlHandler(H.driveItemSetKeyFacet,D.itemsViewSearchControl)(P.driveItemSearchControlHandler));e(i.registerControlHandler(B.searchItemSetKeyFacet,D.itemsViewSearchControl)(P.searchItemSearchControlHandler));e(i.registerControlHandler(H.driveItemSetKeyFacet,j.filteredItemSetControl)(F.driveItemSetFilteredItemSetControlHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,o.createFolderOperation)(m.driveItemCreateFolderOperationHandler));e(t?r.registerOperationHandler(s.driveItemKeyFacet,u.deleteItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(X.waitForPageLoad())];case 1:t.sent();return[4,Z()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):r.registerOperationHandler(s.driveItemKeyFacet,u.deleteItemsOperation)(g.driveItemDeleteItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,a.renameItemOperation)(y.driveItemRenameItemOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,f.uploadItemsOperation)(b.driveItemUploadItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,I.moveCopyItemsOperation)(q.driveItemMoveCopyItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,G.addToOneDriveOperation)(Y.addToOneDriveOperationHandler));e(i.registerControlHandler(s.driveItemKeyFacet,l.createFolderActionControl)(w.driveItemCreateFolderActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,R.createFolderDialogControl)(U.driveItemCreateFolderDialogControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,c.renameActionControl)(E.driveItemRenameItemActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,h.deleteActionControler)(S.driveItemDeleteItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,p.uploadItemsActionControl)(x.driveItemUploadItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,L.shareLinkActionControl)(N.driveItemDefaultShareLinkControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,A.permissionInviteActionControl)(k.driveItemPermissionGrantControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,d.downloadItemsActionControlFacet)(T.driveItemDownloadItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,v.followItemActionControl)(C.driveItemfollowItemActionControlHandler));e(r.registerOperationHandler(O.driveFollowedItemKeyFacet,_.followItemOperation)(M.driveItemFollowItemOperationHandler));e(r.registerOperationHandler($.driveActivityItemKeyFacet,J.getItemsOperation)(K.driveActivityItemGetItemsOperationHandler))}))}})});
define("KQ",["require","exports","lC","ph","Hm","GA","Gm","Xo","$W","Vm"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.folders,l=r.driveItemKeyFacet.deserialize(t),c=l.endpoint,h=l.driveId,p=l.itemId,d=Object.keys(i)[0],v=i[d].progressItemKey,m=s.getDriveUrl(l);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,g,y,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:i=s.getDriveItemUrl(l)+"/children";g={name:d,folder:{},"@microsoft.graph.conflictBehavior":"rename"};h&&p&&(g.parentReference={driveId:h,id:p});return[4,e(s.getRawData({url:i,driveUrl:m,method:"POST",body:g,qosName:"createFolder",endpoint:c}))];case 1:y=T.sent();b=r.driveItemKeyFacet.serialize({endpoint:c,driveId:h,itemId:y.id});w=new f.ItemResolver;v&&w.resolveItems({items:(E={},E[v]=n.__assign({},o.createdItemFacet.pack({itemKey:b})),E)});w.invalidateItems({items:(S={},S[t]=[u.defaultChildItemSetFacet],S)});w.resolveItems({items:(x={},x[b]=n.__assign({},a.getDriveItemFacets({driveItem:y,parentFolderItemKey:t,endpoint:c})),x)});e(w.execute());return[2]}})})}})});
define("GQ",["require","exports","lC","ph","Hm","GA","zm","Rs"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=r.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,a;return n.__generator(this,function(n){switch(n.label){case 0:r=s.getDriveItemUrl(i);return[4,e(s.getRawData({url:r,method:"DELETE",qosName:"deleteItem",endpoint:i.endpoint}))];case 1:n.sent();e(o.invalidateItems({items:(a={},a[t]=[u.deletedFacet],a)}));return[2]}})})}})});
define("zQ",["require","exports","lC","ko","ph","Hm","GA","Rs","S0","$W","xo","Vm","JA"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemOperationHandler=s.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,s=e.options.names,p=i.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:i=Object.keys(s)[0];d=s[i],v=d.newName,m=d.newExtension;g=o.getDriveItemUrl(p);y=o.getDriveUrl(p);b=e(l.readItem({fileName:u.fileNameFacet},t)).fileName;w="string"==typeof m?m:b&&b.extension||"";return[4,e(o.getRawData({url:g,driveUrl:y,method:"PATCH",body:{name:""+v+w},qosName:"renameItem",endpoint:p.endpoint})).then(function(r){var i,s,o=new c.ItemResolver;o.invalidateItems({items:(i={},i[t]=[u.displayNameFacet],i)});o.resolveItems({items:(s={},s[t]=n.__assign(n.__assign({},u.displayNameFacet.pack(r.name)),u.fileNameFacet.pack(f.getFileName(r.name||"",!!r.folder))),s)});e(o.execute())}).catch(function(e){if(e instanceof h.GraphError&&e.status===r.STATUS_CODE_ZERO)throw new r.ItemOperationError({facets:n.__assign({},a.offlineErrorFacet.pack({})),innerError:e});throw e})];case 1:E.sent();return[2]}})})}})});
define("FQ",["require","exports","lC","Hm","HQ"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemUploadItemsOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,r(i.uploadDriveItem(e))];case 1:t=n.sent().itemResolver;r(t.execute());return[2]}})})}})});
define("HQ",["require","exports","lC","VQ","jQ","BQ","NQ","RQ","GA","qA","JA","$W","Zn","oo","ph","YS","xo","rs","LO","$1","Gm","si","Xo","Fe","To","Vm","S0"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=p.asOnceOnly(function(){return new s.UploadWaiter({},{})}),L=p.asOnceOnly(function(e){var t=e(a.getDataRequestor).dataRequestor,s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t,{performanceNow:u.performanceNow})||this}return t})(u.ActivityBandwidthVerifier),f=new i.UploadService({},{dataRequestor:t}),l=new o.UploadStateMachine({},{activityBandwidthVerifierType:s,uploadService:f});return new r.Uploader({},{uploadService:f,uploadStateMachine:l})}),A=0;t.uploadDriveItem=function(e){var t=this,r=e.itemKey,i=e.options.sourceEntries,s=d.driveItemKeyFacet.deserialize(r),o=s.endpoint,u=s.driveId,f=Object.keys(i)[0],l=i[f],h=l.progressItemKey,p=l.conflictResolution,v=void 0===p?"fail":p;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,p,g,x,T,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:if(!(t=e(m.readItem({sourceFile:y.sourceFileFacet},f)).sourceFile))throw new Error("No source file for Graph upload.");i=a.getDriveItemUrl(s)+":";l=a.getDriveUrl(s);h&&e(b.resolveItems({items:(T={},T[h]=n.__assign({},w.progressSizeFacet.pack({total:t.size,current:0})),T)}));return[4,e(O({progressItemKey:h,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:v,endpoint:o}))];case 1:p=A.sent();g=d.driveItemKeyFacet.serialize({endpoint:o,driveId:u,itemId:p.id});x=new N.ItemResolver;h&&x.resolveItems({items:(C={},C[h]=n.__assign(n.__assign({},w.createdItemFacet.pack({itemKey:g})),E.pack({progressSize:w.progressSizeFacet},{progressSize:{current:t.size}})),C)});x.invalidateItems({items:(k={},k[r]=[S.defaultChildItemSetFacet],k)});x.resolveItems({items:(L={},L[g]=n.__assign({},c.getDriveItemFacets({driveItem:p,parentFolderItemKey:r,endpoint:o})),L)});return[2,{itemResolver:x,driveItem:p,itemKey:g}]}})})}};function O(e){var t=this,r=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=(function(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}})(e.conflictResolution);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,p,d,m,y,S,N,O,M;return n.__generator(this,function(_){switch(_.label){case 0:t=e(L);c=e(k);return[4,e(f.getSessionToken(u,o))];case 1:p=_.sent();d=new h.Async;m=0;y=d.debounce(function(t){var n;if(t>m){r&&e(b.resolveItems({items:(n={},n[r]=E.pack({progressSize:w.progressSizeFacet},{progressSize:{current:t}}),n)}));m=t}},300,{leading:!1});S=e(g.readItems(function(e){return e.demandItemFacet(w.cancelSourceFacet,r)}));N=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++A},accessToken:p,fileName:i.name,content:i,itemUrl:s,onProgress:y,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return c.wait(e)},select:"*,sharepointIds"});O=S?S.token.subscribe(function(){N.cancel()}):void 0;_.label=2;case 2:_.trys.push([2,4,5,6]);return[4,N];case 3:return[2,_.sent()];case 4:M=_.sent();if(x.default.isCanceled(M))throw new T.CancelError;throw new v.UploadItemOperationError({facets:n.__assign({},l.getErrorResolution(M,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return C.accessDeniedErrorFacet.pack({});case"nameAlreadyExists":case 409:return C.conflictErrorFacet.pack({supportsRename:!0})}})||E.pack({},{})),innerError:M});case 5:O&&O();d.dispose();return[7];case 6:return[2]}})})}}});
define("VQ",["require","exports","lC","Fe","JA","E"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){var n=t.uploadService,r=t.uploadStateMachine,i=t.useStreamingUpload,s=void 0!==i&&i;this._uploadService=n;this._uploadStateMachine=r;this._useStreamingUpload=s}e.prototype.upload=function(e){var t=e.conflictBehavior,o=n.__rest(e,["conflictBehavior"]),u=o.qosData,a=new s.Qos({name:"VroomUploader.upload",extraData:u});return this._uploadState(o,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then(function(e){a.end({resultType:s.ResultTypeEnum.Success});return e},function(e){a.end({resultType:r.default.isCanceled(e)?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:e.message,resultCode:i.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},u),i.getQosExtraDataFromError(e))});return r.default.reject(e)})};e.prototype._uploadState=function(e,t){var n=this,i=t.sessionUrl,s=t.item,o=t.error;if(s)return r.default.resolve(s);if(o){var u=void 0;i&&(u=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:i}).then(function(){},function(){}));return r.default.resolve(u).then(function(){return r.default.reject(o)})}return this._uploadStateMachine.advanceState(e,t).then(function(t){return n._uploadState(e,t)})};return e})();t.Uploader=o;t.default=o});
define("jQ",["require","exports","lC","th"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.createSession=function(e){var t=e.qosData,r=e.itemUrl,i=e.headers,o=e.allowCookies,u=e.accessToken,a=e.fileName,f=e.fileSize,l=e.lastModifiedDate,c=e.eTag,h=e.conflictBehavior,p=e.ignoreCookieAuth,d={item:n.__assign(n.__assign({},s(r)?{"@microsoft.graph.conflictBehavior":h}:{"@name.conflictBehavior":h}),l?{fileSystemInfo:{lastModifiedDateTime:l.toISOString()}}:{})},v=n.__assign(n.__assign(n.__assign(n.__assign({},c?{"If-Match":c}:{}),p?{IgnoreCookieAuthentication:"t"}:{}),{Prefer:"synchronousmetadata"}),i);return this._dataRequestor.send({path:r+"/"+encodeURIComponent(a)+":/"+(s(r)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:v,allowCookies:o,accessToken:u,useAuthorizationHeaders:!0,postData:JSON.stringify(d),qosExtraData:n.__assign({conflictBehavior:h,fileSize:f},t)})};e.prototype.cancelSession=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.uploadFragment=function(e){var t=e.qosData,i=e.headers,s=e.sessionUrl,o=e.startByte,u=e.endByte,a=e.fileSize,f=e.content,l=e.timeout,c=e.onProgress,h=e.select,p=n.__assign({"Content-Range":"bytes "+o+"-"+Math.max(u-1,o)+"/"+a},i),d=!0,v=this._dataRequestor.send({path:s+(h?(s.indexOf("?")>-1?"&":"?")+"$select="+h:""),needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:p,postData:f,timeout:l,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&d&&c(o+e.loaded)},qosExtraData:n.__assign(n.__assign({},t),{startByte:o,endByte:u,fileSize:a})}),m=new r.default(function(){d=!1;v.cancel()});v.done(function(e){d=!1;m.complete(e)},function(e){d=!1;m.error(e)});return m.getPromise()};e.prototype.commit=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,o=e.fileName,u=(e.description,e.eTag),a=e.conflictBehavior,f=e.sessionUrl,l={"If-Match":u},c=s(r)?{"@microsoft.graph.conflictBehavior":a,"@microsoft.graph.sourceUrl":f}:{"@name.conflictBehavior":a,"@content.sourceUrl":f};return this._dataRequestor.send({path:r+"/"+encodeURIComponent(o),requestType:"PUT",apiName:"CommitSession",headers:l,accessToken:i,useAuthorizationHeaders:!0,postData:JSON.stringify(c),qosExtraData:n.__assign({conflictBehavior:a},t)})};e.prototype.getStatus=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.getItem=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,s=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:r+"/"+encodeURIComponent(s),useAuthorizationHeaders:!0,accessToken:i,qosExtraData:n.__assign({},t)})};return e})();t.UploadService=i;function s(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}});
define("BQ",["require","exports","Oh","pv","eh","Fe","th"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){var s=t.asyncType,o=void 0===s?n.default:s,u=t.eventGroupType,a=void 0===u?r.default:u,f=t.targetWindow,l=void 0===f?window:f,c=this._scope=new i.default;this._async=c.attach(new o(this));this._events=c.attach(new a(this));this._targetWindow=l}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.wait=function(e){var t,n=e.duration,r=e.allowWakeWhenOnline,i=void 0!==r&&r,u=this._async,a=this._events,f=this._targetWindow,l=new o.default(function(){u.clearTimeout(t)}),c=function(){i&&l.complete()};t=u.setTimeout(function(){l.complete()},n);a.on(f,"online",c);return l.getPromise().then(function(){a.off(f,"online",c)},function(e){a.off(f,"online",c);return s.default.reject(e)})};return e})();t.UploadWaiter=u});
define("NQ",["require","exports","lC","JA","E","Fe","th"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=Math.pow(2,1/4),a=(function(){function e(e,t){this._uploadService=t.uploadService;this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var n=t.useCommitForUpload,r=void 0!==n&&n,i=t.checkForCompletedUploadOnSessionTermination,s=void 0===i||i,o=t.shouldCancelOnCompleteFailure,u=void 0===o||o,a=t.maximumFragmentSize,f=void 0===a?62914560:a;this._shouldCancelOnCompleteFailure=u;this._useCommitForUpload=r;this._checkForCompletedUploadOnSessionTermination=s;this._maximumFragmentSize=f}e.prototype.advanceState=function(e,t){var n=this,r=t.sessionUrl,i=t.nextExpectedRanges;return(r?i?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then(function(t){return t.error?n._handleGeneralErrorState(e,t):n._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})})};e.prototype._createSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.createSession",extraData:o});return this._uploadService.createSession({qosData:o,itemUrl:e.itemUrl,headers:e.headers,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior,ignoreCookieAuth:e.ignoreCookieAuth}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})},function(a){return s._handleCreateSessionErrorState(e,s._getState(t,{error:a})).then(function(e){e.error?u.end({resultType:i.ResultTypeEnum.Failure,error:a.message,resultCode:r.getResultCodeFromError(a),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(a))}):u.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return e})})};e.prototype._handleCreateSessionErrorState=function(e,t){var n=this;return this._handleErrorState(t,function(r,i){switch(r){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(i,e,t)}})};e.prototype._getStatusState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getStatus",extraData:o});return this._uploadService.getStatus({qosData:o,sessionUrl:t.sessionUrl}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._uploadItemState=function(e,t){var s=this,o=e.qosData,u=e.content.size,a=this._getNextRange({fileSize:u,nextExpectedRanges:t.nextExpectedRanges}),f=new i.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(a&&a.start<u?t.allowStreaming?this._uploadStreamState({nextRange:a},e,t):this._uploadFragmentState({nextRange:a},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then(function(t){if(t.error)return s._handleUploadItemErrorState(e,t).then(function(e){var t=e.error;t?f.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(t),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(t))}):f.end({resultType:i.ResultTypeEnum.Success});return e});f.end({resultType:i.ResultTypeEnum.Success});return t})};e.prototype._terminateUploadOnCompleteFailure=function(e){return s.default.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))};e.prototype._uploadFragmentState=function(e,t,s){var a=this,f=e.nextRange,l=t.onProgress,c=t.headers,h=t.content,p=t.content.size,d=t.qosData,v=t.select,m=s.sessionUrl,g=s.speed,y=void 0===g?1/8:g,b=f.start,w=f.end;l&&l(b);var E,S,x=this._getFragmentSize(y),T=Math.min(b+x,w),N=new o.default(function(){E&&E.cancel()}),C=y>1/1920?6e4:3e5,k=new this._activityBandwidthVerifierType({timeout:C,totalBytes:T-b}),L=new i.Qos({name:"VroomUploader.uploadFragment",extraData:n.__assign(n.__assign({},d),{startByte:b,endByte:T,fileSize:p,speed:y,fragmentSize:x})});(E=this._uploadService.uploadFragment({qosData:d,headers:c,sessionUrl:m,startByte:b,endByte:T,fileSize:p,content:h.slice(b,T),timeout:C,select:v,onProgress:function(e){S=e;if(y>1/1920&&!k.doesActivityHaveRemainingCapacity(e-b)){L.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:n.__assign(n.__assign({},d),{lastByte:e})});N.complete(a._getState(s,{speed:Math.max(.5*y,1/1920),nextExpectedRanges:void 0}));E&&E.cancel()}l&&l(e)}}).then(function(e){l&&l(T);L.end({resultType:i.ResultTypeEnum.Success});return s=a._isItem(e)?a._getState(s,{item:e}):a._getState(s,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(k.didActivityHaveExtraCapacity()?y*u:y,1)})},function(e){L.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign(n.__assign({},d),r.getQosExtraDataFromError(e)),{lastByte:S})});return a._getState(s,{error:e})})).done(function(e){N.complete(e)});return N.getPromise()};e.prototype._uploadStreamState=function(e,t,s){var u=this,a=e.nextRange,f=t.headers,l=t.onProgress,c=t.content,h=t.content.size,p=t.qosData,d=s.sessionUrl,v=a.start,m=a.end,g=Math.min(m-v,this._maximumFragmentSize),y=v+g;l&&l(v);var b,w=new o.default(function(){b&&b.cancel()}),E=new i.Qos({name:"VroomUploader.uploadStream",extraData:n.__assign(n.__assign({},p),{startByte:v,endByte:y,fileSize:h,fragmentSize:g})});(b=this._uploadService.uploadFragment({qosData:p,headers:f,sessionUrl:d,startByte:v,endByte:y,fileSize:h,content:c.slice(v,y),timeout:864e5,onProgress:function(e){l&&l(e)}}).then(function(e){l&&l(y);E.end({resultType:i.ResultTypeEnum.Success});return s=u._isItem(e)?u._getState(s,{item:e}):u._getState(s,{nextExpectedRanges:e.nextExpectedRanges})},function(e){E.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign(n.__assign({},p),r.getQosExtraDataFromError(e)),{lastByte:void 0})});return u._handleUploadStreamErrorState({nextRange:a},t,u._getState(s,{error:e}))})).done(function(e){w.complete(e)});return w.getPromise()};e.prototype._handleUploadStreamErrorState=function(e,t,n){var r=this,i=e.nextRange;return this._handleErrorState(n,function(e){switch(e){case 0:return r._wait({duration:1e3},t).then(function(){return r._getStatusState(t,n).then(function(e){return r._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>i.start?e:r._getState(n,{allowStreaming:!1})})})}})};e.prototype._commitState=function(e,t){var s=this,o=e.qosData,u=e.onProgress;u&&u(e.content.size);var a=new i.Qos({name:"VroomUploader.commit",extraData:o});return this._uploadService.commit({qosData:o,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then(function(e){a.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{item:e})},function(e){return s._handleCommitErrorState(s._getState(t,{error:e})).then(function(t){a.end({resultType:t.error?i.ResultTypeEnum.Failure:i.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return t})})};e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,function(n){switch(n){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return s.default.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}})};e.prototype._cancelSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.cancelSession",extraData:o});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then(function(){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{sessionUrl:void 0})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{sessionUrl:void 0})})};e.prototype._handleUploadItemErrorState=function(e,t){var n=this,r=t.speed,i=void 0===r?1:r;t=this._getState(t,{nextExpectedRanges:void 0});return this._handleErrorState(t,function(r,o){switch(r){case 0:return window.navigator.onLine?t.allowStreaming?s.default.resolve(n._getState(t,{allowStreaming:!1})):s.default.resolve(n._getState(t,{speed:Math.max(i*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return s.default.resolve(n._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(o,e,t);case"invalidRange":case 416:return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0})})}})};e.prototype._getItemIfCompletedState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getItemIfCompleted",extraData:o});return this._uploadService.getItem({qosData:o,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then(function(n){u.end({resultType:i.ResultTypeEnum.Success});return e.lastModifiedDate&&n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&n.size===e.content.size&&"rename"!==t.conflictBehavior?s._getState(t,{item:n,error:void 0}):s._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._handleGeneralErrorState=function(e,t){var n=this,r=t.waitDuration,i=void 0===r?500:r,s=t.attemptsRemaining,o=void 0===s?10:s;return this._handleErrorState(t,function(r){switch(r){case"uploadSessionNotFound":return n._checkForCompletedUploadOnSessionTermination?n._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof r){if(r>=400&&r<500)return;if(0===r||r>=500&&r<600)return n._wait({duration:i,allowWakeWhenOnline:!0},e).then(function(){return n._getState(t,{error:void 0,waitDuration:Math.min(2*i,3e4),attemptsRemaining:void 0})});if(!o)return;return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(o-1,0)})})}})};e.prototype._handleErrorState=function(e,t){var n=e.error,i=r.getErrorResolution(n,t);void 0===i&&(i=s.default.resolve(e));return i};e.prototype._promptForConflictBehaviorState=function(e,t,o){var u=this,a=t.onPromptForConfictBehavior,f=t.qosData,l=new i.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:f});return s.default.resolve().then(function(){return a(e)}).then(function(e){l.end({resultType:i.ResultTypeEnum.Success,extraData:f});return u._getState(o,{error:void 0,conflictBehavior:e})},function(t){l.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},f),r.getQosExtraDataFromError(t))});return u._getState(o,{error:t})})};e.prototype._wait=function(e,t){var n=e.duration,o=e.allowWakeWhenOnline,u=t.onWait,a=t.qosData,f=new i.Qos({name:"VroomUploader.wait",extraData:a});return s.default.resolve(u({duration:n,allowWakeWhenOnline:o})).then(function(){f.end({resultType:i.ResultTypeEnum.Success})},function(e){f.end({resultType:s.default.isCanceled(e)?i.ResultTypeEnum.Success:i.ResultTypeEnum.Failure,error:e&&e.message,resultCode:r.getResultCodeFromError(e)});return s.default.reject(e)})};e.prototype._getState=function(e,t){return n.__assign(n.__assign({},e),t)};e.prototype._getNextRange=function(e){var t=e.fileSize,n=e.nextExpectedRanges;return(void 0===n?[]:n).reduce(function(e,n){var r,i=n.split("-",2),s=i[0],o=i[1],u=parseInt(s,10);if(!e||u<e.start&&u<t){r={start:u,end:""===o?t:Math.min(parseInt(o,10)+1,t)}}else r=e;return r},void 0)};e.prototype._isItem=function(e){return!!e.id};e.prototype._getFragmentSize=function(e){var t,n=62914560*e;t=n>327680?n-n%327680:n-n%32768;return Math.min(Math.max(t,32768),this._maximumFragmentSize)};return e})();t.UploadStateMachine=a});
define("RQ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.performanceNow=window.performance?function(){return window.performance.now()}:function(){return Date.now()};var n=(function(){function e(e,t){this._performanceNow=t.performanceNow;this._startTime=this._performanceNow();this._expirationTime=this._startTime+e.timeout;this._totalBytes=e.totalBytes;this._progressPoints=0}e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1};e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5};e.prototype._getRateRatio=function(e){this._progressPoints++;var t,n=this._performanceNow(),r=n-this._startTime,i=this._expirationTime-n,s=this._totalBytes-e;(this._progressPoints>=4&&r>=4e3||this._progressPoints>0&&0===s)&&i>0&&(t=s/i/(e/r));return t};return e})();t.ActivityBandwidthVerifier=n});
define("UQ",["require","exports","ih","kQ"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canCreateFolderFacet,n)}}}})});
define("kQ",["require","exports","lC","UB","uq","cq","ph","do","oi"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.canAddToOneDriveFacet=new u.ComputedItemFacet("addToOneDrive",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.addToOneDriveFacet}))});t.canCreateFolderFacet=new u.ComputedItemFacet("canCreateFolder",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.createFolderFacet}))});t.canCreateLinkFacet=new u.ComputedItemFacet("canCreateLink",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.createLinkFacet}))});t.canDeleteFacet=new u.ComputedItemFacet("canDelete",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.deleteFacet}))});t.canDownloadFacet=new u.ComputedItemFacet("canDownload",function(e,t){return!e.demandItemFacet(a.oneNoteFacet,t.itemKey)&&f(e,n.__assign(n.__assign({},t),{commandFacet:i.downloadFacet}))});t.canInviteFacet=new u.ComputedItemFacet("canInvite",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.inviteFacet}))});t.canMoveFacet=new u.ComputedItemFacet("canMove",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.moveFacet}))});t.canUseOfficeLensFacet=new u.ComputedItemFacet("canUseOfficeLens",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.officeLensFacet}))});t.canRenameFacet=new u.ComputedItemFacet("canRename",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.renameFacet}))});t.canUploadFacet=new u.ComputedItemFacet("canUpload",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.uploadFacet}))});function f(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(o.driveItemKeyFacet,n);if(!i)return!1;var u=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,s.commandsItemKeyFacet.serialize({endpoint:u,driveId:a}));return!!f&&!!f.roles&&l(e,{itemKey:n,oneOfRequiredRoles:f.roles})}t.hasPermission=f;function l(e,t){var n=t.itemKey;return c(e,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:p(e,n)})}t.hasRequiredItemRole=l;function c(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1}t.hasRequiredRole=c;function h(e,t){var n=e.demandItemFacet(r.sharedFacet,t);return!n||!n.effectiveRoles||!n.owner}t.isOwner=h;function p(e,t){if(h(e,t))return["read","write","owner"];var n=e.demandItemFacet(r.sharedFacet,t);return n&&n.effectiveRoles?n.effectiveRoles:[]}t.getEffectiveItemRoles=p});
define("TQ",["require","exports","ih","OP","kQ"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(i.canRenameFacet,n),validator:r.nameValidator}}}})});
define("PQ",["require","exports","ih","kQ"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canDeleteFacet,n)}}}})});
define("MQ",["require","exports","ih","kQ"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemUploadItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canUploadFacet,n)}}}})});
define("LQ",["require","exports","lC","ih","ph","GA","Rs","kQ","JA","ko","S0","JA"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDownloadItemsActionControlHandler=r.createControlHandler()(h);function h(){return function(e){return p}}t.getDownloadItemActionControlHandler=h;function p(e,t){if(1!==t.itemKeys.length)return{};var r=t.itemKeys[0];if(e.demandItemFacet(o.folderFacet,r))return{};var h=e.demandItemFacet(i.driveItemKeyFacet,r),p=h?s.getDriveItemUrl(h):void 0,d=h?s.getDriveUrl(h):void 0,v=h&&h.endpoint||"";return{isAvailable:e.demandItemFacet(u.canDownloadFacet,r),getDownloadData:p&&d?function(){return(function(e){var t=this,r=e.itemUrl,i=e.driveUrl,o=e.endpoint;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,u(s.getRawData({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:o}))];case 1:t=n.sent();if(!(h=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(r)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:h}];case 2:if((p=n.sent())instanceof a.GraphError){d=c.getErrorResolution(p,function(e,t){switch(e){case"unauthenticated":case 401:return l.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return l.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return l.accessDeniedErrorFacet.pack({});default:return l.offlineErrorFacet.pack({})}});throw new f.ItemOperationError({innerError:p,facets:d})}throw p;case 3:return[2]}})})}})({itemUrl:p,driveUrl:d,endpoint:v})}:void 0}}});
define("AQ",["require","exports","lC","ih","ph","GA"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDefaultShareLinkControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getDefaultShareLinkActionControlHandler=o;function u(e,t){var r=t.itemKey,o=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,u;return n.__generator(this,function(n){switch(n.label){case 0:if(!(t=e.driveItem))return[3,2];i=s.getDriveItemUrl(t)+"/invite";o=s.getDriveUrl(t);return[4,r(s.getRawDataWithCache({url:i,driveUrl:o,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(u=n.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:u.value[0].link.webUrl,scope:u.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:o})}}}});
define("EQ",["require","exports","ih"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemfollowItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(){return{}}}})});
define("wQ",["require","exports","lC","ih","ph","GA"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPermissionGrantControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getPermissionGrantActionControlHandler=o;function u(e,t){var r=t.itemKey,o=t.link,u=t.recipients,a=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,u,a,f,l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.link,o=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");u=t.endpoint;f=btoa(i);a="u!"+f.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");l=o.map(function(e){return{email:e}});c={recipients:l,roles:["read"]};h=u.replace("v1.0","beta");p=h+"/shares/"+a+"/permission/grant";return[4,r(s.getRawDataWithCache({url:p,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:c}))];case 1:d=n.sent();v=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:v}]}})})}})({driveItem:a,link:o,recipients:u})}}}});
define("OQ",["require","exports","lC","Hm","GA","Rs","Vm","Z7","ri","Io","$1","ph","Gm"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemFollowItemOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,p=r.isFollowed,d=r.progressItemKey,v=u.driveFollowedItemKeyFacet.deserialize(t),m=v.driveItemKey,g=m.itemId,y=void 0===g?"":g,b=i.getDriveUrl(m);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,g,w,E,S,x,T,N;return n.__generator(this,function(C){switch(C.label){case 0:t=e(f.readConfiguration({saveForLaterGraphEndpoint:a.savedForLaterGraphEndpointConfigurationFacet})).saveForLaterGraphEndpoint;r=new o.ItemResolver;g=u.driveFollowedItemKeyFacet.serialize(v);w=t||m.endpoint;d&&e(l.resolveItems({items:(x={},x[d]=n.__assign({},h.sourceItemFacet.pack({itemKey:c.driveItemKeyFacet.serialize(m)})),x)}));E=p?{url:w+"/drives/"+m.driveId+"/items/"+y+"/follow",method:"POST",qosName:"followItem"}:{url:w+"/drives/"+m.driveId+"/following/"+y,method:"DELETE",qosName:"unfollowItem"};C.label=1;case 1:C.trys.push([1,3,,4]);return[4,e(i.getRawData({url:E.url,driveUrl:b,method:E.method,qosName:E.qosName,endpoint:w}))];case 2:C.sent();r.invalidateItems({items:(T={},T[g]=[s.isFollowedFacet],T)});r.resolveItems({items:(N={},N[g]=n.__assign({},s.isFollowedFacet.pack(p||void 0)),N)});e(r.execute());return[3,4];case 3:S=C.sent();throw new Error(S.message);case 4:return[2]}})})}})});
define("CQ",["require","exports","lC","ih","HW","mq"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e,t){return s.searchItemSetKeyFacet.serialize(n.__assign({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}t.driveItemSearchControlHandler=r.createControlHandler()(u);t.searchItemSearchControlHandler=r.createControlHandler()(u);function u(){return function(e){return function(e,t){var n,r=t.itemKey,u=e.demandItemFacet(i.driveItemSetKeyFacet,r);if(u)n=function(e){return u?o(u,e):void 0};else{var a=e.demandItemFacet(s.searchItemSetKeyFacet,r);n=function(e){return a?o(a,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}});
define("xQ",["require","exports","lC","HW","mq","ih","U8","F8"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetFilteredItemSetControlHandler=s.createControlHandler()(function(){return function(e){return a}});function a(e,t){var s=t.handlers,a=t.itemKey,f=e.demandItemFacet(r.driveItemSetKeyFacet,a),l=e.demandItemFacet(i.searchItemSetKeyFacet,a);if(s&&(f||l)){for(var c=[],h=0,p=s;h<p.length;h++){var d=p[h];if(d.key===u.itemPhotoTypeFilterHandler.key)c.push("photo");else if(d.key===u.itemVideoTypeFilterHandler.key)c.push("video");else if(d.key===u.itemFolderTypeFilterHandler.key)c.push("folder");else if(d.key===u.itemOneNoteFilterHandler.key)c.push("onenote");else if(d.key===u.itemNonPhotoTypeFilterHandler.key)c.push("!photo");else if(d.key===u.itemNonVideoTypeFilterHandler.key)c.push("!video");else if(d.key===u.itemNonFolderTypeFilterHandler.key)c.push("!folder");else if(d.key===u.itemNonOneNoteFilterHandler.key)c.push("!onenote");else{var v=o.getExtensionFilterFromFilterHandler(d);v&&c.push(v)}}if(f)return{itemKey:r.driveItemSetKeyFacet.serialize(n.__assign(n.__assign({},f),{extFilters:c}))}}return{}}});
define("IQ",["require","exports","lC","Hm","ko","YD","VD","S0","Rs","Vm","ph","GA","rs","JA","Xo","UW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemMoveCopyItemsOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,m=Object.keys(r)[0];return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var g,y,b,w,E,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:if(!e(h.readItems(function(e){return e.demandItemFacet(l.driveItemKeyFacet,m)})))throw new Error("Source item does not have a driveItem key");g=r[m],y=g.isMove,b=g.conflictBehavior,w=g.progressItemKey;E=l.driveItemKeyFacet.deserialize(t);return[4,e(s.demandItems(function(e){return e.demandItemFacet(l.driveItemKeyFacet,m)}))];case 1:if(!(S=M.sent()))throw new Error("Unable to get metadata for destination item.");x=c.getDriveItemUrl(S);T=c.getDriveUrl(S);N=S.endpoint;M.label=2;case 2:M.trys.push([2,4,,5]);return[4,e(c.getRawData({url:x+(y?"":"/copy"),driveUrl:T,method:y?"PATCH":"POST",body:{parentReference:{id:E.itemId||v.ROOT_ITEM_ID,driveId:E.driveId||""},"@microsoft.graph.conflictBehavior":b},qosName:y?"moveItem":"copyItem",endpoint:N}))];case 3:C=M.sent();(k=new f.ItemResolver).invalidateItems({items:(A={},A[m]=y?[a.parentFolderItemFacet,a.deletedFacet]:[],A[t]=[d.defaultChildItemSetFacet],A)});w&&!y&&C.name&&k.resolveItems({items:(O={},O[w]=n.__assign({},a.displayNameFacet.pack(C.name)),O)});e(k.execute());return[3,5];case 4:if((L=M.sent())instanceof p.GraphError&&L.status===i.STATUS_CODE_ZERO)throw new o.MoveCopyItemOperationError({innerError:L,facets:n.__assign({},u.httpStatusErrorFacet.pack(L.status))});throw L;case 5:return[2]}})})}})});
define("DQ",["require","exports","ih","OP"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderDialogControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){return{validator:r.nameValidator}}}})});
define("SQ",["require","exports","lC","ko","rs","Rs","Hm","ph","bH","JA","lh","hH"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveOperationHandler=o.createSingleItemOperationHandler()(function(e){var t=e.itemKey,o=e.options.itemSetKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g;return n.__generator(this,function(n){switch(n.label){case 0:if(!l.sharedWithMeItemSetKeyFacet.matches(o))throw new r.ItemOperationError({code:"invalidItemSetForAddToOneDrive"});h=l.sharedWithMeItemSetKeyFacet.deserialize(o).driveItemKey.endpoint;p=e(i.readItems(function(e){return e.demandItemFacet(s.fileNameFacet,t)}));d=e(i.readItems(function(e){return e.demandItemFacet(a.sharepointIdsFacet,t)}));v=e(i.readItems(function(e){return e.demandItemFacet(u.driveItemKeyFacet,t)}));if(!(h&&p&&v&&d))throw new r.ItemOperationError({code:"missingItemInfoForAddToOneDrive"});return[4,e(c.getDriveResponse("GetDriveInfo",h))];case 1:m=n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,e(c.getAddToOneDriveResponse(p.name,m.id,d,"AddToOneDrive_SWM",h))];case 3:n.sent();return[3,5];case 4:if(!((g=n.sent())instanceof f.GraphError))throw g;c.addToOneDriveErrorHandle(g);return[3,5];case 5:return[2]}})})}})});
define("hH",["require","exports","ko","S0","uH","GA","JA","ph"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveResponse=function(e,t){var n=t+"/me/drive";return s.getRawData({url:n,qosName:e,method:"GET",endpoint:t})};t.getAddToOneDriveResponse=function(e,t,n,r,i){var o=i.replace("v2.0","v2.1")+"/drives/"+t+"/root/children",u={name:e,remoteItem:{sharepointIds:{listId:n.listId,listItemUniqueId:n.listItemUniqueId,siteId:n.siteId,siteUrl:n.siteUrl,webId:n.webId}},"@microsoft.graph.conflictBehavior":"rename"};return s.getRawData({url:o,qosName:r,method:"POST",body:u,endpoint:i})};t.addToOneDriveErrorHandle=function(e,t,s){var a=o.getErrorResolution(e,function(n,o){var a=e.response,f=a&&a.error;if(f){var l=f["@error.fixItItemIds"],c=f["@error.fixItWebUrl"],h=f["@error.fixItItemName"],p=[];if(l&&t&&s)for(var d=0,v=l;d<v.length;d++){var m=v[d],g=u.driveItemKeyFacet.serialize({endpoint:t,driveId:s,itemId:m});p.push(g)}switch(n){case"unauthenticated":case 401:return r.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return r.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return r.accessDeniedErrorFacet.pack({});case"shortcutAlreadyExists":return i.shortcutExistedAlreadyFacet.pack({existShortcutUrl:c,existShortcutName:h});case"nestedDescendantShortcutExists":return i.nestedDescendantShortcutExistsFacet.pack({nestDescendantItemKeys:p});case"nestedAscendantShortcutExists":return i.nestedAscendantShortcutExistsFacet.pack({existShortcutUrl:c,existShortcutName:h});default:return r.offlineErrorFacet.pack({})}}});throw new n.ItemOperationError({innerError:e,facets:a})}});
define("uQ",["require","exports","ih","og","Jb","vQ","pQ","fQ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return f}});t.default=t.sharedWithMeCommandBarControlHandler;var a=[r.openCommand,i.shareCommand,i.copyLinkCommand,s.addShortcutFromSharedWithMeCommand,u.removeShortcutFromSharedWithMeCommand,o.removeFromSharedListCommand];function f(e,t){return{commands:a}}});
define("lQ",["require","exports","lC","ih","lh","Kv","v_"],function(e,t,n,r,i,s,o){"use strict";var u;Object.defineProperty(t,"__esModule",{value:!0});var a=((u={})[o.DISPLAY_NAME_COLUMN_KEY]=!0,u[o.NAME_AND_PATH_COLUMN_KEY]=!0,u[s.SHARED_BY_COLUMN_KEY]=!0,u[s.DATE_SHARED_COLUMN_KEY]=!0,u[s.ITEM_ACTIVITY_COLUMN_KEY]=!0,u);t.sharedWithMeSortedItemSetControlHandler=r.createControlHandler()(function(){return function(e){return f}});function f(e,t){var r=t.itemSetKey,o=t.handler,u=o.columnKey,f=o.isAscending;if(!a[u])return{};var l=e.demandItemFacet(i.sharedWithMeItemSetKeyFacet,r);if(!l)return{};var c=s.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[u];return c?{newItemSetKey:i.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},l),{sortBy:c,isAscending:f}))}:{}}});
define("dQ",["require","exports","lC","lh","ih","fq","CD"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetOpenActionControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var i=t.itemKey,u=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i),a=u&&u.driveItemKey.endpoint,f=a&&s.getStageItemOverride(e,{parentItemKey:o.sharedWithMeRootItemKeyFacet.serialize({endpoint:a}),stageItem:t.stageItem});return n.__assign({},f?{stageItem:f}:{})}}})});
define("cQ",["require","exports","lC","lh","ih","Kv"],function(e,t,n,r,i,s){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});var u=((o={})[s.SHARED_BY_COLUMN_KEY]=!0,o[s.DATE_SHARED_COLUMN_KEY]=!0,o);t.sharedWithMeGroupedItemSetControlHandler=i.createControlHandler()(function(){return function(e){return a}});function a(e,t){var i=t.itemSetKey,o=t.handler.columnKey;if(!u[o])return{};var a=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i);if(!a)return{};var f=s.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[o];return f?{newItemSetKey:r.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{groupBy:f}))}:{}}});
define("sQ",["require","exports","lC","lh","ih"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeUngroupedItemSetControlHandler=i.createControlHandler()(function(){return function(e){return s}});function s(e,t){var i=t.itemSetKey,s=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i);return s?{newItemSetKey:r.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},s),{groupBy:void 0}))}:{}}});
define("oQ",["require","exports","ih"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupBySharedByOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("rQ",["require","exports","ih"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupByRelativeTimeOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("aQ",["require","exports","lC","Vm","Hm","eQ","Io","ri","GA","iQ","Jr","Rs","oy","Xo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.peopleGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey;return function(d){return n.__awaiter(t,void 0,void 0,function(){var t,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:t=new r.ItemResolver;v=d(o.readConfiguration({graphEndpoint:u.graphEndpointConfigurationFacet})).graphEndpoint;m=s.topCollaboratorSetKeyFacet.deserialize(i);g=v||m.endpoint;y=g+"/me/people/";return[4,d(a.getRawData({url:y,qosName:"getTopCollaborator",endpoint:g}))];case 1:b=O.sent();w=[];for(E=0,S=b.value;E<S.length;E++){x=S[E];T=x.id,N=x.displayName,C=x.userPrincipalName;k=f.topCollaboratorItemKeyFacet.serialize({id:T});d(l.resolveItems({items:(L={},L[k]=n.__assign(n.__assign({},c.displayNameFacet.pack(N)),h.emailFacet.pack(C)),L)}));w.push(k)}t.resolveItems({items:(A={},A[e.itemKey]=n.__assign({},p.childItemsFacet.pack({itemKeys:w})),A)});d(t.execute());return[2]}})})}})});
define("iQ",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorItemKeyFacet=new n.KeyFacet("topCollaboratorItemKeyFacet",{id:n.stringPart()})});
define("QQ",["require","exports","lC","Hm","YD","Y","YQ","GA","qA","_S","mS","ri","Io","Rm","E","lD"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileHandlerGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,i=f.driveAppsKeyFacet.deserialize(r),o=i.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u;return n.__generator(this,function(n){t=e(p.logQoS({name:"getFileHandlersOperation"}));u={endpoint:o};return[2,e(m(i)).then(function(n){if(n){v.cacheFileHandlerData({driveAppsKey:i,data:n});e(v.resolveFileHandlers(n,r));u.fileHandlerRequestEndpoint=n.signature.endpoint;u.accessTokenObtained=!0;e(t({resultType:d.ResultTypeEnum.Success,extraData:u}))}}).catch(function(n){s.default.logError(n);e(t({resultType:d.ResultTypeEnum.Failure,extraData:u}));throw n})]})})}});t.filehandlerPerExtensionGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,s=f.driveAppsExtensionKeyFacet.deserialize(r).endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=f.driveAppsKeyFacet.serialize({endpoint:s});return[4,e(i.demandItems(function(e){return e.demandItemFacet(l.fileHandlerActionsFacet,t)}))];case 1:n.sent();return[2]}})})}});function m(e){var t=e.endpoint,n=e.driveId;return function(e){var r,i=e(h.readConfiguration({getUserOneDriveEndpoint:c.getUserOneDriveEndpointFacet,useOneDriveEndpoint:c.userOneDriveEndpointForFileHandlerConfigurationFacet})),s=i.getUserOneDriveEndpoint,f=i.useOneDriveEndpoint,l=u.getDriveUrl({endpoint:t,driveId:n}),p=new o.default({},{dataRequestor:e(u.getDataRequestor).dataRequestor}),d=Promise.resolve(t);s&&f&&(d=e(s({endpoint:t})));return d.then(function(t){r=t;l=u.getDriveUrl({endpoint:r});return e(a.getSessionToken(r,l))}).then(function(e){return p.getFileHandlerData({accessToken:e,endpoint:r,includePromotedApp:!0,driveId:n}).then(function(e){if(e){return{data:e,lastModified:Date.now(),signature:{endpoint:r,includePromotedApp:!0,driveId:n}}}})})}}t.fetchFileHandlerData=m});
define("YQ",["require","exports","_e"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return!!e.fileHandler}function i(e){return r(e)&&!!e.promoted}var s=/^(?:data|blob|javascript):/i,o=/^(?:data|http|https):/i;function u(e){return!s.test(e)}var a={svg:!0,png1x:!0,png1_5x:!0,png2x:!0};function f(e){var t,n;if(e)for(var r in e)if(a.hasOwnProperty(r)){var i=(n=e[r])&&o.test(n)?n:void 0;if(i){t||(t={});t[r]=i}}return t}function l(e){return{file:e.file,folder:e.folder,allowMultiSelect:e.allowMultiSelect}}var c=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.getFileHandlerData=function(e){var t=e||{},s=t.language,o=void 0===s?n.default.language:s,a=t.accessToken,c=void 0===a?void 0:a,h=t.endpoint,p=void 0===h?"":h,d=t.includePromotedApp,v=void 0!==d&&d,m=t.driveId,g=void 0===m?void 0:m,y=p+"/drive";g&&(y="me"===g?p+"/me/drive":p+"/drives/"+g);return this._dataRequestor.send({path:y+"/apps?"+(v?"select=*,promoted&":"")+"$expand=actions",apiName:"GetDriveApps",headers:{"Accept-Language":o},accessToken:c,useAuthorizationHeaders:!!c}).then(function(e){for(var t={custom:[],create:[],open:[],preview:[]},n={},s=0,o=e.value;s<o.length;s++){var a=o[s];if(r(a)){var c=v?i(a):void 0,h=a.application,p=a.id,d=a.actions,m=a.fileHandler;if(d){var g=m.fileTypeDisplayName,y=m.fileTypeIconUrl,b=m.version;if(b)for(var w={id:p,appId:h.id,actionMenuDisplayName:m.actionMenuDisplayName,displayName:h.displayName,appIcon:f(m.appIcon),version:b,fileTypeDisplayName:g,fileTypeIcon:f(m.fileTypeIcon||{png1x:y}),isPromoted:c},E=0,S=0,x=d;S<x.length;S++){var T=x[S],N=T.url;if(N&&u(N)){var C=T.displayName,k=T.shortDisplayName,L=T.icon,A=T.availableOn;if(A){var O="newFile"===T.type?"create":T.type,M={type:O,url:N,displayName:C,icon:f(L),availableOn:l(A),handler:w,id:E},_=A.file,D=_&&_.extensions;switch(O){case"custom":if(!C)continue;M.shortDisplayName=k;if(!_&&!A.folder)continue;break;case"create":if(!D||!D[0])continue;break;case"open":case"preview":if(!_)continue;if(D&&!c)for(var P=0,H=D;P<H.length;P++){var B=H[P];(n[B]||(n[B]={open:[],preview:[]}))[O].push(M)}break;default:continue}t[O].push(M);E++}}}}}}return{actions:t,preferences:n,version:4}})};return e})();t.default=c});
define("lD",["require","exports","lC","Vm","Rs","Xo","_S","mS"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){var t=e.endpoint,n=e.driveId;return"fileHandlerCache_"+JSON.stringify({endpoint:t,driveId:n})}t.getFileHandlerCacheKey=a;t.cacheFileHandlerData=function(e){if("localStorage"in window)try{var t=a(e.driveAppsKey);localStorage.setItem(t,JSON.stringify(e.data))}catch(e){}};t.resolveFileHandlers=function(e,t){var i=e.data,s=i.actions,a=i.preferences,c=i.version,h=e.signature,p=o.driveAppsKeyFacet.deserialize(t);return function(i){var d,v=new r.ItemResolver,m=(function(e,t){var n={};["custom","create","open","preview"].forEach(function(r){var i=f(e,t[r],r);n[r]=i});return n})(v,s),g=(function(e,t){for(var i,s=new r.ItemResolver,a=0,c=Object.keys(e);a<c.length;a++){var h=c[a],p=e[h],d={};d.open=f(s,p.open,"open",h);d.preview=f(s,p.preview,"preview",h);for(var v=(p.open||[]).concat(p.preview||[]),m=void 0,g=0;g<v.length;g++){var y=v[g],b=y.handler,w=y&&l(y.icon)||b&&l(b.fileTypeIcon),E=b.fileTypeDisplayName||b.displayName;if(w){m={displayName:E,url:w};break}}var S=o.driveAppsExtensionKeyFacet.serialize({endpoint:t,extension:h}),x=n.__assign(n.__assign({},u.fileHandlerActionsFacet.pack(d)),u.fileHandlerFileTypeIconFacet.pack(m));s.resolveItems({items:(i={},i[S]=x,i)})}return{preferencesItemResolver:s}})(a,p.endpoint).preferencesItemResolver;v.merge(g);v.resolveItems({items:(d={},d[t]=n.__assign(n.__assign(n.__assign({},u.fileHandlerActionsFacet.pack(m)),u.fileHandlerVersionFacet.pack(c)),u.fileHandlerRawDataFacet.pack({data:e.data,signature:h})),d)});i(v.execute())}};function f(e,t,r,a){var f,c=[];t.forEach(function(t){var r,s=t.handler,a=o.fileHandlerKeyFacet.serialize({id:s.id,appId:s.appId}),f=o.fileHandlerActionKeyFacet.serialize({handlerId:s.id,appId:s.appId,id:t.id||0}),h={displayName:s.actionMenuDisplayName,url:l(s.appIcon)},p={displayName:s.fileTypeDisplayName||s.displayName,url:l(t.icon||s.fileTypeIcon)},d=n.__assign(n.__assign({},i.displayNameFacet.pack(s.actionMenuDisplayName||s.displayName)),u.fileHandlerAppIconFacet.pack(h)),v=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},i.displayNameFacet.pack(t.displayName||s.displayName)),i.openUrlFacet.pack(t.url)),u.fileHandlerActionAvailableOnFacet.pack(t.availableOn)),u.fileHandlerKeyFacetFacet.pack(a)),u.fileHandlerFileTypeIconFacet.pack(p)),u.fileHandlerAppIdFacet.pack(s.appId)),void 0!==s.isPromoted?n.__assign({},u.fileHandlerIsPromotedFacet.pack(s.isPromoted)):{});e.resolveItems({items:(r={},r[a]=d,r[f]=v,r)});-1===c.indexOf(f)&&c.push(f)});var h=o.fileHandlerActionSetKeyFacet.serialize({type:r,extension:a}),p=n.__assign({},s.childItemsFacet.pack(0===c.length?void 0:{itemKeys:c}));e.resolveItems({items:(f={},f[h]=p,f)});return h}function l(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)}});
define("sKe",["require","exports","lC","r","ih","Z_e","ahe","Rs","X4","JW","ph"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});function h(e,t){var n=e.activity,i=e.hoverCardElementsPerUser,o=e.personKeyByEmail;if(n){var u,a=(u=n.type,p[u]);return a?new a({activity:n,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!1,name:t,graphItemUrl:""},onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),s=e.user,u=s.email||"",a=i[u],f=o[u];return a?r.cloneElement(a,{displayValue:s.displayName,personKey:f,user:s},n):n},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:s.default}):void 0}}var p=((c={})[0]=o.EditItemActivity,c[1]=o.MoveItemActivity,c[2]=o.CommentItemActivity,c[3]=o.CommentResponseItemActivity,c[4]=o.MentionItemActivity,c[5]=o.VersionItemActivity,c[6]=o.RestoreItemActivity,c[9]=o.RenameItemActivity,c[10]=o.DeleteItemActivity,c[11]=o.CreateItemActivity,c[12]=o.ShareItemActivity,c);t.driveItemActivityFieldControlHandler=i.createControlHandler()(function(){return function(){return function(e,t){var r=t.itemKey,i=t.activity,s={},o={};if(l.driveItemKeyFacet.matches(r)){var c=l.driveItemKeyFacet.deserialize(r).endpoint,p=i&&i.actors||[],d=i&&i.action,v=d&&d.mention&&d.mention.mentionees||[],m=d&&d.share&&d.share.recipients||[],g=d&&d.commentResponse&&d.commentResponse.commentAuthor,y=n.__spreadArrays(p,v,m);g&&y.push(g);for(var b=0,w=y;b<w.length;b++){var E=w[b];if(E.email){var S=f.userByEmailKeyFacet.serialize({email:E.email,endpoint:c}),x={itemKey:S,displayValue:E.displayName},T=a.getHoverCardElement(e,x).hoverCardElement;s[E.email]=T;o[E.email]=S}}}var N=e.demandItemFacet(u.fileNameFacet,r);return{itemActivity:i&&N&&h({activity:i,hoverCardElementsPerUser:s,personKeyByEmail:o},N.name)}}}})});
define("ahe",["require","exports","lC","she","rhe","r","Oe","ce","pe","Au","pd","L7","us","Z_e","ihe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function v(e){return e?1:3}var m=(function(){function e(e){var t=this;this._onRenderUser=function(e,n){var r=e.user;return t._getUserLabel(r,{stringOnly:!1,isAccusative:e.isAccusative})};this.activity=e.activity;this.currentUserEmail=e.currentUserEmail;this.containingItem=e.containingItem;this.isSingleLevel=e.isSingleLevel;this.canOpenItem=e.canOpenItem;this.onItemClick=e.onItemClick;this.strings=e.strings;this.onRenderUser=e.onRenderUser;this.populateItemNameToDisplay=e.populateItemNameToDisplay;this.currentListTitle=e.currentListTitle;this.currentRootTitle=e.currentRootTitle;this.defaultItemTitle=e.defaultItemTitle;this.commentListItem=e.commentListItem;this.isReadonly=e.isReadonly;this.canDeleteActivity=e.canDeleteActivity;this.activityMenuFunctions=e.activityMenuFunctions;this.isNewCommentExperienceEnabled=e.isNewCommentExperienceEnabled;this.isAtMentionEnabled=!!e.isAtMentionEnabled;this.environment=e.environment;this.getpersonaIconUrl=e.getpersonaIconUrl;this.displayLargeText=e.displayLargeText;this.isListItem=e.isSingleLevel&&"sharePointList"===e.environment}e.prototype.getKey=function(){return this.activity.id};e.prototype.getTitle=function(e){void 0===e&&(e={});return this.getDescription(e)};e.prototype.getDescription=function(e){void 0===e&&(e={});return[]};e.prototype.getIconName=function(){return"ActivityFeed"};e.prototype.getPersonaIconUrl=function(){};e.prototype.getDate=function(){return this.activity.time};e.prototype.getFriendlyDisplayTime=function(){return this.activity.friendlyDisplayTime};e.prototype.getActivityTypeString=function(){return""};e.prototype.getResponse=function(){};e.prototype.getContextualMenu=function(){};e.prototype.getenvironment=function(){return this.environment};e.prototype.getCommentAuthorName=function(){};e.prototype.getcommentAuthorEmail=function(){};e.prototype.getCommentThreadId=function(){};e.prototype._getFilteredActors=function(e){for(var t,n,r=e.actors,i=void 0===r?this.activity.actors||[]:r,s=e.isCompact,o=[],u=0,a=i;u<a.length;u++){var f=a[u];f&&f.self?t=f:o.push(f)}t&&(o=[t].concat(o));var l=v(s);o.length>l&&(n=o.slice(l,o.length));return{youUser:t,additionalUsers:n,sortedUsers:o.length?o:[void 0]}};e.prototype._getAdditionalUsersTooltip=function(e,t){var n=t.stringOnly,r=t.isCompact,i=t.hideDate,o=t.isAccusative,u=void 0!==o&&o,l=r&&i?u?a.getLocalizedCountValue(this.strings.andOtherUsersCountFormShortAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):a.getLocalizedCountValue(this.strings.andOtherActorsCountFormShort,this.strings.otherActorsCountFormIntervals,e.length):u?a.getLocalizedCountValue(this.strings.andOtherUsersCountFormAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):a.getLocalizedCountValue(this.strings.andOtherActorsCountForm,this.strings.otherActorsCountFormIntervals,e.length),c=a.formatToArray(l,e.length);if(n)return c;var p={onRenderContent:function(){var t=e.map(function(e){return s.createElement("li",null,e.displayName)});return s.createElement("ul",{className:"od-ItemActivity-otherActors"},t)},id:h.getId("otherUsersTooltip")};return s.createElement(f.TooltipHost,{tooltipProps:p,id:p.id},s.createElement("span",{className:"od-ItemActivity-n-Others","aria-describedby":p.id,"data-is-focusable":!0},c))};e.prototype.getRenderedUsers=function(e,t){var n=this,r=t.stringOnly,i=t.isAccusative,s=t.isActor;return e&&0!==e.length?e.map(function(e,t){return n.renderUser(e,{stringOnly:r,isAccusative:i,isActor:s},t)||""}):[this.renderUser(void 0)]};e.prototype.renderUser=function(e,t,n){void 0===n&&(n=0);var r=this.onRenderUser,i=void 0===r?this._onRenderUser:r,o=t.stringOnly,u=t.isAccusative,a=t.isActor,f=this._getUserLabel(e,{stringOnly:!0,isAccusative:u});if(!e||o)return f;var l=(a?"_actor":"_")+n;return s.createElement("span",{key:e.email+l,"aria-label":f},i({user:e,isAccusative:u},this._onRenderUser))};e.prototype.renderMainItemLink=function(e,t,n){return this.isSingleLevel?e:a.formatToArray(t,this.renderItemLink({item:this.activity.item,stringOnly:n}))};e.prototype.renderItemLink=function(e){var t=this,n=e.item,r=e.itemLabel,i=e.stringOnly,o=e.keyPrefix,u=void 0===o?"":o,a=r;if(!a&&n&&!n.name&&this.populateItemNameToDisplay){this.populateItemNameToDisplay(n);a=n.name}a||(a=n&&n.isRoot?this._getRootFolderName():void 0);a||(a=n&&n.name?n.name:this._getDefaultItemName());if(a){if(i)return a;var f=void 0;if("string"==typeof a){f=a;var c=void 0,p=void 0;if(-1!==a.indexOf(".")){var d=a.split(".");c=d.slice(0,-1).join();p=d.slice(-1).join()}else{c=a;p=""}c.length>40&&(a=c.slice(0,37).concat("...").concat(p))}var v=a;if(this.canOpenItem&&this.canOpenItem(n)){var m=void 0;m=f?s.createElement("span",{className:"od-ItemActivity-item-textContent}",title:f}," ",a," "):s.createElement("span",{className:"od-ItemActivity-item-textContent}"}," ",a," ");return s.createElement(l.Link,{key:u+"_"+v+"_link",className:h.css("od-ItemActivity-item-linkText","od-ItemActivity-item-clickableLinkText"),onClick:function(){return t.onItemClick(n,t.getActivityTypeString())},href:"javascript:void(0)"},m)}return f?s.createElement("span",{key:u+"_"+v+"_string",className:"od-ItemActivity-item-linkText",title:f},a):s.createElement("span",{key:u+"_"+v+"_string",className:"od-ItemActivity-item-linkText"},a)}};e.prototype._getRootFolderName=function(){return this.currentRootTitle};e.prototype._getDefaultItemName=function(){return(this.currentListTitle?this.currentListTitle:this.defaultItemTitle)||void 0};e.prototype._getUserLabel=function(e,t){var n,r=t.stringOnly,i=t.isAccusative;n=e&&e.self?i?this.strings.you:this.strings.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:this.strings.someoneUpperCase;return r?n:s.createElement("span",{className:"od-ItemActivity-item-nameText"},n)};return e})();t.BaseItemActivity=m;var g=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,r=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.editThisFile;this.isListItem&&(o=this.strings.thisItem);var u,f=this.renderMainItemLink(o,this.strings.editArbitraryFile,i),l=this._getFilteredActors({isCompact:r}),c=l.youUser,h=l.sortedUsers,p=l.additionalUsers,d=v(r);if(h.length>d){var m=r?!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedCountFormShort:this.strings.othersEditedCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedCountForm:this.strings.othersEditedCountForm;return a.formatToArray.apply(a,n.__spreadArrays([m,f],this.getRenderedUsers(h.slice(0,d),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(p,{stringOnly:i,isCompact:r,hideDate:s})]))}var g=r?!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedListFormShort:this.strings.othersEditedListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedListForm:this.strings.othersEditedListForm;u=a.getLocalizedCountValue(g,r?this.strings.editedListFormShortIntervals:this.strings.editedListFormIntervals,h.length);return a.formatToArray.apply(a,n.__spreadArrays([u,f],this.getRenderedUsers(h,{stringOnly:i,isActor:!0})))};t.prototype.getIconName=function(){return"Edit"};t.prototype.getActivityTypeString=function(){return"edit"};return t})(m);t.EditItemActivity=g;var y=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=this.renderMainItemLink(this.strings.moveThisFile,this.strings.moveArbitraryFile,i),o=this._getFilteredActors({isCompact:r}),u=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:i,isActor:!0});if(!r&&this.activity.action&&this.activity.action.move){var l=this.activity.action.move;if(l.from&&l.to){var c=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"}),h=this.renderItemLink({item:l.to,stringOnly:i});t=!this.isNewCommentExperienceEnabled&&u?this.strings.youMovedFromFolderToFolder:this.strings.otherMovedFromFolderToFolder;return a.formatToArray(t,s,f,c,h)}if(l.from){c=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"});t=!this.isNewCommentExperienceEnabled&&u?this.strings.youMovedFromFolder:this.strings.otherMovedFromFolder;return a.formatToArray(t,s,f,c)}if(l.to){h=this.renderItemLink({item:l.to,stringOnly:i});t=!this.isNewCommentExperienceEnabled&&u?this.strings.youMovedToFolder:this.strings.otherMovedToFolder;return a.formatToArray(t,s,f,void 0,h)}}t=r?!this.isNewCommentExperienceEnabled&&u?this.strings.youMovedShort:this.strings.otherMovedShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youMoved:this.strings.otherMoved;return a.formatToArray(t,s,f)};t.prototype.getIconName=function(){return"FabricMovetoFolder"};t.prototype.getActivityTypeString=function(){return"move"};return t})(m);t.MoveItemActivity=y;var b=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,r=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.commentedOnThisFile;this.isListItem&&(o=this.strings.thisItem);var u,f,l=this.renderMainItemLink(o,this.strings.commentedOnArbitraryFile,i),c=this._getFilteredActors({isCompact:r}),h=c.youUser,p=c.sortedUsers,d=c.additionalUsers,m=v(r),g=this._isOnFileComment();if(g&&p.length<=1){var y=void 0;if(r)u=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort;else{var b=this._getCommentMessage(i);if(this.isSingleLevel&&b){y=b;u=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedOnThisFile:this.strings.othersCommentedOnThisFile}else{y=l;u=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedOnFile:this.strings.othersCommentedOnFile}}f=a.formatToArray.apply(a,n.__spreadArrays([u,y],this.getRenderedUsers(p,{stringOnly:i,isActor:!0})))}else if(p.length>m){var w=r?!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedCountFormShort:this.strings.othersCommentedCountFormShort:!this.isNewCommentExperienceEnabled&&h?g?this.strings.youCommentedCountFormOnItem:this.strings.youCommentedCountForm:g?this.strings.othersCommentedCountFormOnItem:this.strings.othersCommentedCountForm;f=a.formatToArray.apply(a,n.__spreadArrays([w,l],this.getRenderedUsers(p.slice(0,m),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(d,{stringOnly:i,isCompact:r,hideDate:s})]))}else{var E=r?!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort:!this.isNewCommentExperienceEnabled&&h?g?this.strings.youCommentedListFormOnItem:this.strings.youCommentedListForm:g?this.strings.othersCommentedListFormOnItem:this.strings.othersCommentedListForm;u=a.getLocalizedCountValue(E,r?this.strings.commentedListFormShortIntervals:this.strings.commentedListFormIntervals,p.length);f=a.formatToArray.apply(a,n.__spreadArrays([u,l],this.getRenderedUsers(p,{stringOnly:i,isActor:!0})))}return f};t.prototype.getIconName=function(){if(this.isNewCommentExperienceEnabled){var e=this._getCommentDetail();return this.commentListItem&&e?void 0:"Comment"}return this.commentListItem?void 0:"Comment"};t.prototype.getPersonaIconUrl=function(){var e=this._getCommentDetail();if(void 0===this.getpersonaIconUrl){var t=this.commentListItem&&e&&e.author.email,n=u.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN")?"/_layouts/15/userphoto.aspx?size=s&accountname="+t:o.getUserPhotoUrl(t);return t&&n||void 0}var r=this.commentListItem&&e&&e.author.id;return r&&this.getpersonaIconUrl(r)||void 0};t.prototype.getActivityTypeString=function(){return"comment"};t.prototype.getContextualMenu=function(){var e=this,t=[],n=this.activityMenuFunctions&&this.activityMenuFunctions.delete,r=this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId;if(this.canDeleteActivity&&this.canDeleteActivity(this.activity.type)&&n&&this.commentListItem&&r&&!this.isReadonly){var o={key:"od-itemActivity.deleteComment"+r,name:p.default.activityMenuOptionDelete,dialogTitle:p.default.deleteCommentDialogTitle,dialogOnConfirm:function(){return n(e.commentListItem.activityItemWrapper,e.currentUserEmail,{commentItem:e.commentListItem,commentId:r})}};t.push(o)}if(t.length)return s.createElement(i.default,{itemActivityMenuItems:t,activityId:this.activity.id,environment:this.environment})};t.prototype.getResponse=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail(),n=t&&t.replies&&t.replies.comments&&t.replies.comments.length>0;if(this.commentListItem&&t&&(n||!this.isReadonly))return s.createElement(r.default,{key:this.containingItem.graphItemUrl+"_"+t.id,parentComment:t,commentListItem:this.commentListItem,currentUserEmail:this.currentUserEmail,onRenderUser:this.onRenderUser,isReadonly:this.isReadonly,environment:this.environment})};t.prototype.getCommentAuthorName=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.displayName};t.prototype.getcommentAuthorEmail=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.email};t.prototype.getCommentThreadId=function(){return this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId};t.prototype._getCommentMessage=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail();if(t&&t.text)return e?t.text:!0===this.isNewCommentExperienceEnabled&&this.displayLargeText?s.createElement("div",{className:"od-itemActivity-commentActivity-commentContent"},this.displayLargeText({seeMoreText:this.strings.seeMoreLabel,seeLessText:this.strings.seeLessLabel,text:"sharePointList"===this.environment?d.default.htmlDecodeFromString(t.text):t.text,isAtMentionEnabled:this.isAtMentionEnabled})):s.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:t.text}})};t.prototype._getCommentDetail=function(){var e=this.activity.action;return e&&e.comment&&e.comment.commentDetail};t.prototype._isOnFileComment=function(){var e=this.activity.action&&this.activity.action.comment;return!(!e||!e.commentId)};return t})(m);t.CommentItemActivity=b;var w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,r=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.activity.action.commentResponse,u=this._getFilteredActors({isCompact:r}),f=u.youUser,l=u.sortedUsers,c=u.additionalUsers,h=v(r),p=this.renderItemLink({item:this.activity.item,itemLabel:this.strings.commentResponseComment,stringOnly:i});if(o&&o.commentAuthor){var d=o.commentAuthor.self,m=this.renderUser(o.commentAuthor,{stringOnly:i,isAccusative:!0}),g=void 0;if(l.length>h){g=d?r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouCountFormShort:this.strings.otherRepliedToYouCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouCountForm:this.strings.otherRepliedToYouCountForm:r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherCountFormShort:this.strings.otherRepliedToOtherCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherCountForm:this.strings.otherRepliedToOtherCountForm;var y=n.__spreadArrays([m],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(c,{stringOnly:i,isCompact:r,hideDate:s})]);r||y.unshift(p);return a.formatToArray.apply(a,n.__spreadArrays([g],y))}var b=void 0;b=d?r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouListFormShort:this.strings.otherRepliedToYouListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouListForm:this.strings.otherRepliedToYouListForm:r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherListFormShort:this.strings.otherRepliedToOtherListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherListForm:this.strings.otherRepliedToOtherListForm;g=a.getLocalizedCountValue(b,r?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length);y=n.__spreadArrays([m],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}));r||y.unshift(p);return a.formatToArray.apply(a,n.__spreadArrays([g],y))}g=void 0;if(l.length>h){g=r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorCountFormShort:this.strings.otherRepliedToMissingAuthorCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorCountForm:this.strings.otherRepliedToMissingAuthorCountForm;return a.formatToArray.apply(a,n.__spreadArrays([g,p],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(c,{stringOnly:i,isCompact:r,hideDate:s})]))}b=r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorListFormShort:this.strings.otherRepliedToMissingAuthorListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorListForm:this.strings.otherRepliedToMissingAuthorListForm;g=a.getLocalizedCountValue(b,r?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length);return a.formatToArray.apply(a,n.__spreadArrays([g,p],this.getRenderedUsers(l,{stringOnly:i,isActor:!0})))};t.prototype.getIconName=function(){return"Reply"};t.prototype.getActivityTypeString=function(){return"commentResponse"};return t})(m);t.CommentResponseItemActivity=w;var E=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,r=void 0===e?{}:e,i=r.isCompact,s=r.stringOnly,o=r.hideDate,u=this.renderMainItemLink(this.strings.mentionedThisFile,this.strings.mentionArbitraryFile,s),f=this._getFilteredActors({actors:this.activity.action.mention.mentionees,isCompact:i}),l=this.getRenderedUsers(f.sortedUsers,{stringOnly:s}),c=f.youUser,h=f.additionalUsers,p=this._getFilteredActors({isCompact:i}),d=p.youUser,m=p.sortedUsers,g=v(i);if(l.length>g){var y;y=c?i?!this.isNewCommentExperienceEnabled&&d?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedYouAndOthersCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youMentionedYouAndOthersCountForm:this.strings.othersMentionedYouAndOthersCountForm:i?!this.isNewCommentExperienceEnabled&&d?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedOthersCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youMentionedOthersCountForm:this.strings.othersMentionedOthersCountForm;return a.formatToArray.apply(a,n.__spreadArrays([y,u],this.getRenderedUsers(m,{stringOnly:s,isActor:!0}),l.slice(0,g),[this._getAdditionalUsersTooltip(h,{stringOnly:s,isCompact:i,hideDate:o})]))}var b=void 0;b=c?i?!this.isNewCommentExperienceEnabled&&d?this.strings.youMentionedYouListFormShort:this.strings.otherMentionedYouListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youMentionedYouAndOthersListForm:this.strings.othersMentionedYouAndOthersListForm:i?!this.isNewCommentExperienceEnabled&&d?this.strings.youMentionedOthersListFormShort:this.strings.othersMentionedOthersListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youMentionedOthersListForm:this.strings.othersMentionedOthersListForm;t=a.getLocalizedCountValue(b,i?this.strings.mentionedListFormShortIntervals:this.strings.mentionedListFormIntervals,l.length);return a.formatToArray.apply(a,n.__spreadArrays([t,u],this.getRenderedUsers(m,{stringOnly:s,isActor:!0}),l.slice(0,g)))};t.prototype.getIconName=function(){return"Accounts"};t.prototype.getActivityTypeString=function(){return"mention"};return t})(m);t.MentionItemActivity=E;var S=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly;if(this.activity.action&&this.activity.action.version&&this.activity.action.version.newVersion){var i=this._getFilteredActors({isCompact:n}),s=i.youUser,o=this.renderUser(i.sortedUsers[0],{stringOnly:r,isActor:!0}),u=n?!this.isNewCommentExperienceEnabled&&s?this.strings.youCreatedVersionShort:this.strings.otherCreatedVersionShort:!this.isNewCommentExperienceEnabled&&s?this.isSingleLevel?this.strings.youCreatedVersionThisFile:this.strings.youCreatedVersion:this.isSingleLevel?this.strings.otherCreatedVersionThisFile:this.strings.otherCreatedVersion,f=this.renderMainItemLink(this.strings.versionThisFile,this.strings.versionArbitraryFile,r),l=this.activity.action.version.newVersion;return a.formatToArray(u,f,o,l)}return[]};t.prototype.getIconName=function(){return"FabricMovetoFolder"};t.prototype.getActivityTypeString=function(){return"version"};return t})(m);t.VersionItemActivity=S;var x=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=(t.isCompact,t.stringOnly),r=this.strings.restoreThisFile;this.isListItem&&(r=this.strings.restoreThisItem);var i=this.renderMainItemLink(r,this.strings.restoreArbitraryFile,n),s=this.isSingleLevel?this.strings.thisFileRestored:this.strings.arbitraryFileRestored;return a.formatToArray(s,i)};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"restore"};return t})(m);t.RestoreItemActivity=x;var T=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=this._getFilteredActors({isCompact:r}),o=s.youUser,u=this.renderUser(s.sortedUsers[0],{stringOnly:i,isActor:!0});if(this.activity.action&&this.activity.action.rename&&this.activity.action.rename.oldItem){var f=this.renderItemLink({item:this.activity.action.rename.oldItem,stringOnly:i,keyPrefix:"old"}),l=this.renderItemLink({item:this.activity.item,stringOnly:i});t=r?!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileToFileShort:this.strings.otherRenamedFileToFileShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileToFile:this.strings.otherRenamedFileToFile;return a.formatToArray(t,u,f,l)}var c=this.renderMainItemLink(this.strings.renameThisFile,this.strings.renameArbitraryFile,i);t=r?!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileShort:this.strings.otherRenamedFileShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFile:this.strings.otherRenamedFile;return a.formatToArray(t,u,c)};t.prototype.getIconName=function(){return"Rename"};t.prototype.getActivityTypeString=function(){return"restore"};return t})(m);t.RenameItemActivity=T;var N=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.strings.deleteThisFile;this.isListItem&&(i=this.strings.thisItem);var s=this.renderMainItemLink(i,this.strings.deleteArbitraryFile,r),o=this._getFilteredActors({isCompact:n}),u=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:r,isActor:!0}),l=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youDeletedShort:this.strings.otherDeletedShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youDeleted:this.strings.otherDeleted;if(this.isSingleLevel)return a.formatToArray(l,s,f);var c=this.renderItemLink({item:this.activity.parentItem,stringOnly:r});l=!n&&c?!this.isNewCommentExperienceEnabled&&u?this.strings.youDeletedFromFolder:this.strings.otherDeletedFromFolder:l;return c?a.formatToArray(l,s,f,c):a.formatToArray(l,s,f)};t.prototype.getIconName=function(){return"Trash"};t.prototype.getActivityTypeString=function(){return"delete"};return t})(m);t.DeleteItemActivity=N;var C=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.strings.createThisFile;this.isListItem&&(i=this.strings.thisItem);var s=this.renderMainItemLink(i,this.strings.createArbitraryFile,r),o=this._getFilteredActors({isCompact:n}),u=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:r,isActor:!0}),l=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youCreatedShort:this.strings.otherCreatedShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youCreated:this.strings.otherCreated;if(this.isSingleLevel)return a.formatToArray(l,s,f);var c=this.renderItemLink({item:this.activity.parentItem,stringOnly:r});l=!n&&c?!this.isNewCommentExperienceEnabled&&u?this.strings.youCreatedInLocation:this.strings.otherCreatedInLocation:l;return c?a.formatToArray(l,s,f,c):a.formatToArray(l,s,f)};t.prototype.getIconName=function(){return"Add"};t.prototype.getActivityTypeString=function(){return"create"};return t})(m);t.CreateItemActivity=C;var k=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,r=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.shareThisFile;this.isListItem&&(o=this.strings.thisItem);var u,f=this.renderMainItemLink(o,this.strings.shareArbitraryFile,i),l=this._getFilteredActors({isCompact:r}),c=l.youUser,h=this.renderUser(l.sortedUsers[0],{stringOnly:i,isActor:!0}),p=this.activity.action.share.recipients;if(p&&p.length>0){var d=this._getFilteredActors({actors:p,isCompact:r}),m=d.sortedUsers,g=d.youUser,y=d.additionalUsers,b=v(r);if(m.length>b){var w;w=g?r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouCountFormShort:this.strings.otherSharedWithYouCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouCountForm:this.strings.otherSharedWithYouCountForm:r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersCountFormShort:this.strings.otherSharedWithOthersCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersCountForm:this.strings.otherSharedWithOthersCountForm;return a.formatToArray.apply(a,n.__spreadArrays([w,f,h],this.getRenderedUsers(m.slice(0,b),{stringOnly:i,isAccusative:!0}),[this._getAdditionalUsersTooltip(y,{stringOnly:i,isCompact:r,hideDate:s,isAccusative:!0})]))}var E=void 0;E=g?r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouListFormShort:this.strings.otherSharedWithYouListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouListForm:this.strings.otherSharedWithYouListForm:r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersListFormShort:this.strings.otherSharedWithOthersListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersListForm:this.strings.otherSharedWithOthersListForm;var S=a.getLocalizedCountValue(E,r?this.strings.sharedWithOthersListFormShortIntervals:this.strings.sharedWithOthersListFormIntervals,m.length);return a.formatToArray.apply(a,n.__spreadArrays([S,f,h],this.getRenderedUsers(m,{stringOnly:i,isAccusative:!0})))}u=r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedShort:this.strings.otherSharedShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youShared:this.strings.otherShared;return a.formatToArray(u,f,h)};t.prototype.getIconName=function(){return"Share"};t.prototype.getActivityTypeString=function(){return"share"};return t})(m);t.ShareItemActivity=k;var L=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.shareThisFile,this.strings.createArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),o=s.youUser,u=this.renderUser(s.sortedUsers[0],{stringOnly:r,isActor:!0}),f=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredDocumentLibraryShort:this.strings.otherRestoredDocumentLibraryShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredDocumentLibrary:this.strings.otherRestoredDocumentLibrary,l=this.activity.action&&this.activity.action.pointInTimeRestore,h=l&&l.restoreToDateTime;return a.formatToArray(f,u,i,c.getRelativeDateTimeStringPast(h))};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"pointInTimeRestore"};return t})(m);t.PointInTimeRestoreActivity=L;var A=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.restoredVersionThisFile,this.strings.restoredVersionArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),o=s.youUser,u=this.renderUser(s.sortedUsers[0],{stringOnly:r}),f=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredVersionShort:this.strings.otherRestoredVersionShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredVersion:this.strings.otherRestoredVersion,l=this.activity.action&&this.activity.action.restoreVersion,c=l&&l.fromVersion;return a.formatToArray(f,u,i,c)};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"restoreVesion"};return t})(m);t.RestoreVersionActivity=A;var O=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=(t.hideDate,this.renderMainItemLink(this.strings.shortcutThisFolder,this.strings.shortcutArbitraryFolder,r)),s=this._getFilteredActors({isCompact:n}),o=s.youUser,u=this.renderUser(s.sortedUsers[0],{stringOnly:r}),f=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youAddedAShortcutShort:this.strings.OtherAddedAShortcutShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youAddedAShortcut:this.strings.OtherAddedAShortcut;return a.formatToArray(f,u,i)};t.prototype.getIconName=function(){return"FabricFolderLink"};t.prototype.getActivityTypeString=function(){return"addShortcutToOneDrive"};return t})(m);t.AddShortcutToOneDriveActivity=O;var M=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=(t.hideDate,this.activity.action.removeShortcutFromOneDrive),s=this.renderItemLink({item:this.activity.item,itemLabel:i.mountPointName,stringOnly:r}),o=this._getFilteredActors({isCompact:n}),u=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:r}),l=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youRemovedAShortcutShort:this.strings.OtherRemovedAShortcutShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youRemovedAShortcut:this.strings.OtherRemovedAShortcut;return a.formatToArray(l,f,s)};t.prototype.getIconName=function(){return"FabricFolderLink"};t.prototype.getActivityTypeString=function(){return"removeShortcutFromOneDrive"};return t})(m);t.RemoveShortcutFromOneDriveActivity=M});
define("she",["require","exports","lC","r","w1","Oe","ce","pe","Uc","us","sd","pd","lhe","Z_e","dhe","us","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._onFocus=function(){i._focusZone&&i._focusZone.focus()};i._onRenderCell=function(e,t){var n=i.props.onRenderUser,s=i.state,o=s.currentReplies,u=s.numberOfRepliesDisplayed,a=o.comments.length||0,f=u<=a&&a-u||0,l=new g({reply:e,onRenderUser:n});if(e&&t>=f)return r.createElement(d.default,{key:l.getKey(),reply:l,additionalClass:"od-ItemActivityList-commentReply"})};i._onSend=function(e,t,n){var r=i.props,s=r.parentComment,o=r.commentListItem,u=r.currentUserEmail;i._store&&i._store.addItemCommentReply({itemWrapper:o,currentUserEmail:u},s.id,e).then(function(e){i._store.fetchItemCommentReplies({itemWrapper:o,currentUserEmail:u,startIndex:0},s.id);t&&t()},function(e){var t=e&&e.message&&e.message.value;n&&n(t)})};i._onShowMore=function(){var e=i.props,t=e.onShowMore,n=e.parentComment,r=e.commentListItem,s=e.currentUserEmail,o=i.state.currentReplies,u=i.state.numberOfRepliesDisplayed;if(u<o.comments.length){i.setState({numberOfRepliesDisplayed:10*Math.floor(u/10)+10});o.nextLink&&i._store.fetchItemCommentReplies({itemWrapper:r,currentUserEmail:s},n.id)}t&&t()};i._store=n.itemCommentsStore;i._engagementSource=n.engagementSource||"";var s=t.parentComment,o=t.commentListItem,u=t.currentUserEmail;i._environment=t.environment;var a=i._store.getItemCommentReplies({itemWrapper:o,currentUserEmail:u},s.id),f=a&&a.comments&&a.comments.length,l=f?2:0;i.state={numberOfRepliesDisplayed:l,currentReplies:a,hasMore:l<f};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.parentComment.id!==this.props.parentComment.id&&this._addListener()};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentWillUnmount=function(){this._store.removeRepliesListener(this._storeListener)};t.prototype.UNSAFE_componentWillUpdate=function(){this._focusElement=void 0};t.prototype.render=function(){var e=this.props,t=e.isReadonly,n=e.parentComment,i=this.state.currentReplies.comments||[],s=i.map(function(e){try{return e.action.comment.commentDetail}catch(e){}}),o="sharePointList"===this._environment,u="consumer"===this._environment;return r.createElement("div",{"data-is-focusable":!u&&!o,key:"activityResponse_"+n.id,onFocus:this._onFocus,"aria-label":p.default.activityCommentRepliesList,"aria-hidden":u||o},r.createElement(a.FocusZone,{componentRef:this._resolveRef("_focusZone"),className:v.css("od-ItemActivityList-activity-commentResponse",{"od-ItemActivityList-activity-withHiddenReply":u||o}),direction:a.FocusZoneDirection.vertical,isCircularNavigation:!1,handleTabKey:a.FocusZoneTabbableElements.inputOnly,shouldInputLoseFocusOnArrowKey:function(e){return!0},isInnerZoneKeystroke:function(e){return e.which===f.getRTLSafeKeyCode(f.KeyCodes.right)}},this._getShowMoreLink(),i&&i.length>0&&r.createElement(l.List,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),className:"od-activityItem-replies-list",items:s,onRenderCell:this._onRenderCell}),!t&&!u&&!o&&r.createElement(h.default,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),commentItemId:n&&n.id,placeholderText:p.default.replyPlaceholder,sendButtonTitle:"",onSend:this._onSend,engagementSource:this._engagementSource+".AddReply"})))};t.prototype._addListener=function(){var e=this,t=this.props,n=t.parentComment,r=t.commentListItem,i=t.currentUserEmail;this._storeListener=this._store.addRepliesListener(function(){var t=e._store.getItemCommentReplies({itemWrapper:r,currentUserEmail:i},n.id),s=t.comments&&t.comments.length;e.setState({currentReplies:t,numberOfRepliesDisplayed:s>2?e.state.numberOfRepliesDisplayed:s,hasMore:!!t.nextLink||t.comments.length>e.state.numberOfRepliesDisplayed})},{item:r.activityItemWrapper,currentUserEmail:i},n.id)};t.prototype._getShowMoreLink=function(){this.props.parentComment;var e,t=this.state,n=t.currentReplies;if(t.numberOfRepliesDisplayed<(null===(e=n.comments)||void 0===e?void 0:e.length)||n.nextLink)return r.createElement("div",{className:"od-ItemActivityList-commentReply od-ItemActivityList-loadMoreReplies"},r.createElement(c.Link,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),onClick:this._onShowMore,href:"javascript:void(0)"},p.default.commentRepliesGetMore))};t.contextTypes={itemCommentsStore:i.any,engagementSource:i.any};return t})(f.BaseComponent);t.default=m;var g=(function(){function e(e){var t=this;this._renderUser=function(e,n){var r=e.user;r||(r=t._getReplyAuthor());return t._renderUserLabel(r,{stringOnly:!1})};this._commentReply=e.reply;this._onRenderUser=e.onRenderUser}e.prototype.getKey=function(){return"Comment"+this._commentReply.parentId+"_Reply"+this._commentReply.id};e.prototype.getPersonaImgUrl=function(){var e=this._commentReply.author;return o.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN")?"/_layouts/15/userphoto.aspx?size=S&accountname="+e.email:s.getUserPhotoUrl(e.email)};e.prototype.getFriendlyDisplayTime=function(){return this._commentReply.friendlyDisplayTime};e.prototype.getDate=function(){return this._commentReply.createdDate};e.prototype.getDescription=function(e){void 0===e&&(e={stringOnly:!1});var t=e.stringOnly,n=this._commentReply.text,i=this._getReplyAuthor(),s=this.renderUser(i,{stringOnly:t}),o=t?n:r.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:n}});return i.self?u.formatToArray(p.default.youReplied,o):u.formatToArray(p.default.otherReplied,o,s)};e.prototype.renderUser=function(e,t){var n=t.stringOnly,i=this._renderUserLabel(e,{stringOnly:!0});return!e||n?i:r.createElement("span",{"aria-label":i},this._onRenderUser({user:e},this._renderUser))};e.prototype._renderUserLabel=function(e,t){var n,i=t.stringOnly;n=e&&e.self?p.default.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:p.default.someoneUpperCase;return i?n:r.createElement("span",{className:"od-ItemActivity-item-nameText"},n)};e.prototype._getReplyAuthor=function(){return this._commentReply.author};return e})();t.ItemCommentReplyModel=g});
define("lhe",["require","exports","lC","r","us","Zd","SE","am","Au","phe","Ih","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._textField=r.createRef();n.COMMENT_TEXT_MAX_LENGTH=2e3;n.charLimitExceededMessage="Maximum character limit exceeded";n._onSend=function(){var e=n.props,t=e.onSend,r=e.engagementSource,i=e.engagementExtraData,s=n.state.text;if(s&&t){n.setState({sending:!0,errorMessage:"",successMessage:""});t(s,function(){n._onClearTextField();n.setState({successMessage:f.default.CommentAdded})},function(e){n.setState({sending:!1,errorMessage:e})});var o=r?r+".":"AddCommentTextField.";l.Engagement.logData({name:o+"Send.Click",isIntentional:!0,extraData:i})}};n._onClearTextField=function(){n.setState(n._getResetState(),function(){n._textField&&n._textField.current&&n._textField.current.focus()})};n._onTextFieldChange=function(e,t){!t||t.length<=n.COMMENT_TEXT_MAX_LENGTH?n.setState({text:t||"",errorMessage:"",enableSendButton:!(!t||!t.trim())}):n.setState({text:n.state.text,errorMessage:n.charLimitExceededMessage,enableSendButton:!1})};n._onKeyDown=function(e){e.which===i.KeyCodes.enter&&n.state.enableSendButton&&n._onSend()};n.state=n._getResetState();return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.commentItemId===this.props.commentItemId&&e.disabled===this.props.disabled||this.setState(n.__assign(n.__assign({},this._getResetState()),{errorMessage:"",successMessage:""}))};t.prototype.componentDidMount=function(){this.props.focusOnMount&&!this.props.disabled&&this._textField.current&&this._textField.current.focus()};t.prototype.render=function(){var e=this.props,t=e.overrideStyleName,s=(e.engagementSource,e.commentItemId,e.enableNewCommentingExperience);return r.createElement("div",{className:i.css({"od-addCommentTextField":!s},{"od-addNewCommentTextField":s},t)},r.createElement(o.TextField,n.__assign({componentRef:this._textField,"data-lpignore":"true"},this._getTextFieldProps())),r.createElement("div",{className:i.css({"od-addCommentTextField-screenReaderOnly":!s},{"od-addNewCommentTextField-screenReaderOnly":s}),"aria-live":"assertive",role:"status","aria-label":this.state.successMessage},this.state.successMessage))};t.prototype._getTextFieldProps=function(){var e=this,t=this.props,n=t.placeholderText,r=t.disabled,s=t.enableNewCommentingExperience,o=this.state,u=o.sending,a=o.text,l=o.errorMessage;return{className:i.css({"od-addCommentTextField-input":!s},{"od-addNewCommentTextField-input":s},{"od-addNewCommentTextField-disabled":s&&(r||u)}),placeholder:n,onChange:this._onTextFieldChange,value:a||"",disabled:r||u,onKeyDown:this._onKeyDown,autoComplete:"off",errorMessage:l,autoAdjustHeight:s,multiline:s,rows:1,resizable:!1,onRenderSuffix:function(t){return e._onRenderSuffix()},ariaLabel:f.default.inputLabel}};t.prototype._onRenderSuffix=function(){return this.props.enableNewCommentingExperience?this.state.text.length>0&&r.createElement(r.Fragment,null,this._getSendButton()):r.createElement(r.Fragment,null,this._getCancelButton(),this._getSendButton())};t.prototype._getCancelButton=function(){this.props.enableNewCommentingExperience;return r.createElement(a.TooltipHost,{content:f.default.cancelLabel,styles:{root:{display:"inline-block"}},directionalHint:a.DirectionalHint.bottomAutoEdge},r.createElement(u.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:f.default.cancelLabel,onClick:this._onClearTextField}))};t.prototype._getSendButton=function(){var e=this.props,t=e.sendButtonTitle,n=e.enableNewCommentingExperience;return this.state.sending?r.createElement("div",{className:i.css({"od-addCommentTextField-spinner":!n},{"od-addNewCommentTextField-spinner":n})},r.createElement(s.Spinner,{size:s.SpinnerSize.small})):r.createElement(a.TooltipHost,{content:f.default.sendLabel||t,styles:{root:{display:"inline-block"}},directionalHint:a.DirectionalHint.bottomAutoEdge},r.createElement(u.IconButton,{className:i.css({"od-addCommentTextField-sendButton":!n},{"od-addNewCommentTextField-sendButton":n}),iconProps:{iconName:"Send"},ariaLabel:f.default.sendLabel||t,onClick:this._onSend,disabled:!this.state||!this.state.enableSendButton}))};t.prototype._getResetState=function(){return{text:"",enableSendButton:!1,sending:!1,errorMessage:""}};return t})(i.BaseComponent);t.default=c});
define("dhe",["require","exports","lC","r","vR","Uc","L7","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},t.props.reply.getDescription())};t._onRenderActivityTimeStamp=function(e,t){return t?t(e):null};t._onRenderHiddenTimeStamp=function(e,t){return null};return t}t.prototype.render=function(){var e=this.props,t=e.reply,n=e.hideDate,o=e.additionalClass,u=void 0===o?"":o;return r.createElement(s.FocusZone,{direction:s.FocusZoneDirection.horizontal,"data-is-focusable":!0,"aria-label":this._getAriaLabel()},r.createElement(i.ActivityItem,{key:t.getKey(),className:"od-ItemActivity-item "+u,activityPersonas:this._activityPersonas(),onRenderActivityDescription:this._onRenderActivityDescription,timeStamp:this._onRenderDate(),onRenderTimeStamp:n?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp}))};t.prototype._onRenderDate=function(){var e=this.props.reply;return(o.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||o.getFriendlyDateTimeStringPast(e.getDate())).toString()};t.prototype._getAriaLabel=function(){return this.props.reply.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()};t.prototype._activityPersonas=function(){return[{imageUrl:this.props.reply.getPersonaImgUrl()}]};return t})(r.Component);t.default=u});
define("rhe",["require","exports","lC","r","am","Au","kw","ku","us","Ih","Z_e","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={root:{display:"inline-block",verticalAlign:"top"}},h=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDismissDialog=function(){r.setState({hideDialog:!0})};r.state={dialogTitle:"",onDialogConfirm:void 0,hideDialog:!0};return r}t.prototype.render=function(){var e=this,t=this.state,n=t.dialogTitle,f=t.onDialogConfirm,h=t.hideDialog,p=this.props.environment,d=this._getMenuItems(),v="sharePointList"===p,m="consumer"===p;if(d)return r.createElement(r.Fragment,null,r.createElement(s.TooltipHost,{content:l.default.activityMenuAriaLabel,styles:c},r.createElement(i.IconButton,{className:a.css("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-display":m||v}),role:"button",iconProps:{iconName:"More"},onRenderMenuIcon:function(){},ariaLabel:l.default.activityMenuAriaLabel,menuProps:{directionalHint:u.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:d,styles:{root:v?"spo-ItemActivity-menuItems":"od-ItemActivity-menuItems"}}})),r.createElement(o.Dialog,{hidden:h,onDismiss:this._onDismissDialog,dialogContentProps:{type:o.DialogType.normal,title:n}},r.createElement(o.DialogFooter,null,r.createElement(i.DefaultButton,{className:a.css({"od-itemActivityMenu-dialogButton-default":m||v}),disabled:!1,onClick:function(){f();e._onDismissDialog()},text:l.default.activityMenuDialogConfirm}),r.createElement(i.DefaultButton,{className:a.css({"od-itemActivityMenu-dialogButton-primary":m||v}),disabled:!1,primary:!0,onClick:this._onDismissDialog,text:l.default.activityMenuDialogCancel}))))};t.prototype._getMenuItems=function(){var e=this,t=this.props,n=t.itemActivityMenuItems,r=t.activityId;return n.map(function(t){return{key:t.key,name:t.name,onClick:function(n,i){var s=t.dialogOnConfirm;t.dialogTitle&&s?e.setState({dialogTitle:t.dialogTitle,onDialogConfirm:s,hideDialog:!1}):t.onClickMenuOption&&t.onClickMenuOption(n,i);f.Engagement.logData({name:"ActivityItemMenu."+t.name+".Click",isIntentional:!0,extraData:{activityId:r}})}}})};return t})(r.Component);t.default=h});
define("ihe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.htmlDecodeFromString=function(e){var t=e,n=(new DOMParser).parseFromString(t,"text/html");return t=n&&n.body&&n.body.innerText?n.body.innerText:t};e.isIE11=function(){return!!window.MSInputMethodContext&&!!document.documentMode};return e})();t.default=n});
define("cKe",["require","exports","FKe","PKe","SKe","yKe","pKe","dKe","Hm","ih","Zs","Sg","E1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentAddon=a.createAddon(function(){return function(e){e(i.recentAddonDataOnly);e(f.registerControlHandler(n.recentRootItemSetKeyFacet,l.itemSetDetailsListControl)(r.recentRootItemSetDetailsListControlHandler));e(f.registerControlHandler(s.recentRootItemKeyFacet,c.itemsCommandBarControl)(o.recentRootItemCommandBarControlHandler));e(f.registerControlHandler(n.recentRootItemSetKeyFacet,h.itemSetColumnsControl)(u.recentRootItemSetColumnsControlHandler))}})});
define("FKe",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetKeyFacet=new n.KeyFacet("recentRootItemSet",{filters:n.arrayPart(n.stringPart())})});
define("PKe",["require","exports","TKe","zc","ih"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetDetailsListControlHandler=i.createControlHandler()(function(){return function(e){return s}});function s(){return{groupHeaderRenderer:n.RecentGroupItemDetailsHeader,groupProps:{collapseAllVisibility:r.CollapseAllVisibility.hidden}}}});
define("TKe",["require","exports","lC","r","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";i=i.RecentGroupItemDetailsHeader_9;Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?r.createElement("div",{className:i.root},this.props.group.name):null};return t})(r.PureComponent);t.RecentGroupItemDetailsHeader=s});
define("SKe",["require","exports","yKe","MKe","FKe","bKe","AKe","wKe","IKe","Hm","$1","ih","H8","DKe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentAddonDataOnly=f.createAddon(function(){return function(e){e(f.registerOperationHandler(n.recentRootItemKeyFacet,l.getItemsOperation)(u.recentRootItemGetItemsOperationHandler));e(f.registerOperationHandler(i.recentRootItemSetKeyFacet,l.getItemsOperation)(o.recentRootItemSetGetItemsOperationHandler));e(f.registerOperationHandler(r.recentItemKeyFacet,s.changePinStateOperation)(a.recentItemChangePinStateOperationHandler));e(c.registerControlHandler(i.recentRootItemSetKeyFacet,h.filteredItemSetControl)(p.recentRootItemSetFilteredItemSetControlHandler))}})});
define("yKe",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemKeyFacet=new n.KeyFacet("recent",{})});
define("MKe",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemKeyFacet=new n.KeyFacet("recentItem",{mru_id:n.stringPart()})});
define("bKe",["require","exports","si","ko"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.changePinStateOperation=new n.Facet("pinItems");t.changePinState=r.implementOperation({operationTypeFacet:t.changePinStateOperation})});
define("AKe",["require","exports","lC","EKe","yKe","kKe","MKe","OKe","xKe","Hm","Xo","Rs","ey","zm","Jf","oi","Co","Vm","EKe","li","LKe","me","Ev","fL","Io","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetGetItemsOperationHandler=f.createSingleItemOperationHandler()(function(e){var t=this,f=e.itemKey,x=i.recentRootItemKeyFacet.serialize({});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me;return n.__generator(this,function(ge){switch(ge.label){case 0:t=e(T.readConfiguration({enableSharePointItemMapping:N.enableSharePointItemMappingConfigurationFacet})).enableSharePointItemMapping,i=void 0===t||t;return[4,e(a.getData({path:"/recent",method:"GET"}))];case 1:k=ge.sent();(L=new g.ItemResolver).resolveItems({items:(he={},he[x]=n.__assign(n.__assign({},l.defaultChildItemSetFacet.pack({itemKey:f})),c.displayNameFacet.pack(y.default.Recent)),he)});A=s.recentGroupKeyFacet.serialize({relativeTime:"today"});O=s.recentGroupKeyFacet.serialize({relativeTime:"yesterday"});M=s.recentGroupKeyFacet.serialize({relativeTime:"thisWeek"});_=s.recentGroupKeyFacet.serialize({relativeTime:"lastWeek"});D=s.recentGroupKeyFacet.serialize({relativeTime:"twoWeeksAgo"});P=s.recentGroupKeyFacet.serialize({relativeTime:"threeWeeksAgo"});H=s.recentGroupKeyFacet.serialize({relativeTime:"lastMonth"});B=s.recentGroupKeyFacet.serialize({relativeTime:"twoMonthsAgo"});j=[];F=[];I=[];q=[];R=[];U=[];z=[];W=[];X="";for(V=0,$=k.documents.items;V<$.length;V++){J=$[V];K=o.recentItemKeyFacet.serialize({mru_id:J.mru_id});Q=J.title,G=J.display_path,Y=void 0===G?[]:G,Z=J.category,ee=J.app,te=J.url,ne=J.type,re=J.time_stamp;ie=new Date(re);switch(w.getRelativeDateBucketByDate(ie)){case w.RelativeDateGroups.today:j.push(K);break;case w.RelativeDateGroups.yesterday:F.push(K);break;case w.RelativeDateGroups.thisWeek:I.push(K);break;case w.RelativeDateGroups.lastWeek:q.push(K);break;case w.RelativeDateGroups.twoWeeksAgo:R.push(K);break;case w.RelativeDateGroups.threeWeeksAgo:U.push(K);break;case w.RelativeDateGroups.lastMonth:z.push(K);break;case w.RelativeDateGroups.twoMonthsAgo:W.push(K);X=w.getMonthString[ie.getMonth()]}se=decodeURIComponent(te);oe={itemFullUrl:se};ue=Q||Y&&Y[Y.length-1]||te||"";ae=C(se),fe=ae.parentItemKey,le=ae.parentItemUrl;L.mapKeys({mappings:(pe={},pe[b.spItemFullUrlKeyFacet.serialize(oe)]=K,pe[b.spItemFullUrlKeyFacet.serialize({itemFullUrl:le})]=fe,pe)});L.resolveItems({items:(de={},de[K]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(ue)),c.fileNameFacet.pack({name:ue,extension:J.extension?""+J.extension:"OneNote"===ee?"one":""})),c.fileSizeFacet.pack(Q?J.file_size:void 0)),c.dateModifiedFacet.pack(new Date(J.time_stamp).getTime())),v.oneNoteFacet.pack("OneNote"===ee?{}:void 0)),i?n.__assign({},m.preferredKeyFacetFacet.pack(b.spItemFullUrlKeyFacet)):{}),b.spItemFullUrlKeyFacet.pack(oe)),c.openUrlFacet.pack(J.url)),u.mruFacet.pack({category:Z,app:ee,url:te,type:ne})),c.canonicalUrlFacet.pack(se)),h.thumbnailFacet.pack(void 0)),c.parentFolderItemFacet.pack({itemKey:fe})),p.getInvalidationFacet().pack()),de[fe]=n.__assign(n.__assign(n.__assign({},c.folderFacet.pack({})),c.canonicalUrlFacet.pack(le)),c.openUrlFacet.pack(le)),de)})}L.resolveItems({items:(ve={},ve[A]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.today)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:j})),ve[O]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.yesterday)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:F})),ve[M]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.thisWeek)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:I})),ve[_]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.lastWeek)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:q})),ve[D]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.twoWeeksAgo)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:R})),ve[P]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.threeWeeksAgo)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:U})),ve[H]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.lastMonth)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:z})),ve[B]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(E.format(r.default.twoMonthsAgo,X))),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:W})),ve)});ce=[];j.length>0&&ce.push(A);O.length>0&&ce.push(O);I.length>0&&ce.push(M);q.length>0&&ce.push(_);R.length>0&&ce.push(D);U.length>0&&ce.push(P);z.length>0&&ce.push(H);W.length>0&&ce.push(B);L.resolveItems({items:(me={},me[f]=n.__assign(n.__assign(n.__assign({},l.childItemsFacet.pack({itemKeys:ce})),p.getInvalidationFacet().forFacet(l.childItemsFacet).thenInvalidate(S.clearCacheIfNotOffline).pack()),l.parentItemFacet.pack({itemKey:x})),me[x]=n.__assign({},p.getInvalidationFacet().forFacet(l.defaultChildItemSetFacet).thenInvalidate(f,l.childItemsFacet).pack()),me)});e(L.execute());return[2]}})})}});function C(e){var t=x.getParentItemUrl(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:b.spItemFullUrlKeyFacet.serialize(n)}}});
define("kKe",["require","exports","fi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupKeyFacet=new n.KeyFacet("recentGroup",{relativeTime:n.stringPart()})});
define("OKe",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mruFacet=new n.Facet("mru")});
define("xKe",["require","exports","lC","CKe","Io"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e,s;return n.__generator(this,function(n){switch(n.label){case 0:e=t(i.readConfiguration({tokenFetcher:r.tokenFetcherConfigurationFacet})).tokenFetcher;return(s=e)?[4,e.getToken("https://officeapps.live.com")]:[3,2];case 1:s=n.sent();n.label=2;case 2:return[2,s]}})})}}t.getAuthToken=s;t.getData=function(e){var t=this,r=e.method,i=e.path,o=e.body;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(s())];case 1:t=n.sent();u=new Headers;o&&u.set("Content-Type","application/json");t&&u.set("Authorization","Bearer "+t);a={headers:u,credentials:"omit",method:r,mode:"cors",cache:"default",body:o?JSON.stringify(o):void 0};return[4,fetch("https://ocws.officeapps.live.com/ocs/v2"+i,a)];case 2:return[4,n.sent().json()];case 3:return[2,n.sent()]}})})}}});
define("CKe",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tokenFetcherConfigurationFacet=new n.Facet("tokenFetcher")});
define("LKe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(n=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.getRelativeDateBucketByDate=function(e){var t=new Date;return(function(e,t){return r(t,e)})(e,t)?n.today:(function(e,t){return r(new Date(t.getTime()-864e5),e)})(e,t)?n.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?n.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?n.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?n.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?n.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?n.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?n.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?n.twoMonthsAgo:""};function r(e,t){return e.toDateString()===t.toDateString()}t.getMonthString=["January","February","March","April","May","June","July","August","September","October","November","December"]});
define("wKe",["require","exports","lC","FKe","Hm","Xo","Rs","Vm","EKe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,l;return n.__generator(this,function(c){t=r.recentRootItemSetKeyFacet.serialize({});(f=new u.ItemResolver).resolveItems({items:(l={},l[i]=n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:t})),o.displayNameFacet.pack(a.default.Recent)),o.parentFolderItemFacet.pack(void 0)),l)});e(f.execute());return[2]})})}})});
define("IKe",["require","exports","lC","MKe","OKe","gKe","xKe","Hm","xo","zm"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemChangePinStateOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,u=e.itemKey,l=e.options.targetPinState,c=r.recentItemKeyFacet.deserialize(u).mru_id;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,h,p;return n.__generator(this,function(d){switch(d.label){case 0:t=e(a.readItem({mru:i.mruFacet},u));r=t&&t.mru;h=n.__assign({mru_id:c,is_pinned:2===l},r||{});return[4,e(o.getData({path:"/recent",method:"POST",body:h}))];case 1:d.sent();e(f.invalidateItems({items:(p={},p[u]=[s.pinStateFacet],p)}));return[2]}})})}})});
define("gKe",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.unpinned=1]="unpinned";e[e.pinned=2]="pinned"})(t.PinState||(t.PinState={}));t.pinStateFacet=new n.Facet("pinState")});
define("DKe",["require","exports","lC","FKe","ih","U8","F8"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return u}});function u(e,t){var i=t.handlers,u=t.itemKey,a=e.demandItemFacet(r.recentRootItemSetKeyFacet,u);if(i&&a){for(var f=[],l=0,c=i;l<c.length;l++){var h=c[l];if(h.key===o.itemPhotoTypeFilterHandler.key)f.push("photo");else if(h.key===o.itemVideoTypeFilterHandler.key)f.push("video");else if(h.key===o.itemFolderTypeFilterHandler.key)f.push("folder");else if(h.key===o.itemOneNoteFilterHandler.key)f.push("onenote");else if(h.key===o.itemNonPhotoTypeFilterHandler.key)f.push("!photo");else if(h.key===o.itemNonVideoTypeFilterHandler.key)f.push("!video");else if(h.key===o.itemNonFolderTypeFilterHandler.key)f.push("!folder");else if(h.key===o.itemNonOneNoteFilterHandler.key)f.push("!onenote");else{var p=s.getExtensionFilterFromFilterHandler(h);p&&f.push(p)}}return{itemKey:r.recentRootItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{filters:f}))}}return{}}});
define("pKe",["require","exports","lC","ih","vKe","mKe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return o}});t.default=t.recentRootItemCommandBarControlHandler;function o(e,t){var r=t.commands;return r?{commands:n.__spreadArrays(r,[i.pinItemsCommand,s.unpinItemsCommand])}:{}}});
define("vKe",["require","exports","r","hKe","_Ke","si"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinItemsCommand={key:new s.Facet("pin").id,name:i.default.pinCommandText,action:n.createElement(r.PinItemsAction,null),iconProps:{iconName:"pin"}}});
define("hKe",["require","exports","lC","r","gKe","bKe","C1","ks","jr","_s","Es"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ChangePinStateAction=o.createItemCacheComponent(function(e,t){for(var o=t.itemKeys,f=t.targetPinState,c=o.length>0,h=0,p=o;h<p.length;h++){var d=p[h],v=e.demandItem({pinState:i.pinStateFacet},d).pinState;if(!v||v===f){c=!1;break}}var m=e.dispatch;return r.createElement(u.Action,n.__assign({isAvailable:c,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){e={targetPinState:f};m(s.changePinState({items:a.makeObject(o,function(){return e})}));return[2]})})}},l.getItemActionEngagement(e,{itemKey:o[0],engagement:{name:"ChangePinState",isIntentional:!0}})))});t.PinItemsAction=o.connectToItemCache(function(){return{targetPinState:2}})(f.withSelectedItems()(t.ChangePinStateAction));t.UnpinItemsAction=o.connectToItemCache(function(){return{targetPinState:1}})(f.withSelectedItems()(t.ChangePinStateAction))});
define("mKe",["require","exports","r","hKe","_Ke","si"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.unpinItemsCommand={key:new s.Facet("unpin").id,name:i.default.unpinCommandText,action:n.createElement(r.UnpinItemsAction,null),iconProps:{iconName:"unpin"}}});
define("dKe",["require","exports","ih","fKe","bL","lKe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateAccessedColumn];function u(e,t){return{columns:o}}});
define("fKe",["require","exports","lC","B_","si"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileTypeIconColumn=n.__assign(n.__assign({},r.fileTypeIconColumn),{key:new i.Facet("fileTypeIconColumn").id,minWidth:32,maxWidth:32})});
define("lKe",["require","exports","lC","e9","si","uKe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateAccessedColumn=n.__assign(n.__assign({},r.dateModifiedColumn),{name:s.default.lastAccessedColumnHeaderText,key:new i.Facet("dateAccessedColumn").id,minWidth:200})});
define("aR",["require","exports","lC","r","dN","ku","Ec","_s","Rs","p_","oc","SPListItemsScopeDeferred_IS_mini_css","DR","sR","Vs","Es","Hs","oR","E","wo","YD","Zo","C1","ce","rR","Xo","iR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";c=c.FileHoverCard_module_7;Object.defineProperty(t,"__esModule",{value:!0});var k=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._dynamicCompactCardHeight=function(e){n.state.compactCardHeight!==e&&n.setState({compactCardHeight:e})};n._dynamicExpandedCardHeight=function(e){var t=n.state.expandedCardHeight;e&&t!==e&&n.setState({expandedCardHeight:e})};n.state={visible:!1,expandedCardHeight:1,compactCardHeight:131};n._isFirstTimeOpenCard=!0;return n}t.prototype.componentDidCatch=function(e,t){this._hoverCardRenderQos&&this._hoverCardRenderQos.end({error:e.name+"_"+e.message,extraData:{stack:e.stack,errorInfo:JSON.stringify(t)},resultCode:e.name,resultType:y.ResultTypeEnum.Failure})};t.prototype.render=function(){var e=this,t=this.props,u=t.itemKey,a=t.cardDismissDelay,y=void 0===a?300:a,w=t.directionalHint,E=void 0===w?s.DirectionalHint.rightTopEdge:w,S=t.gapSpace,x=void 0===S?8:S,N=t.target;if(!u||!N)return null;var C,k,L,A,O,M={expandedCardScroll:c.fileHoverCardExpandedCardHostScroll},_=n.__assign({root:{boxShadow:l.getTheme().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},M),D=new T.FileHoverCardEngagement(this.props.telemetry(m.Engagement));return r.createElement(o.WithItemCache,null,function(t){var n=t.itemCache;if(e.state.visible){var s=e._demandFacets(n),o=s.itemAnalyticsKey,a=s.keyPointsData,l=s.itemName,c=s.recommendedActions,m=s.conversations,w=s.viewActivities,S=s.relatedItemKeys,T=n.isItemFacetResolved(f.viewCountFacet,o),M=n.isItemFacetResolved(b.errorFacet,o),P=M?n.demandItemFacet(b.errorFacet,o):void 0;e._errorMessage=P&&P.message;e._isViewCountDataError=M&&!T;C=h.isKeyPointsAvailable(a);k=!!l&&h.isRecommendedActionsAvailable(l.extension,c);L=h.isConversationsAvailable(m);A=h.shouldShowActivities(w);O=h.isRelatedFilesAvailable(S);if(n.demandItemFacet(b.errorFacet,u,{suppressGetItems:!0}))return null}var H=v.getItemEngagement(n,{itemKey:u,engagement:{isIntentional:!0}});D.engagementData=H;var B={onRenderCompactCard:function(){return r.createElement(p.CompactCard,{itemKey:u,target:N,updateCardHeight:e._dynamicCompactCardHeight})},onRenderExpandedCard:function(){return r.createElement(h.ExpandedCard,{itemKey:u,target:N,onCardExpand:function(t){return e._onCardExpand(t,H)}})},compactCardHeight:e.state.compactCardHeight,expandedCardHeight:e.state.expandedCardHeight,directionalHint:E,directionalHintFixed:!1,gapSpace:x,styles:_};return r.createElement(d.TelemetryProvider,{withContext:{component:"FileHoverCard"}},r.createElement(g.EngagementContext.Provider,{value:D},r.createElement(i.HoverCard,{expandingCardProps:B,cardDismissDelay:y,expandedCardOpenDelay:500,target:e.props.target,onCardVisible:function(){return e._onCardOpen(H)},onCardHide:function(){return e._onCardHide(H,C,k,L,A,O)},trapFocus:!0})))})};t.prototype._demandFacets=function(e){var t,n=e.demandItemFacet(a.analyticsItemFacet,this.props.itemKey),r=n&&n.itemKey,i=e.demandItemFacet(f.keyPointsFacet,r),s=e.demandItemFacet(a.fileNameFacet,this.props.itemKey),o=e.demandItemFacet(f.recommendedActionsFacet,r),u=e.demandItemFacet(f.conversationsFacet,r),l=e.demandItemFacet(f.activitiesFacet,r),c=l&&l.filter(function(e){return void 0!==e.access});if(C.isRelatedFilesApiCallEnabled()){var h=e.demandItemFacet(a.relatedFilesItemSetFacet,this.props.itemKey),p=e.demandItemFacet(N.childItemsFacet,h&&h.itemKey);t=p&&p.itemKeys}return{analyticsKey:n,itemAnalyticsKey:r,keyPointsData:i,itemName:s,recommendedActions:o,conversations:u,activities:l,viewActivities:c,relatedItemKeys:t}};t.prototype._onCardOpen=function(e){var t=this;if(!x.Killswitch.isActivated("b0d3df87-b7df-4431-a2ed-e94568d478c9","12/17/2019","Pre-fetch file card API calls")){var r=this.props.itemCacheDispatch;r(w.demandItems(function(e){return t._demandFacets(e)},{flushOperationQueue:!0}));r(E.forceStoreUpdate())}this.props.telemetry(m.Engagement).logData(n.__assign({name:"FileHoverCard.CompactCardOpen"},e));this._cardOpenTimeStamp=Date.now();this.setState({visible:!0});this._isFirstTimeOpenCard&&(this._hoverCardRenderQos=new(this.props.telemetry(y.Qos))({name:"ItemScope_FileHoverCardRender"}))};t.prototype._onCardHide=function(e,t,r,i,s,o){var u=Date.now()-this._cardOpenTimeStamp,a=this.state.expandedCardHeight>1,f=a&&u>2500?"FileHoverCard.DwellTimeLong":"FileHoverCard.DwellTime";this.props.telemetry(m.Engagement).logData(n.__assign(n.__assign({name:f},e),{extraData:n.__assign(n.__assign({},e.extraData),{time:u,compactCardOpen:1===this.state.expandedCardHeight,expandedCardOpen:a,keyPoints:t,recommendedActions:r,conversations:i,viewers:s,relatedFiles:o})}));if(this._isFirstTimeOpenCard){this._hoverCardRenderQos.end({resultType:y.ResultTypeEnum.Success});this._isFirstTimeOpenCard=!1}this.setState({visible:!1})};t.prototype._onCardExpand=function(e,t){this._dynamicExpandedCardHeight(e);if(!this._isCardExpanded&&e>1){this.props.telemetry(m.Engagement).logData(n.__assign({name:"FileHoverCard.ExpandedCardOpen"},t));this._isCardExpanded=!0}if(this._isFirstTimeOpenCard){this._isViewCountDataError?this._hoverCardRenderQos.end({resultType:y.ResultTypeEnum.Failure,resultCode:"NoViewCount",error:this._errorMessage}):this._hoverCardRenderQos.end({resultType:y.ResultTypeEnum.Success});this._isFirstTimeOpenCard=!1}};t.defaultProps={itemKey:""};return t})(r.Component);t.FileHoverCard=S.connectToItemCache()(d.withTelemetry()(k));t.CurrentFileHoverCard=u.withCurrentItem()(t.FileHoverCard)});
define("DR",["require","exports","lC","r","Km","O1","Ps","Ec","Jo","Ym","So","p_","Rs","us","r","VR","BR","RR","SPListItemsScopeDeferred_IS_mini_css","iR","TR","my","WL","wo","CR","i_","oy","am","cR","oR","Vs","Es","Hs","nc","Au","Xo","IR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B){"use strict";y=y.FileHoverCard_module_7;Object.defineProperty(t,"__esModule",{value:!0});t.ExpandedCard=function(e){var t=e.itemKey,i=d.useContext(A.EngagementContext),f=d.useRef(null),m=r.useState(!1),w=m[0],W=m[1],X=r.useState(!0),V=X[0],$=X[1],J=r.useState(!1),K=J[0],Q=J[1],G=r.useState(!0),Y=G[0],Z=G[1],ee=r.useState(!1),te=ee[0],ne=ee[1],re=r.useState(!0),ie=re[0],se=re[1],oe=r.useState(!1),ue=oe[0],ae=oe[1],fe=r.useState(!0),le=fe[0],ce=fe[1],he=r.useState(!1),pe=he[0],de=he[1],ve=r.useState(!0),me=ve[0],ge=ve[1];d.useEffect(function(){f.current&&e.onCardExpand(f.current.clientHeight)});function ye(e,t,n,r,s,o){r(!n);if(s){i.logData(e,t);o(!1)}}return d.createElement(u.WithItemCache,null,function(r){var i=r.itemCache,u=(function(e,t){var n,r=e.demandItemFacet(h.analyticsItemFacet,t),i=r&&r.itemKey,s=e.demandItemFacet(c.viewCountFacet,i),o=e.demandItemFacet(c.viewerCountFacet,i),u=e.demandItemFacet(c.isTrendingFacet,i),a=e.demandItemFacet(c.activitiesFacet,i),f=e.demandItemFacet(c.incompleteDataFacet,i),p=e.demandItemFacet(c.keyPointsFacet,i),d=e.demandItemFacet(l.loginUserFacet,l.configurationItemKey),v=e.demandItemFacet(h.fileNameFacet,t),m=a&&a.filter(function(e){return void 0!==e.access}),g=e.demandItemFacet(c.recommendedActionsFacet,i),y=e.demandItemFacet(c.conversationsFacet,i);if(b.isRelatedFilesApiCallEnabled()){var w=e.demandItemFacet(h.relatedFilesItemSetFacet,t),E=e.demandItemFacet(H.childItemsFacet,w&&w.itemKey);n=E&&E.itemKeys}return{analyticsKey:r,itemAnalyticsKey:i,viewCount:s,viewerCount:o,isTrending:u,activities:a,incompleteData:f,keyPointsData:p,loginUser:d,itemName:v,viewActivities:m,actions:g,conversations:y,relatedItemKeys:n}})(i,t),m=u.itemAnalyticsKey,A=u.viewCount,X=u.viewerCount,J=u.isTrending,G=u.incompleteData,ee=u.keyPointsData,re=u.loginUser,oe=u.itemName,fe=u.viewActivities,he=u.actions,ve=u.conversations,be=u.relatedItemKeys,we=N.getLifeCycleSignals(i,t,2,!0),Ee=i.isItemFacetResolved(c.keyPointsFacet,m)&&i.isItemFacetResolved(c.recommendedActionsFacet,m)&&i.isItemFacetResolved(c.conversationsFacet,m)&&(!b.isRelatedFilesApiCallEnabled()||i.isItemFacetResolved(h.relatedFilesItemSetFacet,t)),Se=i.isItemFacetResolved(x.errorFacet,m),xe=j(ee),Te=oe&&t&&F(oe.extension,he),Ne=I(ve),Ce=q(fe),ke=R(be),Le={keyPoints:xe,recommendedActions:!!Te,conversations:Ne,viewers:!!Ce,relatedFiles:ke};if(Ee||Se)return d.createElement("div",{ref:f,className:p.css(y.fileHoverCardExpandedCard,{isFluent:!0})},!!(re&&t&&m)&&we.map(function(e){return(function(e,t,r,i,u){var f,l=n.__assign({},a.selectedItemsControl.pack(function(){return{itemKeys:[r]}})),p=u.demandItemFacet(E.hoverCardCommandsControl,r),v=E.hoverCardCommandsControl.evaluate(p)(u,{itemKey:r}),m=v.checkInAction,y=v.undoCheckOutAction,b=v.policyTipAction,w=v.addMetadataAction,x={checkIn:m,undoCheckOut:y,viewPolicyTip:b,addMetadata:w},T=u.demandItemFacet(c.createdByPersonFacet,i),N=u.demandItemFacet(c.createdDateTimeFacet,i);if(T){var k=u.demandItem({displayName:h.displayNameFacet,email:C.emailFacet,image:C.pictureFacet,id:C.sipFacet},T.itemKey);f={email:k.email||"",displayName:k.displayName||"",image:k.image||"",id:k.id||""}}var L=u.demandItemFacet(S.hoverCardLifeCycleStatusControl,r),A=S.hoverCardLifeCycleStatusControl.evaluate(L)(u,{itemKey:r,signalData:e}).onRenderLifeCycleSignal,D=O.getTelemetry(u).telemetry,P=M.getItemEngagement(u,{itemKey:r,engagement:{isIntentional:!0}});return d.createElement(s.ControlHandlerProvider,{controlHandlers:l},d.createElement(o.WithActionSet,{actions:x},function(r){var i=r.actions,s=i.checkIn,o=i.undoCheckOut,u=i.viewPolicyTip,a=i.addMetadata;return d.createElement(g.AnalyticsLifeCycle,{lifeCycleSignalData:e,createdBy:f,createdDateTime:N,loginUserEmail:t.userLoginName,userEmail:t.userEmail,onViewPolicyTip:function(){D(_.Engagement).logData(n.__assign({name:"FileHoverCard.LifeCycle.ViewPolicyTip"},P));u&&u.execute()},onAddMetadataNow:function(){D(_.Engagement).logData(n.__assign({name:"FileHoverCard.LifeCycle.AddMetadata"},P));a&&a.execute()},onCheckIn:s&&s.isAvailable?function(){D(_.Engagement).logData(n.__assign({name:"FileHoverCard.LifeCycle.FileCheckIn"},P));s&&s.execute()}:void 0,onDiscardCheckOut:o&&o.isAvailable?function(){D(_.Engagement).logData(n.__assign({name:"FileHoverCard.LifeCycle.DiscardCheckOut"},P));o&&o.execute()}:void 0,onRenderLifeCycleSignal:A})}))})(e,re,t,m,i)}),d.createElement("div",{className:y.fileHoverCardExpandedCardScrollableSection},b.isCollapsedSectionsEnabled()&&d.createElement("div",{className:y.collapsedFileCardTooltip},d.createElement(P.TooltipHost,{content:L.default.CollapsedFileCardTooltip},d.createElement(D.Icon,{iconName:"info"}))),!!(xe&&ee&&t)&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.insideLook,menuIconProps:{iconName:w?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.KeyPointsExpanded",Le,w,W,V,$)}}),w&&U(i,{keyPointsData:ee,itemKey:t})):U(i,{keyPointsData:ee,itemKey:t})),Te&&m&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:xe?{}:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.RecommendedActionTitle,menuIconProps:{iconName:K?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.RecommendedActionsExpanded",Le,K,Q,Y,Z)}}),K&&z(i,{target:e.target,itemKey:t,itemAnalyticsKey:m})):z(i,{target:e.target,itemKey:t,itemAnalyticsKey:m})),b.isRelatedFilesSectionEnabled()&&be&&ke&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:xe||ke?{}:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.RelatedFilesTitle,menuIconProps:{iconName:pe?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.RelatedFilesExpanded",Le,pe,de,me,ge)}}),pe&&d.createElement(B.RelatedFiles,{relatedFilesKeys:be,itemKey:t})):d.createElement(B.RelatedFiles,{relatedFilesKeys:be,itemKey:t})),ve&&re&&Ne&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:xe||Te?{}:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.ConversationsTitle,menuIconProps:{iconName:te?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.ConversationsExpanded",Le,te,ne,ie,se)}}),te&&d.createElement(T.Conversations,{conversations:ve,loginUserEmail:re.userLoginName,userEmail:re.userEmail})):d.createElement(T.Conversations,{conversations:ve,loginUserEmail:re.userLoginName,userEmail:re.userEmail})),!(!Ce||!re)&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:xe||Te||Ne?{}:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.viewers,menuIconProps:{iconName:ue?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.ViewersExpanded",Le,ue,ae,le,ce)}}),ue&&d.createElement("div",{className:y.fileHoverCardActivitiesSection,style:{borderTop:0}},d.createElement(v.AnalyticsActivityList,{itemAnalytics:{activities:fe||[],viewCount:A,viewerCount:X,isTrending:J,incompleteData:G},loginUserEmail:re.userLoginName,userEmail:re.userEmail}))):d.createElement("div",{className:y.fileHoverCardActivitiesSection},d.createElement(v.AnalyticsActivityList,{itemAnalytics:{activities:fe||[],viewCount:A,viewerCount:X,isTrending:J,incompleteData:G},loginUserEmail:re.userLoginName,userEmail:re.userEmail})))))})};function j(e){var t=e&&e.readTime&&e.readTime.minutes;return!!(e&&e.keyPoints&&e.keyPoints.length>0)||!!t}t.isKeyPointsAvailable=j;function F(e,t){return Boolean(t&&t.length>0)&&b.isRecommendedActionsSupported(void 0,e)}t.isRecommendedActionsAvailable=F;function I(e){return Boolean(e&&e.length>0)}t.isConversationsAvailable=I;function q(e){return Boolean(e&&e.length>=1)}t.shouldShowActivities=q;function R(e){return Boolean(e&&e.length>0)}t.isRelatedFilesAvailable=R;function U(e,t){var n=t.keyPointsData,r=t.itemKey,i=e.demandItemFacet(E.hoverCardCommandsControl,r),s=E.hoverCardCommandsControl.evaluate(i)(e,{itemKey:r}),u={showKeyPoints:s.showKeyPointsPane,showFeedback:s.showFeedbackPane};return d.createElement(o.WithActionSet,{actions:u},function(e){var t=e.actions,r=t.showKeyPoints,i=t.showFeedback,s=r&&r.isAvailable?r.execute:void 0,o=i&&i.isAvailable?i.execute:void 0;return d.createElement(m.AnalyticsKeyPoints,{keyPointsData:n,onKeyPointsClick:s,onSendFeedbackClick:o})})}function z(e,t){var n=t.target,r=t.itemKey,u=t.itemAnalyticsKey,a=e.demandItemFacet(c.recommendedActionsFacet,u),p=b.isLowActivityTidbitEnabled()&&e.demandItemFacet(c.recommendedPeopleFacet,u)||[],v=e.demandItemFacet(h.openUrlFacet,r),m=e.demandItemFacet(c.activitiesFacet,u),g=e.demandItemFacet(l.loginUserFacet,l.configurationItemKey),y=m&&m.filter(function(e){return void 0!==e.edit}),S=e.demandItemFacet(E.hoverCardCommandsControl,r),x=E.hoverCardCommandsControl.evaluate(S)(e,{itemKey:r}).onDismiss;return d.createElement(s.ControlHandlerProvider,{controlHandlers:f.shareActionControl.pack(function(){return{defaultRecipients:p?p.map(function(e){return e.email}):[]}})},d.createElement(o.WithAction,{action:d.createElement(i.ItemShareAction,{itemKey:r})},function(e){var t=e.execute;return a&&x&&d.createElement(w.RecommendedActions,{actions:{recommendedActions:a,shareWith:p,editActivities:y},loginUserEmail:g&&g.userLoginName,userEmail:g&&g.userEmail,pageUrl:v,onDismiss:x,onShareWith:function(e,r){e.target=n;e.persist();t({event:e})}})}))}});
define("VR",["require","exports","lC","r","sd","Zd","oN","fR","fR","SPListItemsScopeDeferred_IS_mini_css","iN","zR","Y"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";f=f.AnalyticsActivityList_module_2;Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()};t.prototype.render=function(){return r.createElement(s.Spinner,{size:s.SpinnerSize.large})};return t})(r.Component),d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCell=function(e,t){return e&&e.activity&&r.createElement("div",{className:f.analyticsActivityListActivity},r.createElement(o.AnalyticsActivity,{activity:e.activity,loginUserEmail:n.props.loginUserEmail,userEmail:n.props.userEmail,imageInitials:e.imageInitials,initialsColor:e.initialsColor}),n.props.moreActivities&&t===n.state.items.length-1?r.createElement(p,{onLoaded:n.props.onLoadMoreActivities}):void 0)};n.state={items:t.itemAnalytics&&t.itemAnalytics.activities.map(function(e){return{activity:e}}),itemAnalyticsData:t.itemAnalytics};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.itemAnalytics){this._updateActivities(e.itemAnalytics);this.props.pageContext&&this._updateAcronyms(e.itemAnalytics)}};t.prototype.render=function(){var e,t=this,n=this.props.showAnalyticsStats,s=void 0===n||n,o=this.state.itemAnalyticsData,f=a.getFileHoverCardStrings();o&&o.incompleteData&&o.incompleteData.wasThrottled&&(e=f.throttledMessage);if(o){l.setListAsFinishedLoading();return r.createElement("div",null,s&&r.createElement(u.AnalyticsStats,{itemAnalytics:o,inComplete:!!e}),this.state.items&&r.createElement(i.List,{items:this.state.items,onRenderCell:this._onRenderCell,onShouldVirtualize:function(){return t.state.items.length>30}}))}return r.createElement(p,null)};t.prototype._updateActivities=function(e){this.setState(function(){return{itemAnalyticsData:e,items:e.activities.map(function(e){return{activity:e}})}})};t.prototype._updateAcronyms=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);if(!this.props.pageContext)return[3,2];t=e.activities.map(function(e){return e.actor.user.displayName});return[4,new c.AcronymAndColorDataSource(this.props.pageContext).getAcronyms(t,{qosName:"ItemAnalyticsListAcronyms"})];case 1:r=n.sent();i=r.reduce(function(e,t){t.text&&(e[t.text]=t);return e},{});this.setState(function(e){return{items:e.items.map(function(e){var t=i[e.activity.actor.user.displayName];return{activity:e.activity,imageInitials:t&&t.acronym,initialsColor:t&&t.color}})}});n.label=2;case 2:return[3,4];case 3:s=n.sent();h.default.logError(s);l.pageError(s);return[3,4];case 4:return[2]}})})};return t})(r.Component);t.AnalyticsActivityList=d});
define("oN",["require","exports","r","gR","PU","pe","fR","cR","kR","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";f=f.AnalyticsActivity_module_8;Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsActivity=function(e){var t=e.activity,l=e.loginUserEmail,c=e.userEmail,h=o.getFileHoverCardStrings(),p="";"Access"===t.activityType?p=h.accessActivity:"Modified"===t.activityType&&(p=h.modifiedActivity);var d=t&&t.actor&&t.actor.user,v=a.isCurrentLoginUser(d&&d.email,l,c)?h.loginUserYou:d&&d.displayName||d&&d.email||u.default.guest,m=n.createElement("div",{className:f.analyticsActivityUserName},v),g=n.createElement("div",{className:f.analyticsActivityUserAction},p),y=h.activityTemplate&&s.formatToArray(h.activityTemplate,m,g),b=i.PersonaSize.size24;return n.createElement(r.ActivityItem,{activityPersonas:[{imageUrl:d.image,imageAlt:v,imageInitials:e.imageInitials,initialsColor:e.initialsColor,size:b}],activityDescription:n.createElement("div",{dir:"auto",className:f.analyticsActivity},y),timeStamp:t.activityDateTime,styles:{root:{alignItems:"center"},activityContent:{padding:"0 12px"},personaContainer:{width:"24px",height:"24px"}}})}});
define("fR",["require","exports","r","pd","gR","lR","nc","oc","cR","pe","Au","bR","SPListItemsScopeDeferred_IS_mini_css","pR","us"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";h=h.AnalyticsStats_module_2;Object.defineProperty(t,"__esModule",{value:!0});var v=new Date("0001-01-01T00:00:00-08:00");t.AnalyticsStats=function(e){var t,d=e.itemAnalytics,b=e.onClick,w=e.onLikeClick,E=e.pageUrl,S=e.isLink,x=e.status,T=e.isCompact,N=e.disableViewerCount,C=void 0===N||N,k=e.ODBOptOutViewerList,L=void 0!==k&&k,A=e.itemKey,O=y();if(x===s.AnalyticsResultStatus.failed){var M=u.getTheme();t=O.apiError&&g("ErrorBadge",O.apiError,{color:M.palette.redDark})}if(t)return null;if(!d||!d.viewCount||!d.viewerCount)return n.createElement(i.ActivityItem,{className:h.analyticsStats,isCompact:!0});var _=d.viewCount,D=d.viewerCount,P=d.activities,H=d.commentCount,B=d.likeCount,j=d.incompleteData&&d.incompleteData.missingDataBeforeDateTime&&new Date(d.incompleteData.missingDataBeforeDateTime).getTime()!==v.getTime(),F=d.incompleteData&&d.incompleteData.wasThrottled,I=j?a.default.inCompleteMessage:F?a.default.throttledStateMessage:"",q=C?L?a.default.odbTeachingMessage:"":a.default.spoTeachingMessage,R=I||q,U=_>1?O.views:O.view,z=D>1?O.viewers:O.viewer,W=H&&H>1?O.comments:O.comment,X=B&&B>1?O.likes:O.like,V=H?""+f.format(W,H):"",$=B?""+f.format(X,B):"",J=c.isLikePanelEnabled()?w:void 0,K=c.isCommentLinkEnabled()?E:void 0,Q=$&&m($,J),G=V&&m(V,void 0,K);return T?S?n.createElement("div",{className:h.analyticsStatsContainer},n.createElement(r.Link,{className:h.analyticsStatsLink,onClick:b},n.createElement(i.ActivityItem,{activityPersonas:P&&0!==P.length?P.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():void 0,activityDescription:n.createElement("div",{className:h.analyticsStatsLabel},_&&n.createElement("div",{className:h.analyticsStatsCount},_+" "+U)),isCompact:!0})),$&&A?n.createElement(p.SocialBarLikeLink,{likeLabel:$,itemKey:A}):Q,G):n.createElement("div",{className:h.analyticsStatsContainer},m(_+" "+U,void 0),m(D+" "+z,void 0),R&&n.createElement(l.TooltipHost,{content:R,directionalHint:l.DirectionalHint.bottomCenter},n.createElement(o.Icon,{className:h.analyticsStatsTeachingMessage,iconName:"Info","aria-describedby":R})),Q,G):n.createElement("div",{className:h.analyticsStatsViews},D+" "+z,n.createElement("span",{className:h.analyticsStatsViewsDivider}),_+" "+U,I&&n.createElement(l.TooltipHost,{content:I,directionalHint:l.DirectionalHint.bottomCenter},n.createElement(o.Icon,{className:h.analyticsStatsInfo,iconName:"Info","aria-describedby":I})))};t.AnalyticsStats.defaultProps={isLink:!1};function m(e,t,s){var o=n.createElement(i.ActivityItem,{activityDescription:n.createElement("div",{className:d.css(h.analyticsStatsLabel,h.analyticsStatsCount)},e),isCompact:!0});return t||s?n.createElement(r.Link,{className:h.analyticsStatsLink,href:s+"#comments",target:"_blank",onClick:t},o):n.createElement("div",{className:h.analyticsStatsNoLink},o)}function g(e,t,r){return n.createElement(n.Fragment,null,n.createElement(o.Icon,{iconName:e,className:h.fileHoverCardErrorIcon,styles:{root:u.mergeStyles([{paddingRight:"8px",position:"relative"},r])}}),t)}t.getMessageSection=g;function y(){return{details:a.default.seeDetails,viewer:a.default.viewer,viewers:a.default.viewers,view:a.default.view,views:a.default.views,comment:a.default.pageComment,comments:a.default.pageComments,like:a.default.pageLike,likes:a.default.pageLikes,apiError:a.default.apiError,suggestion:a.default.suggestion,unsupportMessage:a.default.unsupportMessage,accessActivity:a.default.accessActivity,modifiedActivity:a.default.modifiedActivity,activityTemplate:a.default.activityTemplate,inCompleteDataMessage:a.default.inCompleteDataMessage,throttledMessage:a.default.throttledMessage,trendingItem:a.default.trendingItem,loginUserYou:a.default.you}}t.getFileHoverCardStrings=y});
define("lR",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.succeed=0]="succeed";e[e.unsupport=1]="unsupport";e[e.failed=2]="failed"})(t.AnalyticsResultStatus||(t.AnalyticsResultStatus={}))});
define("bR",["require","exports","be"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ODB:1305},i={ODB:1306};t.isCommentLinkEnabled=function(){return n.default.isFeatureEnabled(r)};t.isLikePanelEnabled=function(){return n.default.isFeatureEnabled(i)}});
define("pR",["require","exports","lC","r","pd","gR","Ps","_R","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a){"use strict";a=a.SocialBar_2;Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,f=r.createElement(s.ActivityItem,{activityDescription:t,isCompact:!0});return r.createElement(o.WithAction,{action:r.createElement(u.ShowSocialBarAction,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,s=t?function(){n().catch(function(){})}:void 0;return r.createElement(i.Link,{disabled:!1,className:a.analyticsStatsLink,onClick:s},f)})};return t})(r.Component);t.SocialBarLikeLink=f});
define("_R",["require","exports","lC","r","_s","Ps","ks","tv","Es","C1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["bVe"],t,n)})];case 1:return[2,t.sent().default]}})})});t.ShowSocialBarAction=f.createItemCacheComponent(function(e,t){var i=t.itemKey,u=s.renderComponentOnExecute(function(e){return r.createElement(l,n.__assign({},e,{itemKey:i}))},{scope:"global"});return r.createElement(o.Action,n.__assign({onExecute:u},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"SocialBar",isIntentional:!0}})))});t.CurrentShowSocialBarAction=i.withOnlyCurrentItem()(t.ShowSocialBarAction)});
define("kR",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isCurrentLoginUser=function(e,t,n){var r=e&&e.toLowerCase(),i=t&&t.toLowerCase(),s=n&&n.toLowerCase();return!(r!==i&&r!==s)}});
define("iN",["require","exports","E"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!1,i=!1;t.setListAsFinishedLoading=function(){if(!i){i=!0;s()}};function s(){if(!r&&i){r=!0;new n.default({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:n.ResultTypeEnum.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}}}t.pageFinishedLoading=s;t.pageError=function(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}});
define("BR",["require","exports","lC","r","us","am","nc","Au","sd","am","sf","cR","pe","oR","SPListItemsScopeDeferred_IS_mini_css","iR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";d=d.AnalyticsKeyPoints_module_6;Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(e){n.context.logData("FileHoverCard.KeyPoints.Click");n.props.onKeyPointsClick&&n.props.onKeyPointsClick(e)};n._onClickMoreIcon=function(e){n._moreIconElement=e.currentTarget;n.setState({showCallout:!0});n.context.logData("FileHoverCard.KeyPoints.ClickMoreIcon")};n.state={showCallout:!1};return n}t.prototype.render=function(){var e=this,t=c.default.insideLookTooltipMessage,n=this.props.keyPointsData;return r.createElement("div",{className:d.fileHoverCardInsideLook,style:v.isCollapsedSectionsEnabled()?{borderTop:0,paddingTop:0}:{}},!v.isCollapsedSectionsEnabled()&&r.createElement("div",{className:d.fileHoverCardInsideLookTitle},r.createElement("div",null,!v.isCollapsedSectionsEnabled()&&c.default.insideLook,r.createElement(u.TooltipHost,{content:t,directionalHint:l.DirectionalHint.bottomCenter},r.createElement(o.Icon,{iconName:"Info",ariaLabel:t,role:"tooltip",tabIndex:0}))),this._ellipses()),this.state.showCallout&&r.createElement(l.ContextualMenu,{gapSpace:0,isBeakVisible:!0,shouldFocusOnMount:!0,target:this._moreIconElement,onDismiss:function(){return e.setState({showCallout:!1})},directionalHint:i.getRTL()?l.DirectionalHint.bottomLeftEdge:l.DirectionalHint.bottomRightEdge,items:[{key:"sendFeedback",name:c.default.SendUsFeedback,onClick:this.props.onSendFeedbackClick},{key:"editKeyPoints",name:c.default.EditKeyPoints,onClick:this.props.onKeyPointsClick}]}),!(!n||!n.readTime||void 0===n.readTime.minutes)&&r.createElement("div",{className:d.fileHoverCardReadTimeContainer,style:v.isCollapsedSectionsEnabled()?{justifyContent:"space-between"}:{}},r.createElement("div",{className:d.fileHoverCardReadTime},r.createElement(o.Icon,{className:d.fileHoverCardReadTimeIcon,iconName:"Clock","aria-describedby":t}),this._timeToReadMessage(n.readTime.minutes)),v.isCollapsedSectionsEnabled()&&this._ellipses()),n&&n.keyPoints&&n.keyPoints.length>0&&(this.props.onKeyPointsClick?r.createElement(s.Button,{className:d.fileHoverCardKeyPointsButton,onClick:this._onClick,styles:{flexContainer:{flexWrap:"wrap"}}},this._keyPointsContent(n)):r.createElement("div",{className:d.fileHoverCardKeyPointsNonButton},this._keyPointsContent(n))))};t.prototype._keyPointsContent=function(e){return r.createElement(r.Fragment,null,r.createElement("div",{className:d.fileHoverCardKeyPointsAction},c.default.keyPointsTitle),r.createElement(a.List,{renderCount:3,items:e.keyPoints,onRenderCell:this._onRenderCell,className:d.fileHoverCardKeyPointsContent}))};t.prototype._onRenderCell=function(e){return e&&r.createElement("div",{className:d.fileHoverCardKeyPointsCell},r.createElement("div",{className:d.fileHoverCardKeyPointsBullet}),r.createElement("div",{dir:"auto",className:d.fileHoverCardKeyPointsText},e.text))};t.prototype._ellipses=function(){return this.props.onSendFeedbackClick&&r.createElement(f.IconButton,{iconProps:{iconName:"More"},onClick:this._onClickMoreIcon,ariaLabel:c.default.MoreOptions,style:{marginTop:"2px"}})};t.prototype._timeToReadMessage=function(e){if(0===e)return c.default.timeToReadInZero;if(e>60){var t=h.getLocalizedCountValue(c.default.timeToReadInHours,c.default.timeToReadInHoursIntervals,Math.floor(e/60));return t&&h.format(t,Math.floor(e/60))}return h.format(c.default.timeToReadInMinutes,e)};return t})(r.Component);t.AnalyticsKeyPoints=m;m.contextType=p.EngagementContext});
define("oR",["require","exports","r","rR"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EngagementContext=n.createContext(new r.FileHoverCardEngagement)});
define("rR",["require","exports","lC","Hs"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){this._engagementData={};this._engagement=e||r.Engagement}Object.defineProperty(e.prototype,"engagementData",{set:function(e){this._engagementData=e},enumerable:!0,configurable:!0});e.prototype.logData=function(e,t){this._engagement.logData(n.__assign(n.__assign({name:e},this._engagementData),{extraData:n.__assign(n.__assign({},this._engagementData.extraData),t)}))};return e})();t.FileHoverCardEngagement=i});
define("RR",["require","exports","r","pd","pe","kR","cR","SPListItemsScopeDeferred_IS_mini_css","i_","L7","Du"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";u=u.AnalyticsLifeCycle_module_8;Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsLifeCycle=function(e){var t,n,r,u,h,p,d=e.lifeCycleSignalData,v=e.loginUserEmail,m=e.userEmail,g=e.createdBy,y=e.createdDateTime,b=e.onRenderLifeCycleSignal,w=d.signal;switch(d.key){case a.malwareSignalKey:t=o.default.malwareDetected;n="https://go.microsoft.com/fwlink/?linkid=862871";h=o.default.learnMore;break;case a.youCheckedOutSignalKey:t=o.default.youHaveThisCheckedOut;r=e.onCheckIn;u=e.onDiscardCheckOut;h=e.onCheckIn?o.default.checkIn:void 0;p=e.onDiscardCheckOut?o.default.discardCheckOut:void 0;break;case a.someoneCheckedOutSignalKey:t=d.title;break;case a.dlpBlockedSignalKey:t=o.default.DLPBlocked;r=e.onViewPolicyTip;h=o.default.viewPolicyTip;break;case a.missingMetadataSignalKey:t=o.default.missingMetaData;r=e.onAddMetadataNow;h=o.default.addMetaData;break;case a.dlpWarningSignalKey:t=o.default.DLPWarning;r=e.onViewPolicyTip;h=o.default.viewPolicyTip;break;case a.trendingSignalKey:t=d.title;break;case a.newSignalKey:var E=y&&f.getFriendlyDateTimeStringPast(new Date(y));t=g&&g.email&&s.isCurrentLoginUser(g.email,v,m)?i.format(o.default.youCreated,E):i.format(o.default.otherCreated,E,g&&g.displayName);break;default:w=null}return(b?l.composeRenderFunctions(b,c):c)({signal:w,content:t,action:r,actionName:h,secondaryAction:u,secondaryActionName:p,link:n})};function c(e){return e&&e.signal?n.createElement("div",{className:u.fileHoverCardLifeCycle},e.signal,n.createElement("div",{className:u.fileHoverCardLifeCycleMessage},e.content&&n.createElement("div",{className:u.fileHoverCardLifeCycleTitle},e.content),(e.action||e.link)&&n.createElement(r.Link,{className:u.fileHoverCardLifeCycleAction,href:e.link,target:e.link&&"_blank",onClick:e.action},e.actionName),e.secondaryAction&&" "+o.default.Or+" ",e.secondaryAction&&n.createElement(r.Link,{className:u.fileHoverCardLifeCycleAction,onClick:e.secondaryAction},e.secondaryActionName))):null}});
define("TR",["require","exports","lC","r","nc","am","pd","gR","Au","L7","pe","we","FR","SPListItemsScopeDeferred_IS_mini_css","cR","iR","oR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";p=p.RecommendedActions_module_4;Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._recommendedAction=function(e,t){var c=f.getFriendlyDateTimeStringPast(f.iso8601DateTimeToJsDate(e.activityTimestamp)),h="",v="",m="";switch(e.recommendationEventType){case"Mentioned":h="Accounts";m=l.formatToArray(d.default.MentionMessage,n._userNameJSX(e.actorDisplayName));v=d.default.Reply;break;case"Edited":h="Edit";m=d.default.EditMessage;v=d.default.OpenToRead;var g=e.importantActorsAndActivities[0],y=g&&g.activityTimestamp;c=y&&f.getFriendlyDateTimeStringPast(f.iso8601DateTimeToJsDate(y));var b=e.importantActorsAndActivities.map(function(e){return e.actorDisplayName});m=1===b.length?l.formatToArray(d.default.OnePersonEditMessage,n._userNameJSX(b[0])):2===b.length?l.formatToArray(d.default.TwoPersonEditMessage,n._userNameJSX(b[0]),n._userNameJSX(b[1])):l.formatToArray(d.default.EditMessage,n._userNameJSX(b[0]),n._userNameJSX(b[1]),e.recentEditorCount-2);break;case"Commented":h="Chat";m=l.formatToArray(d.default.CommentMessage,n._userNameJSX(e.actorDisplayName));v=d.default.View}return r.createElement("div",{key:t},r.createElement("div",{className:p.fileHoverCardRecommendedAction},r.createElement(u.ActivityItem,{activityIcon:r.createElement(i.Icon,{iconName:h,className:p.fileHoverCardRecommendedIcon}),activityDescription:r.createElement("div",{className:p.fileHoverCardRecommendedMessage},m),timeStamp:c}),r.createElement(a.TooltipHost,{content:d.default.Dismiss,directionalHint:a.DirectionalHint.topCenter},r.createElement(s.IconButton,{className:p.fileHoverCardCancelIcon,iconProps:{iconName:"Cancel"},onClick:function(){return n._handleClickDismiss(t)}}))),r.createElement(o.Link,{className:p.fileHoverCardRecommendedLink,href:n._getNavLink(e.navigationId),target:"_blank",onClick:function(){n.context.logData("FileHoverCard.RecommendedActions."+e.recommendationEventType,{})}},v))};n._getNavLink=function(e){if(n.props.pageUrl&&e){var t=new c.default(n.props.pageUrl);t.setQueryParameter("nav",e);t.setQueryParameter("commentId",e);return t.toString()}return n.props.pageUrl};n._recommendedActionRef=function(e){var t=n.state.recommendedActions;n.context.logData("FileHoverCard.RecommendedActions.Render",{activityType:t&&t.length>0?"HighActivities":"LowActivities"})};n.state={recommendedActions:n.props.actions.recommendedActions};return n}t.prototype.render=function(){var e=this.state.recommendedActions,t=v.isLowActivityTidbitEnabled()&&this.props.actions.shareWith&&this.props.actions.shareWith.length>=2;return(e&&e.length>0||t)&&r.createElement("div",{ref:this._recommendedActionRef,className:p.fileHoverCardRecommendedSection,style:v.isCollapsedSectionsEnabled()?{borderTop:0}:{}},!v.isCollapsedSectionsEnabled()&&r.createElement("div",{className:p.fileHoverCardRecommendedTitle},d.default.RecommendedActionTitle),e&&e.length>0?e.slice(0,3).map(this._recommendedAction):r.createElement(h.LowActivity,{item:this.props.item,shareWith:this.props.actions.shareWith,editActivities:this.props.actions.editActivities,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onShareWith:this.props.onShareWith,onRenderShareWithPeople:this.props.onRenderShareWithPeople}))};t.prototype._userNameJSX=function(e){return r.createElement("span",{className:p.fileHoverCardUserName},e)};t.prototype._handleClickDismiss=function(e){this.context.logData("FileHoverCard.RecommendedActions.Dismiss",{recommendedActionId:this.state.recommendedActions[e].recommendationId});this.props.onDismiss(this.state.recommendedActions[e].recommendationId,e);this.state.recommendedActions.splice(e,1);this.setState({recommendedActions:this.state.recommendedActions})};return t})(r.Component);t.RecommendedActions=g;g.contextType=m.EngagementContext});
define("FR",["require","exports","lC","r","nc","gR","pd","pe","kR","cR","SPListItemsScopeDeferred_IS_mini_css","HR"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";l=l.RecommendedActions_module_4;Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._handleClickShare=function(e){var n=t.props.shareWith&&t.props.shareWith.slice(0,2).map(function(e){return e.email});t.props.onShareWith(e,n);c.default("FileHoverCard.RecommendedActions.ShareWith",t.props.item)};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.editActivities,a=t.shareWith,c=this.props.shareWith&&this.props.shareWith.slice(0,2).map(function(e){return e.email});return a&&a.length>=2&&r.createElement(r.Fragment,null,r.createElement("div",{className:l.fileHoverCardShareWith},u.formatToArray(f.default.ShareWithMessage,this._userNameJSX(a[0].displayName),this._userNameJSX(a[1].displayName))),this.props.onRenderShareWithPeople?r.createElement("div",{className:l.fileHoverCardShareWithLink},this.props.onRenderShareWithPeople(c)):r.createElement(o.Link,{className:l.fileHoverCardShareWithLink,onClick:this._handleClickShare},f.default.ShareWithThem),n&&n.map(function(t,n){return n<2&&r.createElement(s.ActivityItem,{key:n,activityIcon:r.createElement(i.Icon,{iconName:"Edit",className:l.fileHoverCardRecommendedIcon}),onRenderActivityDescription:function(){return e._onRenderActivityDescription(t)},timeStamp:t.activityDateTime})}))};t.prototype._onRenderActivityDescription=function(e){var t=e&&e.actor&&e.actor.user,n=a.isCurrentLoginUser(t&&t.email,this.props.loginUserEmail,this.props.userEmail)?f.default.you:e.actor.user.displayName;return r.createElement("div",{className:l.fileHoverCardActivity},u.formatToArray(f.default.LowActivities,this._userNameJSX(n)))};t.prototype._userNameJSX=function(e){return r.createElement("div",{key:e,className:l.fileHoverCardUserName},e)};return t})(r.Component);t.LowActivity=h});
define("HR",["require","exports","lC","Ih"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,i){t?r.Engagement.logData({name:e,isIntentional:!0,extraData:n.__assign({itemId:t.itemId,driveId:t.graph&&t.graph.driveId,fileExtension:t.extension,fileType:t.appMap},i)}):r.Engagement.logData(n.__assign({name:e},i))}});
define("CR",["require","exports","lC","r","gR","PR","nc","L7","SPListItemsScopeDeferred_IS_mini_css","cR","kR","pe","Qe","OR","iR","oR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";a=a.Conversations_module_6;Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._conversation=function(e,n){var s=t._context(e),f=e.deepLink,l=t._getIconName(e.conversationType),c=t._participants(e),h=e.referencePreview,p=u.getFriendlyDateTimeStringPast(new Date(e.activityTimestamp));return r.createElement("div",{key:n},r.createElement("div",{className:a.fileHoverCardConversation,onClick:function(){var e=window.open(f,"_blank");e&&e.focus();t.context.logData("FileHoverCard.Conversations.ClickDeepLink",{})}},r.createElement(i.ActivityItem,{activityIcon:r.createElement(o.Icon,{iconName:l,className:a.fileHoverCardConversationIcon}),activityDescription:c,comments:r.createElement(r.Fragment,null,s,r.createElement("div",{className:a.fileHoverCardConversationReferencePreview},h)),timeStamp:p})))};return t}t.prototype.render=function(){var e=this.props.conversations;return p.isConversationsExperimentOn()&&r.createElement("div",{className:a.fileHoverCardConversationsSection,style:d.isCollapsedSectionsEnabled()?{borderTop:0}:{}},!d.isCollapsedSectionsEnabled()&&r.createElement("div",{className:a.fileHoverCardConversationsTitle},f.default.ConversationsTitle),e.slice(0,3).map(this._conversation))};t.prototype._context=function(e){var t=e.context,n=r.createElement(r.Fragment,null),i=a.fileHoverCardConversationContext;if(e.conversationType===s.ConversationType.CalendarEvent){t=c.format(f.default.MeetingsConversationsSubject,e.context);n=r.createElement(o.Icon,{iconName:"Event",className:a.fileHoverCardConversationsMeetingIcon});i=a.fileHoverCardMeetingConversationContext}var u=0===t.length?r.createElement(r.Fragment,null):r.createElement("div",{className:i},t);return r.createElement(r.Fragment,null,n,u)};t.prototype._participants=function(e){var t,n=this;t=e.participants.filter(function(t){return t.identity.displayName&&!n._isSharedByUser(t.identity.email,e.sharedByUserEmail,t.identity.displayName,e.sharedByUserDisplayName)}).map(function(e){return l.isCurrentLoginUser(e.identity.email,n.props.loginUserEmail,n.props.userEmail)?f.default.you:e.identity.displayName}).join(", ");var i=e.isSharedByMe?f.default.you:e.sharedByUserDisplayName;return r.createElement("div",{className:a.fileHoverCardConversationParticipants},r.createElement("span",{className:a.fileHoverCardConversationSharedByUser},0===t.length?i:i+", "),t)};t.prototype._isSharedByUser=function(e,t,n,r){return e.toLowerCase()===t.toLowerCase()||n.toLowerCase()===r.toLowerCase()};t.prototype._getIconName=function(e){var t=e===s.ConversationType.CalendarEvent||e===s.ConversationType.Mail?h.getBrandTypeIconProps({extension:"",brand:"outlook"}):h.getBrandTypeIconProps({extension:"",brand:"teams"});if(t)return t.iconName};return t})(r.PureComponent);t.Conversations=m;m.contextType=v.EngagementContext});
define("OR",["require","exports","be","wR"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={ODB:1153,OneDrive:!0};t.isConversationsExperimentOn=function(){if(n.default.isFeatureEnabled(i)){return new r.ABExperiment({name:"ConversationsExperiment",startDate:"11/8/2019"}).IsExperimentOn()}return!0}});
define("IR",["require","exports","r","gR","nc","SPListItemsScopeDeferred_IS_mini_css","cR","Ec","Rs","iR","q_","C1","qf","Ps"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";s=s.RelatedFiles_module_4;Object.defineProperty(t,"__esModule",{value:!0});t.RelatedFiles=function(e){return n.createElement("div",{className:s.fileHoverCardRelatedFilesSection,style:f.isCollapsedSectionsEnabled()?{borderTop:0}:{}},!f.isCollapsedSectionsEnabled()&&n.createElement("div",{className:s.fileHoverCardRelatedFilesTitle},o.default.RelatedFilesTitle),e.relatedFilesKeys.slice(0,3).map(function(e,t){return(function(e,t){return n.createElement(u.WithItemCache,{key:t},function(o){var u,f=o.itemCache,d=f.demandItemFacet(a.displayNameFacet,e),v=(function(e){if(!e)return;var t=l.getFileTypeIconProps({extension:e,size:16});return t?t.iconName:void 0})(null===(u=d)||void 0===u?void 0:u.split(".")[1]),m=c.evaluateItemCacheComponent(f,n.createElement(h.ItemOpenUrlAction,{itemKey:e,engagement:{name:"FileHoverCard.RelatedFiles.ClickDeepLink"}}));return n.createElement(p.WithAction,{action:m},function(e){var o=e.execute;return n.createElement("div",{key:"relatedFile_"+t},n.createElement("div",{className:s.fileHoverCardRelatedFile,onClick:function(){o()}},n.createElement(r.ActivityItem,{activityIcon:n.createElement(i.Icon,{iconName:v,className:s.fileHoverCardRelatedFileIcon}),activityDescription:n.createElement(n.Fragment,null,n.createElement("div",{className:s.fileHoverCardRelatedFilesName},d)),isCompact:!0})))})})})(e,t)}))}});
define("sR",["require","exports","lC","Km","sb","O1","V_","Ps","Ec","Jo","p_","Rs","pe","Hs","us","r","dR","SPListItemsScopeDeferred_IS_mini_css","cR","iR","my","wo","Vs","Es"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";g=g.FileHoverCard_module_7;Object.defineProperty(t,"__esModule",{value:!0});t.CompactCard=function(e){var t=e.itemKey,T=v.useRef(null);v.useEffect(function(){T.current&&e.updateCardHeight(T.current.clientHeight)});return v.createElement(a.WithItemCache,null,function(a){var N,C=a.itemCache,k=C.demandItemFacet(c.fileNameFacet,t),L=k&&k.name,A=k&&k.extension,O=C.demandItemFacet(c.analyticsItemFacet,t),M=O&&O.itemKey,_=v.createElement("div",{className:d.css(g.fileHoverCardCompactCardTitle,(N={},N[g.titleNotExpanded]=!T.current,N)),id:"ms-FileHoverCard-title","aria-label":h.format(y.default.hoverCardTitle,L)},L),D=v.createElement("div",{className:g.fileHoverCardCompactCardTitleRegion},v.createElement(o.FileTypeIcon,{className:g.fileHoverCardCompactCardFileIcon,extension:A,size:32}),_);return v.createElement("div",{ref:T,className:d.css(g.fileHoverCardCompactCard,{isFluent:!0})},D,!(!t||!M)&&(function(e,t,o,a){var h=e.demandItemFacet(l.viewCountFacet,o),d=e.demandItemFacet(l.viewerCountFacet,o),g=e.demandItemFacet(l.likeCountFacet,o),T=e.demandItemFacet(l.commentCountFacet,o),N=e.demandItemFacet(c.openUrlFacet,t),C=e.demandItemFacet(l.activitiesFacet,o),k=C&&C.filter(function(e){return void 0!==e.access}),L=S.getTelemetry(e).telemetry,A=x.getItemEngagement(e,{itemKey:t,engagement:{isIntentional:!0}}),O=e.isItemFacetResolved(l.viewCountFacet,o)||e.isItemFacetResolved(E.errorFacet,o)?{activities:k||[],viewCount:h,viewerCount:d,likeCount:g,commentCount:T}:void 0,M=e.demandItemFacet(w.hoverCardCommandsControl,t),_=w.hoverCardCommandsControl.evaluate(M)(e,{itemKey:t}),D=_.showDetailsPane,P=_.showFileAnalytics,H={showDetails:D,showItemAnalytics:P,shareAction:v.createElement(r.ItemShareAction,{itemKey:t})},B=n.__assign({},f.selectedItemsControl.pack(function(){return{itemKeys:[t]}}));return v.createElement(s.ControlHandlerProvider,{controlHandlers:B},v.createElement(u.WithActionSet,{actions:H},function(e){var r=e.actions,s=r.showDetails,o=r.showItemAnalytics,u=r.shareAction,f=s&&s.execute?function(){L(p.Engagement).logData(n.__assign({name:"FileHoverCard.SeeDetailsClick"},A));s.execute().catch(function(){})}:void 0,l=o&&o.execute?function(){L(p.Engagement).logData(n.__assign({name:"FileHoverCard.ViewCountClick"},A));o.execute().catch(function(){})}:void 0,c=u&&u.isAvailable?function(e){if(e&&a){e.target=a;e.persist();u.execute({event:e});L(p.Engagement).logData(n.__assign({name:"FileHoverCard.CommandBar.ShareClick"},A))}}:void 0,h=n.__spreadArrays(s&&s.isAvailable?[{key:"details",title:y.default.seeDetails,name:y.default.seeDetails,ariaLabel:y.default.seeDetails,onClick:f}]:[]),d={key:"share",iconProps:{iconName:"share"},title:y.default.Share,onClick:c},g={itemAnalytics:O,isCompact:!0,isLink:o&&o.isAvailable,pageUrl:N,onClick:l,itemKey:t},w=[];c&&w.push(d);b.isSaveForLaterOn()&&i.followCommand.action&&i.followCommand.onClick&&w.unshift(n.__assign(n.__assign({},i.followCommand),{iconOnly:!0,name:void 0}));return v.createElement(m.AnalyticsActionBar,{itemKey:t,analyticsStats:g,items:w,withFacePile:!0,farItems:h})}))})(C,t,M,e.target))})}});
define("dR",["require","exports","lC","r","Ig","fR","Rl","SPListItemsScopeDeferred_IS_mini_css","lR","Dg"],function(e,t,n,r,i,s,o,u,a,f){"use strict";u=u.AnalyticsActionBar_module_4;Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsActionBar=function(e){var t=e.items,l=e.farItems,c=e.analyticsStats,h=e.isLink,p=e.showActionBar,d=void 0===p||p,v=!(!c||!c.itemAnalytics&&!c.isNotSupported&&c.status!==a.AnalyticsResultStatus.unsupport&&c.status!==a.AnalyticsResultStatus.failed),m=e.itemKey?r.createElement(f.ActionCommandBar,{className:u.analyticsActionBar,commands:t,farCommands:l}):r.createElement(i.CommandBar,{className:u.analyticsActionBar,items:t,farItems:l});return r.createElement("div",null,r.createElement("div",{className:u.analyticsActionBarStats},r.createElement(o.Shimmer,{width:"35%",isDataLoaded:v,shimmerElements:[{type:o.ShimmerElementType.line,height:8}]},r.createElement(s.AnalyticsStats,n.__assign({isLink:h,isCompact:!0},c)))),d&&(l.length>0||t.length>0)&&m)}});
define("Dg",["require","exports","lC","r","Ig","wm","db","ts","Or","Hn"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=[];t.ActionCommandBar=s.connectToCommandSets(function(e){return{main:e.commands,overflow:e.overflowCommands,far:e.farCommands,shortcut:e.shortcutCommands}},function(e,t){var n=t.items,r=void 0===n?l:n,i=t.overflowItems,s=void 0===i?l:i,u=t.farItems,f=void 0===u?l:u,c=t.shortcutItems,h=void 0===c?l:c;return{items:o.concat(r,e.main),overflowItems:o.concat(s,e.overflow),farItems:o.concat(f,e.far),shortcutItems:o.concat(h,e.shortcut),ariaLabel:a.default.CommandBarAriaLabel}})(function(e){var t=e.items,s=void 0===t?l:t,o=e.farItems,c=void 0===o?l:o,h=e.overflowItems,p=void 0===h?l:h,d=e.shortcutItems,v=void 0===d?l:d,m=e.commandBarAs,g=e.overflowButtonProps,y=void 0===g?{}:g,b=m?f.composeComponentAs(m,i.CommandBar):i.CommandBar,w=(function(e){return e.filter(function(e){return e&&(!!e.shortcutProps||!!e.keytipProps)})})(n.__spreadArrays(s,c,p,v));return r.createElement(r.Fragment,null,r.createElement(b,n.__assign({overflowButtonProps:n.__assign({ariaLabel:a.default.OverflowCommandTooltip,title:a.default.OverflowCommandTooltip},y)},e)),w&&w.length>0&&w.map(function(e){var t=e.shortcutProps||e.keytipProps;return t&&t.keySequences.length>0&&e.onClick?r.createElement(u.KeyboardShortcut,{key:e.key,keySequences:t.keySequences,description:t.content,onExecute:e.onClick}):null}))});t.ActionCommandBar.displayName="ActionCommandBar"});
define("OO",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.aria=e("@ms/aria-private")});
define("HB",["require","exports","lC","Fe","BH","X_","BB","NB","eC","os","Bo","Xx","ss","Rs","RB","LD","rs","yh","oh","ss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(t){n.__extends(i,t);function i(e,n){var r=t.call(this,e,n)||this,i=e.allowMultiSelect,s=void 0!==i&&i,o=e.canFallback,u=void 0!==o&&o,a=e.overrideItem,h=e.ignoreSelection,v=void 0!==h&&h,m=n.itemsScopeItemKey,g=n.itemCacheObservablesFactory,y=n.itemCacheStore,b=n.urlDataSource;r._itemCacheStore=y;r._itemsScopeItemKey=m;r._placeholder=r.observables.create(new d.default);r._urlDataSource=b;r._currentKnockoutStoreItem=r.scope.attach(g.pureCompute(function(e){var t=e.demandItemFacet(f.currentItemFacet,m),n=l.getItemKey(e,{itemKey:t&&t.itemKey});e.demandItemFacet(p.displayNameFacet,n);return e.demandItemFacet(c.knockoutStoreItemFacet,n)||r._placeholder}));r.currentItem=r.observables.pureCompute(function(){var e=r._currentKnockoutStoreItem();return e&&e()});r._selectedKnockoutStoreItems=r.scope.attach(g.pureCompute(function(e){if(a)return[[void 0,a]];var t=e.demandItemFacet(f.selectedItemsFacet,m),n=t&&t.itemKeys,r=e.demandItemFacet(f.currentItemFacet,m),i=l.getItemKey(e,{itemKey:r&&r.itemKey}),o=n&&n.length>0;if(!s&&n&&n.length>1)return[];for(var h=[],p=0,d=o&&!v||!u?n||[]:i?[i]:[];p<d.length;p++){var g=d[p],y=e.demandItemFacet(c.knockoutStoreItemFacet,g);y&&h.push([g,y])}return h}));r.selection=r.observables.pureCompute(function(){return r._selectedKnockoutStoreItems().map(function(e){return e[1]})});r.firstItem=r.observables.pureCompute(function(){var e=r._selectedKnockoutStoreItems()[0],t=(void 0===e?[]:e)[1],n=void 0===t?void 0:t;return n&&n()});return r}i.prototype.filterItems=function(e){return this._selectedKnockoutStoreItems.peek().some(function(t){var n=t[1];return e(n())})};i.prototype.resolveSelection=function(){return n.__awaiter(this,void 0,r.default,function(){var t,r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:t=this._selectedKnockoutStoreItems.peek();return[4,Promise.all([new Promise(function(t,n){e(["YD"],t,n)}),new Promise(function(t,n){e(["TB"],t,n)})])];case 1:r=n.sent(),i=r[0].demandItems,s=r[1].oneDriveItemFacet;return[4,this._itemCacheStore.dispatch(i(function(e){for(var n=0,r=t;n<r.length;n++){var i=r[n][0];e.demandItemFacet(s,i)}}))];case 2:n.sent();return[2,t.map(function(e){return e[1].peek()})]}})})};i.prototype.resolveFirst=function(){return n.__awaiter(this,void 0,r.default,function(){var t,r,i,s,o,u;return n.__generator(this,function(n){switch(n.label){case 0:if(!(t=this._selectedKnockoutStoreItems.peek()[0]))return[2,void 0];r=t[0],i=t[1];return[4,Promise.all([new Promise(function(t,n){e(["YD"],t,n)}),new Promise(function(t,n){e(["TB"],t,n)})])];case 1:s=n.sent(),o=s[0].demandItems,u=s[1].oneDriveItemFacet;return[4,this._itemCacheStore.dispatch(o(function(e){e.demandItemFacet(u,r)}))];case 2:n.sent();return[2,i.peek()]}})})};i.prototype.selectItems=function(e){var t=this._urlDataSource,n=this._itemsScopeItemKey;this._itemCacheStore.dispatch(function(r){var i=r(m.readItems(function(n){for(var r=n.demandItemFacet(v.viewParamsToItemKeyControl,y.odspNextAppItemKey),i=[],s=0,o=e;s<o.length;s++){var u=o[s],a=v.viewParamsToItemKeyControl.evaluate(r)(n,{viewParams:t.getKeyParams(u.key)}).itemKey;a&&i.push(a)}return i}));r(b.selectItems({itemsScopeItemKey:n,selectedItemKeys:i,currentSelectionKey:void 0}))})};i.prototype.clearSelection=function(){this._itemCacheStore.dispatch(h.clearSelection({itemsScopeItemKey:this._itemsScopeItemKey}))};i.prototype.selectAll=function(){};return i})(i.default);t.ItemsScopeItemSelectionHelper=w;t.typeResourceKey=s.createResolvedTypeResourceKey(e("module").id,w,n.__assign(n.__assign({},i.default.dependencies),{itemCacheStore:a.resourceKey,itemCacheObservablesFactory:o.resourceKey,itemsScopeItemKey:u.resourceKey,urlDataSource:g.url}))});
define("HKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToQuickLaunchAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.AddToQuickLaunchAction))})});
define("RKe",["require","exports","lC","r","X_","ks","c0","gj","jB","HB","Re","Kg"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=e("module").id;t.createItemsScopeActionFromKnockout=function(e,t){void 0===t&&(t={});function n(n){return r.createElement(c.WithKnockoutResourceScope,null,r.createElement(p,{createKnockoutAction:e,options:t,actionProps:n}))}return l.default.isActivated("DB243761-5E52-4E84-8204-175D856F50DE","9/4/2019","Always use ItemCache selection shim for actions")?n:o.withChildResources(function(e){e.exposeFactory(a.typeResourceKey,new i.AliasResourceFactory(f.typeResourceKey))},{owner:h})(n)};function p(e){var t=this,i=e.createKnockoutAction,a=e.options,f=e.actionProps,l=a.isToggleable,c=void 0!==l&&l,h=a.isExecutorOnly,p=void 0!==h&&h,d=o.useResourceScope(),v=r.useRef(),m=v.current||(v.current=i(d,f));r.useEffect(function(){return function(){m.dispose()}},[]);var g=u.useObservableValue(!!p||m.isAvailable),y=u.useObservableValue(c?m.isToggled:void 0);return r.createElement(s.ActionBase,{isAvailable:g,onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,m.execute(e.event)];case 1:t.sent();return[2]}})})},isToggled:y})}});
define("Kg",["require","exports","lC","r","c0","tv","ah","X_"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){return r.createElement(r.Fragment,null,e.children)}var f=new u.ResourceKey(e("module").id+".canary"),l=e("module").id;t.WithKnockoutResourceScope=function(e){var t=this,c=e.bypass,h=i.useResourceScope(),p=r.useState(function(){return s.asAsync(function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:if(!c)return[3,5];(e=new u.ResourceScope(h,{owner:l})).expose(f,!0);t.label=1;case 1:t.trys.push([1,,3,4]);return[4,e.consumeAsync(o.resourceKey.optional.bypass)];case 2:t.sent();return[3,4];case 3:e.dispose();return[7];case 4:return[3,7];case 5:return[4,h.consumeAsync(o.resourceKey.optional)];case 6:t.sent();t.label=7;case 7:return[2,a]}})})})})[0];return r.createElement(p,n.__assign({},e))}});
define("NKe",["require","exports","lC","rWe","iWe","aWe","nWe","tWe","eWe","$Ke","ZKe","XKe","JKe","YKe","QKe","qKe","WKe","KKe","GKe","zKe","BKe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t);n.__exportStar(d,t);n.__exportStar(v,t);n.__exportStar(m,t);n.__exportStar(g,t);n.__exportStar(y,t);n.__exportStar(b,t);n.__exportStar(w,t)});
define("rWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AlertAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.AlertAction))(t)})});
define("iWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CancelEditAtion=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CancelEditAction))})});
define("aWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComplianceDetailsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ComplianceDetailsAction))})});
define("nWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateShortcutAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchCreateShortcutPanel))})});
define("tWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditNewMenuAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditNewMenuAction))({templates:[]})})});
define("eWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateFileRequestAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateFileRequestAction))},{isExecutorOnly:!0})});
define("$Ke",["require","exports","px","RKe","sJ","jKe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddFlowAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.AddFlowAction))});t.LaunchConfigureFlowsPanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchConfigureFlowsPanelAction))});t.ShowExistingFlowsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowExistingFlowsAction))});t.SetUpApprovalFlowAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SetUpApprovalFlowAction))});t.SetUpReminderFlowAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.SetUpReminderFlowAction))({columnName:t.columnName,columnDisplayName:t.columnDisplayName})});t.TriggerFlowAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),s=t?i.default.getAction(t.flow,r):r.TriggerFlowAction;return new(e.injected(s))({flow:t.flow})});t.TriggerFlowItemAction=s.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),s=t?i.default.getAction(t.flow,r,!0):r.TriggerFlowByIdAction;return new(e.injected(s))({item:t.item,userInvokedItem:!0,flow:t.flow,noCache:t.noCache})})});
define("jKe",["require","exports","RKe","VKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemsScopeItemActionFromKnockout=function(e,t){void 0===t&&(t={});var i=n.createItemsScopeActionFromKnockout(e,t);return r.withKnockoutStoreItem(function(e){return{item:e}})(i)}});
define("VKe",["require","exports","lC","r","C1","gj","Xx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withKnockoutStoreItem=function(e){return function(t){var u=t;return i.connectToItemCache(function(e,t){return{storeItem:e.demandItemFacet(o.knockoutStoreItemFacet,t.itemKey)}})(function(t){var i=t.storeItem,o=s.useObservableValue(i),a=s.useObservable(o);return r.createElement(u,n.__assign({},t,e(a,t)))})}};t.withKnockoutStoreItems=function(){return function(e){var t=e;return i.connectToItemCache(function(e,t){return{items:t.itemKeys.map(function(t){return e.demandItemFacet(o.knockoutStoreItemFacet,t)})}})(t)}}});
define("ZKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MakeHomePageAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.MakeHomepageAction))})});
define("XKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchFormatViewPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchFormatViewPaneAction))})});
define("JKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInPowerBIAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInPowerBIAction))})});
define("YKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchQuickEditAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditAction))})});
define("QKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CustomizeFormsNavigationAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CustomizeFormsNavigationAction))});t.LaunchCreateAppViewPanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchCreateAppViewPanelAction))});t.SeeAllAppsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SeeAllAppsAction))})});
define("qKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchTeamChannelAction))})});
define("WKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VersionHistoryAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowVersionHistoryAction))})});
define("KKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInSharePointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInSharePointAction))})});
define("GKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditItemAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=t.isBulkEdit,i=e.consume(n.actionMap);return new(e.injected(i.EditItemAction))({isBulkEdit:r})})});
define("zKe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewItemAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ViewItemAction))({preferredSection:t.preferredSection})})});
define("BKe",["require","exports","jKe","px"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewCommentsAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.ViewItemAction))({item:t.item,preferredSection:"comments"})})});
define("oWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPanelAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchMoveCopyPanelAction))({isMove:t.isMove})})});
define("sWe",["require","exports","Y5e"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInExplorerExecutor=function(e){var t=e.isODB,r=e.explorerWindowUrl;if(r){t&&n.set("odbnu","0");window.open(r,"_blank")}}});
define("cWe",["require","exports","lC","r","pZ","px","RKe","m1","jm","si","qr","li","gD","hs","Ro","Jr","Gm","ii","Rs","k1","Er","C1","Re","ke","oh","YD","Xx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=new a.ProgressKeyFacet("shimUpload");var L=o.createItemsScopeActionFromKnockout(function(e,t){var n=t.uploadProcessorType,r=t.createUploadObserver,i=e.consume(s.actionMap);return new(e.injected(i.UploadAction))({uploadProcessorType:n,createUploadObserver:r})},{isExecutorOnly:!0});function A(e){return E.connectToItemCache(M)(function(t){var i=(function(e){var t=this,r=e.itemKey,i=e.overrides,s=i.onItemUploaded,o=i.onUploadStarted,u=i.onUploadCompleted,c=e.getUploadedItemKey,p=b.useItemCacheDispatch();return w.useEventHandler(function(){var e,i,d=a.progressBatchKeyFacet.serializeNext(),b=k.serializeBatchKey(d);r&&p(v.resolveItems({items:(e={},e[r]=n.__assign({},g.activeUploadProjectionFoldersFacet.pack((i={},i[b]={},i))),e)}));o&&p(o({progressItemKey:b}));return{onItemUploaded:function(e){var t,r=e.type===h.default.Folder,i=c(e);if(i){var o=e.parent?c(e.parent):void 0,u=k.serializeTaskKey(d,i,{});p(v.resolveItems({items:(t={},t[u]=m.createdItemFacet.pack({itemKey:i}),t[i]=n.__assign(n.__assign(n.__assign({},y.displayNameFacet.pack(e.displayName)),y.parentFolderItemFacet.pack(o?{itemKey:o}:void 0)),y.folderFacet.pack(r?{}:void 0)),t)}));s&&p(s({progressItemKey:u}))}},onUploadCompleted:function(){var e,t;r&&p(v.resolveItems({items:(e={},e[r]=f.pack({activeUploadProjectionFolders:g.activeUploadProjectionFoldersFacet},{activeUploadProjectionFolders:(t={},t[b]=new l.Delete,t)}),e)}));u&&p(u({progressItemKey:b}))},resolveParentItem:function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,p(N.demandItems(function(e){return e.demandItemFacet(C.knockoutStoreItemFacet,r)}))];case 1:e.sent();return[2]}})})}}})})(t);return r.createElement(L,{uploadProcessorType:e,createUploadObserver:i})})}var O=S.default.isActivated("0F47DF9E-205A-4A21-BA79-DE69FAE2CBE5","5/4/2020","Invoke control handlers within KO upload actions");t.UploadFileAction=O?o.createItemsScopeActionFromKnockout(function(e){var t=e.consume(s.actionMap);return new(e.injected(t.UploadAction))({uploadProcessorType:i.UploadProcessorType.Html5file})},{isExecutorOnly:!0}):A(i.UploadProcessorType.Html5file);t.UploadFolderAction=O?o.createItemsScopeActionFromKnockout(function(e){var t=e.consume(s.actionMap);return new(e.injected(t.UploadAction))({uploadProcessorType:i.UploadProcessorType.Folder})},{isExecutorOnly:!0}):A(i.UploadProcessorType.Folder);function M(e){var t=p.getCurrentItemKey(e),r=e.demandItemFacet(c.spItemGroupKeyFacet,t),i=d.getCurrentItemSetKey(e),s=e.demandItemFacet(u.uploadItemsActionControl,t),o=e.demandItemFacet(g.spPageContextFacet,T.odspNextAppItemKey),a=e.demandItemFacet(c.spFolderItemSetKeyFacet,i)||r&&r.itemSetKey;return{itemKey:t,overrides:u.uploadItemsActionControl.evaluate(s)(e,{itemKey:t,targetItemKey:t,isAvailable:!0}),getUploadedItemKey:function(e){var t,r=null===(t=e.properties)||void 0===t?void 0:t.ID,i=e.type===h.default.Folder;if((i||r)&&a&&o){var s=new x.ItemUrlHelper({},{pageContext:o}).getItemUrlParts(e.key),u=s.serverRelativeItemUrl,f=u===s.serverRelativeListUrl?"":u,l=a.webAbsoluteUrl,p=a.listFullUrl;return c.spItemKeyFacet.serialize(n.__assign({webAbsoluteUrl:l,listFullUrl:p},i?{rootFolder:f}:{itemId:r}))}}}}});
define("dWe",["require","exports","px","jKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowPermissionsAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowPermissionsAction))({item:t.item})},{isExecutorOnly:!0})});
define("lWe",["require","exports","lC","jKe","px","KH","Re"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(i.actionMap);n._action=new(n.managed(r.DefaultClickAction))(t);n._item=t.item;return n}t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!(!e||e.isPlaceholder)&&this._action.isAvailable()};t.prototype.onExecute=function(e){return this._action.execute(e)};return t})(s.default);t.DefaultClickAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(i.actionMap),r=o.default.isActivated("9FCD7B65-390C-4C59-9913-FC1D9D8D79E1","9/9/2019","Restore original DefaultClickAction behavior thanks to deferred execution")?u:n.DefaultClickAction;return new(e.injected(r,{injectChildResourceScope:!0}))({item:t.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"})})});
define("uWe",["require","exports","jKe","px"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditItemAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.EditItemAction))({item:t.item,userInvokedItem:!0})})});
define("fWe",["require","exports","jKe","px"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExternalNavigateAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.ExternalNavigateAction))({item:t.item})})});
define("pWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateClassicColumnAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateColumnAction))({fieldType:null})})});
define("mWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameColumnAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.RenameColumnAction))(t)})});
define("_We",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchColumnManagementPanelAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchColumnManagementPanelAction))(t)})});
define("hWe",["require","exports","lC","r","Ps","ks","bWe","C1","hs","Xy","c0","pK","g$","h$","li","ii","li","Xo","yh","bx","vh","_s","Gk","xo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(e,t,n,s,u){return i.renderComponentOnExecute(function(i){var a=i.resolve;i.reject;return r.createElement(o.ContentTypeManagementPanelContainer,{resolve:a,pageContext:e,views:t,onSuccess:n,getOAuthToken:s,updateViewWithNewColumns:u})})},N=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.onSuccess=function(e){var t=n._columnActionsHelper.getAddOrRemoveFromViewAction(void 0,e);new(n.props.resources.injected(t.action))(t.params).execute(null).done(function(){n._columnActionsHelper.invalidateInfoPaneCache()},function(){});n._isItemsScopeEnabled()&&n.props.resources.consumeAsync(h.resourceKey).then(function(e){e.invalidateCurrentItemSet();e.invalidateCurrentView();e.invalidateAvailableViews();e.invalidateListContentTypes()})};n.getOAuthToken=function(){return n.props.resources.consumeAsync(y.identity.bypass).then(function(e){if(!e.getSharePointToken){n._engagement.logData({name:"LaunchContentTypeManagementPanelAction.ErrorInGettInGettingIdentityDataSource"});return"No IdentityDataSource"}return e.getSharePointToken(b.getServerUrl(n.props.pageContext||{})).then(function(e){return e.accessToken})})};n._isItemsScopeEnabled=t.resources.consume(c.isItemsScopeEnabledResourceKey.lazy);n._columnActionsHelper=t.resources.consume(p.resourceKey);n._engagement=t.resources.consume(w.resourceKey);return n}t.prototype.render=function(){var e=this.props,t=e.pageContext,n=e.contentTypesEnabled,i=e.updateViewWithNewColumns,o=e.views;return t?r.createElement(s.Action,{isAvailable:n,onExecute:T(t,o,this.onSuccess,this.getOAuthToken,i)}):null};return t})(r.PureComponent);t.LaunchContentTypeManagementPanelActionBase=N;t.LaunchContentTypeManagementPanelAction=u.connectToItemCache(function(e){var t=a.getCurrentItemKey(e),n=E.getCurrentItemSetKey(e),r=e.demandItemFacet(d.spItemKeyFacet,t),i=r&&m.spListViewsSetKeyFacet.serialize(r),s=r&&d.spListKeyFacet.serialize(r),o=e.demandItemFacet(v.listFacet,s),u=e.dispatch,l=void 0;if(r){var c={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl},h=m.spListViewsSetKeyFacet.serialize(c),p=e.demandItemFacet(g.childItemsFacet,h),y=p&&p.itemKeys;l=y&&y.map(function(t){return e.demandItemFacet(v.serverViewFacet,t)})}return{pageContext:f.getPageContextFromItemCache(e,t),contentTypesEnabled:o&&o.contentTypesEnabled,views:l,updateViewWithNewColumns:function(e,r){var s,o,a=d.spViewKeyFacet.serialize({viewId:e}),f=u(x.readItem({derivedView:v.currentDerivedViewFacet},a)).derivedView;if(f){f.replaceFields(r);n&&t&&i&&u(S.saveViewCore({items:(s={},s[i]={views:(o={},o[a]={shouldSaveViewFieldsOnly:!0},o),qosName:"saveViewFieldsFromLaunchContentTypeManagementPanel"},s)}))}}}})(l.withResources()(N))});
define("bWe",["require","exports","lC","r","Ih","OWe","yWe","vWe","gWe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;i.Engagement.logData({name:"ContentTypeManagementPanel.PanelOpened"});r._state=new s.ContentTypeManagementPanelContainerStateManager({contentTypeManagementPanelContainer:r,strings:n.__assign({},u.default),errorStrings:n.__assign({},a.default)});return r}t.prototype.render=function(){var e=this._state.getRenderProps();return r.createElement(o.ContentTypeManagementPanel,n.__assign({},e))};return t})(r.Component);t.ContentTypeManagementPanelContainer=f;t.default=f});
define("OWe",["require","exports","lC","bw","LWe","AWe","TBe","wWe","Wte","Vte","E","rT"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(e){e[e.NO_VIEW=0]="NO_VIEW";e[e.DIRTY_VIEW=1]="DIRTY_VIEW";e[e.CLEAN_VIEW=2]="CLEAN_VIEW"})(h||(h={}));var p=(function(){function e(e){var t=this;this._onDismiss=function(){t._params.contentTypeManagementPanelContainer.state.isPanelOpen&&t._params.contentTypeManagementPanelContainer.setState({isPanelOpen:!1});t._params.contentTypeManagementPanelContainer.props.resolve()};this._getSiteContentTypesAvailableForList=function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this.contentTypeProvider.loadContentTypesDetailedAvailableForList()]})})};this._getSiteContentType=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadContentType(e)]})})};this._getListContentTypes=function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this.contentTypeProvider.loadListContentTypesDetailed("$filter=custom ne null")]})})};this._getContentTypeColumns=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadReorderableContentTypeColumns(e)]})})};this._getListContentTypeColumns=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadReorderableListContentTypeColumns(e)]})})};this._addContentTypesToList=function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,o,u,a,f,p,d,v,m,g,y,b,w,E;return n.__generator(this,function(S){switch(S.label){case 0:t=[];r=[];i=[];s=0,o=e;S.label=1;case 1:if(!(s<o.length))return[3,5];y=o[s];t.push(y.id);y.createNewView&&r.push(y);if(!y.addColumnsToCurrentView)return[3,4];if(y.columns)return[3,3];u=y;return[4,this._getContentTypeColumns(y.id)];case 2:u.columns=S.sent();S.label=3;case 3:y.columns.forEach(function(e){return i.push(e.name)});S.label=4;case 4:s++;return[3,1];case 5:a=new l.Qos({name:"ContentTypeManagementPanel.addContentTypesToList"});f=[];S.label=6;case 6:S.trys.push([6,8,,9]);return[4,this.contentTypeProvider.addContentTypesToList(t)];case 7:f=S.sent();a.end({resultType:l.ResultTypeEnum.Success});return[3,9];case 8:p=S.sent();this.handleError(a,p);return[2];case 9:if(!((r=this._updateToListContentTypes(r,f))&&r.length>=0))return[3,20];d=new l.Qos({name:"ContentTypeManagementPanel.CreateNewView"});v={};this._params.contentTypeManagementPanelContainer.props.views&&this._params.contentTypeManagementPanelContainer.props.views.forEach(function(e){if(e){var t=c.parseView(e.ListViewXml);t.associatedContentTypeId&&(v[t.associatedContentTypeId]=n.__assign(n.__assign({},e),{arrangedColumns:t.fieldNames}))}});S.label=10;case 10:S.trys.push([10,19,,20]);m=0,g=r;S.label=11;case 11:if(!(m<g.length))return[3,18];y=g[m];b=y;return[4,this._getListContentTypeColumns(y.id)];case 12:b.columns=S.sent();w=this.getExistingViewInfo(y,v);switch(w.status){case h.NO_VIEW:return[3,13];case h.DIRTY_VIEW:return[3,15]}return[3,17];case 13:return[4,this._createContentTypeView(y)];case 14:S.sent();return[3,17];case 15:return[4,this.updateViewWithNewColumns(v[y.parentReference.id],w.newColumnsNeeded)];case 16:S.sent();return[3,17];case 17:m++;return[3,11];case 18:d.end({resultType:l.ResultTypeEnum.Success});return[3,20];case 19:E=S.sent();this.handleError(d,E);return[2];case 20:this._onDismiss();this._params.contentTypeManagementPanelContainer.props.onSuccess&&this._params.contentTypeManagementPanelContainer.props.onSuccess(i);return[2]}})})};this._createContentTypeView=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.createContentTypeView(e)]})})};this._deleteContentType=function(e){return n.__awaiter(t,void 0,void 0,function(){var t=this;return n.__generator(this,function(n){return[2,this.contentTypeProvider.deleteListContentType(e).then(function(){t._params.contentTypeManagementPanelContainer.props.onSuccess([])})]})})};this._updateToListContentTypes=function(e,t){return t=t.filter(function(t){for(var n=0,r=e;n<r.length;n++){if(r[n].id===t.parentReference.id)return!0}return!1})};this.handleError=function(e,n){e.end({resultType:l.ResultTypeEnum.Failure,error:n});t._params.contentTypeManagementPanelContainer.setState({hasError:!0})};this.getExistingViewInfo=function(e,t){if(!(e.parentReference.id in t))return{status:h.NO_VIEW};var n=new Set;t[e.parentReference.id].arrangedColumns.forEach(function(e){return n.add(e)});for(var r=[],i=0,s=e.columns;i<s.length;i++){var o=s[i];n.has(o.name)||r.push(o.name)}return r.length>0?{status:h.DIRTY_VIEW,newColumnsNeeded:r}:{status:h.CLEAN_VIEW}};this.updateViewWithNewColumns=function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(i){if(r&&r.length>0){t=n.__spreadArrays(e.arrangedColumns,r);this._params.contentTypeManagementPanelContainer.props.updateViewWithNewColumns&&this._params.contentTypeManagementPanelContainer.props.updateViewWithNewColumns(e.Id,t)}return[2]})})};this._params=e;var r=this._params.contentTypeManagementPanelContainer.props.pageContext;this.contentTypeProvider=new u.default(new s.default({pageContext:r,oAuthTokenProvider:new a.default({},{oAuthTokenDataSource:new f.default(r)})}),new o.default(r,e.contentTypeManagementPanelContainer.props.getOAuthToken),r);this._params.contentTypeManagementPanelContainer.state={isPanelOpen:!0,hasError:!1}}e.prototype.getRenderProps=function(){var e=this._params.contentTypeManagementPanelContainer.state,t=i.fillInContentTypeManagementPanelStrings(this._params.strings),n=i.fillInContentTypeManagementPanelErrorStrings(this._params.errorStrings);return{panelProps:{type:r.PanelType.custom,isOpen:e.isPanelOpen,customWidth:"70%",onDismiss:this._onDismiss,isLightDismiss:!0,hasCloseButton:!1,onRenderNavigation:function(){return null},styles:{content:{padding:"0px",margin:"0px"}}},strings:t,errorStrings:n,hasErrorOccurred:e.hasError,onDismiss:this._onDismiss,getSiteContentTypes:this._getSiteContentTypesAvailableForList,getSiteContentType:this._getSiteContentType,getListContentTypes:this._getListContentTypes,getContentTypeColumns:this._getContentTypeColumns,getListContentTypeColumns:this._getListContentTypeColumns,addContentTypesToList:this._addContentTypesToList,removeContentType:this._deleteContentType}};return e})();t.ContentTypeManagementPanelContainerStateManager=p});
define("LWe",["require","exports","lC"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MockContentTypeManagementPanelStrings={title:null,closeButtonAriaLabel:null,dropdownNoneLabel:null,dropdownLabel:null,dropdownTitleSelectedLabel:null,addedContentTypes:null,selectedContentTypesColumnKey:null,nameLabel:null,parentLabel:null,descriptionLabel:null,columnsLabel:null,cancelButtonLabel:null,applyButtonLabel:null,addColumnCurrentViewLabel:null,createNewViewLabel:null,defaultSecondaryPanelLabel:null,contentTypeInformationLabel:null,secondaryPanelFieldsListNameDisplayName:null,secondaryPanelFieldsListTypeDisplayName:null,secondaryPanelFieldsListStatusDisplayName:null,secondaryPanelFieldsListSourceDisplayName:null,removeContentTypeButtonLabel:null,loadingContentTypesSpinner:null,applyingContentTypesSpinner:null,tooltipReadonlyCT:null,ariaLabelAddedCT:null};t.MockContentTypeManagementPanelErrorStrings={cannotRemoveContentType:null,genericErrorMessage:null};t.fillInContentTypeManagementPanelStrings=function(e){var r=n.__assign({},t.MockContentTypeManagementPanelStrings);for(var i in t.MockContentTypeManagementPanelStrings)r[i]=e[i]?e[i]:i;return r};t.fillInContentTypeManagementPanelErrorStrings=function(e){var r=n.__assign({},t.MockContentTypeManagementPanelErrorStrings);for(var i in t.MockContentTypeManagementPanelErrorStrings)r[i]=e&&e[i]?e[i]:i;return r}});
define("AWe",["require","exports","lC","Fe","nk"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{dataSourceName:"GraphContentTypeInfo"},t)||this;n._oAuthTokenProvider=t.oAuthTokenProvider;n._canUseGraph=n._pageContext.isSPO;return n}t.prototype.getSiteAndWebIdfromUrl=function(e){var t=this;return this._canUseGraph?this._oAuthTokenProvider.getToken(this._pageContext.msGraphEndpointUrl).then(function(n){return t._getSiteAndWebId(n,t._pageContext.msGraphEndpointUrl+e)}).catch(function(){return null}):r.default.resolve(null)};t.prototype._getSiteAndWebId=function(e,t){return this.dataRequestor.getData({url:t,authToken:e,qosName:"GetSiteId",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){var t=JSON.parse(e);return[t.id.split(",")[1],t.id.split(",")[2]]}})};return t})(i.DataSource);t.default=s});
define("TBe",["require","exports","lC","bx","Wte","nk","Vte","HBe","FBe","pe","Fe","UBe"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,p;(function(e){e.JSON="application/json";e.octetStream="application/octet-stream";e.multipartBoundary="multipart/related; boundary="})(h||(h={}));(function(e){e.metadata="metadata";e.content="content"})(p||(p={}));var d=(function(e){n.__extends(t,e);function t(t,n){var s=e.call(this,{dataSourceName:"ContentTypeDataSource"},{pageContext:t})||this;s.siteUrlTemplate="{0}/_api/v2.1/sites/{1},{2}";s.contentTypeUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes";s.listContentTypeDetailedUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/{2}/contentTypes";s.contentTypeColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}/columns";s.sharedPackageUrlTemplate="{0}/_api/web/GetList(@listUrl)/items?@listUrl='/sites/contenttypehub/lists/PackageList'";s.sharedPackageByTitleUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/Shared Packages/items?expand=fields";s.availableContentTypesForListUrlTemplate="{0}/_api/v2.1/sites/{1}/oneDrive.getApplicableContentTypesForList(listId='{2}')";s.siteColumnsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/columns";s.currencyListUrlTemplate="{0}/_api/SP.CurrencyList.GetList";s.regionalDateTimeUrlTemplate="{0}/_api/web/GetRegionalDateTimeSchema";s.siteListsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists?$select=system,id,name,displayName,list";s.listFieldsUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists/{3}/columns";s.createContentTypeViewUrl="{0}/_api/v2.1/sites/{1}/lists/{2}/views";s.listContentTypeColumnsUrlTemplate="{0}/_api/v2.1/sites/{1}/lists/{2}/contentTypes/{3}/columns";s.publishContentTypeUrlTemplate="{0}/_api/v2.1//sites/{1}/contentTypes/{2}/oneDrive.publish";s.unpublishContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1}/contentTypes/{2}/oneDrive.unpublish";s.updateContentTypeColumnUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}/columns/{4}";s.updateContentTypeUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/contentTypes/{3}";s.contentTypeListViewUrl="/_api/web/lists/GetByTitle('{0}')";s.createListUrlTemplate="{0}/_api/v2.1/sites/{1},{2}/lists";s.fetchCustomCTProperty="$filter=custom ne null";s.filterByReorderable="$filter=reorderable eq true";s.selectDocTemplateProperty="$select=documentTemplate";s.reorderColumns="$select=columnOrder";s.getContentTypeColumnsHiddenParam="$select=*,hidden";s.getContentTypeAncestorsParam="$expand=ancestors";s.getContentTypeEnforcemenetParam="$select=*,enforcement";s.getToken=function(e){var t=r.getServerUrl(s._pageContext);return s._getOAuthToken?s._getOAuthToken(e):s._tokenProvider.getToken(t)};s._tokenProvider=new i.default(null,{oAuthTokenDataSource:new o.default(t)});s._getOAuthToken=n;return s}t.prototype.getSiteInfo=function(e,t){return this.dataRequestor.getData({url:encodeURI(f.format(this.siteUrlTemplate,r.getServerUrl(this._pageContext),e,t)),qosName:"GetSiteInfo",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})};t.prototype.getContentTypes=function(e,t){return this.dataRequestor.getData({url:encodeURI(f.format(this.contentTypeUrlTemplate,r.getServerUrl(this._pageContext),e,t)),qosName:"GetSiteContentType",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getContentTypeAncestors=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.updateContentTypeUrlTemplate+"?"+this.getContentTypeAncestorsParam,r.getServerUrl(this._pageContext),e,t,n)),qosName:"GetSiteContentTypeAncestors",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).ancestors},noRedirect:!0})};t.prototype.getContentType=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.contentTypeUrlTemplate+"/"+n,r.getServerUrl(this._pageContext),e,t)),qosName:"GetSiteContentType",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e)}catch(e){return}},noRedirect:!0})};t.prototype.getContentTypesDetailedAvailableForList=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.availableContentTypesForListUrlTemplate+"?"+this.fetchCustomCTProperty,e,void 0,t),qosName:"GetSiteContentTypeForList",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListContentTypesDetailed=function(e,t,n,i){var s=this,o=null!=n?n:r.getServerUrl(this._pageContext);o.endsWith("/")&&(o=o.substring(0,o.length-2));var u=null!=i?i:"";u=u?"?"+u:"";var a=function(n){return s.dataRequestor.getData({url:encodeURI(f.format(s.listContentTypeDetailedUrlTemplate+u,o,e,t)),qosName:"GetListContentType",method:"GET",contentType:"application/json",authToken:null!=n?n:void 0,parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};return n?this._getOAuthToken(n).then(function(e){return a(e)}):a()};t.prototype.getContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.contentTypeColumnsUrlTemplate+"?"+this.getContentTypeColumnsHiddenParam,r.getServerUrl(this._pageContext),e,t,n)),qosName:"GetContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getReorderableContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.contentTypeColumnsUrlTemplate+"?"+this.filterByReorderable,r.getServerUrl(this._pageContext),e,t,n)),qosName:"GetReorderableContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getListContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.listContentTypeColumnsUrlTemplate,r.getServerUrl(this._pageContext),e,t,n)),qosName:"GetContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getReorderableListContentTypeColumns=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.listContentTypeColumnsUrlTemplate+"?"+this.filterByReorderable,r.getServerUrl(this._pageContext),e,t,n)),qosName:"GetReorderableContentTypeColumns",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getEnforcedHubSites=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.updateContentTypeUrlTemplate+"?"+this.getContentTypeEnforcemenetParam,r.getServerUrl(this._pageContext),e,t,n)),qosName:"GetContentTypeEnforcedHubSites",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e)}catch(e){return{}}},noRedirect:!0})};t.prototype.publishContentTypeGet=function(e,t){return this.dataRequestor.getData({url:encodeURI(f.format(this.publishContentTypeUrlTemplate,r.getServerUrl(this._pageContext),e,t)),qosName:"GetContentTypePublish",method:"GET",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})};t.prototype.publishContentType=function(e,t){var n=this;return this.getToken().then(function(i){return n.dataRequestor.getData({url:encodeURI(f.format(n.publishContentTypeUrlTemplate,r.getServerUrl(n._pageContext),e,t)),authToken:i,qosName:"PostContentTypePublish",method:"POST",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})})};t.prototype.unpublishContentType=function(e,t){var n=this;return this.getToken().then(function(r){return n.dataRequestor.getData({url:n.getUrl(n.unpublishContentTypeUrlTemplate,e,t),authToken:r,qosName:"PostContentTypeUnpublish",method:"POST",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})})};t.prototype.unpublishContentTypeGet=function(e,t){return this.dataRequestor.getData({url:this.getUrl(this.unpublishContentTypeUrlTemplate,e,t),qosName:"GetContentTypeUnpublish",method:"GET",contentType:"application/json",parseResponse:function(e){},noRedirect:!0})};t.prototype.getSiteColumns=function(e,t,n){return this.dataRequestor.getData({url:n?encodeURI(f.format(this.siteColumnsUrlTemplate,r.getServerUrl(this._pageContext),e,t)+"?select="+n.join(",")):encodeURI(f.format(this.siteColumnsUrlTemplate,r.getServerUrl(this._pageContext),e,t)),qosName:"GetSiteColumns",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.addContentTypesToList=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:r.getUrl(r.listContentTypeDetailedUrlTemplate,e,void 0,t),authToken:i,qosName:"AddContentTypeToList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:r.constructContentTypeAddToListPostBody(n),parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})})};t.prototype.createContentType=function(e,t,n,i,s,o,u){var a=this;return this.getToken().then(function(l){return a.dataRequestor.getData({url:encodeURI(f.format(a.contentTypeUrlTemplate,r.getServerUrl(a._pageContext),s,o)),authToken:l,qosName:"CreateContentType",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:a.constructContentTypeBody(e,t,n,i,void 0,void 0,u),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateContentType=function(e,t,n,i,s,o,u,a,l,h,p){var d=this,v=JSON.parse(this.constructContentTypeBody(i,s,o,u,a,l,p)),m=void 0,g=1;if(void 0!==h){v.documentTemplate={name:h.name};if(void 0!==h.content){v.documentTemplate["@microsoft.graph.sourceUrl"]="cid:content"+g;m=c.getBatchContentHeader("A100x","content"+g,"application/octet-stream");g+=1}}var y,b=c.getBatchContent("A100x","metadata","application/json",JSON.stringify(v));if(void 0!==m){b+=m;y=new Blob([b,h.content,"\r\n--A100x--"])}else y=new Blob([b,"--A100x--"]);return this.getToken().then(function(i){return d.dataRequestor.getData({url:encodeURI(f.format(d.updateContentTypeUrlTemplate,r.getServerUrl(d._pageContext),e,t,n)),authToken:i,qosName:"UpdateContentType",method:"PATCH",contentType:"multipart/related; boundary=A100x",additionalHeaders:void 0,additionalPostData:y,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.createOrAddContentTypeColumns=function(e,t,i,s,o){var u=this;return this.getToken().then(function(a){return u.dataRequestor.getData({url:encodeURI(f.format(u.contentTypeColumnsUrlTemplate,r.getServerUrl(u._pageContext),e,t,i)),authToken:a,qosName:"CreateContentTypeColumn",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({value:n.__spreadArrays(s,o)}),parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})})};t.prototype.createContentTypeView=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:r.getUrl(r.createContentTypeViewUrl,e,void 0,t),authToken:i,qosName:"CreateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:r.constructCreateContentTypeViewPostBody(n),parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return""}},noRedirect:!0})})};t.prototype.getSharedPackagesByUrl=function(e,t){var n=this;return this.getToken(e).then(function(r){return n.dataRequestor.getData({url:encodeURI(f.format(n.sharedPackageUrlTemplate,e+t)),qosName:"GetSharedPackagesByUrl",method:"GET",authToken:r,contentType:"application/json",parseResponse:function(e){return JSON.parse(e).d.results},noRedirect:!0})})};t.prototype.getSharedPackages=function(e){return this.dataRequestor.getData({url:this.getUrl(this.sharedPackageByTitleUrlTemplate,e),qosName:"GetSharedPackages",method:"GET",contentType:"application/json",parseResponse:function(e){return JSON.parse(e).value},noRedirect:!0})};t.prototype.getCurrencyList=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(f.format(t.currencyListUrlTemplate,e)),authToken:n,qosName:"SP.CurrencyList.GetList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e).Items}catch(e){return[]}},noRedirect:!0})})};t.prototype.getRegionalDateTimeSchema=function(e){var t=this;return this.getToken().then(function(n){return t.dataRequestor.getData({url:encodeURI(f.format(t.regionalDateTimeUrlTemplate,e)),authToken:n,qosName:"GetRegionalDateTimeSchema",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{var t=JSON.parse(e);return JSON.parse(t.value)}catch(e){return{}}},noRedirect:!0})})};t.prototype.loadViews=function(e,t){var n=this;return this.dataRequestor.getData({url:""+e+f.format(this.contentTypeListViewUrl,t)+"/Views",qosName:"GetContentTypeViews",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){return n._parseReturnedViews(JSON.parse(e))},noRedirect:!0})};t.prototype.updateView=function(e,t,n,r,i,s){var o=this,u=""+i+f.format(this.contentTypeListViewUrl,s)+"/Views('"+e+"')/SetViewXml()",l=this._translateColumnKeysToFieldRefNames(r),c=new a.default(n,l).generateCamlQueryString().replace("<View>",'<View Name="'+e+'" DisplayName="'+t+'">');return this.getToken().then(function(e){return o.dataRequestor.getData({url:u,authToken:e,qosName:"UpdateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({viewXml:c}),parseResponse:function(e){},noRedirect:!0})})};t.prototype.createView=function(e,t,n,r,i){var s=this,o=""+r+f.format(this.contentTypeListViewUrl,i)+"/Views/Add",u=this._translateColumnKeysToFieldRefNames(n),l=new a.default(t).generateCamlQueryString();return this.getToken().then(function(t){return s.dataRequestor.getData({url:o,authToken:t,qosName:"CreateContentTypeView",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({parameters:{Title:e,ViewFields:u,Query:l,Paged:!1,PersonalView:!1}}),parseResponse:function(e){return JSON.parse(e).Id},noRedirect:!0})})};t.prototype.setDefaultView=function(e,t,r){return n.__awaiter(this,void 0,l.default,function(){var i,s=this;return n.__generator(this,function(n){i=""+e+f.format(this.contentTypeListViewUrl,r)+"/Views('"+t+"')";return[2,this.getToken().then(function(e){return s.dataRequestor.getData({url:i,authToken:e,qosName:"UpdateContentTypeView",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({DefaultView:!0}),parseResponse:function(e){},noRedirect:!0})})]})})};t.prototype.createContentTypeViewList=function(e,t,n){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(f.format(i.createListUrlTemplate,r.getServerUrl(i._pageContext),e,t)),authToken:s,qosName:"CreateContentTypeViewList",method:"POST",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify(n),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.getAllSitesLists=function(e,t){return this.dataRequestor.getData({url:encodeURI(f.format(this.siteListsUrlTemplate,r.getServerUrl(this._pageContext),e,t)),qosName:"GetAllSitesLists",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getListFields=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.listFieldsUrlTemplate,r.getServerUrl(this._pageContext),e,t,n)),qosName:"GetListFields",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).value}catch(e){return[]}},noRedirect:!0})};t.prototype.getContentTypeDocTemplate=function(e,t,n){return this.dataRequestor.getData({url:encodeURI(f.format(this.contentTypeUrlTemplate+"/"+n+"?"+this.selectDocTemplateProperty,r.getServerUrl(this._pageContext),e,t)),qosName:"GetContentTypeDocTemplate",method:"GET",contentType:"application/json",parseResponse:function(e){try{return JSON.parse(e).documentTemplate}catch(e){return{}}},noRedirect:!0})};t.prototype.deleteContentTypeFromList=function(e,t,n){var r=this;return this.getToken().then(function(i){return r.dataRequestor.getData({url:r.getUrl(r.listContentTypeDetailedUrlTemplate+"/"+n,e,void 0,t),authToken:i,qosName:"DeleteContentTypeList",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.deleteContentTypeFromSite=function(e,t,n){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(f.format(i.contentTypeUrlTemplate+"/"+n,r.getServerUrl(i._pageContext),e,t)),authToken:s,qosName:"DeleteContentTypeSite",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.deleteContentTypeColumn=function(e,t,n,i){var s=this;return this.getToken().then(function(o){return s.dataRequestor.getData({url:encodeURI(f.format(s.updateContentTypeColumnUrlTemplate,r.getServerUrl(s._pageContext),e,t,n,i)),authToken:o,qosName:"DeleteContentTypeColumn",method:"DELETE",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){try{return JSON.parse(e)}catch(e){return""}},noRedirect:!0})})};t.prototype.updateContentTypeColumn=function(e,t,n,i,s,o,u){var a=this;return this.getToken().then(function(l){return a.dataRequestor.getData({url:encodeURI(f.format(a.updateContentTypeColumnUrlTemplate,r.getServerUrl(a._pageContext),e,t,n,i)),authToken:l,qosName:"UpdateContentTypeColumn",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({pushDownChanges:s,hidden:o,required:u}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.reorderContentTypeColumn=function(e,t,n,i){var s=this;return this.getToken().then(function(o){return s.dataRequestor.getData({url:encodeURI(f.format(s.updateContentTypeUrlTemplate+"?"+s.reorderColumns,r.getServerUrl(s._pageContext),e,t,n)),authToken:o,qosName:"ReorderContentTypeColumns",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({columnOrder:i}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype.updateSiteColumn=function(e,t,n,r){var i=this;return this.getToken().then(function(s){return i.dataRequestor.getData({url:encodeURI(f.format(i.siteColumnsUrlTemplate,i._pageContext.siteAbsoluteUrl,e,t)+"/"+n),authToken:s,qosName:"UpdateSiteColumn",method:"PATCH",contentType:"application/json",additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({customFormatter:r}),parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})})};t.prototype._translateColumnKeysToFieldRefNames=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i in u.contentTypeColumnFields&&t.push(u.contentTypeColumnFields[i].fieldRefName)}return t};t.prototype._parseReturnedViews=function(e){if(!e||!e.value||0===e.value.length)throw new Error("ContentTypeDataSource.parseReturnedViews: viewsData is null or undefined!");for(var t={},n=0,r=e.value;n<r.length;n++){var i=r[n],s=void 0;s=i.ViewQuery.indexOf("<View>")>-1?a.default.parseCamlQueryString(i.ViewQuery):a.default.parseCamlQueryString("<View><Query>"+i.ViewQuery+"</Query></View>");t[i.Id]={id:i.Id,title:i.Title,isDefault:i.DefaultView,query:s}}return t};t.prototype.getUrl=function(e,t,n,i,s){var o=r.getServerUrl(this._pageContext);return n?i?void 0:s?encodeURI(f.format(e,o,t,n,s)):encodeURI(f.format(e,o,t,n)):i?encodeURI(f.format(e,o,t,i)):encodeURI(f.format(e,o,t))};t.prototype.constructContentTypeBody=function(e,t,n,r,i,s,o){var u={name:e,description:t,group:n,readOnly:i,pushDownChanges:s,enforcement:o};r&&(u.parentReference={id:r});return JSON.stringify(u)};t.prototype.constructContentTypeAddToListPostBody=function(e){var t=[];e.forEach(function(e){return t.push({id:e})});return JSON.stringify({value:t})};t.prototype.constructCreateContentTypeViewPostBody=function(e){var t={columns:e.columns,isDefault:!1,isPersonalView:!1,title:e.name,associatedContentType:{id:e.parentReference.id}};return JSON.stringify(t)};return t})(s.default);t.default=d});
define("HBe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NONE=0]="NONE";e[e.ASC=1]="ASC";e[e.DESC=2]="DESC"})(t.QueryDirection||(t.QueryDirection={}));(function(e){e.id="id";e.reorderable="reorderable"})(t.ColumnProperties||(t.ColumnProperties={}));t.contentTypeColumnFields={name:{fieldRefName:"Name",valueType:"TEXT"},parent:{fieldRefName:"Parent",valueType:"TEXT"},group:{fieldRefName:"Group",valueType:"TEXT"},lastPublished:{fieldRefName:"LastPublished",valueType:"TEXT"},source:{fieldRefName:"Source",valueType:"TEXT"}};t.contentTypeAdminViewName="DO_NOT_DELETE_SPLIST_TENANTADMIN_AGGREGATED_CONTENTTYPES";t.contentTypeViewName="DO_NOT_DELETE_SPLIST_SITECOLLECTION_AGGREGATED_CONTENTTYPES"});
define("FBe",["require","exports","lS","rT","HBe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){this._children=e}e.prototype.generateCamlQueryString=function(){var e=this._children.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<Where>"+e+"</Where>":""};return e})(),o=(function(){function e(e,t){this._fieldName=e;this._fieldValue=t}e.prototype.generateCamlQueryString=function(){var e=n.default.encodeText(i.contentTypeColumnFields[this._fieldName].fieldRefName),t=n.default.encodeText(this._fieldValue),r=n.default.encodeText(i.contentTypeColumnFields[this._fieldName].valueType);return t?"<Eq><FieldRef Name='"+e+"'/><Value Type='"+r+"'>"+t+"</Value></Eq>":"<IsNull><FieldRef Name='"+e+"'/></IsNull>"};return e})(),u=(function(){function e(e,t){this._filterFieldValueCamlQueries=[];for(var n=0,r=t;n<r.length;n++){var i=r[n];this._filterFieldValueCamlQueries.push(new o(e,i))}}e.prototype.generateCamlQueryString=function(){for(var e="",t=0,n=this._filterFieldValueCamlQueries;t<n.length;t++){var r=n[t].generateCamlQueryString();e=e?"<Or>"+e+r+"</Or>":r}return e};return e})(),a=(function(){function e(e){var t=this,n=e||new Map;this._filterByFieldCamlQueries=[];n.forEach(function(e,n){0!==e.length&&t._filterByFieldCamlQueries.push(new u(n,e))})}e.prototype.generateCamlQueryString=function(){for(var e="",t=0,n=this._filterByFieldCamlQueries;t<n.length;t++){var r=n[t].generateCamlQueryString();e=e?"<And>"+e+r+"</And>":r}return e};return e})(),f=(function(){function e(e){this._condition=e}e.prototype.generateCamlQueryString=function(){if(0===this._condition.direction)throw new Error("OrderBy query direction is set to NONE which is unexpected!");var e=2===this._condition.direction;return"<OrderBy><FieldRef Name='"+n.default.encodeText(i.contentTypeColumnFields[this._condition.field].fieldRefName)+"' Ascending='"+!e+"' /></OrderBy>"};return e})(),l=(function(){function e(e){this._condition=e}e.prototype.generateCamlQueryString=function(){return"<GroupBy><FieldRef Name='"+n.default.encodeText(i.contentTypeColumnFields[this._condition.field].fieldRefName)+"' /></GroupBy>"};return e})(),c=(function(){function e(e){e=e||{};this._queryCamlQueryElements=[];var t=[];t.push(new a(e.filterBys));this._queryCamlQueryElements.push(new s(t));e.orderBy&&this._queryCamlQueryElements.push(new f(e.orderBy));e.groupBy&&this._queryCamlQueryElements.push(new l(e.groupBy))}e.prototype.generateCamlQueryString=function(){var e=this._queryCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<Query>"+e+"</Query>":""};return e})(),h=(function(){function e(e){this._fieldRefName=e}e.prototype.generateCamlQueryString=function(){return'<FieldRef Name="'+this._fieldRefName+'"/>'};return e})(),p=(function(){function e(e){this._contentTypeCamlQueryElements=[];for(var t=0,n=e;t<n.length;t++){var r=n[t];this._contentTypeCamlQueryElements.push(new h(r))}}e.prototype.generateCamlQueryString=function(){var e=this._contentTypeCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<ViewFields>"+e+"</ViewFields>":""};return e})(),d=(function(){function e(e,t){this._contentTypeCamlQueryElements=[];e&&this._contentTypeCamlQueryElements.push(new c(e));t&&this._contentTypeCamlQueryElements.push(new p(t))}e.parseCamlQueryString=function(e){var t=r.parseView(e),n={};if(t.filters){n.filterBys=new Map;for(var i=0,s=t.filters;i<s.length;i++){var o=s[i];if(this._instanceOfIFilter(o)){var u=this._getColumnKeyFromFieldRefName(o.fieldName);u&&(n.filterBys[u]=o.values)}}}if(t.sorts){var a=this._getColumnKeyFromFieldRefName(t.sorts[0].fieldName);a&&(n.orderBy={field:a,direction:t.sorts[0].isAscending?1:2})}if(t.groupBy){var f=this._getColumnKeyFromFieldRefName(t.groupBy.group1.fieldName);f&&(n.groupBy={field:f})}return n};e._instanceOfIFilter=function(e){return"fieldName"in e};e._getColumnKeyFromFieldRefName=function(e){for(var t in i.contentTypeColumnFields)if(i.contentTypeColumnFields[t].fieldRefName===e)return t};e.prototype.generateCamlQueryString=function(){var e=this._contentTypeCamlQueryElements.map(function(e){return e.generateCamlQueryString()}).join("");return e?"<View>"+e+"</View>":""};return e})();t.default=d});
define("UBe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getBatchContent=function(e,n,r,i){var s=t.getBatchContentHeader(e,n,r);return s+=i+"\r\n"};t.getBatchContentHeader=function(e,t,n){var r="--"+e+"\r\n";r+="Content-ID: "+t+"\r\n";return r+="Content-Type: "+n+"\r\n\r\n"}});
define("wWe",["require","exports","lC","HBe","bx","EWe","ce","Fe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[{name:"Name",displayName:"Name",required:!1,text:{textType:""}},{name:"Group",displayName:"Group",required:!1,text:{textType:""}},{name:"Parent",displayName:"Parent",required:!1,text:{textType:""}}],f=(function(){function e(t,n,r,i,s,o){this.contentTypeHubPath="/sites/contenttypehub";this._graphDataSource=t;this._contentTypeDataSource=n;this._pageContext=r;this._isAdmin=void 0!==i&&!1!==i;this._siteId=void 0!==s?s:e.removeParenthesisIfExist(this._pageContext.siteId);this._webId=void 0!==o?o:e.removeParenthesisIfExist(this._pageContext.webId)}e.prototype.loadContentTypes=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getContentTypes(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.loadContentType=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getContentType(e.removeParenthesisIfExist(this._pageContext.siteId),this._webId,t).then(function(e){return e})]})})};e.prototype.getSiteInfo=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getSiteInfo(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.loadContentTypesDetailedAvailableForList=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypesDetailedAvailableForList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId)).then(function(e){return e})]})})};e.prototype.loadListContentTypesDetailed=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getListContentTypesDetailed(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),void 0,t).then(function(e){return e})]})})};e.prototype.addContentTypesToList=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.addContentTypesToList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadContentTypeColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadReorderableContentTypeColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getReorderableContentTypeColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadListContentTypeColumns=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getListContentTypeColumns(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadReorderableListContentTypeColumns=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getReorderableListContentTypeColumns(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadSiteColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getSiteColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.createContentType=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.createContentType(e,t,r,i,this._siteId,this._webId,s).then(function(e){return e})]})})};e.prototype.updateContentType=function(e,t,r,i,s,o,u,a,f){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateContentType(this._siteId,this._webId,e,t,r,i,s,o,u,a,f).then(function(e){return e})]})})};e.prototype.publishContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){try{return[2,this._contentTypeDataSource.publishContentTypeGet(this._siteId,e).then(function(e){return e})]}catch(t){if(400===t.status)return[2,this._contentTypeDataSource.publishContentType(this._siteId,e).then(function(e){return e})];throw t}return[2]})})};e.prototype.unpublishContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){try{return[2,this._contentTypeDataSource.unpublishContentTypeGet(this._siteId,e).then(function(e){return e})]}catch(t){if(400===t.status)return[2,this._contentTypeDataSource.unpublishContentType(this._siteId,e).then(function(e){return e})]}return[2]})})};e.prototype.deleteContentTypeColumn=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.deleteContentTypeColumn(this._siteId,this._webId,e,t).then(function(e){return e})]})})};e.prototype.createOrAddContentTypeColumns=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.createOrAddContentTypeColumns(this._siteId,this._webId,e,t,r).then(function(e){return e})]})})};e.prototype.createContentTypeView=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){t.columns;return[2,this._contentTypeDataSource.createContentTypeView(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.getSharedPackages=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=[];if(o.Killswitch.isActivated("ec389545-4106-4ad8-a677-53106625a517","08/28/2020","Kill getting shared packages by title"))return[3,9];n.label=1;case 1:n.trys.push([1,3,,8]);return[4,this._contentTypeDataSource.getSharedPackagesByUrl(e,this.contentTypeHubPath)];case 2:t=n.sent();return[3,8];case 3:n.sent();n.label=4;case 4:n.trys.push([4,6,,7]);return[4,this.getSharedPackagesInfo()];case 5:t=n.sent();return[3,7];case 6:n.sent();return[3,7];case 7:return[3,8];case 8:return[3,12];case 9:n.trys.push([9,11,,12]);return[4,this.getSharedPackagesInfo()];case 10:t=n.sent();return[3,12];case 11:n.sent();return[3,12];case 12:return[2,t]}})})};e.prototype.getCurrencyList=function(){return n.__awaiter(this,void 0,u.default,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=this._isAdmin?i.getServerUrl(this._pageContext):this._pageContext.webAbsoluteUrl;return[4,this._contentTypeDataSource.getCurrencyList(e)];case 1:return[2,t.sent()]}})})};e.prototype.getRegionalDateTimeSchema=function(){return n.__awaiter(this,void 0,u.default,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=this._isAdmin?i.getServerUrl(this._pageContext):this._pageContext.webAbsoluteUrl;return[4,this._contentTypeDataSource.getRegionalDateTimeSchema(e)];case 1:return[2,t.sent()]}})})};e.prototype.getAllSitesLists=function(){return n.__awaiter(this,void 0,u.default,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getAllSitesLists(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.getListFields=function(e){return n.__awaiter(this,void 0,u.default,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getListFields(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.getContentTypeDocTemplate=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeDocTemplate(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.getContentTypeEnforcedHubSites=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getEnforcedHubSites(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.deleteListContentType=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.deleteContentTypeFromList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.updateContentTypeColumn=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateContentTypeColumn(this._siteId,this._webId,e,t,r,i,s).then(function(e){return e})]})})};e.prototype.reorderContentTypeColumn=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.reorderContentTypeColumn(this._siteId,this._webId,e,t).then(function(e){return e})]})})};e.prototype.getContentTypeAncestors=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeAncestors(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.updateSiteColumn=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateSiteColumn(this._siteId,this._webId,e,t).then(function(e){return e})]})})};e.prototype.deleteSiteContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.deleteContentTypeFromSite(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.updateView=function(e,t,i,s){return n.__awaiter(this,void 0,u.default,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:o=this._isAdmin?r.contentTypeAdminViewName:r.contentTypeViewName;return[4,this._contentTypeDataSource.updateView(e,t,i,s,this._pageContext.webAbsoluteUrl,o)];case 1:return[2,n.sent()]}})})};e.prototype.createView=function(e,t,i){return n.__awaiter(this,void 0,u.default,function(){var s;return n.__generator(this,function(n){switch(n.label){case 0:s=this._isAdmin?r.contentTypeAdminViewName:r.contentTypeViewName;return[4,this._contentTypeDataSource.createView(e,t,i,this._pageContext.webAbsoluteUrl,s)];case 1:return[2,n.sent()]}})})};e.prototype.setDefaultView=function(e){return n.__awaiter(this,void 0,u.default,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=this._isAdmin?r.contentTypeAdminViewName:r.contentTypeViewName;return[4,this._contentTypeDataSource.setDefaultView(this._pageContext.webAbsoluteUrl,e,t)];case 1:return[2,n.sent()]}})})};e.prototype.loadViews=function(){return n.__awaiter(this,void 0,u.default,function(){var t,i,s,o,u,f,l,c,h,p;return n.__generator(this,function(n){switch(n.label){case 0:t=this._pageContext.webAbsoluteUrl;i=e.removeParenthesisIfExist(this._pageContext.siteId);s=e.removeParenthesisIfExist(this._pageContext.webId);o=this._isAdmin?r.contentTypeAdminViewName:r.contentTypeViewName;u=["name","parent","group"];if(this._isAdmin||this._pageContext.webServerRelativeUrl.toLowerCase()===this.contentTypeHubPath){a.push({name:"LastPublished",displayName:"LastPublished",required:!1,text:{textType:""}});u.push("lastPublished")}else{a.push({name:"Source",displayName:"Source",required:!1,text:{textType:""}});u.push("source")}n.label=1;case 1:n.trys.push([1,3,,10]);return[4,this._contentTypeDataSource.loadViews(t,o)];case 2:return[2,n.sent()];case 3:if(404!==(f=n.sent()).status)return[3,8];l={displayName:o,list:{hidden:!0,template:"genericList"},columns:a};c={orderBy:{field:"name",direction:1}};return[4,this._contentTypeDataSource.createContentTypeViewList(i,s,l)];case 4:n.sent();return[4,this._contentTypeDataSource.loadViews(t,o)];case 5:h=n.sent();p=Object.keys(h)[0];return[4,this._contentTypeDataSource.updateView(p,h[p].title,c,u,this._pageContext.webAbsoluteUrl,o)];case 6:n.sent();return[4,this._contentTypeDataSource.loadViews(t,o)];case 7:return[2,n.sent()];case 8:throw f;case 9:return[3,10];case 10:return[2]}})})};e.prototype.getContentTypeHubSiteId=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:t=new s.ContentTypeUrlHelper({path:this.contentTypeHubPath,authority:e});r=t.getSiteByPathUrl();return[4,this._graphDataSource.getSiteAndWebIdfromUrl(r)];case 1:return[2,n.sent()]}})})};e.removeParenthesisIfExist=function(e){return e.indexOf("{")>=0&&e.lastIndexOf("}")===e.length-1?e.substring(1,e.length-1):e};e.prototype.getSharedPackagesInfo=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=[];return[4,this._contentTypeDataSource.getSharedPackages(this._siteId)];case 1:t.sent().forEach(function(t){e.push(t.fields)});return[2,e]}})})};return e})();t.default=f});
define("EWe",["require","exports","Se"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.uri=new n.default(""+e.authority+e.path)}e.prototype.getSiteByPathUrl=function(){return"/v1.0/sites/"+this.uri.domain+":"+this.uri.path};e.prototype.getWebAbsoluteUrlValue=function(){return""+this.uri.value};return e})();t.ContentTypeUrlHelper=r});
define("yWe",["require","exports","lC","SWe","SWe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.ContentTypeManagementPanel});
define("SWe",["require","exports","lC","CWe","IWe","DWe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("CWe",["require","exports","lC","r","bw","Zd","am","IWe","Ih"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i.addContentTypesToList=function(e){i.setState(n.__assign(n.__assign({},i.state),{showSpinner:!0,spinnerText:i.props.strings.applyingContentTypesSpinner}));i.props.addContentTypesToList(e)};i.onContentTypeSelected=function(e){return i.setState(n.__assign(n.__assign({},i.state),{selectedContentTypeIds:e}))};i.onErrorOccured=function(){i.setState(n.__assign(n.__assign({},i.state),{hasErrorOccurred:!0}))};i._renderFooterButtons=function(){return r.createElement(r.Fragment,null,r.createElement(o.PrimaryButton,{className:"ms-ContentTypeManagementPanel-Button",onClick:i._handleApplyClick,disabled:0===i.state.selectedContentTypeIds.length||i.state.showSpinner},i.props.strings.applyButtonLabel),r.createElement(o.DefaultButton,{className:"ms-ContentTypeManagementPanel-Button ms-ContentTypeManagementPanel-CancelButton",onClick:i._handleCancelClick},i.props.strings.cancelButtonLabel))};i._handleApplyClick=function(){var e=i._content.current.getSelectedContentTypesWithView();a.Engagement.logData({name:"ContentTypeManagementPanel.ApplyClick",extraData:{countContentTypes:e.length}});i.addContentTypesToList(e)};i._handleCancelClick=function(){a.Engagement.logData({name:"ContentTypeManagementPanel.CancelClick"});i.props.onDismiss()};i._content=r.createRef();i.state={showSpinner:!0,spinnerText:t.strings.loadingContentTypesSpinner,hasErrorOccurred:i.props.hasErrorOccurred,siteContentTypes:[],listContentTypes:[],selectedContentTypeIds:[],initialLoadComplete:!1};return i}t.prototype.componentDidMount=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,this.props.getSiteContentTypes()];case 1:e=n.sent();return[4,this.props.getListContentTypes()];case 2:t=n.sent();e.forEach(function(e){e.createNewView=!0;e.addColumnsToCurrentView=!1});this.setState({showSpinner:!1,spinnerText:"",initialLoadComplete:!0,siteContentTypes:e,listContentTypes:t});return[3,4];case 3:n.sent();this.setState({showSpinner:!1,hasErrorOccurred:!0});return[3,4];case 4:return[2]}})})};t.getDerivedStateFromProps=function(e,t){return n.__assign(n.__assign({},t),{showSpinner:!e.hasErrorOccurred&&t.showSpinner,hasErrorOccurred:t.hasErrorOccurred||e.hasErrorOccurred})};t.prototype.render=function(){return r.createElement("div",null,r.createElement(i.Panel,n.__assign({},this.props.panelProps),this.state.showSpinner&&r.createElement(s.Spinner,{size:s.SpinnerSize.large,label:this.state.spinnerText,className:"ms-ContentTypeManagementPanel-Spinner"}),!this.state.showSpinner&&r.createElement(u.ContentTypeManagementPanelContent,{ref:this._content,availableContentTypes:this.state.siteContentTypes,addedContentTypes:this.state.listContentTypes,strings:this.props.strings,errorStrings:this.props.errorStrings,hasErrorOccurred:this.state.hasErrorOccurred,onContentTypeSelected:this.onContentTypeSelected,getContentType:this.props.getSiteContentType,getContentTypeColumns:this.props.getContentTypeColumns,getListContentTypeColumns:this.props.getListContentTypeColumns,removeContentType:this.props.removeContentType,onDismiss:this.props.onDismiss,onError:this.onErrorOccured}),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Buttons",role:"complimentary"},this.state.initialLoadComplete&&this._renderFooterButtons())))};return t})(r.PureComponent);t.ContentTypeManagementPanel=f});
define("IWe",["require","exports","lC","r","hne","EF","DWe","am","YF","Pfe","E","Ee","Ih","Uc","sd","us","zc","pe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._isInnerZoneKeystroke=function(e){return e.which===v.getRTLSafeKeyCode(v.KeyCodes.right)};i._onRenderDropdownTitle=function(e){var t="",n=e.filter(function(e){return e.selected}).length;t=n>0?n+" "+i.props.strings.dropdownTitleSelectedLabel:i.props.strings.dropdownNoneLabel;return r.createElement("div",null,t)};i._handleDropdownChange=function(e,t){var r=n.__spreadArrays(i.state.selectedContentTypesIds),s=i.state.selectedContentTypeToViewInfoId;if(t.selected)r.push(t.key);else{r=r.filter(function(e){return e!==t.key});s&&s===t.key&&(s=void 0)}i.props.onContentTypeSelected(r);i.setState(n.__assign(n.__assign({},i.state),{selectedContentTypesIds:r,selectedContentTypeToViewInfoId:s}))};i._handleAddedContentTypeSelect=function(e){if(e.columns)i.setState(n.__assign(n.__assign({},i.state),{isLoadingContentTypeColumn:!1,selectedContentTypeToViewInfoId:e.id,isSelectedAnAddedContentType:!0,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));else{i.setState(n.__assign(n.__assign({},i.state),{isLoadingContentTypeColumn:!0,selectedContentTypeToViewInfoId:e.id,isSelectedAnAddedContentType:!0,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));i._updateColumnsOfAddedContentType(e)}};i._handleSelect=function(e){return n.__awaiter(i,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(s){t=c.deepCopy(this.state.availableContentTypes);r=void 0;for(i=0;i<t.length;i++)if(t[i].id===e){r=i;break}if(t[r].columns)this.setState(n.__assign(n.__assign({},this.state),{selectedContentTypeToViewInfoId:e,isLoadingContentTypeColumn:!1,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));else{this._updateColumns(t,r);this.setState(n.__assign(n.__assign({},this.state),{isLoadingContentTypeColumn:!0,selectedContentTypeToViewInfoId:e,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}return[2]})})};i._onRenderAddedCTItem=function(e,t){return r.createElement(u.DefaultButton,{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container"+(e.isSelected?" ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container-selected":""),onClick:function(){return i._handleAddedContentTypeSelect(e)},key:e.id,styles:{label:{fontWeight:400}},ariaLabel:i._getAriaLabelforAddedCT(e.name,t+1)},e.name)};i._updateColumnsOfAddedContentType=function(e){return n.__awaiter(i,void 0,void 0,function(){var t=this;return n.__generator(this,function(r){this.props.getListContentTypeColumns(e.id).then(function(r){for(var i=c.deepCopy(t.state.addedContentTypes),s=0;s<i.length;s++)if(i[s].id===e.id){i[s].columns=r;break}t.setState(n.__assign(n.__assign({},t.state),{addedContentTypes:n.__spreadArrays(i),isLoadingContentTypeColumn:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}).catch(function(e){t.props.onError()});return[2]})})};i._updateColumns=function(e,t){return n.__awaiter(i,void 0,void 0,function(){var r=this;return n.__generator(this,function(i){this.props.getContentTypeColumns(e[t].id).then(function(i){e[t].columns=i;r.setState(n.__assign(n.__assign({},r.state),{availableContentTypes:n.__spreadArrays(e),isLoadingContentTypeColumn:r.state.selectedContentTypeToViewInfoId!==e[t].id&&r.state.isLoadingContentTypeColumn,isSelectedAnAddedContentType:r.state.selectedContentTypeToViewInfoId!==e[t].id&&r.state.isSelectedAnAddedContentType,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}).catch(function(e){r.props.onError()});return[2]})})};i._handleListCheckboxChangeWrapper=function(e){return function(t,n){return i._handleListCheckboxChange(n,e)}};i._handleListCheckboxChange=function(e,t){if(!e){var r=n.__spreadArrays(i.state.selectedContentTypesIds),s=i.state.selectedContentTypeToViewInfoId;r=r.filter(function(e){return e!==t});s&&s===t&&(s=void 0);i.props.onContentTypeSelected(r);i.setState(n.__assign(n.__assign({},i.state),{selectedContentTypesIds:r,selectedContentTypeToViewInfoId:s}))}};i._handleCreateNewViewToggle=function(e){h.Engagement.logData({name:"ContentTypeManagementPanel.CreateNewViewToggle."+(e?"Enabled":"Disabled")});for(var t=c.deepCopy(i.state.availableContentTypes),r=0;r<t.length;r++)if(t[r].id===i.state.selectedContentTypeToViewInfoId){t[r]=n.__assign({},t[r]);t[r].createNewView=e;break}i.setState(n.__assign(n.__assign({},i.state),{availableContentTypes:n.__spreadArrays(t)}))};i._handleAddColumnsToCurrentViewToggle=function(e){h.Engagement.logData({name:"ContentTypeManagementPanel.AddColumnsToCurrentViewToggle."+(e?"Enabled":"Disabled")});for(var t=c.deepCopy(i.state.availableContentTypes),r=0;r<t.length;r++)if(t[r].id===i.state.selectedContentTypeToViewInfoId){t[r]=n.__assign({},t[r]);t[r].addColumnsToCurrentView=e;break}i.setState(n.__assign(n.__assign({},i.state),{availableContentTypes:n.__spreadArrays(t)}))};i._handleRemoveContentTypeClick=function(e,t){h.Engagement.logData({name:"ContentTypeManagementPanel.DeleteClick"});var r=new l.Qos({name:"ContentTypeManagementPanel.DeleteContentType"});i.props.removeContentType(e).then(function(){return n.__awaiter(i,void 0,void 0,function(){var i,s,o;return n.__generator(this,function(u){switch(u.label){case 0:r.end({resultType:l.ResultTypeEnum.Success,extraData:{contentTypeId:e}});i=(i=c.deepCopy(this.state.addedContentTypes)).filter(function(t){return t.id!==e});return[4,this.props.getContentType(t)];case 1:(s=u.sent()).createNewView=!1;s.addColumnsToCurrentView=!1;(o=c.deepCopy(this.state.availableContentTypes)).push(s);this.setState(n.__assign(n.__assign({},this.state),{availableContentTypes:n.__spreadArrays(o),addedContentTypes:n.__spreadArrays(i),selectedContentTypeToViewInfoId:void 0,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:void 0,cannotBeRemovedError:void 0}));return[2]}})})}).catch(function(t){if(400===t.status){r.end({resultType:l.ResultTypeEnum.ExpectedFailure,error:t,extraData:{contentTypeId:e}});i.setState(n.__assign(n.__assign({},i.state),{hasCannotBeRemovedError:!0,cannotBeRemovedError:t.message}))}else{r.end({resultType:l.ResultTypeEnum.Failure,error:t,extraData:{contentTypeId:e}});i.props.onError()}})};i._dismissError=function(){i.setState(n.__assign(n.__assign({},i.state),{hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))};i.getSelectedContentTypesWithView=function(){var e=[];n.__spreadArrays(i.state.availableContentTypes).forEach(function(t){i.state.selectedContentTypesIds.find(function(e){return e===t.id})&&e.push(c.deepCopy(t))});return e};i.state={availableContentTypes:c.deepCopy(i.props.availableContentTypes),selectedContentTypesIds:[],addedContentTypes:c.deepCopy(i.props.addedContentTypes),selectedContentTypeToViewInfoId:void 0,isLoadingContentTypeColumn:!0,isSelectedAnAddedContentType:!1,hasError:i.props.hasErrorOccurred,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0};return i}t.getDerivedStateFromProps=function(e,t){return n.__assign(n.__assign({},t),{hasError:t.hasError||e.hasErrorOccurred})};t.prototype.render=function(){var e=this,t=this.props.strings;if(this.state.hasError&&!this.state.hasCannotBeRemovedError)return r.createElement(r.Fragment,null,r.createElement(a.MessageBar,{isMultiline:!1,messageBarType:a.MessageBarType.error},this.props.errorStrings.genericErrorMessage));var l=[],h=void 0;this.state.availableContentTypes.forEach(function(t){e.state.selectedContentTypesIds.find(function(e){return e===t.id})&&l.push(c.deepCopy(t));e.state.isSelectedAnAddedContentType||t.id!==e.state.selectedContentTypeToViewInfoId||(h=c.deepCopy(t))});if(this.state.isSelectedAnAddedContentType)for(var v=0;v<this.state.addedContentTypes.length;v++)if(this.state.addedContentTypes[v].id===this.state.selectedContentTypeToViewInfoId){h=c.deepCopy(this.state.addedContentTypes[v]);break}var g=this.state.availableContentTypes.map(function(t){return{key:t.id,text:t.name,selected:void 0!==e.state.selectedContentTypesIds.find(function(e){return e===t.id})}}),y=[{key:"checkbox",name:"Checkbox",fieldName:"",minWidth:20,onRender:function(t){return r.createElement(s.Checkbox,{checked:!0,onChange:e._handleListCheckboxChangeWrapper(t.id),className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox",ariaLabel:t.name})}},{key:"button",name:"Button",fieldName:"",minWidth:20,className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCT-button-cell",styles:{root:{width:"100%"}},onRender:function(t){return r.createElement(u.DefaultButton,{text:t.name,className:"ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton",onClick:function(){return e._handleSelect(t.id)},styles:{label:{fontWeight:400}}})}}],b=new m.Selection;b.setItems(l.map(function(e){return n.__assign(n.__assign({},e),{key:e.id})}));return r.createElement("div",{className:"ms-ContentTypeManagementPanel"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel"},r.createElement("div",{role:"form"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Title"},t.title),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown"},r.createElement(i.Dropdown,{placeholder:t.dropdownNoneLabel,label:t.dropdownLabel,selectedKeys:n.__spreadArrays(this.state.selectedContentTypesIds),onChange:this._handleDropdownChange,multiSelect:!0,options:g,onRenderTitle:this._onRenderDropdownTitle,disabled:0===this.state.availableContentTypes.length,styles:{label:{color:"#323130"}}})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentTypes"},r.createElement(p.FocusZone,{direction:p.FocusZoneDirection.vertical,isCircularNavigation:!0,isInnerZoneKeystroke:this._isInnerZoneKeystroke,role:"grid"},l.map(function(t,i){return r.createElement(m.DetailsRow,{key:t.id,item:n.__assign(n.__assign({},t),{key:t.id}),itemIndex:i,columns:y,selectionMode:m.SelectionMode.none,selection:b,styles:{root:{display:"block",width:"100%",height:"36px",border:"none",backgroundColor:e.state.selectedContentTypeToViewInfoId===t.id?"#F3F2F1":void 0},cell:{padding:"0px"}}})}))),this.state.addedContentTypes.length>0&&r.createElement(r.Fragment,null,r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label"},r.createElement("b",null,t.addedContentTypes)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes"},r.createElement(p.FocusZone,{direction:p.FocusZoneDirection.vertical,isCircularNavigation:!0},r.createElement(d.List,{items:this.state.addedContentTypes.map(function(t){return n.__assign(n.__assign({},t),{isSelected:e.state.selectedContentTypeToViewInfoId&&e.state.selectedContentTypeToViewInfoId===t.id})}),onRenderCell:this._onRenderAddedCTItem}))))))),r.createElement(f.Separator,{vertical:!0}),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel"},r.createElement(o.SecondaryPanel,{selectedContentTypeToViewInfo:h||void 0,isSelectedAnAddedContentType:this.state.isSelectedAnAddedContentType,strings:this.props.strings,errorStrings:this.props.errorStrings,cannotBeRemovedError:this.state.cannotBeRemovedError,handleCreateNewViewToggle:this._handleCreateNewViewToggle,handleAddColumnsToCurrentViewToggle:this._handleAddColumnsToCurrentViewToggle,removeContentType:this._handleRemoveContentTypeClick,dismissErrorMessage:this._dismissError})))};t.prototype._getAriaLabelforAddedCT=function(e,t){try{return g.format(this.props.strings.ariaLabelAddedCT,e,t,this.state.addedContentTypes.length)}catch(e){}};return t})(r.PureComponent);t.ContentTypeManagementPanelContent=y});
define("DWe",["require","exports","lC","r","pd","Zd","sre","am","Au","Ee","Ol","YF"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.renderPanelContent=function(){var e=f.deepCopy(t.props.selectedContentTypeToViewInfo),n=t.props.strings;return r.createElement(r.Fragment,null,!t.props.selectedContentTypeToViewInfo.columns&&r.createElement(s.Spinner,{size:s.SpinnerSize.large}),t.props.selectedContentTypeToViewInfo.columns&&r.createElement("div",null,!t.props.isSelectedAnAddedContentType&&r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle"},r.createElement(o.Toggle,{onText:n.createNewViewLabel,offText:n.createNewViewLabel,onChange:t._onCreateNewViewToggle,checked:!!t.props.selectedContentTypeToViewInfo.createNewView})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-column"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-row"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.nameLabel,e.name)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.parentLabel,e.parentReference.name))),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-row"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.descriptionLabel,e.description)))),!t.props.isSelectedAnAddedContentType&&r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView"},r.createElement(o.Toggle,{onText:n.addColumnCurrentViewLabel,offText:n.addColumnCurrentViewLabel,onChange:t._onAddColumnsToCurrentViewToggle,checked:!!t.props.selectedContentTypeToViewInfo.addColumnsToCurrentView})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Columns"},r.createElement("b",null,n.columnsLabel)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable"},t.renderFieldsTable()),t.props.cannotBeRemovedError&&r.createElement(c.MessageBar,{dismissButtonAriaLabel:n.closeButtonAriaLabel,messageBarType:c.MessageBarType.error,isMultiline:!0,onDismiss:t.props.dismissErrorMessage},t.props.cannotBeRemovedError),t.props.isSelectedAnAddedContentType&&r.createElement(l.Fabric,null,r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Buttons ms-ContentTypeManagementPanel-Button"},t.renderDeleteWithTooltip()))))};t._onCreateNewViewToggle=function(e,n){t.props.handleCreateNewViewToggle(n)};t._onAddColumnsToCurrentViewToggle=function(e,n){t.props.handleAddColumnsToCurrentViewToggle(n)};t._onRemoveContentTypeWrapper=function(e){t.props.removeContentType(t.props.selectedContentTypeToViewInfo.id,t.props.selectedContentTypeToViewInfo.parentReference.id)};t.renderKeyValueText=function(e,t,n){return r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-column"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},r.createElement("b",null,e)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},n?r.createElement(i.Link,{href:n}):t))};t.renderFieldsTable=function(){var e=t.props.strings;return r.createElement(r.Fragment,null,r.createElement("table",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,e.secondaryPanelFieldsListNameDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListTypeDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListStatusDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListSourceDisplayName))),r.createElement("tbody",null,t.props.selectedContentTypeToViewInfo.columns.map(function(e){return r.createElement("tr",{key:e.id},r.createElement("td",null,e.displayName),r.createElement("td",null,e.typeDisplayName),r.createElement("td",null,e.required?"Required":"Optional"),r.createElement("td",null,e.sourceContentType?e.sourceContentType.name:""))}))))};t.renderDeleteWithTooltip=function(){return t.props.selectedContentTypeToViewInfo?t.props.selectedContentTypeToViewInfo.readOnly?r.createElement(a.TooltipHost,{content:t.props.strings.tooltipReadonlyCT},t.renderDeleteButton()):t.renderDeleteButton():r.createElement(r.Fragment,null," ")};t.renderDeleteButton=function(){return r.createElement("div",null,r.createElement(u.PrimaryButton,{onClick:t._onRemoveContentTypeWrapper,disabled:t.props.selectedContentTypeToViewInfo&&t.props.selectedContentTypeToViewInfo.readOnly},t.props.strings.removeContentTypeButtonLabel))};return t}t.prototype.render=function(){return r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Content",role:"region"},void 0===this.props.selectedContentTypeToViewInfo?this.props.strings.defaultSecondaryPanelLabel:this.props.strings.contentTypeInformationLabel,r.createElement("br",null),void 0!==this.props.selectedContentTypeToViewInfo?this.renderPanelContent():"")};return t})(r.PureComponent);t.SecondaryPanel=h});
define("kWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchColumnCustomizationPaneAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchColumnCustomizationPaneAction))(t)})});
define("MWe",["require","exports","lC","r","ks","c0","mG","X4e","S$","QH","li","ii","Gk","rs","eC","mK","pK","VK","UK","zK","Y"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._panelProvider=n.props.resources.consume(o.resourceKey);n._updateItemsScopeCurrentDerivedView=n.props.resources.consume(a.itemsScopeCurrentDerivedViewUpdatorResourceKey);n._operationProvider=n.props.resources.consume(y.resourceKey);return n}t.prototype.render=function(){var e=this;return r.createElement(i.Action,{isAvailable:!0,onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){var e,t=this;return n.__generator(this,function(n){e=this._panelProvider.requestPanel({hasCommandBar:!0,component:{name:u.default.tagName,params:{onComplete:function(n){var r=!1;t._updateItemsScopeCurrentDerivedView(function(e){r=e.isDirty();e.replaceFields(n);return e});var i=t.props.resources.consume(m.isItemsScopeEnabledResourceKey);f.isFeatureEnabled(f.ColumnFieldsAutoSave)&&i&&t.props.resources.consumeAsync(d.resourceKey).then(function(e){t.props.resources.consumeAsync(v.resourceKey).then(function(n){var i,s,o=e.dispatch(p.readItems(function(e){var t=e.demandItemFacet(l.spFolderItemSetKeyFacet,n.peek());return{setKey:t,viewKey:t&&t.viewKey&&l.spViewKeyFacet.serialize(t.viewKey)}}));if(o.setKey&&o.viewKey){if(e.dispatch(p.readItems(function(e){var t=e.demandItemFacet(c.listFacet,l.spListKeyFacet.serialize({webAbsoluteUrl:o.setKey.webAbsoluteUrl,listFullUrl:o.setKey.listFullUrl}));return!!(t&&t.permissions&&t.permissions.manageLists)}))){var u=t._operationProvider.register({name:"",type:g.default.editViewColumns,payloads:{}});u.state(b.default.started);e.dispatch(h.saveViewCore({items:(i={},i[l.spListViewsSetKeyFacet.serialize(o.setKey)]={views:(s={},s[o.viewKey]={shouldSaveViewFieldsOnly:!0},s),qosName:"autoSaveShowHide"},i)})).then(function(){!1===r&&t._updateItemsScopeCurrentDerivedView(function(e){e.baseViewXml=e.getEffectiveViewXml();return e});u.state(b.default.completed)},function(e){w.default.logError(e,{eventName:"ShowHideAutoSave",feature:"ColumnFieldsAutoSave",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});t._updateItemsScopeCurrentDerivedView(function(e){e.setIsDirty(!0);return e});u.state(b.default.failed);throw e})}}})});e.state(1)}}}});return[2]})})}})};return t})(r.PureComponent);t.LaunchColumnsEditorPanelAction=s.withResources()(E)});
define("X4e",["require","exports","o9e","i9e","QB","SPListItemsScopeDeferred_IS_mini_css","UJ","Z4e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-columns-editor",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("o9e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-ColumnsEditor-commandBar" data-bind="control:commandBarSpecification"></div><div class="od-ColumnsEditor-contentContainer" data-bind="scrollContainer:{}" role="group"><h2 class="od-ColumnsEditor-title ms-font-xl ms-fontWeight-semilight" data-bind="text:strings.columnsEditorTitle"></h2><p id="descriptionList" class="od-ColumnsEditor-helpText" data-bind="text:strings.columnsEditorHelpText"></p>\x3c!--ko if:hasData--\x3e<ol aria-describedby="descriptionList" aria-multiselectable="false" class="od-ColumnsEditor-list" data-bind="keyboard:{allowButtonEvents:true,useRtlMappings:true,mappings:{Enter:onKeyEnter,Space:onKeyEnter,Left:onKeyLeft,Right:onKeyRight}},selection:{data:columns,mode:\'single\',direction:\'vertical\',focused:focusedColumn,selected:selectedColumns,selectionModel:selectionModel,allowInputEvents:true},attr:{tabindex:!focusedColumn()?0:-1},component:{name:\'od-sortable\',params:{dragProxyClass:\'od-ColumnsEditor-dragProxy\',items:columns}}">\x3c!--ko with:$host.item--\x3e<li class="od-ColumnsEditor-listItem" role="checkbox" data-bind="attr:{tabindex:$parent.focusedColumn()===$data?0:-1,\'aria-checked\':checked,\'aria-selected\':selected,\'aria-label\':displayName,\'data-draggable\':String(isEditable)},css:{\'is-childFocused\':childFocused,\'is-editable\':isEditable},hasChildFocus:childFocused,delayedHasFocus:focused"><label class="od-ColumnsEditor-itemLabel"><div class="od-CheckBox"><input tabindex="-1" class="od-CheckBox-input" type="checkbox" data-bind="checked:checked,enable:isEditable"><label class="od-CheckBox-field" data-bind="css:{\'is-checked\':checked}"><span class="od-ColumnsEditor-itemText od-Label" data-bind="attr:{title:displayName},text:displayName"></span></label></div></label>\x3c!--ko if:isEditable--\x3e<div class="od-ColumnsEditor-itemButtons"><button class="od-ColumnsEditor-button" tabindex="-1" data-bind="click:$parent.onClickMoveUp.bind($parent,$data),delayedHasFocus:moveUpFocused,attr:{title:$parent.strings.columnsEditorMoveUpTooltip},keyboard:{mappings:{Space:$parent.onClickMoveUp.bind($parent,$data)}}"><i aria-hidden="true" class="ms-Icon ms-Icon--ChevronUp" data-bind="icon:true"></i></button><button class="od-ColumnsEditor-button" tabindex="-1" data-bind="click:$parent.onClickMoveDown.bind($parent,$data),delayedHasFocus:moveDownFocused,attr:{title:$parent.strings.columnsEditorMoveDownTooltip},keyboard:{mappings:{Space:$parent.onClickMoveDown.bind($parent,$data)}}"><i aria-hidden="true" class="ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e</ol>\x3c!--/ko--\x3e\x3c!--ko ifnot:hasData--\x3e<span class="ms-font-m" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:strings.columnsEditorLoadingText}}"></span>\x3c!--/ko--\x3e</div>'});
define("i9e",["require","exports","lC","tG","a$","QSe","px","i6e","vh","lG","zB","dG","e","LJ","r9e","iG","F1e","R1e","JB","YSe","UJ","e$","lj","tX"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INTERNAL_COLUMNS={_CopySource:!0,_dlc_DocId:!0,_dlc_DocIdUrl:!0,_ip_UnifiedCompliancePolicyProperties:!0,_ip_UnifiedCompliancePolicyUIAction:!0,_ModerationComments:!0,_UIVersionString:!0,_x0074_wb0:!0,AppAuthor:!0,AppEditor:!0,CheckoutUser:!0,ContentType:!0,Edit:!0,FileLeafRef:!0,LastSharedByTime:!0,LastSharedByUser:!0,LikesCount:!0,LinkFilenameNoMenu:!0,LinkTitle2:!0,LinkTitleNoMenu:!0,ParentLeafName:!0,ParentVersionString:!0,RatingCount:!0,SharedWithDetails:!0,SharedWithUsers:!0,Title:!0,URLwMenu2:!0,URLNoMenu:!0,URL:!0};var T=(function(e){n.__extends(y,e);function y(n){var s=e.call(this)||this;s.loadingSpinnerTagName=w.default.tagName;s._currentView=s.resources.consume(o.currentView);s.addBindingHandlers({hasChildFocus:r.default,keyboard:c.default,scrollContainer:v.default,selection:m.default,delayedHasFocus:u.default,control:S.default});s._onComplete=n.onComplete;s.columns=h.observableArray();s.commandSet={commands:h.observableArray([new i.default({text:d.default.columnsEditorApplyCommand,icon:new l.default("CheckMark"),callback:function(){s._applyViewFieldsOverride()}})])};s.commandBarSpecification=S.toSpecification(E.resourceKey,{commandSet:s.commandSet});s.focusedColumn=h.observable();s.selectedColumns=h.observableArray();s.selectionModel=new g.default;s.hasData=h.observable(!1);s.strings=d.default;s._dataManager=s.resources.consume(x.dataManager.optional);var a=s.resources.consume(p.resourceKey),f=s.resources.consume(o.currentItemSet),T=s.addDisposable(f().schema.filter(function(e){return y._isColumnVisible(e)})),N=s.addDisposable(T.map(function(e){return s._initializeEditableColumn({checked:h.observable(!0),displayName:e.name||e.internalName,internalName:e.internalName,isEditable:y._isColumnEditable(e)})})),C=s.addDisposable(a.fields.filter(function(e){var n=N().some(function(t){return t.internalName===e.internalName});return e&&!e.isHidden&&!n&&!t.INTERNAL_COLUMNS[e.internalName]&&-1===b.EXCLUDED_FIELDS.indexOf(e.internalName)})),k=s.addDisposable(C.map(function(e){return s._initializeEditableColumn({checked:h.observable(!1),displayName:s._getDisplayName(e),internalName:e.internalName,isEditable:!0})}));a.getFields(!0).then(function(){s.columns(N().concat(k()));s.hasData(!0)});return s}y._isColumnEditable=function(e){return y._isColumnVisible(e)};y._isColumnVisible=function(e){return e&&(e.isVisible||e.isVisibleMobile)&&"_calloutInvoker"!==e.key&&"_shareHeroCommand"!==e.key&&!!e.internalName&&-1===b.EXCLUDED_FIELDS.indexOf(e.internalName)};y.prototype.onClickMoveUp=function(e){this._maintainButtonFocus(e);this._shiftColumnIndex(e,-1)};y.prototype.onClickMoveDown=function(e){this._maintainButtonFocus(e);this._shiftColumnIndex(e,1)};y.prototype.onToggleCheckbox=function(){var e=this.focusedColumn();e&&e.isEditable&&e.checked(!e.checked());return!1};y.prototype.onKeyEnter=function(e,t){if(f.isButtonElement(t.target))return!0;var n=this.focusedColumn();n&&n.isEditable&&n.checked(!n.checked());return!1};y.prototype.onKeyLeft=function(e,t){var n=this.focusedColumn();if(n){var r=this.focusedColumn().moveUpFocused;(0,this.focusedColumn().moveDownFocused)()?r(!0):r()&&n.focused(!0)}return!1};y.prototype.onKeyRight=function(e,t){if(this.focusedColumn()){var n=this.focusedColumn().moveUpFocused,r=this.focusedColumn().moveDownFocused;r()||(n()?r(!0):n(!0))}return!1};y.prototype._getDisplayName=function(e){return 1===s.default.getMappedColumnType(e.internalName)?e.internalName:e.title||e.internalName};y.prototype._applyViewFieldsOverride=function(){this.resources.consume(a.resourceKey).logData({name:"ColumnsEditor.ApplyViewFields",isIntentional:!0});var e=this._getFieldNames();this._currentView.peek().replaceFields(e);this._currentView.valueHasMutated();this._onComplete&&this._onComplete(e)};y.prototype._getFieldNames=function(){return this.columns().filter(function(e){return e.checked()}).map(function(e){return e.internalName})};y.prototype._initializeEditableColumn=function(e){e.childFocused=h.observable(!1);e.focused=h.observable(!1);e.key=e.internalName;e.moveDownFocused=h.observable(!1);e.moveUpFocused=h.observable(!1);e.selected=h.observable(!1);return e};y.prototype._maintainButtonFocus=function(e){var t=e.moveUpFocused.peek(),n=e.moveDownFocused.peek(),r=this.subscribe(this.focusedColumn,function(i){if(e===i){r.dispose();e.moveUpFocused(!1);e.moveDownFocused(!1);e.moveUpFocused(t);e.moveDownFocused(n)}})};y.prototype._shiftColumnIndex=function(e,t){var n=this.columns(),r=n.indexOf(e),i=r+t;if(r!==(i=Math.max(Math.min(i,n.length-1),0))){var s=n[i];if(e.isEditable&&s.isEditable){n[i]=n[r];n[r]=s;this.columns(n)}}};return y})(y.default);t.default=T});
define("QSe",["require","exports","lC","e","m7","px","S3","X0","mv","YSe"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getListSchema=function(e){var t=e.listSchema,n=e.resources,r=e.groupSchema,i=e.hasFixedSchema,l=e.listContext,h=e.getItemContext,p=e.sortFallback,d=n.consume(s.disableShareHeroCommand.optional),v=n.consume(a.platformDetection).isMobile&&n.consume(s.useMobileList.optional);l||(l=n.consume(o.listContext));var m={hasFixedSchema:i,serverSupportsAutoHyperLink:!1,useCustomColumn:v,disableShareHeroCommand:d},g=f.SchemaBuilder.buildSchema(t,l,m,r,h),y=n.consume(o.pageContext),b=Number(y.webTemplate)===u.default.mySite;return g.filter(function(e){return!b||"ItemChildCount"!==e.internalName&&"FolderChildCount"!==e.internalName}).map(function(e){e.groupable=!b&&e.groupable;if(p.sortField===e.internalName&&p.sortDirection){e.isSorted=!0;e.isAscending="ascending"===p.sortDirection}return c(e,l)})};var l=(function(){function e(){}e.getCustomColumns=function(e,t,n){var r=this,i=this._convertToSPColumn(e),s=t.map(function(e){return e.map(function(e){return r._convertToSPColumn(e)})}),o=n.map(function(e){return r._convertToSPColumn(e)});return f.SchemaBuilder.getCustomColumns(i,s,o).map(function(e){return c(e)})};e.getMappedColumnType=function(e){return f.SchemaBuilder.getMappedColumnType(e)};e.getIconColumnWidth=function(e){return e.consume(a.platformDetection).isMobile&&e.consume(s.useMobileList.optional)?48:16};e.getIconColumnMinWidth=function(e){return e.consume(a.platformDetection).isMobile&&e.consume(s.useMobileList.optional)?48:16};e.fillColumnDefinitionDefaults=function(e,t,s){void 0===t&&(t={});void 0===s&&(s={});var o=t.isCollapsible,u=void 0===o||o;return e.map(function(e,o){var a=e.isIcon,f=void 0!==a&&a,l=e.sortable,c=void 0===l?!!t.sortable:l,h=e.resizable,p=void 0===h?!!t.resizable:h,d=e.isCollapsable,v=void 0===d?u:d,m=e.fieldType,g=void 0===m?i.ColumnFieldType.Text:m,y=e.name,b=e.getValue,w=e.key,E=e.width,S=!!s.sortField&&s.sortField===e.internalName,x=!!s.groupBy&&s.groupBy===e.internalName;return n.__assign(n.__assign({},e),{key:w,name:y,width:E,index:o,fieldType:g,isCollapsable:v,isIcon:f,isVisible:!0,isVisibleMobile:!0,isGrouped:x,sortable:c,isSorted:S,isAscending:S&&s.isAscending,filterable:!1,isFocused:r.observable(!1),getValue:b,resizable:p})})};e._convertToSPColumn=function(e){var t=this;return n.__assign(n.__assign({},e),{isFiltered:e.isFiltered&&e.isFiltered.peek(),filterValues:e.filterValues&&e.filterValues.peek(),customWidth:e.customWidth&&e.customWidth.peek(),clientSideColumnAdapter:e.clientSideColumnAdapter,customFields:e.customFields&&e.customFields.map(function(e){return t._convertToSPColumn(e)})})};return e})();t.default=l;function c(e,t){return n.__assign(n.__assign({},e),{key:h(e.key),clientSideColumnAdapter:e.clientSideColumnAdapter,isFiltered:r.observable(e.isFiltered),isMenuOpen:r.observable(!1),isFocused:r.observable(!1),customWidth:r.observable(0),filterValues:r.observable(e.filterValues),customFields:e.customFields?e.customFields.map(function(e){return c(e,t)}):void 0})}function h(e){var t;switch(e){case"FileSizeDisplay":t="size";break;default:t=e}return t}});
define("YSe",["require","exports","lC","dU","cU","p7","N7","B7","W7"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t)});
define("Z4e",["require","exports","n9e","QB","e9e","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-sortable",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("n9e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-Sortable" data-bind="autoScroll:{enabled:autoScrollEnabled,y:autoScrollY},element:element,event:{mouseup:onMouseUp.bind($data),touchend:onTouchEnd.bind($data)},foreach:{afterMove:onAfterMove.bind($data),afterRender:onAfterRender.bind($data),data:items}">\x3c!--ko host:{data:{item:$data}}--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:proxyOverlayVisible--\x3e\x3c!--ko component:{name:overlayTagName}--\x3e<div class="od-Sortable--proxyOverlay" data-bind="element:proxyOverlayElement"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("e9e",["require","exports","lC","t9e","S7","fG","Jz","e","x7","D7","iG","JB","Bz"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=t.items,a=t.dragProxyClass,f=void 0===a?void 0:a,c=t.placeholderClass,p=void 0===c?void 0:c;n.addBindingHandlers({autoScroll:r.default,element:s.default,host:o.default});n.overlayTagName=h.default.tagName;n.autoScrollEnabled=u.observable(!1);n.autoScrollY=u.observable(0);n.element=u.observable(null);n.items=i;n.proxyOverlayElement=u.observable(null);n.proxyOverlayVisible=u.observable(!1);n._dragProxyClass=f;n._placeholderClass=p;n._draggables=[];n._scrollParent=n.createPureComputed(function(){if(n.element())return l.getScrollContainer(n.element())});n.subscribe(n._scrollParent,function(e){n.events.off(e,"scroll",n._onScroll)},!0);n.subscribe(n._scrollParent,function(e){n.events.on(e,"scroll",n._onScroll)});n.events.on(document.body,"dragend",n.onMouseUp);n.events.on(document.body,"mousemove",n._onMouseMove);n.events.on(document.body,"touchmove",n._onTouchMove);n.events.on(document,"mouseup",n.onMouseUp);return n}t.prototype.onAfterMove=function(e,t,n){if(e.nodeType===Node.ELEMENT_NODE){var r=this._getDraggableByData(n);if(r){r.element=e;r.bounds=this._getDraggableBounds(r);r.dataIndex=this.items.peek().indexOf(n)}}};t.prototype.onAfterRender=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i.nodeType===Node.ELEMENT_NODE){var s=i.getAttribute("data-draggable");s&&"true"!==s||this._addDraggable(i,t);break}}};t.prototype.onMouseUp=function(e){0===e.button&&this._onDragEnd()};t.prototype.onTouchEnd=function(e){if(this._touchTimerId){this.async.clearTimeout(this._touchTimerId);this._touchTimerId=void 0}var t=!0;this._activeDraggable||(t=!1);this._onDragEnd();return!t};t.prototype._addDraggable=function(e,t){var n={bounds:null,data:t,dataIndex:this.items.peek().indexOf(t),element:e,isDragging:!1};u.utils.domData.set(e,"dragdata",n);this.events.on(e,"mousedown",this._onMouseDown);this.events.on(e,"touchstart",this._onTouchStart);n.bounds=this._getDraggableBounds(n);this._draggables.push(n)};t.prototype._createPlaceholder=function(e){this._placeholder&&this._destroyPlaceholder();var t=e.nodeName.toLowerCase(),n=document.createElement(t);if(this._placeholderClass)i.default.toggleClass(n,this._placeholderClass,!0);else{var r=window.getComputedStyle(e);n.style.margin=r.margin;n.style.padding=r.padding;n.style.width=r.width;n.style.height=r.height}e.parentElement.insertBefore(n,e.nextElementSibling);this._placeholder={baseElement:e,baseElementDisplay:e.style.display,draggable:u.utils.domData.get(e,"dragdata"),element:n};e.style.display="none"};t.prototype._createProxy=function(e,t){this._proxy&&this._destroyProxy();this.proxyOverlayVisible(!0);var n=e.cloneNode(!0),r=window.getComputedStyle(e),s={left:parseInt(r.marginLeft,10)||0,top:parseInt(r.marginTop,10)||0,right:parseInt(r.marginRight,10)||0,bottom:parseInt(r.marginBottom,10)||0};n.removeAttribute("id");n.style.width=r.width;n.style.height=r.height;i.default.toggleClass(n,"is-dragging",!0);i.default.toggleClass(n,"od-Sortable--proxy",!0);this._dragProxyClass&&i.default.toggleClass(n,this._dragProxyClass,!0);var o=e.parentElement,u=e.nextElementSibling;this.proxyOverlayElement.peek().appendChild(n);var l=new a.default(t),c=e.getBoundingClientRect();l=(l=l.subtract(new a.default(c.left,c.top))).add(new a.default(s.left,s.top));var h=new a.default;if(e.offsetParent){var p=e.offsetParent.getBoundingClientRect();h.x=p.left;h.y=p.top}this._proxy={bounds:new f.default(0,0,n.offsetWidth,n.offsetHeight),clickOffset:l,element:n,margins:s,parentOffset:h,parentElement:o,nextElementSibling:u};this._updateProxyPosition(t);this._createPlaceholder(e)};t.prototype._destroyPlaceholder=function(){if(this._placeholder){this._placeholder.element&&this._placeholder.element.parentElement&&this._placeholder.element.parentElement.removeChild(this._placeholder.element);this._placeholder.baseElement&&(this._placeholder.baseElement.style.display=this._placeholder.baseElementDisplay);this._placeholder=null}};t.prototype._destroyProxy=function(){if(this._proxy){var e=this._proxy.element;e&&e.parentElement&&e.parentElement.removeChild(e);this.autoScrollEnabled(!1);this.proxyOverlayVisible(!1);this._proxy=null}};t.prototype._findNearestDraggable=function(){for(var e=null,t=this._proxy.bounds.getCenter(),n=4294967295,r=0,i=this._draggables;r<i.length;r++){var s=i[r],o=s.bounds.getCenter(),u=t.distance(o);if(u<n){n=u;e=s}}return e};t.prototype._getDraggableBounds=function(e){var t=i.default.calculateSubtreeRect(e.element),n=e.element.offsetParent,r=this._scrollParent.peek();if(n&&r){var s=n.getBoundingClientRect();t=(t=t.translate(-s.left,-s.top)).translate(new a.default(r.scrollLeft,r.scrollTop))}return t};t.prototype._getDraggableByData=function(e){for(var t=0,n=this._draggables;t<n.length;t++){var r=n[t];if(r.data===e)return r}return null};t.prototype._onDragEnd=function(){if(this._activeDraggable){if(this._placeholder){var e=this._activeDraggable.dataIndex,t=this._placeholder.draggable.dataIndex;this._destroyProxy();this._destroyPlaceholder();if(e!==t){var n=this.items.peek();n.splice(t,0,n.splice(e,1)[0]);this.items(n)}}this._activeDraggable.isDragging=!1;this._activeDraggable=null}};t.prototype._onDragMove=function(e){if(this._proxy){this._updateProxyPosition(e);this._updatePlaceholder()}this._lastDragOffset=e};t.prototype._onMouseDown=function(e){if(0===e.button){var t=e.currentTarget,n=u.utils.domData.get(t,"dragdata");if(n){this._activeDraggable=n;this._activeDraggable.isDragging=!0;this._startDragPosition=new a.default(e.pageX,e.pageY)}e.preventDefault()}};t.prototype._onMouseMove=function(e){if(this._activeDraggable){var t=new a.default(e.pageX,e.pageY),n=this._startDragPosition.distance(t);!this._proxy&&n>=3&&this._createProxy(this._activeDraggable.element,t);this._onDragMove(t)}};t.prototype._onScroll=function(e){this._lastDragOffset&&this._onDragMove(this._lastDragOffset)};t.prototype._onTouchMove=function(e){var t=e.targetTouches[0],n=new a.default(t.pageX,t.pageY),r=this._startDragPosition.distance(n);if(this._activeDraggable){!this._proxy&&r>=3&&this._createProxy(this._activeDraggable.element,n);this._onDragMove(n);e.preventDefault()}else if(r>5&&this._touchTimerId){this.async.clearTimeout(this._touchTimerId);this._touchTimerId=void 0}};t.prototype._onTouchLongHold=function(e){var t=e.targetTouches[0].target,n=u.utils.domData.get(t,"dragdata");if(n){this._activeDraggable=n;this._activeDraggable.isDragging=!0}this._touchTimerId=void 0};t.prototype._onTouchStart=function(e){var t=e.targetTouches[0];this._touchTimerId&&this.async.clearTimeout(this._touchTimerId);this._startDragPosition=new a.default(t.pageX,t.pageY);this._touchTimerId=this.async.setTimeout(this._onTouchLongHold.bind(this,e),500)};t.prototype._updatePlaceholder=function(){var e=this._findNearestDraggable();if(e&&(!this._placeholder||this._placeholder.draggable!==e)){var t=e.element,n=this._placeholder.element,r=n.parentElement;r.removeChild(n);e.dataIndex<this._activeDraggable.dataIndex?r.insertBefore(n,t):r.insertBefore(n,t.nextElementSibling);this._placeholder.draggable=e}};t.prototype._updateProxyPosition=function(e){var t=new a.default(e),n=this._scrollParent.peek(),r=n?new a.default(n.scrollLeft,n.scrollTop):new a.default,i=t=t.subtract(this._proxy.clickOffset);if(n&&this._proxy&&this._proxy.element&&!a.default.areEqual(this._proxy.bounds.getPoint(),t)){this._proxy.element.style.left=t.x+"px";this._proxy.element.style.top=t.y+"px";t=(t=t.subtract(this._proxy.parentOffset)).add(r);this._proxy.bounds=new f.default(t.x,t.y,this._proxy.bounds.width,this._proxy.bounds.height);this.autoScrollEnabled(!0);this.autoScrollY(i.y)}};return t})(c.default);t.default=p});
define("t9e",["require","exports","lC","ZB","iG","e"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._container=i.getScrollContainer(n.element);var r=s.unwrap(n.valueAccessor()),o=r.enabled,u=void 0===o?s.observable(!1):o,a=r.y,f=void 0===a?s.observable(0):a;n._enabled=u;n._y=f;n.createComputed(n._computeScrollOnYPosition);return n}t.prototype._computeScrollOnYPosition=function(){var e=this._enabled(),t=this._container;this.async.clearTimeout(this._timeoutId);this._timeoutId=null;if(e){var n=t.getBoundingClientRect(),r=this._y(),i=n.top,s=i+n.height,o=0;r<=i+100?o=-(1-(r-n.top)/100):r>=s-100&&(o=1-(n.top+n.height-r)/100)}if(o){t.scrollTop=Math.min(t.scrollHeight-n.height,Math.max(0,t.scrollTop+15*o));this._timeoutId=this.async.setTimeout(this._computeScrollOnYPosition,30)}};return t})(r.default);t.default=o});
define("PWe",["require","exports","px","jKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchNewItemListFormInPanelAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchListFormAction))({item:t.item,type:2,contentTypeId:t.contentTypeId,defaultValueOverride:t.defaultValueOverride,url:t.formUrl})})});
define("TWe",["require","exports","lC","_s","Oy","gv","oh"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPanelAction=r.withSelectedItems()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["oWe"],t,n)})];case 1:return[2,t.sent().LaunchMoveCopyPanelAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1)return!1;var r=e.demandItemFacet(s.launchMoveCopyPanelActionControl,o.odspNextAppItemKey);return!!s.launchMoveCopyPanelActionControl.evaluate(r)(e,t).isAvailable}))});
define("UWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ModifyShowInFiltersPaneAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ModifyShowInFiltersPaneAction))(t)})});
define("FWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PreviewAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.PreviewAction))})});
define("HWe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SyncAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SyncAction))})});
define("RWe",["require","exports","px","RKe","QH"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!0,allowMultiSelect:!i.isOneDrive})},{isToggleable:!0})});
define("NWe",["require","exports","lC","r","v","tv","C1","C_","jKe","px","Ps","dC","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=u.asAutoAction({timeout:3e3})(s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["dWe"],t,n)})];case 1:return[2,t.sent().ShowPermissionsAction]}})})})),d=a.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(f.actionMap);return new(e.injected(n.ShowPermissionsAction))({item:t.item})}),v=o.createItemCacheComponent(function(t,s){var o=s.itemKey,u=t.demandItemFacet(h.mountPointFacet,o,{suppressGetItems:!0}),a=t.dispatch,f=u?function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,s;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["YD"],t,n)})];case 1:t=n.sent().demandItems;r=u&&u.siteUrl;return[4,a(t(function(e){var t=e.demandItemFacet(h.placeInfoFacet,o),n=t&&t.itemKey,i=e.demandItemFacet(h.itemSourcePathFacet,n,{suppressGetItems:!1});return o&&i&&r&&r+"/"+i}))];case 2:if(!(s=n.sent()))throw new i.ApiError({code:"ShortcutOriginalItemUrlFetchFailed",isExpected:!1});window.open(s);return[2]}})})}:l.renderComponentOnExecute(function(e){var t=e.resolve,i=e.reject,o=e.onExecuteProps;return r.createElement(p,n.__assign({},s,{onComplete:t,onError:i,onExecuteProps:o}))},{scope:"global"});return r.createElement(l.ActionBase,{onExecute:f})});t.SharedColumnClickAction=c.isFeatureEnabled(c.ManageAccessActionOnDemand)?v:d});
define("BWe",["require","exports","lC","r","RWe","ss","C1","Ps","F1"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowDetailsPaneAction=o.createItemCacheComponent(function(e,t){var f=a.getItemsScope(e).itemsScopeItemKey,l=t.itemKey;if(!l||!f)return null;var c=e.dispatch,h=o.evaluateItemCacheComponent(e,r.createElement(i.ToggleInfoPaneAction,null));return r.createElement(u.WithAction,{action:h},function(e){var t=e.isToggled,i=e.execute;return r.createElement(u.ActionBase,{onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:c(s.selectItems({itemsScopeItemKey:f,selectedItemKeys:[l],currentSelectionKey:void 0}));return t?[3,2]:[4,i(e)];case 1:n.sent();n.label=2;case 2:return[2]}})})}})})})});
define("jWe",["require","exports","px","jKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowItemAnalyticsAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowItemAnalyticsAction))({item:t.item})})});
define("VWe",["require","exports","px","jKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowKeyPointsPaneAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowKeyPointsAction))({item:t.item,showFeedbackPanel:t.showFeedbackPanel})})});
define("zWe",["require","exports","jKe","px"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PolicyTipAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.PolicyTipAction))({item:t.item})})});
define("GWe",["require","exports","lC","r","c0","O9e","KWe","yh","ks","Xx","C1","YD"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=l.createItemCacheComponent(function(e,t){var i=t.itemKey,l=t.itemKeys,h=t.isMove,p=t.resources;if(!i||0===l.length)return null;var d=e.dispatch,v={name:h?"Move":"Copy",isIntentional:!0,extraData:{count:l.length}};return r.createElement(a.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,r,i,a,l,v,m,g,y;return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.all([p.consumeAsync(s.resourceKey),p.consumeAsync(o.resourceKey)])];case 1:e=n.sent(),r=e[0],i=e[1];return[4,d(c.demandItems(function(e){return(function(e,t){var n=e.demandItemFacet(f.knockoutStoreItemFacet,t.itemKey),r=t.itemKeys.map(function(t){return e.demandItemFacet(f.knockoutStoreItemFacet,t)});return{item:n,items:r}})(e,t)}))];case 2:a=n.sent(),l=a.item,v=a.items;m=(function(e,t){var n=e&&e.peek(),r=[],i=!1;if(n){var s=n.key;n.remoteItem||t.forEach(function(e){var t=e&&e.peek();if(t){var n=t.key,o=t.parentKey;t.remoteItem?i=!0:n!==s&&o!==s&&r.push(t)}})}return{targetItem:n,sourceItems:i?[]:r}})(l,v),g=m.targetItem,y=m.sourceItems;return g&&y&&y.length>0&&r&&i?[4,r.copyItems({items:y,parentKey:g.parentKey,targetId:g.id,targetKey:g.key,cid:i.getOwnerId(),group:g.isGroup?1:0,isAsync:!1,isMove:h})]:[3,5];case 3:n.sent();return[4,p.consumeAsync(u.itemInvalidator)];case 4:n.sent().invalidateItems(g.key);n.label=5;case 5:return[2]}})})},engagement:v})});t.MoveCopyAction=i.withResources()(h)});
define("WWe",["require","exports","lC","r","c0","C1","_s","Xx","mh","ks","px","fZ","pZ","li","rM","jL","dZ","jm","k1","Jr","Gm","rs","Rs","gD","Jy","ii","si","qr","Jf","yh","YD"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M=new g.ProgressKeyFacet("shimUpload");function _(e){var t=this,s=y.useItemCacheDispatch(),o=i.useResourceScope(),a=o.consume(l.currentItemSet.optional),d=o.consume(T.resourceKey),v=e.itemKey,E=e.webAbsoluteUrl,N=e.listFullUrl,C=e.onItemUploaded,k=e.onUploadStarted,L=e.onUploadCompleted;return r.createElement(f.Action,{onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){function t(e){var t,r=null===(t=e.properties)||void 0===t?void 0:t.ID,i=e.type===x.default.Folder;if(i||r){var s=d.getItemUrlParts(e.key),o=s.serverRelativeItemUrl,u=o===s.serverRelativeListUrl?"":o;return p.spItemKeyFacet.serialize(n.__assign({webAbsoluteUrl:E,listFullUrl:N},i?{rootFolder:u}:{itemId:r}))}}var r,i,f,l,y,T,A,_,D;return n.__generator(this,function(p){switch(p.label){case 0:r=e&&e.event&&e.event;return(i=r&&r.dataTransfer)&&i.files?[4,s(O.demandItems(function(e){return e.demandItemFacet(u.knockoutStoreItemFacet,v)}))]:[2];case 1:if(!(f=p.sent()))throw new Error("No target store item for Upload");l=!1;y=[];for(T=0;T<i.files.length;T++){A=i.files[T];y.push(A);l||!0!==A.isFolder&&!0!==A.isDirectory||(l=!0)}_=g.progressBatchKeyFacet.serializeNext();D=M.serializeBatchKey(_);o.consumeAsync(c.asyncTypeResourceKey).then(function(e){var r=new e({files:y,parentItem:f.peek(),itemSet:a&&a.peek(),wasDragAndDropped:!0,type:l?h.default.Folder:h.default.Html5file,skipInvalidation:!0,onItemUploaded:function(e){var r,i=e.type===x.default.Folder,u=t(e);if(u){var a=e.parent?t(e.parent):void 0,f=M.serializeTaskKey(_,u,{});s(b.resolveItems({items:(r={},r[f]=w.createdItemFacet.pack({itemKey:u}),r[u]=n.__assign(n.__assign(n.__assign({},S.displayNameFacet.pack(e.displayName)),S.parentFolderItemFacet.pack(a?{itemKey:a}:void 0)),S.folderFacet.pack(i?{}:void 0)),r)}));C&&s(C({progressItemKey:f}));o.consumeAsync(m.resourceKey).then(function(t){return t(e)})}}});r.start();k&&s(k({progressItemKey:D}));return r.wait().catch(function(){}).then(function(){L&&s(L({progressItemKey:D}))})});return[2]}})})},engagement:{name:"Upload",isIntentional:!0}})}t.UploadItemsAction=i.withResources()(s.createItemCacheComponent(function(e,t){var i=t.itemKey,s=t.onItemUploaded,u=t.onUploadStarted,f=t.onUploadCompleted,l=t.resources,c=e.dispatch,h=i,m=e.demandItemFacet(p.spItemGroupKeyFacet,i),g=o.getCurrentItemSetKey(e),y=e.demandItemFacet(p.spFolderItemSetKeyFacet,g)||m&&m.itemSetKey;if(!i||!g||!y)return null;var S=y.webAbsoluteUrl,x=y.listFullUrl,T=y.rootFolder;m&&(h=p.spItemKeyFacet.serialize({webAbsoluteUrl:S,listFullUrl:x,rootFolder:T}));if(!a.hasKnockoutStoreItem(e,h))return null;return r.createElement(_,{itemKey:h,onItemUploaded:function(e){return function(){var t,n=c(E.readItems(function(t){var n=t.demandItemFacet(w.createdItemFacet,e.progressItemKey);return n&&n.itemKey}));if(n&&m){var r=c(E.readItems(function(e){return e.demandItemFacet(L.defaultCollapsedFacet,i)}));c(d.assignItemToGroup({items:(t={},t[n]={groupKey:i},t)})).then(function(){var e,t;r?l.consumeAsync(A.itemInvalidator).then(function(e){e.invalidateGroups([i])}):c(v.refreshItemsInSet({items:(e={},e[g]=(t={},t[n]={},t),e)}))})}s&&c(s(e))}},onUploadStarted:function(e){var t=e.progressItemKey;return function(){var r,s;c(b.resolveItems({items:(r={},r[i]=n.__assign({},N.activeUploadProjectionFoldersFacet.pack((s={},s[t]={},s))),r)}));u&&c(u(e))}},onUploadCompleted:function(e){var t=e.progressItemKey;return function(){var n,r;c(b.resolveItems({items:(n={},n[i]=C.pack({activeUploadProjectionFolders:N.activeUploadProjectionFoldersFacet},{activeUploadProjectionFolders:(r={},r[t]=new k.Delete,r)}),n)}));f&&c(f(e))}},webAbsoluteUrl:S,listFullUrl:x})}))});
define("qWe",["require","exports","lC","r","HF","bw","Zd","hne","Xw","pd","am","YF","vre","HE","SE","JWe","YWe","pe","S3","Y","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=["Document","Folder"],E=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._renderAdvancedSettings=function(){var e=s.state.showAdvancedSettings;return r.createElement("div",null,s._renderAdvancedSettingsHeader(),e&&s._renderAdvancedSettingsContent())};s._toggleAdvancedSettings=function(){s.setState({showAdvancedSettings:!s.state.showAdvancedSettings})};s._renderAdvancedSettingsHeader=function(){var e=s.state.showAdvancedSettings;return r.createElement("div",{onClick:s._toggleAdvancedSettings,className:"advancedSettingsHeader"},r.createElement("div",{className:"advancedSettingsHeaderText"},v.default.AdvancedSettingsText),r.createElement(l.IconButton,{style:{fontSize:"13px",color:"black"},iconProps:{iconName:e?"ChevronUp":"ChevronDown"},title:v.default.AdvancedSettingsText,ariaLabel:v.default.AdvancedSettingsText}))};s._renderAdvancedSettingsContent=function(){return r.createElement("div",{className:"advancedSettingsExpandedMargin"},s._renderDescriptionText(),s._renderAssociatedContentTypeHeader(),s._renderChoiceGroup())};s._renderDescriptionText=function(){return r.createElement(p.Text,null," ",v.default.CreateModelInstructionText4)};s._renderAssociatedContentTypeHeader=function(){return r.createElement(a.Label,{styles:{root:{marginTop:"20px"}}},r.createElement(h.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,v.default.ContentTypeHeader," ")))};s._renderChoiceGroup=function(){var e=[{key:"create",text:v.default.createContentType,ariaLabel:v.default.createContentType},{key:"select",text:v.default.selectContentType,ariaLabel:v.default.selectContentType}];return r.createElement(i.ChoiceGroup,{options:e,onChange:s.onChoiceGroupSelectedChange,selectedKey:s.state.contentTypeSelected})};s.onMessageBarDismiss=function(){s.setState({isMessageBarHidden:!0})};s.onTextFieldChange=function(e,t){s.setState({modelName:t||"",classifierErrorMessage:"",isMessageBarHidden:!0})};s.onChoiceGroupSelectedChange=function(e,t){s.setState({contentTypeSelected:t.key,classifierSelected:"select"===t.key?{key:"",value:""}:s.state.classifierSelected,classifierErrorMessage:"",isMessageBarHidden:!0})};s.onDropdownSelectionChange=function(){return function(e,t,n,r){var i=t&&t.key||"",o=t&&t.text||r;s.setState({classifierSelected:{key:i,value:o},classifierErrorMessage:"",isMessageBarHidden:!0,modelName:o})}};s.onRenderFooterContent=function(){return r.createElement(r.Fragment,null,r.createElement(l.PrimaryButton,{onClick:s.onCreateClick,style:{marginRight:"8px"},disabled:s.state.isSaving||!s.state.modelName},v.default.NextText),r.createElement(l.DefaultButton,{onClick:s.props.onDismiss},v.default.CancelText))};s.onCreateClick=function(){return n.__awaiter(s,void 0,void 0,function(){var e,t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:e=this.state,t=e.classifierSelected,r=e.contentTypeSelected,i=e.modelName;if("create"===r){t.key=i;t.value=i}if(""===t.value){this.setState({classifierErrorMessage:v.default.ClassifierNameInvalidText});return[2]}if(!(this._loadedContentTypes.filter(function(e){return e.name===t.value&&"Intelligent Document Content Types"===e.group}).length>0))return[3,1];this.setState({isDialogHidden:!1,isMessageBarHidden:!1});return[3,3];case 1:return[4,this._createOrReviewModel()];case 2:n.sent();n.label=3;case 3:return[2]}})})};s._createOrReviewModel=function(){return n.__awaiter(s,void 0,void 0,function(){var e,t=this;return n.__generator(this,function(n){e=this.state.classifierSelected;this.setState({isSaving:!0});this._contentCenterDataSource.createOrUpdateModel(e.value,e.key,"","").then(function(e){t.setState({isSaving:!1});if(e.d.DriveId&&e.d.ObjectId){var n=e.d.UniqueId;t.props.onDismiss();t._contentCenterDataSource.navigateToModelHomePage(n);t.props.onComplete(!0)}else{b.default.log("[ccui] create or retrieve model failed, empty modelId");t.setState({classifierErrorMessage:v.default.EmptyModelPathErrorText})}}).catch(function(e){b.default.log("[ccui] create model api call failed "+e.message.value);t.setState({isSaving:!1,classifierErrorMessage:e.message.value});t.props.onComplete(!1)});return[2]})})};s.state={contentTypeSelected:"create",classifierErrorMessage:"",classfierDropdownOptions:[],classifierOptions:[],classifierSelected:{key:"",value:""},isLoading:!0,isSaving:!1,isDialogHidden:!0,isMessageBarHidden:!0,modelName:"",showAdvancedSettings:!1};s._contentCenterDataSource=s.props.resources.consume(m.resourceKey);s._pageContext=s.props.resources.consume(y.pageContext);s._modelNameTextFieldRef=r.createRef();return s}t.prototype.componentDidMount=function(){var e=this;this._contentCenterDataSource.getSiteContentTypes(this._pageContext.webAbsoluteUrl,this._pageContext.webServerRelativeUrl,this._pageContext.siteId||"").then(function(t){var n=[];e._loadedContentTypes=t;(t=t.filter(function(e){return-1===w.indexOf(e.name)&&e.id.startsWith("0x0101")})).sort(function(e,t){return e.name.toUpperCase()>t.name.toUpperCase()?1:-1});t.forEach(function(e){n.push({key:e.id,text:e.name})});e.setState({classifierOptions:n,isLoading:!1});e._modelNameTextFieldRef&&e._modelNameTextFieldRef.current&&e._modelNameTextFieldRef.current.focus()}).catch(function(t){b.default.log("[ccui] fetching content type failed "+t.message.value);e.setState({isLoading:!1})})};t.prototype.render=function(){var e=this.state,t=e.contentTypeSelected,n=e.classifierErrorMessage,i=e.classifierOptions,a=e.isLoading,l=e.isSaving,m=e.isMessageBarHidden,y=e.modelName;return r.createElement(s.Panel,{closeButtonAriaLabel:v.default.CloseText,headerText:v.default.CreateModelHeader,isOpen:!0,isFooterAtBottom:!0,isLightDismiss:!0,onDismiss:this.props.onDismiss,onRenderFooterContent:this.onRenderFooterContent,type:s.PanelType.smallFixedFar},!m&&r.createElement("div",{className:"warningMassage"},r.createElement(c.MessageBar,{messageBarType:c.MessageBarType.warning,isMultiline:!0,onDismiss:this.onMessageBarDismiss,dismissButtonAriaLabel:v.default.CloseText},v.default.ContentTypeExistsMessageBarText1,r.createElement(f.Link,{onClick:this._createOrReviewModel},v.default.ContentTypeExistsMessageBarText2),v.default.ContentTypeExistsMessageBarText3)),r.createElement(h.Stack,{gap:15},r.createElement(h.Stack.Item,{styles:{root:{marginTop:"15px"}}},r.createElement(p.Text,null,v.default.CreateModelInstructionText3," ")),r.createElement(h.Stack.Item,{styles:{root:{marginBottom:"25px"}}},r.createElement(d.TextField,{componentRef:this._modelNameTextFieldRef,ariaLabel:v.default.ModelNameInputAriaLabel,errorMessage:"select"===t?"":n,value:y,disabled:"select"===t,label:v.default.ModelInputTextFieldLabel,onChange:this.onTextFieldChange})),r.createElement(h.Stack.Item,{className:"advancedSettingsContainer"},this._renderAdvancedSettings(),"select"===t&&this.state.showAdvancedSettings&&r.createElement(r.Fragment,null,r.createElement(u.Dropdown,{ariaLabel:v.default.selectContentTypeIndicator,className:"ContentCenterCreateModelPanel-dropdown",errorMessage:n,onChange:this.onDropdownSelectionChange(),options:i,placeholder:v.default.selectContentTypeIndicator}),a&&r.createElement(o.Spinner,{className:"spinner-topMargin",size:o.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:v.default.LoadingText}))),l&&r.createElement(h.Stack.Item,null,r.createElement(o.Spinner,{className:"spinner-topMargin",size:o.SpinnerSize.small,ariaLive:"assertive",ariaLabel:g.format(v.default.CreateNewModelArialabel,this.state.modelName),role:"status",labelPosition:"right",label:v.default.UpdatingModelFileText}))))};return t})(r.Component);t.default=E});
define("YWe",["require","exports","lC","VG","SJ","X_","S3","Lh","de","CA","Y"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,n.pageContext)||this;r.extractFileName=function(e){var t=e.split("/");return t[t.length-1]};r._apiUrlHelper=n.apiUrlHelper;r._navigation=n.navigation;r._pageContext=n.pageContext;return r}t.prototype.getWebFields=function(e){var t=e+"/_api/web/fields?$select=Id,Title&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')";return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getSiteContentTypes=function(e,t,n,r){void 0===r&&(r="Intelligent Document Content Types");var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes";return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){var t=JSON.parse(e).value;r&&(t=t.filter(function(e){return e.group===r}));return t},qosName:"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getColumnsForSiteContentType=function(e,t,n,r){var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes/"+r+"/columnLinks";return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e).value.map(function(e){return a.default.normalizeLower(e.id)})},qosName:"getColumnsForSiteContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getViewIds=function(e,t){var n=e+"/_api/Web/Lists(guid'"+t+"')/views";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e).value,n=[];t.forEach(function(e){return n.push(e.ListViewXml)});return n},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getMachineTeachingModelsForList=function(e,t){var n=e+"/_api/web/Lists(guid'"+t+"')/contenttypes?$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/machinelearning/modelid', SchemaXml) eq true";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getFormProcessingModelsForList=function(e,t){var n=e+"/_api/web/Lists(guid'"+t+"')/contenttypes?$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/formprocessing/models', SchemaXml) eq true";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getModelDetails=function(e,t,n){var r=e+"/_api/v2.1/drives/"+t+"/items/"+n+" ";return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getUserInformation=function(e,t,n){var r=e+"/_api/web/lists/modelusage/items?$select=Author/Name,Author/Title&$expand=Author/Id&"+("$filter=ModelUsageModelName eq '"+n+"' and ModelUsageTargetListID eq '"+t+"'");return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){return JSON.parse(e).value[0]},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getRetentionLabels=function(e,t){var n=e+"/_api/machinelearning/models/getbyuniqueid('"+t+"')";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t,n,r=JSON.parse(e);return null===(n=null===(t=JSON.parse(r.ModelSettings))||void 0===t?void 0:t.RetentionLabel)||void 0===n?void 0:n.Name},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.runModel=function(e){var t=this._apiUrlHelper.build().segment("machinelearning").segment("workItems");return this.runModelBatchRequest(t.toString(),function(e){return e},"runModel",function(){return e})};t.prototype.createOrUpdateModel=function(e,t,n,r,i){void 0===i&&(i="Intelligent Document Content Types");var s={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningModelEntityData"},ColumnId:r,ColumnName:n,ContentTypeGroup:i,ContentTypeId:t,ContentTypeName:e,Schemas:""},o=this._apiUrlHelper.build().segment("machinelearning").segment("models");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"createContentTypeAndModel",additionalPostData:JSON.stringify(s),method:"POST"})};t.prototype.navigateToTrainingPage=function(e){var t=[];t.push(this._pageContext.webAbsoluteUrl);t.push(this._pageContext.layoutsUrl);t.push("training.aspx");var n=t.join("/")+e;this._navigation.navigateTo(n)};t.prototype.navigateToModelHomePage=function(e){var t="?v=modelHome&modelUniqueId="+e,n=[];n.push(this._pageContext.webAbsoluteUrl);n.push(this._pageContext.layoutsUrl);n.push("training.aspx");var r=n.join("/")+t;this._navigation.navigateTo({url:r,frameId:"_blank"})};t.prototype.getModelIdByContentType=function(e){var t=this._apiUrlHelper.build().toString();t=t+"/machinelearning/models/getbytitle('"+e+"')";return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).UniqueId},qosName:"getModelIdByContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.importModel=function(){var e=this;return this.getModelIdByContentType("BenefitsChangeNotice.classifier").then(function(t){if(t)return Promise.resolve("Model already exists");var n=e._apiUrlHelper.build().segment("machinelearning").segment("models").segment("import('BenefitsChangeNotice.cmp')");return e.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t,n;return(null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.UniqueId)||""},qosName:"createContentImportModel",method:"Post"})})};t.prototype.checkIfModelExists=function(){var e=this._pageContext,t=e.webAbsoluteUrl+"/_api/web/GetFileByServerRelativeUrl('"+e.webServerRelativeUrl+"/Model/BenefitsChangeNotice.classifier')";return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return!0},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.runModelBatchRequest=function(e,t,n,r){var i=this;if(!r)return Promise.reject("failed");for(var s=a.default.generate(),o="multipart/mixed; boundary=batch_"+s,u=[],c=Math.ceil(r().length/30),h=0;h<c;h++){var p=r().slice(30*h,30*(h+1)),d=this.getConvertedData(p,e,s);u.push(this.dataRequestor.getData({url:f.DataBatchOperationHelper.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:t,qosName:this.getDataSourceName()+"."+n,additionalPostData:d,method:"POST",contentType:o}).then(function(e){return f.DataBatchOperationHelper.getBatchResponseText(e)}).catch(function(e){var t,n;l.default.log("[ccui] fetching content type failed "+(null===(n=null===(t=e)||void 0===t?void 0:t.message)||void 0===n?void 0:n.value));Promise.reject(e)}))}return Promise.all(u).then(function(e){var t=[].concat.apply([],e);return new Set(t.map(function(e){var t,n,r,s;if((null===(n=null===(t=e=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.Created)&&(null===(s=null===(r=e)||void 0===r?void 0:r.d)||void 0===s?void 0:s.TargetServerRelativeUrl))return i.extractFileName(e.d.TargetServerRelativeUrl)}))})};t.prototype.getConvertedData=function(e,t,n){void 0===t&&(t="");void 0===n&&(n="");if(!e)return e;var r=f.DataBatchOperationHelper.defaultBatchAcceptData,i=[],s=[],o=[],u=f.DataBatchOperationHelper.defaultBatchRequestPostData,a=1;e.forEach(function(e){o.push(""+a++);i.push(t);s.push(JSON.stringify(e))});return f.DataBatchOperationHelper.getBatchContentExtended(n,i,"POST",u,s,r)};t.dependencies={pageContext:o.pageContext,apiUrlHelper:r.resourceKey,navigation:u.navigation};return t})(i.default);t.default=c;t.resourceKey=s.createResolvedResourceKey(e("module").id,c)});
define("XWe",["require","exports","lC","r","SS","sre","bw","YF","CDe","zK","OJ","li","Jy","eC","B8","$We","pe","pd","bh","Re","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.learnMore_link=r.createElement(g.Link,{key:"learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=2112547",target:"_blank"},v.default.LearnMore);n._onChange=function(e,t){n._webDataSource.setSchedulingFeature(t).then(function(e){n.setState({schedulingOn:e.isFeatureActivated});var r=n._resources.consume(h.resourceKey).getUrlParts({}),i=c.spPageContextKeyFacet.serialize({webAbsoluteUrl:n.props.pageContext.webAbsoluteUrl,listFullUrl:r.fullListUrl}),s=n._getUpdatedPageContext(t);if(s){n._resources.consumeAsync(p.resourceKey).then(function(e){e.dispatch(d.updatePageContext({itemKey:i,options:{pageContext:s}}))});if(!b.default.isActivated("f08f5202-8ed8-49bf-8d00-c5504a67dbb0","4/16/2020","use clearPageCache when scheduling is toggled")){var o=n._resources.consume(y.resourceKey);o.clearPageCache&&o.clearPageCache()}}},function(e){n._operation.state(f.default.failed);n._operation.error(new l.default({message:"Error",payloads:e}))})};n._onDismiss=function(){n.setState({isOpen:!1})};n._resources=n.props.resources;n._webDataSource=n._resources.consume(a.resourceKey);n.state={schedulingOn:n._isSchedulingTurnedOn(n.props.pageContext&&n.props.pageContext.featureInfo),isOpen:!0};n.message=m.formatToArray(v.default.SchedulingDescription,n.learnMore_link);return n}t.prototype.render=function(){return r.createElement(o.Panel,{"data-automationid":"SchedulingPanel",isOpen:this.state.isOpen,type:o.PanelType.smallFixedFar,headerText:v.default.Scheduling,isLightDismiss:!0,onDismiss:this._onDismiss,closeButtonAriaLabel:v.default.SchedulingPanelCloseLabel},r.createElement("div",null,this.message),r.createElement(s.Toggle,{className:"SchedulingComponentToggle-topPadding",label:v.default.EnableScheduling,checked:this.state.schedulingOn,onChange:this._onChange,onText:v.default.SchedulingOnToggleText,offText:v.default.SchedulingOffToggleText}),r.createElement("div",null,this.state.schedulingOn&&r.createElement(u.MessageBar,{ariaLabel:v.default.DisableSchedulingWarning,messageBarType:u.MessageBarType.warning},v.default.DisableSchedulingWarning)))};t.prototype._getUpdatedPageContext=function(e){if(this.props.pageContext&&this.props.pageContext.featureInfo){var t=n.__assign({},this.props.pageContext.featureInfo);t.SitePagesScheduling.Enabled=e;return n.__assign(n.__assign({},this.props.pageContext),{featureInfo:t})}};t.prototype._isSchedulingTurnedOn=function(e){if(!e)return!1;var t=new i.default(e);if(t){var n=t.get("SitePagesScheduling");return!!n&&n.enabled}return!1};return t})(r.PureComponent);t.SchedulingComponent=w});
define("eqe",["require","exports","lC","r","Yh","O1","Sg","G5e","Ol","$V","X_","I_e","BH","eh","I5e","X5e","Lr","Qx","aqe","nqe","oh","Rs","rY","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S={commands:[],farCommands:[],overflowCommands:[]},x=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemsCommandBarControlHandler=function(e,t){var n=t.itemKey;if(!e.isItemFacetResolved(E.displayNameFacet,n))return S;var r=e.demandItemFacet(b.extendedCommandBarControl,w.odspNextAppItemKey);return r?b.extendedCommandBarControl.evaluate(r)(e,t):S};r._scope=new p.default;var i=r._scope.attach(new(r.context.dependencies.resources.injected(c.default))({renderLabel:1})).command;r._observables=r._scope.attach(new r.context.dependencies.observablesFactoryType({owner:r}));r._reactCommandManager=r._scope.attach(new r.context.dependencies.reactCommandManagerType({commandSet:{commands:r._observables.createArray([i])}}));r.state={farItems:r._reactCommandManager.commandBarItems.peek().farItems};r._itemsScopeManager=n.dependencies.itemsScopeManager;r._controlHandlers=o.itemsCommandBarControl.pack(r._itemsCommandBarControlHandler);return r}t.prototype.componentDidMount=function(){var e=this;this._observables.subscribe(this._reactCommandManager.commandBarItems,function(t){e.setState({farItems:n.__spreadArrays(t.farItems)})});this.props.handleRenderComplete(m.now(),this._itemsScopeManager)};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.context.dependencies,t=e.currentItemsScope,n=e.actionControlHandlers,o=this.state.farItems,u=r.createElement(n,null,r.createElement(s.ControlHandlerProvider,{controlHandlers:this._controlHandlers},r.createElement(t,null,r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{display:"block",width:"100%"}},r.createElement(i.ItemsCommandBar,{farItems:o}))))));return r.createElement(a.Fabric,null,u)};t.contextTypes=f.RESOLVED_COMPONENT_CONTEXT_TYPES;return t})(r.PureComponent);t.ItemsScopeCommandBar=x;t.resourceKey=f.createResolvedComponentTypeResourceKey(e("module").id,x,{resources:l.resourceScopeKey,observablesFactoryType:h.observablesFactoryTypeResourceKey,reactCommandManagerType:d.typeResourceKey,currentItemsScope:v.resourceKey.local,itemsScopeManager:g.resourceKey,actionControlHandlers:y.resourceKey});t.knockoutResourceKey=u.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-command-bar",name:e("module").id+".knockout"})});
define("Yh",["require","exports","lC","r","_s","C1","Dg","Sg","cg","og","Zb","Jb","Bb","Pb","Cb","vb","gb","_b","lb","db","Pp","Vs","ev","sb","hs","bs","wo","ob","Lr","Hn","Lr","tb","eb","Jh","Ko","Hs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var B=[a.newCommand,l.uploadCommand,f.openCommand,c.shareCommand,c.copyLinkCommand,h.downloadCommand,x.followCommand,d.deleteCommand,p.renameCommand],j=[y.enterSelectionCommand],F=[],I=[],q=E.createTelemetryProvider({withContext:{component:"CommandBar"}});t.ItemsCommandBar=w.wrapWithParent(q)(S.withPageLoad()(s.connectToItemCache(function(e,t){var r=O.now(),s=t.commands,o=void 0===s?I:s,a=t.overflowCommands,f=void 0===a?I:a,l=t.farCommands,c=void 0===l?I:l,h=t.shortcutCommands,p=void 0===h?I:h,d=t.overflowButtonProps,m=void 0===d?{}:d,y=T.getCurrentItemKey(e),w=i.getCurrentItemSetKey(e),S=E.getTelemetry(e).telemetry,x=N.getItemsScope(e).itemsScopeItemKey,M=!!e.demandItemFacet(C.errorFacet,x,{suppressGetItems:!0}),D=t.buttonAs,P=D?A.composeComponentAs(D,R):R,q=n.__assign(n.__assign({},m),{onMenuClick:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];S(H.Engagement).logData({name:"Overflow"});m.onMenuClick&&m.onMenuClick.apply(m,e)}});try{if(!t.hasPageLoaded||M&&!t.ignoreError)return{buttonAs:P,overflowButtonProps:q};L.mark("ItemsCommandBar.render");var U=e.demandItemFacet(u.itemsCommandBarControl,y),W=[g.clearSelectionCommand,v.showProgressCommand,k.buildSortCommand(e),z(e)],X=u.itemsCommandBarControl.evaluate(U)(e,{itemKey:y||"",itemSetKey:w,commands:B,farCommands:W,overflowCommands:j,shortcutCommands:F}),V=X.commands,$=X.overflowCommands,J=X.farCommands,K=X.shortcutCommands;return{commands:b.concat(V,o),overflowCommands:b.concat($,f),farCommands:b.concat(J,c),shortcutCommands:b.concat(K,p),buttonAs:P,overflowButtonProps:q}}finally{var Q=O.now()-r;_.itemsCommandBarSelectorTime.add(Q)}})(o.ActionCommandBar)));t.ItemsCommandBar.displayName="ItemsCommandBar";function R(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]),s=r.useContext(M.MeasuredContext).isMeasured,o=O.now();return r.createElement(r.Fragment,null,t?r.createElement(t,n.__assign({},i)):null,r.createElement(U,{renderStartTime:o,isMeasured:s}))}function U(e){var t=O.now()-e.renderStartTime;(e.isMeasured?_.commandBarButtonsStagingTime:_.commandBarButtonsRenderTime).add(t);return null}function z(e){return P.getItemsViewLayoutsContext(e)?D.buildSwitchLayoutCommand(e):m.switchLayoutCommand}});
define("lb",["require","exports","r","si","mb","pb","fb","ub"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.enterSelectionCommand={key:r.getNextId("enterSelectionCommand"),name:o.default.EnterSelectionCommandText,iconProps:{iconName:"CheckboxComposite"},action:n.createElement(u.ShowOnlyOnMobile,null,n.createElement(s.HideWithSelection,null,n.createElement(i.EnterSelectionAction,null)))}});
define("mb",["require","exports","lC","r","C1","F1","os","ks","Jr"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EnterSelectionAction=i.createItemCacheComponent(function(e,t){var i=s.getItemsScope(e).itemsScopeItemKey;if(!i)return null;if(e.demandItemFacet(o.isSelectionModalFacet,i))return null;var f=e.dispatch;return r.createElement(u.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){f(a.resolveItems({items:(e={},e[i]=n.__assign({},o.isSelectionModalFacet.pack(!0)),e)}));return[2]})})},engagement:{name:"EnterSelection"}})})});
define("ub",["require","exports","C1","Rf"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=new r.PlatformDetection;t.PlatformVisibility=n.createItemCacheComponent(function(e,t){var n=t.allowOnPlatform,r=t.children;return n(e,{platformDetection:i})&&r||null});t.ShowOnlyOnMobile=n.connectToItemCache(function(){return{allowOnPlatform:s}})(t.PlatformVisibility);t.HideOnMobile=n.connectToItemCache(function(){return{allowOnPlatform:o}})(t.PlatformVisibility);function s(e,t){return t.platformDetection.isMobile}function o(e,t){return!t.platformDetection.isMobile}});
define("eb",["require","exports","Ff"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandBarButtonsRenderCount=n.createPerformanceCounter("commandBarButtons.render.count");t.commandBarButtonsRenderTime=n.createPerformanceCounter("commandBarButtons.render",{dependentCounter:t.commandBarButtonsRenderCount});t.commandBarButtonsStagingCount=n.createPerformanceCounter("commandBarButtons.stageMeasurement.count");t.commandBarButtonsStagingTime=n.createPerformanceCounter("commandBarButtons.stageMeasurement",{dependentCounter:t.commandBarButtonsStagingCount});t.itemsCommandBarSelectorCount=n.createPerformanceCounter("commandBar.selectStoreData.count");t.itemsCommandBarSelectorTime=n.createPerformanceCounter("commandBar.selectStoreData",{dependentCounter:t.itemsCommandBarSelectorCount})});
define("Jh",["require","exports","lC","r","Or","$h","Ko","Xh"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.buildSwitchLayoutCommand=function(e){var t=o.getItemsViewLayoutsContext(e),a=t&&t.availableLayouts,f=[];a&&a.forEach(function(e){var t=e.layoutType,i=e.command;f.push(n.__assign(n.__assign({},e.command),{key:t.id,action:r.createElement(u.SwitchLayoutAction,{layoutType:t,ariaLabel:i.ariaLabel})}))});return{key:s.switchLayoutCommandKey,automationId:"switchLayoutCommand",title:i.default.SwitchLayoutCommandLabel,ariaLabel:i.default.SwitchLayoutCommandLabel,iconProps:{iconName:"tiles"},postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,r=t&&t.filter(function(e){return e.checked})[0];return n.__assign(n.__assign(n.__assign({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),r?{iconProps:r.iconProps}:{})},subMenuProps:{items:f}}}});
define("pqe",["require","exports","lC","r","k1","c0","rs","Rs","O3","G$"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DesktopAppDownloader=function(e){var t=this,l=e.resolve,c=e.reject,h=i.useItemCacheDispatch(),p=s.useResourceScope();r.useLayoutEffect(function(){n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,d,v;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,e.getDownloadData()];case 1:t=n.sent();r=e.itemKeys[0];i=h(o.readItems(function(e){return e.demandItemFacet(u.displayNameFacet,r)}));return[4,p.consumeAsync(a.resourceKey)];case 2:s=n.sent();d={command:"Download",type:f.WinAppDownloadType.DownloadSingleFile,downloadUrl:t.url,zipFileName:i,postBody:JSON.stringify({})};if("POST"===t.method){d.postBody=JSON.stringify({request:t.postData});d.zipFileName=t.postData.zipFileName;d.type=f.WinAppDownloadType.DownloadMultiFile}s.sendCommand({command:JSON.stringify({DownloadCommand:d})});l();return[3,4];case 3:v=n.sent();c(v);return[3,4];case 4:return[2]}})})},[]);return null}});
define("mqe",["require","exports","lC","r","rs","u3","TB","QH","k1","c0"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DownloaderWithRecents=function(e){var t=this,l=e.defaultRender,c=n.__rest(e,["defaultRender"]),h=e.itemKeys,p=a.useItemCacheDispatch(),d=f.useResourceScope();r.useLayoutEffect(function(){if(u.isFeatureEnabled(u.WriteMruSignalWhenMediaDownloaded)){var e=p(i.readItems(function(e){return h.map(function(t){return e.demandItemFacet(o.oneDriveItemFacet,t)})}));n.__awaiter(t,void 0,void 0,function(){var t,r,i,o,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,d.consumeAsync(s.mruRecent.optional)];case 1:if(!(t=n.sent()))return[3,3];r=[];for(i=0,o=e;i<o.length;i++)(u=o[i])&&r.push(t.recordDocumentView(u));return[4,Promise.all(r)];case 2:n.sent();n.label=3;case 3:return[2]}})})}},[]);return l?r.createElement(l,n.__assign({},c)):null}});
define("TB",["require","exports","lC","do","Rs","ph","d1","U7","So","gD","Uk","oh","mh","Jf","ii","UB","hv","p_"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.oneDriveItemFacet=new r.ComputedItemFacet("oneDriveItem",function(e,t){var r=t.itemKey,y=e.demandItemFacet(h.knockoutStoreIdentityFacet,r);if(void 0!==y){var b=y.key,w=y.id,E=e.demandItemFacet(i.displayNameFacet,r),S=e.demandItemFacet(i.fileNameFacet,r),x=S&&S.name||"",T=S&&S.extension||"",N=e.demandItemFacet(s.driveItemKeyFacet,r),C=e.demandItemFacet(i.fileSizeFacet,r),k=e.demandItemFacet(i.folderFacet,r),L=e.demandItemFacet(i.dateModifiedFacet,r),A=e.demandItemFacet(a.localeFacet,a.configurationItemKey),O=A&&A.language||window.navigator.language,M=e.demandItemFacet(i.openUrlFacet,r),_=k?f.default.Folder:f.default.File,D=l.getIconNameFromItem({type:_,extension:T,textEditorMimeType:void 0}),P=e.demandItemFacet(p.countFacet,r),H=e.demandItemFacet(d.officeAppFacet,r),B=e.demandItemFacet(v.sharedFacet,r),j=B&&new Date(B.sharedDateTime).getTime(),F=e.demandItemFacet(i.dateCreatedFacet,r),I=e.demandItem({createdByPerson:g.createdByPersonFacet},r).createdByPerson,q=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({key:b,queryType:o.default.Files,displayType:o.default.Files,id:w},N?{itemId:N.itemId}:{}),N?{graph:{itemId:N.itemId,driveId:N.driveId}}:{}),x?{name:x}:{}),E?{displayName:E}:{}),T?{extension:T}:{}),void 0!==C?{size:C}:{}),{type:k?f.default.Folder:f.default.File}),k?{folder:{}}:{}),{childCount:P}),void 0===L||isNaN(L)?{}:{dateModifiedTime:new Date(L),dateModified:u.getRelativeDateTimeStringPast(new Date(L),O)}),void 0===F||isNaN(F)?{}:{dateCretedTime:new Date(F),dateCreated:u.getRelativeDateTimeStringPast(new Date(F),O)}),void 0===j||isNaN(j)?{}:{dateSharedTime:new Date(j),dateShared:u.getRelativeDateTimeStringPast(new Date(j),O)}),{properties:{}}),D?{iconName:D}:{}),H?{appMap:H}:{}),{urls:{}}),M?{openUrl:M}:{}),{creatorName:I&&I.displayValue,isPlaceholder:!e.isItemFacetResolved(i.displayNameFacet,r),state:{},recycleBinProperties:{},reputationProperties:{},statistics:{}}),R=e.demandItemFacet(m.oneDriveItemControl,c.odspNextAppItemKey);return m.oneDriveItemControl.evaluate(R)(e,{itemKey:r,key:b,item:q}).item}})});
define("_qe",["require","exports","lC","Lqe","Jb","og","Cb","AM","DM","ih","Ty","bqe","QH","ai","WB","li","o4","ii","hqe","Y0","Rf"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsContextMenuControlHandler=f.createControlHandler()(function(){return function(e){return S}});var E=new w.PlatformDetection;function S(e,t){var f,w=0,S=t.itemKey,x=e.demandItemFacet(v.spItemKeyFacet,S),T=e.demandItemFacet(m.SharedByMeRootItemKeyFacet,S);if(x){var N={webAbsoluteUrl:"",listFullUrl:""};x&&(N={webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl});var C=v.spListKeyFacet.serialize(N),k=e.demandItemFacet(g.listFacet,C),L=!!k&&!k.isDocumentLibrary,A=!1,O=!1;if(k){A=k.templateType===p.default.publishingAsset;O=k.templateType===p.default.mySiteDocumentLibrary}var M=e.demandItemFacet(g.spPageContextFacet,v.spPageContextKeyFacet.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl})),_=l.isCrossOrigin(),D=c.getFlowCommand(e,S),P=M&&k&&h.isFeatureEnabled(h.WexSitePagesContentApproval)&&k.templateType===p.default.webPageLibrary&&k.isModerated,H=P?n.__assign(n.__assign({},r.approveRejectCommand),{name:d.default.ReviewApprovals}):r.approveRejectCommand,B=P?n.__assign(n.__assign({},r.PublishCommand),{name:d.default.Submit}):r.PublishCommand,j=y.isManageAccessItemsScopeOn(),F=E.isMobile,I=!(null===(f=M)||void 0===f?void 0:f.CommentsOnListItemsDisabled)&&h.isFeatureEnabled(h.EnableActivityPaneForSPCustomList)&&h.isFeatureEnabled(h.EnableCommentsForSPCustomList);I=(I=I&&(!F||h.isFeatureEnabled(h.EnableActivityPaneInListFormForMobile)))&&(!b.isTeamsWebView()||h.isFeatureEnabled(h.EnableActivityPaneInListFormForTeamsApp));return L?{contextMenuOverride:[{command:i.copyLinkCommand,followupCommands:j?n.__spreadArrays(I?[r.CommentItemCommand,y.divider(w++)]:[],[r.copyFieldCommand,r.ManageAccessCommand,y.divider(w++)]):n.__spreadArrays(I?[r.CommentItemCommand]:[],[r.copyFieldCommand,y.divider(w++)])},{command:o.deleteCommand,followupCommands:D?[D,y.divider(w++)]:[y.divider(w++)]},{command:a.MoreCommands,beforeCommands:_?[r.moveToCommand,y.divider(w++),r.versionHistoryCommand]:[r.moveToCommand,y.divider(w++),r.captureVersionCommand,r.versionHistoryCommand,r.alertMeCommand],beforeChildrenCommands:[r.WorkflowCommand,r.ComplianceDetailsCommand],followupChildrenCommands:n.__spreadArrays(h.isFeatureEnabled(h.BulkApproveReject)?[]:[H])},{command:null,followupCommands:[y.divider(w++),r.detailsMenuCommand],bottomCommand:!0},{command:null,followupCommands:[r.ViewItemCommand,r.EditItemCommand],topCommand:!0}]}:O?{contextMenuOverride:[{command:o.deleteCommand,followupCommands:[r.moveToCommand,r.copyToCommand]},{command:i.copyLinkCommand,followupCommands:j?[r.FileRequestCommand,r.ManageAccessCommand,y.divider(w++)]:[r.FileRequestCommand,y.divider(w++)]},{command:a.MoreCommands,beforeCommands:n.__spreadArrays([y.divider(w++)],D?[D]:[],[r.versionHistoryCommand]),beforeChildrenCommands:[r.WorkflowCommand,r.ComplianceDetailsCommand],followupChildrenCommands:n.__spreadArrays(A?[r.EditRenditionsCommand]:[],[B,r.UnPublishCommand,r.CancelPublishCommand])},{command:null,followupCommands:[y.divider(w++),r.detailsMenuCommand],bottomCommand:!0},{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0}]}:{contextMenuOverride:[{command:u.editPinnedItemCommand,followupCommands:n.__spreadArrays([r.moveToCommand,r.copyToCommand],h.isFeatureEnabled(h.SPBulkEditItemCommand)?[r.bulkEditDocumentPropertyCommand]:[])},{command:i.copyLinkCommand,followupCommands:j?[r.ManageAccessCommand,y.divider(w++)]:[y.divider(w++)]},{command:o.deleteCommand,followupCommands:D?[D,y.divider(w++)]:[y.divider(w++)]},{command:a.MoreCommands,beforeCommands:_?[y.divider(w++),r.versionHistoryCommand,r.makeHomePageCommand]:[y.divider(w++),r.captureVersionCommand,r.versionHistoryCommand,r.alertMeCommand,r.makeHomePageCommand],beforeChildrenCommands:[r.ViewDocumentPropertyCommand,r.WorkflowCommand,r.ComplianceDetailsCommand],followupChildrenCommands:n.__spreadArrays(A?[r.EditRenditionsCommand]:[],[B,r.UnPublishCommand,r.CancelPublishCommand],h.isFeatureEnabled(h.BulkApproveReject)?[]:[H])},{command:null,followupCommands:[y.divider(w++),r.detailsMenuCommand],bottomCommand:!0},{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0}]}}return T?{contextMenuOverride:[{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0},{command:i.copyLinkCommand,followupCommands:[y.divider(w++)]},{command:null,followupCommands:[y.divider(w++),r.detailsMenuCommand],bottomCommand:!0}]}:{contextMenuOverride:void 0}}});
define("Lqe",["require","exports","lC","r","WB","si","pb","nYe","tYe","eYe","$Qe","ZQe","XQe","JQe","YQe","QQe","qQe","WQe","KQe","zQe","VQe","jQe","BQe","Bk","ug","NQe","d1","hg","Vb","og","AQe","wQe","OQe","xQe","yQe","vQe","gQe","hQe","cQe","oQe","iQe","nQe","tQe","eQe","$qe","Zqe","Xqe","Jqe","Qqe","Wqe","Gqe","Vqe","Bqe","Rqe","Hqe","Uqe","Pqe","kqe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var ie={iconName:void 0,styles:{root:{display:"none!important"}}};t.alertMeCommand=O.alertMeCommand;t.manageAlertCommand=O.manageAlertCommand;t.versionHistoryCommand=O.versionHistoryCommand;t.powerAppsCommand=O.powerAppsCommand;t.aibuilderCommand=O.aibuilderCommand;t.captureVersionCommand=M.captureVersionCommand;t.detailsCommand=_.detailsCommand;t.detailsMenuCommand=D.detailsMenuCommand;t.filtersPaneCommand=P.filtersPaneCommand;t.moveToCommand=H.moveToCommand;t.copyToCommand=B.copyToCommand;t.runModelCommand=j.runModelCommand;t.fullscreenCommand=F.fullscreenCommand;t.addToOneDriveCommand=I.addToOneDriveCommand;t.quickEditCommand=q.quickEditCommand;t.cancelEditCommand=R.cancelEditCommand;t.copyFieldCommand={key:new s.Facet("CopyField").id,name:i.default.CopyField,action:r.createElement(y.CopyFieldAction,null),hasLaunchTarget:!0,automationId:"copyFieldCommand"};t.EditItemCommand={key:new s.Facet("EditProperties").id,name:i.default.editProperties,action:r.createElement(y.EditItemAction,null),iconProps:{iconName:"Edit"},automationId:"editProperties"};t.ViewItemCommand={key:new s.Facet("ViewProperties").id,name:i.default.Open,action:r.createElement(y.ViewItemAction,null),automationId:"viewItemCommand"};t.CommentItemCommand={key:new s.Facet("Comment").id,name:i.default.commentCommandText,action:r.createElement(y.ViewItemAction,{preferredSection:"comments"}),iconProps:{iconName:"Comment"},engagement:{name:"CommentItemCommand",isIntentional:!0,usageType:"Click"}};t.bulkEditDocumentPropertyCommand={key:new s.Facet("bulkEditDocumentProperties").id,name:i.default.viewProperties,action:r.createElement(y.EditItemAction,{isBulkEdit:!0}),iconProps:{iconName:"Edit"}};t.ViewDocumentPropertyCommand={key:new s.Facet("ViewProperties").id,name:i.default.viewProperties,action:r.createElement(y.ViewItemAction,null),iconProps:{iconName:"Edit"}};t.makeHomePageCommand={key:new s.Facet("MakeHomePage").id,name:i.default.MakeHomepage,action:r.createElement(h.MakeHomePageAction,null),iconProps:{iconName:"Home"}};t.rotateCommand={key:new s.Facet("rotate").id,name:i.default.rotate,action:r.createElement(p.RotateAction,null),iconProps:{iconName:"rotate"}};t.orderPrintsCommand={key:new s.Facet("orderPrints").id,name:i.default.OrderPrints,action:r.createElement(d.OrderPrintsAction,null),iconProps:{iconName:"Print"}};t.embedCommand={key:new s.Facet("embed").id,automationId:"embed",name:i.default.Embed,action:r.createElement(v.EmbedAction,null),iconProps:{iconName:"Embed"}};t.createMountPointCommand={key:new s.Facet("createMountPoint").id,automationId:"createMountPoint",name:i.default.CreateMountPoint,action:r.createElement(w.CreateMountPointAction,null),iconProps:{iconName:"FabricFolderLink"}};t.removeMountPointCommand={key:new s.Facet("removeMountPoint").id,name:i.default.RemoveMountPoint,action:r.createElement(w.RemoveMountPointAction,null),iconProps:{iconName:"Cancel"}};t.reportAbuseCommand={key:new s.Facet("reportAbuse").id,name:i.default.reportAbuse,action:r.createElement(c.ReportAbuseAction,null),iconProps:{iconName:"EditNote"}};t.approveRejectCommand={key:new s.Facet("ApproveReject").id,name:i.default.ApproveReject,action:r.createElement(S.ApproveRejectAction,null),iconProps:ie};t.previewCommand=U.previewCommand;t.WorkflowCommand=z.workflowCommand;t.ComplianceDetailsCommand=W.complianceDetailsCommand;t.EditRenditionsCommand={key:new s.Facet("EditRenditions").id,name:i.default.EditRenditions,action:r.createElement(b.EditRenditionsAction,null)};t.PublishCommand=X.publishCommand;t.UnPublishCommand=V.unPublishCommand;t.CancelPublishCommand=$.cancelPublishCommand;t.CreateShortcutCommand=J.createShortcutCommand;t.createWordCommand={key:new s.Facet("createWord").id,automationId:"createWordCommand",name:k.default.CreateWord,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateWordAction,null)),iconProps:T.getCommandIconProps({extension:"docx",size:16})};t.createExcelCommand={key:new s.Facet("createExcel").id,automationId:"createExcelCommand",name:k.default.CreateExcel,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateExcelAction,null)),iconProps:T.getCommandIconProps({extension:"xlsx",size:16})};t.createPowerPointCommand={key:new s.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:k.default.CreatePowerPoint,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreatePowerPointAction,null)),iconProps:T.getCommandIconProps({extension:"pptx",size:16})};t.createOneNoteCommand={key:new s.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:k.default.CreateOneNote,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateOneNoteAction,null)),iconProps:T.getCommandIconProps({extension:"onetoc",size:16})};t.createExcelSurveyCommand={key:new s.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:k.default.CreateExcelSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateExcelSurveyAction,null)),iconProps:T.getCommandIconProps({extension:"xlsx",size:16})};t.createTextFileCommand={key:new s.Facet("createTextFile").id,name:i.default.CreateText,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateTextFileAction,null)),iconProps:T.getCommandIconProps({extension:"txt",size:16})};t.shareSurveyCommand={key:new s.Facet("shareSurvey").id,name:i.default.shareSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.ShareSurveyAction,null)),iconProps:ie};t.viewSurveyCommand={key:new s.Facet("viewSurvey").id,name:i.default.viewSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.ViewSurveyAction,null)),iconProps:ie};t.editSurveyCommand={key:new s.Facet("editSurvey").id,name:i.default.editSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.EditSurveyAction,null)),iconProps:ie};t.surveyCommand={key:new s.Facet("survey").id,name:"Survey",subMenuProps:{items:[t.shareSurveyCommand,t.viewSurveyCommand,t.editSurveyCommand]},iconProps:ie};t.OpenInPowerBICommand=K.openInPowerBICommand;t.AddToQuickLaunchCommand={key:new s.Facet("AddToQuickLaunch").id,name:i.default.AddToQuickLaunch,action:r.createElement(a.AddToQuickLaunch,null),iconProps:{iconName:"Pin"}};t.OpenInTextEditorCommand=Q.openInTextEditorCommand;t.OpenInExplorerCommand=G.openInExplorerCommand;t.OpenInSharePointCommand=Y.openInSharePointCommand;t.openInOfficeOnlineCommand={key:new s.Facet("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",name:"##Localized_OpenInOfficeOnline##",action:r.createElement(f.OpenInOfficeOnlineAction,null),facets:n.__assign({},L.isReadonlyFacet.pack(!0))};t.openInOfficeClientCommand={key:new s.Facet("openInOfficeClient").id,automationId:"openInOfficeClientCommand",name:"##Localized_OpenInOfficeClient##",action:r.createElement(l.OpenInOfficeClientAction,null),facets:n.__assign({},L.isReadonlyFacet.pack(!0))};t.openFileCommand={key:A.openCommand.key,automationId:A.openCommand.automationId,name:"##Localized_Open##",subMenuProps:{items:[t.openInOfficeOnlineCommand,t.openInOfficeClientCommand]},facets:n.__assign({},L.isReadonlyFacet.pack(!0))};t.launchFormatViewPaneCommand={key:new s.Facet("LaunchFormatViewPane").id,name:i.default.FormatView,action:r.createElement(o.HideWithSelection,null,r.createElement(E.LaunchFormatViewPaneAction,null)),iconProps:ie,automationId:"launchFormatViewPaneCommand"};t.EditNewMenuCommand={key:x.editNewMenuKey,name:i.default.editNewMenu,action:r.createElement(o.HideWithSelection,null,r.createElement(u.EditNewMenuAction,null)),iconProps:{iconName:"Edit"}};t.TeamChannelCommand=Z.teamChannelCommand;t.UploadFileCommand=ee.uploadFileCommand;t.UploadFolderCommand=te.uploadFolderCommand;t.FileRequestCommand=ne.fileRequestCommand;t.ManageAccessCommand=re.manageAccessCommand;t.NavigateToSharedWithMeCommand={key:new s.Facet("NavigateToSharedWithMe").id,name:i.default.SharedWithYou,title:i.default.SharedWithYou,action:r.createElement(N.NavigateToQueryRootAction,{queryType:C.default.SharedWithMe}),isPermanent:!0};t.NavigateToSharedByMeCommand={key:new s.Facet("NavigateToSharedByMe").id,name:i.default.SharedByYou,title:i.default.SharedByYou,action:r.createElement(N.NavigateToQueryRootAction,{queryType:C.default.SharedByMe}),isPermanent:!0}});
define("nYe",["require","exports","lC","Oy","_s","F1","T3","ii","ch","QH","Xy","li","ii","ai"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditNewMenuAction=i.withCurrentItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["tWe"],t,n)})];case 1:return[2,t.sent().EditNewMenuAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(c.spItemKeyFacet,n),i=r&&e.demandItemFacet(h.listFacet,c.spListKeyFacet.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})),d=l.getPageContextFromItemCache(e,n),v=e.demandItemFacet(u.permissionsFacet,n),m=o.default.hasItemPermission({permissions:v},o.default.editListItems),g=s.getItemsScope(e).itemsScopeItemKey,y=e.demandItemFacet(a.currentViewParamsFacet,g);return f.isFeatureEnabled(f.NewDocumentTemplates)&&!!d&&!d.isAnonymousGuestUser&&!(y&&y.q)&&m&&!(i&&i.templateType===p.ListTemplateType.webPageLibrary)}return!1}))});
define("tYe",["require","exports","lC","Oy","_s","Rs","ii","li"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToQuickLaunch=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["HKe"],t,n)})];case 1:return[2,t.sent().AddToQuickLaunchAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(s.fileNameFacet,n),i=e.demandItemFacet(o.officeAppFacet,n),a=e.demandItemFacet(u.spItemKeyFacet,n);return!!r&&".aspx"===r.extension&&!i&&!!a&&-1!==a.listFullUrl.toLowerCase().indexOf("sitepages")}return!1})))});
define("eYe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeOnlineAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeOnlineAction))})});
define("$Qe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeClientAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeClientAction))})});
define("ZQe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReportAbuseAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ReportAbuseAction))})});
define("XQe",["require","exports","lC","Oy","Rs","_s","ii","ai","T3","li"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MakeHomePageAction=s.withSelectedItems()(s.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["ZKe"],t,n)})];case 1:return[2,t.sent().MakeHomePageAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(f.spItemKeyFacet,n),s=r&&e.demandItemFacet(o.listFacet,f.spListKeyFacet.serialize(r)),l=e.demandItem({permissions:o.permissionsFacet,isCheckedOut:i.isCheckedOutFacet},n),c=l.permissions,h=l.isCheckedOut,p=a.default.hasItemPermission({permissions:c},a.default.manageWeb);return!!s&&s.templateType===u.default.webPageLibrary&&p&&!!h&&!h.byYou}return!1})))});
define("JQe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RotateAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RotateAction))})});
define("YQe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OrderPrintsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OrderPrintsAction))})});
define("QQe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EmbedAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EmbedAction))})});
define("qQe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShareSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:1})});t.ViewSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:2})});t.EditSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:3})})});
define("WQe",["require","exports","px","RKe","e4"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){return function(t){var r=t.consume(n.actionMap);return new(t.injected(r.CreateDocumentAction))({docType:e})}};t.CreateWordAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Word));t.CreateExcelAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Excel));t.CreatePowerPointAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.PowerPoint));t.CreateOneNoteAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.OneNote));t.CreateExcelSurveyAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.ExcelSurvey));t.CreateTextFileAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Text))});
define("KQe",["require","exports","lC","px","RKe","_s","Oy","Xy","ai","li","ii","QH","T3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CopyFieldAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.CopyFieldAction))});function p(e,t){var n=u.getPageContextFromItemCache(e,t),r=e.demandItemFacet(f.spItemKeyFacet,t),i=r&&f.spListKeyFacet.serialize(r),s=i&&e.demandItemFacet(l.listFacet,i),o=s&&s.templateType===a.default.mySiteDocumentLibrary;return{isAvailable:!!n&&!n.isAnonymousGuestUser&&!o,pageContext:n,listContext:s}}t.EditItemAction=s.withSelectedItems()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["GKe"],t,n)})];case 1:return[2,t.sent().EditItemAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1||!c.isFeatureEnabled(c.SPBulkEditItemCommand)&&n.length>1)return!1;var r=p(e,n[0]),i=r.isAvailable,s=r.listContext;if(!i)return!1;if(c.isFeatureEnabled(c.SPBulkEditItemCommand)&&s&&s.isDocumentLibrary&&n.length<=1)return!1;for(var o=0,u=n;o<u.length;o++){var a=u[o],f=e.demandItemFacet(l.permissionsFacet,a);if(!(i=h.default.hasItemPermission({permissions:f},h.default.editListItems)))break}return!!i}));t.ViewItemAction=s.withSelectedItems()(s.withExactlyOneItem()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["zKe"],t,n)})];case 1:return[2,t.sent().ViewItemAction]}})})},function(e,t){var n,r=t.itemKey,i=t.preferredSection;if(!r)return!1;var s=p(e,r),o=s.isAvailable,u=s.listContext;return"comments"===i?o&&(null===(n=u)||void 0===n?void 0:n.templateType)===a.default.genericList:o})))});
define("zQe",["require","exports","lC","px","RKe","GQe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(s,t);t.WorkflowAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.WorkflowAction))});t.EditRenditionsAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.EditRenditionsAction))});t.PublishAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.PublishAction))});t.UnPublishAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:0})});t.CancelApprovalAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:1})})});
define("GQe",["require","exports","lC","Oy","_s","Rs","ii","T3","li","ii","ai"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComplianceDetailsAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["aWe"],t,n)})];case 1:return[2,t.sent().ComplianceDetailsAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItem({isFolder:s.folderFacet,permissions:o.permissionsFacet,spItem:a.spItemKeyFacet},n),i=r.isFolder,c=r.permissions,h=r.spItem,p=h&&a.spListKeyFacet.serialize(h),d=e.demandItemFacet(f.listFacet,p);if(!!d&&d.templateType===l.ListTemplateType.mySiteDocumentLibrary)return!1;var v=u.default.hasItemPermission({permissions:c},u.default.viewVersions);return!i&&v}return!1})))});
define("VQe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateMountPointAction))});t.RemoveMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RemoveMountPointAction))})});
define("jQe",["require","exports","lC","Oy","_s","ii","li","ii","ai"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchFormatViewPaneAction=i.withCurrentItemSet()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["XKe"],t,n)})];case 1:return[2,t.sent().LaunchFormatViewPaneAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(o.spFolderItemSetKeyFacet,n),i=r&&o.spListKeyFacet.serialize(r),f=e.demandItemFacet(u.listFacet,i);if(!!f&&f.templateType===a.ListTemplateType.mySiteDocumentLibrary)return!1;if(r&&r.viewKey){var l=o.spViewKeyFacet.serialize(r.viewKey);if(e.demandItemFacet(s.currentDerivedViewFacet,l))return!0}}return!1}))});
define("BQe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ApproveRejectAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ApproveRejectAction))})});
define("NQe",["require","exports","px","RKe","yh","zX"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToQueryRootAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),o=e.consume(s.resourceKey),u=e.consume(i.url);return new(e.injected(r.OpenAction))({item:o.getItemSync({parentKey:u.getRootItemKey(t.queryType)}).item,openRelation:2})})});
define("AQe",["require","exports","RQe","FQe","TQe","MQe","vqe","LQe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.alertMeCommand=n.alertMeCommand;t.manageAlertCommand=r.manageAlertCommand;t.versionHistoryCommand=i.versionHistoryCommand;t.powerAppsCommand=s.powerAppsCommand;t.aibuilderCommand=o.aibuilderCommand;t.powerBICommand=u.powerBICommand});
define("RQe",["require","exports","r","si","HQe","W0"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.alertMeCommand={key:new r.Facet("AlertMe").id,name:s.default.Alert,action:n.createElement(i.AlertMeAction,null),iconProps:{iconName:"Ringer"},automationId:"alertMe"}});
define("HQe",["require","exports","lC","r","_s","Xy","Jy","ii","T3","Rs","Oy","c0"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=l.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["rWe"],t,n)})];case 1:return[2,t.sent().AlertAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),l=e.demandItemFacet(u.permissionsFacet,n);if(!(!!i&&!i.isEmailAuthenticationGuestUser&&a.PermissionMask.hasItemPermission({permissions:l},a.PermissionMask.createAlerts)))return!1;var c=r&&r.consume(o.resourceKey.optional);if(c){var h=e.demandItemFacet(f.canonicalUrlFacet,n);if(c.getUrlParts({path:h}).isCrossDomain)return!1}return!0}),p=i.withSelectedItems()(i.withCurrentItemAsFallback()(i.withExactlyOneItem()(h)));t.AlertMeAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e})};t.ManageAlertAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e,manageAlerts:!0})}});
define("FQe",["require","exports","r","si","HQe","W0"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAlertCommand={key:new r.Facet("ManageAlert").id,name:s.default.ManageAlert,action:n.createElement(i.ManageAlertAction,null),iconProps:{iconName:"EditNote"}}});
define("TQe",["require","exports","r","si","UQe","W0"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.versionHistoryCommand={key:new r.Facet("VersionHistory").id,name:s.default.ShowVersionHistory,action:n.createElement(i.VersionHistoryAction,null),iconProps:{iconName:"StackIndicator"}}});
define("UQe",["require","exports","lC","r","_s","Xy","Jy","ii","jS","T3","Rs","Oy","c0","li","dC","oi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=c.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["WKe"],t,n)})];case 1:return[2,t.sent().VersionHistoryAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),c=e.demandItemFacet(u.permissionsFacet,n),h=e.demandItemFacet(a.itemComplianceStatusFacet,n),m=e.demandItemFacet(l.malwareDetectedFacet,n),g=!!i&&!i.isEmailAuthenticationGuestUser&&f.PermissionMask.hasItemPermission({permissions:c},f.PermissionMask.viewVersions)&&3!==h&&4!==h;if(m||!g)return!1;var y=e.demandItemFacet(p.spItemKeyFacet,n),b=y&&p.spListKeyFacet.serialize(y),w=e.demandItemFacet(u.listFacet,b),E=!(!w||!w.enableVersions&&!w.isModerated);if(!E)return!1;var S=r&&r.consume(o.resourceKey.optional);if(S){var x=e.demandItemFacet(l.canonicalUrlFacet,n);if(S.getUrlParts({path:x}).isCrossDomain)return!1}var T=e.demandItemFacet(l.folderFacet,n),N=e.demandItemFacet(u.documentSetFacet,n),C=e.demandItemFacet(v.oneNoteFacet,n),k=e.demandItemFacet(u.listItemIdFacet,n),L=d.isFeatureEnabled(d.DocumentSetsModernView)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites)&&k;return E=!T&&!C||!(!L||!N)}),g=i.withSelectedItems()(i.withExactlyOneItem()(m));t.VersionHistoryAction=function(){var e=h.useResourceScope();return r.createElement(g,{resources:e})}});
define("MQe",["require","exports","r","si","pb","PQe","W0","dC"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={key:new r.Facet("CustomizeListForms").id,name:o.default.CustomizeListForms,engagement:{name:"LaunchCustomizePowerAppForm",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.CustomizeFormsNavigationAction,null))},f={key:new r.Facet("CreateAppView").id,name:o.default.CreateAppView,engagement:{name:"LaunchCreatePowerAppPanel",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.LaunchCreateAppViewPanelAction,null))},l={key:new r.Facet("SeeAllApps").id,name:o.default.SeeAllAppsLabel,engagement:{name:"LaunchSeeAllPowerApps",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.SeeAllAppsAction,null))};t.powerAppsCommand={key:new r.Facet("PowerApps").id,name:u.isFeatureEnabled(u.PowerAppsIncludeSpace)?o.default.AppViewsCommandLabel_WithSpace:o.default.AppViewsCommandLabel,iconProps:{iconName:"PowerApps2Logo"},engagement:{name:"PowerAppsMainMenu",isIntentional:!0},subMenuProps:{items:[f,l,a]}}});
define("PQe",["require","exports","lC","_s","Xy","dC","li","ii","ai","Oy"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t){var n=t.itemKey;if(!n)return!1;var r=i.getPageContextFromItemCache(e,n);return!!r&&!!n&&s.isFeatureEnabled(s.PowerApps)&&!r.disableAppViews}t.CustomizeFormsNavigationAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["QKe"],t,n)})];case 1:return[2,t.sent().CustomizeFormsNavigationAction]}})})},function(e,t){var n=t.itemKey,r=s.isFeatureEnabled(s.PowerAppListForms)&&s.isFeatureEnabled(s.PowerApps),i=!!n&&r;if(!i)return!1;var f=e.demandItemFacet(o.spItemKeyFacet,n),l=f&&o.spListKeyFacet.serialize(f),c=e.demandItemFacet(u.listFacet,l);if(!c||!c.id)return!1;var h=!(!c.permissions||!c.permissions.manageLists),p=c.isDocumentLibrary,d=Number(c.templateType)===a.ListTemplateType.genericList;return i=(p||d)&&h}));t.LaunchCreateAppViewPanelAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["QKe"],t,n)})];case 1:return[2,t.sent().LaunchCreateAppViewPanelAction]}})})},function(e,t){var n=t.itemKey,r=!!n&&l(e,t);if(r){var i=e.demandItemFacet(o.spItemKeyFacet,n),s=i&&o.spListKeyFacet.serialize(i),a=e.demandItemFacet(u.listFacet,s);r=!(!(a&&a.permissions&&a.permissions.manageLists)||a.isDocumentLibrary)}return r}));t.SeeAllAppsAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["QKe"],t,n)})];case 1:return[2,t.sent().SeeAllAppsAction]}})})},l))});
define("vqe",["require","exports","r","si","pb","yqe","W0"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={key:new r.Facet("CreateAIBuilderModel").id,name:o.default.CreateAIBuilderModel,action:n.createElement(i.HideWithSelection,null,n.createElement(s.CreateAIBuilderModelAction,null))},a={key:new r.Facet("ViewAIBuilderModelDetails").id,name:o.default.ViewAIBuilderModelDetails,action:n.createElement(i.HideWithSelection,null,n.createElement(s.ViewAIBuilderModelDetailsAction,null))},f={key:new r.Facet("GotoAIBuilder").id,name:o.default.GotoAIBuilder,action:n.createElement(i.HideWithSelection,null,n.createElement(s.ViewAIBuilderModelsAction,null))};t.aibuilderCommand={key:new r.Facet("AIBuilder").id,name:o.default.AIBuilderCommandLabel,iconProps:{iconName:"HomeGroup"},subMenuProps:{items:[u,a,f]}}});
define("yqe",["require","exports","lC","r","ks","Ro","C1","ii","ai","li","Dqe","Sqe","T3","Re"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.isAvailable,s="https://"+l.getAIBuilderRunTimeHost()+"/aibuilder/default-environment/models?template=SharePointFormProcessing";return r.createElement(i.Action,{isAvailable:t,onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){window.open(s,"_blank");return[2]})})}})};return t})(r.PureComponent),v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.isModelApplied,n=e.permissions,i=h.default.hasItemPermission({permissions:n},h.default.manageLists),s=p.default.isActivated("FAEE08B0-697A-4B92-AA71-74ED9A366CA7","6/23/2020","Check permission for create form processing model menu")?!t:!t&&i;return r.createElement(r.Fragment,null,s&&r.createElement(c.LaunchCreateAIBModelPanelAction,null))};return t})(r.PureComponent),m=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.isModelApplied;return r.createElement(r.Fragment,null,e&&r.createElement(c.LaunchCreateAIBModelPanelAction,null))};return t})(r.PureComponent);function g(e){var t,n=s.getCurrentItemSetKey(e),r=e.demandItemFacet(f.spFolderItemSetKeyFacet,n),i=r&&f.spListKeyFacet.serialize(r),o=e.demandItemFacet(u.listFacet,i),a=r?r.webAbsoluteUrl:"",l=null===(t=r)||void 0===t?void 0:t.listFullUrl;return{viewId:r&&r.viewKey?r.viewKey.viewId:void 0,webAbsoluteUrl:a,list:o,listFullUrl:l,isPredictionModelApplied:!!o&&!!o.flags2&&8192==(8192&o.flags2),permissions:l?e.demandItemFacet(u.permissionsFacet,f.spItemKeyFacet.serialize({listFullUrl:l,webAbsoluteUrl:a})):void 0}}t.ViewAIBuilderModelsAction=o.connectToItemCache(function(e){var t=g(e).list;return{isAvailable:!!t&&!!t.isDocumentLibrary&&t.templateType!==a.ListTemplateType.webPageLibrary&&t.templateType!==a.ListTemplateType.mySiteDocumentLibrary}})(d);t.CreateAIBuilderModelAction=o.connectToItemCache(function(e){var t=g(e);return{isModelApplied:t.isPredictionModelApplied,permissions:t.permissions}})(v);t.ViewAIBuilderModelDetailsAction=o.connectToItemCache(function(e){return{isModelApplied:g(e).isPredictionModelApplied}})(m)});
define("Dqe",["require","exports","QH"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAIBuilderRunTimeHost=function(){var e="make.powerapps.com";n.isFeatureEnabled(n.PreviewAIBuilder)?e="make.preview.powerapps.com":n.isFeatureEnabled(n.PowerAppsAndAndProcessSimpleTestEnvironment)&&(e="make.test.powerapps.com");return e}});
define("Sqe",["require","exports","lC","r","C1","x2","To","c0","yp","Ro","li","ii","ai"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["FYe"],t,n)})];case 1:return[2,t.sent().default]}})})});t.LaunchCreateAIBModelPanelAction=i.createItemCacheComponent(function(e){var t,n,i=f.getCurrentItemSetKey(e),a=e.demandItemFacet(l.spFolderItemSetKeyFacet,i),d=a&&l.spListKeyFacet.serialize(a),v=e.demandItemFacet(c.listFacet,d),m=a?a.webAbsoluteUrl:"",g=(null===(t=a)||void 0===t?void 0:t.listFullUrl)?a.listFullUrl:"",y=(null===(n=v)||void 0===n?void 0:n.id)?v.id.replace("{","").replace("}",""):"",b=!!(g&&m&&y&&v&&v.isDocumentLibrary&&v.templateType!==h.ListTemplateType.webPageLibrary&&v.templateType!==h.ListTemplateType.mySiteDocumentLibrary),w=!!v&&!!v.flags2&&8192==(8192&v.flags2);return r.createElement(s.WizardAction,{engagement:{isIntentional:!0,name:w?"ViewFormProcessingModelPanelOpen":"CreateFormProcessingModelPanelOpen",currentPage:"DocumentLibraryPage"},isAvailable:b},u.withResources()(function(e){var t=e.reject,n=e.resolve;return r.createElement(p,{resources:e.resources,onDismiss:function(){t(new o.CancelError)},onComplete:function(e){e&&n()},createModelContext:{webAbsoluteUrl:m,listId:y,listFullUrl:g,isPredictionModelApplied:w}})}))})});
define("x2",["require","exports","Vr","C1","ks","Ps"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WizardAction=r.connectToItemCache(o("local"))(i.Action);t.BackgroundAction=r.connectToItemCache(o("global"))(i.Action);t.HeadlessAction=r.connectToItemCache(o("headless"))(i.Action);function o(e){return function(t,r){var i=r.children;return{onExecute:s.renderComponentOnExecute(function(e){return n.renderChildrenWithProps(i,e)},{scope:e})}}}});
define("LQe",["require","exports","r","si","pb","kQe","W0"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.powerBICommand={key:new r.Facet("PowerBI").id,name:o.default.PowerBICommandLabel,iconProps:{iconName:"PowerBILogo16"},action:n.createElement(i.HideWithSelection,null,n.createElement(s.PowerBIAction,null))}});
define("kQe",["require","exports","lC","r","C1","ks","Ps","To","tv","Xy","_s","Es"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../components/powerBI/PowerBIPanel"],t,n)})];case 1:return[2,t.sent().PowerBIPanel]}})})});t.PowerBIAction=l.withCurrentItemSet()(i.createItemCacheComponent(function(e,t){var i=t.itemKey,a=f.getPageContextFromItemCache(e,i);if(!a)return null;var l=c.getItemActionEngagement(e,{itemKey:i,engagement:{name:"LaunchPowerBIPanel",isIntentional:!0}}),p=o.renderComponentOnExecute(function(e){return r.createElement(h,{pageContext:a,onDismiss:function(){e.reject(new u.CancelError)}})});return r.createElement(s.Action,n.__assign({onExecute:p},l))}))});
define("wQe",["require","exports","r","si","EQe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.captureVersionCommand={key:new r.Facet("CaptureVersion").id,name:s.default.CaptureVersion,action:n.createElement(i.CaptureVersionAction,null),iconProps:{iconName:"StackIndicator"}}});
define("EQe",["require","exports","lC","r","ks","_s","Ps","Xy","WB","Jy","Zn","bU","AD","ii","jS","T3","Rs","C1","Es","c0","li","QH"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=g.createItemCacheComponent(function(e,t){var s=t.itemKey,l=t.resources,g=e.demandItemFacet(p.listItemIdFacet,s),b=u.getPageContextFromItemCache(e,s),S=b?b.layoutsUrl:"",T=b&&b.listId||"",N=(b?b.webAbsoluteUrl:"")+"/"+S+"/CreateDocSetVersion.aspx?"+h.serializeQuery({list:T,ID:g||"",IsDlg:1}),C=(function(e,t){var n=t.itemKey,r=t.resources;if(!n||!r)return!1;var i=u.getPageContextFromItemCache(e,n),s=e.demandItemFacet(p.permissionsFacet,n),o=e.demandItemFacet(d.itemComplianceStatusFacet,n);if(!i||i.isEmailAuthenticationGuestUser||!v.PermissionMask.hasItemPermission({permissions:s},v.PermissionMask.editListItems)||3===o||4===o)return!1;var a=e.demandItemFacet(w.spItemKeyFacet,n),l=a&&w.spListKeyFacet.serialize(a),c=e.demandItemFacet(p.listFacet,l),h=!!c&&!!c.enableVersions;if(!h)return!1;var g=r.consume(f.resourceKey.optional);if(g){var y=e.demandItemFacet(m.canonicalUrlFacet,n);if(g.getUrlParts({path:y}).isCrossDomain)return!1}var b=e.demandItemFacet(p.documentSetFacet,n),S=e.demandItemFacet(p.listItemIdFacet,n),x=E.isFeatureEnabled(E.DocumentSetsModernView)&&E.isFeatureEnabled(E.UseItemsScopeInTeamSites)&&S;return h=!(!x||!b)})(e,{itemKey:s,resources:l}),k=o.renderComponentOnExecute(function(e){return r.createElement(c.IFrameDialog,{url:N,heightOffset:.7,dialogContentProps:{title:a.default.CaptureVersion},onDismiss:function(){e&&e.resolve&&e.resolve()},onLoad:x})});return r.createElement(i.Action,n.__assign({isAvailable:C,onExecute:k},y.getItemActionEngagement(e,{itemKey:s,engagement:{name:"CaptureVersion",isIntentional:!0}})))});function x(e){new l.Async(void 0).setTimeout(function(){if(e&&e.contentDocument){var t=e.contentDocument.body.clientHeight;t>0&&(e.style.height=t+"px")}},10)}var T=s.withSelectedItems()(s.withExactlyOneItem()(S));t.CaptureVersionAction=function(){var e=b.useResourceScope();return r.createElement(T,{resources:e})}});
define("OQe",["require","exports","lC","r","RWe","Kg","jy"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommand=n.__assign(n.__assign({},o.detailsCommandBaseWithoutAction),{action:r.createElement(s.WithKnockoutResourceScope,null,r.createElement(i.ToggleInfoPaneAction,null)),automationId:"detailsCommand"})});
define("jy",["require","exports","lC","si","r","W0","c0","Vy"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommandBaseWithoutAction={key:new r.Facet("Details").id,automationId:"detailsPane",iconProps:{iconName:"Info"},title:s.default.DetailsPane,ariaLabel:s.default.DetailsPane,shortcutProps:{content:s.default.DetailsPane,keySequences:["I"]},commandBarButtonAs:function(e){var t=e.defaultRender,r=o.useResourceScope().consume(u.resourceKey),s=e.actionState,a=s&&s.isToggled;return t?i.createElement(t,n.__assign({},e,{"aria-controls":r,"aria-expanded":!!a})):null}}});
define("xQe",["require","exports","r","si","CQe","WB","W0"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsMenuCommand={key:new r.Facet("Details").id,name:s.default.Details,ariaLabel:o.default.DetailsPane,action:n.createElement(i.ShowInfoPaneAction,null),automationId:"detailsMenuCommand"}});
define("CQe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!1})},{isToggleable:!1})});
define("yQe",["require","exports","lC","r","IQe","SQe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommand=n.__assign(n.__assign({},s.filtersPaneCommandBaseWithoutAction),{action:r.createElement(i.ToggleFiltersPaneAction,null)})});
define("IQe",["require","exports","lC","_s","Oy","Gg","oh","F1","ii","Z0","ch","_3","d1","j5","QH","dC","mD"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleFiltersPaneAction=r.withOnlyCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["Qat"],t,n)})];case 1:return[2,t.sent().ToggleFiltersPaneAction]}})})},function(e,t){var n=e.demandItemFacet(a.spPageContextFacet,o.odspNextAppItemKey);if(n&&Number(n.webTemplate)!==f.default.mySite)return!0;var r=u.getItemsScope(e).itemsScopeItemKey,i=e.demandItemFacet(l.currentViewParamsFacet,r)||{},s=p.getQueryType(i),g=c.isSearchType(s),y=s===h.default.SharedWithMe,b=d.isFeatureEnabled(v.SharedWithMeItemsScope)||!m.isGallatin();return d.isFeatureEnabled(d.FiltersInODB)&&g||b&&y},function(e,t){var n=e.demandItemFacet(s.currentPaneFacet,o.odspNextAppItemKey);return!!n&&n.paneKey===s.FILTERS_PANE_KEY}))});
define("SQe",["require","exports","lC","r","W0","DQe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommandBaseWithoutAction={key:s.filtersPaneCommandKey,automationId:"filtersPane",title:i.default.FiltersPane,ariaLabel:i.default.FiltersPane,iconProps:{iconName:"Filter"},commandBarButtonAs:function(e){var t=e.actionState&&e.actionState.isToggled,i=e.defaultRender;return i?r.createElement(i,n.__assign({},e,{"aria-expanded":!!t})):null}}});
define("DQe",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommandKey=n.getNextId("filtersPane")});
define("vQe",["require","exports","r","si","pb","TWe","WB"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveToCommand={key:new r.Facet("MoveTo").id,name:o.default.Move,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.LaunchMoveCopyPanelAction,{isMove:!0})),iconProps:{iconName:"FabricMoveToFolder"}}});
define("gQe",["require","exports","r","si","pb","TWe","WB"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyToCommand={key:new r.Facet("CopyTo").id,name:o.default.Copy,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.LaunchMoveCopyPanelAction,{isMove:!1})),iconProps:{iconName:"Copy"}}});
define("hQe",["require","exports","r","si","pb","bQe","WB"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.runModelCommand={key:new r.Facet("AutoClassify").id,name:o.default.RunModelText,title:o.default.RunModelToolTip,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.RunModelAction,null)),iconProps:{iconName:"Play"}}});
define("bQe",["require","exports","lC","r","_s","c0","C1","ks","Rs","S3","YWe","ai","UK","VK","zK","BK","RB","Uk","gD","Y","li","_s","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=o.createItemCacheComponent(function(e,t){var i,s,o=t.resources;if(!o)return null;var x=t.itemKeys;x=x.filter(function(t){return!e.demandItemFacet(a.folderFacet,t)});var T=o&&o.consume(f.listContext)||{},N=T.listUrl,C=T.listTemplateType,k=E.getCurrentItemSetKey(e),L=e.demandItemFacet(w.spFolderItemSetKeyFacet,k),A=L&&w.spListKeyFacet.serialize(L),O=e.demandItemFacet(S.listFacet,A),M=o&&o.consume(l.resourceKey),_=o&&o.consume(f.pageContext)||{},D=_.webAbsoluteUrl,P=_.webServerRelativeUrl,H=x.map(function(t){var n,r,i=new m.default(t),s=e.demandItem({fileName:a.fileNameFacet,openUrl:a.openUrlFacet},t),o=s.fileName,u=s.openUrl;i.name=(null===(n=o)||void 0===n?void 0:n.name)||"";i.extension=(null===(r=o)||void 0===r?void 0:r.extension)||"";i.displayName=""+i.name+i.extension;i.openUrl=u||"";return i}),B=x&&x.length>0&&C!==c.default.contentCenterSampleLibrary&&!!O&&!!O.flags2&&4096==(4096&O.flags2)&&!!(null===(s=null===(i=O)||void 0===i?void 0:i.permissions)||void 0===s?void 0:s.manageLists);return r.createElement(u.Action,{isAvailable:B,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(n){switch(n.label){case 0:e=(function(){var e=new v.default,t=o.consume(h.resourceKey),n=H.map(function(n){var r=t.register({name:n.displayName||"",iconName:g.getIconNameFromItem({type:y.default.File,extension:n.extension}),type:p.default.runModelOnItems,payloads:{runModelOnItems:{item:n}},batch:e,progress:{minimum:0,maximum:1,current:0}});r.progress.maximum(1);r.progress.current(0);return r});n.forEach(function(e){e.state(d.default.started)});return n})();t=(function(){var e=[];H.forEach(function(t){var n,r={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningWorkItemEntityData"},Type:"AE9D4F24-EE84-4C0C-A972-A74CFFE939A1",TargetSiteUrl:D,TargetWebServerRelativeUrl:P,TargetServerRelativeUrl:((null===(n=L)||void 0===n?void 0:n.rootFolder)||N)+"/"+t.displayName};e.push(r)});return e})();return[4,null===(r=M)||void 0===r?void 0:r.runModel(t).then(function(t){e.forEach(function(e){if(t.has(e.name)){e.progress.current(1);e.state(d.default.completed)}else e.state(d.default.failed)})}).catch(function(t){var n,r;b.default.log("[ccui] fetching content type failed "+(null===(r=null===(n=t)||void 0===n?void 0:n.message)||void 0===r?void 0:r.value));e.forEach(function(e){e.state(d.default.failed)})})];case 1:n.sent();return[2]}})})}})}),T=i.withSelectedItems()(x);t.RunModelAction=function(){var e=s.useResourceScope();return r.createElement(T,{resources:e})}});
define("cQe",["require","exports","lC","r","si","W0","dQe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fullscreenCommand={action:o.FullscreenAction,automationId:"expandCollapseList",key:new i.Facet("FullscreenMode").id,commandBarButtonAs:function(e){var t=e.defaultRender,i=e.actionState&&e.actionState.isToggled;return t?r.createElement(t,n.__assign({},e,{iconProps:{iconName:i?"BackToWindow":"FullScreen"},title:i?s.default.collapseContent:s.default.expandContent})):null}}});
define("dQe",["require","exports","lC","r","ks","uQe","S3","lQe","pv"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FullscreenAction=s.createComponentWithSPOAppContext([s.ContextKeys.pageControls,s.ContextKeys.resources])(function(e){var t=e.pageControls,f=e.resources,l=t.isFullscreen,c=f.consume(u.resourceKey);return r.createElement(i.Action,{isToggled:l,engagement:{isIntentional:!0,name:l?"FullscreenListOff":"FullscreenListOn"},onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){t=f.consume(o.pageContext);(r=t&&t.listUrl)&&c.setFullscreenToStorage(!l,r);a.default.raise(document.body,"resize",void 0,!0);e.handleContextDataChange(((i={})[s.ContextKeys.pageControls]={isFullscreen:!l},i));return[2]})})}})})});
define("uQe",["require","exports","lC","qr","Hr","r","p3","_Qe","pQe","fQe"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextKeys=u;var l=s.createContext({}),c=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._isDisposed=!1;r._handleContextChange=function(e){if(!r._isDisposed){var t=r.state,i=t.contextData,s=t.handleContextDataChange,o=p(i,e);if(!o)return null;r.setState({contextData:o,handleContextDataChange:s},function(){r._contextHandler.notifyUpdate(n.__assign({},o))})}};r._contextHandler=t.resources.consume(f.resourceKey);r._setContextInitState();return r}t.prototype.componentDidMount=function(){this._contextHandler.registerContextChangeHandler(this._handleContextChange);this._contextHandler.notifyUpdate(n.__assign({},this.state.contextData))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0;this._stopListener&&this._stopListener()};t.prototype.render=function(){return s.createElement(l.Provider,{value:this.state},this.props.children)};t.prototype._setContextInitState=function(){var e=this,t=this.props,r=t.resources,i=t.overrideContextData,s=r.consume(o.resourceKey);this._stopListener=s.listen(function(t){var r;e._handleContextChange(((r={})[u.responsiveUIMetrics]=n.__assign({},t),r))});this.state={contextData:a.createSPOAppContextData(r,i),handleContextDataChange:this._handleContextChange}};return t})(s.PureComponent);t.SPOAppContextProvider=c;function h(e,t){for(var n=t.contextData,r={handleContextDataChange:t.handleContextDataChange},i=[],s=0,o=e;s<o.length;s++){var u=o[s],a=n[u].data;r[u]=a;i.push(a)}return{pickedContext:r,contextDeps:i}}t.pickContextItems=h;t.createComponentWithSPOAppContext=function(e){return function(t){return function(r){var i=s.useContext(l),o=h(e,i),u=o.pickedContext,a=o.contextDeps,f=t;return s.useMemo(function(){return s.createElement(f,n.__assign({},u,r))},n.__spreadArrays(a,[r]))}}};function p(e,t){var n={},s=!1;for(var o in t){var u=e[o],f=u.data,l=t[o],c=void 0;switch(u.updateMethod){case a.ContextItemUpdateMethod.READONLY:throw'Read-only SPOAppContextItem "'+o+'" cannot be updated';case a.ContextItemUpdateMethod.REPLACE:c=l;break;case a.ContextItemUpdateMethod.PATCH:default:c=r.graft(f,l)}if(i.areShallowDifferent(f,c)){s=!0;n[o]={data:new r.ReplacePatch(c)};u.onChange&&u.onChange(f,c)}}return s?r.graft(e,n):null}t.createNewContextData=p});
define("p3",["require","exports","lC","pv","m3","X_"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},u={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0};t.breakpointsResourceKey=new s.ResourceKey({name:e("module").id+".breakpoints",factory:new s.ConstantResourceFactory(u)});var a=(function(e){n.__extends(i,e);function i(t,n){var i=e.call(this)||this;i._onContainerResize=function(e){var t=i._containerElement,n=document.body,r=document.documentElement,s=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,o=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight,a=i._computeFormFactorSize(i._breakpoints,s),f=i._computeCssClass(a),l=i._computeShowLabels(a),c=i._computeIsHamburgerVisible(s),h=i._computeIsScopingControlVisible(s),p={DEFAULT_BREAKPOINTS:u,MAC_SCROLL_BAR_WIDTH:8,windowWidth:s,windowHeight:o,formFactorSize:a,showLabels:l,isHamburgerVisible:c,isScopingControlVisible:h,cssClass:f};i.setData(p)};var s=t.containerElement,o=void 0===s?window:s,a=n.breakpoints;i._containerElement=o;i._breakpoints=a;i._event=new r.default(i);i._event.on(i._containerElement,"resize, orientationchange",i._onContainerResize);i._onContainerResize();return i}Object.defineProperty(i.prototype,"metrics",{get:function(){return this.readData()},enumerable:!0,configurable:!0});i.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};i.determineWindowSize=function(e,t){void 0===t&&(t=u);if(0===e)return"Medium";for(var n in u)if(e<t[n])return n};i.determineCssClass=function(e){return o[e]};i.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};i.prototype.compareSize=function(e,t){var n=this._breakpoints;return n[e]-n[t]};i.prototype._computeFormFactorSize=function(e,t){return this._containerElement===window?i.determineWindowSize(t,e):"Medium"};i.prototype._computeCssClass=function(e){return i.determineCssClass(e)};i.prototype._computeShowLabels=function(e){return this.compareSize(e,"Medium")>0};i.prototype._computeIsHamburgerVisible=function(e){return e<u.Large};i.prototype._computeIsScopingControlVisible=function(e){return e>u.Large};i.dependencies={breakpoints:t.breakpointsResourceKey};return i})(i.Listenable);t.ResponsiveUI=a;t.resourceKey=s.createResolvedResourceKey(e("module").id,a)});
define("m3",["require","exports","qr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this._listeners=[]}e.prototype.readData=function(){return this._data};e.prototype.listen=function(e){var t=this;this._listeners.indexOf(e)<0&&this._listeners.push(e);return function(){var n=t._listeners.indexOf(e);n>=0&&t._listeners.splice(n,1)}};e.prototype.setData=function(e){this._data=this._data||{};var t=n.graft(this._data,e);this._data=t;for(var r=0,i=this._listeners;r<i.length;r++){(0,i[r])(this._data)}};e.prototype.refresh=function(){};return e})();t.Listenable=r});
define("_Qe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.legacyMode="legacyMode";t.viewParams="viewParams";t.responsiveUIMetrics="responsiveUIMetrics";t.itemsScopeCurrentItemKey="itemsScopeCurrentItemKey";t.resources="resources";t.paneControls="paneControls";t.pageControls="pageControls";t.hotMainComponent="hotMainComponent"});
define("pQe",["require","exports","Lh","rU","px","px","mQe","V5e","p3","_Qe","lQe","Re"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(e){e[e.READONLY=0]="READONLY";e[e.REPLACE=1]="REPLACE";e[e.PATCH=2]="PATCH"})(h=t.ContextItemUpdateMethod||(t.ContextItemUpdateMethod={}));t.createSPOAppContextData=function(e,t){void 0===t&&(t={});var p,d=e.consume(o.resourceKey),v=e.consume(n.navigation),m={name:f.legacyMode,updateMethod:h.REPLACE,data:!1},g={name:f.viewParams,data:v.viewParams,updateMethod:h.REPLACE,onChange:function(t,n){e.consume(i.originalViewParams)&&r.default(e.consume(i.originalViewParams),n);var o=e.consume(s.viewParams.optional);o&&o(n);d.updateViewParams(n)}};!c.default.isActivated("755D4075-3A26-4A5E-82ED-51702CAA4E54","05/05/20","initialize currentViewParamsFacet when create createSPOAppContextData")&&g.data&&d.updateViewParams(g.data);var y=e.consume(a.resourceKey),b={name:f.responsiveUIMetrics,updateMethod:h.PATCH,data:y.metrics},w={name:f.resources,updateMethod:h.READONLY,data:e},E={name:f.itemsScopeCurrentItemKey,data:e.consume(u.resourceKey).currentItemKey,updateMethod:h.REPLACE,onChange:function(t,n){if(n!==t){e.consume(u.resourceKey).currentItemKey=n;d.openItem(n)}}},S={name:f.paneControls,updateMethod:h.PATCH,data:{isLeftNavExpanded:!1,isRightPaneExpanded:!1,isInfoPaneExpanded:!1,isFiltersPaneExpanded:!1,isColumnCustomizationPaneExpanded:!1,isO365FlexPaneVisible:!1,isTipsNTricksPaneVisible:!1}},x=e.consume(l.resourceKey.optional),T=!c.default.isActivated("E6C29515-A1B5-472F-9759-B19A2BE8C623","02/11/20","Get fullscreen list setting from local storage")&&x&&x.getFullscreenFromStorage();return{legacyMode:m,viewParams:g,responsiveUIMetrics:b,resources:w,itemsScopeCurrentItemKey:E,paneControls:S,pageControls:{name:f.pageControls,updateMethod:h.PATCH,data:{canUserSelect:!0,isSuiteNavHamburgerVisible:y.metrics.isHamburgerVisible,isFullscreen:!!T}},hotMainComponent:{name:f.hotMainComponent,updateMethod:h.REPLACE,data:(p=t[f.hotMainComponent],null!=p?p:void 0)}}}});
define("mQe",["require","exports","lC","X_","z5e","rs","$1","Gp","ch","qr","si","k3","Oh","V5e","Eh"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=new h.default,m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.openActionControlHandler=function(e,t){throw new Error("Not Implemented")};r._itemsScopeItemKey=n.itemsScopeKeys.itemKey;r._itemCacheStore=n.itemCacheStore;r._itemCacheStore.dispatch(u.blockItemPage());return r}t.prototype.unblockItemPageRender=function(){var e=this;this._itemCacheStore.dispatch(s.readItems(function(e){return u.itemPageIsBlocked(e)}))&&v.setTimeout(function(){return e._itemCacheStore.dispatch(u.unblockItemPage())},0)};t.prototype.updateViewParams=function(e){var t;(0,this._itemCacheStore.dispatch)(o.resolveItems({items:(t={},t[this._itemsScopeItemKey]=l.pack({viewParams:a.currentViewParamsFacet},{viewParams:new f.MirrorPatch(e)}),t)}))};t.prototype.openItem=function(e){var t=this._itemCacheStore.dispatch,n=this._nextOpenItem;if(n){this._nextOpenItem=void 0;t(n)}else t(d.openItemWithAddon({itemsScopeItemKey:this._itemsScopeItemKey,currentItemKey:e}))};t.dependencies=n.__assign(n.__assign({},c.default.dependencies),{itemsScopeKeys:p.resourceKey,itemCacheStore:i.resourceKey});return t})(c.default);t.ItemsScopeHelper=m;t.resourceKey=r.createResolvedResourceKey(e("module").id,m)});
define("z5e",["require","exports","ih","V1","X_","_h","LD","oh","nC","aC","S3","tC","Dx","Yx","Zx","$f"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=new i.ResourceKey({name:e("module").id+".oneItemCacheInstance",factory:{dependencies:{},create:function(e){var t={created:!1};return{instance:t,disposible:t}}}}),g={resources:i.resourceScopeKey,itemsScopeKeyConverter:f.resourceKey,itemCacheConfiguration:c.resourceKey,webConfiguration:h.webConfigurationResourceKey,oneItemCacheInstance:m,pageContext:l.pageContext,itemsScopeAddon:a.resourceKey,knockoutStoreItemControlHandler:p.resourceKey};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:g,create:function(e){var t=e.itemsScopeKeyConverter,i=e.itemCacheConfiguration,a=e.webConfiguration,f=e.oneItemCacheInstance,l=e.itemsScopeAddon,c=e.knockoutStoreItemControlHandler;if(f.created)throw new Error("Attempted to create a second instance of the ItemCacheStore.");f.created=!0;var h=r.createItemCacheStore({configuration:a});h.dispatch(v.asBatch(function(){h.dispatch(i);h.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,s.itemKeyToStoreKeyControl)(n.createControlHandler()(function(){return function(){return t.itemKeyToStoreKeyControlHandler}})));h.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,o.viewParamsToItemKeyControl)(n.createControlHandler()(function(){return function(){return t.viewParamsToItemKeyControlHandler}})));h.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,d.knockoutStoreItemControl)(n.createControlHandler()(function(){return c})))}));h.dispatch(l);return{instance:h,disposable:h}}}})});
define("V5e",["require","exports","X_","li","li","R1","z5e","rs","Jy","S3","aC","px"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{itemUrlHelper:a.resourceKey,pageContext:f.pageContext,itemsScopeKeyConverter:l.resourceKey,viewParams:c.originalViewParams,itemCacheStore:o.resourceKey},create:function(e){var t=e.itemUrlHelper,n=e.pageContext,o=e.itemsScopeKeyConverter,a=e.viewParams,f=e.itemCacheStore,l=t.getUrlParts(),c=f.dispatch(u.readItems(function(e){var t=o.viewParamsToItemKeyControlHandler(e,{viewParams:a,isNavigation:!0}).itemKey,s=e.demandItemFacet(r.spFolderItemSetKeyFacet,t)||{webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:l.fullListUrl||"",rootFolder:""};return{currentItemKey:t||"",pageContextKey:i.spPageContextKeyFacet.serialize(s)}})),h=c.currentItemKey,p=c.pageContextKey,d={itemKey:s.getNextItemsScopeItemKey(),currentItemKey:h,pageContextKey:p};return{instance:d,disposable:d}}}});t.itemsScopeItemKeyResourceKey=new n.ResourceKey({name:e("module").id+".itemsScopeItemKey",factory:{dependencies:{itemsScopeKeys:t.resourceKey},create:function(e){return{instance:e.itemsScopeKeys.itemKey}}}})});
define("lQe",["require","exports","X_","S3"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.setFullscreenToStorage=function(e,t){if(window&&window.localStorage)try{var n=localStorage&&localStorage.getItem("sp-fullscreen-list");if(n){var r=JSON.parse(n);e?r[t]=!0:delete r[t];localStorage.setItem("sp-fullscreen-list",JSON.stringify(r))}else this._setInitialFullscreenToStorage(e,t)}catch(n){this._setInitialFullscreenToStorage(e,t)}};e.prototype.getFullscreenFromStorage=function(){var e=this._pageContext&&this._pageContext.listUrl,t=localStorage&&localStorage.getItem("sp-fullscreen-list"),n=!1;if(t&&e)try{n=!!JSON.parse(t)[e]}catch(e){}return n};e.prototype._setInitialFullscreenToStorage=function(e,t){var n,r=((n={})[t]=e,n);localStorage.setItem("sp-fullscreen-list",JSON.stringify(r))};e.dependencies={pageContext:r.pageContext};return e})();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i)});
define("fQe",["require","exports","lC","pv","X_","_Qe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextKeys=s;var o=(function(){function e(){this._events=new r.default(this);this._events.declare("contextUpdated")}e.prototype.registerContextChangeHandler=function(e){this._handleContextDataChange=e};e.prototype.update=function(e){this._handleContextDataChange&&this._handleContextDataChange(e)};e.prototype.onUpdated=function(e){this._events.on(this,"contextUpdated",e)};e.prototype.offUpdated=function(e){this._events.off(this,"contextUpdated",e)};e.prototype.notifyUpdate=function(e){this._contextData=e;this._events.raise("contextUpdated",e)};e.prototype.getContext=function(){return n.__assign({},this._contextData)};e.prototype.dispose=function(){this._events.dispose()};return e})();t.SPOAppContextHandler=o;t.resourceKey=new i.ResourceKey({name:e("module").id+"s",factory:new i.SimpleResourceFactory(o)})});
define("oQe",["require","exports","r","si","nc","pb","sQe","WB"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveCommand={key:new r.Facet("AddToOneDrive").id,name:u.default.CreateMountPoint,action:n.createElement(s.ShowOnlyWithSelection,null,n.createElement(o.AddToOneDriveAction,null)),iconProps:{iconType:i.IconType.Image,imageProps:{src:window.require.toUrl("odsp-media/images/addtoonedrive/a2od.svg"),width:"16px",height:"16px"}}}});
define("sQe",["require","exports","lC","r","_s","Rs","Oy","c0"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/AddToOneDriveAction"],t,n)})];case 1:return[2,t.sent().AddToOneDriveAction]}})})},function(e,t){var n=t.itemKey;return!!n&&!!e.demandItemFacet(s.folderFacet,n)}),f=i.withSelectedItems()(i.withExactlyOneItem()(a));t.AddToOneDriveAction=function(){var e=u.useResourceScope();return r.createElement(f,{resources:e})}});
define("iQe",["require","exports","r","si","rQe","WB","pb"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditCommand={key:new r.Facet("QuickEdit").id,name:s.default.EditAll,action:n.createElement(o.HideWithSelection,null,n.createElement(i.LaunchQuickEditAtion,null)),iconProps:{iconName:"Edit"}}});
define("rQe",["require","exports","lC","r","Oy","F1","_s","ii","T3","li","Rf","Xo","ai","S3","QH","m$","c0","Cx","d1","ch","he"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=new l.PlatformDetection;var S=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["YKe"],t,n)})];case 1:return[2,t.sent().LaunchQuickEditAction]}})})},function(e,t){if(d.isFeatureEnabled(d.showQuickEditFeature)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites))return!1;if(E.isMobile)return!1;var n=t.itemKey;if(n){var r=e.demandItemFacet(f.spFolderItemSetKeyFacet,n);if(r){var i=f.spListKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),o=e.demandItemFacet(u.listFacet,i);if((function(e,t,n){if(n&&n.isDocumentLibrary){var r=e.demandItemFacet(c.schemaFacet,t),i=[];if(r&&r.columnKeys)for(var s=0,o=r.columnKeys;s<o.length;s++){var a=o[s],f=e.demandItemFacet(u.internalNameFacet,a);f&&i.push({internalName:f})}return v.isOutOfTheBoxList(i,!0)}return!1})(e,n,o))return!1;var l=f.spPageContextKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),m=e.demandItemFacet(u.spPageContextFacet,l);if(m&&m.isAnonymousGuestUser)return!1;if(o&&o.templateType===h.default.mySiteDocumentLibrary)return!1;var S=void 0;if(!t.resources)return!1;if(!(S=t.resources.isExposed(p.inplaceEditorUrl)?t.resources.consume(p.inplaceEditorUrl):null))return!1;var x=e.demandItemFacet(f.spFolderItemSetKeyFacet,n),T=void 0,N=void 0;if(x&&x.viewKey){var C=f.spViewKeyFacet.serialize(x.viewKey);if((N=e.demandItemFacet(u.currentDerivedViewFacet,C))&&N.baseViewXml){T=(new DOMParser).parseFromString(N.baseViewXml,"text/xml").getElementsByTagName("ViewStyle")}}var k=s.getItemsScope(e).itemsScopeItemKey,L=e.demandItemFacet(b.currentViewParamsFacet,k),A=e.demandItemFacet(u.permissionsFacet,f.spItemKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl})),O=a.default.hasItemPermission({permissions:A},a.default.editListItems),M=g.getQueryType(e,n),_=e.demandItemFacet(c.childItemsFacet,n),D=!1;if(_&&_.itemKeys)for(var P=0,H=_.itemKeys;P<H.length;P++){var B=H[P];f.spItemGroupKeyFacet.matches(B)&&(D=!0)}return M===y.default.Files&&!D&&!!o&&!!o.allowGridMode&&!!N&&!!N.id&&!!T&&0===T.length&&!(L&&L.needsAttentionView)&&O&&(!S||!S())&&!(function(e,t){if(e&&e.listBaseTemplate&&h.isPromotedLinksList(e.listBaseTemplate))try{if(t&&t.baseViewXml){var n=w.xmlToDom(t.baseViewXml);if("1"===w.getAttr(n.childNodes[0],"BaseViewID"))return!0}}catch(e){}return!1})(m,N)}}return!1}),x=o.withCurrentItemSet()(S);t.LaunchQuickEditAtion=function(){var e=m.useResourceScope();return r.createElement(x,{resources:e})}});
define("nQe",["require","exports","r","si","aQe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelEditCommand={key:new r.Facet("CancelEdit").id,name:s.default.cancelEdit,action:n.createElement(i.LaunchCancelEditAtion,null),iconProps:{iconName:"CheckMark"}}});
define("aQe",["require","exports","lC","r","Oy","S3","c0"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["iWe"],t,n)})];case 1:return[2,t.sent().CancelEditAtion]}})})},function(e,t){var n=t.resources;if(n){var r=n.consume(s.inplaceEditorUrl.optional);return!(!r||!r())}return!1});t.LaunchCancelEditAtion=function(){var e=o.useResourceScope();return r.createElement(u,{resources:e})}});
define("tQe",["require","exports","r","si","FWe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.previewCommand={key:new r.Facet("Preview").id,name:s.default.Preview,automationId:"Preview",action:n.createElement(i.PreviewAction,null)}});
define("eQe",["require","exports","r","si","zQe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.workflowCommand={key:new r.Facet("Workflow").id,name:s.default.Workflow,action:n.createElement(i.WorkflowAction,null),automationId:"workflow"}});
define("$qe",["require","exports","r","si","zQe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.complianceDetailsCommand={key:new r.Facet("ComplianceDetails").id,name:s.default.ComplianceDetails,action:n.createElement(i.ComplianceDetailsAction,null),automationId:"complianceDetails"}});
define("Zqe",["require","exports","r","si","zQe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.publishCommand={key:new r.Facet("Publish").id,name:s.default.Publish,action:n.createElement(i.PublishAction,null)}});
define("Xqe",["require","exports","r","si","zQe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.unPublishCommand={key:new r.Facet("UnPublish").id,name:s.default.UnPublish,action:n.createElement(i.UnPublishAction,null)}});
define("Jqe",["require","exports","r","si","zQe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelPublishCommand={key:new r.Facet("CancelApproval").id,name:s.default.CancelApproval,action:n.createElement(i.CancelApprovalAction,null)}});
define("Qqe",["require","exports","lC","r","si","Yqe","pb","WB"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createShortcutCommand={key:new i.Facet("Link").id,name:u.default.CreateShortcut,action:r.createElement(o.HideWithSelection,null,r.createElement(s.CreateShortcutAction,null)),iconProps:{iconName:"Globe"}};t.createPersistentShortcutCommand=n.__assign(n.__assign({},t.createShortcutCommand),{action:r.createElement(s.CreatePersistentShortcutAction,null)})});
define("Yqe",["require","exports","lC","r","Oy","_s","F1","T3","ii","li","QH","Cx","d1","c0","iee"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["nWe"],t,n)})];case 1:return[2,t.sent().CreateShortcutAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!r||!n)return!1;var i=e.demandItemFacet(f.spItemKeyFacet,n);if(i){if(r.consume(d.resourceKey.optional)){var p=f.spPageContextKeyFacet.serialize({listFullUrl:i.listFullUrl,webAbsoluteUrl:i.webAbsoluteUrl}),v=e.demandItemFacet(a.permissionsFacet,n),m=u.default.hasItemPermission({permissions:v},u.default.insertListItems),g=e.demandItemFacet(a.spPageContextFacet,p),y=o.getItemsScope(e).itemsScopeItemKey,b=s.getCurrentItemSetKey(e,y);if(b){var w=c.getQueryType(e,b);return!!g&&!g.isAnonymousGuestUser&&!g.isEmailAuthenticationGuestUser&&l.isFeatureEnabled(l.ShortcutLink)&&l.isFeatureEnabled(l.SpListNext)&&m&&w===h.default.Files}}}return!1}),m=s.withOnlyCurrentItem()(v),g=s.withCurrentItem()(v);t.CreateShortcutAction=function(){var e=p.useResourceScope();return r.createElement(m,{resources:e})};t.CreatePersistentShortcutAction=function(){var e=p.useResourceScope();return r.createElement(g,{resources:e})}});
define("Wqe",["require","exports","r","si","qqe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInPowerBICommand={key:new r.Facet("OpenInPowerBI").id,name:s.default.OpenInPowerBI,action:n.createElement(i.OpenInPowerBIAction,null),iconProps:{iconName:"PowerBILogo16"}}});
define("qqe",["require","exports","lC","Oy","e4","Rs","_s","jS","F1","T3","ii","QH","Cx","kZ","j5"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInPowerBIAction=o.withSelectedItems()(o.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["JKe"],t,n)})];case 1:return[2,t.sent().OpenInPowerBIAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItem({fileName:s.fileNameFacet,itemStatus:u.itemComplianceStatusFacet,openUrl:s.openUrlFacet,permissions:l.permissionsFacet},n),v=r.fileName,m=r.itemStatus,g=r.openUrl,y=r.permissions,b=f.default.hasItemPermission({permissions:y},f.default.openItems),w=a.getItemsScope(e).itemsScopeItemKey,E=o.getCurrentItemSetKey(e,w);if(E){var S=h.getQueryType(e,E);return c.isFeatureEnabled(c.EnablePowerBIIngegration)&&!!v&&!!v.extension&&!!g&&(p.GetDocumentTypeFromExtension(v.extension)===i.DocumentType.Excel||".csv"===v.extension.toLowerCase())&&4!==m&&3!==m&&b&&!d.isRecycleBin(S)}}return!1})))});
define("Gqe",["require","exports","r","si","Kqe","WB","Kg"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInTextEditorCommand={key:new r.Facet("OpenInTextEditor").id,name:s.default.OpenInTextEditor,action:n.createElement(o.WithKnockoutResourceScope,null,n.createElement(i.OpenInTextEditorAction,null)),iconProps:{iconName:"Edit"}}});
define("Kqe",["require","exports","r","px","RKe","C1","Yo"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.OpenInTextEditorAction))});t.OpenInTextEditorAction=s.createItemCacheComponent(function(e){return 0===o.getSelectedItemKeys(e).length?null:n.createElement(u,null)})});
define("Vqe",["require","exports","r","si","zqe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={iconName:void 0,styles:{root:{display:"none!important"}}};t.openInExplorerCommand={key:new r.Facet("OpenInExplorer").id,name:s.default.OpenInExplorer,action:n.createElement(i.OpenInExplorerAction,null),iconProps:o}});
define("zqe",["require","exports","lC","r","_s","ii","li","Xy","ai","y1","C1","u9","ks","Es"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=new f.default,v=l.createItemCacheComponent(function(t,i){var f=i.itemKey,l=d.isIE,v=!1,m=void 0;if(l){var g=t.demandItemFacet(o.spItemKeyFacet,f),y=g&&o.spListKeyFacet.serialize(g),b=y&&t.demandItemFacet(s.listFacet,y),w=u.getPageContextFromItemCache(t,f),E=t.demandItemFacet(s.folderPathFacet,f);l=!(!(m=g&&E?g.listFullUrl+"?"+c.serializeQuery({ExplorerWindowUrl:E}):void 0)||!b||!b.isDocumentLibrary||b.templateType===a.default.webPageLibrary||!w||w.viewOnlyExperienceEnabled||w.blockDownloadsExperienceEnabled);v=!!b&&b.templateType===a.default.mySiteDocumentLibrary}return r.createElement(h.Action,n.__assign({isAvailable:l,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["sWe"],t,n)})];case 1:(0,t.sent().openInExplorerExecutor)({isODB:v,explorerWindowUrl:m});return[2]}})})}},p.getItemActionEngagement(t,{itemKey:f,engagement:{name:"OpenInExplorer",isIntentional:!0}})))});t.OpenInExplorerAction=i.withCurrentItem()(v)});
define("Bqe",["require","exports","r","si","pb","jqe","W0"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInSharePointCommand={key:new r.Facet("OpenInSharePoint").id,name:o.default.OpenInSharePoint,action:n.createElement(i.HideWithSelection,null,n.createElement(s.OpenInSharePointAction,null)),iconProps:{iconName:"SharepointLogo"}}});
define("jqe",["require","exports","lC","Oy","Y0","Ty"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInSharePointAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["KKe"],t,n)})];case 1:return[2,t.sent().OpenInSharePointAction]}})})},function(e,t){var n=i.isTeamsWebView(),r=s.isCrossOrigin();return n||r})});
define("Rqe",["require","exports","lC","r","si","Nqe","WB","Qe","QH"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.teamChannelCommand={key:new i.Facet("TeamChannel").id,name:o.default.Channel,action:r.createElement(s.TeamChannelAction,null),iconProps:a.isFeatureEnabled(a.CommandBarBrandIcons)?n.__assign(n.__assign({},u.getBrandTypeIconProps({extension:"",brand:"teams",size:16})),{styles:{root:{width:"16px",height:"16px",selectors:{img:{width:"16px",height:"16px",display:"block"}}}}}):{iconName:"TeamsLogo"}}});
define("Nqe",["require","exports","lC","Oy","_s","F1","ii","li","Tz","Y0","Re"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["qKe"],t,n)})];case 1:return[2,t.sent().TeamChannelAction]}})})},function(e,t){var n=t.itemKey,r=s.getItemsScope(e).itemsScopeItemKey,c=i.getCurrentItemSetKey(e,r),h=e.demandItemFacet(u.spFolderItemSetKeyFacet,c),p=e.demandItemFacet(u.spItemKeyFacet,n);if(!h)return!1;if(!l.default.isActivated("1739891D-4D4D-458D-8561-2506E1685479","06/22/2020","special logic for teams file app")&&f.isTeamsWebView())return!1;var d=u.spItemKeyFacet.serialize({itemId:p?p.itemId:"",listFullUrl:h.listFullUrl,rootFolder:h.rootFolder,webAbsoluteUrl:h.webAbsoluteUrl}),v=e.demandItemFacet(o.progIdFacet,d)||"";return a.isTeamChannelBannerEnabled()&&a.isProgIdTeamChannelFolder(v)})))});
define("Hqe",["require","exports","r","si","pb","Fqe","WB"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFileCommand={key:new r.Facet("UploadFile").id,name:o.default.UploadFile,action:n.createElement(i.HideWithSelection,null,n.createElement(s.UploadFileAction,null))}});
define("Fqe",["require","exports","lC","li","fx","_s","Oy","Rf","ke","ii","ke","Re","K3","oh"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=new u.PlatformDetection,v=!c.default.isActivated("6D1B4299-EE2A-4540-B291-4DCD668A690B","7/23/2020","Disable upload cross geo");function m(e,t){var n=e.demandItemFacet(f.spPageContextFacet,p.odspNextAppItemKey);if(n&&t.itemKey&&v){var i=h.getSpWebKey(e,{itemKey:t.itemKey}).itemKey;if(i){var s=r.spWebKeyFacet.deserialize(i).webAbsoluteUrl;return new a.ItemUrlHelper({},{pageContext:n}).getUrlParts({webUrl:s}).geoRelation!==l.GeoRelation.sameGeo}}return!1}t.UploadFileAction=s.withOnlyCurrentItem()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["cWe"],t,n)})];case 1:return[2,t.sent().UploadFileAction]}})})},function(e,t){return d.isHtml5FileUploadSupported&&i.getIsUploadItemsActionAvailable(e,t)&&!m(e,t)}));t.UploadFolderAction=s.withOnlyCurrentItem()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["cWe"],t,n)})];case 1:return[2,t.sent().UploadFolderAction]}})})},function(e,t){return d.isFolderUploadSupported&&i.getIsUploadItemsActionAvailable(e,t)&&!m(e,t)}))});
define("K3",["require","exports","li","ii","oh"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSpWebKey=function(e,t){var s=t.itemKey,o=e.demandItemFacet(n.spWebKeyFacet,s)||e.demandItemFacet(n.spLibrariesItemSetKeyFacet,s)||e.demandItemFacet(n.spFolderItemSetKeyFacet,s)||e.demandItemFacet(n.spItemKeyFacet,s);if(!o)return{};var u=e.demandItemFacet(r.spPageContextFacet,i.odspNextAppItemKey);return u&&u.webAbsoluteUrl===o.webAbsoluteUrl?{}:{itemKey:n.spWebKeyFacet.serialize(o)}}});
define("Uqe",["require","exports","r","si","pb","Fqe","WB"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFolderCommand={key:new r.Facet("UploadFolder").id,name:o.default.UploadFolder,action:n.createElement(i.HideWithSelection,null,n.createElement(s.UploadFolderAction,null))}});
define("Pqe",["require","exports","r","si","Tqe","WB"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileRequestCommand={key:new r.Facet("FileRequest").id,name:s.default.CreateFileRequest,action:n.createElement(i.FileRequestAction,null),iconProps:{iconName:"FileRequest"}}});
define("Tqe",["require","exports","lC","Oy","_s","ii","li","Xy","ai","Re","Ro","Rs","QH"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileRequestAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["eWe"],t,n)})];case 1:return[2,t.sent().CreateFileRequestAction]}})})},function(e,t){if(!h.isFeatureEnabled(h.FileRequestUI))return!1;var n=t.itemKey,r=e.demandItemFacet(o.spItemKeyFacet,n);if(!r)return!1;var i=l.getCurrentItemSetKey(e);if(!e.demandItemFacet(o.spFolderItemSetKeyFacet,i)&&!f.default.isActivated("07a8a4f1-bb71-4166-9a57-94afe649189e","02/28/2020","Show Request files action only in Files view"))return!1;if(e.demandItemFacet(s.mountPointFacet,n))return!1;if(!e.demandItemFacet(c.folderFacet,n))return!1;var p=o.spListKeyFacet.serialize(r),d=e.demandItemFacet(s.listFacet,p);if(!d)return!1;if(d.templateType!==a.default.mySiteDocumentLibrary&&!f.default.isActivated("54638CBE-3322-47EB-B3BC-96645317201E","04/13/2020","Folder in ODB shared library could show file request command"))return!1;var v=u.getPageContextFromItemCache(e,n);return!!v&&(!!v.isSiteOwner&&(!v.isEmailAuthenticationGuestUser&&((!v.farmSettings||!v.farmSettings.ExternalService_filerequestenable||"0"!==v.farmSettings.ExternalService_filerequestenable)&&!(!f.default.isActivated("43A2AE6C-6893-4A99-A4BE-2996D6C2FF4C","03/27/2020","Show Request files action only if anonymous sharing is enabled and folder edit sharing is enabled, too.")&&(!v.isShareByLinkEnabled||0!==v.FolderAnonymousLinkPermission&&5!==v.FolderAnonymousLinkPermission)))))})))});
define("kqe",["require","exports","r","si","pb","Mqe","WB"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAccessCommand={key:new r.Facet("ManageAccess").id,name:o.default.ManageAccess,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"},automationId:"manageAccessCommand"}});
define("Mqe",["require","exports","px","RKe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ManageAccessAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPermissionsAction))})});
define("bqe",["require","exports","lC","r","si","X0","ai","Aqe","li","ii","Iqe","dC","W0","Py","jv","vv","vqe","$f","Jr","Zo","Re","oh","gqe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=new i.Facet("addFlow").id,T=new i.Facet("configureFlows").id,N=new i.Facet("existingFlows").id,C=new i.Facet("setUpApprovalFlow").id,k=i.getNextId("createRuleCommand"),L=i.getNextId("manageRulesCommand"),A=i.getNextId("powerAutomateCommand"),O=w.default.isActivated("E91D3604-01E2-4BBF-9444-596B07A532FC","5/27/2020","Show Flow menu only when populated");t.getFlowCommand=function(e,t){var i,l=p.getFlowMetaData(e,t),w=l.canShow,x=l.pageContext,T=l.listKey,N=l.isDocumentLibrary;if(w&&x&&T){var C=e.demandItemFacet(d.flowProcessorControl,d.flowProcessorKey),A=d.flowProcessorControl.evaluate(C)(e,{}),D=A.flowProcessor,P=A.loadAllFlows,H=A.getFlowCommandSubMenuProps,B=!1,j=e.demandItemFacet(a.spItemKeyFacet,t);if(j){var F={webAbsoluteUrl:j.webAbsoluteUrl,listFullUrl:j.listFullUrl},I=a.spListKeyFacet.serialize(F),q=e.demandItemFacet(f.listFacet,I);B=!!q&&!!q.aiBuilderEnabled&&!!(null===(i=q)||void 0===i?void 0:i.isDocumentLibrary)&&q.templateType!==o.default.webPageLibrary}var R=(function(e,t){var i,s=[];if(c.isFeatureEnabled(c.RulesPanel)&&e&&e.listBaseTemplate===o.default.genericList){var a={key:k,automationId:"CreateRuleCommand",name:h.default.CreateRuleCommandLabel,iconProps:{iconName:"Add"},action:r.createElement(u.LaunchManageRulesAction,null),engagement:{name:"Automate.ListRules.Create",isIntentional:!0}},f={key:L,automationId:"ManageRulesCommand",name:h.default.ManageRulesCommandLabel,iconProps:{iconName:"EditNote"},action:r.createElement(u.LaunchManageRulesAction,{openManagementPanel:!0}),engagement:{name:"Automate.ListRules.Manage",isIntentional:!0}};s.push(a);s.push(f)}if(c.isFeatureEnabled(c.AutomateMenuNewLayout)&&c.isFeatureEnabled(c.ChangeFlowToAutomate)){if(!S.shouldDisplayIntegrateCommand(null===(i=e)||void 0===i?void 0:i.listBaseTemplate)){var l=M(e);s.push(l)}t&&s.push(m.aibuilderCommand)}else{var p=_(e);s=n.__spreadArrays(s,p)}return s})(x,B),U=v.flowSetKeyFacet.serialize(T),z=e.demandItemFacet(v.allowLoadAllFlowsFacet,E.odspNextAppItemKey),W=c.isFeatureEnabled(c.ProcessSimple)?z?P?P(e,{key:T,isDocumentLibrary:!!N,pageContext:x,flowProcessor:D,staticFlowCommands:R}):{commands:R,isResolved:!!O}:{commands:R,isResolved:!0}:{commands:[],isResolved:!0},X=W.commands,V=W.isResolved,$=Number(x.webTemplate)===s.default.mySite,J=H&&H(e,{key:T,flowSetKey:U,isODB:$,pageContext:x}),K=e.dispatch,Q=function(){K(g.asBatch(function(){var e;J&&J.onMenuOpened();K(y.resolveItems({items:(e={},e[E.odspNextAppItemKey]=n.__assign({},v.allowLoadAllFlowsFacet.pack(!0)),e)}))}));K(b.forceStoreUpdate())},G=function(){K(g.asBatch(function(){var e;J&&J.onMenuDismissed();K(y.resolveItems({items:(e={},e[E.odspNextAppItemKey]=n.__assign({},v.allowLoadAllFlowsFacet.pack(!1)),e)}))}))};return n.__assign(n.__assign(n.__assign({},p.getFlowCommandTemplate()),{subMenuProps:n.__assign({items:X},O?{onMenuOpened:J&&J.onMenuOpened,onMenuDismissed:J&&J.onMenuDismissed}:{})}),O?{}:{postProcess:function(e){var t=e.subMenuProps;return n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},t||{}),{onMenuOpened:Q,onMenuDismissed:G,items:V&&z&&t&&t.items||[]})})}})}};function M(e){var t=_(e);return{key:A,name:h.default.PowerAutomateCommandLabel,iconProps:{iconName:"Flow"},subMenuProps:{items:t}}}t.getPowerAutomateCommand=M;function _(e){var t=[{key:x,automationId:"AddFlowCommand",name:h.default.AddFlow,action:r.createElement(l.AddFlowAction,null)},{key:N,automationId:"ExistingFlowsCommand",name:h.default.ExistingFlows,action:r.createElement(l.ShowExistingFlowsAction,null)},{key:C,automationId:"SetUpApprovalFlowCommand",name:h.default.setUpApprovalFlow,action:r.createElement(l.SetUpApprovalFlowAction,null)}],n=Number(e.webTemplate)===s.default.mySite;c.isFeatureEnabled(c.RequestSignOffSwitch)&&e&&e.listBaseTemplate!==o.default.webPageLibrary&&!n&&t.push({key:T,automationId:"ConfigureFlowsCommand",name:h.default.ConfigureFlows,action:r.createElement(l.LaunchConfigureFlowsPanelAction,null)});return t}});
define("Aqe",["require","exports","lC","r","ks","Ps","To","tv","C1","_s","Rs","Xy","Ik","ii"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["UUt"],t,n)})];case 1:return[2,t.sent().RulesPanel]}})})});t.LaunchManageRulesAction=f.withCurrentItemSet()(a.createItemCacheComponent(function(e,t){var n=t.itemKey,u=t.openManagementPanel,a=c.getPageContextFromItemCache(e,n),f=h.readItemSetSchemaFromItemCache(e,{mapping:{internalName:p.internalNameFacet,displayName:l.displayNameFacet,columnFieldType:p.mappedColumnFieldTypeFacet},itemSetKey:n||""});if(!a)return null;var v=s.renderComponentOnExecute(function(e){return r.createElement(d,{onDismiss:function(){e.reject(new o.CancelError)},pageContext:a,itemKey:n,columnData:f,openManagementPanel:u||!1})});return r.createElement(i.Action,{onExecute:v,engagement:{name:"LaunchRulesPanel",isIntentional:!0}})}))});
define("Iqe",["require","exports","lC","_s","Oy","Eqe","wqe","Oqe","xqe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddFlowAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["$Ke"],t,n)})];case 1:return[2,t.sent().AddFlowAction]}})})},s.checkBaseAvailability));t.LaunchConfigureFlowsPanelAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["$Ke"],t,n)})];case 1:return[2,t.sent().LaunchConfigureFlowsPanelAction]}})})},s.checkBaseAvailability));t.ShowExistingFlowsAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["$Ke"],t,n)})];case 1:return[2,t.sent().ShowExistingFlowsAction]}})})},s.checkBaseAvailability));t.SetUpApprovalFlowAction=o.SetUpApprovalFlowAction;t.SetUpReminderFlowAction=u.SetUpReminderFlowAction;t.TriggerFlowAction=a.TriggerFlowAction;t.TriggerFlowItemAction=a.TriggerFlowItemAction});
define("Eqe",["require","exports","Xy","dC","Z0"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkBaseAvailability=function(e,t){var s=t.itemKey;if(!s)return!1;var o=n.getPageContextFromItemCache(e,s),u=o&&o.webTemplate,a=Number(u)===i.default.mySite,f=!!a&&!!o&&(!1===o.isSiteOwner||void 0===o.isSiteOwner&&!o.isSiteAdmin);return!!o&&!o.isAnonymousGuestUser&&!o.isEmailAuthenticationGuestUser&&!o.disableFlows&&r.isFeatureEnabled(r.ProcessSimple)&&(!a||r.isFeatureEnabled(r.ODBFlow))&&!f}});
define("wqe",["require","exports","lC","Oy","_s","Eqe","Xy","dC","ai","Re"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetUpApprovalFlowAction=i.withCurrentItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["$Ke"],t,n)})];case 1:return[2,t.sent().SetUpApprovalFlowAction]}})})},function(e,t){var n=t.itemKey,r=o.getPageContextFromItemCache(e,n);return!!r&&!!n&&s.checkBaseAvailability(e,{itemKey:n})&&r.hasManageWebPermissions&&u.isFeatureEnabled(u.WexSitePagesContentApproval)&&r.listBaseTemplate===a.ListTemplateType.webPageLibrary&&!r.disableFlows&&(f.default.isActivated("9905bd80-6e9f-4cd7-ab5d-e4929ce90551","08/07/2020","hide approval button on GCC")||!!r.farmSettings&&"0"!==r.farmSettings.ExternalService_pagecontentapprovalenabled)}))});
define("Oqe",["require","exports","lC","Oy","_s","Eqe","dC"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["$Ke"],t,n)})];case 1:return[2,t.sent().SetUpReminderFlowAction]}})})},function(e,t){var n=t.itemKey;return!!n&&o.isFeatureEnabled(o.DynamicFlowDates)&&s.checkBaseAvailability(e,{itemKey:n})});t.SetUpReminderFlowAction=i.withCurrentItem()(u)});
define("xqe",["require","exports","lC","Oy","_s","Eqe","Xy","dC","li","ii","Rs","cJ","iJ","Cqe","Re"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=d.default.isActivated("ff312379-d00f-4a6b-88e5-bece529c9b72","08/19/2020","Compute isTeamSiteInODB boolean");function m(e,t){var n=t.flow,r=t.itemKey,i=t.defaultToTriggerById;if(!r)return!1;var d=o.getPageContextFromItemCache(e,r),m=e.demandItemFacet(a.spItemKeyFacet,r),g=m&&a.spListKeyFacet.serialize(m),y=e.demandItemFacet(f.listFacet,g),b=!0;if(!i){if(!(b=!!d&&s.checkBaseAvailability(e,{itemKey:r})))return!1;var w=!!y&&!!y.isDocumentLibrary;if(!(b=u.isFeatureEnabled(u.SPOFlowIntegration)||w))return!1}if(n&&n.categoryNames)if(n.categoryNames.indexOf(c.EnvironmentAppropriateRequestSignoffTemplateCategory)>-1){var E=e.demandItemFacet(f.rowDataFacet,r),S=!v&&p.computeIsTeamSiteInODB(e,d);b=!!d&&!!y&&!!E&&!S&&h.isTriggerSignoffFlowActionAvailable(d,y,{properties:{CheckedOutUserId:E.CheckedOutUserId}})}else if(n.categoryNames.indexOf("ODB_CONVERT_TO_PDF")>-1){var x=e.demandItemFacet(l.fileNameFacet,r);b=!!x&&!!x.extension&&h.isTriggerODBConvertToPdfFlowActionAvailable({extension:x.extension})}return b}var g=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["$Ke"],t,n)})];case 1:return[2,t.sent().TriggerFlowAction]}})})},function(e,t){return m(e,t)});t.TriggerFlowAction=i.withSelectedItems()(i.withExactlyOneItem()(g));t.TriggerFlowItemAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["$Ke"],t,n)})];case 1:return[2,t.sent().TriggerFlowItemAction]}})})},function(e,t){return m(e,n.__assign(n.__assign({},t),{defaultToTriggerById:!0}))})});
define("Cqe",["require","exports","oh","ai","ii","Z0"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.computeIsTeamSiteInODB=function(e,t){var o=e.demandItemFacet(i.spPageContextFacet,n.odspNextAppItemKey),u=!!o&&Number(o.webTemplate)===s.default.mySite,a=t&&t.listBaseTemplate===r.default.mySiteDocumentLibrary;return u&&!a}});
define("gqe",["require","exports","ai","dC"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shouldDisplayIntegrateCommand=function(e){return r.isFeatureEnabled(r.IntegrateCommandOnLists)&&r.isFeatureEnabled(r.RulesPanel)&&e===n.ListTemplateType.genericList}});
define("hqe",["require","exports","sf","QH"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.divider=function(e){return{name:"-",key:"breakBefore"+e.toString(),itemType:n.ContextualMenuItemType.Divider,automationId:"divider"}};t.isManageAccessItemsScopeOn=function(){return r.isFeatureEnabled(r.EnableManageAccessItemsScope)}});
define("aYe",["require","exports","Xy","li","ii","jS","T3","ai"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.launchMoveCopyPanelActionControlHandler=function(e,t){for(var n=t.isMove,r=0,i=t.itemKeys;r<i.length;r++){if(!a(e,{itemKey:i[r],isMove:n}))return{isAvailable:!1}}return{isAvailable:!0}};function a(e,t){var a=t.itemKey,f=t.isMove,l=e.demandItem({spItem:r.spItemKeyFacet,mountPoint:i.mountPointFacet,permissions:i.permissionsFacet,itemComplianceStatus:s.itemComplianceStatusFacet},a),c=l.spItem,h=l.mountPoint,p=l.permissions,d=l.itemComplianceStatus,v=n.getPageContextFromItemCache(e,a);if(!v||!c||v.isAnonymousGuestUser)return!1;if(3===d||4===d||h||!o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.openItems))return!1;if(f){var m=r.spListKeyFacet.serialize(c),g=e.demandItemFacet(i.listFacet,m);if(g){if(g.templateType===u.default.webPageLibrary)return!1;if(!g.isDocumentLibrary&&!g.allowCreateFolder)return!1}return o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.editListItems)&&o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.deleteListItems)}return!0}});
define("iYe",["require","exports","ih","X_","sJ","Nte","oYe","rYe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{resources:r.resourceScopeKey,flowProcessorType:i.typeResourceKey,flowWidgetProvider:s.resourceKey},create:function(e){var t=new e.flowProcessorType({resources:e.resources}),r=e.flowWidgetProvider;return{instance:n.createControlHandler()(function(){return function(e){return function(e,n){return{flowProcessor:t,flowWidgetProvider:r,loadAllFlows:o.loadAllFlows,getFlowCommandSubMenuProps:u.getFlowCommandSubMenuProps}}}})}}}})});
define("oYe",["require","exports","lC","r","pb","sf","si","Iqe","Ro","Xo","QH","WB","vv","sYe","Rs","ii","m7","Ih","Z0","Re","Cqe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=new o.Facet("flowInstance").id,S=b.default.isActivated("ff312379-d00f-4a6b-88e5-bece529c9b72","08/19/2020","Compute isTeamSiteInODB boolean"),x={name:"-",key:"divider_1",itemType:s.ContextualMenuItemType.Divider},T={name:"-",key:"divider_2",itemType:s.ContextualMenuItemType.Divider},N=function(e){var t=e.id||e.templateName;return{key:E+"-"+t,automationId:"FlowInstanceCommand",name:e.displayName,action:r.createElement(i.ShowOnlyWithSelection,null,r.createElement(u.TriggerFlowAction,{flow:e}))}};t.loadAllFlows=function(e,t){var i=t.staticFlowCommands,s=t.isDocumentLibrary,o=a.getCurrentItemSetKey(e),b=e.demandItemFacet(f.schemaFacet,o),E=!S&&w.computeIsTeamSiteInODB(e,t.pageContext)?[]:(function(e,t){var n=[];if(l.isFeatureEnabled(l.DynamicFlowDates)&&t){for(var i=[],s=0,o=t.columnKeys;s<o.length;s++){var a=o[s],f=e.demandItemFacet(v.mappedColumnFieldTypeFacet,a),h=e.demandItemFacet(d.displayNameFacet,a)||"",p=e.demandItemFacet(v.isCalculatedFacet,a),y=e.demandItemFacet(v.internalNameFacet,a)||"";f!==m.ColumnFieldType.DateTime||p||"Modified"===y||"Created"===y||i.push({key:L+"_"+y,automationId:"RemindMeColumnCommand_"+y,name:h,action:r.createElement(u.SetUpReminderFlowAction,{columnName:y,columnDisplayName:h})})}if(i.length>0){var b={key:k,automationId:"RemindMeCommand",name:c.default.remindMeCommandName,subMenuProps:{items:i,onMenuOpened:function(){g.Engagement.logData({name:"FlowSetAReminder.Expanded"})}}};n.push(b)}}return n})(e,b),O=!0;if(l.isFeatureEnabled(l.FlowForLibraries)&&s||!s&&l.isFeatureEnabled(l.SPOFlowIntegration)){var M=[],_=(function(e,t){var r=t.key,i=t.flowProcessor,s=h.flowSetKeyFacet.serialize(r),o=A(e,t,p.flowItemFacet,s),u=o.results,a=o.isResolved,f=h.flowTemplateSetKeyFacet.serialize(r),l=A(e,t,p.flowTemplateItemFacet,f),c=l.results,d=l.isResolved,v=a&&d,m=Number(t.pageContext.webTemplate)===y.default.mySite;return{flowInstances:i.buildDisplayedFlowsInstances(u.map(function(e){return n.__assign({},e)}),c,m),isResolved:v}})(e,t),D=_.flowInstances;_.isResolved||(O=!1);if(l.isFeatureEnabled(l.AutomateMenuCreateSubsections)){var P=n.__spreadArrays(E),H=[];D.forEach(function(e){!(function(e){var t,n=null===(t=e.categoryNames)||void 0===t?void 0:t.indexOf("OOB_CURRENT");n=n||-1;return"FromTemplate"===e.provisioningMethod||n>=0})(e)?H.push(N(e)):P.push(N(e))});C(P);C(H);M=P.concat(x,H,T,i)}else{for(var B=0,j=n.__spreadArrays(E);B<D.length;B++)j.push(N(D[B]));C(j);j.push(x);M=j.concat(i)}return{commands:M,isResolved:O}}return{commands:i,isResolved:O}};function C(e){e.sort(function(e,t){var n=e.name?e.name.toLowerCase():"",r=t.name?t.name.toLowerCase():"";return n===r?0:n>r?1:-1})}var k=new o.Facet("remindMe").id,L=new o.Facet("remindMeColumn").id;function A(e,t,n,r){var i=[],s=e.demandItemFacet(f.childItemsFacet,r),o=e.isItemFacetResolved(f.childItemsFacet,r);s&&s.itemKeys&&s.itemKeys.forEach(function(t){var r=e.demandItemFacet(n,t);r&&i.push(r)});return{results:i,isResolved:o}}});
define("sYe",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.flowItemFacet=new n.Facet("flow");t.flowTemplateItemFacet=new n.Facet("flowTemplate")});
define("rYe",["require","exports","lC","Xo","Jr","Xte","Vm","vv","Re","Nte","oh"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=a.default.isActivated("E91D3604-01E2-4BBF-9444-596B07A532FC","5/27/2020","Show Flow menu only when populated");t.getFlowCommandSubMenuProps=function(e,t){var a=e.dispatch,h=t.key,p=t.flowSetKey,d=t.isODB,v=t.pageContext;return{onMenuOpened:function(){var e,t;s.FlowWidgetProvider2.preloadSdk(d?f.HostId.ODB:f.HostId.SPO,v);var i=new o.ItemResolver;c&&i.resolveItems({items:(e={},e[l.odspNextAppItemKey]=n.__assign({},u.allowLoadAllFlowsFacet.pack(!0)),e)});var m=u.flowTemplateSetKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl});i.invalidateItems({items:(t={},t[p]=[r.childItemsFacet],t[m]=[r.childItemsFacet],t)});a(i.execute())},onMenuDismissed:function(){var e;c&&a(i.resolveItems({items:(e={},e[l.odspNextAppItemKey]=n.__assign({},u.allowLoadAllFlowsFacet.pack(!1)),e)}))}}}});
define("cYe",["require","exports","lC","r","px","_s","Tz","C1","ii","Vae","c0"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.progId,n=e.resources,s=n.consume(i.actionMap);return o.isProgIdTeamChannelFolder(t)?r.createElement(f.default,{actionMap:s,resources:n}):null};return t})(r.PureComponent);t.TeamChannelHeaderBase=c;t.TeamChannelHeader=s.withCurrentItem()(u.connectToItemCache(function(e,t){return{progId:e.demandItemFacet(a.progIdFacet,t.itemKey)}})(l.withResources()(c)))});
define("vz",["require","exports","lC","r","Yo","tv","F1","_s","li","yz","C1"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["Dz"],t,n)})];case 1:return[2,t.sent().SetPreferredKeyFacetForGraphItem]}})})});t.GraphItemUpdater=l.createItemCacheComponent(function(e,t){var n=o.getItemsScope(e).itemsScopeItemKey,s=u.getCurrentItemSetKey(e,n);if(s){if(!e.demandItemFacet(a.spItemKeyFacet,s)){var l=i.getSelectedItemKeys(e);if(1===l.length){var h=l[0];if(f.isGraphItemWithoutPreferredKey(e,h))return r.createElement(c,{itemKey:l[0]})}}}return null})});
define("Dz",["require","exports","lC","r","ks","Ps","Iz","C_","Kf","$1","li","Co","k1","C1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=p.createItemCacheComponent(function(e,t){var i=t.itemKey,o=n.__rest(t,["itemKey"]),f=e.demandItemFacet(c.preferredKeyFacetFacet,i),h=f&&e.demandItemFacet(f,i);if(h&&h.webAbsoluteUrl&&h){return l.spItemKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,itemId:h.itemId,rootFolder:h.rootFolder})&&r.createElement(s.WithAction,{action:r.createElement(a.ItemDefaultClickAction,{itemKey:i})},function(e){return r.createElement(u.AutoActionExecutor,n.__assign({},e,{onComplete:o.resolve,onError:o.reject}))})}return null});t.bindPreferredKeyClickAction=function(e){var t=this,a=e.itemKey,f=s.renderComponentOnExecute(function(e){return r.createElement(s.WithAction,{action:r.createElement(o.SetPreferredKeyAction,{itemKey:a})},function(t){return r.createElement(u.AutoActionExecutor,n.__assign({},t,{onComplete:e.resolve,onError:e.reject}))})}),l=s.renderComponentOnExecute(function(e){return r.createElement(s.WithAction,{action:r.createElement(o.SelectItemAction,{itemKey:a})},function(t){return r.createElement(u.AutoActionExecutor,n.__assign({},t,{onComplete:e.resolve,onError:e.reject}))})}),c=s.renderComponentOnExecute(function(e){return r.createElement(d,n.__assign({},e,{itemKey:a}))});return r.createElement(i.Action,{onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,f(e)];case 1:t.sent();return[4,l(e)];case 2:t.sent();return[4,c(e)];case 3:t.sent();return[2]}})})}})};t.SetPreferredKeyFacetForGraphItem=function(e){var t=e.itemKey,n=h.useItemCacheDispatch();r.useEffect(function(){n(v({itemKey:t}))},[t]);return null};function v(e){return function(t){var r,i=e.itemKey;t(f.resolveItems({items:(r={},r[i]=n.__assign({},o.getPreferredKeyFacet(i)),r)}))}}t.setPreferredKeyFacet=v});
define("Iz",["require","exports","lC","C1","ks","Es","$1","li","Co","qr","si","zm","ph","ss","bs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPreferredKeyFacet=function(e){return n.__assign(n.__assign({},l.pack({preferredKeyFacet:a.preferredKeyFacetFacet},{preferredKeyFacet:new f.IfNotMatchPatch(u.spItemFullUrlKeyFacet,function(e){return e===u.spItemKeyFacet})})),c.getInvalidationFacet().forFacet(a.preferredKeyFacetFacet).thenInvalidate(e,a.preferredKeyFacetFacet).pack())};t.getGraphItemPreferredFacet=function(e,t){var n=e.demandItemFacet(u.spItemFullUrlKeyFacet,t),r=e.demandItemFacet(a.preferredKeyFacetFacet,t),i=r&&e.demandItemFacet(r,t),s=i&&i.webAbsoluteUrl,o=e.demandItemFacet(h.driveItemKeyFacet,t);return{preferredValue:i,graphItemHasPreferredKey:!!n&&s&&!!o}};t.SetPreferredKeyAction=r.connectToItemCache(function(e,r){var i=r.itemKey,u=e.dispatch,a=t.getGraphItemPreferredFacet(e,i).graphItemHasPreferredKey;return n.__assign({isAvailable:!a,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(r){u(o.resolveItems({items:(e={},e[i]=n.__assign({},t.getPreferredKeyFacet(i)),e)}));return[2]})})}},s.getItemActionEngagement(e,{itemKey:i,engagement:{name:"SetPreferredGraphItemKey",isIntentional:!1}}))})(i.Action);t.SelectItemAction=r.connectToItemCache(function(e,t){var r=t.itemKey,i=d.getItemsScope(e).itemsScopeItemKey,o=e.dispatch;return n.__assign({isAvailable:!0,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){i&&o(p.selectItems({currentSelectionKey:void 0,itemsScopeItemKey:i,selectedItemKeys:[r]}));return[2]})})}},s.getItemActionEngagement(e,{itemKey:r,engagement:{name:"SelectItem",isIntentional:!1}}))})(i.Action)});
define("dYe",["require","exports","lC","Jy","li","S3","X_","eC","Xo","zm","mK","rs","li","ii","Xo","jL","Jf","xo","$1","b7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(){function e(e,t){void 0===e&&(e={});var n=t.itemUrlHelper,r=t.pageContext,i=t.itemCacheStore;this._itemCacheStore=i;this._pageContext=r;this._itemUrlHelper=n;this._itemsScopeCurrentItemKey=t.itemsScopeCurrentItemKey}e.prototype.invalidateItemSet=function(e){var t;this._itemCacheStore.dispatch(f.invalidateItems({items:(t={},t[e]=[d.childItemsFacet],t)}))};e.prototype.invalidateCurrentItemSet=function(){var e=this._itemsScopeCurrentItemKey.peek();if(e){var t=this._itemCacheStore.dispatch(c.readItems(function(t){return t.demandItemFacet(h.remoteItemKeyFacet,e)}));t?this.invalidateItemSet(t.remoteItemKey):this.invalidateItemSet(e)}};e.prototype.invalidateItems=function(e){var t=this._getItemKeyFromKOKey(e);this._invalidateFolderItems(t)};e.prototype.invalidateCurrentView=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&n.viewKey&&h.spViewKeyFacet.serialize(n.viewKey);r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[p.serverViewFacet,p.currentDerivedViewFacet],e)}))};e.prototype.invalidateAvailableViews=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&i.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl});r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[d.childItemsFacet],e)}))};e.prototype.notifySpfxLoaded=function(e){var t,r=this._itemsScopeCurrentItemKey.peek(),i=r&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,r)})),s=i&&h.spListKeyFacet.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl});if(s){var o=void 0;try{if(e&&e.context&&e.context.preloadedData){var u=e,a=u.context.preloadedData;!a.spPageContextInfo&&u.context.pageContext&&u.context.pageContext.legacyPageContext&&(a.spPageContextInfo=u.context.pageContext.legacyPageContext);o=JSON.stringify(a)}}catch(e){console.log("Failed to get spfx application preloaded data to cache: "+e)}this._itemCacheStore.dispatch(y.resolveItems({items:(t={},t[s]=n.__assign(n.__assign({},b.isSpfxLoadedFacet.pack(!0)),o?b.spClientSideFrameworkContextFacet.pack(o):{}),t)}))}};e.prototype.invalidateListContentTypes=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&h.spListKeyFacet.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl});r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[p.contentTypeKeysFacet],e)}))};e.prototype.refreshItemsInCurrentItemSet=function(e){var t,n=this._itemsScopeCurrentItemKey.peek(),r=this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,n)}));if(n&&r){for(var s=r.webAbsoluteUrl,o=r.listFullUrl,u={},a=0,f=e;a<f.length;a++){var l=f[a];u[i.spItemKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:o,itemId:l})]={}}this._itemCacheStore.dispatch(v.refreshItemsInSet({items:(t={},t[n]=u,t)}))}};e.prototype.invalidateGroups=function(e){var t=e||[],n=this._itemsScopeCurrentItemKey.peek();if(n&&h.spFolderItemSetKeyFacet.matches(n)){if(0===t.length){var r=n&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(d.childItemsFacet,n)}));t=(r&&r.itemKeys||[]).filter(function(e){return i.spItemGroupKeyFacet.matches(e)})}if(t.length>0){this.invalidateItemSet(n);if(this._itemCacheStore.dispatch(g.readItem({defaultCollapsed:m.defaultCollapsedFacet},t[0])).defaultCollapsed){var s={};t.forEach(function(e){s[e]=[d.childItemsFacet]});this._itemCacheStore.dispatch(f.invalidateItems({items:s}))}}}};e.prototype.invalidateCurrentFolderItems=function(){var e=this._itemsScopeCurrentItemKey.peek(),t=this._itemCacheStore.dispatch(c.readItems(function(t){return t.demandItemFacet(a.parentItemFacet,e)}));t&&t.itemKey&&this._invalidateFolderItems(t.itemKey)};e.prototype._invalidateFolderItems=function(e){var t;this._itemCacheStore.dispatch(f.invalidateItems({items:(t={},t[e]=[a.defaultChildItemSetFacet],t)}))};e.prototype._getItemKeyFromKOKey=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return i.spItemKeyFacet.serialize({webAbsoluteUrl:t.isCrossList?"":this._pageContext.webAbsoluteUrl,listFullUrl:t.fullListUrl,rootFolder:t.serverRelativeItemUrl!==t.serverRelativeListUrl?t.serverRelativeItemUrl:""})};e.dependencies={itemUrlHelper:r.resourceKey,pageContext:s.pageContext,itemCacheStore:u.resourceKey,itemsScopeCurrentItemKey:l.resourceKey};return e})();t.ItemInvalidator=w;t.resourceKey=o.createResolvedResourceKey(e("module").id,w)});
define("lYe",["require","exports","lC","Jy","li","S3","X_","eC","rs","ii","Vm","ss","NB","mK","YD","Xo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(){function e(e,t){void 0===e&&(e={});var n=t.itemUrlHelper,r=t.pageContext,i=t.itemCacheStore,s=t.itemsScopeCurrentItemKey,o=t.itemsScopeItemKey;this._itemCacheStore=i;this._pageContext=r;this._itemUrlHelper=n;this._itemsScopeCurrentItemKey=s;this._itemsScopeItemKey=o}e.prototype.updateItemShortcutValues=function(e,t,r){var s,o=this._getItemKeyFromKOKey(e,t),u=this._itemCacheStore.dispatch(a.readItems(function(e){return e.demandItem({key:i.spItemKeyFacet,rowData:f.rowDataFacet},o)})),c=u.key,h=u.rowData;if(c&&h){var p=n.__assign({},h);p._ShortcutUrl=r.url;p._ShortcutSiteId=r.siteId;p._ShortcutWebId=r.webId;p._ShortcutUniqueId=r.uniqueId;var d=new l.ItemResolver;d.resolveItems({items:(s={},s[o]=n.__assign({},f.rowDataFacet.pack(p)),s)});this._itemCacheStore.dispatch(d.execute())}};e.prototype.selectItems=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,s,o,u,f,l,h;return n.__generator(this,function(n){switch(n.label){case 0:t=[];r=this._itemsScopeCurrentItemKey.peek();if(!(s=r&&this._itemCacheStore.dispatch(a.readItems(function(e){return e.demandItemFacet(i.spFolderItemSetKeyFacet,r)})))||!r)return[2];for(o=0,u=e;o<u.length;o++){f=u[o];l={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,itemId:f};h=i.spItemKeyFacet.serialize(l);t.push(h)}return[4,this._itemCacheStore.dispatch(d.demandItems(function(e){e.demandItemFacet(v.childItemsFacet,r)}))];case 1:n.sent();this._itemCacheStore.dispatch(c.selectItems({itemsScopeItemKey:this._itemsScopeItemKey,selectedItemKeys:t,currentSelectionKey:void 0}));return[2]}})})};e.prototype._getItemKeyFromKOKey=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e);return i.spItemKeyFacet.serialize({webAbsoluteUrl:n.isCrossList?"":this._pageContext.webAbsoluteUrl,listFullUrl:n.fullListUrl,itemId:t||"",rootFolder:t||n.serverRelativeItemUrl===n.serverRelativeListUrl?"":n.serverRelativeItemUrl})};e.dependencies={itemUrlHelper:r.resourceKey,pageContext:s.pageContext,itemCacheStore:u.resourceKey,itemsScopeCurrentItemKey:p.resourceKey,itemsScopeItemKey:h.resourceKey};return e})();t.ItemUpdator=m;t.resourceKey=o.createResolvedResourceKey(e("module").id,m)});
define("uYe",["require","exports","lC","Hm","$1","vv","Xo","$f"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.flowAddon=r.createAddon(function(){return function(t){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(a){t(u.asBatch(function(){t(i.supportFacets({keyFacet:s.flowSetKeyFacet,facets:[o.childItemsFacet]}));t(i.supportFacets({keyFacet:s.flowTemplateSetKeyFacet,facets:[o.childItemsFacet]}));t(r.registerOperationHandler(s.flowSetKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["pYe"],t,n)})];case 1:return[2,t.sent().getFlowSetOperationHandler]}})})})));t(r.registerOperationHandler(s.flowTemplateSetKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["pYe"],t,n)})];case 1:return[2,t.sent().getFlowTemplateSetOperationHandler]}})})})))}));return[2]})})}})});
define("fYe",["require","exports","xv","A8","sJ"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFlowInstancesData=function(e,t){var o=r.getListApiUrl({webAbsoluteUrl:e,listFullUrl:t}).segment("SyncFlowInstances").toString();return function(r){return r(n.getData({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:o,qosName:"SyncFlowInstances",noRedirect:!0})).then(function(e){var t=s(e);return i.default.processFlowInstances(t,"Request")})}};t.getFlowTemplatesData=function(e,t,o){var u=r.getListApiUrl({webAbsoluteUrl:e,listFullUrl:t}).segment("SyncFlowTemplates").toString(),a=o?JSON.stringify({category:o}):"";return function(t){return t(n.getData({webAbsoluteUrl:e,listFullUrl:"",method:"POST",url:u,body:a,qosName:"SyncFlowTemplates",noRedirect:!0})).then(function(e){var t=s(e);return i.default.processTrustedTemplates(t,"OOB_CURRENT")})}};function s(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=JSON.stringify(e);var n=e;t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t}});
define("pYe",["require","exports","lC","Xo","vv","li","ii","Hm","$1","xo","ai","fYe","cJ","sYe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFlowSetOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,s=e.itemKey,o=i.flowSetKeyFacet.deserialize(s),u=o.webAbsoluteUrl,f=o.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,l;return n.__generator(this,function(h){switch(h.label){case 0:t={};return[4,e(c.getFlowInstancesData(u,f))];case 1:l=h.sent();(function(e,t,s,o){var u=[];o.forEach(function(t){var r=i.flowItemKeyFacet.serialize(n.__assign(n.__assign({},s),{id:t.id}));e[r]=n.__assign({},p.flowItemFacet.pack(t));u.push(r)});e[t]=n.__assign({},r.childItemsFacet.pack({itemKeys:u}))})(t,s,o,l);e(a.resolveItems({items:t}));return[2]}})})}});t.getFlowTemplateSetOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,u=e.itemKey,d=i.flowTemplateSetKeyFacet.deserialize(u),v=d.webAbsoluteUrl,m=d.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:t={};g=e(f.readItem({list:o.listFacet},s.spListKeyFacet.serialize({webAbsoluteUrl:v,listFullUrl:m})));(y=g.list&&g.list.templateType)===l.default.mySiteDocumentLibrary?b=h.EnvironmentAppropriateODBTemplateCategory:l.isDocumentLibrary(y)?b="OOB_SHAREPOINT_LIBRARY":l.isGenericList(y)&&(b="OOB_SHAREPOINT_LIST");return[4,e(c.getFlowTemplatesData(v,m,b))];case 1:w=E.sent();(function(e,t,s,o){var u=[];o.forEach(function(t){var r=i.flowTemplateItemKeyFacet.serialize(n.__assign(n.__assign({},s),{id:t.templateId}));e[r]=n.__assign({},p.flowTemplateItemFacet.pack(t));u.push(r)});e[t]=n.__assign({},r.childItemsFacet.pack({itemKeys:u}))})(t,u,d,w);e(a.resolveItems({items:t}));return[2]}})})}})});
define("mYe",["require","exports","lC","Xx","X_","Hm","ko","gK","yh","Vm","YD","rs","mh","TB","zm","Rs","S0","v"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{urlDataSource:a.url,itemTaskObserverType:u.resourceKey},create:function(e){var t=e.urlDataSource,i=e.itemTaskObserverType;return{instance:s.createSingleItemOperationHandler({maxParallelOperationCount:30,mergeForSameItemKey:!0})(function(e){var s=this,a=r.odspNextStoreKeyFacet.deserialize(e.itemKey).itemKey;return function(y){return n.__awaiter(s,void 0,void 0,function(){var s,b,w,E,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:if(!(s=y(c.readItems(function(e){return e.demandItemFacet(h.knockoutStoreIdentityFacet,a)}))))return[3,5];b=s.key;w=t.getKeyParams(b);E=t.getQueryType(w);(S=new i).update([new u.Task(b).succeed({item:{key:b,queryType:E}})]);M.label=1;case 1:M.trys.push([1,3,,4]);return[4,y(l.demandItems(function(e){return e.demandItemFacet(p.oneDriveItemFacet,a)}))];case 2:x=M.sent();S.update([new u.Task(b).succeed({item:x})]);return[3,4];case 3:T=M.sent();N=0;C="";k="";T instanceof Error&&(k=T.message);T instanceof g.ApiError&&(C=T.code);T instanceof o.ItemOperationError&&(m.itemNotFoundErrorFacet.unpack(T.facets)||m.accessDeniedErrorFacet.unpack(T.facets)?N=2:m.authFailureErrorFacet.unpack(T.facets)&&(N=1));S.update([new u.Task(b).succeed({item:{error:{type:N,data:{errorCode:C,errorTitle:k}}}})]);return[3,4];case 4:S.flush();M.label=5;case 5:(L=new f.ItemResolver).resolveItems({items:n.__assign(n.__assign({},a?(A={},A[a]=n.__assign({},d.getInvalidationFacet().forFacet(v.displayNameFacet).thenInvalidate(e.itemKey,r.createdStoreItemFacet).pack()),A):{}),(O={},O[e.itemKey]=n.__assign({},r.createdStoreItemFacet.pack(void 0)),O))});y(L.execute());return[2]}})})}})}}}})});
define("_Ye",["require","exports","lC","X_","BH","px","yh","jG","bYe","yK","gK","d1","zX","S3","QSe","ai","vK","YSe","Re","rK","OK","hYe","Ee","Dj","QH","eC","rs","_h","oh","ch","ii","li","S$","jo","os","Xo","Jf","u3","Qx","sne","gD","oje","de","b7","IZ","mS","_S","Se"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var J=y.default.isActivated("D349E556-140B-4BFA-8B14-5DD337AAFB41","7/2/2020","Use per-list store for MicroServiceDataSource"),K=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._listItemBuilder=n.listItemBuilder;r._listItemResultProcessor=n.listItemResultProcessor;r._store=n.itemsStore;r._itemTaskObserverType=n.itemTaskObserverType;r._itemsScopeItemKeyToKOItemKeyMap={};r._itemProvider=n.itemProvider;r._fileHandlerCacheDataSource=n.fileHandlerCacheDataSource;r._resources=n.resources;r._listContext=n.listContext;r._pageContext=n.pageContext;r._microServiceDataSource=n.microServiceDataSource;r._microServiceDataSourceStore=n.microServiceDataSourceStore;r._onePageContext=n.onePageContext;r._itemCacheStore=n.itemCacheStore;r._getItemsScopeCurrentViewKey=n.getItemsScopeCurrentViewKey;r._getItemsScopeCurrentDerivedView=n.getItemsScopeCurrentServerView;r._bundleLoaderProvider=n.bundleLoaderProvider;r._itemsScopeManager=n.itemsScopeManager;r._useItemsScope=n.useItemsScope;r._clientSideExtensionHelper=n.clientSideExtensionHelper;r.koItem=r._currentKOItem=n.currentKOItem;r.koItemSet=r._currentKOItemSet=n.currentKOItemSet;r.selectedKOItemKeys=r._selectedKOItemKeys=r.observables.create([]);r._initializeStateSubscription();return r}t.prototype._initializeStateSubscription=function(){var e=this,t=this._itemCacheStore,n={},r={currentItemKey:void 0,currentItemSetKey:void 0,selectedItemKeys:[],parentItemKey:void 0,childItems:void 0,getItemResponse:void 0,spFolderItemSet:void 0,fileHandlerRawData:void 0},i={},s=function(){var t;t=e._onStoreUpdate(r,n,i),r=t.itemsScopeInfo,n=t.keyMap};s();t.subscribe(s);this.observables.backgroundCompute(function(){e._bundleLoaderProvider.isPageLoaded.peek()?s():e._bundleLoaderProvider.isPageLoaded()})};t.prototype._onStoreUpdate=function(e,t,n){if(!this._bundleLoaderProvider.isPageLoaded.peek())return{itemsScopeInfo:e,keyMap:t};var r=this._itemCacheStore,i=this._itemsScopeManager.itemsScopeItemKey,s=r.dispatch(Q({itemsScopeItemKey:i,pageContext:this._pageContext}));if(!this._useItemsScope.peek())return{itemsScopeInfo:s,keyMap:t};if(s.currentItemKey){var o=s.childItems,u=o&&o.itemKeys&&o.itemKeys.length>0&&G(r,o.itemKeys[0]);if(u||e.childItems!==s.childItems||e.parentItemKey!==s.parentItemKey||e.getItemResponse!==s.getItemResponse){var a=s.parentItemKey,f=s.getItemResponse;if(o&&a){var l={},c=!1,h=!1,p=o.itemKeys;if(!n[a]||n[a].getItemResponse!==f){n[a]={getItemResponse:f};c=!0}u&&(p=(function(e,t){for(var n=!1,r=!1,i=[],s=0;s<t.itemKeys.length;s++){var o=Y(e,t.itemKeys[s]),u=o&&o.itemKeys;if(u){if(!n){r=u.length>0&&G(e,u[0]);n=!0}if(r)for(var a=0;a<u.length;a++){var f=Y(e,u[a]),l=f&&f.itemKeys;l&&(i=i.concat(l))}else i=i.concat(u)}}return i})(r,o));for(var d=function(e){var i=r.dispatch(C.readItems(function(t){return{rowData:t.demandItemFacet(O.rowDataFacet,e)}})).rowData;if(n[e]&&n[e].rowData===i)l[e]={item:{rowData:i},mappedKOItemKey:t[e]};else{h=!0;n[e]={rowData:i};l[e]={item:{rowData:i}}}},v=0,m=p;v<m.length;v++){d(m[v])}(h||c||e.currentItemKey!==s.currentItemKey)&&(t=this._updateKOCurrentItemSet({itemsScopeItemKey:i,allChildItems:l,childItemsChanged:h,shouldSkipProcessParentItem:!c}).itemsScopeItemKeyToKOItemKeyMap)}}}s.fileHandlerRawData&&this._fileHandlerCacheDataSource&&this._fileHandlerCacheDataSource.setFileHandlerData(s.fileHandlerRawData);if((function(e,t){if(e.length!==t.length)return!0;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(e.indexOf(i)<0)return!0}return!1})(e.selectedItemKeys,s.selectedItemKeys)){var g=s.selectedItemKeys.map(function(e){return t[e]});this._selectedKOItemKeys(g)}return{itemsScopeInfo:s,keyMap:t}};t.prototype._updateKOCurrentItemSet=function(e){var t=this,r=e.itemsScopeItemKey,i=e.allChildItems,o=e.shouldSkipProcessParentItem,u=this._itemCacheStore,a=u.dispatch(Q({itemsScopeItemKey:r,pageContext:this._pageContext})),f=a.parentItemKey,l=a.getItemResponse,h=a.spFolderItemSet,b={itemKey:f},w=h||{},N=w.webAbsoluteUrl,_=void 0===N?void 0:N,D=w.listFullUrl,P=void 0===D?void 0:D,H=u.dispatch(C.readItems(function(e){return{folderPath:e.demandItemFacet(O.folderPathFacet,f),permissions:e.demandItemFacet(O.permissionsFacet,f)}})),B={id:H.folderPath,permissions:H.permissions},j=this._getItemsScopeCurrentViewKey(),F=this._getItemsScopeCurrentDerivedView(j),I=M.spListKeyFacet.serialize({webAbsoluteUrl:_,listFullUrl:P}),z=u.dispatch(C.readItems(function(e){var t=e.demandItemFacet(O.contentTypeKeysFacet,I)||[],n=e.demandItemFacet(O.contentTypeKeysFacet,f)||[];return{contentTypes:t.map(function(t){return e.demandItemFacet(O.spListContentTypeFacet,t)}),folderContentTypeOrder:n.map(function(t){return e.demandItemFacet(O.spFolderContentTypeFacet,t)})}})),W=z.contentTypes,X=z.folderContentTypeOrder,V=this._itemCacheStore.dispatch(C.readItems(function(e){return e.demandItemFacet(O.spPageContextFacet,M.spPageContextKeyFacet.serialize({webAbsoluteUrl:_,listFullUrl:P}))}));l&&g.ListItemBuilderHelpers.updateListContext(l,this._listContext);var $=this.resources.consume(R.resourceKey);$&&!y.default.isActivated("975DFDE1-C9F7-44A9-A628-D9DD6F9BB63D","09/05/2019","Make power app pre-loading more robust")&&$.ensureListContextUpdateSignal().complete();if(V&&(V.listId!==this._pageContext.listId||!this._pageContext.listUrl||(y.default.isActivated("0DF86B3C-ACA4-472B-85E0-639FD555D129","10/03/2019","Compare listId without guid casing")?this._listContext.listId!==this._pageContext.listId:U.default.normalizeLower(this._listContext.listId)!==U.default.normalizeLower(this._pageContext.listId)))){var K=this._onePageContext;if(K){this._listContext.refreshClientForm=!0;if(V.listUrl&&this._listContext.listId.toUpperCase()===V.listId.toUpperCase())S.extend(this._pageContext,V);else{this._pageContext.listUrl=this._listContext.listUrl;this._pageContext.listId=this._listContext.listId;this._pageContext.listTitle=this._listContext.listTitle;this._pageContext.listBaseTemplate=this._listContext.listTemplateType}this._pageContext.serverRequestPath=void 0;var G=this.resources.consume(x.resourceKey.optional);if(G){G.clearCachedPromise();G.updateWorkloadSettingsLinks()}this._useItemsScope.peek()&&this._updateSpfxContext(I);K.onePageNavigationDataFetch(!0);K.onePageNavigationDataFetch(!1)}}var Y=(0,this._itemCacheStore.dispatch)(C.readItems(function(e){var t=e.demandItemFacet(k.itemKeyToStoreKeyControl,L.odspNextAppItemKey),n=e.demandItemFacet(A.currentViewParamsFacet,r),i=k.itemKeyToStoreKeyControl.evaluate(t)(e,{itemKey:b.itemKey,viewParams:n||{}}).storeKey;return i&&i.key})),Z=new this._itemTaskObserverType,ee=[];if(l&&b&&!o){var te=l.ListSchema,ne=this._listItemResultProcessor.processResponse({response:l,requestKey:Y,observer:Z}).listRootItemKey;if(te&&!T.isFeatureEnabled(T.SkipSettingMicroserviceBaseInfo)){var re={data:te,allowCookies:!1};if(!J){this._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(ne).setBaseInfo(re)}this._microServiceDataSource.setBaseInfo(re)}y.default.isActivated("AA918EC4-B203-49D2-9EF6-0DB64E830D56","1/09/2018","Disable list token update automatically")||this.resources.consumeAsync(E.resourceKey).then(function(e){e.trackListToken(Y)});this._itemsScopeItemKeyToKOItemKeyMap[b.itemKey]=Y}B&&Z.update([new m.default(Y).succeed({item:n.__assign(n.__assign({},B),{folder:{},type:q.default.Folder,isDropEnabled:!0,isPlaceholder:!1})})]);var ie=this.resources.consume(s.currentView);F&&ie&&ie(F.clone());var se=this.resources.consume(p.contentTypes.optional);se&&se(W);for(var oe in i){var ue=i[oe],ae=ue.item,fe=ue.mappedKOItemKey;if(fe){this._itemsScopeItemKeyToKOItemKeyMap[oe]=fe;ee.push(fe)}else{var le=ae.rowData;if(le){var ce=this._listItemBuilder.getItemResult({itemFromServer:n.__assign({},le),parentItemKey:Y,requestKey:Y,queryType:c.default.Files,supportsNestedGroups:!1,isItemDataOnly:!0,observer:Z});this._itemsScopeItemKeyToKOItemKeyMap[oe]=ce.item.key;ee.push(ce.item.key)}}}var he=void 0;l&&l.ListSchema&&(he=d.getListSchema({listSchema:l.ListSchema,resources:this._resources,groupSchema:{},hasFixedSchema:this._listContext.listTemplateType===v.ListTemplateType.mySiteDocumentLibrary,listContext:this._listContext,getItemContext:void 0,sortFallback:{sortField:l.ListData.SortField,sortDirection:l.ListData.SortDir}}));if(Y||ee.length){Z.flush();var pe=this._store.getItem(Y),de=ee.map(function(e){return t._store.getItem(e)}),ve=this._itemProvider.getItemSync({parentKey:Y});ve.isPlaceholder=!1;ve.content({items:de,groupings:[]});he&&ve.schema(he);pe&&this._currentKOItem(pe.peek());X&&ve.contentTypes(X);this._currentKOItemSet(ve)}return{itemsScopeItemKeyToKOItemKeyMap:this._itemsScopeItemKeyToKOItemKeyMap}};t.prototype._updateSpfxContext=function(e){if(this._itemCacheStore&&this._listContext&&e&&this._clientSideExtensionHelper)try{var t=(0,this._itemCacheStore.dispatch)(C.readItems(function(t){return{cachedSpfxPageContext:t.demandItemFacet(z.spClientSideFrameworkContextFacet,e)}})).cachedSpfxPageContext,n=this._clientSideExtensionHelper.getApplication();if(n&&"function"==typeof n.navigateToPreloadedData&&t){var r=n&&n.context&&n.context.pageContext&&n.context.pageContext.list&&n.context.pageContext.list.id&&n.context.pageContext.list.id.toString();U.default.normalizeLower(r)!==U.default.normalizeLower(this._listContext.listId)&&n.navigateToPreloadedData(JSON.parse(t))}}catch(e){console.log("Error updating SpfxContext, error "+e)}};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{itemsStore:u.resourceKey,listItemBuilder:a.resourceKey,listItemResultProcessor:f.resourceKey,currentKOItem:s.currentItem,currentKOItemSet:s.currentItemSet,itemTaskObserverType:l.resourceKey,itemProvider:h.resourceKey,listContext:p.listContext,microServiceDataSource:b.resourceKey,microServiceDataSourceStore:w.resourceKey,pageContext:p.pageContext,onePageContext:p.onePageContext.optional,itemCacheStore:N.resourceKey,getItemsScopeCurrentViewKey:_.getItemsScopeCurrentViewKeyResourceKey,getItemsScopeCurrentServerView:_.getItemsScopeCurrentDerivedViewResourceKey,bundleLoaderProvider:j.bundleLoader,itemsScopeManager:F.resourceKey,useItemsScope:I.resourceKey,clientSideExtensionHelper:W.clientSideExtensionHelper.optional,fileHandlerCacheDataSource:o.fileHandlerFromCache.optional});return t})(i.default);t.default=K;function Q(e){var t=e.itemsScopeItemKey,n=e.pageContext;return function(e){return e(C.readItems(function(e){var r=e.demandItemFacet(P.currentItemFacet,t),i=r&&r.itemKey,s=e.demandItemFacet(P.selectedItemsFacet,t),o=s&&s.itemKeys||[],u=D.getItemSetKey(e,{itemKey:i}),a=e.demandItemFacet(M.spFolderItemSetKeyFacet,u),f=e.demandItemFacet(H.childItemsFacet,u),l=e.demandItemFacet(H.parentItemFacet,u),c=l&&l.itemKey,h=e.demandItemFacet(O.getItemResponseFacet,u),p=n.webAbsoluteUrl,d=new $.default(p).authority+"/_api/v2.0",v=V.driveAppsKeyFacet.serialize({endpoint:d});return{currentItemKey:i,selectedItemKeys:o,spFolderItemSet:a,childItems:f,parentItemKey:c,getItemResponse:h,currentItemSetKey:u,fileHandlerRawData:e.demandItemFacet(X.fileHandlerRawDataFacet,v)}}))}}function G(e,t){return!!e.dispatch(C.readItems(function(e){return e.demandItemFacet(B.isGroupFacet,t)}))}function Y(e,t){return e.dispatch(C.readItems(function(e){return e.demandItemFacet(H.childItemsFacet,t)}))}t.resourceKey=r.createResolvedResourceKey(e("module").id,K)});
define("bYe",["require","exports","lC","BH","bD","Lee","d1","we","DYe","Uk","E2","kX","SYe","yYe","gD","L7","lke","sU","IK","QH","lee","r4e","Le","de","ai","yh","i4e","S3","vYe","Lh","vK","rU","Jy","DK","rK","Ee","YSe","X_","Re","Y","Dye","Sye","jDe","gYe","T3","yye"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var V=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;r._listContext=n.listContext;r._navigation=n.navigation;r._microServiceDataSource=n.microServiceDataSource;r._vroomUrlHelper=n.vroomUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._vroomDataContext=n.vroomDataContext;r._shortcutLinkDataSource=n.shortcutLinkDataSource;r._isActivityFeatureEnabled=n.isActivityFeatureEnabled;r._allowWrsExcel=!F.default.isActivated("4F4F63D5-6B0D-4B6E-B98F-93975947DEED","6/13/2019","Use OneUpWrs instead of OneUpWAC for Excel");r._allowWrsVisio=!1;r._htmlDecodeDiv=document.createElement("textarea");return r}t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){I.default.log(e,"ListItemBuilder.getItemResult");throw e}};t.prototype._getItemResult=function(e){var t,r,a,m,N=e.itemFromServer;if(!N)return null;var k,L=e.microServiceDataSource||this._microServiceDataSource,A=this._urlDataSource,_=e.requestKey,D=e.parentItemKey,P=e.queryType,j=void 0===P?A.getQueryType():P,I=e.groupBy,q=e.itemGroups,U=e.contentTypes,X=e.supportsNestedGroups,V=e.isItemDataOnly,J=e.listTemplateType,K=void 0===J?this._listContext.listTemplateType:J,Q=e.observer,G=A.getKeyParams(_),Y=this._itemUrlHelper.getUrlParts({path:N.id||N.FileRef||N.ServerRelativeUrl,listUrl:G.listurl});k=((t={}).id=Y.serverRelativeItemUrl,t.listurl=Y.normalizedListUrl,t);var Z=N.File_x0020_Type,ee=Z?"."+Z:"",te=this._parseMediaServiceMetadata(N.MediaServiceFastMetadata),ne=this._parseMediaServiceMetadata(N.MediaServiceMetadata),re=this._getItemType({itemFromServer:N,listTemplateType:K,microServiceDataSource:L,mediaServiceFastMetadata:te});if(re===d.default.Folder){var ie=G.id===k.id,se=A.getItemTypeFilter(G),oe={};if(ie)oe=((r={}).view=G.view,r.q=G.q,r.typeFilters=G.typeFilters,r);else{j!==o.default.Search&&(oe=((a={}).view=j,a));se&&H.extend(oe,A.saveItemTypeFilter(se))}H.extend(k,oe)}var ue=A.getKey(k),ae={key:ue,extension:ee},fe=N.id||N.FileRef;ae.id=fe;var le,ce,he=y.default.fromHexString(N.PermMask),pe=W.PermissionMask.hasPermission(he,W.PermissionMask.openItems),de=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!pe,ve=N[".spItemUrl"];if(ve){var me=this._vroomUrlHelper.getUrlParts(ve);le=me.itemId;ce=me.driveId}else le=N["name.FileSystemItemId"]||(N.isRootFolder?"root":void 0);this._vroomDataContext&&le&&this._vroomDataContext.setFileSystemIdMapping(le,fe);var ge=N[".etag"];ge&&(ae.eTag=ge);ae.itemId=M.optional(le);var ye=K===T.ListTemplateType.mySiteDocumentLibrary;ae.graph=M.optional(le&&{itemId:le,driveId:ce,driveType:K?ye?"business":"documentLibrary":void 0});var be=Number(N._ip_UnifiedCompliancePolicyUIAction)||0;"1"===this._navigation.viewParams.showpolicytips&&(be=Number(N.ID)%6);ae.policyTip=M.optional(be);var we=C.isDicomFile(ee);(we||".ai"===ee||".eps"===ee||".psd"===ee)&&L.getThumbnail({fileExtension:ee,item:N,itemKey:ue,mediaServiceMetadata:te})&&(re=d.default.Media);if(R.canRenderNative(ee))ae.htmlConversion={};else if(R.canConvert(ee)){if(Ee=L.getHtmlConversionUrl({fileExtension:ee,item:N,mediaServiceMetadata:te})){re=d.default.Media;ae.htmlConversion={url:Ee+"&inlineImages=true"}}}if(b.isFeatureEnabled(b.EnableZipFilePreviewing)&&(".zip"===ee||".rar"===ee)){var Ee=L.getZipMetaDataUrl({fileExtension:ee,item:N,mediaServiceMetadata:te}),Se=L.getDownloadZipContentsUrl(N);if(Ee&&Se){re=d.default.Media;ae.zip={zipMetaDataUrl:Ee,downloadZipContentsUrl:Se}}}var xe,Te,Ne,Ce,ke,Le,Ae={},Oe=L.getDownloadAsZipUrl(N);Oe&&(Ae[i.default.downloadAsZip]=Oe);ve&&(Ae[i.default.itemUrl]=ve);var Me=this._listContext,_e=Number(N.File_x0020_Size)||Number(N.FileSizeDisplay)||void 0,De=te&&te.video,Pe=".ts"===ee&&_e<1<<19&&!De;Pe&&(re=d.default.File);var He=te&&te.media,Be=F.default.isActivated("AE18621B-70BE-46AB-B681-F87FE63EBAA4","12/10/2019","Obtain item openUrl from full item path")?this._itemUrlHelper.getUrlParts({path:N.FileRef,listUrl:Y.normalizedListUrl}).normalizedItemUrl:Y.fullItemUrl,je=Be?l.canonicalizeDecodedUrl(Be):void 0;if(re===d.default.Folder)xe=N.ProgId&&"sharepoint.documentset"===N.ProgId.toLowerCase();else if(re!==d.default.Media&&!te||T.isPromotedLinksList(K))re===d.default.File&&Me&&void 0!==Me.isDocLib&&!Me.isDocLib&&(Te={});else{var Fe=f.getIconNameFromExtension(ee),Ie=te&&te.photo||(we||"photo"===Fe?{}:void 0),qe=De||("video"===Fe?{}:void 0),Re=te&&te.audio||("audio"===Fe?{}:void 0);if(Ie){Ne={originalUrl:M.optional("photo"===Fe?je:void 0),width:Ie.width||0,height:Ie.height||0};b.isFeatureEnabled(b.Image360Viewer)&&le&&(Ce=this._getImage360(N,te,Ie,ne))}qe&&(ke={fourCC:M.optional(qe.fourCC||(".mp4"===ee.toLowerCase()?"H264":void 0)),bitrate:M.optional(qe.encodingBitrate),width:qe.frameWidth||0,height:qe.frameHeight||0,duration:$(He&&He.duration),audioFormat:M.optional(Re&&Re.format),manifestMetadata:qe.manifestMetadata,altManifestMetadata:qe.altManifestMetadata});Re&&(Le={duration:$(He&&He.duration)})}var Ue=He&&He.title;ae.caption=M.optional(Ue);ae.photo=M.optional(Ne);ae.image360=M.optional(Ce);ae.video=M.optional(ke);ae.audio=M.optional(Le);ae.listItem=M.optional(Te);D&&(ae.parentKey=D);ae.isDocSet=M.optional(xe);Y.serverRelativeItemUrl===Y.serverRelativeListUrl&&(ae.isRootFolder=!0);var ze,We=B.ListItemBuilderHelpers.getItemName(N,re,Me);ae.name=M.optional(We);ae.displayName=M.optional(We);var Xe,Ve=!0;if(N.Modified&&"21"===this._pageContext.webTemplate&&b.isFeatureEnabled(b.RequestDatesInUtc))try{var $e=new Date(N.Modified);ae.dateModifiedTime=$e;ae.dateModifiedValue=$e.getTime();ze=v.getShortDisplayDate($e);Ve=!1}catch(e){}if(Ve){ae.dateModifiedValue=M.optional(N.Modified);ze=N["Modified.FriendlyDisplay"]?v.getRelativeDateTimeStringForLists(N["Modified.FriendlyDisplay"]):N.Modified?""+N.Modified:""}ae.dateModified=M.optional(ze||void 0);ae.permissions=M.optional(he);if(q&&I&&I.length>0)if(X){q[0]||(q[0]=[]);var Je=q[0]&&q[0].length>0?q[0][q[0].length-1]:null,Ke=I[0],Qe=I[1];if(Ke&&"1"===N[Ke+".newgroup"]){var Ge=Je?Je.startIndex+Je.count:0,Ye=B.GroupBuilder.buildGroup(Me,N,Ke,0,!1,Ge),Ze=this._convertToODNGroup(Ye);q[0].push(Ze);Je=Ze}if(Qe&&"1"===N[Qe+".newgroup"]){var et=Je&&Je.children&&Je.children.length>0?Je.children[Je.children.length-1]:null;Ge=et?et.startIndex+et.count:Je?Je.startIndex:0;B.GroupBuilder.buildGroup(Me,N,Qe,1,!1,Ge,Je);var tt=Je.children.pop();Je.children.push(this._convertToODNGroup(tt))}}else for(var nt=0;nt<I.length;nt++){var rt=I[nt];if(rt){var it=q[nt]&&q[nt].length>0?q[nt][q[nt].length-1]:null;if("1"===N[rt+".newgroup"]){Ge=it?it.startIndex+it.count:0,Ze=B.GroupBuilder.buildGroup(Me,N,rt,nt,!1,Ge);q[nt]||(q[nt]=[]);q[nt].push(this._convertToODNGroup(Ze))}}}if(U&&U.length>0&&N.ContentTypeId)for(var st=0,ot=U;st<ot.length;st++){var ut=ot[st];if(N.ContentTypeId===ut.contentTypeId){Xe=!1;if(ut.requiredFields)for(var at=0,ft=ut.requiredFields.split(",");at<ft.length;at++){var lt=N[ft[at]];if(!lt||Array.isArray(lt)&&0===lt.length){Xe=!0;break}}}}ae.hasMissingMetadata=M.optional(Xe);ae.contentTypeId=M.optional(N.ContentTypeId);var ct,ht,pt,dt,vt,mt=N.folder,gt=[];if(mt){ae.folder={};ae.isDropEnabled=!0;ct=[];if(mt.children){for(var yt=0,bt=mt.children,wt=bt.length,Et=0,St=0;St<wt;St++){var xt=this.getItemResult({requestKey:_,queryType:j,itemFromServer:bt[St],groupBy:I,itemGroups:gt,contentTypes:U,listTemplateType:K,supportsNestedGroups:X,isItemDataOnly:V,observer:Q});if(xt){ct[St]=xt.item;Et<10&&xt.itemType===d.default.Media&&yt++;Et++}}wt>0&&(yt>=10||yt>=wt)&&(ae.displayType=o.default.Photos)}}else{pt=(pt=N["serverurl.progid"])?pt.substring(1):je;Ae[i.default.original]=pt;if(b.isFeatureEnabled(b.ShortcutLink)&&g.default.isShortcutItem({key:ue,extension:ee})){re=d.default.Shortcut;if(N._ShortcutUrl){ae.shortcutInfo={shortcutLinkRewritten:!0};Ae[i.default.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,N._ShortcutUrl,N._ShortcutSiteId,N._ShortcutWebId,N._ShortcutUniqueId);N._ShortcutUniqueId&&(ht=s.previewImageUrl({url:N._ShortcutUrl,siteId:N._ShortcutSiteId,webId:N._ShortcutWebId,uniqueId:N._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))}else{ae.shortcutInfo=M.backup({shortcutLinkRewritten:!1});this._shortcutLinkDataSource.enqueueParseShortcut(ue,e.itemFromServer.ID);Ae[i.default.shortcutTarget]=u.default.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+S.default.encodeURIComponent(N.FileRef)}}Ae[i.default.open]=pt;dt=N["File_x0020_Type.mapapp"]||N["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];if(Y.isCrossDomain&&Y.isCrossList){var Tt=N[".fileType"],Nt=w.getOfficeFileType(Tt||"");dt=void 0===Nt?Tt?void 0:dt:Nt;"OneNote.Notebook"===N.HTML_x0020_File_x0020_Type&&(dt="onenote|UsePlain");"pdf"===N.File_x0020_Type&&(dt=void 0)}ae.size=M.optional(_e);ae.totalSize=M.optional(Number(N.SMTotalSize)||void 0);ht||(ht=this._getThumbnail({itemFromServer:N,listTemplateType:K,extension:ee,key:ue,type:re,mediaServiceFastMetadata:te,microServiceDataSource:L}));ae.openUrl=pt;var Ct=N["IconOverlay.mapoly"];Ct&&(ae.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+Ct);ae.thumbnail=ht;var kt=this._getPdfConversionFacet({extension:ee,blockDownload:de,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});kt&&(ae.pdfConversion=kt);var Lt=this._get3dFacet({extension:ee,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});Lt&&(ae.model3d=Lt);if(re===d.default.Folder){var At=Number(N.ItemChildCount)+Number(N.FolderChildCount);ae.childCount=At;var Ot=Number(N.SMTotalFileCount);ae.folder={totalCount:Ot>0?Ot:At,childCount:At};ae.isDropEnabled=!0}var Mt=N.ServerRedirectedEmbedUrl;Mt&&(this._itemUrlHelper.getUrlParts({path:Mt}).isCrossDomain||(vt=Mt))}ae.previewIFrameUrl=vt;ae.type=re;ae.appMap=M.optional(dt);this._pageContext.blockDownloadsExperienceEnabled&&(ae.type===d.default.Media||pt&&dt)?ae.itemStatus=4:this._pageContext.blockDownloadsExperienceEnabled&&re!==d.default.Folder?ae.itemStatus=3:this._pageContext.viewOnlyExperienceEnabled&&(ae.itemStatus=4);var _t={};for(var Dt in N)N.hasOwnProperty(Dt)&&(_t[Dt]=N[Dt]);var Pt=x.default.normalizeLower(N.UniqueId)||void 0;Pt&&(_t.uniqueId=Pt);var Ht=N.RemoteItem;ae.remoteItem=Ht&&JSON.parse(Ht);ae.reputationProperties=this.getReputationProperties(N);var Bt,jt=We;ee&&(jt=We.substring(0,We.toLowerCase().lastIndexOf(ee.toLowerCase())));ae.sharingRole=0;Bt=Number(N.PrincipalCount)>0?c.default.Shared:void 0===N.PrincipalCount?b.isOneDrive?void 0:c.default.Unknown:c.default.Private;ae.sharingType=M.optional(Bt);_t.FileName=jt;var Ft=f.getIconNameFromItem({extension:ee,isDocSet:xe,listItem:Te,sharingType:Bt,type:re,textEditorMimeType:Pe?"text/typescript":void 0,panorama:Ce});ae.iconName=Ft;var It="ms-excel"===dt,qt="ms-powerpoint"===dt,Rt="ms-visio"===dt,Ut="ms-word"===dt;if(pt&&(Ut||It||qt||Rt)){var zt=this._getOfficeBundleFacet({isWord:Ut,extension:ee,itemUrlParts:Y,isPowerPoint:qt,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});!zt||It&&!this._allowWrsExcel||Rt&&!this._allowWrsVisio||(ae.officeBundle=zt);zt&&(Ut||qt)&&(Ae[i.default.viewInBrowser]=L.getPdfConversionUrl({fileExtension:ee,item:N,mediaServiceMetadata:te},!0));ae.wopiFrameUrl=pt}ae.defaultSubText=E.getGridSubTitleTextFromModifiedBy(E.getModifiedByFromObject(N.Editor));ae.isPlaceholder=!N.PermMask;ae.queryType=j;ae.displayType=M.backup(ae.queryType);ae.isDraggable=ae.queryType===o.default.Files;N.folder||(_t.modifiedByUser=E.getModifiedByUserFromObject(N.Editor));_t.MediaServiceOCR=E.getOcrFromHtmlString(N.MediaServiceOCR);ae.properties=_t;ae.lifeCycleStatus=M.optional(this._getItemLifeCycleStatus(N));ae.comments={settings:z.getCommentFlags(N._CommentFlags)};ae.urls=n.__assign(n.__assign(n.__assign({},Ae),this._getVideoUrl({extension:ee,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te})),((m={})[i.default.mediaBaseUrl]=L.getMediaBaseUrl({fileExtension:ee,item:N,mediaServiceMetadata:te}),m));Q.update([new O.default(ue).succeed({item:ae})]);b.isFeatureEnabled(b.ItemAnalytics)&&b.isFeatureEnabled(b.EnableTrendingSignalInListView)&&ue&&this.resources.consumeAsync(h.resourceKey).then(function(e){e.queueNewItem(ue)});var Wt=this._isActivityFeatureEnabled;F.default.isActivated("5FB0B159-1F05-4A77-99C9-AF50F3EC8435","4/2/2020","Use ItemsScope activity column")&&Wt&&!V&&Pt&&le&&!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isEmailAuthenticationGuestUser&&!this._pageContext.isExternalGuestUser&&this.resources.consumeAsync(p.resourceKey).then(function(e){e.enqueue(ue)});var Xt=this._getGroupings({itemFromServer:N,supportsNestedGroups:X,groupBy:I,groups:gt}),Vt=Xt.groupings,$t=Xt.totalChildren;return{item:{key:ue},itemType:re,children:ct,groupings:Vt,totalChildren:$t,nextRequestToken:N.nextRequestToken}};t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;b.isFeatureEnabled(b.EnableATPFilesListView)&&0!==n&&3!==n&&(t.isMalwareDetected=!0);return t};t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,r=e.supportsNestedGroups,i=e.groupBy,s=e.groups,o=null,u=this._listContext.groupLevel,a=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==u)if(n.groups){var f=[],l=0;if(r){var c=B.GroupBuilder.buildCollapsedGroups(n.groups,this._listContext,i),h=c.groups,p=c.totalCount;f=h.map(function(e){return t._convertToODNGroup(e)});l=p}else for(var d=0,v=n.groups;d<v.length;d++){var m=v[d],g=i[u];if(m[g+".newgroup"]){var y=B.GroupBuilder.buildGroup(this._listContext,m,g,u,!0,l);f.push(this._convertToODNGroup(y));l+=y.count}}if(f&&f.length>0){o=[{name:void 0,itemGroups:f,isAllCollapsed:this.createObservable(!0)}];a=l}}else s&&s.length>0&&s[u]&&s[u].length>0&&(o=[{name:void 0,itemGroups:s[u],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:a}};t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,r=[],i=n.folder.children,s=n.nextRequestToken?2:0,o=i.length+s,u=0;u<o;u++){var a=i[u];if(a){if(!(this._getItemTypeOneNoteOrFolder(a)===d.default.Folder)){t=u;break}}}(void 0===t&&o>0||t>0)&&r.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})});void 0!==t&&r.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})});return r.length?[{name:"FoldersDocumentsPhotos",itemGroups:r,isAllCollapsed:this.createObservable(!1)}]:void 0};t.prototype._getImage360=function(e,t,n,r){var i,s=t&&t.panorama,o=!1;if(s&&"equirectangular"===s.projectionType){i={projectionType:s.projectionType};o=!0}else e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0);if(o&&r){var u=r.panorama;if(u)i={projectionType:M.optional(s.projectionType||void 0),croppedAreaImageHeightPixels:M.optional(u.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:M.optional(u.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:M.optional(u.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:M.optional(u.croppedAreaTopPixels||void 0),fullPanoHeightPixels:M.optional(u.fullPanoHeightPixels||void 0),fullPanoWidthPixels:M.optional(u.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:M.optional(u.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:M.optional(u.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:M.optional(u.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:M.optional(u.initialViewPitchDegrees||void 0),initialViewRollDegrees:M.optional(u.initialViewRollDegrees||void 0),poseHeadingDegrees:M.optional(u.poseHeadingDegrees||void 0),posePitchDegrees:M.optional(u.posePitchDegrees||void 0),poseRollDegrees:M.optional(u.poseRollDegrees||void 0)};else{var a=r.photo;if(a&&a.cameraModel){var f=a.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro – 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(f)>=0&&(i={projectionType:"equirectangular"})}}}return i};t.prototype.getReputationProperties=function(e){for(var t={},n=0,r=a.default;n<r.length;n++){var i=r[n];t[i]=M.optional(e[i])}return t};t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&X.canRenderNative(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}};t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=q.canRenderNative(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}};t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,r=e.itemUrlParts,i=e.isPowerPoint,s=e.itemFromServer,o=e.microServiceDataSource,u=e.mediaServiceFastMetadata,a=r.isCrossDomain;if(!a&&("21"===this._pageContext.webTemplate||b.isFeatureEnabled(b.EnableWrsPreviewOutsideODB))){var f,l,c,h=!a&&(t&&b.isFeatureEnabled(b.EnableWordWrsPreview)||i&&b.isFeatureEnabled(b.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:s,mediaServiceMetadata:u}):"",d=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:s,mediaServiceMetadata:u}),v=!1,m="",g=s[".ctag"],y=u&&u.officeBundle;if(y){f=y.ctag;c=y.version;v=y.fatalError||!1;y.generationTime&&(l=new Date(y.generationTime));m=y.errorInfo||""}return{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:d,bundleCTag:f,bundleVersion:c,hasBundleGenerationFailed:v,bundleErrorInfo:m,generationTime:l,cTag:g,enableDefaultClick:h}}};t.prototype._getThumbnail=function(e){var t=e.itemFromServer;if(e.type!==d.default.Folder){if(T.isPromotedLinksList(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===T.ListTemplateType.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(C.fileTypeSupportsPreview(e.extension)){if(this._listContext.remoteParentWeb){var r=new u.default(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(u.UriPartial.authority),i=encodeURI(t.FileRef);return s.previewImageUrlFromUrl(S.default.encodeURIComponent(r+i),this._pageContext.webAbsoluteUrl,this._pageContext)}return s.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}};t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};t&&(n[i.default.video]=t);return n};t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,r=e.microServiceDataSource,i=e.mediaServiceFastMetadata,s=this._getItemTypeOneNoteOrFolder(t);if(s===d.default.Unknown){var o=t.File_x0020_Type,u=o?"."+o:"";if(b.isFeatureEnabled(b.ShortcutLink)&&g.default.isShortcutFileType(o))return d.default.Shortcut;if(b.isFeatureEnabled(b.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:u,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:r})))return d.default.Media;if(this._get3dFacet({itemFromServer:t,extension:u,microServiceDataSource:r,mediaServiceFastMetadata:i}))return d.default.Media;if("audio"===f.getIconNameFromExtension(u))return d.default.Media;if(i)return d.default.Media;if((s=f.getItemTypeFromExtension(u))===d.default.Unknown)return T.isGenericList(n)?d.default.File:T.isPromotedLinksList(n)?d.default.Media:s}return s||d.default.File};t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=d.default.Folder;else if("1"===e.FSObjType){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],r=e["File_x0020_Type.mapapp"];t=r&&"onenote"===r.substring(0,7)||n&&-1!==n.indexOf("onenote")?d.default.OneNote:d.default.Folder}else t=d.default.Unknown;return t};t.prototype._convertToODNGroup=function(e){var t=this,n=e;n.state=this.createObservable({isCollapsed:e.isCollapsed});n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)}));return n};t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;if("&"===e[1]){this._htmlDecodeDiv.innerHTML=e;t=this._htmlDecodeDiv.innerText}return JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:k.pageContext,urlDataSource:N.url,listContext:k.listContext,navigation:A.navigation,microServiceDataSource:P.resourceKey,vroomUrlHelper:D.resourceKey,itemUrlHelper:_.resourceKey,vroomDataContext:L.dataContext.optional,shortcutLinkDataSource:m.resourceKey,isActivityFeatureEnabled:U.isActivityFieldEnabledResourceKey});return t})(r.default);t.default=V;function $(e){return"number"!=typeof e||F.default.isActivated("7F572FB6-3D81-4762-8499-379671FD5F86","9/20/2017","Convert 100ns video durations to ms")?e:e/1e4}t.resourceKey=j.createResolvedResourceKey(e("module").id,V)});
define("DYe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"]});
define("SYe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["z6e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("yYe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["B6e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("IK",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(n=t.Double||(t.Double={}));t.default=n});
define("r4e",["require","exports","See","ye","pe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getGridSubTitleTextFromModifiedBy=function(e){return e?i.format(n.default.gridViewSubTitle,e):""};t.getModifiedByFromObject=function(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""};t.getModifiedByUserFromObject=function(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&r.getUserPhotoUrl({userLoginName:t.email})}};t.getModifiedByFromString=function(e){return e?e.substr(e.lastIndexOf("\n")+1):""};t.getOcrFromHtmlString=function(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}};t.FOLDER_CONTENT_TYPE_PREFIX="0x0120";t.isFolderContentType=function(e){return e&&e.slice(0,6)===t.FOLDER_CONTENT_TYPE_PREFIX}});
define("i4e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[".dcm",".dcm30",".dic",".dicm",".dicom"],r={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};t.fileTypeSupportsPreview=function(e){return!!e&&r[e.toLowerCase()]};t.isDicomFile=function(e){return n.indexOf(e)>=0}});
define("DK",["require","exports","lC","BH","we","X_"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getUrlParts=function(e){return new u(e)};return t})(r.default);t.default=o;var u=(function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!0,configurable:!0});e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new i.default(t).getPathSegments():[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e})();t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("Dye",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["glb","gltf"],r=["cool","fbx","obj","ply","stl","3mf"];function i(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e){return i(r,e)};t.canRenderNative=function(e){return i(n,e)}});
define("Sye",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["htm","html","svg"],r=["eml","msg","md","mdown","markdown"];function i(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e){return i(r,e)};t.canRenderNative=function(e){return i(n,e)}});
define("gYe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCommentFlags=function(e){var t={};t.isCommentDisabled=n(e);return t};function n(e){return void 0===e||null==e||(1&e)>0}t.isCommentDisabled=n});
define("yye",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["ai","pdf"],r=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],i=["dwg","dxf"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e,t){return s(r,e)||!!t&&s(i,e)};t.canRenderNative=function(e){return s(n,e)}});
define("yK",["require","exports","Ih","d1","yh","vK","bj","S3","Ee","gD","IK","ai","rU","Jy","DK","E2","AD","X_","SK","Re"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=!1;var E=(function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext;this._itemUrlHelper=t.itemUrlHelper;this._vroomUrlHelper=t.vroomUrlHelper}e.prototype.processResponse=function(e){var t=e.response,n=e.response,r=n.WebUrl,i=n.HttpRoot,s=n.ListData,u=n.rootFolder,a=n.ListSchema,f=(void 0===a?{}:a).Collapse,c=void 0===f?"FALSE":f,h=e.requestKey,p=e.observer,d=this._urlDataSource.getKeyParams(h),v="TRUE"===c,m=this._itemUrlHelper.getItemUrlParts(h),g=this._itemUrlHelper.getUrlParts({path:m.serverRelativeListUrl,listUrl:m.fullListUrl});(r||i)&&this._processWeb({list:t,requestKeyParts:d,observer:p});var y=this._processList({list:t,listUrlParts:g,requestKeyParts:d,observer:p}).listRootItemKey,b=[];if(u){var w=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:d,observer:p});b.push.apply(b,w.parentItemUrls)}if(s&&!v){w=this._processListData({listData:s,listUrlParts:g,parentKey:h,requestKeyParts:d,observer:p});b.push.apply(b,w.parentItemUrls)}var E={};if(t.ParentInfo)for(var S=0,x=t.ParentInfo.ParentFolderInfo;S<x.length;S++){var T=x[S];E[T.ServerRelativeUrl]=l.default.fromHexString(T.Permissions)}for(var N=0,C=o.removeDuplicates(b);N<C.length;N++){var k=C[N];this._processParentItem({itemUrl:k,listUrlParts:g,parentInfo:E,requestKeyParts:d,observer:p})}return{listRootItemKey:y}};e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,r=e.requestKeyParts,i=e.listUrlParts,o=e.observer,u=[],a="",f=0,l=t;f<l.length;f++){var c=l[f],h=c.FileRef,p=this._processRow({row:c,observer:o,requestKeyParts:r,listUrlParts:i}).key;u.push.apply(u,this._getParentItemUrls({listUrlParts:i,itemUrl:h}));o.update([new s.default(p).succeed({set:{parent:{key:n},after:{key:a}}})]);a=p}return{parentItemUrls:u}};e.prototype._processRow=function(e){var t,n,i=e.row,o=e.row.FileRef,u=e.listUrlParts,f=e.requestKeyParts,l=e.observer,c=this._itemUrlHelper.getUrlParts({path:o,listUrl:u.fullListUrl});n=((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t);if(this._isFolder(i)){var h={},p=this._urlDataSource.getQueryType(f),d=f.typeFilters;p!==r.default.Search&&(h.view=f.view);d&&(h.typeFilters=d);a.extend(n,h)}var v=this._urlDataSource.getKey(n),m=this._getParentKeyForListItem({listUrlParts:u,itemUrl:o,requestKeyParts:f}),g={key:v};m&&(g.parentKey=m);l.update([new s.default(v).succeed({item:g})]);return{key:v}};e.prototype._processRootFolder=function(e){var t,n,r,i=e.list,o=e.listUrlParts,u=e.requestKeyParts,a=e.observer,l=i.rootFolder,c=this._itemUrlHelper.getUrlParts({path:l,listUrl:o.fullListUrl}),p=this._urlDataSource.getKey(((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t.view=u.view,t.q=u.q,t.typeFilters=u.typeFilters,t)),d=this._getParentKeyForListItem({listUrlParts:o,itemUrl:l,requestKeyParts:u}),v={key:p,type:f.default.Folder,newWOPIDocumentEnabled:h.optional(i.NewWOPIDocumentEnabled)};d&&(v.parentKey=d);var m=!b.default.isActivated("D661752A-9F1F-4AF8-89A9-2C0CA6688A00","03/19/2019","Infer rootFolder content-type");if(i.ListData){n=i.ListData.FolderId;if(m&&"Sharepoint.DocumentSet"===i.ListData.CurrentFolderProgId){v.isDocSet=!0;if(i.AvailableContentTypes)for(var g=0,y=i.AvailableContentTypes;g<y.length;g++){var w=y[g],E=w.contentTypeId;if(E&&0===E.indexOf("0x0120D520")){v.contentTypeId=E;r=w.displayName;break}}}if(i.ListData.CurrentFolderSpItemUrl){var S=this._vroomUrlHelper.getUrlParts(i.ListData.CurrentFolderSpItemUrl);v.itemId=h.optional(S.itemId);v.graph={itemId:h.optional(S.itemId),driveId:h.optional(S.driveId)}}}m&&r&&v.contentTypeId?v.properties={ID:h.optional(n),ContentType:r,ContentTypeId:v.contentTypeId}:v.properties={ID:h.optional(n)};if(!this._isListRoot({itemUrl:l,listUrlParts:o})){var x=l.split("/").slice(-1)[0];v.name=x;v.displayName=x}a.update([new s.default(p).succeed({item:v})]);return{parentItemUrls:this._getParentItemUrls({listUrlParts:o,itemUrl:l})}};e.prototype._processWeb=function(e){var t,n=e.list,i=e.requestKeyParts,o=e.observer,u=n.HttpRoot,a=n.SiteTitle,l=n.WebUrl||u&&v.getSharePointPath(decodeURIComponent(u)),c=this._itemUrlHelper.getUrlParts({path:l,webUrl:l}),h=this._urlDataSource.getKey(((t={}).id=c.normalizedItemUrl,t.view=r.default.DocumentLibraries,t.typeFilters=i.typeFilters,t)),p={},d={key:h,type:f.default.Folder,subsite:p};if(this._pageContext.webAbsoluteUrl===l){d.name=a;d.displayName=a;p.webTemplateId=Number(this._pageContext.webTemplate);p.serverRelativeUrl=this._pageContext.webAbsoluteUrl;p.id=this._pageContext.webId;p.siteCollectionId=this._pageContext.siteId;p.title=this._pageContext.webTitle;p.icon=this._pageContext.webLogoUrl}o.update([new s.default(h).succeed({item:d})])};e.prototype._processList=function(e){var t,i,o,u,a,l,p=e.list,d=e.listUrlParts,g=e.requestKeyParts,b=e.observer,E=p.ListTitle,S=p.HttpRoot,x=p.ListUrl,T=p.listUrlDir,N=x||T&&decodeURIComponent(T),C=this._urlDataSource.getKey(((t={}).id=d.serverRelativeItemUrl,t.listurl=d.normalizedListUrl,t.view=g.view,t.q=g.q,t.typeFilters=g.typeFilters,t)),k=p.AllowCreateFolder,L=p.EnableMinorVersions,A=p.verEnabled,O=p.AllowGridMode,M=p.DisableGridEditing,_=p.ListTemplateType,D=p.BasePermissions,P=void 0===D?{}:D,H=P.ManageLists,B=void 0===H?void 0:H,j=P.ManagePersonalViews,F=void 0===j?void 0:j,I=P.OpenItems,q=void 0===I?void 0:I,R=P.UseClientIntegration,U=void 0===R?void 0:R,z=p.ListSchema,W=void 0===z?{}:z,X=W.DefaultItemOpen,V=void 0===X?void 0:X,$=W[".driveAccessTokenV21"],J=void 0===$?void 0:$,K=W[".driveAccessToken"],Q=void 0===K?void 0:K,G=W[".driveUrl"],Y=void 0===G?void 0:G,Z=W[".driveUrlV21"],ee=void 0===Z?void 0:Z,te=p.ExcludeFromOfflineClient,ne=p.WebExcludeFromOfflineClient,re=p.listBaseType,ie=Q,se=J,oe=Y,ue=ee,ae=this._pageContext.driveInfo;if(p.isFromServiceWorkerCache&&N===this._pageContext.listUrl&&ae){ae[".driveAccessToken"]&&(ie=ae[".driveAccessToken"]);ae[".driveAccessTokenV21"]&&(se=ae[".driveAccessTokenV21"]);ae[".driveUrl"]&&(oe=ae[".driveUrl"]);ae[".driveUrlV21"]&&(ue=ae[".driveUrlV21"])}if(ie){u={accessToken:(fe=m.deserializeQuery(ie)).access_token,proofToken:fe.prooftoken,tokenUrl:oe}}if(se){var fe;a={accessToken:(fe=m.deserializeQuery(se)).access_token,proofToken:fe.prooftoken,tokenUrl:ue}}var le=p.WebUrl||S&&v.getSharePointPath(decodeURIComponent(S));if(le){var ce=this._itemUrlHelper.getUrlParts({path:le,webUrl:le});l=this._urlDataSource.getKey(((i={}).id=ce.normalizedItemUrl,i.view=r.default.DocumentLibraries,i.typeFilters=g.typeFilters,i))}var he="string"==typeof V?"0"===V:void 0;he&&(function(){if(!w){n.Engagement.logData({name:"List.openInClient"});w=!0}})();var pe=oe&&this._vroomUrlHelper.getUrlParts(oe)||void 0;u&&y.isTokenExpired({authToken:u.accessToken,proofToken:u.proofToken})&&(u=void 0);a&&y.isTokenExpired({authToken:a.accessToken,proofToken:a.proofToken})&&(a=void 0);var de="number"==typeof re?c.isDocLib(String(re)):void 0;b.update([new s.default(C).succeed({item:{key:C,parentKey:h.optional(l),itemId:h.backup("root"),graph:{itemId:h.backup("root"),driveId:h.optional((null===(o=pe)||void 0===o?void 0:o.driveId)||void 0),sessionToken:h.optional(u),sessionTokenV21:h.optional(a)},type:f.default.Folder,name:h.optional(E),displayName:h.optional(E),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:h.optional(p.rootFolder?void 0:p.NewWOPIDocumentEnabled),list:{id:h.optional(p.listName),allowGridMode:"boolean"==typeof O?O:h.backup(!0),allowCreateFolder:h.optional(k),disableGridEditing:"boolean"==typeof M?M:h.backup(!1),enableMinorVersions:h.optional(L),enableVersions:h.optional(A),templateType:h.optional("string"==typeof _?Number(_):void 0),isDocumentLibrary:h.optional(de),isPromotedLinks:h.optional("string"==typeof _?c.isPromotedLinksList(_):void 0),isModerated:h.optional(p.isModerated),newWOPIDocumentEnabled:h.optional(p.NewWOPIDocumentEnabled),newWOPIDocumentTypes:h.optional(p.NewWOPIDocumentTypes),permissions:{manageLists:h.optional(B),managePersonalViews:h.optional(F),openItems:h.optional(q),useClientIntegration:h.optional(U)},openInClient:h.optional(he),excludeFromOfflineClient:h.optional("boolean"==typeof te||"boolean"==typeof ne?te||ne:void 0),contentTypesEnabled:h.optional(p.ContentTypesEnabled),metadataNavFeatureEnabled:h.optional(p.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:h.optional(p.canUserCreateMicrosoftForm),itemCount:h.optional(p.ListSchema&&p.ListSchema.ItemCount),rowLimit:h.optional(p.ListData.RowLimit),listUrlDir:N,createdFromExcel:h.optional(p.CreatedFromExcel),createdFromExisting:h.optional(p.CreatedFromExisting)},properties:{commandsSupported:h.optional(p.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]);return{listRootItemKey:C}};e.prototype._processParentItem=function(e){var t,n=e.itemUrl,r=e.listUrlParts,i=e.parentInfo,o=e.requestKeyParts,u=e.observer,a=this._itemUrlHelper.getUrlParts({path:n,listUrl:r.fullListUrl}),l=this._urlDataSource.getKey(((t={}).id=a.serverRelativeItemUrl,t.listurl=a.normalizedListUrl,t.view=o.view,t.q=o.q,t.typeFilters=o.typeFilters,t)),c={key:l,parentKey:this._getParentKeyForListItem({listUrlParts:r,itemUrl:n,requestKeyParts:o}),queryType:this._urlDataSource.getQueryType(o)};if(this._isListRoot({itemUrl:n,listUrlParts:r}))c.list={};else{var h=v.getFolderNameFromPath(n);c.name=h;c.displayName=h;c.type=f.default.Folder;c.isDropEnabled=!0;c.folder={};i&&i[n]&&(c.permissions=i[n])}u.update([new s.default(l).succeed({item:c})])};e.prototype._getParentKeyForListItem=function(e){var t,n,r=e.listUrlParts,i=e.itemUrl,s=e.requestKeyParts;if(r.serverRelativeListUrl!==i){var o=i.split("/").slice(0,-1).join("/"),u=this._itemUrlHelper.getUrlParts({path:o,listUrl:r.fullListUrl});n=this._urlDataSource.getKey(((t={}).id=u.serverRelativeItemUrl,t.listurl=u.normalizedListUrl,t.view=s.view,t.q=s.q,t.typeFilters=s.typeFilters,t))}return n};e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,r=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var s="",o=0,u=n.substring(i.length).split("/").slice(1,-1);o<u.length;o++){var a=""+i+(s+="/"+u[o]);r.push(a)}return r};e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t};e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],r=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||r&&-1!==r.indexOf("onenote"))}else t=!1;return t};e.dependencies={urlDataSource:i.url,pageContext:u.pageContext,itemUrlHelper:p.resourceKey,vroomUrlHelper:d.resourceKey,resources:g.resourceScopeKey};return e})();t.default=E;t.resourceKey=g.createResolvedResourceKey(e("module").id,E)});
define("SK",["require","exports","C3"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return n.parseTokenPayload(e)}t.parseToken=r;function i(e){try{return new Date(parseInt(e+"000",10))}catch(e){}}t.getDate=i;t.isTokenExpired=function(e,t){void 0===t&&(t=0);if(!e.expiry){var n=r(e.authToken);e.expiry=n&&i(n.exp)}return(e.expiry?e.expiry.getTime():0)-Date.now()<t}});
define("OK",["require","exports","wK","X_"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._microServiceDataSourceType=t.microServiceDataSourceType;this._store=new Map}e.prototype.getOrCreateMicroServiceDataSource=function(e){var t=this._store.get(e);if(!t){t=new this._microServiceDataSourceType;this._store.set(e,t)}return t};return e})();t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{microServiceDataSourceType:n.typeResourceKey})});
define("hYe",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["d8e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("IYe",["require","exports","lC","X_","bYe","yK","gK","LD","d1","rs","Vm","mh","j5","de","Re","Tz","yh","xYe","OK","S3","YSe","Xx","zm","Rs","oh"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=d.default.isActivated("D349E556-140B-4BFA-8B14-5DD337AAFB41","7/2/2020","Use per-list store for MicroServiceDataSource"),C=!d.default.isActivated("B2674AC0-2974-4648-A267-F071B5046467","2/26/2020","Create a new MicroServiceDataSource per list response."),k=(function(){function e(e,t){this._listItemBuilder=t.listItemBuilder;this._listItemResultProcessor=t.listItemResultProcessor;this._itemTaskObserverType=t.itemTaskObserverType;this._urlDataSource=t.urlDataSource;this._microServiceDataSource=t.microServiceDataSource;this._microServiceDataSourceType=t.microServiceDataSourceType;this._microServiceDataSourceStore=t.microServiceDataSourceStore;this._listContext=t.listContext}e.prototype.updateFromResponse=function(e){var t=this;return function(r){var i=new t._itemTaskObserverType,s=e.itemSetKey,o=e.serverData,p=e.isItemSetRequest,v=r(f.readItems(function(e){return e.demandItemFacet(c.knockoutStoreIdentityFacet,s)}));if(void 0!==v){var m=[v],g=v.key,y=t._listItemResultProcessor.processResponse({response:o,requestKey:g,observer:i}).listRootItemKey;if(p){var b=t._processRootFolder({response:o,requestKey:g,observer:i,isItemSetRequest:p});b&&m.push(b.item);o&&w.ListItemBuilderHelpers.updateListContext(o,t._listContext)}var k,L=o.ListData&&o.ListData.Row||[];N?C&&(k=new t._microServiceDataSourceType):k=t._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(y);if(k&&o.ListSchema){var A={data:o.ListSchema,allowCookies:!1};k.setBaseInfo(A);t._microServiceDataSource.setBaseInfo(A)}if(!(o.ListSchema&&"TRUE"===o.ListSchema.Collapse))for(var O=0,M=L;O<M.length;O++){var _=M[O],D=t._listItemBuilder.getItemResult({microServiceDataSource:k,itemFromServer:n.__assign({},_),requestKey:g,queryType:a.default.Files,supportsNestedGroups:!1,isItemDataOnly:!p,observer:i}).item;m.push(D)}i.flush();if(!d.default.isActivated("2282EF64-8A86-46E8-9221-D8554DC1D731","6/26/2020","Mark KO shim items as resolved when processing list response")){var P=r(f.readItems(function(e){for(var t,r=new l.ItemResolver,s=0,o=m;s<o.length;s++){var a=o[s],f=i.getItem(a);if(f&&!f.isPlaceholder){var c=h.getKeyParams(a.key),p=e.demandItemFacet(u.viewParamsToItemKeyControl,T.odspNextAppItemKey),d=u.viewParamsToItemKeyControl.evaluate(p)(e,{viewParams:c,isNavigation:!1}).itemKey;if(d){var v=E.odspNextStoreKeyFacet.serialize({itemKey:d});r.resolveItems({items:(t={},t[d]=n.__assign({},S.getInvalidationFacet().forFacet(x.displayNameFacet).thenInvalidate(v,E.createdStoreItemFacet).pack()),t[v]=n.__assign({},E.createdStoreItemFacet.pack(void 0)),t)})}}}return r}));r(P.execute())}}}};e.prototype._processRootFolder=function(e){var t=e.response,n=e.requestKey,r=e.observer,i=e.isItemSetRequest,s=t.ListData,o=t.ListSchema,u=(void 0===o?{}:o).Collapse,a=void 0===u?"FALSE":u;if(s){var f=s&&s.Row,l="";s.NextHref&&(l=(l=s.NextHref).replace("&View="+p.default.Empty,""));var c="TRUE"===a,h=!c&&f?f.slice(0):[],d=this._urlDataSource.getKeyParams(n),m={id:d.id,folder:{childCount:h.length,children:h},nextRequestToken:l,PermMask:s.FolderPermissions,groups:c?f:null,isRootFolder:!1};if(v.isTeamChannelBannerEnabled()){var g=s&&s.CurrentFolderProgId;m.ProgId=g}return this._listItemBuilder.getItemResult({requestKey:n,queryType:this._urlDataSource.getQueryType(d),itemFromServer:m,supportsNestedGroups:!1,isItemDataOnly:!i,observer:r})}};return e})();t.default=k;t.resourceKey=r.createResolvedResourceKey(e("module").id,k,{listItemBuilder:i.resourceKey,listItemResultProcessor:s.resourceKey,itemTaskObserverType:o.resourceKey,urlDataSource:m.url,microServiceDataSource:g.resourceKey,microServiceDataSourceType:g.typeResourceKey,microServiceDataSourceStore:y.resourceKey,listContext:b.listContext})});
define("xYe",["require","exports","lC","X_","PYe","S3","kYe","AYe","wYe","CYe","bK"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=new r.ResolvedResourceFactory(i.default,{pageContext:s.pageContext,thumbnailHelper:o.resourceKey,metaDataProcessor:u.resourceKey,authCookieHelper:a.resourceKey,authTokenStore:f.resourceKey,authTokenDataSource:l.resourceKey});t.typeResourceKey=new r.ResourceKey({name:e("module").id+".type",factory:{dependencies:{resources:r.resourceScopeKey},create:function(e){return{instance:(function(t){n.__extends(i,t);function i(){var n=this,i=new r.ResourceScope(e.resources);i.bind(u.resourceKey);(n=t.call(this,{},i.resolve(c.dependencies))||this)._resources=i;return n}i.prototype.dispose=function(){this._resources.dispose()};return i})(i.default)}}}});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:c})});
define("PYe",["require","exports","lC","th","TYe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._baseInfoSetCallbacks=[];i._authDataSignalCompleted=!1;i._authDataSignal=new r.default;i._authTokenDataSource=n.authTokenDataSource;i._baseInfoSet=!1;return i}t.prototype.getAuthData=function(){var e=this;return this._authTokenDataSource&&this.hasAuthDataExpired()?this._authTokenDataSource.getAuthToken({}).then(function(t){e.setBaseInfo(t);return e._authDataSignal.getPromise()}):this._authDataSignal.getPromise()};t.prototype.hasAuthData=function(){return!!this._processor.getCommonAuthData()};t.prototype.hasAuthDataExpired=function(){var e=new Date;e.setMinutes(e.getMinutes()+5);var t=this._processor.getCommonAuthData();return!!t&&t.expirationTime<=e};t.prototype.setBaseInfo=function(e){this._baseInfoSet=!0;var t=this._processor.parseCommonData(e);if(t.authData)if(this._authDataSignalCompleted){this._authDataSignal=new r.default;this._authDataSignal.complete(t.authData)}else{this._authDataSignalCompleted=!0;this._authDataSignal.complete(t.authData)}this._cookieHelper.checkCookies(t.mediaUrl,t.authData);for(var n=0,i=this._baseInfoSetCallbacks;n<i.length;n++){(0,i[n])()}};t.prototype.hasSetBaseInfo=function(){return this._baseInfoSet};t.prototype.registerSetBaseInfoCallback=function(e){this._baseInfoSetCallbacks.push(e)};return t})(i.default);t.default=s});
define("TYe",["require","exports","_e","Uk","Cv","Dye","e5","yye","Z8","$8"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={ODC:"EnableAudioPlayer",ODB:841,OneDrive:!0},c={"ar-SA":!0,"he-IL":!0,"ja-JP":!0,"ko-KR":!0,"zh-CN":!0},h=/&(?:access_|proof)token=[^&]*/g,p=(function(){function e(e,t){this._processor=t.metaDataProcessor;this._cookieHelper=t.authCookieHelper;this._thumbnailHelper=t.thumbnailHelper;this._pageContext=t.pageContext;this._authTokenStore=t.authTokenStore}e.prototype.getVideoUrl=function(e){if("False"!==e.item[".hasVideoManifest"]||e.item[".videoManifestUrl"]||"audio"===r.getIconNameFromExtension(e.fileExtension)||i.default.isFeatureEnabled(l)){var t=this._processor.generateUrl(".videoManifestUrl",e.item);if(t){var n=e.item[".ctag"];n&&(t+="&cTag="+encodeURIComponent(n));t+="&action=Access"}return t}};e.prototype.getThumbnail=function(e){if(("False"!==e.item[".hasThumbnail"]||e.item[".thumbnailUrl"])&&this._thumbnailHelper.canProvideThumbnail(e.fileExtension)){var t=this._processor.generateUrl(".thumbnailUrl",e.item);t&&(t+="&encodeFailures=1");var n=e.allowCookieAuth,r=void 0===n||n,s=e.itemKey,o=e.fileExtension,u=e.mediaServiceMetadata;if(t&&r&&this._cookieHelper.canUseCookies()){t=t.replace(h,"");e.item[".ctag"]&&(t+="&ctag="+encodeURIComponent(e.item[".ctag"]));this._cookieHelper.trackItem({itemKey:s,thumbnailUrl:t,fileExtension:o,mediaServiceMetadata:u})}else if(t){var f=this._processor.getCommonAuthData();if(f){var l=i.default.isFeatureEnabled(a.MediaTAUseVroomV21),c={authToken:l?f.authTokenV21:f.authToken,proofToken:l?f.proofTokenV21:f.proofToken},p=this._authTokenStore.getToken(this._processor.getUniqueKey(),c);p&&p!==c&&(t=t.replace(h,"&access_token="+p.authToken+(p.proofToken?"&prooftoken="+p.proofToken:"")))}}return t?this._thumbnailHelper.getThumbnail({itemKey:s,fileExtension:o,baseUrl:t,mediaServiceMetadata:u}):void 0}};e.prototype.getDownloadAsZipUrl=function(e){var t=this._processor.getNormalUrl(".zipUrl",e);if(!t){e[".zipUrl"]=o.ZIP_URL;t=this._processor.getFallbackUrl(".zipUrl",e)}return t};e.prototype.getPassthroughUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"passthrough")};e.prototype.getPdfConversionUrl=function(e,t){var r=e.fileExtension;if((this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled)&&u.canRenderNative(r))return this.getPassthroughUrl(e);if(!c[n.default.language]){var s=i.default.isFeatureEnabled({ODB:1225});return u.canConvert(r,s)||t?this._processor.generateUrl(".pdfConversionUrl",e.item):void 0}};e.prototype.getFbxConversionUrl=function(e){return"True"===e.item[".hasBxf"]&&s.canConvert(e.fileExtension)?this._processor.generateUrl(".transformUrl",e.item,"bxf"):""};e.prototype.getHtmlConversionUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"html")};e.prototype.getZipMetaDataUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"zipmetadata")};e.prototype.getDownloadZipContentsUrl=function(e){return this._processor.generateUrl(".transformUrl",e,"zipcontent")};e.prototype.getOfficeBundleGenerateUrl=function(e){if("False"!==e.item[".hasOfficePreview"]||e.item[".officeBundleGenerate"]){var t=this._processor.generateUrl(".officeBundleGenerate",e.item),n=encodeURIComponent(e.item[".ctag"]);return t&&t.replace("Generate","")+"&minVersion={{minVersion}}&cTag="+n}};e.prototype.getOfficeBundleGetFragmentUrl=function(e){if("False"!==e.item[".hasOfficePreview"]||e.item[".officeBundleGetFragment"]){var t=this._processor.generateUrl(".officeBundleGetFragment",e.item);return t&&t.replace("Get","")+"&fragment={0}"}};e.prototype.getitemUrlWithToken=function(e){var t=this._processor.getCommonProperty(".driveAccessToken");return t&&f.getItemUrlWithToken(e,t)};e.prototype.getPushChannelUrl=function(){return this._processor.getCommonProperty(".pushChannelBaseUrl")};e.prototype.getGenerateTranscriptUrl=function(e){return this._processor.getAnalyzeUrl("transcriptinit",e.item)};e.prototype.getMediaBaseUrl=function(e){return this._processor.generateUrl(".mediaBaseUrl",e.item)};return e})();t.default=p});
define("kYe",["require","exports","X_","VG","Jy","MYe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={crossDomainImageHelper:n.createResolvedResourceKey(e("module").id+".crossDomainImageHelper",s.CrossDomainImageHelper,{apiUrlHelper:r.resourceKey}),itemUrlHelper:i.resourceKey};t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:o,create:function(e){var t=new s.default(e);return{instance:t,disposable:t}}}})});
define("MYe",["require","exports","lC","Mee","u9","be"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UseThumbnailService={ODB:816,OneDrive:!0};t.ExpandThumbnailSupport={ODB:820};var o={".xls":!0,".xlsx":!0},u={".jpg":!0,".jpeg":!0,".png":!0,".gif":!0,".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},a=(function(){function e(e,t){this._apiUrlHelper=t.apiUrlHelper}e.prototype.getImageUrl=function(e){if(e.isCrossDomain){var t=this._apiUrlHelper.build().webByItemUrl(e);return(t=(t=t.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl})).segment("OpenBinaryStream")).toString()}return e.fullItemUrl};return e})();t.CrossDomainImageHelper=a;var f=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._crossDomainImageHelper=e.crossDomainImageHelper}e.prototype.getThumbnail=function(e){var t,r,i=this,s=e.fileExtension,o=void 0===s?"":s,u=e.itemKey,a=e.baseUrl,f=e.mediaServiceMetadata,l=f&&f.photo,c=f&&f.video;if(l){t=l.width;r=l.height}else if(c){t=c.frameWidth;r=c.frameHeight}var h={width:t||0,height:r||0};if(".gif"===o.toLowerCase()){var p=this._itemUrlHelper.getItemUrlParts(u),d=this._crossDomainImageHelper.getImageUrl(p),v=n.__assign({url:d},h);return n.__assign(n.__assign({},v),{getAligned:function(){return v}})}if(a){var m=f&&f.lenses;m&&m.officeLens&&(a+="&lenses=OfficeLens");return n.__assign(n.__assign({url:this._getUrl({baseUrl:a})},h),{getAligned:function(e,s){return n.__assign({url:i._getUrl({baseUrl:a,desiredSize:e,alignment:s,width:t,height:r})},h)}})}};e.prototype.canProvideThumbnail=function(e){if(!e)return!1;"."===(e=e.toLowerCase())[0]&&(e=e.substring(1));return!o[e]&&(!!s.default.isFeatureEnabled(t.UseThumbnailService)||!!s.default.isFeatureEnabled(t.ExpandThumbnailSupport)&&(!!e&&!u[e]))};e.prototype._getUrl=function(e){var t,n=e.desiredSize,s=void 0===n?{width:1024,height:1024}:n,o=e.alignment,u=e.width,a=e.height;o&&(o.name===r.coverCenter.name?t="fill":o.name===r.fitWidth.name+"-"+r.top.name&&(t="dochead"));var f={width:Math.ceil(s.width),height:Math.ceil(s.height),srcWidth:u||"",srcHeight:a||""};t&&(f.cropMode=t);return e.baseUrl+"&"+i.serializeQuery(f)};return e})();t.default=f});
define("AYe",["require","exports","X_","LYe","mv","S3"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{pageContext:s.pageContext,platformDetection:i.platformDetection})});
define("LYe",["require","exports","lC","w","e5","Z8","$8","Cv"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t){this._properties={};this._authData=void 0;this._allowCookies=!t.platformDetection.isSafari;var n=t.pageContext,r=n.env,i=n.userEmail,s=n.viewOnlyExperienceEnabled;this._env=r;this._isViewOnly=!!s;this._userID=i}e.prototype.getCommonAuthData=function(){return this._authData};e.prototype.getCommonProperty=function(e){return this._properties[e]};e.prototype.parseCommonData=function(e){o.setMicroServiceProperties(this._properties,e.data,this._env);this._authData=this._getCurrentAuthData(e.allowCookies&&this._allowCookies);return{authData:this._authData,mediaUrl:this._properties[".mediaBaseUrl"]}};e.prototype.getUniqueKey=function(){var e=this._properties[".driveUrl"]||this._properties[".driveUrlV21"],t=this._userID;return t&&e?t+"-"+e:""};e.prototype.generateUrl=function(e,t,n){return this.getNormalUrl(e,t,n)||this.getFallbackUrl(e,t,n)};e.prototype.getAnalyzeUrl=function(e,t){return o.getNormalUrl(n.__assign({".analyzeUrl":"{.mediaBaseUrl}/analyze?provider=spo&profile="+e+"&extension={.fileType}&docid={.spItemUrl}&{.driveAccessToken"+(u.default.isFeatureEnabled(s.MediaTAUseVroomV21)?"V21":"")+"}"},this._properties),".analyzeUrl",t)};e.prototype.getNormalUrl=function(e,t,n){return o.getNormalUrl(this._properties,e,t,n,this._isViewOnly,this._authData&&this._authData.supportsCookies)};e.prototype.getFallbackUrl=function(e,t,n){var r=t[e];if(r){r=r.replace("{.method}",n);for(var s=0,u=i.FALLBACK_PROPERTIES;s<u.length;s++){var a=u[s],f=t[a];".mediaBaseUrl"===a&&(f=o.fixMediaBaseUrl(f,this._env));if(!f){if(".correlationId"===a){r=r.replace("&correlationId={.correlationId}","");continue}return}".spResourceUrl"===a&&(f=encodeURIComponent(f));r=r.replace("{"+a+"}",f)}this._isViewOnly&&(r+="&nocache=true");return r}};e.prototype._getCurrentAuthData=function(e){var t=f(this._properties[".driveAccessToken"]),n=f(this._properties[".driveAccessTokenV21"]);if(n&&t){var r=new Date;return{authToken:t.authToken,proofToken:t.proofToken,tokenUrl:this._properties[".driveUrl"],authTokenV21:n.authToken,proofTokenV21:n.proofToken,tokenUrlV21:this._properties[".driveUrlV21"],timeReceived:r,expirationTime:new Date(r.getTime()+216e5),supportsCookies:e}}};return e})();t.default=a;function f(e){if(e){var t=r.deserializeQuery(e);return t&&t.access_token?{authToken:t.access_token,proofToken:t.prooftoken}:void 0}}});
define("wYe",["require","exports","rU","X_","mv","EYe","kYe","QH","gK"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=new r.ResourceKey({name:"updateThumbnailUrlCallback",factory:{dependencies:{itemTaskObserverType:a.resourceKey},create:function(e){return{instance:function(t,r){var i=new e.itemTaskObserverType;i.update(t.itemsWaitingForCookies.map(function(e){var i=e.itemKey,s=u.isFeatureEnabled(u.MediaTAUseVroomV21),o=s?r.authTokenV21:r.authToken,f=s?r.proofTokenV21:r.proofToken,l=e.thumbnailUrl+"&access_token="+o+"&prooftoken="+f,c=t.thumbnailHelper.getThumbnail({baseUrl:l,itemKey:i,fileExtension:e.fileExtension,mediaServiceMetadata:e.mediaServiceMetadata});return new a.Task(i).succeed({item:{key:i,thumbnail:n.replace(c)}})}));t.itemsWaitingForCookies.length=0;i.flush()}}}}});t.resourceKey=r.createResolvedResourceKey(e("module").id,s.default,{thumbnailHelper:o.resourceKey,platformDetection:i.platformDetection,updateThumbnailUrlCallback:f})});
define("EYe",["require","exports","lC","th","Fe","XA","be","yke","GJ","Z8"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;(function(e){e[e.Failed=-1]="Failed";e[e.None=0]="None";e[e.Pending=1]="Pending";e[e.Success=2]="Success"})(l||(l={}));var c=(function(){function e(e,t){var n=this;this._platform=t.platformDetection;this.thumbnailHelper=t.thumbnailHelper;this._updateThumbnailUrlCallback=t.updateThumbnailUrlCallback;this._cookieState=0;this._haveCookies=new r.default;this.itemsWaitingForCookies=[];this._cookieAuthData={};a.default.registerCookieChecker({isApplicable:function(e){return!(e.indexOf("access_token")>0||e.indexOf(".svc.ms/transform/thumbnail")<0)},check:function(e){var t=new r.default;n._haveCookies.getPromise().done(function(e){return t.complete(e)},function(e){return t.error(e)});return t.getPromise()}})}e.prototype.canUseCookies=function(){return!(!this._cookieAuthData.active&&1!==this._cookieState)};e.prototype.trackItem=function(e){this._cookieAuthData.active||this.itemsWaitingForCookies.push(n.__assign({},e))};e.prototype.checkCookies=function(e,t){if(-1!==this._cookieState&&t&&t.supportsCookies){this._cookieAuthData.mostRecent=t;if(1!==this._cookieState)if(this._cookieAuthData.active){if(this._cookieAuthData.active!==t){var n=Date.now()-this._cookieAuthData.active.timeReceived.getTime();if(n>432e5){this._haveCookies=new r.default;this._cookieAuthData.active=void 0}n>72e5&&this._updateCookies(e,t)}}else this._updateCookies(e,t)}};e.prototype._updateCookies=function(e,t){var n=this,r=0===this._cookieState;this._cookieState=1;this._makeImageRequest(e,t,r).then(function(){n._cookieAuthData.active=t;n._cookieState=2;n.itemsWaitingForCookies.length=0;n._haveCookies.complete(!0)},function(){n._cookieState=-1;n._updateThumbnailUrls(t);n._haveCookies.error(!1)})};e.prototype._makeCorsRequest=function(e,t){var n,r=this;e+="/Auth/SetCookies?provider=spo";var s=o.default.isFeatureEnabled(f.MediaTAUseVroomV21),u=s?t.authTokenV21:t.authToken,a=s?t.proofTokenV21:t.proofToken;if(this._platform.isIE&&this._platform.browserMajor<=10){e+="&access_token="+u;e+="&prooftoken="+a}else n={spo_access_token:u,spo_prooftoken:a};return this.sendCorsRequest(e,n).then(function(t){if(!t.isOldCookiePresent)return r.sendCorsRequest(e,n).then(function(e){if(!e.isOldCookiePresent)return i.default.wrapError("Cookie request succeeded, but the cookies are not actually being set")})})};e.prototype.sendCorsRequest=function(e,t){return s.default.start({withCredentials:!0,url:e,headers:t,method:"POST"}).then(function(e){var t;try{t=JSON.parse(e.responseText)}catch(e){}return t||i.default.reject("Expected response object but received nothing")})};e.prototype._makeImageRequest=function(e,t,n){var r=o.default.isFeatureEnabled(f.MediaTAUseVroomV21),i=r?t.authTokenV21:t.authToken,s=r?t.proofTokenV21:t.proofToken;e+="/Auth/SetCookiesImg?provider=spo";e+="&access_token="+i;e+="&prooftoken="+s;return u.request(e).then(function(){if(n)return u.request(e+"&throwOnMissingCookies=true")})};e.prototype._updateThumbnailUrls=function(e){this.itemsWaitingForCookies.length&&this._updateThumbnailUrlCallback(this,e)};return e})();t.default=c});
define("CYe",["require","exports","X_","OYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{})});
define("OYe",["require","exports","Iv","Dv","SK"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=t.dataStoreType,s=void 0===i?n.default:i;this._dataStore=new s("MediaAuthStore",r.default.session)}e.prototype.getToken=function(e,t){if(e){var n=this._dataStore.getValue(e);if(n&&!i.isTokenExpired(n,36e5))return n;this._dataStore.setValue(e,t)}return t};return e})();t.default=s});
define("bK",["require","exports","lC","Fe","E","xK","BH","X_","re","yK","gK","S3","yh","Jy"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t)||this;r._itemTaskObserverType=n.itemTaskObserverType;r._itemUrlHelper=n.itemUrlHelper;r._listItemResultProcessor=n.listItemResultProcessor;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;return r}t.prototype.getAuthToken=function(e){var t=this;if(!this._pageContext.isSPO)return r.default.reject(new Error("getAuthToken is not supported OnPrem"));var o=new s.SPListItemRetriever({pageContext:this._pageContext}),u=e&&e.key||this._urlDataSource.getRootItemKey(),f=this._itemUrlHelper.getItemUrlParts(u),l=this._itemUrlHelper.getUrlParts({path:f.serverRelativeListUrl,listUrl:f.fullListUrl}),c=a.getViewXml({pageSize:1}),h={parentKey:u,postDataContext:{viewXml:c,needsSchema:!0,isListDataRenderOptionChangeFeatureEnabled:!0},skipServiceWorkerCache:!0},p={urlParts:l},d={qosEvent:new i.Qos({name:"FetchAuthToken"}),qosName:"AuthToken.GetData"};return o.getItem(h,p,d).then(function(e){var r=new t._itemTaskObserverType;t._listItemResultProcessor.processResponse({response:n.__assign(n.__assign({},e),{ListData:n.__assign(n.__assign({},e.ListData),{Row:[]})}),requestKey:u,observer:r});r.flush();if(e&&e.ListSchema)return{data:e.ListSchema,allowCookies:!1}})};t.dependencies=n.__assign(n.__assign({},o.default.dependencies),{itemTaskObserverType:l.resourceKey,itemUrlHelper:p.resourceKey,listItemResultProcessor:f.resourceKey,pageContext:c.pageContext,urlDataSource:h.url});return t})(o.default);t.default=d;t.resourceKey=u.createResolvedResourceKey(e("module").id,d)});
define("xK",["require","exports","lC","CK"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("CK",["require","exports","lC","V7","re","nk","Fe","E","Ih","de","E","be"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1201};t.GROUPINGID_NEXT="__next__";var p=(function(e){n.__extends(s,e);function s(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}s.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var u=t.remoteItem&&c.default.isFeatureEnabled(h)?this._getRemoteItemPostData():this.getAdditionalPostData(t.postDataContext,n);return e.prototype.getData.call(this,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,function(){return u},"POST",this._getListRequestHeaders(t,n),void 0,void 0,void 0,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0,t.authToken).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return o.default.reject(e)})};s.prototype.getUrl=function(e,t){var n,i=t&&t.postDataContext;n=c.default.isFeatureEnabled(h)?{webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId}:{webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath,isOnePageNavigation:t.isOnePageNavigation};if(this._isSpecifiedItemRequest(e))n.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||i&&i.isOnePage)&&e.viewIdForRequest!==f.default.Empty&&(n.view=e.viewIdForRequest);!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(n.filterParams=e.filterParams);if(e.sortField){n.sortField=e.sortField;n.sortDir="false"===e.isAscending?"Desc":"Asc"}i&&i.groupReplace?n.requestToken=this._isExpandingGroup(n)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||i&&i.groupReplace||(n.groupString=e.group.groupString);i&&i.webId&&(n.webId=i.webId)}return r.getListDataUrl(n)};s.prototype.getAdditionalPostData=function(e,t){return i.getAdditionalPostData(e,t)};s.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};s.prototype._getListRequestHeaders=function(e,t){var n=r.getListRequestHeaders(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};s.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};s.prototype._isExpandingGroup=function(e){return e.group&&e.group.groupingId!==t.GROUPINGID_NEXT};s.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};s.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};s.prototype._telemetryHandler=function(e){var t=e.errorData,r=n.__assign({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;r.resultType=l.ResultTypeEnum.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;r.resultType=l.ResultTypeEnum.ExpectedFailure}}else s=r.resultCode;r.resultCode=s;return{canRetry:i,eventData:r}}return{eventData:r}};s.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?a.default.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&a.default.logData({name:e+".LookupColumnTreshold"})};return s})(s.default);t.SPListItemRetriever=p;t.default=p});
define("JQ",["require","exports","lC","ph","Xx","rs","hK","DK","X_","yh","Re"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new a.ResourceKey({name:e("module").id,factory:{dependencies:{vroomUrlHelper:u.resourceKey,authTokenFetcher:o.resourceKey,graphDataSource:f.graph},create:function(e){var t=e.vroomUrlHelper,o=e.authTokenFetcher,u=e.graphDataSource;return{instance:function(e,a,f){var c=this;return function(e){return n.__awaiter(c,void 0,void 0,function(){var c,h,p,d,v,m,g;return n.__generator(this,function(n){switch(n.label){case 0:c=f&&t.getUrlParts(f);if(!(h=c&&c.driveId)&&!l.default.isActivated("8166AF21-A682-4F83-8DA3-3F57848BCE82","6/22/2020","Avoid fetching tokens if driveId is unknown"))return[2,void 0];p=r.driveItemKeyFacet.serialize({endpoint:a,driveId:h,itemId:"root"});d=e(s.readItems(function(e){return e.demandItemFacet(i.knockoutStoreItemFacet,p)}));return(v=d&&d.peek())?[4,o.ensureAuthToken(v.key)]:[3,3];case 1:n.sent();m=f&&f.indexOf("/v2.1")>-1;return[4,u.getAccessToken(v,{apiVersion:m?"v2.1":"V2.0"})];case 2:if((g=n.sent())&&(l.default.isActivated("A1EECBC8-4B38-491F-8F2D-311D6F192CB3","6/16/2020","Validate drive URL for token auth")||!g.tokenUrl&&!f||g.tokenUrl===f))return[2,g.accessToken];n.label=3;case 3:return[2]}})})}}}}}})});
define("hK",["require","exports","Fe","X_","rK","OK","bK","S3","Jy","yx","QH","Re"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=c.default.isActivated("D349E556-140B-4BFA-8B14-5DD337AAFB41","7/2/2020","Use per-list store for MicroServiceDataSource"),p=l.isFeatureEnabled(l.UseSelfIssuedTokenForSPOWebAuth)&&l.isFeatureEnabled(l.UseIdentityAuthForVroom),d=(function(){function e(e,t){this._authTokenDataSource=t.authTokenDataSource;this.itemUrlHelper=t.itemUrlHelper;this._pageContext=t.pageContext;this._microServiceDataSource=t.microServiceDataSource;this._microServiceDataSourceStore=t.microServiceDataSourceStore;this._pendingListResponse=t.pendingListResponse;this._getAuthTokenPromises={}}e.prototype.ensureAuthToken=function(e){var t=this;return n.default.resolve().then(function(){var e=t._pendingListResponse.response;if(e)return e}).then(function(){var r=h?void 0:t._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(e);return p||(!r||r.hasAuthData()&&!r.hasAuthDataExpired())&&t._microServiceDataSource.hasAuthData()&&!t._microServiceDataSource.hasAuthDataExpired()?n.default.wrap(void 0):t._pageContext.isSPO?t._getAuthTokenWithDebounce(e).then(function(i){if(!i)return n.default.wrapError("The list response did not contain a list schema value.");r&&r.setBaseInfo(i);t._microServiceDataSource.setBaseInfo(i);var s=h?"":e;delete t._getAuthTokenPromises[s]}):n.default.resolve()})};e.prototype.getAuthToken=function(e){return p?n.default.reject(new Error("AuthTokenFetcher: drive tokens should no longer be used")):this._pageContext.isSPO?this._authTokenDataSource.getAuthToken({key:e}):n.default.reject(new Error("getAuthToken is not supported OnPrem"))};e.prototype._getAuthTokenWithDebounce=function(e){var t=h?"":e;return this._getAuthTokenPromises[t]||(this._getAuthTokenPromises[t]=this.getAuthToken(e))};return e})();t.default=d;t.resourceKey=r.createResolvedResourceKey(e("module").id,d,{authTokenDataSource:o.resourceKey,itemUrlHelper:a.resourceKey,pageContext:u.pageContext,microServiceDataSource:i.resourceKey,microServiceDataSourceStore:s.resourceKey,pendingListResponse:f.resourceKey})});
define("UYe",["require","exports","lC","X_","li","YS","HOe","XOe","rs","YD","Xx","LO","I","Uo","BH","To","Jr","Rs","Gm","PA","TA","S0","si","MA","ii","Fe","Se","LA"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{singleFileUploaderType:o.typeResourceKey,html5FileUploadType:u.typeResourceKey,observablesFactoryType:d.observablesFactoryTypeResourceKey},create:function(e){var t=e.singleFileUploaderType,r=e.html5FileUploadType,o=e.observablesFactoryType;return{instance:function(e){var u=this,d=e.itemKey,A=e.options.sourceEntries,O=i.spItemKeyFacet.deserialize(d),M=O.webAbsoluteUrl,_=O.listFullUrl,D=O.rootFolder,P=Object.keys(A)[0],H=A[P],B=H.progressItemKey,j=H.conflictResolution;return function(A){return n.__awaiter(u,void 0,void 0,function(){var u,O,H,F=this;return n.__generator(this,function(I){switch(I.label){case 0:u=A(a.readItems(function(e){return{folderPath:e.demandItemFacet(T.folderPathFacet,d)}})).folderPath,O=void 0===u?D:u;H=new C.SimpleUri(_).path+"/Forms";return!!O&&O.slice(0,H.length)===H?[4,A(k.uploadListItem(e))]:[3,2];case 1:return[2,I.sent()];case 2:return[4,h.withScope(function(e){return n.__awaiter(F,void 0,void 0,function(){var u,h,C,k,O,D,H,F,I,q,R,U,z,W,X,V,$;return n.__generator(this,function(J){switch(J.label){case 0:return[4,A(f.demandItems(function(e){return{storeItem:e.demandItemFacet(l.knockoutStoreItemFacet,d)}}))];case 1:u=J.sent().storeItem;h=A(a.readItems(function(e){return{sourceFile:e.demandItemFacet(c.sourceFileFacet,P)}})).sourceFile;if(!(C=u&&u.peek()))throw new b.UploadError({message:"No parent item available for upload.",errorType:w.UploadErrorType.general,code:"ClientMissingParentItem"});if(!h)throw new b.UploadError({message:"No source file for upload.",errorType:w.UploadErrorType.general,code:"ClientMissingSourceFile"});k=e.attach(new r({file:h}));O="replace"===j?1:0;D=e.attach(new t({nameConflictBehavior:O,fileUpload:k,parentItem:C,metadata:{},qosContext:{scenario:"ItemsScope.Upload",folderUpload:!0,wasDraggedAndDropped:!1}}));B&&A(m.resolveItems({items:(V={},V[B]=n.__assign({},y.progressSizeFacet.pack({total:h.size,current:0})),V)}));H=e.attach(new o);F=new p.Signal;H.backgroundCompute(function(){var e,t=D.uploadedBytes();B&&A(m.resolveItems({items:(e={},e[B]=S.pack({progressSize:y.progressSizeFacet},{progressSize:{current:t}}),e)}))}).extend({rateLimit:{timeout:300}});H.backgroundCompute(function(){var e=D.state.peek();2===e?F.resolve():4===e?F.reject(D.error.peek()||new b.UploadError({message:"Unknown upload error.",errorType:w.UploadErrorType.general,code:"ClientUnknown"})):3===e?F.reject(new v.CancelError):D.state()});D.start().catch();(I=A(a.readItems(function(e){return e.demandItemFacet(y.cancelSourceFacet,B)})))&&e.attach({dispose:I.token.subscribe(function(){D.abort()})});J.label=2;case 2:J.trys.push([2,4,,5]);return[4,F.promise];case 3:J.sent();return[3,5];case 4:if((q=J.sent())instanceof v.CancelError)throw q;if(N.default.isCanceled(q))throw new v.CancelError;if(q instanceof b.UploadError)throw new s.UploadItemOperationError({facets:L(q),innerError:q});if(x.isErrorData(q))throw new s.UploadItemOperationError({facets:n.__assign(n.__assign({},"-2130575257"===q.code?n.__assign({},E.conflictErrorFacet.pack({supportsRename:!1})):n.__assign({},E.retryErrorFacet.pack({}))),T.spErrorDataFacet.pack(q)),message:x.getErrorMessage(q)});throw q;case 5:if(!(R=D.item.peek()))throw new b.UploadError({message:"No item created during upload.",errorType:w.UploadErrorType.general,code:"ClientNoCreatedItem"});U=R.properties;z=U&&U.ID;W=U&&U.uniqueId;if(!z)throw new b.UploadError({message:"No item id determined after upload.",errorType:w.UploadErrorType.general,code:"ClientNoAssignedItemId"});X=i.spItemKeyFacet.serialize({webAbsoluteUrl:M,listFullUrl:_,itemId:z});A(m.resolveItems({items:($={},$[X]=n.__assign(n.__assign(n.__assign(n.__assign({},T.folderPathFacet.pack(R.id)),g.displayNameFacet.pack(R.displayName)),W?T.uniqueIdFacet.pack(W):{}),g.parentFolderItemFacet.pack({itemKey:d})),$)}));return[2,{itemKey:X}]}})})})];case 3:return[2,I.sent()]}})})}}}}}});function L(e){switch(e.errorType){case w.UploadErrorType.conflict:return n.__assign({},E.conflictErrorFacet.pack({supportsRename:!1}));case w.UploadErrorType.accessDenied:return n.__assign({},E.accessDeniedErrorFacet.pack({}));case w.UploadErrorType.disconnected:return n.__assign({},E.offlineErrorFacet.pack({}));case w.UploadErrorType.emptyFileOrFolder:case w.UploadErrorType.emptyFileOrFolderForDocLib:return n.__assign({},E.emptyFolderUnsupportedFacet.pack({}));case w.UploadErrorType.folderUploadNotSupported:return n.__assign({},E.folderUploadUnsupportedFacet.pack({}));case w.UploadErrorType.invalidName:return n.__assign({},E.invalidNameErrorFacet.pack({}));case w.UploadErrorType.lockMismatch:return n.__assign({},E.lockMismatchErrorFacet.pack({}));case w.UploadErrorType.malwareDetected:return n.__assign({},E.malwareErrorFacet.pack({}));case w.UploadErrorType.overQuota:return n.__assign({},E.overQuotaErrorFacet.pack({}));case w.UploadErrorType.targetFolderMissing:return n.__assign({},E.targetFolderErrorFacet.pack({}));case w.UploadErrorType.throttled:return n.__assign({},E.throttleErrorFacet.pack({}));case w.UploadErrorType.versionMismatch:return n.__assign({},E.versionMismatchFacet.pack({}))}return n.__assign({},E.retryErrorFacet.pack({}))}});
define("HOe",["require","exports","lC","de","th","Fe","E2","P3","Zve","X0","X_","TA","KOe","ai","BH","QH","vK","VOe","gD","NOe","Re","S3","ROe","Wve","yh","sX","VG","Jy","E3","W7e","BG","gK"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=v.isFeatureEnabled(v.SPOODBWebUploadChecksum)&&"undefined"!=typeof Worker,D=!w.default.isActivated("44BB59BD-B756-45D2-945E-4C9B1AACEB42","9/1/2020","Switch back the odsp-next version of the SharePoint uploader.")?h.SharePointUploader:b.SharePointUploader,P=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._handleFailure=function(e){if(3===r.state.peek())return s.default.reject(e);var t=r._getItemKey();if(e.errorType!==c.UploadErrorType.conflict){r._itemTaskObserver.update([new m.default(t).succeed({item:{key:t,state:{upload:{status:4}}}})]);r._itemTaskObserver.flush()}r.item(r._itemTaskObserver.getItem({key:t}));r.error(e);r.state(4);return s.default.reject(e)};var i=t.fileUpload,o=t.parentItem,u=t.metadata,a=t.isTemplate,l=t.nameConflictBehavior;r._parentItem=o;r._fileUpload=i;r._isTemplate=!!a;if(_){var h="undefined"!=typeof __webpack_public_path__?__webpack_public_path__+"hasher.worker.js":window.require.toUrl("hasher.worker.js"),p=n.workerDataSource.getWorkerUrl(h);r._hasher=new g.FileHasher(p);r.addDisposable(r._hasher)}r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;r._itemParentHelper=n.itemParentHelper;r._itemUrlHelper=n.itemUrlHelper;r._apiUrlHelper=n.apiUrlHelper;r._throttler=n.uploadThrottler;r._dataRequestor=new n.dataRequestorType({qosName:"SingleFileUploader"});var d=Number(r._pageContext.webTemplate)===f.default.mySite;r.totalBytes=r.createObservable(i.size);r.uploadedBytes=r.createObservable(0);r.fileName=r.createObservable(i.name);r.iconName=r.createObservable(i.iconName);r.state=r.createObservable(0);r.error=r.createObservable();r.nameConflictBehavior=r.createObservable(l||0);r.allowRename=!1;r.supportsVersioning=!0;r.item=r.createObservable();r._uploadMetadata=u;r._itemTaskObserver=new n.itemTaskObserverType;var v=r._itemUrlHelper.getItemUrlParts(r._parentItem.key),y=r._apiUrlHelper.build().webByItemUrl(v);r.sharePointUploader=new D({webApiUrl:y,hasher:r._hasher,fileUpload:i,throttler:r._throttler,canStream:r._canStream(),dataRequestor:r._dataRequestor,itemExpansion:r._getExpansionValue(),destinationUrl:r._getDestinationUrl(),nameConflictBehavior:l,appName:d?"OdbWeb":"SpDocLibWeb",onStart:function(){r.error(void 0);r.state(1)},onAbort:function(){var e=r.item.peek().key;r._itemTaskObserver.update([new m.default(e).succeed({item:{key:e,state:{upload:{status:3}}}})]);r._itemTaskObserver.flush();r.item(r._itemTaskObserver.getItem({key:e}))},onProgress:function(e){r.uploadedBytes(e)}});return r}t.prototype.start=function(){var e=this;this.state(0);var t=this._getItemKey();this._itemTaskObserver.update([new m.default(t).succeed({item:{key:t,state:{upload:{status:1}}}})]);this._itemTaskObserver.flush();this.item(this._itemTaskObserver.getItem({key:t}));return this.sharePointUploader.upload().then(function(t){return e._finshUpload(t)},this._handleFailure)};t.prototype.abort=function(){this.error(void 0);this.state(3);this.sharePointUploader.abort()};t.prototype.restart=function(){var e=this;this.sharePointUploader.restart({nameConflictBehavior:this.nameConflictBehavior.peek()}).then(function(t){return e._finshUpload(t)},this._handleFailure)};t.prototype._canStream=function(){return!this._pageContext.blockDownloadsExperienceEnabled&&!!(this._parentItem&&this._parentItem.permissions||u.PermissionMask.hasItemPermission(this._parentItem,u.PermissionMask.editListItems))};t.prototype._finshUpload=function(e){var t=this,n=this._transformItem(e);this.item(n);var r=this._getItemKey();return this._updateMetadata(n).then(function(){if(!t._uploadMetadata||!t._uploadMetadata.group){t._itemTaskObserver.update([new m.default(r).succeed({item:{key:r,state:{upload:{status:2}}}})]);t._itemTaskObserver.flush();t.item(t._itemTaskObserver.getItem({key:r}))}t.state(2)},this._handleFailure)};t.prototype._transformItem=function(e){var t=this._getItemKey(),n=void 0;e.ListItemAllFields&&e.ListItemAllFields.Id&&(n=String(e.ListItemAllFields.Id));var i=!1;if(e.ListItemAllFields&&e.ListItemAllFields.ContentType&&e.ListItemAllFields.ContentType.Fields&&e.ListItemAllFields.ContentType.Fields.results){var s=e.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(s.length>0)for(var u=0,a=s;u<a.length;u++){var f=a[u];if(!e.ListItemAllFields[f.InternalName]){i=!0;break}}}var l=e.UniqueId?r.default.normalizeLower(e.UniqueId):"",c=e.Name,h=o.getFileExtension(c),p=this._itemTaskObserver;p.update([new m.default(t).succeed({item:{key:t,parentKey:this._parentItem.key,type:y.default.File,id:e.ServerRelativeUrl,name:c,displayName:c,extension:h,properties:{ID:n,uniqueId:l},itemFromServer:e,hasMissingMetadata:i,graph:{driveId:e.VroomDriveID,itemId:e.VroomItemID}}})]);p.flush();return p.getItem({key:t})};t.prototype._getDestinationUrl=function(){var e=this._itemUrlHelper.getItemUrlParts(this._parentItem.key),t=e.serverRelativeListUrl+"/Forms";return v.isFeatureEnabled(v.NewDocumentTemplates)&&this._isTemplate?t:e.serverRelativeItemUrl||""};t.prototype._getExpansionValue=function(){var e="ListItemAllFields",t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._parentItem,"list"));if(t){var n=t.list;n&&n.contentTypesEnabled&&n.templateType!==p.default.mySiteDocumentLibrary&&(e="ListItemAllFields/ContentType/Fields")}return e};t.prototype._updateMetadata=function(e){var t;if(this._uploadMetadata&&this._uploadMetadata.group){var n=new i.default;this._updateItem(e,n);t=n.getPromise()}else t=s.default.wrap();return t};t.prototype._updateItem=function(e,t){if(!this._uploadMetadata||!this._uploadMetadata.group)return s.default.wrap();var n=this._uploadMetadata,r=this.resources.consume(A.resourceKey),i={item:N.convertToISPListItem(e),fields:(function(){for(var e=[],t=n.group;t;){var r=t.fieldValue,i=t.fieldSchema;e.push({data:r,serverData:null,state:0,hasException:!1,errorMessage:"",schema:i});t=n.itemGroups&&Array.isArray(n.itemGroups)?x.convertGroup(a.default.getParent(t,n.itemGroups)):void 0}return e})(),formType:1};return r.updateItem({clientForm:i,newDocumentUpdate:!1}).then(function(){t.complete()},function(e){t.error(e)})};t.prototype._getItemKey=function(){var e,t=this._itemUrlHelper.getItemUrlParts(this._parentItem.key),n=t.serverRelativeItemUrl,r=t.normalizedListUrl,i=n+"/"+this._fileUpload.name;return this._urlDataSource.getKey(((e={}).id=i,e.listurl=r||"",e))};t.dependencies=n.__assign(n.__assign({},d.default.dependencies),{urlDataSource:T.url,itemParentHelper:O.resourceKey,itemUrlHelper:k.resourceKey,apiUrlHelper:C.resourceKey,dataRequestorType:L.typeResourceKey,itemTaskObserverType:M.resourceKey,pageContext:E.pageContext,workerDataSource:T.worker,uploadThrottler:S.resourceKey});return t})(d.default);t.SingleFileUploader=P;t.typeResourceKey=l.createResolvedTypeResourceKey(e("module").id,P)});
define("KOe",["require","exports","lC","de","Oh","th","Fe","N1","E","Ms","TA","WOe","Fv","WOe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(){function e(e){var t=e.hasher,n=e.throttler,s=e.dataRequestor,o=e.appName,u=e.webApiUrl,f=e.authToken,l=e.canStream,c=e.fileUpload,h=e.itemExpansion,p=e.destinationUrl,d=e.qosEvent,v=void 0===d?a.Qos:d,m=e.nameConflictBehavior,g=void 0===m?0:m,y=e.onStart,b=e.onAbort,w=e.onProgress;this._hasher=t;this._dataRequestor=s;this._throttler=n;this._chunkNumber=0;this._uploadedBytes=0;this._qosEvent=v;this._id=r.default.generate();this._authToken=f;this._canStream=l;this._webApiUrl=u;this._fileUpload=c;this._async=new i.default(this);this._itemExpansion=h;this._destinationUrl=p;this._nameConflictBehavior=g;this._chunkSize=Math.min(c.size,262144e3);this._trackingHeaders={Application:o,Scenario:"UploadFile",ScenarioType:"AUO"};this._onStart=y;this._onAbort=b;this._onProgress=w}e.prototype.upload=function(){var e=this,t=this._throttler.throttle(function(){var t=e._id,n=e._fileUpload.size,r=e._canStream&&n>25165824,i={fileUploadId:t,size:n},s=new e._qosEvent({name:"Upload.h5",extraData:i}),p=r?"SharePointUploader.stream":"SharePointUploader.create",d=new e._qosEvent({name:p,extraData:i});e._onStart&&e._onStart();return e.start(r).then(function(e){s.end({resultType:a.ResultTypeEnum.Success});d.end({resultType:a.ResultTypeEnum.Success});return e},function(t){var n=o.default.isCanceled(t),r=c.wrapError(t),i=c.convertToUploadError(r);if(n||i.code===h.requestAborted){s.end({resultType:a.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"});d.end({resultType:a.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"});e._onAbort&&e._onAbort()}else{var p=c.isErrorTypeExpected(r)?a.ResultTypeEnum.ExpectedFailure:a.ResultTypeEnum.Failure;s.end(u.mergeQosEndSchema(f.getQosEndSchemaFromError(i),{resultType:p,resultCode:l.UploadErrorType[i.errorType]}));d.end(u.mergeQosEndSchema(f.getQosEndSchemaFromError(r),{resultType:p,extraData:{uploadedBytes:e._uploadedBytes}}))}return o.default.reject(i)})});this._uploadPromise=t;return t};e.prototype.abort=function(){var e=this,t=this._uploadPromise;this._uploadPromise=void 0;if(!this._hasCompleted&&t){t.cancel();t.then(function(){},function(){}).done(function(){e._hasher&&e._hasher.dispose();return e.cancelUpload()})}};e.prototype.restart=function(e){var t=e.nameConflictBehavior,n=void 0===t?this._nameConflictBehavior:t;this._nameConflictBehavior=n;var r=this._uploadPromise;this._uploadPromise=void 0;r&&r.cancel();this._hasher&&this._hasher.reset();return this.upload()};e.prototype.dispose=function(){this._async.dispose();this._hasher&&this._hasher.dispose()};e.prototype.start=function(e){var t=this;this._uploadedBytes=0;var n=this._fileUpload.size;return(e?this.streamFile():this.uploadFile()).then(function(e){t.updateProgress(n);return e})};e.prototype.updateProgress=function(e){if(this._uploadedBytes!==e){this._uploadedBytes=e;this._onProgress&&this._onProgress(e)}};e.prototype.getUploadUrl=function(e){var t=this._webApiUrl;t=(t=t.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");var n={};n.DecodedUrl=this._fileUpload.name;n.overwrite=1===this._nameConflictBehavior;n.AutoCheckoutOnInvalidData=!0;e&&(n.XorHash=e);t=t.methodWithAliases("AddUsingPath",n).oDataParameter("$Select","VroomItemID");this._itemExpansion&&(t=t.oDataParameter("$Expand",this._itemExpansion));return t.toString()};e.prototype.uploadFile=function(e){var t=this;void 0===e&&(e=3);var n=this._fileUpload.slice(0,this._fileUpload.size);return(this._hasher&&!this._hasher.hasFullHash()?this._hasher.computeHash(n,0,n.size):o.default.resolve()).then(function(){var r=t._hasher?t._hasher.getFullHash(n.size):void 0,i=t._hasher?"UploadFileWithChecksum":"UploadFile";return t.uploadChunk({trackSpeed:!1,url:t.getUploadUrl(r),qosName:i,data:n,offset:0,length:n.size}).then(function(e){return t.parseItemResponse(e)}).catch(function(n){if(o.default.isCanceled(n))return o.default.wrapError(n);if(n&&n.retryAfter&&e>0){var r=1e3*n.retryAfter;return t._throttler.addThrottleTimer(r).then(function(){t._uploadedBytes=0;return t.uploadFile(e-1)})}return o.default.wrapError(c.createError(n,p.UploadStage.singleChunk))})})};e.prototype.getStreamingUrl=function(e,t,n,r){var i,s=this._webApiUrl,o=this._fileUpload.name,u={uploadId:{guid:this._requestId}};if(n===p.UploadStage.start){i="StartUpload";s=(s=s.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");s=1===this._nameConflictBehavior?s.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:o}):s.methodWithAliases("AddStubUsingPath",{DecodedUrl:o})}else{if(n===p.UploadStage.finish){i=this._hasher?"FinishUploadWithChecksum":"FinishUpload";s=s.oDataParameter("$Expand","ListItemAllFields")}else i="ContinueUpload";s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+o});u.fileOffset=e;r&&n===p.UploadStage.finish&&(u.checksum=r)}return(s=s.methodWithAliases(i,u)).toString()};e.prototype.streamFile=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._requestId||(this._requestId=r.default.generate());var i=this._fileUpload.size,u=this._chunkNumber>0?Math.min(this._chunkSize+e,i):0,a=this._fileUpload.slice(e,u),f=0===this._chunkNumber?p.UploadStage.start:i<=u?p.UploadStage.finish:p.UploadStage.continue,l=f===p.UploadStage.start,h=f===p.UploadStage.finish,d="SendFileRequest"+(l?".Start":h?this._hasher?".FinishWithChecksum":".Finish":".Continue"),v=this._hasher&&f!==p.UploadStage.start&&!this._hasher.hasFullHash()&&this._hasher?this._hasher.computeHash(a,e,u):o.default.resolve();return(h?v:o.default.resolve()).then(function(){var r=void 0;n._hasher&&h&&(r=n._hasher.getFullHash(i));return n.uploadChunk({trackSpeed:!0,url:n.getStreamingUrl(e,u,f,r),qosName:d,data:a,offset:e,length:a.size}).then(function(e){n.updateProgress(u);if(u<i){n._chunkNumber++;return v.then(function(){return n.streamFile(u)})}return n.parseItemResponse(e)},function(r){if(o.default.isCanceled(r)){f!==p.UploadStage.start&&n.cancelUpload();return o.default.reject(r)}if(c.shouldLowerChunkSize(r)){if(n._chunkSize<=1048576){n.cancelUpload();return o.default.reject(c.createError(r,f))}n._chunkSize=Math.floor(n._chunkSize/2);return n.streamFile(e,t)}if(t>0&&c.canRetry(r,f)){var i,u=new s.default(function(){i&&n._async.clearTimeout(i)});i=n._async.setTimeout(function(){return u.complete()},1e3);return u.getPromise().then(function(){return n.getUploadStatus().then(function(e){return n.streamFile(e,t-1)},function(){return n.streamFile(e,t-1)})})}f!==p.UploadStage.start&&n.cancelUpload();return o.default.reject(c.createError(r,f))})},function(e){f!==p.UploadStage.start&&n.cancelUpload();return o.default.reject(e)})};e.prototype.getUploadStatus=function(){var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileUpload.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:this._requestId}}).toString();return this._dataRequestor.getData({url:e,method:"GET",noRedirect:!0,authToken:this._authToken,qosName:"GetUploadStatus",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},telemetryHandler:function(e){var t=e.eventData,r=e.response;if(t.resultType===a.ResultTypeEnum.Success){if(!r||!r.d||!r.d.ExpectedContentRange)return{eventData:n.__assign(n.__assign({},t),{resultCode:"NoContentRange",resultType:a.ResultTypeEnum.Failure})};var i=parseInt(r.d.ExpectedContentRange.split("-")[0],10);if(isNaN(i))return{eventData:n.__assign(n.__assign({},t),{resultCode:"NaNContentRange",resultType:a.ResultTypeEnum.Failure,error:r.d.ExpectedContentRange})}}return{eventData:t}}}).then(function(e){if(e.d&&e.d.ExpectedContentRange){var t=parseInt(e.d.ExpectedContentRange.split("-")[0],10);return isNaN(t)?o.default.reject(""):t}return o.default.reject("")})};e.prototype.cancelUpload=function(){if(!this._requestId)return o.default.resolve();var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileUpload.name}).methodWithAliases("CancelUpload",{uploadId:{guid:this._requestId}}).toString();this._requestId="";this._chunkNumber=0;return this._dataRequestor.getData({url:e,noRedirect:!0,authToken:this._authToken,qosName:"CancelUploadSession",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id}}).then(function(){})};e.prototype.uploadChunk=function(e){var t,n,r,i,o=this,u=e.url,a=e.qosName,f=e.data,l=e.offset,h=e.length,p=new s.default(function(){t.cancel()}),d=function(e){var t=o._chunkNumber>0&&l+h>=o._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&o._async.clearTimeout(n);e&&(n=o._async.setTimeout(function(){p.error({code:""+c.clientErrorCodes.timeout,message:""})},r))},v=Date.now(),m=Date.now(),g=0,y=0,b=0,w=this._async.debounce(function(e){e>o._uploadedBytes&&o.updateProgress(e)},100,{leading:!1});t=this._dataRequestor.getData({url:u,qosName:a,noRedirect:!0,authToken:this._authToken,additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:f,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();y+=(e.loaded-g)/(t-m);b++;r=e.loaded/(t-v);m=t;g=e.loaded;w(l+e.loaded);d(h-e.loaded)}}});d(h);e.trackSpeed&&(i=this._async.setInterval(function(){if(b){Date.now()-v+(h-g)/((y+r)/(b+1))>15e4&&g<h&&p.error({code:""+c.clientErrorCodes.tooSlow,message:""})}},1e4));t.done(function(e){p.complete(e)},function(e){p.error(e)});p.getPromise().done(function(){n&&o._async.clearTimeout(n);i&&o._async.clearInterval(i)},function(){t.cancel();n&&o._async.clearTimeout(n);i&&o._async.clearInterval(i)});return p.getPromise()};e.prototype.parseItemResponse=function(e){try{return JSON.parse(e).d}catch(e){}};return e})();t.SharePointUploader=d});
define("WOe",["require","exports","lC","v","TA","PA","Fv","qOe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;t.clientErrorCodes={unknown:"UNKNOWN_UPLOAD_ERROR",timeout:"UPLOAD_TIMEOUT_ERROR",tooSlow:"UPLOAD_TOO_SLOW_ERROR"};(function(e){e[e.singleChunk=0]="singleChunk";e[e.start=1]="start";e[e.continue=2]="continue";e[e.finish=3]="finish";e[e.status=4]="status";e[e.cancel=5]="cancel"})(a=t.UploadStage||(t.UploadStage={}));var f=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,n.__assign(n.__assign({},t),{extraData:n.__assign(n.__assign({},t.extraData||{}),"number"==typeof t.statusCode?{status:t.statusCode}:{})}))||this;r.errorType=t.errorType;r.displayString=t.displayString;try{r.serverError=JSON.stringify(t.serverError)}catch(e){r.serverError=""}return r}return t})(r.ApiError);t.UploadFragmentError=f;function l(e){if(e&&e.code){return e.code.split(",")[0]||e.code}return e&&e.number?""+e.number:t.clientErrorCodes.unknown}t.shouldLowerChunkSize=function(e){var n=l(e);return n===t.clientErrorCodes.tooSlow||n===t.clientErrorCodes.timeout||!!e&&0===e.status};t.canRetry=function(e,t){if(429===e.status)return!1;if(404===e.status&&(t===a.start||t===a.singleChunk))return!1;switch(l(e)){case o.requestAborted:case"-1":case"-2130575257":case"-2130575142":case"-2130209002":case"-2130209003":case"-2147023080":case"-2130575245":return!1;default:return!0}};t.createError=function(e,n){if(!e)return new f({errorType:i.UploadErrorType.general,code:"Unknown",statusCode:0,message:"Unknown upload error",serverError:e});var r,s,u=!1,c=l(e);if("string"==typeof e)r=e;else{var h=e.message;if("string"==typeof h)r=h;else if(h&&h.value){r=h.value;u=!0}}var p=e&&e.code||"Unhandled client error";if(c===o.offline){p="Disconnected";s=i.UploadErrorType.disconnected}else s="-2130575257"===c?i.UploadErrorType.conflict:c===t.clientErrorCodes.timeout?i.UploadErrorType.general:404!==e.status||n!==a.start&&n!==a.singleChunk?u?i.UploadErrorType.other:i.UploadErrorType.general:i.UploadErrorType.targetFolderMissing;return new f({errorType:s,code:c,statusCode:e.status,message:p,correlationId:e.correlationId,displayString:r,serverError:e})};t.wrapError=function(e){return e instanceof f?e:e instanceof u.FileHasherError?new f({errorType:i.UploadErrorType.other,code:"FileHasher",statusCode:0,innerError:e}):new f({errorType:i.UploadErrorType.general,code:"Unknown",statusCode:0,innerError:e})};t.convertToUploadError=function(e){return new s.UploadError({message:e.displayString||e.message||"Unknown fragment error",errorType:e.errorType,innerError:e,supportsVersioning:!0})};t.isErrorTypeExpected=function(e){switch(e.errorType){case i.UploadErrorType.disconnected:case i.UploadErrorType.conflict:case i.UploadErrorType.targetFolderMissing:return!0}switch(e.code){case"-2147023080":case"-2130575245":case o.offline:case o.noConnection:case o.requestAborted:case t.clientErrorCodes.timeout:return!0}return!1}});
define("qOe",["require","exports","lC"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){n.__extends(t,e);function t(n){var r=e.call(this,n)||this;r.name="FileHasherError";r.__proto__=t.prototype;return r}return t})(Error);t.FileHasherError=r});
define("VOe",["require","exports","Oh","th","Fe","pv","jOe","zOe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function t(e){this._workerUrl=e;this._async=new n.default;this._events=new s.default(this);this.createWorker();this.reset()}t.prototype.reset=function(){this._isWorkerAlive||this.createWorker();this._finalHash="";this._hashInfo={data:u.createHashArray(),shiftSoFar:0,endByteHashed:0}};t.prototype.computeHash=function(e,t,n){var s=this;if(this.hasFullHash())return i.default.reject(new o.FileHasherError("Cannot compute hash because we already computed final hash"));if(!this._isWorkerAlive)return i.default.reject(new o.FileHasherError("Web worker failed to load or was terminated"));var u=this._currentJob?this._currentJob.signal:new r.default,a=t+8388608>=n?n:t+8388608;this._currentJob={data:e,signal:u,endByte:n,nextStartByte:a,timeout:this._async.setTimeout(function(){s.completeJob("Web worker did not respond")},3e4)};(function(e){var t=new r.default,n=new FileReader;n.onload=function(){t.complete(n.result)};n.onerror=function(){n.abort();t.error(new Error("Unable to read data Blob as ArrayBuffer using FileReader"))};n.readAsArrayBuffer(e.slice(0,8388608>e.size?e.size:8388608));return t.getPromise()})(e).then(function(e){if(e.byteLength>0){var n={buffer:e,startByte:t,endByte:a};s._worker.postMessage({info:s._hashInfo,input:n},[e])}else s.completeJob()},function(e){s.completeJob(e.message)}).done();return u.getPromise()};t.prototype.hasFullHash=function(){return!!this._finalHash};t.prototype.getFullHash=function(e){if(!this._finalHash){this.dispose();this._finalHash=u.finalizeHash(this._hashInfo,e)}return this._finalHash};t.prototype.dispose=function(){if(this._isWorkerAlive){this._events.dispose();this._async.dispose();this.completeJob("Web worker was terminated");this._worker.terminate()}this._isWorkerAlive=!1};t.prototype.createWorker=function(){var t=window.__hasher_worker;this._worker=t||new Worker(e.toUrl(this._workerUrl));this._isWorkerAlive=!0;if(t){this._worker.onerror=this.handleWorkerError.bind(this);this._worker.onmessage=this.handleWorkerMessage.bind(this)}else{this._events.on(this._worker,"error",this.handleWorkerError.bind(this));this._events.on(this._worker,"message",this.handleWorkerMessage.bind(this))}};t.prototype.handleWorkerError=function(e){var t=e&&(e.error&&e.error.message||e.message)||"Unknown web worker error";this.completeJob(t);this.dispose()};t.prototype.handleWorkerMessage=function(e){if(this._currentJob){this._async.clearTimeout(this._currentJob.timeout);if(!e||!e.data||!e.data.info)return this.completeJob("Invalid response from web worker");this._hashInfo=e.data.info;var t=this._currentJob,n=t.nextStartByte,r=t.endByte;n>=r?this.completeJob():this.computeHash(this._currentJob.data.slice(8388608),n,r)}};t.prototype.completeJob=function(e){if(this._currentJob){this._async.clearTimeout(this._currentJob.timeout);e?this._currentJob.signal.error(new o.FileHasherError(e)):this._currentJob.signal.complete();this._currentJob=void 0}};return t})();t.FileHasher=a});
define("jOe",["require","exports","lC"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){n.__extends(t,e);function t(n){var r=e.call(this,n)||this;r.name="FileHasherError";r.__proto__=t.prototype;return r}return t})(Error);t.FileHasherError=r});
define("zOe",["require","exports","GOe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Math.floor(5.96875);t.createHashArray=function(){return Array.apply(null,Array(r)).map(Number.prototype.valueOf,0)};function i(e){return new Uint8Array([255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24])}function s(e,t,n,r,i){for(var s=0;s<i;s++)n[r+s]=e[t+s]}t.finalizeHash=function(e,t){for(var o=Math.floor(20.875),u=new Array(o),a=0;a<r-1;a++){s(i(e.data[a]),0,u,4*a,4)}s(i(e.data[r-1]),0,u,4*(r-1),u.length-4*(r-1));var f=(function(e){return new Uint8Array(new n.Uint64LE(e).toArrayBuffer())})(t);for(a=0;a<f.length;a++)u[o-f.length+a]^=f[a];return btoa(String.fromCharCode.apply(null,u))}});
define("GOe",["require","exports","module"],function(e,t,n){!(function(e){var t,n="undefined"!=typeof Buffer&&Buffer,r="undefined"!=typeof Uint8Array&&Uint8Array,i="undefined"!=typeof ArrayBuffer&&ArrayBuffer,s=[0,0,0,0,0,0,0,0],o=Array.isArray||function(e){return!!e&&"[object Array]"==Object.prototype.toString.call(e)},u=4294967296;a("Uint64BE",!0,!0);a("Int64BE",!0,!1);a("Uint64LE",!1,!0);a("Int64LE",!1,!1);function a(o,a,b){var w=a?0:4,E=a?4:0,S=a?0:3,x=a?1:2,T=a?2:1,N=a?3:0,C=a?v:g,k=a?m:y,L=M.prototype,A="is"+o,O="_"+A;L.buffer=void 0;L.offset=0;L[O]=!0;L.toNumber=_;L.toString=function(e){var t=this.buffer,n=this.offset,r=P(t,n+w),i=P(t,n+E),s="",o=!b&&2147483648&r;if(o){r=~r;i=u-i}e=e||10;for(;;){var a=r%e*u+i;r=Math.floor(r/e);i=Math.floor(a/e);s=(a%e).toString(e)+s;if(!r&&!i)break}o&&(s="-"+s);return s};L.toJSON=_;L.toArray=f;n&&(L.toBuffer=l);r&&(L.toArrayBuffer=c);M[A]=function(e){return!(!e||!e[O])};e[o]=M;return M;function M(e,n,o,a){return this instanceof M?(function(e,n,o,a,f){if(r&&i){n instanceof i&&(n=new r(n));a instanceof i&&(a=new r(a))}if(!(n||o||a||t)){e.buffer=d(s,0);return}if(!h(n,o)){f=o;a=n;o=0;n=new(t||Array)(8)}e.buffer=n;e.offset=o|=0;if(void 0===a)return;if("string"==typeof a)(function(e,t,n,r){var i=0,s=n.length,o=0,a=0;"-"===n[0]&&i++;var f=i;for(;i<s;){var l=parseInt(n[i++],r);if(!(l>=0))break;a=a*r+l;o=o*r+Math.floor(a/u);a%=u}if(f){o=~o;a?a=u-a:o++}D(e,t+w,o);D(e,t+E,a)})(n,o,a,f||10);else if(h(a,f))p(n,o,a,f);else if("number"==typeof f){D(n,o+w,a);D(n,o+E,f)}else a>0?C(n,o,a):a<0?k(n,o,a):p(n,o,s,0)})(this,e,n,o,a):new M(e,n,o,a)}function _(){var e=this.buffer,t=this.offset,n=P(e,t+w),r=P(e,t+E);b||(n|=0);return n?n*u+r:r}function D(e,t,n){e[t+N]=255&n;n>>=8;e[t+T]=255&n;n>>=8;e[t+x]=255&n;n>>=8;e[t+S]=255&n}function P(e,t){return 16777216*e[t+S]+(e[t+x]<<16)+(e[t+T]<<8)+e[t+N]}}function f(e){var n=this.buffer,r=this.offset;t=null;return!1!==e&&o(n)?8===n.length?n:n.slice(r,r+8):d(n,r)}function l(e){var r=this.buffer,i=this.offset;t=n;return!1!==e&&n.isBuffer(r)?8===r.length?r:r.slice(i,i+8):n.from(c.call(this,e))}function c(e){var n=this.buffer,s=this.offset,o=n.buffer;t=r;if(!1!==e&&!n.offset&&o instanceof i)return 8===o.byteLength?o:o.slice(s,s+8);var u=new r(8);p(u,0,n,s);return u.buffer}function h(e,t){var n=e&&e.length;t|=0;return n&&t+8<=n&&"string"!=typeof e[t]}function p(e,t,n,r){t|=0;r|=0;for(var i=0;i<8;i++)e[t++]=255&n[r++]}function d(e,t){return Array.prototype.slice.call(e,t,t+8)}function v(e,t,n){for(var r=t+8;r>t;){e[--r]=255&n;n/=256}}function m(e,t,n){var r=t+8;n++;for(;r>t;){e[--r]=255&-n^255;n/=256}}function g(e,t,n){for(var r=t+8;t<r;){e[t++]=255&n;n/=256}}function y(e,t,n){var r=t+8;n++;for(;t<r;){e[t++]=255&-n^255;n/=256}}})("object"==typeof t&&"string"!=typeof t.nodeName?t:this||{})});
define("NOe",["require","exports","lC","de","Oh","th","Fe","TA","Fv","N1","E","Ms","BOe","Re","BOe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=!p.default.isActivated("C632CBA1-6081-467D-A6A5-3BBCDD06B459","5/13/2020","Allow throttling after 429"),m=!p.default.isActivated("B351592D-F9B9-4EA3-BBB6-6573D66ABB6D","6/8/2020","Use file size for starting chunk size for smaller files."),g=!p.default.isActivated("60D6C33A-B397-454F-83CF-DAF0246F97A1","8/3/2020","Select file fields when upload"),y=(function(){function e(e){var t=e.hasher,n=e.throttler,s=e.dataRequestor,o=e.appName,u=e.webApiUrl,a=e.canStream,f=e.fileUpload,c=e.itemExpansion,h=e.destinationUrl,p=e.qosEvent,d=void 0===p?l.Qos:p,v=e.nameConflictBehavior,g=void 0===v?0:v,y=e.onStart,b=e.onAbort,w=e.onProgress;this._hasher=t;this._dataRequestor=s;this._throttler=n;this._chunkNumber=0;this._uploadedBytes=0;this._qosEvent=d;this._id=r.default.generate();this._canStream=a;this._webApiUrl=u;this._fileUpload=f;this._async=new i.default(this);this._itemExpansion=c;this._destinationUrl=h;this._nameConflictBehavior=g;this._chunkSize=m?Math.min(f.size,262144e3):262144e3;this._trackingHeaders={Application:o,Scenario:"UploadFile",ScenarioType:"AUO"};this._onStart=y;this._onAbort=b;this._onProgress=w}e.prototype.upload=function(){var e=this,t=this._throttler.throttle(function(){var t=e._id,n=e._fileUpload.size,r=e._canStream&&n>25165824,i={fileUploadId:t,size:n},s=new e._qosEvent({name:"Upload.h5",extraData:i}),p=r?"SharePointUploader.stream":"SharePointUploader.create",d=new e._qosEvent({name:p,extraData:i});e._onStart&&e._onStart();return e.start(r).then(function(e){s.end({resultType:l.ResultTypeEnum.Success});d.end({resultType:l.ResultTypeEnum.Success});return e},function(t){var n=o.default.isCanceled(t),r=h.wrapError(t),i=h.convertToUploadError(r);if(n||i.code===a.requestAborted){s.end({resultType:l.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"});d.end({resultType:l.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"});e._onAbort&&e._onAbort()}else{var p=h.isErrorTypeExpected(r)?l.ResultTypeEnum.ExpectedFailure:l.ResultTypeEnum.Failure;s.end(f.mergeQosEndSchema(c.getQosEndSchemaFromError(i),{resultType:p,resultCode:u.UploadErrorType[i.errorType]}));d.end(f.mergeQosEndSchema(c.getQosEndSchemaFromError(r),{resultType:p,extraData:{uploadedBytes:e._uploadedBytes}}))}return o.default.reject(i)})});this._uploadPromise=t;return t};e.prototype.abort=function(){var e=this,t=this._uploadPromise;this._uploadPromise=void 0;if(!this._hasCompleted&&t){t.cancel();t.then(function(){},function(){}).done(function(){e._hasher&&e._hasher.dispose();return e.cancelUpload()})}};e.prototype.restart=function(e){var t=e.nameConflictBehavior,n=void 0===t?this._nameConflictBehavior:t;this._nameConflictBehavior=n;var r=this._uploadPromise;this._uploadPromise=void 0;r&&r.cancel();this._hasher&&this._hasher.reset();return this.upload()};e.prototype.start=function(e){var t=this;this._uploadedBytes=0;var n=this._fileUpload.size;return(e?this.streamFile():this.uploadFile()).then(function(e){t.updateProgress(n);return e})};e.prototype.updateProgress=function(e){if(this._uploadedBytes!==e){this._uploadedBytes=e;this._onProgress&&this._onProgress(e)}};e.prototype.getUploadUrl=function(e){var t=this._webApiUrl;t=(t=t.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");var n={};n.DecodedUrl=this._fileUpload.name;n.overwrite=1===this._nameConflictBehavior;n.AutoCheckoutOnInvalidData=!0;e&&(n.XorHash=e);t=t.methodWithAliases("AddUsingPath",n);g&&(t=t.oDataParameter("$Select","VroomItemID,VroomDriveID"));this._itemExpansion&&(t=t.oDataParameter("$Expand",this._itemExpansion));return t.toString()};e.prototype.uploadFile=function(e){var t=this;void 0===e&&(e=3);var n=this._fileUpload.slice(0,this._fileUpload.size);return(this._hasher&&!this._hasher.hasFullHash()?this._hasher.computeHash(n,0,n.size):o.default.resolve()).then(function(){var r=t._hasher?t._hasher.getFullHash(n.size):void 0,i=t._hasher?"UploadFileWithChecksum":"UploadFile";return t.uploadChunk({trackSpeed:!1,url:t.getUploadUrl(r),qosName:i,data:n,offset:0,length:n.size}).then(function(e){return t.parseItemResponse(e)}).catch(function(n){if(o.default.isCanceled(n))return o.default.wrapError(n);if(n&&n.retryAfter&&e>0&&v){var r=1e3*n.retryAfter;return t._throttler.addThrottleTimer(r).then(function(){t._uploadedBytes=0;return t.uploadFile(e-1)})}return o.default.wrapError(h.createError(n,d.UploadStage.singleChunk))})})};e.prototype.getStreamingUrl=function(e,t,n,r){var i,s=this._webApiUrl,o=this._fileUpload.name,u={uploadId:{guid:this._requestId}};if(n===d.UploadStage.start){i="StartUpload";s=(s=s.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");s=1===this._nameConflictBehavior?s.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:o}):s.methodWithAliases("AddStubUsingPath",{DecodedUrl:o})}else{if(n===d.UploadStage.finish){i=this._hasher?"FinishUploadWithChecksum":"FinishUpload";s=s.oDataParameter("$Expand","ListItemAllFields")}else i="ContinueUpload";s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+o});u.fileOffset=e;r&&n===d.UploadStage.finish&&(u.checksum=r)}return(s=s.methodWithAliases(i,u)).toString()};e.prototype.streamFile=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._requestId||(this._requestId=r.default.generate());var i=this._fileUpload.size,u=this._chunkNumber>0?Math.min(this._chunkSize+e,i):0,a=this._fileUpload.slice(e,u),f=0===this._chunkNumber?d.UploadStage.start:i<=u?d.UploadStage.finish:d.UploadStage.continue,l=f===d.UploadStage.start,c=f===d.UploadStage.finish,p="SendFileRequest"+(l?".Start":c?this._hasher?".FinishWithChecksum":".Finish":".Continue"),v=this._hasher&&f!==d.UploadStage.start&&!this._hasher.hasFullHash()&&this._hasher?this._hasher.computeHash(a,e,u):o.default.resolve();return(c?v:o.default.resolve()).then(function(){var r=void 0;n._hasher&&c&&(r=n._hasher.getFullHash(i));return n.uploadChunk({trackSpeed:!0,url:n.getStreamingUrl(e,u,f,r),qosName:p,data:a,offset:e,length:a.size}).then(function(e){n.updateProgress(u);if(u<i){n._chunkNumber++;return v.then(function(){return n.streamFile(u)})}return n.parseItemResponse(e)},function(r){if(o.default.isCanceled(r)){f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(r)}if(h.shouldLowerChunkSize(r)){if(n._chunkSize<=1048576){n.cancelUpload();return o.default.reject(h.createError(r,f))}n._chunkSize=Math.floor(n._chunkSize/2);return n.streamFile(e,t)}if(t>0&&h.canRetry(r,f)){var i,u=new s.default(function(){i&&n._async.clearTimeout(i)});i=n._async.setTimeout(function(){return u.complete()},1e3);return u.getPromise().then(function(){return n.getUploadStatus().then(function(e){return n.streamFile(e,t-1)},function(){return n.streamFile(e,t-1)})})}f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(h.createError(r,f))})},function(e){f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(e)})};e.prototype.getUploadStatus=function(){var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileUpload.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:this._requestId}}).toString();return this._dataRequestor.getData({url:e,method:"GET",qosName:"GetUploadStatus",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},telemetryHandler:function(e){var t=e.eventData,r=e.response;if(t.resultType===l.ResultTypeEnum.Success){if(!r||!r.d||!r.d.ExpectedContentRange)return{eventData:n.__assign(n.__assign({},t),{resultCode:"NoContentRange",resultType:l.ResultTypeEnum.Failure})};var i=parseInt(r.d.ExpectedContentRange.split("-")[0],10);if(isNaN(i))return{eventData:n.__assign(n.__assign({},t),{resultCode:"NaNContentRange",resultType:l.ResultTypeEnum.Failure,error:r.d.ExpectedContentRange})}}return{eventData:t}}}).then(function(e){if(e.d&&e.d.ExpectedContentRange){var t=parseInt(e.d.ExpectedContentRange.split("-")[0],10);return isNaN(t)?o.default.reject(""):t}return o.default.reject("")})};e.prototype.cancelUpload=function(){if(!this._requestId)return o.default.resolve();var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileUpload.name}).methodWithAliases("CancelUpload",{uploadId:{guid:this._requestId}}).toString();this._requestId="";this._chunkNumber=0;return this._dataRequestor.getData({url:e,qosName:"CancelUploadSession",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id}}).then(function(){})};e.prototype.uploadChunk=function(e){var t,n,r,i,o=this,u=e.url,a=e.qosName,f=e.data,l=e.offset,c=e.length,p=new s.default(function(){t.cancel()}),d=function(e){var t=o._chunkNumber>0&&l+c>=o._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&o._async.clearTimeout(n);e&&(n=o._async.setTimeout(function(){p.error({code:""+h.clientErrorCodes.timeout,message:""})},r))},v=Date.now(),m=Date.now(),g=0,y=0,b=0,w=this._async.debounce(function(e){e>o._uploadedBytes&&o.updateProgress(e)},100,{leading:!1});t=this._dataRequestor.getData({url:u,qosName:a,additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:f,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();y+=(e.loaded-g)/(t-m);b++;r=e.loaded/(t-v);m=t;g=e.loaded;w(l+e.loaded);d(c-e.loaded)}}});d(c);e.trackSpeed&&(i=this._async.setInterval(function(){if(b){Date.now()-v+(c-g)/((y+r)/(b+1))>15e4&&g<c&&p.error({code:""+h.clientErrorCodes.tooSlow,message:""})}},1e4));t.done(function(e){p.complete(e)},function(e){p.error(e)});p.getPromise().done(function(){n&&o._async.clearTimeout(n);i&&o._async.clearInterval(i)},function(){t.cancel();n&&o._async.clearTimeout(n);i&&o._async.clearInterval(i)});return p.getPromise()};e.prototype.parseItemResponse=function(e){try{return JSON.parse(e).d}catch(e){}};return e})();t.SharePointUploader=y});
define("BOe",["require","exports","lC","Fv","TA","PA","v","jOe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;t.clientErrorCodes={unknown:"UNKNOWN_UPLOAD_ERROR",timeout:"UPLOAD_TIMEOUT_ERROR",tooSlow:"UPLOAD_TOO_SLOW_ERROR"};(function(e){e[e.singleChunk=0]="singleChunk";e[e.start=1]="start";e[e.continue=2]="continue";e[e.finish=3]="finish";e[e.status=4]="status";e[e.cancel=5]="cancel"})(a=t.UploadStage||(t.UploadStage={}));var f=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,n.__assign(n.__assign({},t),{extraData:n.__assign(n.__assign({},t.extraData||{}),"number"==typeof t.statusCode?{status:t.statusCode}:{})}))||this;r.errorType=t.errorType;r.displayString=t.displayString;try{r.serverError=JSON.stringify(t.serverError)}catch(e){r.serverError=""}return r}return t})(o.ApiError);t.UploadFragmentError=f;function l(e){if(e&&e.code){return e.code.split(",")[0]||e.code}return e&&e.number?""+e.number:t.clientErrorCodes.unknown}t.shouldLowerChunkSize=function(e){var n=l(e);return n===t.clientErrorCodes.tooSlow||n===t.clientErrorCodes.timeout||!!e&&0===e.status};t.canRetry=function(e,t){if(429===e.status)return!1;if(404===e.status&&(t===a.start||t===a.singleChunk))return!1;switch(l(e)){case r.requestAborted:case"-1":case"-2130575257":case"-2130575142":case"-2130209002":case"-2130209003":case"-2147023080":case"-2130575245":return!1;default:return!0}};t.createError=function(e,n){if(!e)return new f({errorType:i.UploadErrorType.general,code:"Unknown",statusCode:0,message:"Unknown upload error",serverError:e});var s,o,u=!1,c=l(e);if("string"==typeof e)s=e;else{var h=e.message;if("string"==typeof h)s=h;else if(h&&h.value){s=h.value;u=!0}}var p=e&&e.code||"Unhandled client error";if(c===r.offline){p="Disconnected";o=i.UploadErrorType.disconnected}else o="-2130575257"===c?i.UploadErrorType.conflict:c===t.clientErrorCodes.timeout?i.UploadErrorType.general:404!==e.status||n!==a.start&&n!==a.singleChunk?u?i.UploadErrorType.other:i.UploadErrorType.general:i.UploadErrorType.targetFolderMissing;return new f({errorType:o,code:c,statusCode:e.status,message:p,correlationId:e.correlationId,displayString:s,serverError:e})};t.wrapError=function(e){return e instanceof f?e:e instanceof u.FileHasherError?new f({errorType:i.UploadErrorType.other,code:"FileHasher",statusCode:0,innerError:e}):new f({errorType:i.UploadErrorType.general,code:"Unknown",statusCode:0,innerError:e})};t.convertToUploadError=function(e){return new s.UploadError({message:e.displayString||e.message||"Unknown fragment error",errorType:e.errorType,innerError:e,supportsVersioning:!0})};t.isErrorTypeExpected=function(e){switch(e.errorType){case i.UploadErrorType.disconnected:case i.UploadErrorType.conflict:case i.UploadErrorType.targetFolderMissing:return!0}switch(e.code){case"-2147023080":case"-2130575245":case r.offline:case r.noConnection:case r.requestAborted:case t.clientErrorCodes.timeout:return!0}return!1}});
define("ROe",["require","exports","Oh","th","Fe","NA","X_"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new s.default(3),a=(function(){function e(){this.async=new n.default;this.uploaderCount=0;this.throttledSignals=[]}e.prototype.throttle=function(e){var t=this;return u.enqueue(function(){if(!t.isReady&&t.uploaderCount>=1e3){t.uploaderCount=0;t.isReady=!0}if(t.batchStartTime&&t.uploaderCount>=8)return t.throttleUploader(e);t.isReady&&!t.batchStartTime&&(t.batchStartTime=Date.now());return t.startUploader(e)})};e.prototype.addThrottleTimer=function(e){this.isReady=!0;this.setTimeout(e);return this.addUploaderCallback(function(){return i.default.resolve()})};e.prototype.startUploader=function(e){this.uploaderCount+=1;return e()};e.prototype.addUploaderCallback=function(e){var t=this,n=new r.default;this.throttledSignals.push(n);return n.getPromise().then(function(){return t.startUploader(e)})};e.prototype.throttleUploader=function(e){if(this.timeout)return this.addUploaderCallback(e);var t=1e3-(Date.now()-this.batchStartTime);if(t>0){this.setTimeout(t);return this.addUploaderCallback(e)}this.uploaderCount=0;this.batchStartTime=Date.now();return this.startUploader(e)};e.prototype.setTimeout=function(e){var t=this;if(this.timeout){this.async.clearTimeout(this.timeout);this.timeout=void 0}this.timeout=this.async.setTimeout(function(){t.timeout=void 0;t.uploaderCount=0;t.batchStartTime=Date.now();for(var e=0,n=t.throttledSignals;e<n.length;e++){n[e].complete()}t.throttledSignals=[]},e)};return e})();t.UploadThrottler=a;t.resourceKey=new o.ResourceKey({name:e("module").id,factory:new o.SimpleResourceFactory(a)})});
define("W7e",["require","exports","X_","S3","q7e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={listContext:r.listContext,pageContext:r.pageContext};t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:s,create:function(e){var t=e.listContext,n=e.pageContext,r=new i.ClientFormProvider({listContext:o(t),pageContext:n});return{instance:r,disposable:r}}}});function o(e){return{listUrl:e.listUrl,listId:e.listId,urlParts:e.urlParts,listTitle:e.listTitle,listTemplateType:e.listTemplateType,isDocLib:e.isDocLib,folderPath:e.folderPath,enableAttachments:e.enableAttachments,leftNavigationData:e.leftNavigationData,refreshClientForm:e.refreshClientForm,contentTypesEnabled:e.contentTypesEnabled,tenantTagPolicyEnabled:e.tenantTagPolicyEnabled,allowCreateFolder:e.allowCreateFolder,flags2:e.flags2}}t.convertListContext=o});
define("q7e",["require","exports","Fe","RA","Q7e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._buffer=[];this._bufferSize=5;var n,r;if(t&&t.pageContext){this._pageContext=t.pageContext;this._listContext=t.listContext;n=t.apiUrlHelper;r=t.itemUrlHelper}else{this._pageContext=e.pageContext;this._listContext=e.listContext;n=e.apiUrlHelper;r=e.itemUrlHelper}this._defaultValueOverride=e.defaultValueOverride||{};this._clientFormDataSource=new i.default({isFeatureEnabled:e.isFeatureEnabled,fileUploaderProvider:e.fileUploaderProvider,complianceTagProvider:e.complianceTagProvider},{pageContext:this._pageContext,apiUrlHelper:n,itemUrlHelper:r});this._clientFormDataSource.listContext=this._listContext}e.prototype.getClientForm=function(e,t){var i=this;void 0===t&&(t=!1);t&&(this._listContext.refreshClientForm=!0);var s,o,u=e.itemId,a=e.item;if(!u&&a){var f=this._getBufferKeyFromItem(a,e.contentType);s=e.isBulkEdit?void 0:this._getClientFormFromBuffer(f);a.type!==r.default.Folder||e.contentType||(e.contentType="Folder");if(s){if(a.hasClientFormData){s.item=e.item;return n.default.wrap(s)}this._deleteClientFormFromBuffer(f)}}var l=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var c={},h=0,p=e.selection;h<p.length;h++){var d=p[h];if(d){var v=d.properties;if(v){var m=d.type!==r.default.Folder||v.ContentType?v.ContentType:"Folder",g=v.ContentTypeId,y=m+g;if(!c[y]){l.push({contentType:m,contentTypeId:g});c[y]=!0}}}}else l.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return u?this._clientFormDataSource.getClientForm(u,e.clientFormType,l,e.isBulkEdit):this._clientFormDataSource.getClientFormSchema(e.clientFormType,l).then(function(t){if(e.item&&!e.item.properties.ContentTypeId){e.item.properties.ContentTypeId=t.contentTypeId;e.item.properties.ContentType=t.contentType}o={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit};i._generateFieldsFromSchema(o,t);if(2!==e.clientFormType)return i.updateFormValues(o)}).then(function(){i._addClientFormToBuffer(o);return n.default.wrap(o)})};e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};e.prototype.updateItem=function(e){e.clientForm.isBulkEdit&&e.itemdIds&&(this._buffer=[]);return this._clientFormDataSource.updateItem(e)};e.prototype.saveCustomShowHideRules=function(e,t,n){return this._clientFormDataSource.saveCustomShowHideRules(e,t,n)};e.prototype.saveClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.saveClientFormCustomFormatter(e,t)};e.prototype.getClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.getClientFormCustomFormatter(e,t)};e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};e.prototype.getFieldFilterData=function(e,t){return this._clientFormDataSource.getFieldFilterData(e,t)};e.prototype.getClientFormSchema=function(e,t,n){return this._clientFormDataSource.getClientFormSchema(e,[{contentType:t,contentTypeId:n}])};e.prototype.updatePanelViewInfo=function(e){return this._clientFormDataSource.updatePanelViewInfo(e)};e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};e.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},i=0,s=e.selection;i<s.length;i++){var o=s[i];if(o){var u=o.properties;if(u){var a=o.type!==r.default.Folder||u.ContentType?u.ContentType:"Folder",f=u.ContentTypeId,l=a+f;if(!n[l]){t.push({contentType:a,contentTypeId:f});n[l]=!0}}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t};e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)};e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};e.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()};e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};e.prototype.clearBuffer=function(){this._buffer=[]};e.prototype.updateListContext=function(e){this._listContext=e;this._clientFormDataSource.listContext=e};e.prototype.getResourceProviders=function(){return this._clientFormDataSource.getResourceProviders()};e.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];if(void 0!==this._defaultValueOverride[s.InternalName]){s.DefaultValue=this._defaultValueOverride[s.InternalName];s.DefaultValueFormatted="";s.DefaultValueTyped=""}("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};e.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:0}};e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};e.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:i});return i}}return null};e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit){var t=e.item;t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};return e})();t.ClientFormProvider=s});
define("Q7e",["require","exports","lC","Fe","Le","mj","z7","Ee","nk","oSe","ke","V7","re","Pe","bx","iSe","aU","tSe","$7e","X7e","Cv","Ih","we","J7e","ce","f8","pv","Y7e","l9"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A="0x0120",O={ODB:788,OneDrive:!0},M={ODB:561,OneDrive:!0},_={ODB:573,OneDrive:!0},D={ODB:1261},P={ODB:1310},H={ODB:1293},B=1,j=2,F=4,I=8,q=16,R=!T.Killswitch.isActivated("6f35d54f-e089-40be-ac52-2550353af7a3","05/28/2020","Update image before creating item"),U=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._clientForms=null;r._getAdditionalPostData=function(e){e.isListDataRenderOptionChangeFeatureEnabled=r.isFeatureEnabled(O);e.isSpotlightFeatureEnabled=r.isFeatureEnabled(_);return h.getAdditionalPostData(e)};var i=n.pageContext,s=n.apiUrlHelper,o=n.itemUrlHelper;r._itemUrlHelper=o||new l.ItemUrlHelper({},{pageContext:i});r._apiUrlHelper=s||new p.ApiUrlHelper({},{itemUrlHelper:r._itemUrlHelper,pageContext:i});t.complianceTagProvider?r._complianceTagProvider=t.complianceTagProvider:r._complianceTagProvider=new y.default({pageContext:i});t.fileUploaderProvider?r._fileUploaderProvider=t.fileUploaderProvider:r._fileUploaderProvider=new g.FileUploaderProvider({pageContext:i});r.isFeatureEnabled=t.isFeatureEnabled?t.isFeatureEnabled:function(e){return w.default.isFeatureEnabled(e,r._pageContext&&r._pageContext.ExpFeatures)};return r}Object.defineProperty(t.prototype,"listContext",{set:function(e){this._listContext=e},enumerable:!0,configurable:!0});t.prototype.getClientFormSchema=function(e,t,i){var s=this,o=function(){var r=s._locateClientFormWithContentTypeInfos(e,t);if(i&&r&&r.fields){var o=r.fields.filter(function(e){return!s._isFieldRequireUniqueValue(e)});return n.__assign(n.__assign({},r),{fields:o})}return r};if(null===this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return o()})}return r.default.wrap(o())};t.prototype.getClientForm=function(e,t,n,s){var o=this;return new r.default(function(r,u){o.getData(function(){var t=i.default.encodeRestUriStringToken(o._listContext.listUrl),n=",cutoffVersion="+(new S.default(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0"),r=j+F+I+q;return o._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/RenderExtendedListFormData(itemId="+e+",formId='editform',mode='2',options="+r+n+")?@v1='"+t+"'"},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData){t=JSON.parse(t.d.RenderExtendedListFormData);n&&n.length>0&&!n[0].contentType&&t.ListData&&t.ListData.ContentType&&(n[0].contentType=t.ListData.ContentType);t.ListDataLite=t.ListData;t.ListData=t.Data;t.Data=void 0;return t}}return null},"GetItemDataForClientForm",function(){return""},"POST",o._getAdditionalHeaders()).then(function(e){r(o._processGetClientFormServerData(e,t,n,s))},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1;u({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})})};t.prototype.updatePanelViewInfo=function(e){var t=this;return new r.default(function(n,r){t.getData(function(){var n=i.default.encodeRestUriStringToken(t._listContext.listUrl);return t._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/contentTypes('"+e.contentTypeId+"')/ReorderFields()?@v1='"+n+"'"},function(){return null},"CustomPanelSaveDataToServer",function(){return JSON.stringify({fieldNames:e.data})}).then(function(){n(e.serverResponse({message:{value:"updated Information"}}))},function(t){r(e.serverResponse(t))})})};t.prototype.saveCustomShowHideRules=function(e,t,n){var r=this,i={__metadata:{type:"SP.Field"},ClientValidationFormula:e.rules,ClientValidationMessage:e.errMsg};return this.getData(function(){return r._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",n).toString()},function(e){return e},"saveCustomValidationRules",function(){return JSON.stringify(i)},"MERGE")};t.prototype._isFieldRequireUniqueValue=function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"===t||"attachments"===t||"Title"===n||"LinkTitle"===n||"LinkTitleNoMenu"===n||"thumbnail"===t};t.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};t.prototype.saveClientFormCustomFormatter=function(e,t){var n=this,r={__metadata:{type:"SP.ContentType"},ClientFormCustomFormatter:JSON.stringify(e.ClientFormCustomFormatterJson)};return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e.ContentTypeId+"')").toString()},function(e){return e},"saveCustomFormFormatterJSON",function(){return JSON.stringify(r)},"MERGE")};t.prototype.getClientFormCustomFormatter=function(e,t){var n=this;return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e+"')").toString()},function(e){var t=JSON.parse(e);console.log(t);return e},"GetCustomFormatter",null,"GET")};t.prototype.getResourceProviders=function(){return{ComplianceTagProvider:this._complianceTagProvider,FileUploaderProvider:this._fileUploaderProvider}};t.prototype._processGetClientFormServerData=function(e,t,r,i){var s=this,o=new m.SPListItemProcessor({listContext:this._listContext,pageContext:this._pageContext}).processData("parent",e),u=o&&o.items&&o.items[0];this._clientForms={};var a=e.ListSchema;if(a){a.New&&this._processClientFormResponse(2,a.New);if(a.Edit){this._processClientFormResponse(1,a.Edit);this._processClientFormResponse(3,a.Edit)}}var f=this._locateClientFormWithContentTypeInfos(t,r);if(i&&f&&f.fields){var l=f.fields.filter(function(e){return!s._isFieldRequireUniqueValue(e)});f=n.__assign(n.__assign({},f),{fields:l})}var c={item:u,formType:f.formType,contentType:f.contentType,contentTypeId:f.contentTypeId,fields:[],isBulkEdit:i,clientFormCustomFormatter:f.clientFormCustomFormatter};this._generateFieldsFromSchema(c,f);for(var h=[],p=0,d=c.fields;p<d.length;p++){if(0===(y=d[p]).state){y.state=2;h.push(y)}}this._handleServerData(c,e,{},h);for(var v=0,g=h;v<g.length;v++){var y;(y=g[v]).state=0}return c};t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&(this._listContext.enableAttachments||void 0===this._listContext.enableAttachments),r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};t.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:0}};t.prototype.updateFormValues=function(e,t){var n=this,s=e.item;if(!s||!s.properties||!s.properties.ID)return r.default.wrap();for(var o=[],u=0,a=e.fields;u<a.length;u++){var f=a[u];if(0===f.state){f.state=2;o.push(f)}}return this.getData(function(){var e=s.properties.ID,t=i.default.encodeRestUriStringToken(n._listContext.listUrl),r=B+j+F+I,o=",cutoffVersion="+(new S.default(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0");return n._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/RenderExtendedListFormData(itemId="+e+",formId='editform',mode='2',options="+r+o+")?@v1='"+t+"'"},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders(),"",0,!0).then(function(r){n._handleServerData(e,r,t,o);for(var i=0,s=o;i<s.length;i++){s[i].state=0}},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,i=0,s=o;i<s.length;i++){s[i].state=0}return r.default.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};t.prototype.createItem=function(e){var t=this,n=this._getUrlInfo(e.clientForm.item),i=n.listUrl,s=n.itemUrlParts,o="AddValidateUpdateItemUsingPath",u=function(){return t._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method(o).toString()},a=!T.Killswitch.isActivated("90B98E16-D68A-4423-A64A-943DF6B995B8","05/11/2020","Need to set UnderlyingObjectType to 1 when the new item is custom folder content type")&&!!e.clientForm.contentTypeId&&0===e.clientForm.contentTypeId.lastIndexOf(A,0),l=function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n},UnderlyingObjectType:a?"1":void 0},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})};return this._ensureClientForms().then(function(){return R&&t.isFeatureEnabled(P)&&t._fileUploaderProvider&&t._fileUploaderProvider.imageOperationsPool.length>0?t._updateImages(!0).then(function(n){var i=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});t._fileUploaderProvider.imageOperationsPool=[];if(t.handleFileUploaderErrors(n,null,i)){n&&n.length>0&&n.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n){var r=L.ParseThumbnailString(n.data);if(r){r.serverRelativeUrl=t.image.serverRelativeUrl;r.id=t.image.id;r.serverUrl=t.image.serverUrl}try{n.data=JSON.stringify(r)}catch(e){n.data=""}}}});return t._doCreateItem(u,l,e,o)}return r.default.wrap({status:f.UpdateResultStatus.fail})}):t._doCreateItem(u,l,e,o)})};t.prototype._doCreateItem=function(e,t,n,r){var i=this;return this._createOrUpdateItem("CreateItem",e,t,n,r).then(function(e){return i._postUpdateFields("CreateItem",n,[]).then(function(t){if(e.status===f.UpdateResultStatus.success&&t.status===f.UpdateResultStatus.fail){t.status=f.UpdateResultStatus.partialSuccess;return t}return e})})};t.prototype.updateItem=function(e){var t=this,n=e.clientForm.isBulkEdit&&e.itemdIds&&e.itemdIds.length>1?e.itemdIds:void 0,i=n&&n.length>1,s=function(e){var n=t._getUrlInfo(e),r=n.listUrl,s=n.itemUrlParts;return i?t._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("BulkValidateUpdateListItems").toString():t._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("items",e.properties.ID).method("ValidateUpdateListItem").toString()},o=function(r){var s;i&&(s=t._listContext.folderPath);return JSON.stringify({itemIds:n,formValues:r,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:s})};return this._ensureClientForms().then(function(){return R&&t.isFeatureEnabled(P)&&t._fileUploaderProvider&&t._fileUploaderProvider.imageOperationsPool.length>0?t._updateImages(!1).then(function(u){var a=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});t._fileUploaderProvider.imageOperationsPool=[];if(t.handleFileUploaderErrors(u,null,a)){u&&u.length>0&&u.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n&&n.data!==n.serverData){var r=L.ParseThumbnailString(n.data);if(r){r.serverRelativeUrl=t.image.serverRelativeUrl;r.id=t.image.id;r.serverUrl=t.image.serverUrl}n.data=r?JSON.stringify(r):""}}});return t._doUpdateItem(s,o,e,i,n)}return r.default.wrap({status:f.UpdateResultStatus.fail})}):t._doUpdateItem(s,o,e,i,n)})};t.prototype._doUpdateItem=function(e,t,n,r,i){var s=this;return this._createOrUpdateItem("UpdateItem",e,t,n,r?"BulkValidateUpdateListItems":"ValidateUpdateListItem",i).then(function(e){return s._postUpdateFields("UpdateItem",n,i).then(function(t){if(e.status===f.UpdateResultStatus.success&&t.status===f.UpdateResultStatus.fail){t.status=f.UpdateResultStatus.partialSuccess;return t}return e})})};t.prototype.fetchAllClientFormSchemas=function(){var e=this;this._clientFormsDebouncer||(this._clientFormsDebouncer=new s.default);this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return e._getServerConnectionUrl().toString()},function(t){e._clientForms={};var n=JSON.parse(t);n.ContentTypeIdToNameMap&&(e._contentTypeIdToNameMap=n.ContentTypeIdToNameMap);n.ClientFormCustomFormatter&&(e._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var r=n.ClientForms;if(r){r.New&&e._processClientFormResponse(2,r.New);if(r.Edit){e._processClientFormResponse(1,r.Edit);e._processClientFormResponse(3,r.Edit)}}n.Navigation&&(e._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});void 0!==n.EnableAttachments&&(e._listContext.enableAttachments=n.EnableAttachments);n.FormRenderModes&&e._processFormRenderMode(n.FormRenderModes);(n.PowerAppFormId||n.AppId)&&(e._powerAppFormId=n.PowerAppFormId||n.AppId);n.AppRenderInfo&&(e._powerAppFormInfo=n.AppRenderInfo||{});n.AppAdditionalData&&(e._powerAppAdditionalData=n.AppAdditionalData);n.CachedFileUrlTemplate&&n.CacheAppFiles&&(e._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){var t=T.Killswitch.isActivated("6C84499D-FB49-4D49-8AA4-D01985944D20","07/07/20","do not fetch navigationNodes when getClientForms")&&!e._listContext.leftNavigationData&&e.isFeatureEnabled(M);return e._getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:t})},"POST",this._getAdditionalHeaders())));return this._clientFormsPromise};t.prototype.getFieldFilterData=function(e,t){return new v.ListFilterDataSource({parentKey:void 0,listContext:this._listContext,pageContext:this._pageContext,folderPath:void 0,itemUrlHelper:this._itemUrlHelper,apiUrlHelper:this._apiUrlHelper}).getFilterData(e,"",t,void 0)};t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t};t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})};t.prototype.getPowerAppFormId=function(){return this._powerAppFormId};t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo};t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='"+e+"'&visualizationTarget=1"},function(e){var t=JSON.parse(e),n="";t.d&&t.d.Value&&(n=JSON.parse(t.d.Value));return n},"GetPowerAppFormDesignUrl",null,"GET")};t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return c.getListDataUrl({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};t.prototype._processClientFormResponse=function(e,t){this._clientForms[e]||(this._clientForms[e]={});var n=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!n[r]){var i=this._reverseLookupContentTypeIdByName(r),s=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[i]:void 0;n[r]={contentType:r,contentTypeId:i,formType:e,fields:[],clientFormCustomFormatter:s?JSON.parse(s):void 0,mode:0};for(var o=n[r],u=t[r],a=0,f=u.length;a<f;a++)o.fields.push(u[a])}};t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var r=2;switch(n){case"Edit":r=1;break;case"Display":r=3}var i=0;switch(e[t][n].RenderType){case 1:i=2;break;case 2:i=3;break;case 3:i=4;break;case 4:i=5;break;default:o.Verbose.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[r][t].mode=i}};t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var r=t[0],i=this._locateClientForm(e,r.contentType,r.contentTypeId);if(1===t.length||!i||!i.fields)return i;for(var s=i.fields.slice(),o=function(n){if(0===s.length)return"break";var r=t[n],i=u._locateClientForm(e,r.contentType,r.contentTypeId);s=s.filter(function(e){for(var t=0,n=i.fields;t<n.length;t++){if(n[t].Name===e.Name)return!0}return!1})},u=this,a=1;a<t.length;a++){if("break"===o(a))break}return n.__assign(n.__assign({},i),{fields:s})};t.prototype._locateClientForm=function(e,t,n){!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]);if(!t&&this._clientForms[e])for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){t=r;break}if(n&&0===n.lastIndexOf(A,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){var s=this._clientForms[e][r].fields.filter(function(e){return!!i[e.Name]})[0];if(s){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[s],mode:0};return this._clientForms[e].Folder}}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var r in this._clientForms[e])if(this._clientForms[e][r]&&!this._clientForms[e][r].contentTypeId)return this._clientForms[e][r];return null}return this._clientForms[e][t]};t.prototype._getAdditionalHeaders=function(){return c.getListRequestHeaders(this._listContext)};t.prototype._handleServerData=function(e,t,n,r){for(var i=t.ListDataLite?t.ListDataLite:t.ListData,s=t.ListDataLite?t.ListData.Row[0]:t.Data.Row[0],o=e.item,u=0,a=r.length;u<a;u++){var f=r[u],l=f.schema;if(!n||!n.hasOwnProperty(l.Name)){void 0===f.data&&(f.data=null);void 0===f.serverData&&(f.serverData=null);if(i.hasOwnProperty(l.Name)){l.FieldType&&"boolean"===l.FieldType.toLowerCase()&&""===s[l.Name]&&"0"===i[l.Name]?f.serverData="":l.FieldType&&"thumbnail"===l.FieldType.toLowerCase()&&s[l.Name]?f.serverData=s[l.Name]:f.serverData=i[l.Name];o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=s[l.Name])}else if(b.isClientFormComplianceTagField(f)){f.serverData=s[b.COMPLIANCETAG_FIELD_NAME];o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=s[l.Name])}else o.folder&&f.schema.FieldType&&"file"===f.schema.FieldType.toLowerCase()&&f.schema.Title&&"name"===f.schema.Title.toLowerCase()&&i.Title?f.serverData=i.Title:f.serverData=null;e.isBulkEdit&&(f.serverData=null);if(f.schema.AppendOnly){f.appendOnlyData=t[f.schema.Name];f.data=""}else f.data=f.serverData}}o.hasClientFormData=!0};t.prototype._createOrUpdateItem=function(e,t,n,i,s,o){var u=this,a=i.clientForm.fields,l=[],c=[],h={},p=[],v=!1,m=!1;!T.Killswitch.isActivated("9275D398-BC11-4137-9A9C-597DEE2E74F9","03/11/2020","For customList, ensure to also update folder FileLeafRef when user update folder title in client form")&&1===i.clientForm.formType&&i.clientForm.item&&!i.clientForm.isBulkEdit&&this._listContext&&!this._listContext.isDocLib&&i.clientForm.item.properties&&"1"===i.clientForm.item.properties.FSObjType&&(m=!0);this.isFeatureEnabled(H)&&(o?x.logTaggingChanges(i.clientForm,o.length):x.logTaggingChanges(i.clientForm));for(var g=0,y=a;g<y.length;g++){var w=y[g];if(null!==w.data&&void 0!==w.data){var S=w.data;if("thumbnail"===w.schema.FieldType.toLowerCase()&&"string"!=typeof S)try{S=JSON.stringify(S)}catch(e){}if(!this._isClientFormFieldUpdated(i,S,w.serverData)||"attachments"===w.schema.FieldType.toLowerCase()||b.isClientFormComplianceTagField(w)||b.isClientFormComplianceUnlockRecordField(w))h[w.schema.Name]=!0;else{l.push(w);var C=w.schema.Name;if("ContentType"===C){S=this._reverseLookupContentTypeIdByName(S.displayName);C="ContentTypeId";v=!0}c.push({FieldName:C,FieldValue:S,HasException:!1,ErrorMessage:null});"Title"===C&&m&&c.push({FieldName:"FileLeafRef",FieldValue:S,HasException:!1,ErrorMessage:null});E.Engagement.logData({name:"ClientFormUpdate."+w.schema.FieldType.toLowerCase(),extraData:{Host:N.getExtraDataHost()}})}}}if(v){if(!T.Killswitch.isActivated("9678aca9-f8a4-4732-879d-ffbe7e215a33","04/07/2020","for cc model deployed lists, set PrimeCorrectByUser flag as true if ContentType is manually corrected")){4096==(4096&this._listContext.flags2)&&c.push({FieldName:"PrimeCorrectedByUser",FieldValue:"true",HasException:!1,ErrorMessage:null})}}else 2===i.clientForm.formType?c.push({FieldName:"ContentType",FieldValue:i.clientForm.contentType,HasException:!1,ErrorMessage:null}):1===i.clientForm.formType&&i.clientForm.item&&i.clientForm.item.properties&&!i.clientForm.isBulkEdit&&c.push({FieldName:"ContentTypeId",FieldValue:i.clientForm.item.properties.ContentTypeId,HasException:!1,ErrorMessage:null});if(0===l.length&&0===p.length)return r.default.wrap({status:f.UpdateResultStatus.success});p.push(this._getUpdateItemPromise(e,t,n,i,s,l,c,i.clientForm.item,o));return r.default.all(p).then(function(e){for(var t={status:f.UpdateResultStatus.success},n=0,r=e;n<r.length;n++){var i=r[n];if(i&&i.hasOwnProperty("status")){t.status=i.status;i.failedItemIds&&(t.failedItemIds=i.failedItemIds)}break}return t},function(e){for(var t=0,n=l;t<n.length;t++){var r=n[t];r.hasException=!0;r.state=0}var s=d.getServerUrl(u._pageContext)+i.clientForm.item.properties.FileRef;throw e=(e=Array.isArray(e)?e:[e]).filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'+s+'" ',"");return e})})};t.prototype._getUpdateItemPromise=function(e,t,n,i,s,o,u,a,l){var c=this;return u&&0!==u.length&&o&&0!==o.length?this.getData(t.bind(null,a),function(e){var t=JSON.parse(e);if(!t.d||!t.d[s]||!t.d[s].results){for(var n=0,u=o;n<u.length;n++){(L=u[n]).state=0}return r.default.wrapError("The server response couldn't be processed")}for(var h=null,p={},d="",v=0,m=t.d[s].results;v<m.length;v++){var g=m[v];if(2===i.clientForm.formType&&"Id"===g.FieldName){var y=a;y.properties||(y.properties={});y.properties.ID=g.FieldValue}if(!0===g.HasException||null!==g.ErrorMessage){var b=g.FieldName;p[b]||(p[b]=[]);void 0!==g.ItemId&&p[b].indexOf(g.ItemId)<0&&p[b].push(g.ItemId);if(!h){h={};for(var w=0,E=i.clientForm.fields;w<E.length;w++){var S=E[w];h[S.schema.Name]=S}}if(h[b]){h[b].errorMessage=g.ErrorMessage;h[b].hasException=!0;var x=h[b].schema.Title;d=d?d+", "+x:x}}}var T={status:d?f.UpdateResultStatus.fail:f.UpdateResultStatus.success};if(l&&l.length&&p.null){var N=p.null;N.length<l.length?T.status=f.UpdateResultStatus.partialSuccess:T.status=f.UpdateResultStatus.fail;T.failedItemIds=N}for(var C=0,k=o;C<k.length;C++){var L=k[C];if(d){if(!p[L.schema.Name]&&i.isInteractiveSave){L.errorMessage="Cannot save due to errors in other fields: "+d;L.hasException=!0}}else{L.errorMessage="";L.hasException=!1}L.state=0}c._raiseCreateOrUpdateEvents(i,T);return T},e,function(){return n(u)},"POST",this._getAdditionalHeaders(),void 0,5):r.default.wrap()};t.prototype._getUrlInfo=function(e){var t=e&&this._itemUrlHelper.getItemUrlParts(e.key);return{listUrl:t&&t.serverRelativeListUrl?t.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:t}};t.prototype._isClientFormFieldUpdated=function(e,t,n){return(!e.clientForm.isBulkEdit||""!==t||null!==n)&&!u.deepCompare(t,n)};t.prototype._postUpdateFields=function(e,t,n){var i=t.clientForm.item;if(!this.isValidItem(i))return r.default.wrap({status:f.UpdateResultStatus.fail});for(var s=this._itemUrlHelper.getItemUrlParts(i.key).serverRelativeListUrl,o=n&&n.length>1,u=[],a=null,l=0;l<t.clientForm.fields.length;l++){var c=t.clientForm.fields[l];if(b.isClientFormComplianceTagField(c)){if(c.data===c.serverData)continue;if(o){var h=this._updateMultipleComplianceTagsPromises(n,c,s);if(h)for(var p=0,d=h;p<d.length;p++){var v=d[p];u.push(v)}}else u.push(this._updateComplianceTagField(c,i));E.Engagement.logData({name:"ClientFormUpdate."+c.schema.FieldType.toLowerCase()})}else if(b.isClientFormComplianceUnlockRecordField(c)){if(!this.isFeatureEnabled(D)||c.data===c.serverData)continue;var m=b.isUnlockRecordTurnedOn(i.properties[b.COMPLIANCEFLAGS_NAME]);if(m===("1"===c.data)||o)continue;u.push(this._updateUnlockRecordField(i,c,s,m));E.Engagement.logData({name:"ClientFormUpdate."+c.schema.FieldType.toLowerCase()})}else"attachments"===c.schema.FieldType.toLowerCase()&&(a=c)}n&&0!==n.length||u.push(this._updateAttachmentsField(a,i,e));return r.default.all(u).then(function(e){for(var t,n={status:f.UpdateResultStatus.success},r=0,i=e;r<i.length;r++){var s=i[r];s&&s.status===f.UpdateResultStatus.fail&&(n.status=s.status);s&&s.failedItemIds&&s.failedItemIds.length>0&&(t=n.failedItemIds).push.apply(t,s.failedItemIds)}return n})};t.prototype._updateComplianceTagField=function(e,t){var n,i=e.schema;i.ComplianceTags&&(n=i.ComplianceTags.filter(function(t){return t&&t.tagValue===e.data})[0]);if(n){e.state=1;return this._complianceTagProvider.updateComplianceTag(t,n).then(function(){e.state=0;return{status:f.UpdateResultStatus.success}},function(t){if(t&&e){e.errorMessage=t.message&&t.message.value?t.message.value:t;e.hasException=!0}e.state=0;return{status:f.UpdateResultStatus.fail}})}return r.default.wrap(null)};t.prototype._updateMultipleComplianceTagsPromises=function(e,t,n){var r,i=t.schema,s=[];i.ComplianceTags&&(r=i.ComplianceTags.filter(function(e){return e&&e.tagValue===t.data})[0]);if(!r)return s;t.state=1;for(var o=[],u=0,a=0,l=e.length;a<l;a++){o.push(e[a]);if(++u===b.MAX_ITEM_SIZE||a===e.length-1){s.push(this._complianceTagProvider.updateComplianceTagInBatch(o,r,n).then(function(e){t.state=0;return e&&e.length>0?{status:f.UpdateResultStatus.fail,failedItemIds:e}:{status:f.UpdateResultStatus.success}},function(e){if(e&&t){t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:f.UpdateResultStatus.fail,failedItemIds:o}}));o=[];u=0}}return s};t.prototype._updateUnlockRecordField=function(e,t,n,r){var i="1"===t.data;t.state=1;return i?this._complianceTagProvider.unlockRecord(e,n).then(function(e){t.serverData=e?"1":"0";t.state=0;return{status:f.UpdateResultStatus.success}},function(e){if(e&&t){t.serverData=r?"1":"0";t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:f.UpdateResultStatus.fail}}):this._complianceTagProvider.lockRecord(e,n).then(function(e){t.serverData=e?"1":"0";t.state=0;return{status:f.UpdateResultStatus.success}},function(e){if(e&&t){t.serverData=r?"1":"0";t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:f.UpdateResultStatus.fail}})};t.prototype._updateAttachmentsField=function(e,t,n){var i=this;if(this._fileUploaderProvider&&this._fileUploaderProvider.operationsPool.length>0){this._fileUploaderProvider.operationsPool.some(function(e){return 0===e.fileType})&&(e.state=1);return this._fileUploaderProvider.executeAllOperations(this._fileUploaderProvider.operationsPool,!0,"CreateItem"===n&&t&&t.properties?Number(t.properties.ID):void 0).then(function(t){i._fileUploaderProvider.operationsPool=[];return{status:i.handleFileUploaderErrors(t,e,[])?f.UpdateResultStatus.success:f.UpdateResultStatus.fail}},function(t){i._fileUploaderProvider.operationsPool=[];return{status:i.handleFileUploaderErrors(t,e,[])?f.UpdateResultStatus.success:f.UpdateResultStatus.fail}})}return r.default.wrap(null)};t.prototype.isValidItem=function(e){return e&&e.properties&&e.properties.ID&&"0"!==e.properties.ID};t.prototype.handleFileUploaderErrors=function(e,t,n){var r={attachments:[]},i=!0;e.forEach(function(e){if(!e.result){e.attachment&&r.attachments.push(e.errorMsg);e.image&&(r[e.image.fieldName]=e.errorMsg);i=!1}});if(t){if(r.attachments.length>0){var s=r.attachments.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage=s;t.hasException=!0}t.state=0;E.Engagement.logData({name:"ClientFormUpdate."+t.schema.FieldType.toLowerCase()})}n.forEach(function(e){if(r[e.schema.Name]){e.errorMessage=r[e.schema.Name];e.hasException=!0}e.state=0;E.Engagement.logData({name:"ClientFormUpdate."+e.schema.FieldType.toLowerCase()})});return i};t.prototype._ensureClientForms=function(e){if(this._clientForms&&this._contentTypeIdToNameMap&&!this._listContext.refreshClientForm)return e?r.default.wrap(e()):r.default.wrap();this._listContext.refreshClientForm=void 0;return e?this.fetchAllClientFormSchemas().then(e):this.fetchAllClientFormSchemas().then(function(){return r.default.wrap()})};t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1};t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],r=this._clientForms[e][n];return r?r.mode:this._checkRenderModes(4)?4:0};t.prototype._raiseCreateOrUpdateEvents=function(e,t){var n=e.clientForm;if(w.default.isFeatureEnabled({ODB:1273})&&t&&t.status===f.UpdateResultStatus.success&&n){var r=n.item&&n.item.properties&&n.item.properties.ID?n.item.properties.ID:void 0,i=e.itemdIds&&e.itemdIds.length?e.itemdIds.map(String):r?[r]:void 0;i&&C.default.raise(window,2===n.formType?k.ClientFormEvents.newItemCreated:k.ClientFormEvents.itemUpdated,{itemIds:i})}};t.prototype._updateImages=function(e){return this._fileUploaderProvider&&this._fileUploaderProvider.imageOperationsPool.length>0?this._fileUploaderProvider.executeAllOperations(this._fileUploaderProvider.imageOperationsPool,!0,e?0:void 0):r.default.wrap([])};return t})(a.default);t.default=U});
define("oSe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"})(t.UpdateResultStatus||(t.UpdateResultStatus={}))});
define("iSe",["require","exports","lC","nk","Le","p7","ke","Pe","j7","oU","rSe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;n._listContext=t.listContext;n._itemUrlHelper=t.itemUrlHelper||new o.ItemUrlHelper({},{pageContext:t.pageContext});n._apiUrlHelper=t.apiUrlHelper||new u.ApiUrlHelper({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper});n._folderPath=t.folderPath;void 0===n._folderPath&&(n._folderPath=f.getFolderPath(t.parentKey,n._listContext));return n}t.prototype.getFilterData=function(e,t,n,r){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,n,r){var o=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl}),u=this._apiUrlHelper.build().webByItemUrl(o).method("GetList",o.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e);n&&n!==l.needsAttentionViewId&&(u=u.parameter("ViewId",n));this._folderPath&&(u=u.parameter("RootFolder",{raw:i.default.encodeURIComponent(this._folderPath)}));r&&r===s.ColumnFieldType.Taxonomy&&(u=u.parameter("ExcludeFieldFilteringHtml",!0));var f=a.getFilterParams(t,!0);return(u=u.rawParameter(f)).toString()};return t})(r.default);t.ListFilterDataSource=c;t.default=c});
define("rSe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.needsAttentionViewId="f9ebc8b2-a976-48f0-a8fa-0846164c0466"});
define("tSe",["require","exports","Fe","ce","pe","aSe","Pe","ke","nSe","Hs","de"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=!r.Killswitch.isActivated("c2826c91-84a2-4d32-9c21-95ec3fad2072","06/15/2020","Dedupe operations when attemp to pushing a new operation(support IE)"),h=(function(){function e(e){this.operationsPool=[];this.imageOperationsPool=[];this.listTitle=e.pageContext.listTitle;this.listId=l.default.normalizeLower(e.pageContext.listId,!1);var t=new u.ItemUrlHelper({},{pageContext:e.pageContext}),n=new o.ApiUrlHelper({},{itemUrlHelper:t,pageContext:e.pageContext}),r={pageContext:e.pageContext};this.dataSource=new s.default({apiUrlHelper:n,itemUrlHelper:t},r)}e.prototype.createAddAttachmentOperation=function(e,t,n){var r={type:1,listItemId:e,listItemKey:t,fileType:0,fileName:n.name,file:n};c?this.handleNewOperation(r,this.operationsPool):this.operationsPool.push(r)};e.prototype.createDeleteAttachmentOperation=function(e,t,n){var r={type:0,listItemId:e,listItemKey:t,fileType:0,fileName:n};c?this.handleNewOperation(r,this.operationsPool):this.operationsPool.push(r)};e.prototype.createAddImageOperation=function(e,t,n,r){var i={type:1,listItemId:e,listItemKey:t,fileType:1,fileName:n.name,file:n,fieldName:r};c?this.handleNewOperation(i,this.imageOperationsPool):this.imageOperationsPool.push(i)};e.prototype.createDeleteImageOperation=function(e,t,n,r){var i={type:0,listItemId:e,listItemKey:t,fileType:1,fileName:n,fieldName:r};c?this.handleNewOperation(i,this.imageOperationsPool):this.imageOperationsPool.push(i)};e.prototype.executeAllOperations=function(e,t,r){var i=this;c||t&&this.preprocessOperations();return new n.default(function(t,n){if(e.length>0){var s=e[0],o=e.slice(1),u=void 0;if(1===s.type){void 0!==r&&(s.listItemId=r);u=i.processUpload(s.listItemId,s.listItemKey,s.file,s.fileType,s.fieldName)}else u=i.processDelete(s.listItemId,s.listItemKey,s.fileName,s.fileType,s.fieldName);var a=function(e){i.executeAllOperations(o,!1,r).done(function(n){return t([e].concat(n))},n)};u.done(a,a);f.Engagement.logData({name:"ClientFormUpdate.attachments"})}else t([])})};e.prototype.processUpload=function(e,t,n,r,s){return 1===r?this.dataSource.addImage(e,t,this.listId,this.listTitle,s,n).then(function(e){return{result:!0,attachment:null,image:e,errorMsg:e?null:i.format(a.default.uploadImageGenericError,n.name)+"."}},function(e){var t=i.format(a.default.uploadImageGenericError,n.name);e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=a.default.uploadImageUnsupportedTypeError:e.message&&e.message.value&&(t+=" : "+e.message.value));throw{result:!1,attachment:null,image:{type:"thumbnail",fieldName:s,fileName:n.name,serverUrl:null},errorMsg:t}}):this.dataSource.addAttachment(e,t,n).then(function(e){return{result:!0,attachment:e,errorMsg:e?null:i.format(a.default.uploadErrorAttachment,n.name)+"."}},function(e){throw{result:!1,attachment:{type:"attachment",uploaded:!1,fileName:n.name},errorMsg:i.format(a.default.uploadErrorAttachment,n.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.processDelete=function(e,t,r,s,o){return 1===s?n.default.wrap({result:!0,image:{type:"thumbnail",fieldName:o,fileName:r,serverRelativeUrl:null,serverUrl:null},errorMsg:null}):this.dataSource.deleteAttachment(e,t,r).then(function(e){return{result:e,errorMsg:e?null:i.format(a.default.deleteErrorAttachment,r)+"."}},function(e){throw{result:!1,errorMsg:i.format(a.default.deleteErrorAttachment,r)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.preprocessOperations=function(){for(var e=this,t=[],n=0;n<this.operationsPool.length;n++){var r=this.operationsPool[n];if(1===r.type)for(var i=n+1;i<this.operationsPool.length;i++){var s=this.operationsPool[i];if(0===s.type&&s.fileType===r.fileType&&s.fileName===r.fileName){t.push(n);t.push(i)}}}t.sort(function(e,t){return t-e}).forEach(function(t){e.operationsPool.splice(t,1)})};e.prototype.handleNewOperation=function(e,t){var n=e.type,r=this.findDuplicateOperation(e,t);1===n?r<0&&t.push(e):r<0?t.push(e):t.splice(r,1)};e.prototype.findDuplicateOperation=function(e,t){var n=e.fileType,r=-1;t.some(function(t,i){if(1===t.type&&t.fileName===e.fileName&&(1!==n||t.fieldName===e.fieldName)){r=i;return!0}});return r};return e})();t.FileUploaderProvider=h});
define("aSe",["require","exports","lC","Fe","nk","bx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.apiUrlHelper,s=t.itemUrlHelper;r._itemUrlHelper=s;r._apiUrlHelper=i;return r}t.prototype.getAttachments=function(e,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e,t).toString()},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.resultes&&0===t.d.results.length)return[];var r=t.d.results;return n.transformAttachmentData(r)},"Attachments")};t.prototype.addAttachment=function(e,t,n){var i=this;return new r.default(function(r,s){var o=new FileReader;o.onload=function(u){var a=o.result;i.doUploadAttachment(e,t,n.name,a).then(r,s)};o.readAsArrayBuffer(n)},function(){})};t.prototype.deleteAttachment=function(e,t,n,i){var s=this;return new r.default(function(r,o){s.doDeleteAttachment(e,t,n,i||!1).then(r,o)},function(){})};t.prototype.getDataSourceName=function(){return"AttachmentDataSource"};t.prototype.addImage=function(e,t,n,i,s,o){var u=this;return new r.default(function(r,a){var f=new FileReader;f.onload=function(l){var c=f.result;u.doUploadImage(t,i,s,o.name,c,n,e).then(r,a)};f.readAsArrayBuffer(o)},function(){})};t.prototype.buildAttachmentBaseUrl=function(e,t,n){var r=this._itemUrlHelper.getItemUrlParts(t),i=this._apiUrlHelper.build().webByItemUrl(r).method("GetList",r.serverRelativeListUrl).method("Items",e);return i=n?i.method("AttachmentFiles",n):i.segment("AttachmentFiles")};t.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{type:"attachment",fileName:e.FileName,serverRelativeUrl:s.getServerUrl(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})};t.prototype.doUploadAttachment=function(e,t,n,r){var i=this;return this.dataRequestor.getData({url:this.buildAttachmentBaseUrl(e,t).methodWithAliases("addUsingPath",{decodedUrl:n}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d)return null;var n=[t.d],r=i.transformAttachmentData(n);return r&&1===r.length?r[0]:null},qosName:"UploadAttachment",additionalPostData:r,noRedirect:!0})};t.prototype.doDeleteAttachment=function(e,t,n,r){var i=this;return this.getData(function(){return i.buildAttachmentBaseUrl(e,t,n).segment(r?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return r&&void 0!==t.d.DeleteObject||!r&&void 0!==t.d.RecycleObject}catch(e){return!1}},r?"DeleteAttachment":"RecycleAttachment")};t.prototype.doUploadImage=function(e,t,n,r,i,s,o){var u=this,a=this._itemUrlHelper.getItemUrlParts(e);return this.dataRequestor.getData({url:this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("UploadImage",{listTitle:t,imageName:r,listId:s,itemId:o}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d.UploadImage)return null;var r=t.d.UploadImage,i=u.transformImageData(r,n);return i||null},qosName:"UploadImage",additionalPostData:i,noRedirect:!0})};t.prototype.transformImageData=function(e,t){return{type:"thumbnail",fileName:e.Name,serverRelativeUrl:e.ServerRelativeUrl,id:e.UniqueId,fieldName:t,serverUrl:s.getServerUrl(this._pageContext)}};return t})(i.DataSource);t.FileUploaderDataSource=o;t.default=o});
define("$7e",["require","exports","eSe","Pe","ke"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){var t=new i.ItemUrlHelper({},{pageContext:e.pageContext}),s=new r.ApiUrlHelper({},{itemUrlHelper:t,pageContext:e.pageContext}),o={pageContext:e.pageContext};this._dataSource=new n.default({apiUrlHelper:s,itemUrlHelper:t},o)}e.prototype.getAvailableTagsForSite=function(){this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite());return this._cachedTagsPromise};e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)};e.prototype.updateComplianceTagInBatch=function(e,t,n){return this._dataSource.updateComplianceTagInBatch(e,t,n)};e.prototype.unlockRecord=function(e,t){return this._dataSource.unlockRecord(e,t)};e.prototype.lockRecord=function(e,t){return this._dataSource.lockRecord(e,t)};e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&e.length>1)})};return e})();t.default=s});
define("eSe",["require","exports","lC","Fe","z7","nk","X7e","Z7e"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.apiUrlHelper,s=t.itemUrlHelper;r._apiUrlHelper=i;r._itemUrlHelper=s;return r}t.prototype.getAvailableTagsForSite=function(){var e=this;return this.dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return r.default.wrapError(u.default.GetAvailableTagsForSiteFailed)})};t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length){i.Verbose.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n});return r.default.wrap([])}var s=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this.dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:s,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return r.default.wrapError(e)})};t.prototype.updateComplianceTag=function(e,t){var n=t.blockEdit||t.blockDelete,i=t.blockEdit,s=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:n,isTagPolicyRecord:i,isEventBasedTag:s,isTagSuperLock:t.superLock});return this.dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,"SetComplianceTag"),qosName:"SetComplianceTag",additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return r.default.wrapError(e)})};t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return o.isUnlockRecordTurnedOn(t)}return!1},function(e){return r.default.wrapError(e)})};t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return o.isUnlockRecordTurnedOn(t)}return!1},function(e){return r.default.wrapError(e)})};t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:u.default.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:u.default.NoneComplianceTagDescription,tagTooltip:u.default.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:""};t.push(n);for(var r=0,i=e;r<i.length;r++){var s=i[r],a=o.getTagDescription(s),f=o.getTagTooltip(s),l={tagName:s.TagName,tagValue:s.TagName,blockDelete:s.BlockDelete,blockEdit:!!s.BlockEdit,tagDescription:a,tagTooltip:f,hasRetentionAction:s.HasRetentionAction,autoDelete:s.AutoDelete,isEventTag:s.IsEventTag,reviewerEmail:s.ReviewerEmail,notes:s.Notes,displayName:s.DisplayName,superLock:s.SuperLock,tagId:s.TagId};t.push(l)}return t};t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()};t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()};return t})(s.DataSource);t.default=a});
define("X7e",["require","exports","pe","Z7e"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COMPLIANCETAG_FIELD_NAME="_ComplianceTag";t.COMPLIANCETAG_FIELD_ID="D4B6480A-4BED-4094-9A52-30181EA38F1D";t.ASSETID_FIELD_NAME="ComplianceAssetId";t.ASSETID_FIELD_ID="3A6B296C-3F50-445C-A13F-9C679EA9DDA3";t.UNLOCKRECORD_FIELD_NAME="RecordUnlocked";t.UNLOCKRECORD_FIELD_ID="96BE7325-AFA4-48CF-8503-9258F0A7817D";t.COMPLIANCEFLAGS_NAME="_ComplianceFlags";t.MAX_ITEM_SIZE=200;t.isUnlockRecordTurnedOn=function(e){return!!(256&e)};t.getRecordLabelHoverText=function(){return r.default.RecordLabelHoverText};t.getPlaceholder=function(){return r.default.ComplianceTagFieldPlaceHolder};t.getTagDescription=function(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?r.default.RetainForeverText:" ";var t=i(e.TagDuration);return e.BlockDelete?n.format(r.default.PreserveTagText,t):e.AutoDelete?n.format(r.default.DeleteTagText,t):" "};t.getTagTooltip=function(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return r.default.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?r.default.PreserveForeverTooltip:r.default.NoRetentionTooltip;var t=i(e.TagDuration),s="",o="";if(e.BlockDelete){s="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(o=r.default.PreserveIsRecordTooltipModifier);e.ReviewerEmail?o+=r.default.ReviewTooltip:o+=e.AutoDelete?r.default.PreserveAutoDeleteTooltipModifier:r.default.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(s="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var u=r.default[s];return u?n.format(u,t)+o:null};function i(e){var t="";if(e>0){var i=Math.floor(e/365);if(i>0){var s=i>1?r.default.RetentionPeriodYears:r.default.RetentionPeriodYear;t=n.format(s,i)}else{var o=Math.floor(e/30);if(o>0){var u=o>1?r.default.RetentionPeriodMonths:r.default.RetentionPeriodMonth;t=n.format(u,o)}else{var a=e>1?r.default.RetentionPeriodDays:r.default.RetentionPeriodDay;t=n.format(a,e)}}}return t}t.getDurationAsString=i;t.isClientFormComplianceUnlockRecordField=function(e){return!!(e&&e.schema&&s(e.schema.FieldType,e.schema.Id))};function s(e,n){return!(!e||"boolean"!==e.toLowerCase()||!n||n.toLowerCase()!==t.UNLOCKRECORD_FIELD_ID.toLowerCase())}t.isComplianceUnlockRecordField=s;t.isClientFormComplianceAssetIdField=function(e){return!!(e&&e.schema&&o(e.schema.FieldType,e.schema.Id))};function o(e,n){return!(!e||"text"!==e.toLowerCase()||!n||n.toLowerCase()!==t.ASSETID_FIELD_ID.toLowerCase())}t.isComplianceAssetIdField=o;t.isClientFormComplianceTagField=function(e){return!!(e&&e.schema&&u(e.schema.FieldType,e.schema.Id))};function u(e,n){return!(!e||"lookup"!==e.toLowerCase()||!n||n.toLowerCase()!==t.COMPLIANCETAG_FIELD_ID.toLowerCase())}t.isComplianceTagField=u});
define("J7e",["require","exports","Ih","Y"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.taxonomyFieldTypeSingle="TaxonomyFieldType";t.taxonomyFieldTypeMulti="TaxonomyFieldTypeMulti";t.bulkEditEngagementName=".BulkEdit.";t.notBulkEditEngagementName=".NotBulkEdit.";t.TERM_DELIMITER=";";t.onChangingTagsEngagementName="OnChangingTags";t.logTaggingChanges=function(e,s){void 0===s&&(s=1);try{for(var o=e.fields.length,u=0;u<o;u++)if(e.fields[u].schema.FieldType===t.taxonomyFieldTypeSingle||e.fields[u].schema.FieldType===t.taxonomyFieldTypeMulti){var a=i(e.fields[u].serverData,e.fields[u].data);if(0===a.addedTagsCount&&0===a.deletedTagsCount)continue;var f=e.fields[u].schema.FieldType.toLowerCase();e.isBulkEdit||s>1?f+=t.bulkEditEngagementName:f+=t.notBulkEditEngagementName;f+=t.onChangingTagsEngagementName;for(var l=0;l<s;l++)n.Engagement.logData({name:f,isIntentional:!0,extraData:{deletedTagsCount:a.deletedTagsCount,addedTagsCount:a.addedTagsCount}})}}catch(e){r.default.logError(e,{eventName:t.onChangingTagsEngagementName});return}};function i(e,t){var n=s(e),r=s(t),i=0,o=Object.keys(n).length,u=Object.keys(r).length;if(o>0&&u>0)for(var a in n)r[a]&&i++;return{deletedTagsCount:o-i,addedTagsCount:u-i}}t.getModifiedTagsCount=i;function s(e){if(!e)return{};for(var n={},r=0,i=e.split(t.TERM_DELIMITER);r<i.length;r++){n[i[r]]=!0}delete n[""];return n}t.separateTags=s});
define("XOe",["require","exports","ZOe","mv","X_"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Html5FileUpload=n.Html5FileUpload;t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,n.Html5FileUpload,{platformDetection:r.platformDetection});t.default=n.Html5FileUpload});
define("ZOe",["require","exports","Uk","A2"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=0,s=(function(){function e(e,t){var s=e.file;this._file=s;this.eTag=s.eTag;var o,u=s.fileName||s.name,a=r.splitFileName(u),f=a.name,l=a.extension;this.extension=l;this.iconName=n.getIconNameFromExtension(l);this.size=s.size;if(t.platformDetection.isIOS&&"image"===f&&"photo"===this.iconName){var c=s.lastModifiedDate,h=void 0===c?new Date:c;o="IMG_"+this._getLastModifiedISO8601(h)+"_"+ ++i+l}else o=u;s.lastModifiedDate&&(this.lastModifiedDate=s.lastModifiedDate);this.name=o}e.prototype.slice=function(e,t){var n=this._file;return(n.slice||n.mozSlice||n.webkitSlice).call(n,e,t)};e.prototype._getLastModifiedISO8601=function(e){return e.getUTCFullYear()+"-"+o(e.getUTCMonth()+1,2)+"-"+o(e.getUTCDate(),2)+" "+o(e.getUTCHours(),2)+"-"+o(e.getUTCMinutes(),2)+"-"+o(e.getSeconds(),2)};return e})();t.Html5FileUpload=s;function o(e,t){for(var n=""+e;n.length<t;)n="0"+n;return n}t.default=s});
define("FYe",["require","exports","lC","r","vre","bw","Xw","Zd","am","YYe","Y","QYe","qYe","WYe","jYe","RYe","S3","HE","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._createModelPanelContent=r.createRef();s.onRenderFooterContent=function(){return r.createElement(i.Stack,{gap:15},r.createElement(i.Stack.Item,{className:"footerDescription"},r.createElement(g.Text,null,f.default.AIBuilderContinueText)),r.createElement(i.Stack.Item,null,r.createElement(a.PrimaryButton,{onClick:s.onCreateClick,style:{marginRight:"8px"},disabled:s.state.isWorking||s.state.isLoading||!s.state.requireFieldSatisfied},f.default.NextText),r.createElement(a.DefaultButton,{onClick:s.props.onDismiss},f.default.CancelText)))};s.onCreateClick=function(){return n.__awaiter(s,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:if(!this._createModelPanelContent.current)return[2];this.setState({isWorking:!0});return[4,this._createModelPanelContent.current.onCreate()];case 1:e=t.sent();this.setState({isWorking:!1});this.props.onComplete(!!e);return[2]}})})};s.state={loadingError:"",isLoading:!0,isWorking:!1,requireFieldSatisfied:!1};s._listAIModelDataSource=s.props.resources.consume(c.resourceKey);s._contentTypeDataSource=s.props.resources.consume(h.resourceKey);s._peopleDataSource=s.props.resources.consume(p.resourceKey);return s}t.prototype.componentDidMount=function(){var e,t;return n.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u,a,f,c,h,p,d,v,g;return n.__generator(this,function(n){switch(n.label){case 0:r=this.props.createModelContext,i=r.webAbsoluteUrl,s=r.listId;n.label=1;case 1:n.trys.push([1,9,,10]);return[4,this._listAIModelDataSource.getListAIModel(i,s)];case 2:o=n.sent();if(!(u=null===(e=o)||void 0===e?void 0:e.predictionModel)){this.setState({isLoading:!1,loadingError:"",viewModelContext:void 0});return[2]}if(u.modifiedBy)return[3,3];f=void 0;return[3,5];case 3:return[4,this._peopleDataSource.getPeopleByLoginName(i,u.modifiedBy)];case 4:f=n.sent();n.label=5;case 5:a=f;if(u.contentTypeId)return[3,6];h=void 0;return[3,8];case 6:return[4,this._contentTypeDataSource.getContentTypeById(i,s,u.contentTypeId)];case 7:h=n.sent();n.label=8;case 8:c=h;this.setState({isLoading:!1,loadingError:"",viewModelContext:{model:u,people:a,contentType:c}});return[3,10];case 9:p=n.sent();d=null===(t=this.props.resources.consume(m.pageContext))||void 0===t?void 0:t.CorrelationId;v="";if(p&&p.message&&p.message.value){v=p.message.value;g=p.correlationiId||d||"";v=v+" correlationId: "+g}else v=JSON.stringify(p);l.default.log("[CreateAIBModelPanel] Error "+v);this.setState({isLoading:!1,loadingError:v||"Please try again later. CorrelationId: "+d,viewModelContext:void 0});return[3,10];case 10:return[2]}})})};t.prototype.render=function(){var e=this,t=this.state,n=t.isLoading,a=t.loadingError,l=t.viewModelContext,c=n,h=!n&&!a,p=!!(l&&l.model&&l.model.id&&l.model.environment),m=!n&&p,g=!n&&!p||!this.props.createModelContext.isPredictionModelApplied&&!p;return r.createElement(s.Panel,{closeButtonAriaLabel:f.default.CloseText,headerText:g?f.default.CreateModelHeader:m?f.default.ViewModelHeader:"",isOpen:!0,isFooterAtBottom:!0,isLightDismiss:!0,onDismiss:this.props.onDismiss,onRenderFooterContent:g?this.onRenderFooterContent:void 0,type:s.PanelType.smallFixedFar},m&&r.createElement(v.ViewModelPanelContent,{resources:this.props.resources,viewModelContext:l}),g&&r.createElement(d.CreateModelPanelContent,{ref:this._createModelPanelContent,createModelContext:this.props.createModelContext,resources:this.props.resources,getRequiredFieldSatisfied:function(t){e.setState({requireFieldSatisfied:t})}}),c&&r.createElement(i.Stack,null,r.createElement(u.Spinner,{size:u.SpinnerSize.small,className:"CreateAIBModelPanel-separator",ariaLive:"assertive",labelPosition:"right",label:f.default.LoadingText})),h&&r.createElement(i.Stack,null,r.createElement(o.Label,{className:"ErrorTextStyle"},a)))};return t})(r.Component);t.default=y});
define("QYe",["require","exports","lC","SJ","X_","S3","Y"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(){}e.Online="Online";e.Offline="Offline";return e})();t.ModelState=u;var a=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getListAIModel=function(e,t){var n=e+"/_api/web/Lists('"+t+"')/rootfolder/properties?$select=vti_x005f_modellibrary,vti_x005f_predictionmodelid,vti_x005f_predictionmodel";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t;return null===(t=JSON.parse(e))||void 0===t?void 0:t.d},qosName:"getListModelProperty",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}}).then(function(e){var t=e.vti_x005f_modellibrary||"",n=t?{driveId:t}:void 0,r=e.vti_x005f_predictionmodelid||"",i=e.vti_x005f_predictionmodel||"",s=[];if(i)try{s=JSON.parse(i)}catch(e){o.default.logError("JSON parse failed for vti_x005f_predictionmodel propety value: "+i)}var u=r&&s&&s.length>0?s.find(function(e){return e.id===r}):void 0;return{machineTeachingModel:n,predictionModel:u||(!u&&r?{id:r}:void 0)}})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=a;t.resourceKey=i.createResolvedResourceKey(e("module").id,a)});
define("qYe",["require","exports","lC","SJ","X_","S3"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getMachineTeachingContentTypes=function(e,t,n,r){return this.getContentTypes(e,t,"$select=Name,Discription,Group,StringId,SchemaXml","$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/machinelearning/modelid', SchemaXml) eq true",n,r)};t.prototype.getFormProcessingContentTypes=function(e,t,n,r){return this.getContentTypes(e,t,"$select=Name,Discription,Group,StringId,SchemaXml","$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/formprocessing/models', SchemaXml) eq true",n,r)};t.prototype.getSiteContentTypes=function(e,t,n,r){var i=t?"$filter=Group eq '"+t+"'":void 0;return this.getContentTypes(e,void 0,"$select=Name,Discription,Group,StringId",i,n,r)};t.prototype.addContentTypeToList=function(e,t,n){var r={contentTypeId:n},i=e+"/_api/web/Lists('"+t+"')/contenttypes/AddAvailableContentType";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t=JSON.parse(e);return{id:t.StringId,name:t.Name,discription:t.Discription,group:t.Group}},qosName:"addContentTypeToList",additionalPostData:JSON.stringify(r),method:"POST"})};t.prototype.createSiteContentType=function(e,t,n){var r={parameters:{__metadata:{type:"SP.ContentTypeEntityData"},Name:t.name,Description:t.discription,Group:t.group,ParentContentTypeId:n}},i=e+"/_api/web/contenttypes/create";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t,n,r,i,s,o,u,a,f=JSON.parse(e);return{id:null===(n=null===(t=f)||void 0===t?void 0:t.d)||void 0===n?void 0:n.StringId,name:null===(i=null===(r=f)||void 0===r?void 0:r.d)||void 0===i?void 0:i.Name,discription:null===(o=null===(s=f)||void 0===s?void 0:s.d)||void 0===o?void 0:o.Discription,group:null===(a=null===(u=f)||void 0===u?void 0:u.d)||void 0===a?void 0:a.Group}},qosName:"createSiteContentType",additionalPostData:JSON.stringify(r),method:"POST"})};t.prototype.createSiteContentTypeLegacy=function(e,t){var n={__metadata:{type:"SP.ContentType"},Name:t.name,Description:t.discription,Group:t.group},r=e+"/_api/web/contenttypes";return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t,n,r,i,s,o,u,a,f=JSON.parse(e);return{id:null===(n=null===(t=f)||void 0===t?void 0:t.d)||void 0===n?void 0:n.StringId,name:null===(i=null===(r=f)||void 0===r?void 0:r.d)||void 0===i?void 0:i.Name,discription:null===(o=null===(s=f)||void 0===s?void 0:s.d)||void 0===o?void 0:o.Discription,group:null===(a=null===(u=f)||void 0===u?void 0:u.d)||void 0===a?void 0:a.Group}},qosName:"createSiteContentType",additionalPostData:JSON.stringify(n),method:"POST"})};t.prototype.getContentTypeById=function(e,t,n){var r=t?e+"/_api/web/Lists('"+t+"')/contenttypes/getbyid('"+n+"')":e+"/_api/web/contenttypes/getbyid('"+n+"')";return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t,n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d;return n?{id:n.StringId,name:n.Name,discription:n.Discription,group:n.Group}:void 0},qosName:t?"getListContentTypeById":"getSiteContentTypeById",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.prototype.getContentTypes=function(e,t,n,r,i,s){var o=n;o+=o&&r?"&":"";o+=r||"";o+=o&&i?"&":"";o+=i?"$top="+i:"";o+=o&&s?"&":"";o=(o+=s?"$skip="+s:"")?"?"+o:"";var u=t?e+"/_api/web/Lists('"+t+"')/contenttypes"+o:e+"/_api/web/contenttypes"+o;return this.dataRequestor.getData({url:u.toString(),parseResponse:function(e){var t,n,r,i,s=JSON.parse(e);return((null===(n=null===(t=s)||void 0===t?void 0:t.d)||void 0===n?void 0:n.results)?null===(i=null===(r=s)||void 0===r?void 0:r.d)||void 0===i?void 0:i.results:[]).map(function(e){return{id:e.StringId,name:e.Name,discription:e.Discription,group:e.Group}})},qosName:t?"getListContentTypes":"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("WYe",["require","exports","lC","SJ","X_","S3"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getPeopleByLoginName=function(e,t){var n=e+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(AccountName=@v)?@v='"+encodeURIComponent(t)+"'&$select=AccountName,DisplayName,Email,Title";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t,n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d;return n?{accountName:n.AccountName,displayName:n.DisplayName,email:n.Email,title:n.Title}:void 0},qosName:"getPeopleProperties",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("jYe",["require","exports","lC","r","HF","Zd","hne","Xw","vre","EF","HE","SE","KYe","Y","Dqe","qYe","GYe","om","zYe","pe","vh","pd","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){n.__extends(t,e);function t(t){var c=e.call(this,t)||this;c._renderAdvancedSettings=function(){var e=c.state.showAdvancedSettings;return r.createElement("div",null,c._renderAdvancedSettingsHeader(),e&&c._renderAdvancedSettingsContent())};c._toggleAdvancedSettings=function(){c.setState({showAdvancedSettings:!c.state.showAdvancedSettings},function(){c._postAdvancedSettingsToggleActions(c.state.showAdvancedSettings)})};c._postAdvancedSettingsToggleActions=function(e){var t=e?"AdvancedSettingsExpanded":"AdvancedSettingsCollapsed",n=e?h.default.AdvancedSettingsExpandedScreenReaderText:h.default.AdvancedSettingsCollapsedScreenReaderText;c._engagement&&c._engagement.logData({name:t,isIntentional:!0,component:"CreateFormProcessingModelPanel"});y.default.alert(t,n)};c._screenReaderCall=function(){var e=c.state.showAdvancedSettings?"collapse":"expand";y.default.alert("Click here to "+e+" advanced settings panel",b.format(h.default.ScreenReaderCallText,e))};c._renderAdvancedSettingsHeader=function(){var e=c.state.showAdvancedSettings;return r.createElement("div",{onFocus:c._screenReaderCall,onClick:c._toggleAdvancedSettings,className:"sp-CreateAIBModelPanel-AdvancedSettingsHeader"},r.createElement("div",{className:"sp-CreateAIBModelPanel-AdvancedSettingsHeaderText"},h.default.AdvancedSettingsText),r.createElement(g.IconButton,{style:{fontSize:"13px"},className:"sp-CreateAIBModelPanel-ChevronColor",iconProps:{iconName:e?"ChevronUp":"ChevronDown"},title:h.default.AdvancedSettingsText,ariaLabel:e?h.default.HideAdvancedSettingsText:h.default.ShowAdvancedSettingsText}))};c._renderAdvancedSettingsContent=function(){return r.createElement("div",{className:"sp-CreateAIBModelPanel-AdvancedSettingsExpandedMargin"},c._renderAssociatedContentTypeHeader(),c._renderDescriptionText(),c._renderChoiceGroup(),c._renderContentTypesDropdown(),c._renderViewSetting())};c._renderAssociatedContentTypeHeader=function(){return r.createElement(u.Label,{styles:{root:{marginTop:"20px"}}},r.createElement(a.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,h.default.ContentTypeHeaderFormProcessing," ")))};c._renderDescriptionText=function(){return r.createElement(l.Text,null," ",h.default.AdvancedSettingsDescription)};c._renderChoiceGroup=function(){var e=[{key:"create",text:h.default.createContentType},{key:"select",text:h.default.selectContentType}];return r.createElement(i.ChoiceGroup,{options:e,onChange:c.onChoiceGroupSelectedChange,selectedKey:c.state.contentTypeOperationSelected})};c._renderContentTypesDropdown=function(){var e=c.state,t=e.contentTypeOperationSelected,n=e.errorMessage,i=e.contentTypeOptions,u=e.loadingCompleted;return r.createElement(r.Fragment,null,"select"===t&&r.createElement(r.Fragment,null,r.createElement(o.Dropdown,{ariaLabel:h.default.selectContentTypeIndicator,className:"sp-CreateAIBModelPanel-Dropdown",errorMessage:n,onChange:c.onDropdownSelectionChange(),options:i}),!u&&r.createElement(a.Stack.Item,null,r.createElement(s.Spinner,{size:s.SpinnerSize.small,className:"sp-CreateAIBModelPanel-Spinner",ariaLive:"assertive",labelPosition:"right",label:h.default.LoadingText}))))};c._renderViewSetting=function(){return r.createElement("div",{className:"sp-CreateAIBModelPanel-ViewContainer"},r.createElement(a.Stack,{gap:10},r.createElement(l.Text,null,h.default.LibraryViewCreateDiscrptionText),r.createElement(f.Checkbox,{ariaLabel:h.default.LibraryViewSetDefaultToggleText,defaultChecked:!0,label:h.default.LibraryViewSetDefaultToggleText,onChange:c.onCheckboxChange})))};c.onTextFieldChange=function(e,t){c.setState({contentTypeName:t||"",errorMessage:""});c.props.getRequiredFieldSatisfied(""!==t)};c.onChoiceGroupSelectedChange=function(e,t){c.setState({contentTypeOperationSelected:t.key,contentTypeSelected:"select"===t.key?{key:"",value:""}:c.state.contentTypeSelected,errorMessage:""})};c.onDropdownSelectionChange=function(){return function(e,t,n,r){var i=t&&t.key||"",s=t&&t.text||r;c.setState({contentTypeSelected:{key:i,value:s},contentTypeName:s,errorMessage:""})}};c.onCheckboxChange=function(e,t){c.setState({isSetDefaultViewRequired:t})};c.onCreateClick=function(){return n.__awaiter(c,void 0,void 0,function(){var e,t,r,i,s,o,u,a,f,l,c,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B;return n.__generator(this,function(n){switch(n.label){case 0:e=this.state,t=e.contentTypeOperationSelected,r=e.contentTypeSelected,i=e.isSetDefaultViewRequired,s=e.contentTypeName;o=this.props.createModelContext,u=o.webAbsoluteUrl,a=o.listId,f=o.listFullUrl;l=r.key;c=r.value;this.setState({isCreating:!0});if("select"===t&&!c){this.setState({isCreating:!1,errorMessage:h.default.ContentTypeNameInvalidText});return[2,!1]}if("create"!==t)return[3,4];if(!s){this.setState({isCreating:!1,errorMessage:h.default.ContentTypeNameInvalidText});return[2,!1]}n.label=1;case 1:n.trys.push([1,3,,4]);v={name:s,group:"Intelligent Document Content Types",discription:"",id:""};return[4,this._contentTypeDataSource.createSiteContentType(u,v,"0x0101")];case 2:m=n.sent();l=m.id;c=m.name;return[3,4];case 3:g=n.sent();T=null===(A=null===(L=g)||void 0===L?void 0:L.message)||void 0===A?void 0:A.value;"183, Microsoft.SharePoint.SPException"===(null===(O=g)||void 0===O?void 0:O.code)&&(T=h.default.ContentTypeNameAlreadyUsed);this.setState({isCreating:!1,errorMessage:T});p.default.log("[CreateModelPanelContent] create content type api call failed: "+(null===(_=null===(M=g)||void 0===M?void 0:M.message)||void 0===_?void 0:_.value));return[2,!1];case 4:y="";n.label=5;case 5:n.trys.push([5,12,,13]);return[4,this._viewDataSource.getViews(u,a)];case 6:b=n.sent();w=b.filter(function(e){return e.title===c});E=w.filter(function(e){return!e.isHidden});return 0!==w.length?[3,8]:[4,this._viewDataSource.createView(u,a,c)];case 7:S=n.sent();y=S.id;return[3,11];case 8:if(!(E.length>0))return[3,9];y=E[0].id;return[3,11];case 9:return[4,this._viewDataSource.createView(u,a,c)];case 10:S=n.sent();y=S.id;n.label=11;case 11:return[3,13];case 12:x=n.sent();T=null===(P=null===(D=x)||void 0===D?void 0:D.message)||void 0===P?void 0:P.value;this.setState({isCreating:!1,errorMessage:T});p.default.log("[CreateModelPanelContent] create view api call failed: "+(null===(B=null===(H=x)||void 0===H?void 0:H.message)||void 0===B?void 0:B.value));return[2,!1];case 13:N=d.getAIBuilderRunTimeHost();C={contentTypeId:l,setViewAsDefault:i};k=("modelNameSeed="+encodeURIComponent(c)).concat("&templateName=SharePointFormProcessing","&context.sharepoint.site="+encodeURIComponent(u),"&context.sharepoint.list="+encodeURIComponent(a),"&context.sharepoint.listfullurl="+encodeURIComponent(f),"&context.sharepoint.view="+encodeURIComponent(y),"&context.sharepoint.context="+encodeURIComponent(JSON.stringify(C)));window.open("https://"+N+"/aibuilder/createModel?"+k,"_blank");this.setState({isCreating:!1});return[2,!0]}})})};c.state={contentTypeOperationSelected:"create",errorMessage:"",contentTypeDropdownOptions:[],contentTypeOptions:[],contentTypeSelected:{key:"",value:""},loadingCompleted:!1,isCreating:!1,isSetDefaultViewRequired:!0,contentTypeName:"",showAdvancedSettings:!1};c._contentTypeDataSource=c.props.resources.consume(v.resourceKey);c._viewDataSource=c.props.resources.consume(m.resourceKey);c._engagement=c.props.resources.consume(w.resourceKey);c._modelNameTextFieldRef=r.createRef();return c}t.prototype.onCreate=function(){return this.onCreateClick()};t.prototype.componentDidMount=function(){var e=this,t=this.props.createModelContext.webAbsoluteUrl;this._contentTypeDataSource.getSiteContentTypes(t,"Intelligent Document Content Types").then(function(t){var n=[];(t=t.filter(function(e){return e.id.startsWith("0x0101")})).sort(function(e,t){return e.name.toUpperCase()>t.name.toUpperCase()?1:-1});t.forEach(function(e){n.push({key:e.id,text:e.name})});e.setState({contentTypeOptions:n,loadingCompleted:!0});e._modelNameTextFieldRef&&e._modelNameTextFieldRef.current&&e._modelNameTextFieldRef.current.focus()}).catch(function(t){var n,r;e.setState({loadingCompleted:!0});p.default.log("[CreateModelPanelContent] fetching content types failed "+(null===(r=null===(n=t)||void 0===n?void 0:n.message)||void 0===r?void 0:r.value))})};t.prototype.render=function(){var e=this.state,t=e.contentTypeOperationSelected,n=e.contentTypeName,i=e.isCreating;return r.createElement(r.Fragment,null,r.createElement(a.Stack,{gap:15},r.createElement(a.Stack.Item,{styles:{root:{marginTop:"15px"}}},r.createElement(l.Text,null,h.default.CreateModelInstructionText+" "),r.createElement(E.Link,{href:"https://go.microsoft.com/fwlink/?linkid=2128020",target:"_blank"},""+h.default.LearnMoreLinkText)),r.createElement(a.Stack.Item,{styles:{root:{marginBottom:"25px"}}},r.createElement(c.TextField,{componentRef:this._modelNameTextFieldRef,ariaLabel:h.default.ModelNameInputAriaLabel,errorMessage:"select"===t?"":this.state.errorMessage,value:n,disabled:"select"===t,label:h.default.ModelInputTextFieldLabel,onChange:this.onTextFieldChange})),r.createElement(a.Stack.Item,{className:"sp-CreateAIBModelPanel-AdvancedSettingsContainer"},this._renderAdvancedSettings()),r.createElement(a.Stack.Item,null,i&&r.createElement(s.Spinner,{size:s.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:""}))))};return t})(r.Component);t.CreateModelPanelContent=S});
define("GYe",["require","exports","lC","SJ","X_","S3"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getViews=function(e,t){var n=e+"/_api/web/Lists('"+t+"')/Views?$select=Id,Title,DefaultView,Hidden";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t,n,r,i,s=JSON.parse(e);return((null===(n=null===(t=s)||void 0===t?void 0:t.d)||void 0===n?void 0:n.results)?null===(i=null===(r=s)||void 0===r?void 0:r.d)||void 0===i?void 0:i.results:[]).map(function(e){return{id:e.Id,title:e.Title,isHidden:e.Hidden,isDefault:e.DefaultView}})},qosName:"getViews",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.prototype.createView=function(e,t,n){var r={parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:n,Query:'"<OrderBy><FieldRef Name="FileLeafRef"/></OrderBy>"',Paged:!0,PersonalView:!1,RowLimit:30,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:["DocIcon","LinkFilename","Modified","Editor","ContentType"]}}},i=e+"/_api/web/Lists('"+t+"')/Views/Add";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t,n,r,i,s,o,u,a,f=JSON.parse(e);return{id:null===(n=null===(t=f)||void 0===t?void 0:t.d)||void 0===n?void 0:n.Id,title:null===(i=null===(r=f)||void 0===r?void 0:r.d)||void 0===i?void 0:i.Title,isHidden:null===(o=null===(s=f)||void 0===s?void 0:s.d)||void 0===o?void 0:o.Hidden,isDefault:null===(a=null===(u=f)||void 0===u?void 0:u.d)||void 0===a?void 0:a.DefaultView}},qosName:"createView",additionalPostData:JSON.stringify(r),method:"POST"})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("zYe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.alert=function(t,n,r,i){void 0===r&&(r=!1);var s="sp_a11y_alert_"+t,o=document.querySelector("#"+s);o&&document.body.removeChild(o);var u=document.createElement("p");r||u.setAttribute("style",e._cssHidden);i&&u.classList.add(i);u.setAttribute("role","alert");u.setAttribute("aria-live","assertive");u.setAttribute("id",s);var a=document.createTextNode(n);document.body.appendChild(u);u.appendChild(a)};e._cssHidden="position:absolute;text-indent:-9999px;\n    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0;";return e})();t.default=n});
define("RYe",["require","exports","lC","r","Xw","vre","BYe","Dqe","am","S3","cy","MU","fy","fy","hh","QYe","L7","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._aiBuilderHost=u.getAIBuilderRunTimeHost();n.state={isMessageBarHidden:!1};n._pageContext=n.props.resources.consume(f.pageContext);return n}t.prototype.render=function(){var e,t=this.props.viewModelContext,n=t.people?{name:t.people.displayName,email:t.people.email,title:t.people.title,imageUrl:"/_layouts/15/userphoto.aspx?accountname="+encodeURIComponent(t.people.accountName)+"&size=S"}:void 0,u=null===(e=t.contentType)||void 0===e?void 0:e.name,f=t.model,l=f.id,c=f.environment,h=f.modifiedTimestamp&&parseInt(f.modifiedTimestamp,10)||void 0,p=f.state,d=h?new Date(h):void 0,g=d?m.getRelativeDateTimeStringPast(d):void 0,y=t.people?this._getUserUpn(t.people):void 0,b=this._pageContext.userPrincipalName,w=!(!y||!b)&&0===y.toUpperCase().localeCompare(b.toUpperCase());return r.createElement(s.Stack,{gap:25},r.createElement("div",null,r.createElement("span",null," ",o.default.ModelPublishedText)),!!c&&w&&r.createElement("div",null,r.createElement(a.PrimaryButton,{ariaDescription:o.default.ManageModelLinkText,href:"https://"+this._aiBuilderHost+"/environment/"+c+"/aibuilder/models/"+l,target:"_about"},o.default.ManageModelLinkText)),u&&r.createElement("div",null,r.createElement(i.Label,null,o.default.ModelLabelText),r.createElement("div",null,r.createElement("span",null,u))),(p===v.ModelState.Online||p===v.ModelState.Offline)&&r.createElement("div",null,r.createElement(i.Label,null,o.default.StatusLabelText),r.createElement("div",null,r.createElement("span",null,p===v.ModelState.Online?o.default.ModelPublishedStatusText:o.default.ModelUnpublishedStatusText)),g&&r.createElement("div",null,r.createElement("span",{className:"item-timeStamp"},g))),n&&r.createElement("div",null,r.createElement(i.Label,null,o.default.ModelOwnerLabelText),r.createElement("div",null,this._getPersonaControl(n))))};t.prototype._makeDeferredLpcProps=function(e){var t=this.props.resources.consume(d.resourceKey),n=p.waitForPageLoadWithTimeout(t);return{personaType:"User",identifier:e&&e.email,pageContext:this._pageContext,moduleLoader:h.getReactDeferredComponentModuleLoader(),customWaiter:n,addGroupMembersCallback:void 0,lpcHoverTargetProps:{upn:e&&e.email,hostAppPersonaInfo:{PersonaDisplayName:e&&e.name}}}};t.prototype._wrapPersona=function(e){var t=this;return function(n,i){var s=t._makeDeferredLpcProps(e);return l.wrapWithDeferredSpLivePersonaCard(s,r.createElement("div",null,i(n)))}};t.prototype._getPersonaControl=function(e){return r.createElement(c.Persona,{imageUrl:e.imageUrl,primaryText:e.name,secondaryText:e.title,size:c.PersonaSize.small,hidePersonaDetails:!1,onRenderCoin:this._wrapPersona(e),onRenderPrimaryText:this._wrapPersona(e),"data-automationid":"ModelPersona"})};t.prototype._getUserUpn=function(e){return e.accountName?e.accountName.slice(e.accountName.lastIndexOf("|")+1):e.email};return t})(r.Component);t.ViewModelPanelContent=g});
define("gy",["require","exports","lC","r","X_","tv","hh"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{pageLoadMonitor:o.resourceKey},create:function(t){var i=t.pageLoadMonitor,o=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,i.waitForPLT()];case 1:t.sent();return[4,new Promise(function(t,n){e(["HWe"],t,n)})];case 2:return[2,t.sent().SyncAction]}})})});return{instance:function(e,t){return"syncGroove"===t.syncState?{isAvailable:!0,fallbackAction:r.createElement(o,null)}:{}}}}}})});
define("JYe",["require","exports","lC","r","cE","$V","G5e","my","Ym","O1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t){return{addMetadataAction:null,checkInAction:null,policyTipAction:null,publishNowAction:null,showDetailsPane:null,showFeedbackPane:null,showFileAnalytics:null,showKeyPointsPane:null,undoCheckOutAction:null}}function c(e,t){return{isAvailable:!1}}var h=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(f.ControlHandlerProvider,{controlHandlers:n.__assign(n.__assign({},u.hoverCardCommandsControl.pack(l)),a.shareActionControl.pack(c))},r.createElement(i.ItemsPicker,n.__assign({},this.props)))};t.contextTypes=n.__assign({},s.RESOLVED_COMPONENT_CONTEXT_TYPES);return t})(r.PureComponent);t.ItemsPicker=h;t.resourceKey=s.createResolvedComponentTypeResourceKey(e("module").id,h,{});t.knockoutResourceKey=o.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-picker",name:e("module").id+".knockout"})});
define("XYe",["require","exports","X_","y6","wZ"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{resources:n.resourceScopeKey,isInfoPaneExpanded:i.resourceKey},create:function(e){return{instance:function(t,n){return{onSwitchLayout:function(t){return function(n){var i=e.isInfoPaneExpanded;t.layoutType===r.quickEditLayoutType&&i&&i.peek()&&i(!1)}}}}}}}})});
define("ZYe",["require","exports","lC","Xo","$Ye","li","ii","rs","ss","YD"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.onUploadCompletedHelper=function(e,t,l){var c=this;return function(h){return n.__awaiter(c,void 0,void 0,function(){var c,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:return t?[4,h(f.demandItems(function(e){e.demandItemFacet(r.childItemsFacet,t)}))]:[3,2];case 1:n.sent();v=h(u.readItems(function(e){var n=[];c=e.demandItemFacet(s.spFolderItemSetKeyFacet,t);p=s.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:c});d=e.demandItemFacet(r.childItemsFacet,p);if(l&&l.itemsScopeItemKey&&d&&d.itemKeys)for(var i=0,u=d.itemKeys;i<u.length;i++){var a=u[i],f=e.demandItemFacet(o.missingMetadataFieldsFacet,a);for(var h in f)if(f.hasOwnProperty(h)){n.push(a);break}}return n}));if(l&&l.itemsScopeItemKey&&d&&d.itemKeys&&v&&v.length>0){h(a.selectItems({itemsScopeItemKey:l.itemsScopeItemKey,selectedItemKeys:v,currentSelectionKey:void 0}));e.resources.consumeAsync(i.resourceKey).then(function(e){e(!0)})}n.label=2;case 2:return[2]}})})}}});
define("$Ye",["require","exports","t3","X_"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,loader:new r.AliasResourceLoader(function(){return n.loadModuleExport({path:"wZ",getModule:function(){return new Promise(function(t,n){e(["wZ"],t,n)})},getExport:function(e){return e.resourceKey}})})})});
define("eJe",["require","exports","r","gj","Ps","Km","tJe","X_","Ym","O1","pd","$We","Ih","C1","Xx","c0","jB","HB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=p.connectToItemCache(function(e,t){return{item:e.demandItemFacet(d.knockoutStoreItemFacet,t.itemKey)}})(r.withKnockoutComputed(function(e){var t=e.item;return{item:t&&t()}})(o.default));t.ItemHoverCardLauncher=v.withChildResources(function(e){e.exposeFactory(m.typeResourceKey,new u.AliasResourceFactory(g.typeResourceKey))},{owner:e("module").id})(function(e){var t=e.root,r=e.itemKey,o=v.useResourceScope(),u=function(e){return n.createElement(f.ControlHandlerProvider,{controlHandlers:a.shareActionControl.pack(function(t,n){return{defaultRecipients:e}})},n.createElement(i.WithAction,{action:n.createElement(s.ItemShareAction,{itemKey:r})},function(e){var r=e.isAvailable,i=e.execute,s=r?function(e){h.Engagement.logData({name:"FileHoverCard.RecommendedActions.ShareWith",isIntentional:!0});e.target=t;e.persist();i({event:e})}:void 0;return n.createElement(l.Link,{className:"ms-FileHoverCard-ShareWithLink",onClick:s},c.default.ShareWithThem)}))};return t&&r?n.createElement(i.WithAction,{action:n.createElement(s.ItemShareAction,{itemKey:r})},function(e){var i=e.isAvailable,s=e.execute,a=i?function(e){h.Engagement.logData({name:"FileHoverCard.CommandBar.ShareClick"});e.target=t;e.persist();s({event:e})}:void 0;return n.createElement(y,{itemKey:r,target:t,onClickShare:a,resources:o,onRenderShareWithPeople:u})}):n.createElement(n.Fragment,null)})});
define("tJe",["require","exports","lC","r","w1","e","H_e","KDe","F_e","px","m_e","ye","S3","d1","yh","WB","mv","vh","Ohe","s3e","n3","Ch","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(t){n.__extends(S,t);function S(n){var i=t.call(this,n)||this;i.onFileIconRender=function(){return r.createElement("div",{className:"ms-FileHoverCard-compactCard--fileIcon"},u.renderFileTypeIcon({item:i.props.item,size:32,resources:i.resources,isDisabled:!1}))};i.getAccessToken=function(){return b.getGraphAccessToken(i.state.graphDataSource,i.props.item)};i.onKeyPoints=function(e){i._engagement.logData({name:"FileHoverCard.KeyPoints.OpenEditPanel"});i._showKeyPointsAction(e,!1)};i.onSendFeedbackClick=function(e){i._engagement.logData({name:"FileHoverCard.KeyPoints.SendFeedback"});i._showKeyPointsAction(e,!0)};i.onView=function(e){new(i.resources.injected(i.actionMap.ShowItemAnalyticsAction))({item:s.observable(i.props.item)}).execute(e)};i.onShare=function(e){i._engagement.logData({name:"FileHoverCard.CommandBar.ShareClick"});i._selectItem(e);var t=new(i.resources.injected(i.actionMap.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey});i.props.onClickShare?i.props.onClickShare(e):t.execute(e)};i.onDetails=function(e,t){i._openInfoPane(e)};i.onFileCheckin=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.FileCheckIn"});i._selectItem(e);(new(i.resources.injected(i.actionMap.CheckInAction))).execute(e)};i.onDiscardCheckOut=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.DiscardCheckOut"});i._selectItem(e);(new(i.resources.injected(i.actionMap.UndoCheckOutAction))).execute(e)};i.onViewPolicyTip=function(t){i._engagement.logData({name:"FileHoverCard.LifeCycle.ViewPolicyTip"});i._selectItem(t);new Promise(function(t,n){e(["E7e"],t,n)}).then(w.getDefaultExport).then(function(e){new(i.resources.injected(e))({item:s.observable(i.props.item)}).execute(t)})};i.onAddMetadataNow=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.AddMetadata"});i._selectItem(e);new(i.resources.injected(i.actionMap.EditItemAction))({item:s.observable(i.props.item)}).execute(e)};i._onShareWithDefaultPeople=function(e,t){i._selectItem(e);var n=new(i.resources.injected(i.actionMap.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey,defaultRecipients:t});i.props.onClickShare?i.props.onClickShare(e):n.execute(e)};i.resources=n.resources;i.state={fileHoverCardStore:i.resources.consume(a.resourceKey.optional),graphDataSource:i.resources.consume(d.graph.optional),target:i.props.target};i.actionMap=i.resources.consume(f.actionMap);i._pageContext=i.resources.consume(h.pageContext);i._platform=i.resources.consume(m.platformDetection);i._engagement=i.resources.consume(g.resourceKey);i._itemSetSelectionModel=i.resources.consume(f.itemsSelection);i._scope=new E.default;return i}S.prototype.componentDidMount=function(){var e=this,t=this.resources.consumeAsync(a.resourceKey),n=this.resources.consumeAsync(d.graph);this._scope.trackPromise(t);this._scope.trackPromise(n);t.then(function(t){e.setState({fileHoverCardStore:t})});n.then(function(t){e.setState({graphDataSource:t})});if(this.props.getUpdatedTarget){var r=this.props.getUpdatedTarget();this.setState({target:r})}};S.prototype.componentWillUnmount=function(){this._scope.dispose()};S.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,i=e.graphDataSource;if(!this.props.item)return null;var s=this.props.item,u=s.appMap,a=s.dateModified,f=s.extension,l=s.graph,h=s.itemId,d=s.isPlaceholder,m=s.lifeCycleStatus,g=s.name,w=s.openUrl,E=s.properties,S=s.queryType,x=s.id;if(d)return null;var T=E&&E.modifiedByUser,N=b.getGraphItemUrl(i,this.props.item),C=T&&T.email,k=T&&T.title,L=T&&C?{displayName:k||"",id:h||"",email:C,image:c.getUserPhotoUrl({userLoginName:C})}:void 0,A=m&&m.isMalwareDetected?void 0:[{key:"share",iconProps:{iconName:"share"},title:v.default.Share,onClick:this.onShare}],O=this._platform.isMobile,M={itemTitle:g||"",item:{itemId:h,graph:l,extension:f,queryType:p.default[S||0],graphItemUrl:N,getAccessToken:this.getAccessToken,appMap:u,path:x},target:this.state.target,currentUserActivity:{activityDateTime:a||"",activityType:"Modified",actor:{user:L}},onDetails:this.canShowActions()?this.onDetails:void 0,onKeyPointsClick:this.onKeyPoints,onView:this.onView,onCheckIn:this.onFileCheckin,onDiscardCheckOut:this.onDiscardCheckOut,onViewPolicyTip:this.onViewPolicyTip,onAddMetadataNow:this.onAddMetadataNow,isViewCountClickable:!0,actionBarItems:this.canShowActions()?A:void 0,loginUserEmail:this._pageContext.userLoginName,userEmail:this._pageContext.userEmail,pageUrl:w,gapSpace:this.props.gapData?12+this.props.gapData.inlineCommandCount*y.COMMAND_BUTTON_WIDTH:0,onSendFeedbackClick:this.onSendFeedbackClick,onShareWith:this._onShareWithDefaultPeople,uniqueId:E&&E.uniqueId,onRenderFileTypeIcon:this.onFileIconRender,onRenderShareWithPeople:this.props.onRenderShareWithPeople};return t&&i&&!O?r.createElement(o.FileHoverCard,n.__assign({},M)):this.props.children?this.props.children:null};S.prototype.getChildContext=function(){return{fileHoverCardStore:this.state.fileHoverCardStore}};S.prototype._selectItem=function(e){new(this.resources.injected(this.actionMap.SelectAction))({item:s.observable(this.props.item),showProperties:!1}).execute(e)};S.prototype._showKeyPointsAction=function(e,t){new(this.resources.injected(this.actionMap.ShowKeyPointsAction))({item:s.observable(this.props.item),showFeedbackPanel:t}).execute(e)};S.prototype._openInfoPane=function(e){var t=s.observable(this.props.item);new(this.resources.injected(this.actionMap.SelectAction))({item:t,selectItems:[t],showProperties:!0}).execute(e)};S.prototype.canShowActions=function(){var e=this.props.item,t=s.observable(e);return!e.isPlaceholder&&this._itemSetSelectionModel.canSelectItem(t)};S.childContextTypes={fileHoverCardStore:i.object.isRequired};return S})(r.Component);t.default=S});
define("H_e",["require","exports","lC","K_e","q9","lR","V_e","dR","fR","VR","B_e","BR","iR","R_e"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t)});
define("K_e",["require","exports","lC","r","w1","dN","us","Ef","ku","oc","lR","VR","dR","fR","q_e","BR","iR","Ih","pe","kR","eM","E","W_e","TR","HR","cR","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";C=C.FileHoverCard_module_7;Object.defineProperty(t,"__esModule",{value:!0});t.CARD_DISMISS_DELAY=300;var k=(function(e){n.__extends(k,e);function k(t,n){var i=e.call(this,t,n)||this;i._hoverCardRenderQos=void 0;i._setHightAndAnalyticsResult=function(e){i.setState({itemAnalyticsResult:i._store.getItemAnalytics(e)})};i._onCardOpen=function(){T.default("FileHoverCard.CompactCardOpen",i.props.item);i._cardOpenTimeStamp=Date.now();i._compactCardElement||(i._hoverCardRenderQos=new E.Qos({name:"FileHoverCard.HoverCardRenderQos"}))};i._onCardClose=function(){i._expandedCardElement?T.default("FileHoverCard.Expanded.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}):T.default("FileHoverCard.Compact.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp});i.props.item.appMap===w.wordType&&(i.state.itemAnalyticsResult&&i._isKeyPointsAvailable(i.state.itemAnalyticsResult.data)?T.default("FileHoverCard.KeyPoints.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}):T.default("FileHoverCard.NoKeyPoints.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}))};i._getCardHeight=function(){var e=i._store.getItemAnalytics(i.props.item);if(e&&e.status===l.AnalyticsResultStatus.succeed&&e.data){if(i._shouldShowActivities(e))return 340;if(i._isKeyPointsAvailable(e.data))return 340;if(i._isLifecycleAvailable(e.data)&&e.data.lifeCycleStatus)return 70*e.data.lifeCycleStatus.length;if(e.data.isTrending)return 70}return 1};i._renderExpandedCard=function(){var e=i.state.itemAnalyticsResult;return!!e&&(i._isKeyPointsAvailable(e.data)||i._shouldShowActivities(e)||i._isLifecycleAvailable(e.data)||i._isRecommendedActionsAvailable(e))};i._hoverCardQosEnd=function(e){if(i._hoverCardRenderQos){e?i._hoverCardRenderQos.end({resultType:E.ResultTypeEnum.Failure,extraData:e}):i.state.itemAnalyticsResult.status===l.AnalyticsResultStatus.succeed?i._compactCardElement||i._expandedCardElement?i._hoverCardRenderQos.end({resultType:E.ResultTypeEnum.Success}):i._hoverCardRenderQos.end({resultType:E.ResultTypeEnum.Failure}):i._hoverCardRenderQos.end({resultType:E.ResultTypeEnum.Success});i._hoverCardRenderQos=void 0}};i._onRenderCompactContent=function(){var e,t=i.props,n=t.itemTitle,s=t.actionBarItems,u=t.isViewCountClickable,a=t.onRenderFileTypeIcon,f=p.getFileHoverCardStrings(),l=i.state.itemAnalyticsResult,c=r.createElement("div",{className:o.css(C.fileHoverCardCompactCardTitle,(e={},e[C.titleNotExpanded]=!i._expandedCardElement,e)),id:"ms-FileHoverCard-title","aria-label":y.format(N.default.hoverCardTitle,n)},n),d=r.createElement("div",{className:C.fileHoverCardCompactCardTitleRegion},r.createElement("div",{className:C.fileHoverCardCompactCardFileIcon},a&&a()),c);return r.createElement("div",{ref:i._onCompactCardRef,className:o.css(C.fileHoverCardCompactCard,{isFluent:!0}),"aria-labelledby":"ms-FileHoverCard-title ms-FileHoverCard-compactCard--latestActivity"},d,r.createElement(h.AnalyticsActionBar,{analyticsStats:{itemAnalytics:l&&l.data,onClick:i._onView,onLikeClick:i._onLikeClick,pageUrl:i.props.pageUrl,disableViewerCount:u,status:l&&l.status,isNotSupported:!1},items:s||[],showActionBar:s&&s.length>0,isLink:u,farItems:[{key:"details",title:f.details,name:f.details,ariaLabel:f.details,onClick:i._onDetails}]}))};i._onRenderExpandedContent=function(){var e=i.state.itemAnalyticsResult,t=i.state.itemAnalyticsResult,n=t.data,s=t.skipToken,u=i._isKeyPointsAvailable(n),a=i._shouldShowActivities(e),f=i._isRecommendedActionsAvailable(e);return r.createElement("div",{className:o.css(C.fileHoverCardExpandedCard,{isFluent:!0}),ref:i._onExpandedCardRef},!!(n&&n.lifeCycleStatus&&i._isLifecycleAvailable(n))&&n.lifeCycleStatus.slice(0,2).map(function(e){return i._getAnalyticsLifeCycle(e)}),(u||a||f)&&r.createElement("div",{className:C.fileHoverCardExpandedCardScrollableSection},u&&n&&n.keyPointsData&&r.createElement(v.AnalyticsKeyPoints,{item:i.props.item,keyPointsData:n.keyPointsData,onKeyPointsClick:i.props.onKeyPointsClick,onSendFeedbackClick:i.props.onSendFeedbackClick}),f&&e.actions&&r.createElement(x.RecommendedActions,{ref:i._onRecommendedActionsRef,item:i.props.item,actions:e.actions,loginUserEmail:i.props.loginUserEmail,userEmail:i.props.userEmail,pageUrl:i.props.pageUrl,onShareWith:i.props.onShareWith,onDismiss:i._onDismiss,onRenderShareWithPeople:i.props.onRenderShareWithPeople}),a&&n&&r.createElement("div",{className:C.fileHoverCardActivitiesSection},r.createElement(c.AnalyticsActivityList,{itemAnalytics:n,moreActivities:!!s,onLoadMoreActivities:function(){return i._store.fetchItemAnalytics(i.props.item,s)},loginUserEmail:i.props.loginUserEmail,userEmail:i.props.userEmail}))))};i._onDismiss=function(e,t){var n=i.props,r=n.item,s=n.itemTitle,o=n.uniqueId;i._store.dismissRecommendedAction(r,s,e,o,t)};i._shouldShowActivities=function(e){var t=e&&e.data&&e.data.activities,n=i.props,r=n.isViewCountClickable,s=n.loginUserEmail,o=n.userEmail;return Boolean(r&&t&&(t.length>1||1===t.length&&!b.isCurrentLoginUser(t[0].actor.user.email,s,o)))};i._onCompactCardRef=function(e){if(e){i._compactCardElement=e;i._store.fetchItemAnalytics(i.props.item)}};i._onExpandedCardRef=function(e){if(e){i._expandedCardElement=e;T.default("FileHoverCard.ExpandedCardOpen",i.props.item,{time:Date.now()-i._cardOpenTimeStamp})}};i._onRecommendedActionsRef=function(e){if(e){var t=i.state.itemAnalyticsResult.actions;T.default("FileHoverCard.RecommendedActions.Render",i.props.item,{activityType:t&&t.recommendedActions&&t.recommendedActions.length>0?"HighActivities":"LowActivities"})}};i._onView=function(e){g.Engagement.logData({name:"FileHoverCard.ViewCountClick"});i.props.onView(e,i.props);e.stopPropagation();e.preventDefault()};i._onLikeClick=function(){g.Engagement.logData({name:"FileHoverCard.LikeClick"})};i._onDetails=function(e){if(e){g.Engagement.logData({name:"FileHoverCard.SeeDetailsClick"});i.props.onDetails(e,i.props);e.stopPropagation();e.preventDefault()}};i._cleanCachedItem=function(){i._store.cleanCachedItem(i.props.item)};i._updateExpandedHeight=function(){var e=i._compactCardElement.clientHeight+i._expandedCardElement.clientHeight,t=i.state.itemAnalyticsResult&&(i._isKeyPointsAvailable(i.state.itemAnalyticsResult.data)||i._shouldShowActivities(i.state.itemAnalyticsResult));e<346&&t&&i.state.expandedCardHeight!==346-i._compactCardElement.clientHeight?i.setState({expandedCardHeight:346-i._compactCardElement.clientHeight}):(e>346&&i.state.expandedCardHeight!==i._expandedCardElement.clientHeight||e<346&&!t&&i.state.expandedCardHeight!==i._expandedCardElement.clientHeight)&&i.setState({expandedCardHeight:i._expandedCardElement.clientHeight})};i._store=n.fileHoverCardStore;i._cardOpenTimeStamp=0;i.state={itemAnalyticsResult:i._store.getItemAnalytics(i.props.item),expandedCardHeight:i._getCardHeight(),compactCardHeight:131};return i}k.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this._setHightAndAnalyticsResult(e.item)};k.prototype.componentDidUpdate=function(){this._expandedCardElement&&this._expandedCardElement.clientHeight&&this._updateExpandedHeight();this._compactCardElement&&0!==this._compactCardElement.clientHeight&&this.state.compactCardHeight!==this._compactCardElement.clientHeight&&this.setState({compactCardHeight:this._compactCardElement.clientHeight});this.state.itemAnalyticsResult&&this._hoverCardQosEnd()};k.prototype.componentDidMount=function(){var e=this,t=this.props.item,n=this._store;this._storeListener=n.addListener(function(){e._setHightAndAnalyticsResult(t)},t)};k.prototype.componentWillUnmount=function(){this._store.removeListener(this._storeListener,this.props.item);this._store.cleanCachedItem(this.props.item)};k.prototype.render=function(){var e=this.props,t=e.responsiveMode,i=e.cardDismissDelay,o=e.directionalHint,a=e.gapSpace,l=e.target,c=e.children,h=this.state,p=h.expandedCardHeight,d=h.compactCardHeight,v={expandedCardScroll:C.fileHoverCardExpandedCardHostScroll},m=n.__assign({root:{boxShadow:f.getTheme().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},v),g={onRenderCompactCard:this._onRenderCompactContent,onRenderExpandedCard:this._renderExpandedCard()?this._onRenderExpandedContent:void 0,compactCardHeight:d,expandedCardHeight:p,directionalHint:o,directionalHintFixed:!1,gapSpace:a,styles:m};return t&&t>u.ResponsiveMode.medium?r.createElement(S.ErrorBoundary,{qosEvent:this._hoverCardQosEnd},r.createElement(s.HoverCard,{expandingCardProps:g,expandedCardOpenDelay:500,cardDismissDelay:i,target:l,onCardVisible:this._onCardOpen,onCardHide:this._onCardClose,trapFocus:!0})):r.createElement("div",null," ",c," ")};k.prototype._isKeyPointsAvailable=function(e){var t=e&&e.keyPointsData,n=Boolean(t&&t.keyPoints&&t.keyPoints.length>0),r=Boolean(t&&t.readTime&&t.readTime.minutes);return n||r};k.prototype._isLifecycleAvailable=function(e){var t=e&&e.lifeCycleStatus;return!!(t&&t.length>0)};k.prototype._isRecommendedActionsAvailable=function(e){return Boolean(e&&e.actions)&&m.isRecommendedActionsSupported(this.props.item.appMap,this.props.item.extension)};k.prototype._getAnalyticsLifeCycle=function(e){return r.createElement(d.AnalyticsLifeCycle,{key:e.createdRelativeTime,lifeCycleStatus:e,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onViewPolicyTip:this.props.onViewPolicyTip,onAddMetadataNow:this.props.onAddMetadataNow,onCheckIn:this.props.onCheckIn,onDiscardCheckOut:this.props.onDiscardCheckOut,cleanCachedItem:this._cleanCachedItem})};k.contextTypes={fileHoverCardStore:i.object.isRequired};k.defaultProps={directionalHint:a.DirectionalHint.rightTopEdge,cardDismissDelay:t.CARD_DISMISS_DELAY,gapSpace:0};return k=n.__decorate([u.withResponsiveMode],k)})(o.BaseComponent);t.FileHoverCard=k});
define("q_e",["require","exports","lC","r","pd","c_","pe","qq","kR","cR","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";l=l.AnalyticsLifeCycle_module_8;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onCheckInClick=function(e){n.props.onCheckIn(e);n.props.cleanCachedItem&&n.props.cleanCachedItem(e)};n._onDiscardCheckOutClick=function(e){n.props.onDiscardCheckOut(e);n.props.cleanCachedItem&&n.props.cleanCachedItem(e)};return n}t.prototype.render=function(){var e,t,n,c,h,p,d=this.props,v=d.lifeCycleStatus,m=d.loginUserEmail,g=d.userEmail,y=void 0;switch(v.status){case u.AnalyticsLifeCycleStatus.MalwareDetected:e=f.default.malwareDetected;t="https://go.microsoft.com/fwlink/?linkid=862871";h=f.default.learnMore;y=r.createElement(s.MalwareDetectedSignal,null);break;case u.AnalyticsLifeCycleStatus.ThisFileIsCheckedOut:var b=v.userCheckedOutThis;if(b&&b.email&&a.isCurrentLoginUser(b.email,m,g)){e=f.default.youHaveThisCheckedOut;n=this.props.onCheckIn&&this._onCheckInClick;c=this.props.onDiscardCheckOut&&this._onDiscardCheckOutClick;h=f.default.checkIn;p=f.default.discardCheckOut;y=r.createElement(s.YouCheckedOutSignal,null)}else{e=o.format(f.default.someoneElseHasThisFileCheckedOut,b&&b.displayName);y=r.createElement(s.SomeoneCheckedOutSignal,null)}break;case u.AnalyticsLifeCycleStatus.DLPBlocked:e=f.default.DLPBlocked;n=this.props.onViewPolicyTip;h=f.default.viewPolicyTip;y=r.createElement(s.BlockedSignal,null);break;case u.AnalyticsLifeCycleStatus.MissingMetaData:e=f.default.missingMetaData;n=this.props.onAddMetadataNow;h=f.default.addMetaData;y=r.createElement(s.MissingMetadataSignal,null);break;case u.AnalyticsLifeCycleStatus.DLPWarning:e=f.default.DLPWarning;n=this.props.onViewPolicyTip;h=f.default.viewPolicyTip;y=r.createElement(s.WarningSignal,null);break;case u.AnalyticsLifeCycleStatus.NeedsRepublishing:e=f.default.needsRepublishing;n=this.props.onPublishNow;h=f.default.publishNow;y=r.createElement(s.NeedsRepublishingSignal,null);break;case u.AnalyticsLifeCycleStatus.AwaitingApproval:e=f.default.awaitingApproval;y=r.createElement(s.AwaitingApprovalSignal,null);break;case u.AnalyticsLifeCycleStatus.Trending:e=f.default.trendingItem;y=r.createElement(s.TrendingSignal,null);break;case u.AnalyticsLifeCycleStatus.New:var w=v.creator;e=w&&w.email&&a.isCurrentLoginUser(w.email,m,g)?o.format(f.default.youCreated,v.createdRelativeTime):o.format(f.default.otherCreated,v.createdRelativeTime,w&&w.displayName);y=r.createElement("div",{className:l.fileHoverCardLifeCycleNewSignal},r.createElement(s.NewSignal,null))}return y&&r.createElement("div",{className:l.fileHoverCardLifeCycle},y,r.createElement("div",{className:l.fileHoverCardLifeCycleMessage},r.createElement("div",{className:l.fileHoverCardLifeCycleTitle},e),(n||t)&&r.createElement(i.Link,{className:l.fileHoverCardLifeCycleAction,href:t,target:t&&"_blank",onClick:n},h),c&&" or ",c&&r.createElement(i.Link,{className:l.fileHoverCardLifeCycleAction,onClick:c},p)))};return t})(r.Component);t.AnalyticsLifeCycle=c});
define("W_e",["require","exports","lC","r"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.prototype.componentDidCatch=function(e,t){this.props.qosEvent({error:e,errorInfo:JSON.stringify(t)});this.setState({hasError:!0})};t.prototype.render=function(){return this.state.hasError?null:r.createElement(r.Fragment,null,this.props.children)};return t})(r.Component);t.ErrorBoundary=i});
define("V_e",["require","exports","lC","lR","G_e","Fe","iN","ce","Mv","z_e"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=0,c=(function(){function e(e,t){this._dictListener={};this._itemAnalyticsDataSource=t.itemAnalyticsDataSource;this._dictItemAnalytics={};this._promiseDeduplicator=new i.default;t.pageContext&&(this._feedbackProvider=new f.FeedbackProvider({},{pageContext:t.pageContext,dataRequestorType:(function(e){n.__extends(r,e);function r(n){return e.call(this,n,{pageContext:t.pageContext})||this}return r})(a.DataRequestor)}));setInterval(this._cleanCache.bind(this),18e5)}e.prototype.addListener=function(e,t){var n=""+ ++l;this._dictListener[t.itemId]||(this._dictListener[t.itemId]={});this._dictListener[t.itemId][n]=e;return{key:n}};e.prototype.fetchItemAnalytics=function(e,t){var i=this;this._clearErrorResponse();if(!this._dictItemAnalytics[e.itemId]||!this._dictItemAnalytics[e.itemId].data)if(u.Killswitch.isActivated("30ddf998-5836-4a46-b116-41e73697fc75","6/6/2019","Switch to single query API to get item analytics"))this._promiseDeduplicator.deduplicate(e.itemId,function(){return s.default.all({allTimeItemAnalytics:i._itemAnalyticsDataSource.getItemAnalytics(e,{skipToken:t}),analyticsSections:i._itemAnalyticsDataSource.getAnalyticsSections(e)}).then(function(t){var s=t.allTimeItemAnalytics,o=t.analyticsSections,u=n.__assign(n.__assign({},o),s),a={status:r.AnalyticsResultStatus.succeed,data:u,skipToken:s&&s.skipToken,actions:void 0};i._dictItemAnalytics[e.itemId]=a;i._emitChange(e)},function(t){var n,s=t&&t.allTimeItemAnalytics;if(s&&"FileTypeNotSupported"===s.message)n=r.AnalyticsResultStatus.unsupport;else{if(s&&"Canceled"===s.message||"Canceled"===t)return;n=r.AnalyticsResultStatus.failed}i._dictItemAnalytics[e.itemId]={status:n,data:void 0,actions:void 0};t.error&&o.pageError(t.error);i._emitChange(e)})});else{this._dictItemAnalytics[e.itemId]={status:r.AnalyticsResultStatus.failed,data:void 0,actions:void 0};this._getAllAnalyticsData(e)}};e.prototype.getItemAnalytics=function(e){return this._dictItemAnalytics[e.itemId]};e.prototype.removeListener=function(e,t){this._dictListener[t.itemId][e.key]&&delete this._dictListener[t.itemId][e.key]};e.prototype.getDailyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e)};e.prototype.getMonthlyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e,720)};e.prototype.getAllTimeItemAnalytics=function(e){return this._itemAnalyticsDataSource.getItemAnalytics(e).then(function(e){var t=e.incompleteData&&e.incompleteData.missingDataBeforeDateTime;return n.__assign({activity:{},incompleteData:{missingDataBeforeDateTime:t&&new Date(t),wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},startDateTime:e.startDateTime&&new Date(e.startDateTime)},e)})};e.prototype.cleanCachedItem=function(e){this._dictItemAnalytics[e.itemId]&&delete this._dictItemAnalytics[e.itemId]};e.prototype.updateItemKeyPoints=function(e,t){var n=this;return this._itemAnalyticsDataSource.updateItemKeyPoints(e,t).then(function(t){var r=n._dictItemAnalytics[e.itemId];if(r&&r.data&&r.data.keyPointsData&&r.data.keyPointsData.keyPoints){var i=t.filter(function(e){return"Deleted"!==e.state});r.data.keyPointsData.keyPoints=i}n._emitChange(e)},function(){n._dictItemAnalytics[e.itemId]&&(n._dictItemAnalytics[e.itemId].status=r.AnalyticsResultStatus.failed);n._emitChange(e)})};e.prototype.dismissRecommendedAction=function(e,t,n,r,i){this._feedbackProvider.dismissRecommendedAction(e,t,n,r,i)};e.prototype._getItemAnalyticsByInterval=function(e,t){var n=new Date;n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()));var r=new Date,i=new Date;r.setDate(r.getDate()-90);i.setHours(r.getHours()-1440);return this._itemAnalyticsDataSource.getItemAnalyticsByInterval(e,r,n,t)};e.prototype._clearErrorResponse=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status===r.AnalyticsResultStatus.failed&&delete this._dictItemAnalytics[e]};e.prototype._emitChange=function(e){var t=this._dictListener[e.itemId];for(var n in t)t&&t[n]()};e.prototype._cleanCache=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status!==r.AnalyticsResultStatus.unsupport&&delete this._dictItemAnalytics[e]};e.prototype._getAllAnalyticsData=function(e){var t=this;this._promiseDeduplicator.deduplicate(e.itemId,function(){return t._itemAnalyticsDataSource.getItemAnalyticsSections(e)}).then(function(n){t._dictItemAnalytics[e.itemId].status=r.AnalyticsResultStatus.succeed;t._dictItemAnalytics[e.itemId].data=n;t._emitChange(e)},function(n){var i,s=n&&n.allTimeItemAnalytics;if(s&&"FileTypeNotSupported"===s.message)i=r.AnalyticsResultStatus.unsupport;else{if(s&&"Canceled"===s.message||"Canceled"===n)return;i=r.AnalyticsResultStatus.failed}t._dictItemAnalytics[e.itemId].status=i;t._dictItemAnalytics[e.itemId].data=void 0;s&&s.error&&o.pageError(s.error);t._emitChange(e)})};return e})();t.FileHoverCardStore=c});
define("G_e",["require","exports","Fe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this._pendingPromises={}}e.prototype.deduplicate=function(e,t){var r=this;if(!this._pendingPromises[e]){var i=t();this._pendingPromises[e]=i;return i.then(function(t){delete r._pendingPromises[e];return t},function(t){delete r._pendingPromises[e];return n.default.reject(t)})}return this._pendingPromises[e]};return e})();t.default=r});
define("z_e",["require","exports","we","ke"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._pageContext=t.pageContext;this._dataRequestor=new t.dataRequestorType({qosName:"FileHoverCardFeedback"});this._itemUrlHelper=new r.ItemUrlHelper({},{pageContext:this._pageContext})}e.prototype.dismissRecommendedAction=function(e,t,r,i,s){var o=this._itemUrlHelper.getUrlParts({path:e.path}),u=o.webRelativeItemUrl.replace("/"+t,""),a={ListId:this._pageContext.listId,ListItemUniqueId:i,Operation:"RecommendationActedOn",AffectedResourceUrl:o.fullItemUrl,ItemType:"File",json:JSON.stringify({FileName:t,Scenario:"RecommendedActions",SourceRelativeUrl:u,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(s+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:r,Canvas:"Web",Workload:"SharePoint",WebId:this._pageContext.webId,SiteId:this._pageContext.siteId,SiteUrl:this._pageContext.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:t,SourceFileExtension:e.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:r,ActionType:"Dismiss"})},f=new n.default(this._pageContext.webAbsoluteUrl+"/_api/web/ActivityLogger/FeedbackDirect");this._dataRequestor.getData({url:f.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(a),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})};return e})();t.FeedbackProvider=i});
define("B_e",["require","exports","lC","r","SE","am","gR","am","pd","sd","Zd","lR","R_e","HR","Uc","cR","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";m=m.AnalyticsKeyPointsEditor_module_1;Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._getKeyPoints=function(){var e=i.props.fileHoverCardStore.getItemAnalytics(i.props.item);return e&&e.data&&e.data.keyPointsData&&e.data.keyPointsData.keyPoints||[]};i._onRenderCell=function(e,t){return e&&void 0!==t&&r.createElement("div",{className:m.fileHoverCardKeyPointsEditorCell,"data-is-focusable":!0,role:"listitem"},r.createElement(o.ActivityItem,{activityDescriptionText:e.text}),r.createElement(u.IconButton,{iconProps:{iconName:"Delete"},className:m.fileHoverCardKeyPointsEditorDeleteIcon,checked:!1,disabled:!1,onClick:function(){return i._onDeleteKeyPoint(t)},ariaLabel:v.default.Delete}))};i._onAddKeyPointClick=function(){i.setState(n.__assign(n.__assign({},i.state),{showInputBox:!0}));p.default("FileHoverCard.KeyPoints.Add",i.props.item)};i._isInputValid=function(){var e=i.state.inputValue.length;return e>0&&e<100};i._onInputChange=function(e,t){i.setState(n.__assign(n.__assign({},i.state),{inputValue:t||""}))};i._getErrorMessage=function(e){return e.length>100?v.default.KeyPointsInvalidMessage:i.state.status===c.AnalyticsResultStatus.failed?v.default.RequestFailureWarning:void 0};i._onSaveClick=function(){var e=i.state.keyPoints,t=JSON.parse(JSON.stringify(e));t.unshift({text:i.state.inputValue,isUserEdited:!0});i.setState(n.__assign(n.__assign({},i.state),{isSaving:!0}));i._updateKeyPoints(t);p.default("FileHoverCard.KeyPoints.Save",i.props.item)};i._onCancelClick=function(){i.setState(n.__assign(n.__assign({},i.state),{showInputBox:!1,status:c.AnalyticsResultStatus.succeed}));p.default("FileHoverCard.KeyPoints.Cancel",i.props.item)};i._addListener=function(){var e=i.props.fileHoverCardStore;i._storeListener=e.addListener(function(){var e=i.props.fileHoverCardStore.getItemAnalytics(i.props.item).status;i.setState(function(t){return n.__assign(n.__assign({},i.state),{showInputBox:(!t.isSaving||e!==c.AnalyticsResultStatus.succeed)&&t.showInputBox,isSaving:!1,keyPoints:i._getKeyPoints(),inputValue:"",status:e})})},i.props.item);e.fetchItemAnalytics(i.props.item)};i._onFeedbackClick=function(){i.setState({showFeedback:!0});i.props.onFeedbackClick();p.default("FileHoverCard.KeyPoints.SendFeedback",i.props.item)};i.state={inputValue:"",isSaving:!1,showInputBox:!1,keyPoints:i._getKeyPoints(),showFeedback:i.props.showFeedbackPanel,status:c.AnalyticsResultStatus.succeed};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState(n.__assign(n.__assign({},this.state),{keyPoints:this._getKeyPoints()}))};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentDidUpdate=function(e){if(this.props.item.itemId!==e.item.itemId){this._removeListener();this._addListener()}};t.prototype.componentWillUnmount=function(){this._removeListener()};t.prototype.render=function(){var e=this.state,t=e.showInputBox,n=e.keyPoints,o=e.isSaving,u=n&&JSON.parse(JSON.stringify(n));return this.state.showFeedback?r.createElement(h.AnalyticsKeyPointsFeedback,{keyPoints:n,item:this.props.item}):r.createElement("div",{className:m.fileHoverCardKeyPointsEditor},r.createElement(a.Link,{className:m.fileHoverCardKeyPointsEditorAddKeyPointLink,onClick:this._onAddKeyPointClick},v.default.keyPointsAdd),t&&r.createElement("div",{className:m.fileHoverCardKeyPointsEditorInputSection},r.createElement(i.TextField,{multiline:!0,rows:4,value:this.state.inputValue,placeholder:v.default.keyPointInputPlaceholder,onGetErrorMessage:this._getErrorMessage,onChange:this._onInputChange}),o?r.createElement(l.Spinner,{className:m.fileHoverCardKeyPointsEditorSpinner,size:l.SpinnerSize.medium}):r.createElement("div",{className:m.fileHoverCardKeyPointsEditorButtons},r.createElement(s.DefaultButton,{primary:!0,disabled:!this._isInputValid(),text:v.default.buttonSave,onClick:this._onSaveClick}),r.createElement(s.DefaultButton,{className:m.fileHoverCardKeyPointsEditorButtonCancel,text:v.default.buttonCancel,onClick:this._onCancelClick}))),r.createElement(d.FocusZone,{direction:d.FocusZoneDirection.vertical,isCircularNavigation:!0,"aria-label":v.default.KeyPointsListScreenReader,role:"list"},r.createElement(f.List,{items:u,onRenderCell:this._onRenderCell})),r.createElement(a.Link,{className:m.fileHoverCardKeyPointsEditorAddKeyPointLink,onClick:this._onFeedbackClick},v.default.SendFeedback))};t.prototype._onDeleteKeyPoint=function(e){var t=this.state.keyPoints;t[e].state="Deleted";this._updateKeyPoints(t);p.default("FileHoverCard.KeyPoints.Delete",this.props.item,{keyPointId:e&&t[e].keyPointId});t.splice(e,1);this.setState(n.__assign(n.__assign({},this.state),{inputValue:""}))};t.prototype._updateKeyPoints=function(e){this.props.fileHoverCardStore.updateItemKeyPoints(this.props.item,e)};t.prototype._removeListener=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)};return t})(r.Component);t.AnalyticsKeyPointsEditor=g});
define("R_e",["require","exports","lC","r","nc","Au","pd","EF","am","pe","HR","Uc","SPListItemsScopeDeferred_IS_mini_css","cR"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";h=h.AnalyticsKeyPointsFeedback_module_9;Object.defineProperty(t,"__esModule",{value:!0});var d;(function(e){e[e.YES=0]="YES";e[e.NO=1]="NO";e[e.NONE=2]="NONE"})(d=t.FeedbackAnswer||(t.FeedbackAnswer={}));var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClickKeyPointsYes=function(){n.setState({keyPointsAnswer:d.YES});l.default("FileHoverCard.KeyPoints.ClickYes",n.props.item)};n._onClickKeyPointsNo=function(){n.setState({keyPointsAnswer:d.NO});l.default("FileHoverCard.KeyPoints.ClickNo",n.props.item)};n._onARTClickYES=function(){n.setState({ARTAnswer:d.YES});l.default("FileHoverCard.TimeToRead.ClickYes",n.props.item)};n._onARTClickNO=function(){n.setState({ARTAnswer:d.NO});l.default("FileHoverCard.TimeToRead.ClickNo",n.props.item)};n._onClickARTSubmit=function(){n.setState({ARTSubmitted:!0});l.default("FileHoverCard.TimeToRead.Submit",n.props.item,n._extraData);n._extraData={}};n._onClickKeyPointsSubmit=function(){n.setState({keyPointsSubmitted:!0});l.default("FileHoverCard.KeyPoints.Submit",n.props.item,n._extraData);n._extraData={}};n.state={ARTAnswer:d.NONE,keyPointsAnswer:d.NONE,ARTSubmitted:!1,keyPointsSubmitted:!1,showARTReasons:!1,showKeyPointsReasons:!1};n._extraData={};return n}t.prototype.render=function(){return r.createElement("div",null,r.createElement("div",{className:h.fileHoverCardFeedbackTitle},p.default.AverageReadingTime,r.createElement(s.TooltipHost,{hostClassName:h.fileHoverCardFeedbackTooltip,content:p.default.TooltipMessage,directionalHint:s.DirectionalHint.bottomCenter},r.createElement(i.Icon,{iconName:"Info",ariaLabel:p.default.TooltipMessage,role:"tooltip",tabIndex:0}))),this.state.ARTSubmitted?this._feedbackSubmitted:r.createElement(r.Fragment,null,r.createElement(c.FocusZone,{direction:c.FocusZoneDirection.vertical,"aria-label":p.default.AnalyticsKeyPointsFeedbackExplanation,role:"group"},this._timeToReadFeedback(this.state.ARTAnswer)),this.state.ARTAnswer!==d.NONE&&r.createElement(a.PrimaryButton,{className:h.fileHoverCardFeedbackSubmit,text:p.default.Submit,onClick:this._onClickARTSubmit})),r.createElement("div",{className:h.fileHoverCardFeedbackTitle},p.default.keyPointsTitle),this.state.keyPointsSubmitted?this._feedbackSubmitted:r.createElement(r.Fragment,null,r.createElement(c.FocusZone,{direction:c.FocusZoneDirection.vertical,"aria-label":p.default.AnalyticsKeyPointsFeedbackExplanation,role:"group"},this._keyPointsFeedback(this.state.keyPointsAnswer)),this.state.keyPointsAnswer!==d.NONE&&r.createElement(a.PrimaryButton,{className:"ms-FileHoverCard-Feedback--Submit",text:p.default.Submit,onClick:this._onClickKeyPointsSubmit})))};t.prototype._timeToReadFeedback=function(e){var t=this;switch(e){case d.YES:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.LikeART,onChange:function(e,n){t._extraData.LikeTimeToRead=n}}),r.createElement(u.Checkbox,{label:p.default.ARTCorrect,onChange:function(e,n){t._extraData.CorrectTimeToRead=n}}));case d.NO:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.NotLikeART,onChange:function(e,n){t._extraData.NotLikeTimeToRead=n}}),r.createElement(u.Checkbox,{label:p.default.ARTIncorrect,onChange:function(e,n){return t.setState({showARTReasons:!!n})}}),this.state.showARTReasons&&r.createElement("div",{className:h.fileHoverCardFeedbackSubCheckbox},r.createElement(u.Checkbox,{label:p.default.TooLong,onChange:function(e,n){t._extraData.TooLong=n}}),r.createElement(u.Checkbox,{label:p.default.TooShort,onChange:function(e,n){t._extraData.TooShort=n}})));case d.NONE:return r.createElement("div",{className:h.fileHoverCardFeedbackOption},p.default.Feedback,r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onARTClickYES,role:"button","aria-label":p.default.AverageReadingTime+" "+p.default.Feedback+" "+p.default.Yes},p.default.Yes),r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onARTClickNO,role:"button","aria-label":p.default.AverageReadingTime+" "+p.default.Feedback+" "+p.default.No},p.default.No))}};t.prototype._keyPointsFeedback=function(e){var t=this;switch(e){case d.YES:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.LikeKeyPoints,onChange:function(e,n){t._extraData.LikeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.CorrectKeyPoints,onChange:function(e,n){return t.setState({showKeyPointsReasons:!!n})}}),this.state.showKeyPointsReasons&&this._subCheckbox(d.YES));case d.NO:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.NotLikeKeyPoints,onChange:function(e,n){t._extraData.NotLikeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.NotAnalyzeKeyPoints,onChange:function(e,n){t._extraData.NotAnalyzeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.IncorrectKeyPoints,onChange:function(e,n){return t.setState({showKeyPointsReasons:!!n})}}),this.state.showKeyPointsReasons&&this._subCheckbox(d.NO));case d.NONE:return r.createElement("div",{className:h.fileHoverCardFeedbackOption},p.default.Feedback,r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onClickKeyPointsYes,role:"button","aria-label":p.default.keyPointsTitle+" "+p.default.Feedback+" "+p.default.Yes},p.default.Yes),r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onClickKeyPointsNo,role:"button","aria-label":p.default.keyPointsTitle+" "+p.default.Feedback+" "+p.default.No},p.default.No))}};t.prototype._subCheckbox=function(e){var t=this;return r.createElement("div",{className:h.fileHoverCardFeedbackSubCheckbox},r.createElement("div",null,e===d.YES?p.default.SelectCorrectKeyPoints:p.default.SelectIncorrectKeyPoints),this.props.keyPoints&&this.props.keyPoints.map(function(n,i){return r.createElement(u.Checkbox,{key:i,label:n.text,onChange:function(n,r){return t._logKeyPointId(r,i,e===d.YES?"CorrectKeyPointId":"InCorrectKeyPointId")}})}))};t.prototype._feedbackMessage=function(e){return r.createElement("div",{className:h.fileHoverCardFeedbackMessage},r.createElement("div",null,p.default.Thanks),r.createElement("div",null,f.format(p.default.FeedbackReason,e===d.YES?p.default.Yes:p.default.No)))};Object.defineProperty(t.prototype,"_feedbackSubmitted",{get:function(){return r.createElement("div",{className:h.fileHoverCardFeedbackMessage},r.createElement(i.Icon,{iconName:"Accept"}),p.default.FeedbackSubmitted)},enumerable:!0,configurable:!0});t.prototype._logKeyPointId=function(e,t,n){e&&l.default("FileHoverCard.KeyPoints."+n,this.props.item,{keyPointId:this.props.keyPoints[t].keyPointId})};return t})(r.Component);t.AnalyticsKeyPointsFeedback=v});
define("KDe",["require","exports","r","e","uee","Uk","gD","Ih","n3","lee","dee","Xye","vee","X_","Dee","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v,m;(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(v||(v={}));(function(e){e[e.none=0]="none";e.checkOut="checkOutOverlay.svg";e.notify="notifyOverlay.svg";e.block="blockOverlay.svg";e.record="recordOverlay.svg"})(m||(m={}));function g(t){var p=t.item,g=t.resources,y=t.size;if(!p)return null;var b=p.properties,w=4===p.state.upload.status?s.genericFile:(function(e){return e.type===o.default.Folder?s.getIconNameFromItem({extension:e.extension,isDocSet:e.isDocSet,listItem:e,sharingType:e.sharingType,type:e.type}):e.iconName})(p),E=p.extension,S=g.consume(l.resourceKey.optional),x=p.vault&&p.vault.root?(function(e,t,n){var r=t.vault.isLocked?v.vaultClosed:v.vaultOpen;return i.getIconUrl(e,r,n)})(g,p,y):p.iconUrl||t.preferAppIcon&&(function(e,t){var n=e.appMap;if((!e.extension||".pdf"!==e.extension.toLowerCase())&&n){var r=f.getAppName(n),i=t>=48?48:16;if(r){return window.require.toUrl("odsp-media/images/"+"appsFluent".toLowerCase()+"/"+r.toLowerCase()+"_"+i+"x1.svg")}}return})(p,y)||(function(e,t){return e&&e.getFileTypeIconUrl(t,!0)})(S,E)||i.getIconUrl(g,w,y),T=(function(e,t){return e&&e.getFileTypeName(t,!0)})(S,E)||h.getIconFieldAriaLabelForItem(p),N=(function(e){var t=m.none,n=e.policyTip;if(n){var r=1==(1&n);2==(2&n)?t=m.block:r&&(t=m.notify)}else e.isViolation?t=m.block:e.properties.CheckedOutUserId?t=m.checkOut:4===e.state.upload.status?t=m.notify:d.complianceRecordIconValue(e)&&(t=m.record);return t})(p),C=p.overlayUrl;C||N===m.none||(C=window.require.toUrl("odsp-media/images/overlays/"+N.toLowerCase()));var k=b.isDisabled||t.isDisabled,L=h.getTooltipText(p),A=!!(1&p.policyTip);return n.createElement(c.FileTypeIconRenderer,{iconName:w,width:y,iconUrl:x,iconTitle:"",overlayUrl:C,isDisabled:k,tooltipText:L,ariaLabel:T,isClickable:A,onClick:function(t){(function(t,n,i){if(1&t.policyTip){u.Engagement.logData({name:"PolicyTip.LaunchFromListView"});new Promise(function(t,n){e(["E7e"],t,n)}).then(a.getDefaultExport).then(function(e){new(n.injected(e))({item:r.observable(t)}).execute(i)})}})(p,g,t)}})}t.renderFileTypeIcon=g;t.fileTypeIconRenderer=function(e){var t=e.item,n=e.column,r=e.isDisabled,i=e.resources;return g({item:t,size:n.minWidth||n.width,resources:i,isDisabled:r})};t.resourceKey=new p.ResourceKey({name:e("module").id,factory:new p.ConstantResourceFactory(t.fileTypeIconRenderer)})});
define("Xye",["require","exports","r","us"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileTypeIconRenderer=function(e){var t=e.width,i=e.iconUrl,s=e.iconTitle,o=e.overlayUrl,u=e.isDisabled,a=e.tooltipText,f=e.isClickable,l=e.onClick,c=e.ariaLabel,h=void 0===c?s:c,p={width:t,height:t},d=a||s||h,v=n.createElement("img",{className:r.css("FileTypeIcon-icon",{"od-FieldRenderer--disabled":u}),alt:"",src:i,style:p});if(o){var m=n.createElement("img",{className:r.css("FileTypeIcon-overlay",{"od-FieldRenderer--disabled":u}),src:o});return n.createElement("div",{className:r.css("FileTypeIcon",{"FileTypeIcon--clickable":f}),"data-is-focusable":!!f||!!l,title:d,"aria-label":h,onClick:l},v,m)}return n.createElement("div",{className:"FileTypeIcon","aria-label":h,title:d},v)}});
define("F_e",["require","exports","X_","yh","H_e","S3","E3"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{itemAnalyticsDataSource:r.analytics,pageContext:s.pageContext,dataRequestorType:o.typeResourceKey},create:function(e){var t=new i.FileHoverCardStore({item:void 0},e);return{instance:t,disposable:t}}}})});
define("Ohe",["require","exports","r","Phe","whe","px"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COMMAND_BUTTON_WIDTH=36;t.createHeroCommandsSectionFilesList=function(e){var t=e.resources.consume(s.disableDotDotDotHeroCommand.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},i.shareHeroCommandRenderer(e),!t&&r.dotDotDotRenderer(e))};t.createHeroCommandsSectionRecentList=function(e){var t=e.resources.consume(s.disableDotDotDotHeroCommand.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},i.shareHeroCommandRenderer(e),!t&&r.dotDotDotRenderer(e))};t.createHeroCommandsSectionList=function(e){var t=e.resources.consume(s.disableDotDotDotHeroCommand.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},!t&&r.dotDotDotRenderer(e))}});
define("Phe",["require","exports","r","vh","hhe","The","u3","Ahe","X_","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dotDotDotRenderer=function(e){var t=e.item,a=e.isDisabled,f=e.resources;return n.createElement(u.TooltipHost,{content:i.default.showDetailsAriaLabel,resources:f},n.createElement(s.DotDotDotRenderer,{isDisabled:t.properties.isDisabled||a,ariaLabel:i.default.showDetailsAriaLabel,onClick:function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("contextmenu",!0,!0,e);e.currentTarget.dispatchEvent(t);var n=f.consume(o.instrumentation.optional);f.consume(r.resourceKey).logData({name:"Ellipsis.Callout.Click",isIntentional:!0,currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA"});e.preventDefault();e.stopPropagation()}}))};t.resourceKey=new a.ResourceKey({name:e("module").id,factory:new a.ConstantResourceFactory(t.dotDotDotRenderer)})});
define("The",["require","exports","r","us","nc","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DotDotDotRenderer=function(e){var t=e.onClick,s=e.isDisabled,o=e.ariaLabel;return n.createElement("button",{className:r.css("od-FieldRenderer-dot",{"od-FieldRenderer--disabled":s}),onClick:t,"aria-label":o,"aria-haspopup":"true"},n.createElement(i.Icon,{iconName:"MoreVertical"}))}});
define("Ahe",["require","exports","lC","r","us","Mu","Lhe","Fu"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onTooltipMouseEnter=function(e){if(void 0!==n.props.overflowMode){var t=n._getTargetElement();if(t&&!i.hasOverflow(t))return}n._toggleTooltip(!0)};n._onTooltipMouseLeave=function(e){n._toggleTooltip(!1)};n._onTooltipCallOutDismiss=function(){n._toggleTooltip(!1)};n.state={isTooltipVisible:!1};return n}t.prototype.render=function(){var e=this.props,t=e.calloutProps,s=e.children,u=e.content,a=e.delay,f=e.directionalHint,l=e.directionalHintForRTL,c=e.hostClassName,h=e.id,p=e.overflowMode,d=e.setAriaDescribedBy,v=void 0===d||d,m=e.tooltipProps,g=e.resources,y=this.state.isTooltipVisible,b=h||i.getId("tooltip");return r.createElement("div",n.__assign({className:i.css("ms-TooltipHost",c),style:p?{display:"inline"}:{display:"inline-block"},ref:this._resolveRef("_tooltipHost")},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._onTooltipMouseLeave},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,"aria-describedby":v&&y&&u?b:void 0}),s,y&&r.createElement(o.AsyncTooltip,n.__assign({id:b,delay:a,content:u,targetElement:this._getTargetElement(),directionalHint:f,directionalHintForRTL:l,calloutProps:i.assign(t,{onDismiss:this._onTooltipCallOutDismiss}),resources:g},i.getNativeProps(this.props,i.divProperties),m)))};t.prototype._getTargetElement=function(){var e=this.props.overflowMode;if(void 0!==e)switch(e){case s.TooltipOverflowMode.Parent:return this._tooltipHost.parentElement;case s.TooltipOverflowMode.Self:return this._tooltipHost}return this._tooltipHost};t.prototype._toggleTooltip=function(e){var t=this;this.setState({isTooltipVisible:e},function(){return t.props.onTooltipToggle&&t.props.onTooltipToggle(t.state.isTooltipVisible)})};t.defaultProps={delay:u.TooltipDelay.medium};return t})(i.BaseComponent);t.TooltipHost=a});
define("Lhe",["require","exports","lC","r","Fe","t3","ly","u3"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AsyncTooltip=function(t){var a,f={load:function(t){return s.loadModuleExport({path:"Au",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["Au"],t,n)}))},getExport:function(e){return e.Tooltip}})},parse:void 0},l=t.resources;l&&(a=l.consume(u.bundleLoader.optional));var c={modulePath:"Au",moduleLoader:f,customWaiter:a&&a.waitForPLT(),props:n.__assign({},t)};return r.createElement(o.ReactDeferredComponent,n.__assign({},c))}});
define("whe",["require","exports","r","e","d1","QH","Y0","hhe","khe","px","S_e","vh","u3","Ahe","rX","NY","X_","Ehe","ce"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=s.isFeatureEnabled(s.ShareV3),w=s.isFeatureEnabled(s.UseNewShareDialog)&&(!o.isOneDriveWinApp()||s.isFeatureEnabled(s.UseNewShareDialogForWinApp));t.shareHeroCommandRenderer=function(e){var t,s=e.item,o=e.itemSet,m=e.resources,E=e.isDisabled,S=s.mruState;t=!!y.Killswitch.isActivated("20603D17-F132-41AF-9391-969F8AD8CC5D","11/20/2019","Disables ShareHeroCommand in non-ItemsScope MRU; activate this KS to restore the command")&&(!S||S.canBeShared);var x=m.consume(v.resourceKey).isCommandSupported(s,d.share),T=o.context&&o.context.queryType===i.default.Files,N=s.parent&&s.parent.id||s.properties&&s.properties.listId,C=T||!(!N||!s.properties.path&&!s.key||!s.properties.ID&&!s.properties.uniqueId),k=s.lifeCycleStatus&&s.lifeCycleStatus.isMalwareDetected,L=x&&C&&t&&!(E||s.properties.isDisabled||k);return L?n.createElement(p.TooltipHost,{content:u.default.shareCommandOnHoverAriaLabel,resources:m},n.createElement(a.ShareHeroCommandRenderer,{isDisabled:!L,ariaLabel:u.default.shareCommandOnHoverAriaLabel,onClick:function(e){if(L){var t,n=m.consume(f.actionMap),i=new(m.injected(n.SelectAction))({item:r.observable(s),showProperties:!1});t=b?new(m.injected(n.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey,overrideItem:s}):w&&!y.Killswitch.isActivated("7e18d766-4890-4cef-9c61-dd49d9eb28d7","06/04/2019","new hero share")?new(m.injected(n.ShowShareMultiItemAction))({focusItems:m.consume(g.shareResourceKey)}):new(m.injected(n.ShareByLinkAction))({sharingMethod:2});i.execute(e).then(function(){return t.execute(e)});var o=m.consume(c.resourceKey),u=m.consume(h.instrumentation.optional);o.logData({name:"ShareHeroCommand.Click",isIntentional:!0,currentPage:u&&u.currentPageName()||"NA",previousPage:u&&u.previousPageName()||"NA"})}}})):null};t.resourceKey=new m.ResourceKey({name:e("module").id,factory:new m.ConstantResourceFactory(t.shareHeroCommandRenderer)})});
define("khe",["require","exports","r","us","nc","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShareHeroCommandRenderer=function(e){var t=e.onClick,s=e.isDisabled,o=e.ariaLabel;return n.createElement("button",{className:r.css("od-FieldRenderer-shareHeroCommand",{"od-FieldRenderer--disabled":s}),onClick:t,"aria-label":o,"aria-haspopup":"true"},n.createElement(i.Icon,{iconName:"Share"}))}});
define("Ehe",["require","exports","X_","e"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["_xt"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey;t.shareResourceKey=new n.ResourceKey({name:"share",factory:new n.ConstantResourceFactory(r.observable())});t.manageAccessShareResourceKey=new n.ResourceKey({name:"manageAccessShare",factory:new n.ConstantResourceFactory(r.observable())});t.manageAccessAddPeopleResourceKey=new n.ResourceKey({name:"manageAccessAddPeople",factory:new n.ConstantResourceFactory(r.observable())});t.copyResourceKey=new n.ResourceKey({name:"copy",factory:new n.ConstantResourceFactory(r.observable([]))});t.sharingContextInformation=new n.ResourceKey("sharingContextInformation")});
define("s3e",["require","exports","ce"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getGraphAccessToken=function(e,t){return e.getAccessToken(t,{apiVersion:n.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E")?"v2.0":"v2.1"})};t.getGraphItemUrl=function(e,t){return e&&e.getItemUrl(t,{useDirectEndpoint:!0,apiVersion:n.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E","1/30/2018","ItemAnalytics API transfer to vroom 2.1")?"v2.0":"v2.1"})};t.getGraphDriveUrl=function(e,t){return e&&e.getDriveUrl(t,{useDirectEndpoint:!0,apiVersion:"v2.1"})}});
define("vDe",["require","exports","gj","Y_e","Xx","C1"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ActivityField=s.connectToItemCache(function(e,t){return{item:e.demandItemFacet(i.knockoutStoreItemFacet,t.itemKey)}})(n.withKnockoutComputed(function(e){var t=e.item;return{item:t&&t()}})(r.baseActivityRenderer))});
define("Y_e",["require","exports","r","X_","Un","X_e","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.baseActivityRenderer=function(e){var t=e.item,r=e.isDisabled,o=void 0!==r&&r,u=t?s.getViewableItemActivity(t):void 0;return n.createElement("div",{className:i.css("od-FieldRenderer-text",{"od-FieldRenderer--disabled":t&&t.properties&&t.properties.isDisabled||o})},u?n.createElement(s.ItemActivityField,{activity:u}):null)};t.activityRenderer=t.baseActivityRenderer;t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(t.activityRenderer)})});
define("X_e",["require","exports","r","nhe","$_e","Z_e"],function(e,t,n,r,i,s){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});t.ItemActivityField=function(e){return n.createElement(i.default,{activity:e.activity,isCompact:!0,hideDate:e.hideDate})};t.getViewableItemActivity=function(e){var t=e.activity;if(t){var n,r=(n=t.type,u[n]);return r?new r({activity:t,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!!e.folder,name:e.displayName,graphItemUrl:""},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:s.default}):void 0}};var u=((o={})[0]=r.EditItemActivity,o[1]=r.MoveItemActivity,o[2]=r.CommentItemActivity,o[3]=r.CommentResponseItemActivity,o[4]=r.MentionItemActivity,o[5]=r.VersionItemActivity,o[6]=r.RestoreItemActivity,o[9]=r.RenameItemActivity,o[10]=r.DeleteItemActivity,o[11]=r.CreateItemActivity,o[12]=r.ShareItemActivity,o)});
define("nhe",["require","exports","lC","ahe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("$_e",["require","exports","lC","ehe","ehe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("ehe",["require","exports","lC","r","vR","yR","SR","nc","Uc","oc","L7","us","kx","MU","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i.charsWithinParenthesisRegex=/\(([^)]*)\)/gi;i.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi;i.multipleSpacesRegex=/\s+/gi;i._onRenderIcon=function(){var e=i.props.activity.getIconName();return r.createElement(u.Icon,{iconName:e})};i._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},i.props.activity.getTitle({isCompact:i.props.isCompact,hideDate:i.props.hideDate}))};i._onRenderActivityTimeStamp=function(e,t){if(i.props.isCompact){var n=s.getStyles(void 0,void 0),u=o.getClassNames(n,e.className,e.activityPersonas,e.isCompact);return r.createElement("div",{className:c.css(u.timeStamp,"od-ItemActivity-timeStamp")},e.timeStamp)}return t?t(e):null};i._onRenderHiddenTimeStamp=function(e,t){return null};i._onRenderActivityDescription=i._onRenderActivityDescription.bind(i);i._onRenderIcon=i._onRenderIcon.bind(i);i.state={isFirstLoad:!0};i._focusedActivity=null;return i}t.prototype.componentDidMount=function(){this.props.isFocusedOnFirstLoad&&this._focusedActivity&&this._focusedActivity.focus()};t.prototype.componentDidUpdate=function(){this.props.isFocusedOnFirstLoad&&this._focusedActivity&&this._focusedActivity.focus()};t.prototype.render=function(){var e=this,t=this.props,n=t.activity,s=t.isCompact,o=t.hideDate,u=t.isInGrid,l=this.state.isFirstLoad,p=n.getIconName(),d=h.isFluentActiveOD||h.EnableFluentTheme?{root:{color:f.getTheme().palette.neutralDark},activityTypeIcon:{color:f.getTheme().palette.themePrimary,height:"16px",marginTop:"8px"}}:void 0,v=n.getResponse(),m=n.getContextualMenu();return r.createElement(a.FocusZone,{className:"od-ItemActivity-item-focusZone",direction:a.FocusZoneDirection.horizontal,handleTabKey:a.FocusZoneTabbableElements.all,"data-is-focusable":!0,"aria-label":this._getAriaLabel(),role:u?"row":void 0,onBlur:function(){e._onBlur()},allowFocusRoot:!0,ref:function(t){return e._focusedActivity=l?t:null}},r.createElement("div",{role:u?"gridcell":void 0,key:"activity_"+n.getKey(),className:c.css({"od-ItemActivityList-activity-withCommentResponse":!!v},{"od-ItemActivityList-activity-commentWithContent":"comment"===n.getActivityTypeString()&&void 0===p},"od-ItemActivityList-activity")},r.createElement(i.ActivityItem,{key:n.getKey(),className:"od-ItemActivity-item",onRenderActivityDescription:this._onRenderActivityDescription,onRenderIcon:p&&this._onRenderIcon||void 0,activityPersonas:this._getPersonaProperties(),timeStamp:this._onRenderDate(),onRenderTimeStamp:o?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp,isCompact:s,styles:d})),m,v)};t.prototype._onRenderDate=function(){var e=this.props.activity;return(l.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||l.getFriendlyDateTimeStringPast(e.getDate())).toString()};t.prototype._getAriaLabel=function(){return this.props.activity.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()};t.prototype._onBlur=function(){this.setState({isFirstLoad:!1})};t.prototype._getInitial=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");if(n.length>=2){t+=n[0].charAt(0).toUpperCase();t+=n[n.length-1].charAt(0).toUpperCase()}else 0!==n.length&&(t+=n[0].charAt(0).toUpperCase());return t};t.prototype._getPersonaProperties=function(){var e=this.props,t=e.activity,n=e.isNewCommentExperienceEnabled,i=t.getCommentAuthorName(),s=t.getcommentAuthorEmail(),o=i||s,u=this._getInitial(o),a=t.getPersonaIconUrl(),f={imageUrl:a},l={imageInitials:u,initialsColor:p.getPersonaInitialsColor({text:o}),onRenderInitials:function(){return r.createElement("div",{className:"od-ItemActivity-persona"},u,r.createElement("img",{className:"od-ItemActivity-personaIcon",src:a}))}};return n?[l]:[f]};return t})(r.Component);t.default=d});
define("aJe",["require","exports","lC","r","am","Ps","Km","LD","C1","oh","$V","X5e","eC","ANe","G5e"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.itemKey,t=p.default.shareActionText,n=e&&r.createElement(s.WithAction,{action:r.createElement(o.ItemShareAction,{itemKey:e})},function(e){var n=e.isAvailable,s=e.execute;return r.createElement(i.PrimaryButton,{disabled:!n,className:"od-Button od-Button--primary od-operationMonitor-ShareLinkButton",text:t,onClick:function(){s()}})});return r.createElement("div",{className:"od-operationMonitor-ShareLink"},n)};return t})(r.Component);t.ShareAfterUploadBase=v;t.ShareAfterUpload=a.connectToItemCache(function(e,t){var n=e.demandItemFacet(u.viewParamsToItemKeyControl,f.odspNextAppItemKey);return{itemKey:u.viewParamsToItemKeyControl.evaluate(n)(e,{viewParams:t.urlDataSource.getKeyParams(t.storeKey)}).itemKey}})(v);var m=(function(e){n.__extends(i,e);function i(){return null!==e&&e.apply(this,arguments)||this}i.prototype.render=function(){var e=this.context.dependencies.currentItemsScope;return r.createElement(e,null,r.createElement(t.ShareAfterUpload,n.__assign({},this.props)))};i.contextTypes=l.RESOLVED_COMPONENT_CONTEXT_TYPES;return i})(r.PureComponent);t.ShareAfterUploadContainer=m;t.resourceKey=l.createResolvedComponentTypeResourceKey(e("module").id,m,{itemCacheStore:h.resourceKey,currentItemsScope:c.resourceKey.local});t.knockoutResourceKey=d.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-share-after-upload",name:e("module").id+".knockout"})});
define("iJe",["require","exports","lC","r","vre","SPListItemsScopeDeferred_IS_mini_css","om","rJe","HE","am","c0","YWe","VK","zK","UK","RB","Uk","gD","S3","Y5e"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";s=s.ContentCenterModelImportBanner_module_1;Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._renderBannerActionComponent=function(){return r.createElement(i.Stack,{horizontal:!0,gap:30},r.createElement(i.Stack.Item,null,r.createElement("h2",{className:s.bannerHeaderTagStyle},r.createElement(a.Text,{className:s.bannerPrimaryText},u.default.BannerHeader))),r.createElement(i.Stack.Item,null,r.createElement(i.Stack,{horizontal:!0,gap:15,className:s.buttonStack},r.createElement(f.PrimaryButton,{disabled:n.state.isImportButtonDisabled,ariaLabel:u.default.ImportSampleButtonText,onClick:n._onImportClicked},u.default.ImportSampleButtonText))))};n._getOneDriveItem=function(){var e=new v.default("BenefitChangeNotice");e.name="BenefitChangeNotice";e.extension="classifier";e.displayName="BenefitChangeNotice";e.key="BenefitChangeNotice";return e};n._createOperation=function(){var e=n.props.resources.consume(d.resourceKey),t=n._getOneDriveItem(),r=e.register({name:t.name||"",iconName:m.getIconNameFromItem({type:g.default.Unknown,extension:t.extension}),type:h.default.importModel,payloads:{importModel:{item:t}}});r.progress.maximum(1);r.progress.current(0);r.state(p.default.started);return r};n._onImportClicked=function(){var e,t=n._createOperation();n.setState({isImportButtonDisabled:!0});null===(e=n._contentCenterDataSource)||void 0===e||e.importModel().then(function(e){var r;if(e&&"Model already exists"!==e){t.state(p.default.completed);n.props.onDismiss();null===(r=n._contentCenterDataSource)||void 0===r||r.navigateToModelHomePage(e)}else if("Model already exists"===e){n.props.onDismiss();t.state(p.default.canceled)}else{n.setState({isImportButtonDisabled:!1});t.state(p.default.failed)}}).catch(function(e){return t.state(p.default.failed)})};var o=n.props.resources;n._contentCenterDataSource=o&&o.consume(c.resourceKey);n.state={isSampleModelPresent:!0,isImportButtonDisabled:!1};return n}t.prototype.componentDidMount=function(){var e,t=this;null===(e=this._contentCenterDataSource)||void 0===e||e.checkIfModelExists().then(function(e){return t.setState({isSampleModelPresent:!0})}).catch(function(e){return t.setState({isSampleModelPresent:!1})})};t.prototype.render=function(){return this.state.isSampleModelPresent?null:r.createElement(i.Stack,{horizontal:!0,className:s.container},r.createElement(i.Stack.Item,{className:s.imageContainer},r.createElement("img",{alt:u.default.ModelImportImageAltText,height:"140px",src:window.require.toUrl("odsp-media/images/contentcenter/modelimporticon.png")})),r.createElement(i.Stack.Item,{className:s.bannerContent},r.createElement(i.Stack,null,r.createElement(i.Stack.Item,null,r.createElement(i.Stack,{className:s.bannerPrimaryContent},r.createElement(i.Stack.Item,{className:s.closeButtonDiv},r.createElement(o.IconButton,{ariaLabel:u.default.DismissButtonAriaLabel,className:s.closeButton,title:u.default.DismissButtonAriaLabel,onClick:this.props.onDismiss,iconProps:{iconName:"ChromeClose"}})),r.createElement(i.Stack.Item,{className:s.bannerHeaderContent},this._renderBannerActionComponent()))),r.createElement(i.Stack.Item,{className:s.descriptionContainer},r.createElement("div",{className:s.descriptionText},r.createElement(a.Text,null,u.default.BannerDescriptionText))))))};return t})(r.Component);t.ContentCenterModelImportBanner=function(e){var t=l.useResourceScope(),n=t.consume(y.pageContext),i=!b.get("hideContentCenterModelImport"),s=r.useState(i),o=s[0],u=s[1];return o?r.createElement(w,{onDismiss:function(){u(!1);var e=n.webAbsoluteUrl,t=(new Date).getTime()+864e5;b.set("hideContentCenterModelImport","true",{expires:t,path:e})},resources:t}):null}});
define("sJe",["require","exports","X_","gD","ii","li","oh"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:function(e,t){var n=t.itemKey;if(!t.item)return{};var u={},a=e.demandItemFacet(i.permissionsFacet,n);u.permissions=a;var f=e.demandItemFacet(s.spWebKeyFacet,n),l=e.demandItemFacet(s.spLibrariesItemSetKeyFacet,n),c=e.demandItemFacet(s.spAllSitesKeyFacet,n),h=e.demandItemFacet(s.spOneDriveDocumentLibraryKeyFacet,n),p=e.demandItemFacet(o.odspNextQueryRootKeyFacet,n);if(f||l||c||h||p){if(p){var d=p.queryType;u.queryType=d;u.displayType=d}u.folder={};u.type=r.default.Folder}return{item:u}}}}}})});
define("FB",["require","exports","r","_j","lj","dj","jB","HB","c0","X_","Re","Kg"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function h(e){var t=a.useResourceScope(),o=n.useMemo(function(){return i.toSpecification(s.resourceKey,{})},[]);return n.createElement(c.WithKnockoutResourceScope,null,n.createElement(r.default,{specification:o,resources:t}))}var p=a.withChildResources(function(e){e.exposeFactory(o.typeResourceKey,new f.AliasResourceFactory(u.typeResourceKey))},{owner:e("module").id})(h);t.TransclusionContent=l.default.isActivated("F2A3B2C8-3374-4D27-A19A-C791E9C75D2C","8/16/2019","ItemSelectionHelper shim for Knockout")?h:p});
define("dj",["require","exports","X_"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Wee"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("cJe",["require","exports","r","_s","C1","tze"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){var t=e.subscribe;n.useLayoutEffect(function(){return t()},[t]);return null}t.ItemAutoRefresh=i.createItemCacheComponent(function(e,t){var r=t.itemKey,i=e.demandItemFacet(s.itemAutoRefreshControl,r),u=s.itemAutoRefreshControl.evaluate(i)(e,{itemKey:r,itemSubscriber:null}),a=u.isAvailable,f=u.itemSubscriber,l=u.subscribe;return a?f||(l?n.createElement(o,{subscribe:l}):null):null});t.CurrentItemAutoRefresh=r.withCurrentItemSet()(t.ItemAutoRefresh)});
define("tI",["require","exports","lC","Hm","gI","Bp","u1","li","ih","Y2","$3","l0","lI","E0","l1","dI","_c","oI","rI","iI","aI","t4","z6","nI","is"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=E.forModuleExport(E.asModuleWithRetries(function(){return new Promise(function(t,n){e(["NT"],t,n)})},{chunkName:"addon-sharepointhome-deferred"}),"sharePointHomeAddonDeferred");t.sharePointHomeAddon=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(i.sharePointHomeAddonDataOnly);e(a.registerControlHandler(u.spAllSitesKeyFacet,f.itemSetNavGroupControl)(l.allSitesNavGroupControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,c.itemSetTilesListControl)(h.spAllSitesItemSetTilesListControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,o.itemEngagementControl)(b.spAllSitesItemEngagementControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,p.itemsViewControl)(v.spAllSitesItemsViewControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,d.itemsViewLayoutsControl)(v.spAllSitesItemsViewLayoutsControlHandler));e(a.registerControlHandler(u.spWebKeyFacet,m.itemFileTypeIconControl)(g.spWebItemFileTypeIconControlHandler));e(a.registerControlHandler(u.spWebKeyFacet,o.itemEngagementControl)(y.spWebItemEngagementControlHandler));e(a.registerControlHandler(u.spFrequentSitesItemSetKeyFacet,s.childItemsControl)(w.frequentSitesItemSetControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,T.itemSetSelectionControl)(x.spAllSitesItemSetSelectionControlHandler));e(S.loadDeferredAddon(N));return[2]})})}})});
define("Y2",["require","exports","ec","Dr","K2","q2"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetNavGroupControl=new r.ControlFacet("itemSetNavGroupControl",{groupHeaderRenderer:n.defaultRenderComponentOption({useItemCache:!0}),commandGroupControlHandler:r.childControlOption(s.itemSetNavGroupPropsControl),navLinkControlHandler:r.childControlOption(i.itemSetNavLinkControl)})});
define("K2",["require","exports","Dr","ec","W2"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetNavLinkControl=new n.ControlFacet("itemSetNavLinkControl",{linkAsRenderer:r.defaultRenderComponentOption(),navLinkRenderer:r.defaultRenderComponentOption({useItemCache:!0}),commandControlHandler:n.childControlOption(i.itemSetNavCommandPropsControl)})});
define("W2",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetNavCommandPropsControl=new n.ControlFacet("itemSetNavLinkPropsControl")});
define("q2",["require","exports","Dr"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetNavGroupPropsControl=new n.ControlFacet("itemSetNavCommandGroupControl")});
define("$3",["require","exports","lC","r","Xo","Jf","ih","m2","li","SPListItemsScopeDeferred_IS_mini_css","ii","A1","Bp","o2","e2"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";f=f.teamSiteNavLink_1;Object.defineProperty(t,"__esModule",{value:!0});function v(e){var t=e.name;return r.createElement("div",{className:f.linkName},t)}t.BasicNavLinkRenderer=v;function m(e,t){var r=t.itemKey;if(e.demandItemFacet(a.spAllSitesKeyFacet,r))return{commandControlHandler:function(e,t){var r=t.command;return r?{command:n.__assign(n.__assign({},r),{name:u.default.MoreSitesText})}:{}},navLinkRenderer:v};var i=c.getConfiguration(e,{isPinningEnabled:l.enableSitePinningConfigurationFacet,isPinnedSiteDragDropEnabled:l.enablePinnedSiteDragDropConfigurationFacet}),s=i.isPinningEnabled,o=i.isPinnedSiteDragDropEnabled;return{navLinkRenderer:s&&o?p.DragDropNavLinkRenderer:d.TeamSiteNavLinkRenderer}}function g(e,t){var r=t.commandGroup;return{commandGroup:n.__assign(n.__assign({},r),{name:u.default.SharedLibrariesHeader})}}function y(e,t){return c.getConfiguration(e,{enableSitePinningConfiguration:l.enableSitePinningConfigurationFacet}).enableSitePinningConfiguration?Math.max(t,8):8}t.allSitesNavGroupControlHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var n={},r=t.itemKey,o=t.childItemKeys;if(!o)return{};for(var u=[],f=!1,l=8,c=0,p=o;c<p.length;c++){var d=p[c];if(f)break;if(e.demandItemFacet(s.isGroupFacet,d,{suppressGetItems:!0})){var v=e.demandItemFacet(i.childItemsFacet,d),b=v&&v.itemKeys,w=e.demandItemFacet(h.childItemsControl,d),E=h.childItemsControl.evaluate(w)(e,{itemKeys:b,itemKey:d}).itemKeys;e.demandItemFacet(a.spFrequentSitesItemSetKeyFacet,d)&&E&&(l=y(e,E.length));if(E){for(var S=0,x=E;S<x.length;S++){var T=x[S];if(u.length>=l){f=!0;u.push(r);break}if(!n[T]){u.push(T);n[T]=!0}}if(!f&&u.length>=8){f=!0;u.push(r)}}}}return{childItemKeys:u,commandGroupControlHandler:g,navLinkControlHandler:m}}}})});
define("o2",["require","exports","lC","r","SPListItemsScopeDeferred_IS_mini_css","Ps","li","ii","f2","l2","s2","e2","C1"],function(e,t,n,r,i,s,o,u,a,f,l,c,p){"use strict";var h=i.PinSite_9;i=i.teamSiteNavLink_1;Object.defineProperty(t,"__esModule",{value:!0});t.DragDropNavLinkRenderer=p.createItemCacheComponent(function(e,t){var d,v,m,g=t.itemKey,y=t.groupKey;if(y){var b=o.pinnedItemKeyFacet.serialize({rootItemKey:y,itemKey:g}),w=e.demandItem({prevPinOrder:u.prevPinOrderFacet,pinOrder:u.pinOrderFacet,nextPinOrder:u.nextPinOrderFacet},b);if(w){d=w.prevPinOrder;v=w.pinOrder;m=w.nextPinOrder}}var E=p.evaluateItemCacheComponent(e,r.createElement(c.TeamSiteNavLinkRenderer,n.__assign({},t)));if(!v)return E;var S=p.evaluateItemCacheComponent(e,r.createElement(f.TeamSiteDropTarget,{itemKey:g,prevPinOrder:d,nextPinOrder:v,isTop:!0})),x=p.evaluateItemCacheComponent(e,r.createElement(f.TeamSiteDropTarget,{itemKey:g,prevPinOrder:v,nextPinOrder:m,isTop:!1})),T=p.evaluateItemCacheComponent(e,r.createElement(l.TeamSiteDragSource,{itemKey:g},E));var N=y?p.evaluateItemCacheComponent(e,r.createElement(a.ReorderPinnedSiteAction,{itemKey:g,rootItemKey:y})):null;return r.createElement(s.WithAction,{action:N},function(e){var t=e.isAvailable,n=e.execute;return r.createElement("div",{className:h.sitePinLeftNavParent},r.createElement("div",{className:i.parentContainer},r.createElement("div",{className:i.dropZoneParent},S?r.cloneElement(S,{execute:n,isAvailable:t}):null,x?r.cloneElement(x,{execute:n,isAvailable:t}):null),T))})})});
define("f2",["require","exports","lC","r","ks","i2","ii","li","C1"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReorderPinnedSiteAction=a.createItemCacheComponent(function(e,t){var a=t.itemKey,f=t.rootItemKey,l=u.pinnedItemKeyFacet.serialize({rootItemKey:f,itemKey:a}),c=!!e.demandItemFacet(o.pinOrderFacet,l),h=e.dispatch;return r.createElement(i.Action,{isAvailable:c,onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,i,o,u,a,l;return n.__generator(this,function(n){t=e.event;r=t.dataTransfer,i=r.draggedItemKey,o=r.prevPinOrder,u=r.nextPinOrder;h(s.default({items:(a={},a[f]=(l={},l[i]={type:"reorderPin",reorderPinInfo:{prevPinOrder:o,nextPinOrder:u}},l),a)}));return[2]})})}})})});
define("l2",["require","exports","lC","r","u2","SPListItemsScopeDeferred_IS_mini_css","J1","C1","fp"],function(e,t,n,r,i,s,o,u,a){"use strict";s=s.teamSiteNavLink_1;Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){var t=e.isAvailable,n=e.execute,o=e.itemKey,u=e.prevPinOrder,f=e.nextPinOrder,l=e.isTop,c=e.pageLoadBarrier,h=r.useCallback(function(e){return!!t},[t]),p=r.useCallback(function(e){var t={dataTransfer:{draggedItemKey:e.draggedItem.dragSourceKey,prevPinOrder:u,nextPinOrder:f}};n&&n({event:t});return{dropTargetKey:e.dropTargetKey}},[u,f,n]),d=r.useMemo(function(){return{canDropHandler:h,onDropHandler:p}},[h,p]);return r.createElement(i.DropTargetRelay,{acceptType:[a.PINNED_SITE_DRAG_TYPE],dropTargetKey:o,handlers:d,showDropTargetHint:!1,showDragOverHint:!1,barrier:c},function(e){var t=e.isDroppable,n=e.isDropping,i=t&&n?l?s.topDropZoneHover:s.bottomDropZoneHover:s.dropZone;return r.createElement("div",{className:i})})};t.TeamSiteDropTarget=u.createItemCacheComponent(function(e,t){var i=o.getPageLoadBarrier(e);return r.createElement(f,n.__assign({},t,{pageLoadBarrier:i}))})});
define("s2",["require","exports","lC","r","SPListItemsScopeDeferred_IS_mini_css","c2","nc","J1","C1","fp"],function(e,t,n,r,i,s,o,u,a,f){"use strict";i=i.teamSiteNavLink_1;Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){var t=e.itemKey,n=e.children,u=e.pageLoadBarrier,a=r.useCallback(function(){return!0},[]),l=r.useCallback(function(e){return{dragSourceKey:t,type:f.PINNED_SITE_DRAG_TYPE}},[t]),c=r.useCallback(function(e){},[]),h=r.useMemo(function(){return{canDragHandler:a,onBeginHandler:l,onEndHandler:c}},[a,l,c]);return r.createElement(s.DragSourceRelay,{dragSourceKey:e.itemKey,type:f.PINNED_SITE_DRAG_TYPE,handlers:h,barrier:u,showDefaultDragPreview:!0},r.createElement("div",{className:i.dragContainer},r.createElement(o.Icon,{iconName:"GripperDotsVertical",className:i.dragHandler,draggable:!0}),n))};t.TeamSiteDragSource=a.createItemCacheComponent(function(e,t){var i=u.getPageLoadBarrier(e);return r.createElement(l,n.__assign({},t,{pageLoadBarrier:i}))})});
define("e2",["require","exports","r","V_","n2","SPListItemsScopeDeferred_IS_mini_css","C1"],function(e,t,n,r,i,s,u){"use strict";var o=s.teamSiteNavLink_1;s=s.PinSite_9;Object.defineProperty(t,"__esModule",{value:!0});t.TeamSiteNavLinkRenderer=u.createItemCacheComponent(function(e,t){var a=t.itemKey,f=t.groupKey,l=t.name;return n.createElement("div",{className:o.siteContainer},n.createElement("div",{className:o.icon},u.evaluateItemCacheComponent(e,n.createElement(r.ItemFileTypeIcon,{itemKey:a,size:24}))),n.createElement("div",{className:o.siteNameContainer,draggable:!1},n.createElement("span",{className:s.sitePinLeftNavParent},n.createElement("span",{className:o.siteName},l),f?n.createElement("span",null,u.evaluateItemCacheComponent(e,n.createElement(i.PinSiteButton,{itemKey:a,rootItemKey:f}))):null)))})});
define("n2",["require","exports","lC","r","nc","pd","C1","Ps","r2","SPListItemsScopeDeferred_IS_mini_css","a2","Y"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";f=f.PinSite_9;Object.defineProperty(t,"__esModule",{value:!0});var h={default:"PinnedSolid",siteHovered:"PinnedSolid",pinHovered:"Unpin"},p={default:"Pinned",siteHovered:"Pinned",pinHovered:"PinnedSolid"};t.PinSiteButton=o.createItemCacheComponent(function(e,t){var d=o.evaluateItemCacheComponent(e,r.createElement(l.PinSiteAction,n.__assign({},t)));return r.createElement(u.WithAction,{action:d},function(e){var t=e.isAvailable,n=e.isToggled,o=e.execute;if(!t)return null;var u=n?h:p,l=n?a.default.UnpinLibrary:a.default.PinLibrary;return r.createElement("span",{className:f.odSitePinContainer,onClick:function(e){if(e){e.stopPropagation();e.preventDefault()}o({event:e}).catch(function(e){c.default.logError(e)})}},r.createElement(s.Link,{"aria-label":l,className:f.odSitePinButtonDefault},r.createElement(i.Icon,{iconName:u.default,className:f.odSitePinIcon,style:{opacity:n?1:0}})),r.createElement(s.Link,{"aria-label":l,className:f.odSitePinButtonHover},r.createElement(i.Icon,{iconName:u.siteHovered,className:f.odSitePinIcon})),r.createElement(s.Link,{"aria-label":l,className:f.odSitePinPinHover},r.createElement(i.Icon,{iconName:u.pinHovered,className:f.odSitePinIcon})))})})});
define("a2",["require","exports","lC","r","ks","i2","A1","ii","li","C1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PinSiteAction=f.createItemCacheComponent(function(e,t){var o=t.itemKey,f=t.rootItemKey,h=t.pinOperationType,p=a.pinnedItemKeyFacet.serialize({rootItemKey:f,itemKey:o}),d=!!e.demandItemFacet(u.pinOrderFacet,p),v=e.dispatch;return r.createElement(i.Action,{isAvailable:c(e,d,h),isToggled:l(d,h),onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){v(s.default({items:(e={},e[f]=(t={},t[o]={type:d?"unpin":"pin"},t),e)}));return[2]})})}})});function l(e,t){return!t&&e}function c(e,t,n){var r=o.getConfiguration(e,{isSitePinningEnabled:u.enableSitePinningConfigurationFacet,isFilesWeightedFrequentSitesEnabled:u.enableFilesWeightedFrequentSitesConfigurationFacet}),i=r.isSitePinningEnabled,s=r.isFilesWeightedFrequentSitesEnabled,a=!!i&&!!s;return!(a&&n&&("pin"===n&&t||"unpin"===n&&!t))&&a}});
define("lI",["require","exports","lC","r","ih","O1","bI","_I","pI","C1","A1","ii","uI"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesItemSetTilesListControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var n,r=l.getConfiguration(e,{enableSiteItemTileV2Configuration:c.enableSiteItemTileV2ConfigurationFacet}).enableSiteItemTileV2Configuration,i=2,s=64,o={width:352,height:s};if(r){s=80;n=24;o.height=s;i=3}return{tileRenderer:v,tileControlHandler:function(e,t){return{desiredSize:o}},groupControlHandler:function(e,t){return r?{headerRenderer:h.SiteHeaderTileCell}:{}},grid:{minRowHeight:s,mode:i,maxAspectRatio:5.5,spacing:n}}}}});var p=f.createItemCacheComponent(function(e,t){var i=t.defaultRender,s=t.itemName,o=t.itemActivity,f=t.itemKey,h=t.itemSetKey,p=n.__rest(t,["defaultRender","itemName","itemActivity","itemKey","itemSetKey"]),d=l.getConfiguration(e,{enableSiteItemTileV2Configuration:c.enableSiteItemTileV2ConfigurationFacet}).enableSiteItemTileV2Configuration?a.SiteItemTileV2:u.SiteItemTile;return i?r.createElement(i,n.__assign({},p,{showForegroundFrame:!1,showBackgroundFrame:!1,foreground:null,background:r.createElement(d,{itemKey:f,itemName:s,itemActivity:o,contentSize:t.contentSize,groupKey:h})})):null});function d(e,t){return{tileAs:p}}var v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(s.ControlHandlerProvider,{controlHandlers:o.itemTileControl.pack(d)},r.createElement(t,n.__assign({},i))):null};return t})(r.PureComponent)});
define("_I",["require","exports","r","V_","SPListItemsScopeDeferred_IS_mini_css","n2","C1","Un"],function(e,t,n,r,i,s,u,a){"use strict";var o=i.PinSite_9;i=i.SiteItemTile_3;Object.defineProperty(t,"__esModule",{value:!0});t.SiteItemTile=u.createItemCacheComponent(function(e,t){var l=t.itemKey,c=t.itemName,h=t.itemActivity,p=t.contentSize,d=t.groupKey,v=p?p.height:16,m=f(v),g=u.evaluateItemCacheComponent(e,n.createElement(r.ItemFileTypeIcon,{itemKey:l,size:m})),y=d&&l?u.evaluateItemCacheComponent(e,n.createElement(s.PinSiteButton,{itemKey:l,rootItemKey:d})):null;return n.createElement("div",{className:a.css(i.root,o.sitePinAllSitesParent)},n.createElement("div",{className:i.icon,style:{width:v+"px"}},g),n.createElement("div",{className:i.nameplate},n.createElement("span",{className:i.name},c),y?n.createElement("span",null,y):null,n.createElement("div",{className:i.activity},h)))});function f(e){return"number"==typeof e?e>=96?96:e>=64?64:e>=48?48:e>=40?40:e>=32?32:e>=20?20:16:16}t.getIconHeight=f});
define("pI",["require","exports","r","n2","C1","Un","SPListItemsScopeDeferred_IS_mini_css","sI"],function(e,t,n,r,i,s,o,a){"use strict";var u=o.PinSite_9;o=o.SiteItemTile_v2_7;Object.defineProperty(t,"__esModule",{value:!0});t.SiteItemTileV2=i.createItemCacheComponent(function(e,t){var f=t.itemKey,l=t.itemName,c=t.itemActivity,h=t.contentSize,p=t.groupKey,d=(function(e){var t,n;if("number"==typeof e)n=(e-(t=e>=72?48:e>=48?32:16))/2;else{t=16;n=0}return{height:t,padding:n}})(h?.9*h.height:16),v=i.evaluateItemCacheComponent(e,n.createElement(a.SiteIcon,{itemKey:f,size:d.height,className:o.icon,acronymHeightRatio:.5,acronymFontSizeRatio:.82})),m=p&&f?i.evaluateItemCacheComponent(e,n.createElement(r.PinSiteButton,{itemKey:f,rootItemKey:p})):null;return n.createElement("div",{className:s.css(o.root,u.sitePinAllSitesParent)},n.createElement("div",{style:{padding:d.padding+"px"}},v),n.createElement("div",{className:o.nameplate},n.createElement("span",{className:o.name},l),m?n.createElement("span",null,m):null,n.createElement("div",{className:o.activity},c)))})});
define("sI",["require","exports","r","ii","SPListItemsScopeDeferred_IS_mini_css","Ar","C1","Un"],function(e,t,n,r,i,s,o,u){"use strict";i=i.SiteIcon_5;Object.defineProperty(t,"__esModule",{value:!0});function a(e){var t=e.size,r=void 0===t?24:t,o=e.acronymColor,a=e.acronym,f=e.siteLogoUrl,l=e.className,c=e.acronymHeightRatio,h=void 0===c?.4:c,p=e.acronymFontSizeRatio,d=void 0===p?.72:p,v=n.useState(!1),m=v[0],g=v[1],y=n.useState(!1),b=y[0],w=y[1],E=s.useEventHandler(function(){w(!0)}),S=s.useEventHandler(function(){g(!0)}),x=r*h*d;return n.createElement("div",{className:u.css(l,i.acronym),style:{backgroundColor:o,width:r+"px",height:r+"px"}},n.createElement("p",{className:i.acronymText,style:{fontSize:Math.ceil(x)+"px"}},a),f&&!m?n.createElement("img",{className:b?i.siteLogo:i.siteLogoHidden,src:f,onLoad:E,onError:S}):null)}t.SiteIcon=o.createItemCacheComponent(function(e,t){var i=t.itemKey,s=t.size,o=t.className,u=t.acronymHeightRatio,f=t.acronymFontSizeRatio,l=e.demandItem({acronym:r.acronymFacet,acronymColor:r.bannerColorFacet,siteLogoUrl:r.bannerImageUrlFacet},i),c=l.acronym,h=l.acronymColor,p=l.siteLogoUrl;return n.createElement(a,{acronym:c,acronymColor:h,className:o,siteLogoUrl:p,size:s,acronymHeightRatio:u,acronymFontSizeRatio:f})})});
define("uI",["require","exports","r","C1","Rs","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s){"use strict";s=s.SiteHeaderTileCell_3;Object.defineProperty(t,"__esModule",{value:!0});t.SiteHeaderTileCell=r.createItemCacheComponent(function(e,t){var r=e.demandItemFacet(i.displayNameFacet,t.itemKey)||"";return n.createElement("div",null,n.createElement("h3",{className:s.name},r))})});
define("dI",["require","exports","ih","Mr"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesItemsViewControlHandler=n.createControlHandler()(i);t.spAllSitesItemsViewLayoutsControlHandler=n.createControlHandler()(i);function i(){return function(e){return function(e,t){return{defaultLayout:r.tilesLayoutType,isLayoutResolved:!0}}}}});
define("oI",["require","exports","ih","sI"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spWebItemFileTypeIconControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{fileTypeIconAs:r.SiteIcon}}}})});
define("rI",["require","exports","ih","ii"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spWebItemEngagementControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItem({pinOrder:r.pinOrderFacet,webId:r.webIdFacet,siteId:r.siteIdFacet},n),s=i.pinOrder,o=i.webId,u=i.siteId;return{engagement:{objectType:"Site",webId:o,siteId:u,extraData:{TargetSiteId:u,TargetWebId:o,isPinned:!!s}}}}}})});
define("iI",["require","exports","ih"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesItemEngagementControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{engagement:{objectType:"AllSites"}}}}})});
define("aI",["require","exports","lC","ih","li","ii","WD","A1"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.frequentSitesItemSetControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,i=e.demandItemFacet(s.parentGroupKeyFacet,n);return{itemKeys:a(e,i&&i.itemKey,r)}}}});function a(e,t,r,a){void 0===a&&(a=o.DEFAULT_LEFT_NAV_SITE_COUNT);if(u.getConfiguration(e,{enableSitePinningConfiguration:s.enableSitePinningConfigurationFacet}).enableSitePinningConfiguration&&t&&r&&r.length>a){for(var f=[],l=(function(e,t,r){return n.__spreadArrays(r).sort(function(n,r){var o=e.demandItemFacet(s.pinOrderFacet,i.pinnedItemKeyFacet.serialize({rootItemKey:t,itemKey:n})),u=e.demandItemFacet(s.pinOrderFacet,i.pinnedItemKeyFacet.serialize({rootItemKey:t,itemKey:r})),a=e.demandItemFacet(s.siteWeightageFacet,n),f=e.demandItemFacet(s.siteWeightageFacet,r);return u||o?o?u?u-o:-1:1:f||a?a?f?f-a:-1:1:0})})(e,t,r),c=0,h=Math.min(l.length,o.MAX_PINNED_FREQUENTSITES_COUNT);c<h;c++){var p=i.pinnedItemKeyFacet.serialize({rootItemKey:t,itemKey:l[c]});if(!e.demandItemFacet(s.pinOrderFacet,p))break;f.push(l[c])}var d=c,v=0;v=d>=a-o.MIN_NONPINNED_FREQUENT_SITE_COUNT?o.MIN_NONPINNED_FREQUENT_SITE_COUNT:a-d;h=Math.min(h,d+v);for(;c<h;c++)f.push(l[c]);return f}return r}});
define("nI",["require","exports","ih","A1","ii"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesItemSetSelectionControlHandler=n.createControlHandler()(function(){return function(){return s}});function s(e,t){var n=r.getConfiguration(e,{isSitePinningEnabled:i.enableSitePinningConfigurationFacet,isFilesWeightedFrequentSitesEnabled:i.enableFilesWeightedFrequentSitesConfigurationFacet}),s=n.isSitePinningEnabled,o=n.isFilesWeightedFrequentSitesEnabled;return s&&o?{}:{selectionMode:"none"}}});
define("NT",["require","exports","lC","Hm","ih","d0","BT","li"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointHomeAddonDeferred=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(i.registerControlHandler(u.spAllSitesKeyFacet,s.itemsContextMenuControl)(o.itemsContextControllerHandler));return[2]})})}})});
define("BT",["require","exports","lC","ih","jT"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsContextControllerHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.commands;return{commands:n.__spreadArrays([i.pinSiteCommand,i.unpinSiteCommand],r||[])}}}})});
define("jT",["require","exports","r","si","_s","Ro","li","a2","r2","C1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.withSelectedItems()(i.withExactlyOneItem()(u.PinSiteAction)),c=f.createItemCacheComponent(function(e,t){var r=s.getCurrentItemSetKey(e)||"";return e.demandItemFacet(o.spAllSitesKeyFacet,r)?n.createElement(l,{rootItemKey:r,pinOperationType:t.pinOperationType}):null});t.pinSiteCommand={key:new r.Facet("pinSiteCommand").id,automationId:"pinSiteCommand",name:a.default.PinLibrary,ariaLabel:a.default.PinLibrary,action:n.createElement(c,{pinOperationType:"pin"})};t.unpinSiteCommand={key:new r.Facet("unpinSiteCommand").id,automationId:"unpinSiteCommand",name:a.default.UnpinLibrary,ariaLabel:a.default.UnpinLibrary,action:n.createElement(c,{pinOperationType:"unpin"})}});
define("dJe",["require","exports","lC","r","pe","Ih","us","am","HF","hne","M9","pd","bw","uw","Zd","ce","Soe","mJe","pJe","fJe","uJe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._showTenantSiteDesigns=function(){s.Engagement.logData({name:"SiteScripts.ShowTenantSiteDesigns.Click"});i._siteScriptProgressStateManager.showTenantSiteDesigns()};i._hideTenantSiteDesigns=function(){s.Engagement.logData({name:"SiteScripts.HideTenantSiteDesigns.Click"});i._siteScriptProgressStateManager.hideTenantSiteDesigns()};i._renderChoiceGroupOption=function(e){return{key:e.runId,text:"",onRenderField:function(t,n){return r.createElement(y.SiteDesignRunChooser,{describedById:i._runChooserDescribedById,onSelected:i._onSiteDesignRunSelected,radioButtonProps:t,renderRadioButton:n,run:e})}}};i._onRadioChanged=function(e,t){i._siteScriptProgressStateManager.showSiteDesignRun(t.key)};i._onSiteDesignRunSelected=function(e){e&&e.runId&&i._siteScriptProgressStateManager.showSiteDesignRun(e.runId)};i._applySelectedTenantSiteDesign=function(){s.Engagement.logData({name:"SiteScripts.ApplyTenantSiteDesign.Click"});i.state.selectedTenantSiteDesign&&i._siteScriptProgressStateManager.applySiteDesign(i.state.selectedTenantSiteDesign)};i._onTenantSiteDesignSelected=function(e,t){i._siteScriptProgressStateManager.showTenantSiteDesign(e.key)};i._convertTenantSiteDesignToDropdownOption=function(e,t){return{key:e.id,text:e.title}};i._dismissAndRefresh=function(){s.Engagement.logData({name:"SiteScripts.DismissAndRefreshButton.Click"});i._onPanelDismissedInternal();window.location.reload(!0)};i._onClickNavigationCloseButton=function(){s.Engagement.logData({name:"SiteScripts.ClosePanelNavigation.Click"});i._onPanelDismissedInternal()};i._onPanelDismissed=function(){s.Engagement.logData({name:"SiteScripts.ClosePanel"});i._onPanelDismissedInternal()};i._onNewDataReceived=function(e){i.setState(e)};i.state={stagesRetrieved:!1,stageOutcomesKnown:0,stageOutcomesKnownButIncomplete:0};i._siteScriptProgressStateManager=i.props.siteScriptProgressStateManager;i.state=n.__assign({},i._siteScriptProgressStateManager.getState());i._runChooserDescribedById="SiteDesignRunChooserDescription"+Math.random().toString();i._designChooserDescribedById="SiteDesignChooserDescription"+Math.random().toString();return i}t.prototype.componentDidMount=function(){this._siteScriptProgressManagerKey="SiteScriptProgressPanel"+Math.random().toString();this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newProgressData,this._onNewDataReceived);this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newNonProgressData,this._onNewDataReceived);this.props.firstRunPanelExperience||this._siteScriptProgressStateManager.retrieveTenantSiteDesignsAndSiteDesignRuns()};t.prototype.componentWillUnmount=function(){this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newProgressData);this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newNonProgressData)};t.prototype.render=function(){var e=void 0;this.props.isOpen&&(e=r.createElement("div",{className:w.styles.siteScriptProgressPanelRoot},this._renderLeftColumn(),this._renderRightColumn()));return r.createElement(h.Panel,{isOpen:this.props.isOpen,className:w.styles.siteScriptProgressPanel,hasCloseButton:!1,isLightDismiss:!0,onDismiss:this._onPanelDismissed,type:h.PanelType.custom,customWidth:"900px"},e)};t.prototype._renderNavigation=function(){return r.createElement("div",{className:w.styles.navigation},r.createElement(u.IconButton,{className:w.styles.xButton,onClick:this._onClickNavigationCloseButton,"data-is-visible":!0,"data-is-focusable":!0,iconProps:{iconName:"Cancel"},ariaLabel:b.default.progressPanelDismissButtonText}))};t.prototype._renderLeftColumn=function(){var e;e=this.props.firstRunPanelExperience?this._renderSiteDesignWorkingImage():this._shouldShowTenantSiteDesigns()?this._renderTenantSiteDesignMetadata():this._renderSiteDesignRuns();return r.createElement("div",{className:o.css(w.styles.darker,w.styles.column,w.styles.leftColumn)},r.createElement("div",{className:w.styles.columnHeader},this._renderPanelTitle(),this._renderPanelSubtitle()),e,r.createElement("div",{className:o.css(w.styles.columnFooter)},this.props.firstRunPanelExperience?this._renderGearMenuHint():this._renderTenantSiteDesignsLink()))};t.prototype._renderSiteDesignWorkingImage=function(){if(this.props.imageUrls){var e=window.devicePixelRatio<2?this.props.imageUrls.workingSiteDesign:this.props.imageUrls.workingSiteDesign2x;if(e)return r.createElement(l.Image,{className:w.styles.workingImage,imageFit:l.ImageFit.contain,alt:"",role:"presentation",src:e})}};t.prototype._renderTenantSiteDesignMetadata=function(){var e;if(this.state.selectedTenantSiteDesign){var t=void 0,n="";if((e=this._siteScriptProgressStateManager.getTenantSiteDesign(this.state.selectedTenantSiteDesign)).imageUrl){t=e.imageUrl;n=e.imageAltText?e.imageAltText:""}else t=this.props.imageUrls?"68"===this._siteScriptProgressStateManager.getWebTemplate()?this.props.imageUrls.commSiteCustomizedLogo:this.props.imageUrls.teamSiteCustomizedLogo:"";if(e)return r.createElement("div",{className:w.styles.columnBody},r.createElement("div",{className:w.styles.siteDesignDescription},e.description),r.createElement("div",null,r.createElement(l.Image,{src:t,alt:n,className:w.styles.siteDesignLogoImage})))}return r.createElement("div",{className:w.styles.columnBody})};t.prototype._renderPanelSubtitle=function(){return!this.props.firstRunPanelExperience&&this._shouldShowTenantSiteDesigns()?this._renderTenantSiteDesignChooser():r.createElement("div",{className:w.styles.progressPanelSubtitle},this.props.firstRunPanelExperience?b.default.progressPanelSubtitle:b.default.progressPanelReopenedSubtitle)};t.prototype._renderPanelTitle=function(){var e=void 0,t=b.default.progressPanelTitle;if(!this.props.firstRunPanelExperience){this.state.showingTenantSiteDesigns&&(e=r.createElement(u.IconButton,{iconProps:{iconName:"Back"},onClick:this._hideTenantSiteDesigns,ariaLabel:b.default.backButtonAriaLabel}));t=this._shouldShowTenantSiteDesigns()?b.default.progressPanelOtherSiteDesignsTitle:b.default.progressPanelReopenedTitle}return r.createElement("div",{className:o.css(w.styles.progressPanelTitle,this.props.firstRunPanelExperience?w.styles.bigTitle:"")},e,t)};t.prototype._shouldShowTenantSiteDesigns=function(){return this.state.showingTenantSiteDesigns||this.state.siteDesignRuns&&0===this.state.siteDesignRuns.length};t.prototype._renderTenantSiteDesignsLink=function(){if(!this._shouldShowTenantSiteDesigns())return r.createElement(c.Link,{className:w.styles.tenantSiteDesigns,onClick:this._showTenantSiteDesigns},b.default.progressPanelSeeOtherDesignsLink)};t.prototype._renderGearMenuHint=function(){};t.prototype._renderSiteDesignRuns=function(){var e=this.state.siteDesignRuns;return e&&e.length?r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable)},r.createElement(a.ChoiceGroup,{selectedKey:this.state.displayedRunKey,onChange:this._onRadioChanged,options:e.map(this._renderChoiceGroupOption)}),r.createElement("div",{id:this._runChooserDescribedById,className:w.styles.accessible},b.default.runChooserDescription)):r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable)})};t.prototype._renderTenantSiteDesignChooser=function(){var e=this.state.tenantSiteDesigns;if(e){var t=n.__spreadArrays([{key:"",text:b.default.siteDesignChooserNone}],e.map(this._convertTenantSiteDesignToDropdownOption));return r.createElement("div",null,r.createElement("div",{className:w.styles.siteDesignChooserTitle},b.default.siteDesignChooserTitle),r.createElement(f.Dropdown,{placeHolder:b.default.siteDesignChooserNone,onChanged:this._onTenantSiteDesignSelected,options:t,selectedKey:this.state.selectedTenantSiteDesign}),r.createElement("div",{className:w.styles.accessible,id:this._designChooserDescribedById},b.default.tenantSiteDesignChooserDescription))}return r.createElement("div",null,r.createElement(d.Spinner,null))};t.prototype._renderRightColumn=function(){return r.createElement("div",{className:o.css(w.styles.column,w.styles.rightColumn)},this._renderNavigation(),r.createElement("div",{className:w.styles.columnInternal},this._renderRightColumnHeader(),this._renderRightColumnBody(),r.createElement("div",{className:w.styles.columnFooter},this._renderDismissButtonIfNecessary())))};t.prototype._renderRightColumnHeader=function(){if(this._shouldShowTenantSiteDesigns()){if(this.state.selectedTenantSiteDesign&&this.state.selectedTenantSiteDesignSchema)return r.createElement("div",{className:w.styles.columnHeader},this._renderTenantSiteDesignTitle(this.state.selectedTenantSiteDesignSchema.siteDesignTitle))}else{var e=this._siteScriptProgressStateManager.getData(this.state.displayedRunKey);if(e&&this.state.stagesRetrieved&&this.state.age!==m.SiteScriptRunAge.unknown)return r.createElement("div",{className:w.styles.columnHeader},this._renderProgressIndicator(e))}};t.prototype._renderRightColumnBody=function(){if(this._shouldShowTenantSiteDesigns()){if(!this.state.selectedTenantSiteDesign){var e=void 0;e=v.Killswitch.isActivated("c699dc3e-812b-49c7-9845-ba97f7d064e8","06/27/2019","SITE_DESIGN_OVERVIEW_URL_Localizable")?"http://aka.ms/spsitedesigns/":i.format("https://docs.microsoft.com/{0}/sharepoint/dev/declarative-customization/site-design-overview?branch=sitedesign",this.props.pageContext.currentUICultureName);return r.createElement("div",{className:o.css(w.styles.columnBody)},r.createElement("div",{className:w.styles.explainerTitle},b.default.progressPanelExplainerTitle),r.createElement("div",null,b.default.progressPanelExplainerText),r.createElement("div",{className:w.styles.explainerLink},r.createElement(c.Link,{href:e,target:"_blank"},b.default.progressPanelExplainerLink)))}if(this.state.selectedTenantSiteDesignSchema)return r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable,w.styles.schemaArea)},this._renderPanelContents(this.state.selectedTenantSiteDesignSchema,void 0,!0))}else{var t=this._siteScriptProgressStateManager.getData(this.state.displayedRunKey);if(t&&this.state.stagesRetrieved&&this.state.age!==m.SiteScriptRunAge.unknown)return r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable,w.styles.schemaArea)},this._renderPanelContents(t.siteScriptData,t.stageResultData,!1))}return r.createElement("div",{className:w.styles.columnBody},this._renderEmptyState())};t.prototype._renderEmptyState=function(){return r.createElement("div",null,r.createElement(d.Spinner,{label:b.default.emptyStateText}))};t.prototype._renderProgressIndicator=function(e){if(this.state.age===m.SiteScriptRunAge.old){var t=this.props.siteScriptProgressStateManager.getSiteDesignRun(this.state.displayedRunKey);if(t)return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement("div",{className:w.styles.noProgressIndicator},e.siteScriptData.siteDesignTitle),r.createElement("div",{className:w.styles.siteScriptProgressSubtext},i.format(b.default.progressPanelVersionAndDateRanText,t.version,t.runDate)))}var n=void 0;this._siteScriptProgressStateManager.isRunComplete(this.state.displayedRunKey)||this.props.firstRunPanelExperience||(n=r.createElement("div",{className:w.styles.siteScriptLongRunningText},b.default.longRunningSiteDesignText));var s=this._siteScriptProgressStateManager.getCompletionRatio(this.state.displayedRunKey),o=this._getCompletionPercentage(s);return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement(p.ProgressIndicator,{label:e.siteScriptData.siteDesignTitle,percentComplete:s}),r.createElement("span",{className:w.styles.siteScriptProgressSubtext,role:"alert"},o),n)};t.prototype._renderTenantSiteDesignTitle=function(e){return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement("div",{className:w.styles.tenantSiteDesignTitle},e),r.createElement(u.PrimaryButton,{ariaLabel:b.default.applySiteDesignButtonText,disabled:!1,onClick:this._applySelectedTenantSiteDesign,text:b.default.applySiteDesignButtonText}))};t.prototype._renderPanelContents=function(e,t,n){var i=[],s=0;if(e&&e.siteScripts)for(var o=0;o<e.siteScripts.length;o++)for(var u=0;u<e.siteScripts[o].actions.length;u++){i.push(r.createElement(g.SiteScriptActionLabel,{key:"scriptAction_"+o.toString()+"_"+u.toString(),stageNames:e.siteScripts[o].actions[u].stages,stageResultData:t,stageOutcomesKnown:this.state.stageOutcomesKnown,stageStartIndex:s,demoMode:n}));s+=e.siteScripts[o].actions[u].stages.length}return i};t.prototype._renderDismissButtonIfNecessary=function(){return this.state.hasARunCompleted||this.props.firstRunPanelExperience&&this._siteScriptProgressStateManager.isRunComplete(this.state.displayedRunKey)?r.createElement(u.PrimaryButton,{ariaLabel:b.default.progressPanelDismissAndRefreshButtonText,"data-automationid":"SiteScriptProgressCloseButton",disabled:!1,onClick:this._dismissAndRefresh,text:b.default.progressPanelDismissAndRefreshButtonText}):void 0};t.prototype._onPanelDismissedInternal=function(){this.props.onDismissed&&this.props.onDismissed();this._siteScriptProgressStateManager.hideTenantSiteDesigns()};t.prototype._getCompletionPercentage=function(e){if(e>=1)return b.default.progressPanelCompleteStatus;if(e<=0)e=0;else{e*=100;e=Math.floor(e)}return i.format(b.default.progressPanelPercentComplete,e)};return t})(r.Component);t.SiteScriptProgressPanel=E});
define("mJe",["require","exports","lC","r","pe","ce","nc","Zd","us","fJe","uJe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._renderStage=function(e,n){return 0===n?null:r.createElement("div",{key:t._getStageKey(n),className:l.styles.stageTitle,"data-automationid":"SiteScriptProgressStageTitle"},e)};return t}t.prototype.render=function(){var e,t=void 0,n=void 0,c=l.styles.activeActionTitle,h=void 0,p=this.props.stageNames[0];e=s.Killswitch.isActivated("402D171D-93E7-49F4-8E32-4231EFA41B9D","5/10/2019","Show stages for long site designs")?!!this.props.stageResultData:!!this.props.stageNames;if(!this.props.demoMode&&e){for(var d=Math.min(this.props.stageNames.length,Math.max(0,this.props.stageOutcomesKnown-this.props.stageStartIndex)),v=!1,m=!1,g=0;g<d;g++){var y=this.props.stageResultData[g+this.props.stageStartIndex];if(1===y.outcomeCode){v=!0;t=r.createElement("div",{className:l.styles.errorText},y.outcomeText||f.default.defaultFailureOutcomeText);break}4===y.outcomeCode&&(m=!0)}if(v){h=i.format(f.default.actionErrorAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.errorIcon),iconName:"Error",role:"img"})}else if(m){h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(u.Spinner,{ariaLabel:h,className:l.styles.inProgressSpinner,role:"img",size:u.SpinnerSize.small})}else if(d>=this.props.stageNames.length){h=i.format(f.default.actionCompleteAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.successIcon),"data-automationid":"SiteScriptProgressSuccessIcon",iconName:"CheckMark",role:"img"})}else if(this.props.stageOutcomesKnown>=this.props.stageStartIndex){h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(u.Spinner,{ariaLabel:h,className:l.styles.inProgressSpinner,role:"img",size:u.SpinnerSize.small})}else{h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.incompleteIcon),iconName:"CheckMark",role:"img"});c=l.styles.inactiveActionTitle}}else n=r.createElement(o.Icon,{"aria-hidden":"true",iconName:"CheckMark",className:a.css(l.styles.actionIcon,l.styles.incompleteIcon)});return r.createElement("div",{role:"heading",className:l.styles.actionContainer,"data-automationid":"SiteScriptProgressActionContainer","aria-label":h},r.createElement("div",{className:l.styles.actionHeader},n,r.createElement("div",{className:a.css(l.styles.actionTitle,c,n?"":l.styles.actionTitleNoIcon),"data-automationid":"SiteScriptProgressActionTitle"},this.props.stageNames[0]||"")),t,r.createElement("div",{className:l.styles.stageContainer},this.props.stageNames.map(this._renderStage)))};t.prototype._getStageKey=function(e){return"scriptProgress_"+this.props.stageStartIndex.toString+"_"+e.toString()};return t})(r.Component);t.SiteScriptActionLabel=c});
define("uJe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.styles={accessible:"ms-siteScriptProgress-accessible",siteScriptLongRunningText:"ms-siteScriptProgress-siteScriptLongRunningText",schemaArea:"ms-siteScriptProgress-schemaArea",workingImage:"ms-siteScriptProgress-workingImage",columnInternal:"ms-siteScriptProgress-columnInternal",siteDesignLogoImage:"ms-siteScriptProgress-siteDesignLogoImage",darker:"ms-siteScriptProgress-darker",xButton:"ms-siteScriptProgress-xButton",navigation:"ms-siteScriptProgress-navigation",siteDesignDescription:"ms-siteScriptProgress-siteDesignDescription",explainerLink:"ms-siteScriptProgress-explainerLink",explainerTitle:"ms-siteScriptProgress-explainerTitle",scrollable:"ms-siteScriptProgress-scrollable",siteDesignChooserTitle:"ms-siteScriptProgress-siteDesignChooserTitle",tenantSiteDesignTitle:"ms-siteScriptProgress-tenantSiteDesignTitle",gear:"ms-siteScriptProgress-gear",noProgressIndicator:"ms-siteScriptProgress-noProgressIndicator",bigTitle:"ms-siteScriptProgress-panelBigTitle",runChoiceChecked:"ms-siteScriptProgress-runChoiceChecked",runChoiceRoot:"ms-siteScriptProgress-runChoiceRoot",runChoiceRadio:"ms-siteScriptProgress-runChoiceRadio",runChoiceText:"ms-siteScriptProgress-runChoiceText",runChoicePrimaryText:"ms-siteScriptProgress-runChoicePrimaryText",runChoiceSecondaryText:"ms-siteScriptProgress-runChoiceSecondayText",runChoiceArrow:"ms-siteScriptProgress-runChoiceArrow",tenantSiteDesigns:"ms-siteScriptProgress-tenantSiteDesignsLink",column:"ms-siteScriptProgress-column",leftColumn:"ms-siteScriptProgress-leftColumn",rightColumn:"ms-siteScriptProgress-rightColumn",columnFooter:"ms-siteScriptProgress-columnFooter",columnBody:"ms-siteScriptProgress-columnBody",columnHeader:"ms-siteScriptProgress-columnHeader",panelBottomTextBold:"ms-siteScriptProgress-panelBottomTextBold",siteScriptProgressPanelRoot:"ms-siteScriptProgress-panelRoot",siteScriptProgressPanel:"ms-siteScriptProgress-panel",emptyStageContainer:"ms-siteScriptProgress-emptyStageContainer",errorIcon:"ms-siteScriptProgress-errorIcon",errorText:"ms-siteScriptProgress-errorText",inProgressSpinner:"ms-siteScriptProgress-inProgressSpinner",actionIcon:"ms-siteScriptProgress-actionIcon",successIcon:"ms-siteScriptProgress-successIcon",activeActionTitle:"ms-siteScriptProgress-activeActionTitle",actionTitle:"ms-siteScriptProgress-actionTitle",actionTitleNoIcon:"ms-siteScriptProgress-actionTitleNoIcon",incompleteIcon:"ms-siteScriptProgress-incompleteIcon",inactiveActionTitle:"ms-siteScriptProgress-inactiveActionTitle",stageTitle:"ms-siteScriptProgress-stageTitle",siteScriptProgressSubtext:"ms-siteScriptProgress-siteScriptProgressSubtext",progressIndicatorContainer:"ms-siteScriptProgress-progressIndicatorContainer",progressPanelTitle:"ms-siteScriptProgress-panelTitle",progressPanelSubtitle:"ms-siteScriptProgress-panelSubtitle",titleContainer:"ms-siteScriptProgress-titleContainer",actionContainer:"ms-siteScriptProgress-actionContainer",emptyStageProgressIndicator:"ms-siteScriptProgress-emptyStageProgressIndicator",stageContainer:"ms-siteScriptProgress-stageContainer",actionHeader:"ms-siteScriptProgress-actionHeader"}});
define("pJe",["require","exports","lC","r","pe","us","uJe","nc","fJe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderLabel=function(e){return r.createElement("div",{id:e.labelId,className:o.styles.accessible},i.format(a.default.siteDesignRunChooserAriaLabel,t.props.run.siteDesignTitle,t.props.run.runDate))};t._onSelected=function(){t.props.onSelected(t.props.run)};return t}t.prototype.render=function(){var e={};e[o.styles.runChoiceChecked]=this.props.radioButtonProps.checked;return r.createElement("div",{className:s.css(o.styles.runChoiceRoot,e),onClick:this._onSelected},r.createElement("div",{className:o.styles.runChoiceRadio},this.props.renderRadioButton(n.__assign(n.__assign({},this.props.radioButtonProps),{"aria-describedby":this.props.describedById,onRenderLabel:this._onRenderLabel}))),r.createElement("div",{className:o.styles.runChoiceText},r.createElement("div",{className:o.styles.runChoicePrimaryText},this.props.run.siteDesignTitle),r.createElement("div",{className:o.styles.runChoiceSecondaryText},i.format(a.default.progressPanelDateRanText,this.props.run.runDate))),r.createElement("div",{className:o.styles.runChoiceArrow},r.createElement(u.Icon,{iconName:"ChevronRight",className:"ms-Icon--m"})))};return t})(r.Component);t.SiteDesignRunChooser=f});
define("_Je",["require","exports","lC","ih","oh","AQe","Lqe","jJe","ii","zM","li","Q3","cg","og","Jb","Zb","gb","Bb","sb","Pb","Cb","Z0","ai","bqe","BJe","FJe","OS","QH","dC","Y0","Ty","jk","tP","sf","Re","CD","o4","oje","SJe","PM","Y3","Uy","vJe","b2","Pqe","gJe","hJe","bg","Y0","gqe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return Q}});function Q(e,t){var r=t.itemKey,i=t.commands,u=t.farCommands,f=t.overflowCommands,h=A.isTeamsWebView(),p=O.isCrossOrigin(),d=h||p,v=e.demandItemFacet(l.spItemKeyFacet,r),m=e.demandItemFacet(c.savedForLaterRootItemKeyFacet,r),g=e.demandItemFacet(H.sharedWithMeRootItemKeyFacet,r),y=e.demandItemFacet(B.SharedByMeRootItemKeyFacet,r),b=e.demandItemFacet(q.recentRootItemKeyFacet,r),w={commands:i,hostedInTeamsDesktop:h,hostedCrossOrigin:p,itemCache:e,overflowCommands:f};if(v){var N=e.demandItemFacet(a.spPageContextFacet,l.spPageContextKeyFacet.serialize({webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl})),C=N&&N.webTemplate,L=N&&N.listBaseTemplate,M=Number(C)===E.WebTemplateType.mySite,D=Number(L)===S.ListTemplateType.contentCenterModelLibrary,j=Number(L)===S.ListTemplateType.contentCenterModelUsageList,U={webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl},z=l.spListKeyFacet.serialize(U),W=e.demandItemFacet(a.listFacet,z),V=!!W&&!!W.isDocumentLibrary,$=!!W&&W.allowCreateFolder,J=!!W&&W.permissions,Q=x.getFlowCommand(e,r),Z=T.getIntegrateCommand(e,r);if(i&&i.length>0&&i[0].key===_.exitQuickEditCommand.key){if(P.default.isActivated("86CDDB78-0503-4987-9214-48BC92A7E039","8/1/2019","Allow more commands in command bar in quick edit"))return{farCommands:[o.filtersPaneCommand]};var ie=ee(I.openFileCommand);return F.getQuickEditCommands(e,{itemKey:r,listKey:U,pageContext:N,isDocumentLibrary:V,extraCommands:{flowCommand:Q,openCommand:ie,integrateCommand:K.shouldDisplayIntegrateCommand(L)?Z:void 0}})}var se=i?Y(e,{defaultCommands:i||[],isODB:M,isDocumentLibrary:V,isContentCenterModelLibrary:D,isContentCenterModelUsageList:j,allowCreateFolder:$,hosted:d,hostedCrossOrigin:p,hostedInTeamsDesktop:h,listTemplate:L}):[];!Q||D||j||se.push(Q);Z&&K.shouldDisplayIntegrateCommand(L)&&se.push(Z);var oe=te(e,{farCommands:u,isDocumentLibrary:V,canModifySchema:!!(J&&!(!J.manageLists&&!J.managePersonalViews)),hosted:d,isOdb:M}),ue=(function(e,t){var r=t.overflowCommands,i=void 0===r?[]:r,u=t.isODB,a=t.isDocumentLibrary,f=t.hostedCrossOrigin,l=t.hostedInTeamsDesktop;if(!i)return[];var c=[];if(u||f&&l)c=n.__spreadArrays([s.versionHistoryCommand],i);else{c=f&&!l?[s.versionHistoryCommand,s.manageAlertCommand]:l&&!f?[s.versionHistoryCommand,s.alertMeCommand]:[s.versionHistoryCommand,s.alertMeCommand,s.manageAlertCommand];a&&c.push(o.makeHomePageCommand);c=c.concat(i)}return c})(0,{overflowCommands:f,isODB:M,isDocumentLibrary:V,hostedCrossOrigin:p,hostedInTeamsDesktop:h});if(M){var ae=R.buildSortCommand(e,{itemKey:r});oe.unshift(ae)}return k.isFeatureEnabled(k.SPListPltCommands)?{commands:re(se),farCommands:re(oe),overflowCommands:re(ue)}:{commands:se,farCommands:oe,overflowCommands:ue}}if(m)return ne(e,n.__assign({endpoint:m.endpoint},w));if(g){var fe=[];fe=G(e,{endpoint:g.endpoint,payload:{defaultCommands:i||[],isODB:!0,isSharedTab:!0,isDocumentLibrary:!0,isContentCenterModelLibrary:!1,isContentCenterModelUsageList:!1,allowCreateFolder:!1,hosted:h||p,hostedCrossOrigin:p,hostedInTeamsDesktop:h,isSavedForLaterPivot:!1},itemKey:r});var le=X.getSharedNavigationCommands(e,r);return{commands:n.__spreadArrays(le,fe),farCommands:oe=te(e,{farCommands:u,isDocumentLibrary:!0,canModifySchema:!1,hosted:d,isOdb:!0}),overflowCommands:[]}}if(y){fe=[];fe=G(e,{endpoint:y.tenantRootUrl,payload:{defaultCommands:i||[],isODB:!0,isSharedTab:!0,isDocumentLibrary:!0,isContentCenterModelLibrary:!1,isContentCenterModelUsageList:!1,allowCreateFolder:!1,hosted:h||p,hostedCrossOrigin:p,hostedInTeamsDesktop:h,isSavedForLaterPivot:!1},itemKey:r});oe=te(e,{farCommands:u,isDocumentLibrary:!1,canModifySchema:!0,hosted:d,isOdb:!0}),le=X.getSharedNavigationCommands(e,r);return{commands:n.__spreadArrays(le,fe),farCommands:oe,overflowCommands:[]}}if(b){var ce=b.endpoint;return ne(e,n.__assign({endpoint:ce},w))}return{}}function G(e,t){var n,r=t.endpoint,i=t.payload;n=i.defaultCommands?Y(e,i):[];return V.getExtendedCommandsWithFileHandlers(e,r,n)}function Y(e,t){var r=[],i=t.isODB,u=t.isSharedTab,a=t.isDocumentLibrary,l=t.isContentCenterModelLibrary,c=t.isContentCenterModelUsageList,m=t.hostedCrossOrigin,E=t.defaultCommands,S=t.hosted,x=t.hostedInTeamsDesktop,T=t.allowCreateFolder,L=t.isSavedForLaterPivot,A=t.listTemplate;i||(a?m||r.push(o.cancelEditCommand):m?r.push(o.EditItemCommand):r.push(o.cancelEditCommand,o.EditItemCommand));for(var O=0,_=E;O<_.length;O++){var D=_[O];if(D.key===h.newCommand.key)r.push(Z(D,!!a,!!l,!!T,i));else if(D.key===d.copyLinkCommand.key){r.push(d.copyLinkCommand);i&&r.push(o.FileRequestCommand)}else if(D.key===p.openCommand.key)r.push(ee(D));else if(D.key===g.downloadCommand.key&&k.isFeatureEnabled(k.TeamChannelFolder)){r.push(D);r.push(o.TeamChannelCommand);r.push(o.runModelCommand)}else if(D.key!==g.downloadCommand.key||k.isFeatureEnabled(k.TeamChannelFolder))if(D.key===y.followCommand.key&&z.isSavedForLaterEnabled())r.push(N.saveForLaterCommand);else if(D.key===f.exportListCommand.key)x||(k.isFeatureEnabled(k.CommandBarBrandIcons)?r.push(f.exportListCommandBrandIcon):r.push(D));else if(D.key===v.uploadCommand.key){var P=D;k.isFeatureEnabled(k.ShimSharePointUploader)||(P=n.__assign(n.__assign({},P),{subMenuProps:n.__assign(n.__assign({},P.subMenuProps),{items:[o.UploadFileCommand,o.UploadFolderCommand]})}));P.subMenuProps&&P.subMenuProps.items&&P.subMenuProps.items.length>0&&P.subMenuProps.items[P.subMenuProps.items.length-1].key!==M.UploadTemplateCommand.key&&!i&&a&&(P=n.__assign(n.__assign({},P),{subMenuProps:n.__assign(n.__assign({},P.subMenuProps),{items:n.__spreadArrays(P.subMenuProps.items,[M.UploadTemplateCommand])})}));r.push(P)}else if(L&&z.isSavedForLaterEnabled()){var H=D.key===b.renameCommand.key,B=D.key===w.deleteCommand.key,F=D.key===W.fileRequestCommand.key;H||B||F||r.push(D)}else r.push(D);else r.push(o.runModelCommand)}if(i)u?r.push(o.addToOneDriveCommand):r.push(o.quickEditCommand,o.moveToCommand,o.copyToCommand);else if(a){if(!m){r.push(o.quickEditCommand);j.default.arePowerAppsFormsEnabled()&&r.push(s.powerAppsCommand)}r.push(o.moveToCommand,o.copyToCommand,o.AddToQuickLaunchCommand);k.isFeatureEnabled(k.WexSitePagesScheduling)&&r.push(U.scheduleCommand)}else{m||(K.shouldDisplayIntegrateCommand(A)?r.push(o.quickEditCommand):r.push(o.quickEditCommand,s.powerAppsCommand));r.push(o.moveToCommand);S&&r.push(o.OpenInSharePointCommand)}l?r=r.filter(function(e){return e.key!==C.syncCommand.key&&e.key!==o.quickEditCommand.key&&e.name!==o.quickEditCommand.name&&e.key!==s.powerAppsCommand.key&&e.key!==f.exportListCommand.key&&e.key!==s.aibuilderCommand.key}):c&&(r=[]);return r}function Z(e,t,r,i,s){if(e.key!==h.newCommand.key)return e;if(t){if(r)return u.contentCenterCreateModelCommand;if(J.isOneDriveWinApp()&&k.isFeatureEnabled(L.UseItemsScopeInODApp)&&e.subMenuProps)return n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:[$.createFolderCommand]})});if(e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key!==M.AddTemplateCommand.key)return n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:n.__spreadArrays(e.subMenuProps.items,[o.CreateShortcutCommand],s?[]:[{name:"-",key:"divider_2",itemType:D.ContextualMenuItemType.Divider},o.EditNewMenuCommand,M.AddTemplateCommand])})})}else if(e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key===f.createListItemCommand.key&&e.subMenuProps.items.length<=2&&!i)return{key:e.key,action:f.createListItemCommand.action,iconProps:e.iconProps,name:e.name};return e}function ee(e){return e.key!==p.openCommand.key?e:e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key!==o.OpenInPowerBICommand.key&&n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:n.__spreadArrays(e.subMenuProps.items,[o.OpenInTextEditorCommand,o.OpenInPowerBICommand])})})||e}function te(e,t){for(var r=t.farCommands,s=void 0===r?[]:r,u=t.isDocumentLibrary,a=t.canModifySchema,f=t.hosted,l=t.isOdb,c=[],h=0,p=s;h<p.length;h++){var d=p[h];if(d.key===m.switchLayoutCommand.key){var v=d.subMenuProps?n.__spreadArrays(d.subMenuProps.items):[];if(u&&d.subMenuProps&&d.subMenuProps.items)for(var g=0,y=0,b=v;y<b.length;y++){if("tilesListCommand"===b[y].automationId&&(!v[g+1]||v[g+1].key!==o.OpenInExplorerCommand.key)){v.splice(g+1,0,o.OpenInExplorerCommand);break}g++}c.push(n.__assign(n.__assign({},d),{subMenuProps:n.__assign(n.__assign({},d.subMenuProps),{items:d.subMenuProps&&(a?n.__spreadArrays(v,[o.launchFormatViewPaneCommand]):n.__spreadArrays(v))||[o.launchFormatViewPaneCommand]})}))}else c.push(d)}c.push(o.filtersPaneCommand,o.detailsCommand);k.isFeatureEnabled(k.SPListLightSpeed)&&k.isFeatureEnabled(k.FullscreenList)&&e.demandItemFacet(i.isLightspeedAppFacet,i.odspNextAppItemKey)&&!f&&!l&&!A.isWebViewHosted()&&c.push(o.fullscreenCommand);return c}function ne(e,t){var r=t.endpoint,i=t.commands,o=t.hostedInTeamsDesktop,u=t.hostedCrossOrigin,a=t.overflowCommands,f=[],l=[];f=i?Y(0,{defaultCommands:i||[],isODB:!0,isDocumentLibrary:!0,allowCreateFolder:!1,hosted:o||u,hostedCrossOrigin:u,hostedInTeamsDesktop:o,isSavedForLaterPivot:!0}):[];f=V.getExtendedCommandsWithFileHandlers(e,r,f);u&&o&&(l=a?n.__spreadArrays([s.versionHistoryCommand],a):[s.versionHistoryCommand]);return{commands:f,farCommands:[],overflowCommands:l}}function re(e){if(!e||!e.length)return e;for(var t=[],n={},r=0,i=e;r<i.length;r++){var s=i[r];if(!n[s.key]){t.push(s);n[s.key]=!0}}return t}});
define("jJe",["require","exports","r","si","VJe","W0"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.contentCenterCreateModelCommand={key:new r.Facet("CreateModel").id,name:s.default.CreateModel,action:n.createElement(i.LaunchCreateModelPanelAction,null),iconProps:{iconName:"Add"}}});
define("VJe",["require","exports","lC","r","x2","To","c0","S3","yp","ev","Re","zYe","SPListItemsScopeDeferred_IS_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=f.afterPageLoad()(a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["rFt"],t,n)})];case 1:return[2,t.sent().default]}})})})),p=f.afterPageLoad()(a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["qWe"],t,n)})];case 1:return[2,t.sent().default]}})})}));t.LaunchCreateModelPanelAction=function(){return r.createElement(i.WizardAction,{engagement:{isIntentional:!0,name:"CreateModelPanelOpen",currentPage:"ModelListPage"},isAvailable:!0},o.withResources()(function(e){var t=e.reject,n=e.resolve,i=function(){t(new s.CancelError)},o=e.resources.consume(u.pageContext),a=function(e){e&&n()};return l.default.isActivated("61b2b6bf-ebbb-4237-aacc-30de3b9377e6","6/4/2020","Create Model Panel from odsp-common")?r.createElement(p,{resources:e.resources,onDismiss:i,onComplete:a}):r.createElement(h,{screenReaderAlert:c.default.alert,pageContext:o,onDismiss:i,onComplete:a})}))}});
define("BJe",["require","exports","si","W0","MQe","Xy","bqe","Yo"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new n.Facet("Integrate").id;t.getIntegrateCommand=function(e,t){if(!(u.getSelectedItemKeys(e).length>0)){var n=s.getPageContextFromItemCache(e,t),f=[i.powerAppsCommand];n&&f.push(o.getPowerAutomateCommand(n));return{key:a,name:r.default.IntegrateCommandLabel,iconProps:{iconName:"AppIconDefault"},engagement:{name:"IntegrateMenu",isIntentional:!0},subMenuProps:{items:f}}}}});
define("FJe",["require","exports","lC","HJe","YY","sb","ec","lqe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SaveForLaterCoachmarkCommand=r.createCoachmarkCommand(i.SAVE_FOR_LATER_COMMAND,function(e){return u.hasNoSavedItemsForLater(e)});t.saveForLaterCommand=n.__assign(n.__assign({},s.followCommand),{commandBarButtonAs:o.defaultRenderComponentOption().merge(t.SaveForLaterCoachmarkCommand,s.followCommand.commandBarButtonAs)})});
define("HJe",["require","exports","lC","r","eh","BH","u3","tne","NJe","c0","UK","Ih","YY","C1","RJe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._hideCoachmark=function(){var e=n.state.teachingBubble;e&&n._observables.wrap(e.isVisible)(!1)};n._onDismissTeachingBubble=function(){var e=n.state.teachingBubble;if(e){n._hideCoachmark();n._isReminderFlowCoachmark&&c.Engagement.logData({name:"ReminderFlowCoachmark.Close"});n._teachingBubbleProvider.markBubbleAsDismissed(e.campaign())}};n._getCurrentTeachingBubble=function(){return n._observables.unwrap(n._coachmarkProvider.getCurrentTeachingBubble())};n._hideToastNotifications=function(){var e=n.props.resources.consume(l.resourceKey.optional);e&&e.cleanup(!0)};n._onTeachingBubbleSeen=function(){n._isReminderFlowCoachmark()&&c.Engagement.logData({name:"ReminderFlowCoachmark.Rendered"})};n._isReminderFlowCoachmark=function(){var e=n.state.teachingBubble;if(!e)return!1;var t=e.campaign();return t&&t.campaignGuid===h.FLOW_REMIND_ME.campaignGuid};var r=t.resources;n._scope=new i.default;n._coachmarkProvider=r.consume(u.resourceKey.optional);n._observables=n._scope.attach(new(r.consume(s.observablesFactoryTypeResourceKey))({owner:n}));n.state={isCoachmarkVisible:!1,teachingBubble:n._getCurrentTeachingBubble()};return n}t.prototype.render=function(){var e=this.state,t=e.isCoachmarkVisible,i=e.teachingBubble;return r.createElement(a.ItemScopeCoachmarkCommand,n.__assign({isCoachmarkVisible:t,teachingBubbleCampaign:i&&i.campaign(),hideCoachmark:this._hideCoachmark,onCoachmarkAnimationOpen:this._hideToastNotifications,onDismissTeachingBubble:this._onDismissTeachingBubble,onTeachingBubbleSeen:this._onTeachingBubbleSeen},this.props))};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.componentDidMount=function(){var e=this;this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype._computeShowCoachmark=function(){var e=this,t=this._getCurrentTeachingBubble();if(t){var n=this._observables.unwrap(t.isVisible),r=t.campaign(),i=this.state.isCoachmarkVisible;if(this._isCampaignCompatible(r)){this._teachingBubbleProvider||(this._teachingBubbleProvider=this.props.resources.consume(o.teachingBubble.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(r,!1).then(function(r){e.setState({isCoachmarkVisible:r&&n,teachingBubble:t})})}else i&&this.setState({isCoachmarkVisible:!1})}};t.prototype._isCampaignCompatible=function(e){var t=this.props.coachmarkCampaign;return t===e||t===(e&&e.compatibleCampaign)};return t})(r.Component);t.CoachmarkCommand=f.withResources()(v);t.createCoachmarkCommand=function(e,i){var s=(function(i){n.__extends(s,i);function s(){var t=null!==i&&i.apply(this,arguments)||this;t._update=function(n,r){if(n.doesCoachmarkApply!==r.doesCoachmarkApply){var i=t.props.coachmarkProvider;n.doesCoachmarkApply?i.isVisible.peek()||i.setCampaign(e):i.isVisible.peek()&&e===i.currentCampaign.peek()&&i.hideCampaign()}};return t}s.prototype.componentDidMount=function(){this._update(this.props,{doesCoachmarkApply:!1})};s.prototype.render=function(){return r.createElement(t.CoachmarkCommand,n.__assign({},this.props))};s.prototype.componentDidUpdate=function(e){this._update(this.props,e)};return s})(r.PureComponent);return p.connectToItemCache(function(e){return{doesCoachmarkApply:i(e,{})}})(d.withCoachmarkProvider(e)(s))}});
define("NJe",["require","exports","lC","r","r","am","Zye","u3","c0"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._target=i.createRef();t._onMenuClicked=function(e,n){var r=t.props,i=r.hideCoachmark,s=r.onMenuClick;s&&s(e,n);i&&i()};t._onClick=function(e,n){var r,i=t.props,s=i.hideCoachmark,o=i.onClick;o&&(r=o(e,n));s&&s();return r};t._getCoachmark=function(){var e=t.props,n=e.isCoachmarkVisible,i=e.teachingBubbleCampaign,s=e.onCoachmarkAnimationOpen,u=e.onDismissTeachingBubble;if(n)return r.createElement(o.ItemScopeTeachingBubbleCoachmarkContainer,{target:t._target.current,teachingBubbleCampaign:i,onDismiss:u,onAnimationOpenStart:s,onTeachingBubbleSeen:t._onTeachingBubbleSeen})};t._onTeachingBubbleSeen=function(){var e=t.props.resources.consume(u.teachingBubble.optional);e&&e.markBubbleAsSeen(t.props.teachingBubbleCampaign);var n=t.props.onTeachingBubbleSeen;n&&n()};return t}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=void 0===t?s.CommandBarButton:t,o=n.__rest(e,["defaultRender"]),u=i;return r.createElement(r.Fragment,null,r.createElement("div",{ref:this._target},r.createElement(u,n.__assign({},o,{onClick:this._onClick,onMenuClick:this._onMenuClicked}))),this._getCoachmark())};return t})(r.PureComponent);t.ItemScopeCoachmarkCommand=a.withResources()(f)});
define("Zye",["require","exports","lC","r","hre","ku","ooe","eJ","Ih","xJ"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){a.Engagement.logData({name:t._getEngagementNamePrefix()+".Close",extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onDismiss;e&&e()};t._onTeachingBubbleSeen=function(){a.Engagement.logData({name:t._getEngagementNamePrefix()+".Rendered",extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onTeachingBubbleSeen;e&&e()};t._getCampaignGuid=function(){return t.props.teachingBubbleCampaign.campaignGuid};t._getEngagementNamePrefix=function(){return t.props.teachingBubbleCampaign.isCoachmark?"Coachmark":"TeachingBubble"};return t}t.prototype.render=function(){var e,t=this.props,n=t.teachingBubbleCampaign,a=t.onAnimationOpenStart,l=t.directionalHint;e=n.automateExperimentBodyCopy&&f.isAutomateExperimentOn()?n.automateExperimentBodyCopy:n.bodyCopy;return n.isCoachmark?r.createElement(o.Coachmark,{target:this.props.target,positioningContainerProps:{directionalHint:l||s.DirectionalHint.bottomCenter},styles:n.coachMarkStyles,onAnimationOpenStart:a,persistentBeak:n.persistentBeak,onAnimationOpenEnd:this._onTeachingBubbleSeen,preventFocusOnMount:!0},r.createElement(i.TeachingBubbleContent,{headline:n.title,illustrationImage:n.illustrationImage,styles:n.teachingBubbleStyles,calloutProps:{doNotLayer:!0},hasCloseIcon:n.isDismissable,closeButtonAriaLabel:u.default.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!n.disableCondensedHeadline},e)):r.createElement(i.TeachingBubble,{target:this.props.target,headline:n.title,hasCloseIcon:!0,closeButtonAriaLabel:u.default.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!0,calloutProps:{onLayerMounted:this._onTeachingBubbleSeen}},e)};return t})(r.PureComponent);t.ItemScopeTeachingBubbleCoachmarkContainer=l});
define("RJe",["require","exports","Pp","tne","c0"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withCoachmarkProvider=function(e){return function(t){return i.withResources()(n.injectInitialProps(function(t){return{coachmarkCampaign:e,coachmarkProvider:t.resources.consume(r.resourceKey.optional)}})(t))}}});
define("SJe",["require","exports","lC","Lqe","zM","li","Jb","Bb","tP","OS","Xo","iP","Ro","de","Cb","vb","QH","wJe","CJe","DJe","gqe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function E(e,t){var s;return n.__spreadArrays(m.isFeatureEnabled(m.QuickEditNewItem)?[g.getQuickEditNewItemCommand(e)]:[],[a.getExitQuickEditCommand(e)],m.isFeatureEnabled(m.QuickEditNewItem)?[r.EditItemCommand]:[],m.isFeatureEnabled(m.QuickEditUndoRedo)?[y.quickEditUndoCommand,b.quickEditRedoCommand]:[],[o.shareCommand,o.copyLinkCommand],t?[r.CommentItemCommand]:[],[i.exportListCommand],w.shouldDisplayIntegrateCommand(null===(s=e)||void 0===s?void 0:s.listBaseTemplate)?[]:[r.powerAppsCommand],m.isFeatureEnabled(m.QuickEditDeleteCommand)?[d.deleteCommand]:[])}function S(e){return n.__spreadArrays([a.getExitQuickEditCommand(e)],m.isFeatureEnabled(m.QuickEditUndoRedo)?[y.quickEditUndoCommand,b.quickEditRedoCommand]:[],[o.shareCommand,o.copyLinkCommand,f.syncCommand,u.downloadCommand,i.exportListCommand],m.isFeatureEnabled(m.QuickEditDeleteCommand)?[d.deleteCommand]:[],m.isFeatureEnabled(m.QuickEditNewItem)?[r.bulkEditDocumentPropertyCommand]:[])}var x=[r.alertMeCommand,r.manageAlertCommand],T=n.__spreadArrays(m.isFeatureEnabled(m.QuickEditNewItem)?[r.ViewDocumentPropertyCommand]:[],[r.versionHistoryCommand,r.alertMeCommand,r.manageAlertCommand]),N=[v.showProgressCommand,r.filtersPaneCommand],C=[v.showProgressCommand,r.filtersPaneCommand];t.getQuickEditCommands=function(e,t){var r,i,o=t.itemKey,u=t.listKey,a=t.pageContext,f=t.isDocumentLibrary,d=t.extraCommands,v=t.isCommentCommandEnabled,m=h.getCurrentItemSetKey(e),g=e.demandItemFacet(s.spItemKeyFacet,o),y=e.demandItemFacet(s.spFolderItemSetKeyFacet,m),b={webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl},w=s.spListViewsSetKeyFacet.serialize(b),k=e.demandItemFacet(l.childItemsFacet,w),L="";y&&y.viewKey&&(L=y.viewKey.viewId);!L&&a&&a.viewId&&(L=p.default.normalizeLower(a.viewId,!1));if(k&&g){var A=[];if((r=c.getViewsCommands(e,{viewKeys:k.itemKeys,webAbsoluteUrl:g.webAbsoluteUrl,listViewSetKey:b,itemSetKey:m,currentViewKey:s.spViewKeyFacet.serialize({viewId:L})}))&&r.subMenuProps&&r.subMenuProps.items){for(var O=r.subMenuProps.items,M=-1,_=0;_<O.length;_++){var D=O[_].automationId;if(D&&(0===D.indexOf("switchToFixedGridLayoutCommand")||0===D.indexOf("switchViewCommand_")||0===D.indexOf("saveCommand"))){M=_;break}}-1!==M&&(A=O.slice(M))}r=n.__assign(n.__assign({},r),{subMenuProps:n.__assign(n.__assign({},r.subMenuProps),{items:A})})}i=f?{commands:S(a),overflowCommands:T,farCommands:C}:{commands:E(a,v),overflowCommands:x,farCommands:N};d&&d.flowCommand&&(i.commands=n.__spreadArrays(i.commands,[d.flowCommand]));d&&d.integrateCommand&&(i.commands=n.__spreadArrays(i.commands,[d.integrateCommand]));d&&d.openCommand&&f&&(i.commands=n.__spreadArrays([d.openCommand],i.commands));r&&(i.farCommands=n.__spreadArrays([r],i.farCommands));d&&d.fullscreenCommand&&(i.farCommands=n.__spreadArrays(i.farCommands,[d.fullscreenCommand]));return i}});
define("wJe",["require","exports","lC","KM","cg","Re","a1","UJe","EJe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditNewItemCommand={key:i.newCommand.key,action:r.createListItemCommand.action,iconProps:i.newCommand.iconProps,name:i.newCommand.name};t.listLibraryNewButtonExperimentKS=!s.default.isActivated("6C189BBC-B1F3-47D6-996A-10CBFDF53714","7/21/2020","Enable List Library New Button Experiment");t.getQuickEditNewItemCommand=function(e){if(t.listLibraryNewButtonExperimentKS){var r=e&&o.getVariantAndLogExposure(90058,e);return 1===r?n.__assign(n.__assign({},t.quickEditNewItemCommand),{commandBarButtonAs:u.PrimaryNewButton}):2===r?n.__assign(n.__assign({},t.quickEditNewItemCommand),{commandBarButtonAs:a.AccentNewButton}):t.quickEditNewItemCommand}return t.quickEditNewItemCommand}});
define("UJe",["require","exports","lC","r","oc","us","LJe","AJe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PrimaryNewButton=function(e){var t=e.defaultRender,a=n.__rest(e,["defaultRender"]),f=i.getTheme();return t?r.createElement(t,n.__assign({},a,{className:s.css("spo--primaryNewButton",e.className),styles:i.concatStyleSets(o.getBaseStyles(),o.getPrimaryStyles({theme:f}),u.getIconStyles())})):null}});
define("LJe",["require","exports","kJe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getBaseStyles=function(){return{root:{padding:0,backgroundColor:"transparent",margin:"0px 8px",selectors:{".ms-Button-label":{fontWeight:600},".ms-Fabric--isFocusVisible &:focus::after":{left:3,top:9,bottom:9,right:3}}},flexContainer:{height:32,paddingLeft:12,paddingRight:12,borderRadius:2},rootHovered:{backgroundColor:"transparent",selectors:{".ms-Button-menuIcon":{backgroundColor:"transparent"}}},rootPressed:{backgroundColor:"transparent"},rootExpanded:{backgroundColor:"transparent"},rootExpandedHovered:{backgroundColor:"transparent",selectors:{".ms-Button-menuIcon":{backgroundColor:"transparent"}}}}};t.getPrimaryStyles=function(e){var t=e.theme;return{root:{selectors:{".ms-Button-label":{color:t.semanticColors.primaryButtonText},".ms-Icon":{color:t.semanticColors.primaryButtonText},".ms-Fabric--isFocusVisible &:focus::after":{outline:"1px solid "+t.semanticColors.primaryButtonText}}},flexContainer:{backgroundColor:t.palette.themePrimary},rootHovered:{selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.themeDarkAlt},".ms-Icon":{color:t.semanticColors.primaryButtonText}}},rootPressed:{selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.themeDark},".ms-Icon":{color:t.semanticColors.primaryButtonText}}},rootExpanded:{selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.themePrimary},".ms-Button-icon":{color:t.semanticColors.primaryButtonText},".ms-Button-menuIcon":{color:t.semanticColors.primaryButtonText}}},rootExpandedHovered:{backgroundColor:"transparent",selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.themeDarkAlt},".ms-Button-icon":{color:t.semanticColors.primaryButtonText},".ms-Button-menuIcon":{color:t.semanticColors.primaryButtonText}}}}};t.getAccentStyles=function(e){var t=e.theme;return{root:{selectors:{".ms-Button-label":{color:t.palette.white},".ms-Icon":{color:t.palette.white},".ms-Fabric--isFocusVisible &:focus::after":{outline:"1px solid "+t.palette.white}}},flexContainer:{backgroundColor:t.palette.accent},rootHovered:{selectors:{".ms-Button-flexContainer":{backgroundColor:r(t.palette.accent,95)},".ms-Icon":{color:t.palette.white}}},rootPressed:{selectors:{".ms-Button-flexContainer":{backgroundColor:r(t.palette.accent,91)},".ms-Icon":{color:t.palette.white}}},rootExpanded:{selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.accent},".ms-Button-icon":{color:t.palette.white},".ms-Button-menuIcon":{color:t.palette.white,backgroundColor:"transparent"}}},rootExpandedHovered:{selectors:{".ms-Button-flexContainer":{backgroundColor:r(t.palette.accent,95)},".ms-Button-icon":{color:t.palette.white},".ms-Button-menuIcon":{color:t.palette.white}}}}};function r(e,t){var r=n.getColorFromString(e);if(void 0!==r){var i=n.hsv2hsl(r.h,r.s,r.v);i.l=i.l*t/100;return n.getColorFromRGBA(n.hsl2rgb(i.h,i.s,i.l)).str}return e}});
define("kJe",["require","exports","lC","MJe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("MJe",["require","exports","lC","jN","TJe","dB","cB","sB","oB","rB","iB","aB","nB","tB","eB","$N","ZN","XN","JN","YN","QN","qN","$N","KN","PJe","GN","zN"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t);n.__exportStar(d,t);n.__exportStar(v,t);n.__exportStar(m,t);n.__exportStar(g,t);n.__exportStar(y,t);n.__exportStar(b,t);n.__exportStar(w,t);n.__exportStar(E,t);n.__exportStar(S,t);n.__exportStar(x,t);n.__exportStar(T,t);n.__exportStar(N,t);n.__exportStar(C,t)});
define("TJe",["require","exports","dB","us","oB","ZN","eB","aB"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,f=[.027,.043,.082,.145,.184,.216,.349,.537],l=[.537,.45,.349,.216,.184,.145,.082,.043],c=[.537,.349,.216,.184,.145,.082,.043,.027],h=[.537,.45,.349,.216,.184,.145,.082,.043],p=[.88,.77,.66,.55,.44,.33,.22,.11],d=[.11,.22,.33,.44,.55,.66,.77,.88],v=[.96,.84,.7,.4,.12],m=[.1,.24,.44];(function(e){e[e.Unshaded=0]="Unshaded";e[e.Shade1=1]="Shade1";e[e.Shade2=2]="Shade2";e[e.Shade3=3]="Shade3";e[e.Shade4=4]="Shade4";e[e.Shade5=5]="Shade5";e[e.Shade6=6]="Shade6";e[e.Shade7=7]="Shade7";e[e.Shade8=8]="Shade8"})(a=t.Shade||(t.Shade={}));function g(e){return"number"==typeof e&&e>=a.Unshaded&&e<=a.Shade8}t.isValidShade=g;function y(e,t){return{h:e.h,s:e.s,v:i.clamp(e.v-e.v*t,100,0)}}function b(e,t){return{h:e.h,s:i.clamp(e.s-e.s*t,100,0),v:i.clamp(e.v+(100-e.v)*t,100,0)}}t.isDark=function(e){return o.hsv2hsl(e.h,e.s,e.v).l<50};t.getShade=function(e,t,i){void 0===i&&(i=!1);if(!e)return null;if(t===a.Unshaded||!g(t))return e;var f=o.hsv2hsl(e.h,e.s,e.v),l={h:e.h,s:e.s,v:e.v},w=t-1,E=b,S=y;if(i){E=y;S=b}l=(function(e){return e.r===n.MAX_COLOR_RGB&&e.g===n.MAX_COLOR_RGB&&e.b===n.MAX_COLOR_RGB})(e)?y(l,c[w]):(function(e){return 0===e.r&&0===e.g&&0===e.b})(e)?b(l,h[w]):f.l/100>.8?S(l,d[w]):f.l/100<.2?E(l,p[w]):w<v.length?E(l,v[w]):S(l,m[w-v.length]);return s.getColorFromRGBA(r.assign(u.hsv2rgb(l.h,l.s,l.v),{a:e.a}))};t.getBackgroundShade=function(e,t,n){void 0===n&&(n=!1);if(!e)return null;if(t===a.Unshaded||!g(t))return e;var i={h:e.h,s:e.s,v:e.v},o=t-1;i=n?b(i,l[h.length-1-o]):y(i,f[o]);return s.getColorFromRGBA(r.assign(u.hsv2rgb(i.h,i.s,i.v),{a:e.a}))};t.getContrastRatio=function(e,t){function r(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}var i=.2126*r(e.r/n.MAX_COLOR_RGB)+.7152*r(e.g/n.MAX_COLOR_RGB)+.0722*r(e.b/n.MAX_COLOR_RGB);i+=.05;var s=.2126*r(t.r/n.MAX_COLOR_RGB)+.7152*r(t.g/n.MAX_COLOR_RGB)+.0722*r(t.b/n.MAX_COLOR_RGB);return i/(s+=.05)>1?i/s:s/i}});
define("PJe",["require","exports","lC","WN","dB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateT=function(e,t){var s=i.MAX_COLOR_ALPHA-t;return n.__assign(n.__assign({},e),{t:t,a:s,str:r._rgbaOrHexString(e.r,e.g,e.b,s,e.hex)})}});
define("AJe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getIconStyles=function(){return{root:{selectors:{".ms-Icon":{fontWeight:600},".ms-Button-icon":{width:14,height:14,fontSize:14,lineHeight:14},".ms-Button-menuIcon":{marginTop:1}}}}}});
define("EJe",["require","exports","lC","r","oc","us","LJe","AJe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AccentNewButton=function(e){var t=e.defaultRender,a=n.__rest(e,["defaultRender"]),f=i.getTheme();return t?r.createElement(t,n.__assign({},a,{className:s.css("spo--accentNewButton",e.className),styles:i.concatStyleSets(o.getBaseStyles(),o.getAccentStyles({theme:f}),u.getIconStyles())})):null}});
define("CJe",["require","exports","r","IJe","wy","OJe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditUndoCommand={key:s.quickEditUndoCommandKey,automationId:"quickEditUndoCommand",name:i.default.quickEditUndo,iconProps:{iconName:"Undo"},isPermanent:!0,action:n.createElement(r.QuickEditUndoRedoAction,{undoRedoActionType:"undo"})}});
define("IJe",["require","exports","lC","r","C1","Es","ks","_s","Go","y6","xA","Qn","IA","g6","Xy"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={ODB:1024},m=function(e){var t=e.undoRedoActionType,i=e.dispatch,s=e.isAvailable,u=r.useState(0),a=u[0],f=u[1],p=r.useState(0),d=p[0],v=p[1],m=r.useRef(new c.EventGroup({})),g=s&&("undo"===t&&a>0||"redo"===t&&d>0);r.useEffect(function(){var e=i(l.getSharePointDataEventSource);m.current.on(e,h.SPGridEvents.undoRealCmdCountChangeEventName,function(e){f(e.undoRealCmdCount)});m.current.on(e,h.SPGridEvents.redoRealCmdCountChangeEventName,function(e){v(e.redoRealCmdCount)});return function(){m.current.dispose()}},[]);return r.createElement(o.Action,n.__assign({},e,{isAvailable:g}))},g=i.createItemCacheComponent(function(e,t){var i=t.itemKey,o=t.undoRedoActionType,u="undo"===o,g=d.getPageContextFromItemCache(e,i),y=p.isFeatureEnabled(e,{feature:v,pageContext:g});if(y){y=a.getCurrentLayout(e)===f.quickEditLayoutType}var b=e.dispatch;return r.createElement(m,n.__assign({undoRedoActionType:o,dispatch:b,isAvailable:y,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){e=b(l.getSharePointDataEventSource);c.EventGroup.raise(e,u?h.SPGridEvents.undoChangeEventName:h.SPGridEvents.redoChangeEventName);return[2]})})}},s.getItemActionEngagement(e,{itemKey:i,engagement:{name:u?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))});t.QuickEditUndoRedoAction=u.withCurrentItemSet()(g)});
define("OJe",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditUndoCommandKey=n.getNextId("quickEditUndo")});
define("DJe",["require","exports","r","wy","xJe","IJe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditRedoCommand={key:i.quickEditRedoCommandKey,automationId:"quickEditRedoCommand",name:r.default.quickEditRedo,iconProps:{iconName:"Redo"},action:n.createElement(s.QuickEditUndoRedoAction,{undoRedoActionType:"redo"})}});
define("xJe",["require","exports","si"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditRedoCommandKey=n.getNextId("quickEditRedo")});
define("Uy",["require","exports","r","ii","li","sf","Xo","Rs","Ny","Ry","Fy","si","Ro"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.oneDriveSortCommandKey=c.getNextId("oneDriveSortCommand");t.buildSortCommand=function(e,c){var p=c.itemKey,d=[],v=h.getCurrentItemSetKey(e),m=e.demandItemFacet(i.spFolderItemSetKeyFacet,v);if(v&&m){var g=e.demandItemFacet(o.sortFacet,p),y=g&&e.demandItemFacet(i.spListFieldKeyFacet,g.columnKey),b=y&&y.internalName||m.sortFieldKey||"",w=g?g.isAscending:m.sortAscending||!0,E=e.demandItemFacet(o.schemaFacet,v),S=E&&E.columnKeys;if(S)for(var x=0,T=S;x<T.length;x++){var N=T[x],C=e.demandItem({internalName:r.internalNameFacet,displayName:u.displayNameFacet,isSortable:a.isSortableFacet},N),k=C.internalName,L=C.displayName;C.isSortable&&k&&d.push({key:"sort"+N,automationId:"sort-"+k,name:L,role:"menuitemradio",action:n.createElement(l.SortAction,{itemSetKey:v,sortFieldKey:k,isAscending:w})})}d.push({name:"-",key:"divider_1",itemType:s.ContextualMenuItemType.Divider});d.push({key:"sortAsc",automationId:"sortAsc",role:"menuitemradio",name:f.default.SortAscending,title:f.default.SortAcendingCommandTooltip,action:n.createElement(l.SortAction,{itemSetKey:v,sortFieldKey:b,isAscending:!0})});d.push({key:"sortDesc",automationId:"sortDesc",role:"menuitemradio",name:f.default.SortDescending,title:f.default.SortDescendingCommandTooltip,action:n.createElement(l.SortAction,{itemSetKey:v,sortFieldKey:b,isAscending:!1})})}return{key:t.oneDriveSortCommandKey,automationId:"sortCommand",name:f.default.Sort,title:f.default.SortCommandTooltip,iconProps:{iconName:"SortLines"},subMenuProps:{items:d}}}});
define("vJe",["require","exports","r","si","pb","yJe","W0","Re"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u.default.isActivated("b58a6d2d-20a9-4cf2-be8f-cd6c5a1cdd3b","7/14/2020","localize Scheduling string");t.scheduleCommand={key:new r.Facet("SchedulingCommand").id,automationId:"schedulingCommand",name:a?"Scheduling":o.default.Scheduling,action:n.createElement(i.HideWithSelection,null,n.createElement(s.SchedulingAction,null)),iconProps:{iconName:"DateTime2"}}});
define("yJe",["require","exports","lC","r","Ps","ks","YV","tv","c0","S3","P3","Re"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["XWe"],t,n)})];case 1:return[2,t.sent().SchedulingComponent]}})})}),p=c.default.isActivated("ffb3f710-f091-499b-880a-4dc902d3404b","4/27/2020","hide scheduling option on subwebs");t.SchedulingAction=function(){var e=a.useResourceScope(),t=e.consume(f.pageContext),n=t&&t.listBaseTemplate===o.ListTemplateType.webPageLibrary&&l.PermissionMask.hasPermission(t.webPermMasks,l.PermissionMask.manageWeb)&&(p||(function(e){return e.siteAbsoluteUrl===e.webAbsoluteUrl})(t)),u=i.renderComponentOnExecute(function(n){var i=n.resolve;n.reject;return r.createElement(h,{pageContext:t,resources:e,resolve:i})});return r.createElement(s.Action,{isAvailable:n,onExecute:u})}});
define("gJe",["require","exports","lC","Lqe","CD","o4","Yo"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharedNavigationCommands=function(e,t){var u=e.demandItemFacet(s.sharedByMeRootItemKeyFacet,t),a=e.demandItemFacet(i.sharedWithMeRootItemKeyFacet,t);if(!u&&!a)return[];var f=n.__assign(n.__assign({},r.NavigateToSharedByMeCommand),{className:u?"is-pivot is-current-view":"is-pivot"}),l=n.__assign(n.__assign({},r.NavigateToSharedWithMeCommand),{className:a?"is-pivot is-current-view":"is-pivot"}),c=o.getSelectedItemKeys(e);return c&&0!==c.length?[]:[l,f]}});
define("hJe",["require","exports","Se","_S","SL","og","bJe","Re","PM"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=!u.default.isActivated(o.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands");function l(e,t){var s=new n.SimpleUri(t).authority,o=r.driveAppsKeyFacet.serialize({endpoint:s});return i.getFileHandlerCommands(e,{itemKey:o})}t.getExtendedCommandsWithFileHandlers=function(e,t,n){return(function(e,t){return e.map(function(e){return e.key===s.openCommand.key?o.getOpenFileCommandWithHandler(t,f):e})})(n,l(e,t))};t.extendContextMenuOpenFileCommand=function(e,t,n){var r=n.key,s=l(e,t);if(r===a.openFileCommand.key){var o=s&&s.open||[];o.length>0&&a.openFileCommandForContextMenu.subMenuProps&&(a.openFileCommandForContextMenu.subMenuProps.items=i.mergeFileHandlerCommands(a.openFileCommandForContextMenu.subMenuProps.items,o,f));return a.openFileCommandForContextMenu}return n}});
define("bJe",["require","exports","YM"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOpenFileCommandWithHandler=n.getOpenFileCommandWithHandler;t.SHOW_FILEHANDLER_COMMANDS_FIRST=n.SHOW_FILEHANDLER_COMMANDS_FIRST});
define('SPListItemsScopeDeferred_IS_mini_css',["Ge","uC"],function(e){"use strict";e.loadStyles([{"rawString":".newDocumentCommandIcon_810ca8e5{height:16px;width:16px}.newDocumentCommandIcon_810ca8e5 img{line-height:normal;display:block}#obf-TPromptContainer:focus{outline:1px solid #605e5c}#obf-TFormRating{color:#333333}#obf-TFormComment{background-color:#fff}\n"},{"rawString":".iconContainer_8f3e4037{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.brandIcon_8f3e4037{position:relative;margin:0 4px;height:16px;width:16px}.brandIcon_8f3e4037 img{display:block}.menuItemBrandIcon_8f3e4037{position:relative;margin:0 4px;height:32px;width:16px}.menuItemIconContainer_8f3e4037{position:relative;margin:0 4px;height:36px;line-height:36px;width:14px}.logoFillIcon_8f3e4037,.logoIcon_8f3e4037{height:100%;position:absolute;left:0;right:0}.logoFillIcon_8f3e4037[data-icon-name='ExcelLogo16'],.logoIcon_8f3e4037[data-icon-name='ExcelLogo16']{color:"},{"theme":"excelIconColor","defaultValue":"#217346"},{"rawString":"}.logoFillIcon_8f3e4037[data-icon-name='OneNoteLogo16'],.logoIcon_8f3e4037[data-icon-name='OneNoteLogo16']{color:"},{"theme":"onenoteIconColor","defaultValue":"#5c2d91"},{"rawString":"}.logoFillIcon_8f3e4037[data-icon-name='PowerPointLogo16'],.logoIcon_8f3e4037[data-icon-name='PowerPointLogo16']{color:"},{"theme":"powerpointIconColor","defaultValue":"#d24726"},{"rawString":"}.logoFillIcon_8f3e4037[data-icon-name='WordLogo16'],.logoIcon_8f3e4037[data-icon-name='WordLogo16']{color:"},{"theme":"wordIconColor","defaultValue":"#2b579a"},{"rawString":"}.logoFillIcon_8f3e4037[data-icon-name='VisioLogo16'],.logoIcon_8f3e4037[data-icon-name='VisioLogo16']{color:"},{"theme":"visioIconColor","defaultValue":"#3854a2"},{"rawString":"}.logoFillIcon_8f3e4037{color:#ffffff}.contextualMenuItemLinkContent_8f3e4037{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.contextualMenuItemTextLabel_8f3e4037{margin:0 4px;vertical-align:middle;display:inline-block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}\n"},{"rawString":".needsAttentionIconOverlay_a23ec69d{position:relative}.needsAttentionIconOverlay_a23ec69d:after{content:'';position:absolute;top:-3px;height:8px;width:8px;border-radius:8px;background-color:#a80000}[dir='ltr'] .needsAttentionIconOverlay_a23ec69d:after{left:15px}[dir='rtl'] .needsAttentionIconOverlay_a23ec69d:after{right:15px}.needsAttentionIcon_a23ec69d{color:#a80000}\n"},{"rawString":".customActionCommandIcon_9e2eb146{width:16px;height:16px}\n"},{"rawString":".keyboardMapGroup_83c329c3{display:inline-block;width:50%;min-width:200px;font-size:12px;vertical-align:top}.keyboardMapTable_83c329c3{display:table;list-style:none;margin:0;padding:0}.keyboardMapRow_83c329c3{display:table-row}.keyboardMapRow_83c329c3 span{display:table-cell}.keyboardMapKey_83c329c3{color:#0078d4;min-width:55px}.keyboardMapVal_83c329c3{padding:4px 8px}\n"},{"rawString":".fileHandlerCommandIcon_1aaa825b{width:16px;height:16px}\n"},{"rawString":".customTile_bb9070dd.ms-Tile{-webkit-transform:none !important;transform:none !important;outline-offset:-2px}.customTile_bb9070dd.ms-Tile--isSelected{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":" !important}.customTile_bb9070dd.ms-Tile--uninvokable{background-color:transparent !important}.customTile_bb9070dd.ms-Tile--uninvokable .ms-Tile-link{pointer-events:auto}.customTile_bb9070dd.ms-Tile--uninvokable .ms-Tile-check{height:auto !important;width:auto !important;right:5px;top:5px;padding:8px 8px 14px 14px}[dir='rtl'] .customTile_bb9070dd.ms-Tile--uninvokable .ms-Tile-check{padding:8px 14px 14px 8px}.customTile_bb9070dd.ms-Tile--uninvokable:hover{background-color:transparent !important}.customTile_bb9070dd.ms-Tile--uninvokable:hover .sp-card-borderHighlight{border:1px solid #c8c6c4;border-radius:4px;-webkit-box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important;box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important}.customTile_bb9070dd.ms-Tile--isSelected .sp-card-borderHighlight{border:1px solid #c8c6c4;border-radius:4px;-webkit-box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important;box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important}.customTile_bb9070dd .sp-field-customFormatter{pointer-events:auto}.customTile_bb9070dd .customTileFocusZone_bb9070dd{width:100%;height:100%}\n"},{"rawString":".listCell_09efe3dd{display:block;margin:0;border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.listPage_09efe3dd{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.cell_09efe3dd{display:block;position:relative}.cellContent_09efe3dd{position:absolute;top:0;left:0;bottom:0;right:0}.cellFirstInRow_09efe3dd{display:block}.sizer_09efe3dd{display:block;visibility:hidden}.header_09efe3dd{display:block}.grid_09efe3dd{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-line-pack:start;align-content:flex-start}.row_09efe3dd{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%}.row_09efe3dd.headerRow_09efe3dd{display:block}.shimmeredList_09efe3dd::after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(30%, transparent), color-stop(65%, "},{"theme":"whiteTranslucent40","defaultValue":"rgba(255,255,255,.4)"},{"rawString":"), to("},{"theme":"white","defaultValue":"#fff"},{"rawString":"));background-image:linear-gradient(to bottom, transparent 30%, "},{"theme":"whiteTranslucent40","defaultValue":"rgba(255,255,255,.4)"},{"rawString":" 65%, "},{"theme":"white","defaultValue":"#fff"},{"rawString":" 100%)}.none_09efe3dd{display:block}"},{"rawString":".tile_43a46e1f{display:block;position:relative;padding-bottom:8px}[dir='ltr'] .tile_43a46e1f{padding-right:40px}[dir='rtl'] .tile_43a46e1f{padding-left:40px}.tile_43a46e1f.hasIcon_43a46e1f{min-height:60px}[dir='ltr'] .tile_43a46e1f.hasIcon_43a46e1f{padding-left:56px}[dir='rtl'] .tile_43a46e1f.hasIcon_43a46e1f{padding-right:56px}.title_43a46e1f{display:inline;white-space:pre-line}.icon_43a46e1f{position:absolute;width:48px;display:block}[dir='ltr'] .icon_43a46e1f{left:0}[dir='rtl'] .icon_43a46e1f{right:0}.icon_43a46e1f.hasProgress_43a46e1f{top:8px}.progress_43a46e1f{display:block}.error_43a46e1f .progress_43a46e1f .ms-ProgressIndicator-itemProgress{display:none}.description_43a46e1f{font-size:12px}.error_43a46e1f .description_43a46e1f{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":"}.actions_43a46e1f{display:block;margin:8px 0 20px 0}.cancel_43a46e1f{position:absolute;display:block;top:0;width:32px;font-size:14px}[dir='ltr'] .cancel_43a46e1f{right:0}[dir='rtl'] .cancel_43a46e1f{left:0}\n"},{"rawString":".commandButton_acea5dc0{font-size:14px}\n"},{"rawString":".root_53a50724{overflow-x:hidden}.group_53a50724{margin:14px 0}.item_53a50724{margin:0}\n"},{"rawString":".callout_96e61042{min-width:315px}[dir='ltr'] .callout_96e61042{padding-left:12px}[dir='rtl'] .callout_96e61042{padding-right:12px}[dir='ltr'] .callout_96e61042{padding-right:4px}[dir='rtl'] .callout_96e61042{padding-left:4px}.progressList_96e61042{display:block}.viewAllButton_96e61042{display:block}.accessibleStatus_96e61042{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".nameDialogContent_31ed50fc{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.nameDialogContent_31ed50fc .ms-TextField{width:100%}.nameDialogContent_31ed50fc .ms-TextField .ms-TextField-errorMessage{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content}.nameDialogContentFileExtension_31ed50fc{padding:10px 5px 0;-ms-flex-item-align:start;align-self:flex-start}.nameDialogSpinner_31ed50fc{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"},{"rawString":".confirmTextLabel_e964ecde{font-weight:400}\n"},{"rawString":".created_08a27ca2{-webkit-animation:spin_08a27ca2 1100ms infinite linear;animation:spin_08a27ca2 1100ms infinite linear}@-webkit-keyframes spin_08a27ca2{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin_08a27ca2{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.closeButton_08a27ca2{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.accessibleStatus_08a27ca2{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".tile_ba4e71c8{display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-transition:-webkit-transform .1s linear;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tile_ba4e71c8::-moz-focus-inner{border:0}.tile_ba4e71c8{outline:transparent}.tile_ba4e71c8.selectable_ba4e71c8:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.tile_ba4e71c8.selectable_ba4e71c8:hover.selected_ba4e71c8{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.tile_ba4e71c8.selected_ba4e71c8{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.tile_ba4e71c8.selected_ba4e71c8.isFluentStyling_ba4e71c8 .name_ba4e71c8{font-weight:600}.ms-Fabric--isFocusVisible .tile_ba4e71c8:focus{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_ba4e71c8:focus.isFluentStyling_ba4e71c8{background-color:transparent}.ms-Fabric--isFocusVisible .tile_ba4e71c8:focus.selected_ba4e71c8{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_ba4e71c8:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_ba4e71c8:focus.selected_ba4e71c8{outline:1px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_ba4e71c8:focus.selected_ba4e71c8.isFluentStyling_ba4e71c8{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.tile_ba4e71c8.hasBackgroundFrame_ba4e71c8{-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,.05);box-shadow:0 1px 3px 1px rgba(1,1,0,.05)}.tile_ba4e71c8.hasBackgroundFrame_ba4e71c8.selectable_ba4e71c8:hover{outline:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_ba4e71c8.hasBackgroundFrame_ba4e71c8:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_ba4e71c8.hasBackgroundFrame_ba4e71c8:focus.selected_ba4e71c8{outline:1px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.tile_ba4e71c8.hasBackgroundFrame_ba4e71c8:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.tile_ba4e71c8.invokable_ba4e71c8:active{-webkit-transform:scale(.95);transform:scale(.95)}.label_ba4e71c8{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.description_ba4e71c8{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.link_ba4e71c8{border:none;background:0 0;position:absolute;padding:0;top:0;left:0;bottom:0;right:0;width:100%;text-decoration:none;color:inherit;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-ms-flex-line-pack:stretch;align-content:stretch;pointer-events:none}.link_ba4e71c8::-moz-focus-inner{border:0}.link_ba4e71c8{outline:transparent}.foreground_ba4e71c8{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;overflow:visible;max-width:100%;max-height:100%;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear}.tile_ba4e71c8.invokable_ba4e71c8 .foreground_ba4e71c8{pointer-events:auto;cursor:pointer}.foreground_ba4e71c8.foregroundHide_ba4e71c8{opacity:0}.hasForegroundFrame_ba4e71c8 .foreground_ba4e71c8{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,.05);box-shadow:0 1px 3px 1px rgba(1,1,0,.05);min-width:32px;min-height:32px}.hasForegroundFrame_ba4e71c8 .foreground_ba4e71c8:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.check_ba4e71c8{display:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;top:0;border:none;background:0 0;background-color:transparent;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;padding:6px}.check_ba4e71c8::-moz-focus-inner{border:0}.check_ba4e71c8{outline:transparent}.check_ba4e71c8{position:absolute}.ms-Fabric--isFocusVisible .check_ba4e71c8:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"focusBorder","defaultValue":"#605e5c"},{"rawString":"}html[dir=ltr] .check_ba4e71c8{right:0}html[dir=rtl] .check_ba4e71c8{left:0}.tile_ba4e71c8.uninvokable_ba4e71c8 .check_ba4e71c8{width:100%;height:100%}.tile_ba4e71c8.selectable_ba4e71c8 .check_ba4e71c8{display:-webkit-box;display:-ms-flexbox;display:flex}.tile_ba4e71c8.selected_ba4e71c8 .check_ba4e71c8,.tile_ba4e71c8.showCheck_ba4e71c8 .check_ba4e71c8,.tile_ba4e71c8:hover .check_ba4e71c8{opacity:1}.ms-Fabric--isFocusVisible .check_ba4e71c8:focus{opacity:1}.ms-Fabric--isFocusVisible .tile_ba4e71c8:focus .check_ba4e71c8{opacity:1}.background_ba4e71c8{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear}.tile_ba4e71c8.invokable_ba4e71c8 .background_ba4e71c8{cursor:pointer;pointer-events:auto}.background_ba4e71c8.backgroundHide_ba4e71c8{opacity:0}.aboveNameplate_ba4e71c8{-webkit-box-flex:1;-ms-flex:1;flex:1;position:relative;margin:16px 16px 0 16px}.content_ba4e71c8{position:absolute;top:0;left:0;bottom:0;right:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.hasForegroundFrame_ba4e71c8 .content_ba4e71c8{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.nameplate_ba4e71c8{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;position:relative;margin:auto 0 0 0;padding:12px 8px;text-align:center;z-index:0}.nameplate_ba4e71c8 .name_ba4e71c8{-webkit-transition:color .2s linear;transition:color .2s linear}.tile_ba4e71c8.invokable_ba4e71c8 .nameplate_ba4e71c8 .name_ba4e71c8{pointer-events:auto;cursor:pointer}.link_ba4e71c8:hover .nameplate_ba4e71c8 .name_ba4e71c8{text-decoration:underline}.isFluentStyling_ba4e71c8 .link_ba4e71c8:hover .nameplate_ba4e71c8 .name_ba4e71c8{text-decoration:none}.nameplate_ba4e71c8 .activity_ba4e71c8{-webkit-transition:color .2s linear;transition:color .2s linear}.tile_ba4e71c8.hasBackgroundFrame_ba4e71c8 .nameplate_ba4e71c8{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:12px 10px}.signal_ba4e71c8{display:inline-block}html[dir=ltr] .signal_ba4e71c8.storageSignal_ba4e71c8{margin-left:4px}html[dir=rtl] .signal_ba4e71c8.storageSignal_ba4e71c8{margin-right:4px}html[dir=ltr] .signal_ba4e71c8.socialSignal_ba4e71c8{margin-right:4px}html[dir=rtl] .signal_ba4e71c8.socialSignal_ba4e71c8{margin-left:4px}html[dir=ltr] .signal_ba4e71c8.lifecycleSignal_ba4e71c8{margin-right:4px}html[dir=rtl] .signal_ba4e71c8.lifecycleSignal_ba4e71c8{margin-left:4px}.name_ba4e71c8{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}html[dir=ltr] .name_ba4e71c8{margin-left:-8px}html[dir=rtl] .name_ba4e71c8{margin-right:-8px}html[dir=ltr] .name_ba4e71c8{padding-left:8px}html[dir=rtl] .name_ba4e71c8{padding-right:8px}.isLarge_ba4e71c8 .name_ba4e71c8,.name_ba4e71c8{font-size:14px;height:30px;margin-top:-7px;margin-bottom:-8px}.isSmall_ba4e71c8 .name_ba4e71c8{font-size:12px;height:24px;margin-top:-5px;margin-bottom:-7px}.activity_ba4e71c8{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;height:24px;margin-bottom:-4px}html[dir=ltr] .activity_ba4e71c8{margin-left:-8px}html[dir=rtl] .activity_ba4e71c8{margin-right:-8px}html[dir=ltr] .activity_ba4e71c8{padding-left:8px}html[dir=rtl] .activity_ba4e71c8{padding-right:8px}.hasBackgroundFrame_ba4e71c8 .name_ba4e71c8{display:block}html[dir=ltr] .hasBackgroundFrame_ba4e71c8 .name_ba4e71c8{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left}html[dir=rtl] .hasBackgroundFrame_ba4e71c8 .name_ba4e71c8{-webkit-box-pack:right;-ms-flex-pack:right;justify-content:right}.hasBackgroundFrame_ba4e71c8 .name_ba4e71c8,.isLarge_ba4e71c8 .isSmall_ba4e71c8 .hasBackgroundFrame_ba4e71c8 .name_ba4e71c8{font-size:14px;height:auto;padding-top:6px;margin-top:0;margin-bottom:0;line-height:22px}.hasBackgroundFrame_ba4e71c8 .activity_ba4e71c8{font-size:12px;display:block;height:auto;margin-top:0;margin-bottom:0;line-height:20px}html[dir=ltr] .hasBackgroundFrame_ba4e71c8 .activity_ba4e71c8{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left;text-align:left}html[dir=rtl] .hasBackgroundFrame_ba4e71c8 .activity_ba4e71c8{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left;text-align:left}.hasBackground_ba4e71c8 .nameplate_ba4e71c8:before{position:absolute;content:'';display:block;top:-4px;bottom:0;left:0;right:0;background-image:-webkit-gradient(linear,left bottom,left top,from(rgba(0,0,0,.65)),color-stop(55%,rgba(0,0,0,.5525)),color-stop(80%,rgba(0,0,0,.195)),to(rgba(0,0,0,0)));background-image:linear-gradient(to top,rgba(0,0,0,.65) 0,rgba(0,0,0,.5525) 55%,rgba(0,0,0,.195) 80%,rgba(0,0,0,0) 100%);z-index:-1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear;opacity:0}.hasBackground_ba4e71c8 .onlyOnHover_ba4e71c8 .name_ba4e71c8{opacity:0;-webkit-transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:transform .25s ease-out,opacity .2s linear,color .2s linear;transition:transform .25s ease-out,opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;-webkit-transform:translateY(1rem);transform:translateY(1rem)}.hasBackground_ba4e71c8 .onlyOnHover_ba4e71c8 .activity_ba4e71c8{opacity:0;-webkit-transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:transform .25s ease-out,opacity .2s linear,color .2s linear;transition:transform .25s ease-out,opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;-webkit-transform:translateY(1rem);transform:translateY(1rem)}.hasBackground_ba4e71c8.selected_ba4e71c8 .name_ba4e71c8.onlyOnHover_ba4e71c8,.hasBackground_ba4e71c8:hover .name_ba4e71c8.onlyOnHover_ba4e71c8{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}.hasBackground_ba4e71c8.selected_ba4e71c8 .activity_ba4e71c8.onlyOnHover_ba4e71c8,.hasBackground_ba4e71c8:hover .activity_ba4e71c8.onlyOnHover_ba4e71c8{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}.hasBackground_ba4e71c8.showBackground_ba4e71c8.selected_ba4e71c8 .onlyOnHover_ba4e71c8.nameplate_ba4e71c8:before,.hasBackground_ba4e71c8.showBackground_ba4e71c8:hover .onlyOnHover_ba4e71c8.nameplate_ba4e71c8:before{opacity:1}.hasBackground_ba4e71c8.showBackground_ba4e71c8 .nameplate_ba4e71c8:not(.onlyOnHover_ba4e71c8):before{opacity:1}.hasBackground_ba4e71c8.showBackground_ba4e71c8 .name_ba4e71c8{color:#fff;text-shadow:.5px .5px 2px rgba(0,0,0,.55)}.hasBackground_ba4e71c8.showBackground_ba4e71c8 .activity_ba4e71c8{color:#fff;text-shadow:.5px .5px 2px rgba(0,0,0,.55)}"},{"rawString":".root_637efddd{line-height:1;width:18px;height:18px;vertical-align:top;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_637efddd:before{content:'';position:absolute;left:1px;right:1px;bottom:1px;top:1px;border-radius:50%;opacity:1;background:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":"}.root_637efddd.rootIsChecked_637efddd:before{background:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";opacity:1}@media screen and (-ms-high-contrast:active){.root_637efddd.rootIsChecked_637efddd:before{background:Window}}.root_637efddd .check_637efddd{opacity:0}.checkHost_637efddd:focus .root_637efddd .check_637efddd,.checkHost_637efddd:hover .root_637efddd .check_637efddd,.root_637efddd.rootIsChecked_637efddd .check_637efddd,.root_637efddd:focus .check_637efddd,.root_637efddd:hover .check_637efddd{opacity:1}.check_637efddd,.circle_637efddd{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;text-align:center;vertical-align:middle}.circle_637efddd{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}@media screen and (-ms-high-contrast:active){.circle_637efddd{color:WindowText}}.rootIsChecked_637efddd .circle_637efddd{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.check_637efddd{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:16px;left:.5px}@media screen and (-ms-high-contrast:active){.check_637efddd{-ms-high-contrast-adjust:none}}.rootIsChecked_637efddd .check_637efddd{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-weight:900}@media screen and (-ms-high-contrast:active){.rootIsChecked_637efddd .check_637efddd{border:none;color:WindowText}}"},{"rawString":".root_0ac1db22{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;vertical-align:bottom;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.root_0ac1db22,.root_0ac1db22.isSmall_0ac1db22{width:72px;height:52px}.root_0ac1db22.isLinked_0ac1db22 .front_0ac1db22,.root_0ac1db22.isSmall_0ac1db22.isLinked_0ac1db22 .front_0ac1db22{top:6px;left:-5px}.root_0ac1db22.isLarge_0ac1db22{width:112px;height:80px}.root_0ac1db22.isLarge_0ac1db22.isLinked_0ac1db22 .front_0ac1db22{top:10px;left:-4px}.front_0ac1db22{display:block;position:absolute;left:-3px;right:-3px;bottom:-4px}.back_0ac1db22{display:block;position:absolute;left:-3px;right:-3px;bottom:-4px}.content_0ac1db22{position:absolute;left:4px;right:4px;bottom:4px;top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear}.hideContent_0ac1db22 .content_0ac1db22{opacity:0}.isFluent_0ac1db22 .content_0ac1db22{top:12px}.frame_0ac1db22{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;overflow:hidden;max-width:100%;max-height:100%;-webkit-box-shadow:0 1px 3px 2px rgba(1,1,0,.06);box-shadow:0 1px 3px 2px rgba(1,1,0,.06);background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";min-width:32px;min-height:32px}.metadata_0ac1db22{display:block;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:400;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";position:relative}html[dir=ltr] .metadata_0ac1db22{margin-right:8px}html[dir=rtl] .metadata_0ac1db22{margin-left:8px}html[dir=ltr] .metadata_0ac1db22{text-align:right}html[dir=rtl] .metadata_0ac1db22{text-align:left}.isFluent_0ac1db22 .metadata_0ac1db22{color:#bf5712}html[dir=ltr] .isFluent_0ac1db22 .metadata_0ac1db22{text-align:left}html[dir=rtl] .isFluent_0ac1db22 .metadata_0ac1db22{text-align:right}.metadata_0ac1db22,.metadata_0ac1db22.isSmall_0ac1db22{font-size:12px;margin-bottom:1px}html[dir=ltr] .metadata_0ac1db22,html[dir=ltr] .metadata_0ac1db22.isSmall_0ac1db22{margin-left:4px}html[dir=rtl] .metadata_0ac1db22,html[dir=rtl] .metadata_0ac1db22.isSmall_0ac1db22{margin-right:4px}.isLarge_0ac1db22 .metadata_0ac1db22{font-size:14px;margin-bottom:4px}html[dir=ltr] .isLarge_0ac1db22 .metadata_0ac1db22{margin-left:8px}html[dir=rtl] .isLarge_0ac1db22 .metadata_0ac1db22{margin-right:8px}.signal_0ac1db22{display:block;position:relative;margin-bottom:8px}html[dir=ltr] .signal_0ac1db22{margin-left:8px}html[dir=rtl] .signal_0ac1db22{margin-right:8px}html[dir=ltr] .signal_0ac1db22{margin-right:4px}html[dir=rtl] .signal_0ac1db22{margin-left:4px}.isFluent_0ac1db22 .signal_0ac1db22 :first-child{color:#bf5712}.signal_0ac1db22,.signal_0ac1db22.isSmall_0ac1db22{font-size:16px;margin-bottom:1px}.isLarge_0ac1db22 .signal_0ac1db22{font-size:16px;margin-bottom:4px}html[dir=ltr] .isLarge_0ac1db22 .signal_0ac1db22{margin-right:7px}html[dir=rtl] .isLarge_0ac1db22 .signal_0ac1db22{margin-left:7px}"},{"rawString":".tile_d5d0cfea.hideFileTypeIcon_d5d0cfea .fileTypeIcon_d5d0cfea,.tile_d5d0cfea.hideFileTypeIcon_d5d0cfea .tileAppIcon_d5d0cfea{display:none}.tile_d5d0cfea.hideThumbnail_d5d0cfea .thumbnail_d5d0cfea{display:none}.defaultTile_d5d0cfea .ms-Tile-foreground>*{pointer-events:none}.defaultTile_d5d0cfea .ms-Tile-background>*{pointer-events:none}.folderCover_d5d0cfea{margin:3px}.thumbnail_d5d0cfea{display:inline-block}.thumbnailNotResolved_d5d0cfea{display:none}.fileTypeIcon_d5d0cfea{margin:16px}.name_d5d0cfea{display:inline;max-width:100%}.blankFolderCover_d5d0cfea{background:"},{"theme":"itemTileBlankFolderCoverColor","defaultValue":"#fff"},{"rawString":";display:inline-block}.tileAppIcon_d5d0cfea{position:absolute;bottom:0;margin:4px}[dir='ltr'] .tileAppIcon_d5d0cfea{left:0px}[dir='rtl'] .tileAppIcon_d5d0cfea{right:0px}\n"},{"rawString":".image_0424b027{display:block}\n"},{"rawString":".root_342da9bd{display:block}.showAllCell_342da9bd{position:'relative';padding:'10px 84px';cursor:'pointer'}\n"},{"rawString":".dragPreviewRoot_c437410f{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);pointer-events:none}.dragPreviewIcon_c437410f{margin:5px;height:20px;width:20px}[dir='ltr'] .dragPreviewText_c437410f{margin-right:5px}[dir='rtl'] .dragPreviewText_c437410f{margin-left:5px}\n"},{"rawString":".commandLink_3eae80fd{height:32px;line-height:32px}html[dir='ltr'] .commandLink_3eae80fd{margin-right:15px}html[dir='rtl'] .commandLink_3eae80fd{margin-left:15px}.commandLink_3eae80fd i{color:"},{"theme":"primaryText","defaultValue":"#333333"},{"rawString":"}label.link_3eae80fd,button.link_3eae80fd{display:inline;line-height:32px;height:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir='ltr'] label.link_3eae80fd,html[dir='ltr'] button.link_3eae80fd{margin-left:-7px}html[dir='rtl'] label.link_3eae80fd,html[dir='rtl'] button.link_3eae80fd{margin-right:-7px}html[dir='ltr'] label.link_3eae80fd,html[dir='ltr'] button.link_3eae80fd{margin-right:15px}html[dir='rtl'] label.link_3eae80fd,html[dir='rtl'] button.link_3eae80fd{margin-left:15px}.pageUsageChartContainer_3eae80fd>.ms-AnalyticsChart{margin-top:0}.root_3eae80fd{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:12px}.socialBarList_3eae80fd{width:288px}.socialBarPanel_3eae80fd{top:50px}.socialBarPanelContent_3eae80fd{overflow-x:hidden;overflow-y:auto}.spSocialPanelPivotContent_3eae80fd{padding-top:15px}.socialBarPanelHeader_3eae80fd{-ms-flex-negative:0;flex-shrink:0;padding:0 25px}.socialBarPanelHeader_3eae80fd .socialBarPanelHeaderText_3eae80fd{font-size:"},{"theme":"xLargeFontSize","defaultValue":"20px"},{"rawString":";font-weight:300;line-height:48px;margin:0}.socialBarPanelPersona_3eae80fd{font-size:14px;padding:4px 0}.socialBarPanelPersonaDescription_3eae80fd{font-size:14px;padding:8px 0}.viewsIcon_3eae80fd{cursor:default;font-size:16px;height:32px;line-height:28px;text-align:center;width:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle}html[dir='ltr'] .viewsIcon_3eae80fd{margin-right:8px}html[dir='rtl'] .viewsIcon_3eae80fd{margin-left:8px}.analyticsStatsLink_3eae80fd{min-width:50px;font-size:14px;padding:0 8px 0 0}.analyticsStatsLink_3eae80fd .ms-Link{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.analyticsStatsLink_3eae80fd .ms-ActivityItem-activityTypeIcon{margin-top:0}html[dir='ltr'] .analyticsStatsLink_3eae80fd .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir='rtl'] .analyticsStatsLink_3eae80fd .ms-ActivityItem-activityTypeIcon{padding-left:5px}.analyticsStatsLink_3eae80fd .ms-ActivityItem-activityContent{-ms-flex-preferred-size:auto;flex-basis:auto;font-weight:400}html[dir='ltr'] .analyticsStatsLink_3eae80fd .ms-ActivityItem-activityContent{padding-left:0}html[dir='rtl'] .analyticsStatsLink_3eae80fd .ms-ActivityItem-activityContent{padding-right:0}.analyticsStatsLink_3eae80fd :hover{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}\n"},{"rawString":".itemCard_869933b0{background-color:"},{"theme":"menuBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,0.132),0 0.3px 0.9px 0 rgba(0,0,0,0.108);box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,0.132),0 0.3px 0.9px 0 rgba(0,0,0,0.108);border-radius:2px;min-width:216px;max-width:296px;position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;z-index:0;margin-left:8px;margin-right:8px}@media only screen and (max-width: 1023.99999px){.itemCard_869933b0{max-width:216px}}.itemCard_869933b0:focus .check_869933b0{opacity:1}.itemCard_869933b0:hover{cursor:pointer;border-color:#c8c8c8}.itemCard_869933b0:hover .commandButtonContainer_869933b0{margin-left:4px;margin-right:4px;margin-top:5px;margin-bottom:5px}.itemCard_869933b0:hover .commandButton_869933b0{display:block}[dir='ltr'] .itemCard_869933b0:hover .fileNameContainer_869933b0{margin-right:0}[dir='rtl'] .itemCard_869933b0:hover .fileNameContainer_869933b0{margin-left:0}.itemCard_869933b0:hover .check_869933b0{opacity:1}.previewContainer_869933b0{width:100%;background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";position:relative;overflow:hidden;padding-bottom:56.25%;z-index:-1}@media only screen and (max-width: 639.99999px){.previewContainer_869933b0{padding-bottom:50%}}.previewVertical_869933b0{position:absolute;top:0;width:64%;left:18%}.previewHorizontal_869933b0{position:absolute;top:0;width:100%;left:0}.thumbnailOverlay_869933b0{opacity:0.04;background:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.previewHidden_869933b0{position:absolute;display:none}.fileTypeIcon_869933b0{position:absolute;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);top:50%;left:50%}.check_869933b0{position:absolute;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;top:0;border:none;background:none;background-color:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;padding:6px;z-index:2}[dir='ltr'] .check_869933b0{right:0}[dir='rtl'] .check_869933b0{left:0}.check_869933b0 .itemCard_869933b0.uninvokable_869933b0{width:100%;height:100%}.itemCard_869933b0.selectable_869933b0 .check_869933b0{display:-webkit-box;display:-ms-flexbox;display:flex}.check_869933b0.unselected_869933b0{opacity:0}.check_869933b0.selected_869933b0{opacity:1}.itemCard_869933b0.selected_869933b0,.itemCard_869933b0:hover,.itemCard_869933b0:focus,.itemCard_869933b0.showCheck_869933b0{opacity:1}.appIcon_869933b0{position:absolute;bottom:0;margin:12px;width:24px;height:24px;z-index:2}.bottomSection_869933b0{height:42px;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}.bottomSectionWithIcon_869933b0{height:58px;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}.shimmerBottomText_869933b0{height:16px;width:100%;margin-left:12px;margin-right:12px}.shimmerBottomText_869933b0 .ms-Shimmer-shimmerWrapper{height:100%}.fileNameContainer_869933b0{max-height:100%;overflow:hidden;text-overflow:ellipsis;margin-left:12px;margin-right:12px;margin-top:10px;margin-bottom:12px;width:100%}.fileNameWithIconContainer_869933b0{max-height:100%;overflow:hidden;text-overflow:ellipsis;margin-top:10px;margin-bottom:12px;width:100%}[dir='ltr'] .fileNameWithIconContainer_869933b0{margin-left:16px}[dir='rtl'] .fileNameWithIconContainer_869933b0{margin-right:16px}[dir='ltr'] .fileNameWithIconContainer_869933b0{margin-right:22px}[dir='rtl'] .fileNameWithIconContainer_869933b0{margin-left:22px}.fileIcon_869933b0{position:relative;width:26px;min-width:26px;height:28px}[dir='ltr'] .fileIcon_869933b0{margin-left:15px}[dir='rtl'] .fileIcon_869933b0{margin-right:15px}.fileName_869933b0{max-height:100%;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px;font-weight:600}.fileName_869933b0:hover{text-decoration:underline}.commandButton_869933b0{display:none;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";height:20px}.commandButton_869933b0:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.menuTarget_869933b0{position:absolute;bottom:-4px}[dir='ltr'] .menuTarget_869933b0{right:0}[dir='rtl'] .menuTarget_869933b0{left:0}.bottomSectionWithActivity_869933b0{height:58px;display:block;position:relative;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}.bottomSectionNamePlate_869933b0{max-height:32px;display:-webkit-box;display:-ms-flexbox;display:flex}.fileNameContainerWithActivity_869933b0{max-height:100%;overflow:hidden;text-overflow:ellipsis;padding-left:12px;padding-right:12px;padding-top:10px;padding-bottom:2px;width:100%}.activityContainer_869933b0{max-height:26px;overflow:hidden;text-overflow:ellipsis;padding-left:12px;padding-right:12px;padding-bottom:10px}\n"},{"rawString":".IFrameDialog_2772e31d .ms-Dialog-main{width:100%;max-width:600px}.IFrameDialog_2772e31d iframe{border:none;width:100%}\n"},{"rawString":".syncDialog_ddec7b9b{-webkit-box-shadow:rgba(0,0,0,0.22) 0px 25.6px 57.6px;box-shadow:rgba(0,0,0,0.22) 0px 25.6px 57.6px;text-align:center}.syncDialogContent_ddec7b9b{margin:0 -8px;overflow-x:hidden}.syncDialogContent_ddec7b9b .syncImg_ddec7b9b{width:100%;max-width:100%;-webkit-transform:scale(1.2, 1.2);transform:scale(1.2, 1.2);margin-bottom:20px;margin-top:10px;height:278px}.copyLibraryId_ddec7b9b{height:10px;color:#0000ee;padding:9px 0;font-size:14px;font-weight:600}.pointerText_ddec7b9b{text-decoration:none}.footNote_ddec7b9b{font-size:12px}.syncTitle_ddec7b9b{font-weight:600;font-size:20px}.contentContainer_ddec7b9b{margin:10px 0px}.adminContentContainer_ddec7b9b{margin:2.5px -2.5px}.separator_ddec7b9b{margin:-5px}.errorContainer_ddec7b9b{padding:10px;color:#a80000;background-color:#fde7e9}.errorTitle_ddec7b9b{font-weight:600}\n"},{"rawString":".saveViewDialogTextField_88ee8f33{margin-bottom:8px}.saveViewDialogCheckbox_88ee8f33{min-height:36px}.saveViewDialogSpinner_88ee8f33{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"},{"rawString":".commentRoot_468682d8{margin-top:20px}.approveRejectDialogSpinner_468682d8{display:inline-block;padding-bottom:7px;vertical-align:bottom}.approveRejectDialogMessageBar_468682d8{margin-bottom:8px}.approveRejectDialogStatusLabel_468682d8{font-weight:600}\n"},{"rawString":".alert_c6721d8a{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}[dir='ltr'] .filterPanelClearAllButton_c6721d8a{margin-left:8px}[dir='rtl'] .filterPanelClearAllButton_c6721d8a{margin-right:8px}.filterPanelRoot_c6721d8a .ms-Panel-content{padding-bottom:0px}.filterPanelFooter_c6721d8a{display:-webkit-box;display:-ms-flexbox;display:flex}.filterPanelSuggestionsNone_c6721d8a{text-align:center;color:"},{"theme":"info","defaultValue":"#666666"},{"rawString":";font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";line-height:30px}.filterPanelSuggestionItem_c6721d8a{padding:4px 6px}.peoplePickerRoot_c6721d8a{margin-bottom:12px}.filterPickerRoot_c6721d8a{margin-bottom:8px}\n"},{"rawString":"html body .ms-fontSize-68{font-size:68px}html body .ms-fontSize-42{font-size:42px}html body .ms-fontSize-32{font-size:32px}html body .ms-fontSize-28{font-size:28px}html body .ms-fontSize-24{font-size:24px}html body .ms-fontSize-20{font-size:20px}html body .ms-fontSize-18{font-size:18px}html body .ms-fontSize-16{font-size:16px}html body .ms-fontSize-14{font-size:14px}html body .ms-fontSize-12{font-size:12px}html body .ms-fontSize-10{font-size:10px}html body .ms-fontWeight-regular{font-weight:400}html body .ms-fontWeight-semibold{font-weight:600}html body .ms-fontWeight-bold{font-weight:700}html body .ms-font-su{font-size:42px;font-weight:100}html body .ms-font-xxl{font-size:28px;font-weight:100}html body .ms-font-xl-plus{font-size:24px;font-weight:100}html body .ms-font-xl{font-size:21px;font-weight:100}html body .ms-font-l{font-size:17px;font-weight:300}html body .ms-font-m-plus{font-size:15px;font-weight:400}html body .ms-font-m{font-size:14px;font-weight:400}html body .ms-font-s-plus{font-size:13px;font-weight:400}html body .ms-font-s{font-size:12px;font-weight:400}html body .ms-font-xs{font-size:11px;font-weight:400}html body .ms-font-mi{font-size:10px;font-weight:600}html body .ms-fontWeight-light{font-weight:100}html body .ms-fontWeight-semilight{font-weight:300}html body .ms-fontSize-su{font-size:42px}html body .ms-fontSize-xxl{font-size:28px}html body .ms-fontSize-xlPlus{font-size:24px}html body .ms-fontSize-xl{font-size:21px}html body .ms-fontSize-l{font-size:17px}html body .ms-fontSize-mPlus{font-size:15px}html body .ms-fontSize-m{font-size:14px}html body .ms-fontSize-sPlus{font-size:13px}html body .ms-fontSize-s{font-size:12px}html body .ms-fontSize-xs{font-size:11px}html body .ms-fontSize-mi{font-size:10px}html body .ms-bgColor-communicationShade30,html body .ms-bgColor-communicationShade30--hover:hover{background-color:#004578}html body .ms-bgColor-communicationShade20,html body .ms-bgColor-communicationShade20--hover:hover{background-color:#005a9e}html body .ms-bgColor-communicationShade10,html body .ms-bgColor-communicationShade10--hover:hover{background-color:#106ebe}html body .ms-bgColor-communicationPrimary,html body .ms-bgColor-communicationPrimary--hover:hover{background-color:#0078d4}html body .ms-bgColor-communicationTint10,html body .ms-bgColor-communicationTint10--hover:hover{background-color:#2b88d8}html body .ms-bgColor-communicationTint20,html body .ms-bgColor-communicationTint20--hover:hover{background-color:#c7e0f4}html body .ms-bgColor-communicationTint30,html body .ms-bgColor-communicationTint30--hover:hover{background-color:#deecf9}html body .ms-bgColor-communicationTint40,html body .ms-bgColor-communicationTint40--hover:hover{background-color:#eff6fc}html body .ms-bgColor-black,html body .ms-bgColor-black--hover:hover{background-color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}html body .ms-bgColor-gray220,html body .ms-bgColor-gray220--hover:hover{background-color:#11100f}html body .ms-bgColor-gray210,html body .ms-bgColor-gray210--hover:hover{background-color:#161514}html body .ms-bgColor-gray200,html body .ms-bgColor-gray200--hover:hover{background-color:#1b1a19}html body .ms-bgColor-gray190,html body .ms-bgColor-gray190--hover:hover{background-color:#201f1e}html body .ms-bgColor-gray180,html body .ms-bgColor-gray180--hover:hover{background-color:#252423}html body .ms-bgColor-gray170,html body .ms-bgColor-gray170--hover:hover{background-color:#292827}html body .ms-bgColor-gray160,html body .ms-bgColor-gray160--hover:hover{background-color:#323130}html body .ms-bgColor-gray150,html body .ms-bgColor-gray150--hover:hover{background-color:#3b3a39}html body .ms-bgColor-gray140,html body .ms-bgColor-gray140--hover:hover{background-color:#484644}html body .ms-bgColor-gray130,html body .ms-bgColor-gray130--hover:hover{background-color:#605e5c}html body .ms-bgColor-gray120,html body .ms-bgColor-gray120--hover:hover{background-color:#797775}html body .ms-bgColor-gray110,html body .ms-bgColor-gray110--hover:hover{background-color:#8a8886}html body .ms-bgColor-gray100,html body .ms-bgColor-gray100--hover:hover{background-color:#979593}html body .ms-bgColor-gray90,html body .ms-bgColor-gray90--hover:hover{background-color:#a19f9d}html body .ms-bgColor-gray80,html body .ms-bgColor-gray80--hover:hover{background-color:#b3b0ad}html body .ms-bgColor-gray70,html body .ms-bgColor-gray70--hover:hover{background-color:#bebbb8}html body .ms-bgColor-gray60,html body .ms-bgColor-gray60--hover:hover{background-color:#c8c6c4}html body .ms-bgColor-gray50,html body .ms-bgColor-gray50--hover:hover{background-color:#d2d0ce}html body .ms-bgColor-gray40,html body .ms-bgColor-gray40--hover:hover{background-color:#e1dfdd}html body .ms-bgColor-gray30,html body .ms-bgColor-gray30--hover:hover{background-color:#edebe9}html body .ms-bgColor-gray20,html body .ms-bgColor-gray20--hover:hover{background-color:#f3f2f1}html body .ms-bgColor-gray10,html body .ms-bgColor-gray10--hover:hover{background-color:#faf9f8}html body .ms-bgColor-white,html body .ms-bgColor-white--hover:hover{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html body .ms-bgColor-sharedPinkRed10,html body .ms-bgColor-sharedPinkRed10--hover:hover{background-color:#750b1c}html body .ms-bgColor-sharedRed20,html body .ms-bgColor-sharedRed20--hover:hover{background-color:#a4262c}html body .ms-bgColor-sharedRed10,html body .ms-bgColor-sharedRed10--hover:hover{background-color:#d13438}html body .ms-bgColor-sharedRedOrange20,html body .ms-bgColor-sharedRedOrange20--hover:hover{background-color:#603d30}html body .ms-bgColor-sharedRedOrange10,html body .ms-bgColor-sharedRedOrange10--hover:hover{background-color:#da3b01}html body .ms-bgColor-sharedOrange30,html body .ms-bgColor-sharedOrange30--hover:hover{background-color:#8e562e}html body .ms-bgColor-sharedOrange20,html body .ms-bgColor-sharedOrange20--hover:hover{background-color:#ca5010}html body .ms-bgColor-sharedOrange10,html body .ms-bgColor-sharedOrange10--hover:hover{background-color:#fa4}html body .ms-bgColor-sharedYellow10,html body .ms-bgColor-sharedYellow10--hover:hover{background-color:#fce100}html body .ms-bgColor-sharedOrangeYellow20,html body .ms-bgColor-sharedOrangeYellow20--hover:hover{background-color:#986f0b}html body .ms-bgColor-sharedOrangeYellow10,html body .ms-bgColor-sharedOrangeYellow10--hover:hover{background-color:#c19c00}html body .ms-bgColor-sharedYellowGreen10,html body .ms-bgColor-sharedYellowGreen10--hover:hover{background-color:#8cbd18}html body .ms-bgColor-sharedGreen20,html body .ms-bgColor-sharedGreen20--hover:hover{background-color:#0b6a0b}html body .ms-bgColor-sharedGreen10,html body .ms-bgColor-sharedGreen10--hover:hover{background-color:#498205}html body .ms-bgColor-sharedGreenCyan10,html body .ms-bgColor-sharedGreenCyan10--hover:hover{background-color:#00ad56}html body .ms-bgColor-sharedCyan40,html body .ms-bgColor-sharedCyan40--hover:hover{background-color:#005e50}html body .ms-bgColor-sharedCyan30,html body .ms-bgColor-sharedCyan30--hover:hover{background-color:#005b70}html body .ms-bgColor-sharedCyan20,html body .ms-bgColor-sharedCyan20--hover:hover{background-color:#038387}html body .ms-bgColor-sharedCyan10,html body .ms-bgColor-sharedCyan10--hover:hover{background-color:#00b7c3}html body .ms-bgColor-sharedCyanBlue20,html body .ms-bgColor-sharedCyanBlue20--hover:hover{background-color:#004e8c}html body .ms-bgColor-sharedCyanBlue10,html body .ms-bgColor-sharedCyanBlue10--hover:hover{background-color:#0078d4}html body .ms-bgColor-sharedBlue10,html body .ms-bgColor-sharedBlue10--hover:hover{background-color:#4f6bed}html body .ms-bgColor-sharedBlueMagenta40,html body .ms-bgColor-sharedBlueMagenta40--hover:hover{background-color:#373277}html body .ms-bgColor-sharedBlueMagenta30,html body .ms-bgColor-sharedBlueMagenta30--hover:hover{background-color:#5c2e91}html body .ms-bgColor-sharedBlueMagenta20,html body .ms-bgColor-sharedBlueMagenta20--hover:hover{background-color:#8764b8}html body .ms-bgColor-sharedBlueMagenta10,html body .ms-bgColor-sharedBlueMagenta10--hover:hover{background-color:#8378de}html body .ms-bgColor-sharedMagenta20,html body .ms-bgColor-sharedMagenta20--hover:hover{background-color:#881798}html body .ms-bgColor-sharedMagenta10,html body .ms-bgColor-sharedMagenta10--hover:hover{background-color:#c239b3}html body .ms-bgColor-sharedMagentaPink20,html body .ms-bgColor-sharedMagentaPink20--hover:hover{background-color:#9b0062}html body .ms-bgColor-sharedMagentaPink10,html body .ms-bgColor-sharedMagentaPink10--hover:hover{background-color:#e3008c}html body .ms-bgColor-sharedGray40,html body .ms-bgColor-sharedGray40--hover:hover{background-color:#393939}html body .ms-bgColor-sharedGray30,html body .ms-bgColor-sharedGray30--hover:hover{background-color:#7a7574}html body .ms-bgColor-sharedGray20,html body .ms-bgColor-sharedGray20--hover:hover{background-color:#69797e}html body .ms-bgColor-sharedGray10,html body .ms-bgColor-sharedGray10--hover:hover{background-color:#a0aeb2}html body .ms-borderColor-communicationShade30,html body .ms-borderColor-communicationShade30--hover:hover{border-color:#004578}html body .ms-borderColor-communicationShade20,html body .ms-borderColor-communicationShade20--hover:hover{border-color:#005a9e}html body .ms-borderColor-communicationShade10,html body .ms-borderColor-communicationShade10--hover:hover{border-color:#106ebe}html body .ms-borderColor-communicationPrimary,html body .ms-borderColor-communicationPrimary--hover:hover{border-color:#0078d4}html body .ms-borderColor-communicationTint10,html body .ms-borderColor-communicationTint10--hover:hover{border-color:#2b88d8}html body .ms-borderColor-communicationTint20,html body .ms-borderColor-communicationTint20--hover:hover{border-color:#c7e0f4}html body .ms-borderColor-communicationTint30,html body .ms-borderColor-communicationTint30--hover:hover{border-color:#deecf9}html body .ms-borderColor-communicationTint40,html body .ms-borderColor-communicationTint40--hover:hover{border-color:#eff6fc}html body .ms-borderColor-black,html body .ms-borderColor-black--hover:hover{border-color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}html body .ms-borderColor-gray220,html body .ms-borderColor-gray220--hover:hover{border-color:#11100f}html body .ms-borderColor-gray210,html body .ms-borderColor-gray210--hover:hover{border-color:#161514}html body .ms-borderColor-gray200,html body .ms-borderColor-gray200--hover:hover{border-color:#1b1a19}html body .ms-borderColor-gray190,html body .ms-borderColor-gray190--hover:hover{border-color:#201f1e}html body .ms-borderColor-gray180,html body .ms-borderColor-gray180--hover:hover{border-color:#252423}html body .ms-borderColor-gray170,html body .ms-borderColor-gray170--hover:hover{border-color:#292827}html body .ms-borderColor-gray160,html body .ms-borderColor-gray160--hover:hover{border-color:#323130}html body .ms-borderColor-gray150,html body .ms-borderColor-gray150--hover:hover{border-color:#3b3a39}html body .ms-borderColor-gray140,html body .ms-borderColor-gray140--hover:hover{border-color:#484644}html body .ms-borderColor-gray130,html body .ms-borderColor-gray130--hover:hover{border-color:#605e5c}html body .ms-borderColor-gray120,html body .ms-borderColor-gray120--hover:hover{border-color:#797775}html body .ms-borderColor-gray110,html body .ms-borderColor-gray110--hover:hover{border-color:#8a8886}html body .ms-borderColor-gray100,html body .ms-borderColor-gray100--hover:hover{border-color:#979593}html body .ms-borderColor-gray90,html body .ms-borderColor-gray90--hover:hover{border-color:#a19f9d}html body .ms-borderColor-gray80,html body .ms-borderColor-gray80--hover:hover{border-color:#b3b0ad}html body .ms-borderColor-gray70,html body .ms-borderColor-gray70--hover:hover{border-color:#bebbb8}html body .ms-borderColor-gray60,html body .ms-borderColor-gray60--hover:hover{border-color:#c8c6c4}html body .ms-borderColor-gray50,html body .ms-borderColor-gray50--hover:hover{border-color:#d2d0ce}html body .ms-borderColor-gray40,html body .ms-borderColor-gray40--hover:hover{border-color:#e1dfdd}html body .ms-borderColor-gray30,html body .ms-borderColor-gray30--hover:hover{border-color:#edebe9}html body .ms-borderColor-gray20,html body .ms-borderColor-gray20--hover:hover{border-color:#f3f2f1}html body .ms-borderColor-gray10,html body .ms-borderColor-gray10--hover:hover{border-color:#faf9f8}html body .ms-borderColor-white,html body .ms-borderColor-white--hover:hover{border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html body .ms-borderColor-sharedPinkRed10,html body .ms-borderColor-sharedPinkRed10--hover:hover{border-color:#750b1c}html body .ms-borderColor-sharedRed20,html body .ms-borderColor-sharedRed20--hover:hover{border-color:#a4262c}html body .ms-borderColor-sharedRed10,html body .ms-borderColor-sharedRed10--hover:hover{border-color:#d13438}html body .ms-borderColor-sharedRedOrange20,html body .ms-borderColor-sharedRedOrange20--hover:hover{border-color:#603d30}html body .ms-borderColor-sharedRedOrange10,html body .ms-borderColor-sharedRedOrange10--hover:hover{border-color:#da3b01}html body .ms-borderColor-sharedOrange30,html body .ms-borderColor-sharedOrange30--hover:hover{border-color:#8e562e}html body .ms-borderColor-sharedOrange20,html body .ms-borderColor-sharedOrange20--hover:hover{border-color:#ca5010}html body .ms-borderColor-sharedOrange10,html body .ms-borderColor-sharedOrange10--hover:hover{border-color:#fa4}html body .ms-borderColor-sharedYellow10,html body .ms-borderColor-sharedYellow10--hover:hover{border-color:#fce100}html body .ms-borderColor-sharedOrangeYellow20,html body .ms-borderColor-sharedOrangeYellow20--hover:hover{border-color:#986f0b}html body .ms-borderColor-sharedOrangeYellow10,html body .ms-borderColor-sharedOrangeYellow10--hover:hover{border-color:#c19c00}html body .ms-borderColor-sharedYellowGreen10,html body .ms-borderColor-sharedYellowGreen10--hover:hover{border-color:#8cbd18}html body .ms-borderColor-sharedGreen20,html body .ms-borderColor-sharedGreen20--hover:hover{border-color:#0b6a0b}html body .ms-borderColor-sharedGreen10,html body .ms-borderColor-sharedGreen10--hover:hover{border-color:#498205}html body .ms-borderColor-sharedGreenCyan10,html body .ms-borderColor-sharedGreenCyan10--hover:hover{border-color:#00ad56}html body .ms-borderColor-sharedCyan40,html body .ms-borderColor-sharedCyan40--hover:hover{border-color:#005e50}html body .ms-borderColor-sharedCyan30,html body .ms-borderColor-sharedCyan30--hover:hover{border-color:#005b70}html body .ms-borderColor-sharedCyan20,html body .ms-borderColor-sharedCyan20--hover:hover{border-color:#038387}html body .ms-borderColor-sharedCyan10,html body .ms-borderColor-sharedCyan10--hover:hover{border-color:#00b7c3}html body .ms-borderColor-sharedCyanBlue20,html body .ms-borderColor-sharedCyanBlue20--hover:hover{border-color:#004e8c}html body .ms-borderColor-sharedCyanBlue10,html body .ms-borderColor-sharedCyanBlue10--hover:hover{border-color:#0078d4}html body .ms-borderColor-sharedBlue10,html body .ms-borderColor-sharedBlue10--hover:hover{border-color:#4f6bed}html body .ms-borderColor-sharedBlueMagenta40,html body .ms-borderColor-sharedBlueMagenta40--hover:hover{border-color:#373277}html body .ms-borderColor-sharedBlueMagenta30,html body .ms-borderColor-sharedBlueMagenta30--hover:hover{border-color:#5c2e91}html body .ms-borderColor-sharedBlueMagenta20,html body .ms-borderColor-sharedBlueMagenta20--hover:hover{border-color:#8764b8}html body .ms-borderColor-sharedBlueMagenta10,html body .ms-borderColor-sharedBlueMagenta10--hover:hover{border-color:#8378de}html body .ms-borderColor-sharedMagenta20,html body .ms-borderColor-sharedMagenta20--hover:hover{border-color:#881798}html body .ms-borderColor-sharedMagenta10,html body .ms-borderColor-sharedMagenta10--hover:hover{border-color:#c239b3}html body .ms-borderColor-sharedMagentaPink20,html body .ms-borderColor-sharedMagentaPink20--hover:hover{border-color:#9b0062}html body .ms-borderColor-sharedMagentaPink10,html body .ms-borderColor-sharedMagentaPink10--hover:hover{border-color:#e3008c}html body .ms-borderColor-sharedGray40,html body .ms-borderColor-sharedGray40--hover:hover{border-color:#393939}html body .ms-borderColor-sharedGray30,html body .ms-borderColor-sharedGray30--hover:hover{border-color:#7a7574}html body .ms-borderColor-sharedGray20,html body .ms-borderColor-sharedGray20--hover:hover{border-color:#69797e}html body .ms-borderColor-sharedGray10,html body .ms-borderColor-sharedGray10--hover:hover{border-color:#a0aeb2}html body .ms-fontColor-communicationShade30,html body .ms-fontColor-communicationShade30--hover:hover{color:#004578}html body .ms-fontColor-communicationShade20,html body .ms-fontColor-communicationShade20--hover:hover{color:#005a9e}html body .ms-fontColor-communicationShade10,html body .ms-fontColor-communicationShade10--hover:hover{color:#106ebe}html body .ms-fontColor-communicationPrimary,html body .ms-fontColor-communicationPrimary--hover:hover{color:#0078d4}html body .ms-fontColor-communicationTint10,html body .ms-fontColor-communicationTint10--hover:hover{color:#2b88d8}html body .ms-fontColor-communicationTint20,html body .ms-fontColor-communicationTint20--hover:hover{color:#c7e0f4}html body .ms-fontColor-communicationTint30,html body .ms-fontColor-communicationTint30--hover:hover{color:#deecf9}html body .ms-fontColor-communicationTint40,html body .ms-fontColor-communicationTint40--hover:hover{color:#eff6fc}html body .ms-fontColor-black,html body .ms-fontColor-black--hover:hover{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}html body .ms-fontColor-gray220,html body .ms-fontColor-gray220--hover:hover{color:#11100f}html body .ms-fontColor-gray210,html body .ms-fontColor-gray210--hover:hover{color:#161514}html body .ms-fontColor-gray200,html body .ms-fontColor-gray200--hover:hover{color:#1b1a19}html body .ms-fontColor-gray190,html body .ms-fontColor-gray190--hover:hover{color:#201f1e}html body .ms-fontColor-gray180,html body .ms-fontColor-gray180--hover:hover{color:#252423}html body .ms-fontColor-gray170,html body .ms-fontColor-gray170--hover:hover{color:#292827}html body .ms-fontColor-gray160,html body .ms-fontColor-gray160--hover:hover{color:#323130}html body .ms-fontColor-gray150,html body .ms-fontColor-gray150--hover:hover{color:#3b3a39}html body .ms-fontColor-gray140,html body .ms-fontColor-gray140--hover:hover{color:#484644}html body .ms-fontColor-gray130,html body .ms-fontColor-gray130--hover:hover{color:#605e5c}html body .ms-fontColor-gray120,html body .ms-fontColor-gray120--hover:hover{color:#797775}html body .ms-fontColor-gray110,html body .ms-fontColor-gray110--hover:hover{color:#8a8886}html body .ms-fontColor-gray100,html body .ms-fontColor-gray100--hover:hover{color:#979593}html body .ms-fontColor-gray90,html body .ms-fontColor-gray90--hover:hover{color:#a19f9d}html body .ms-fontColor-gray80,html body .ms-fontColor-gray80--hover:hover{color:#b3b0ad}html body .ms-fontColor-gray70,html body .ms-fontColor-gray70--hover:hover{color:#bebbb8}html body .ms-fontColor-gray60,html body .ms-fontColor-gray60--hover:hover{color:#c8c6c4}html body .ms-fontColor-gray50,html body .ms-fontColor-gray50--hover:hover{color:#d2d0ce}html body .ms-fontColor-gray40,html body .ms-fontColor-gray40--hover:hover{color:#e1dfdd}html body .ms-fontColor-gray30,html body .ms-fontColor-gray30--hover:hover{color:#edebe9}html body .ms-fontColor-gray20,html body .ms-fontColor-gray20--hover:hover{color:#f3f2f1}html body .ms-fontColor-gray10,html body .ms-fontColor-gray10--hover:hover{color:#faf9f8}html body .ms-fontColor-white,html body .ms-fontColor-white--hover:hover{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html body .ms-fontColor-sharedPinkRed10,html body .ms-fontColor-sharedPinkRed10--hover:hover{color:#750b1c}html body .ms-fontColor-sharedRed20,html body .ms-fontColor-sharedRed20--hover:hover{color:#a4262c}html body .ms-fontColor-sharedRed10,html body .ms-fontColor-sharedRed10--hover:hover{color:#d13438}html body .ms-fontColor-sharedRedOrange20,html body .ms-fontColor-sharedRedOrange20--hover:hover{color:#603d30}html body .ms-fontColor-sharedRedOrange10,html body .ms-fontColor-sharedRedOrange10--hover:hover{color:#da3b01}html body .ms-fontColor-sharedOrange30,html body .ms-fontColor-sharedOrange30--hover:hover{color:#8e562e}html body .ms-fontColor-sharedOrange20,html body .ms-fontColor-sharedOrange20--hover:hover{color:#ca5010}html body .ms-fontColor-sharedOrange10,html body .ms-fontColor-sharedOrange10--hover:hover{color:#fa4}html body .ms-fontColor-sharedYellow10,html body .ms-fontColor-sharedYellow10--hover:hover{color:#fce100}html body .ms-fontColor-sharedOrangeYellow20,html body .ms-fontColor-sharedOrangeYellow20--hover:hover{color:#986f0b}html body .ms-fontColor-sharedOrangeYellow10,html body .ms-fontColor-sharedOrangeYellow10--hover:hover{color:#c19c00}html body .ms-fontColor-sharedYellowGreen10,html body .ms-fontColor-sharedYellowGreen10--hover:hover{color:#8cbd18}html body .ms-fontColor-sharedGreen20,html body .ms-fontColor-sharedGreen20--hover:hover{color:#0b6a0b}html body .ms-fontColor-sharedGreen10,html body .ms-fontColor-sharedGreen10--hover:hover{color:#498205}html body .ms-fontColor-sharedGreenCyan10,html body .ms-fontColor-sharedGreenCyan10--hover:hover{color:#00ad56}html body .ms-fontColor-sharedCyan40,html body .ms-fontColor-sharedCyan40--hover:hover{color:#005e50}html body .ms-fontColor-sharedCyan30,html body .ms-fontColor-sharedCyan30--hover:hover{color:#005b70}html body .ms-fontColor-sharedCyan20,html body .ms-fontColor-sharedCyan20--hover:hover{color:#038387}html body .ms-fontColor-sharedCyan10,html body .ms-fontColor-sharedCyan10--hover:hover{color:#00b7c3}html body .ms-fontColor-sharedCyanBlue20,html body .ms-fontColor-sharedCyanBlue20--hover:hover{color:#004e8c}html body .ms-fontColor-sharedCyanBlue10,html body .ms-fontColor-sharedCyanBlue10--hover:hover{color:#0078d4}html body .ms-fontColor-sharedBlue10,html body .ms-fontColor-sharedBlue10--hover:hover{color:#4f6bed}html body .ms-fontColor-sharedBlueMagenta40,html body .ms-fontColor-sharedBlueMagenta40--hover:hover{color:#373277}html body .ms-fontColor-sharedBlueMagenta30,html body .ms-fontColor-sharedBlueMagenta30--hover:hover{color:#5c2e91}html body .ms-fontColor-sharedBlueMagenta20,html body .ms-fontColor-sharedBlueMagenta20--hover:hover{color:#8764b8}html body .ms-fontColor-sharedBlueMagenta10,html body .ms-fontColor-sharedBlueMagenta10--hover:hover{color:#8378de}html body .ms-fontColor-sharedMagenta20,html body .ms-fontColor-sharedMagenta20--hover:hover{color:#881798}html body .ms-fontColor-sharedMagenta10,html body .ms-fontColor-sharedMagenta10--hover:hover{color:#c239b3}html body .ms-fontColor-sharedMagentaPink20,html body .ms-fontColor-sharedMagentaPink20--hover:hover{color:#9b0062}html body .ms-fontColor-sharedMagentaPink10,html body .ms-fontColor-sharedMagentaPink10--hover:hover{color:#e3008c}html body .ms-fontColor-sharedGray40,html body .ms-fontColor-sharedGray40--hover:hover{color:#393939}html body .ms-fontColor-sharedGray30,html body .ms-fontColor-sharedGray30--hover:hover{color:#7a7574}html body .ms-fontColor-sharedGray20,html body .ms-fontColor-sharedGray20--hover:hover{color:#69797e}html body .ms-fontColor-sharedGray10,html body .ms-fontColor-sharedGray10--hover:hover{color:#a0aeb2}html body .ms-bgColor-themeDark,html body .ms-bgColor-themeDark--hover:hover{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}html body .ms-bgColor-themeDarkAlt,html body .ms-bgColor-themeDarkAlt--hover:hover{background-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}html body .ms-bgColor-themeDarker,html body .ms-bgColor-themeDarker--hover:hover{background-color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}html body .ms-bgColor-themePrimary,html body .ms-bgColor-themePrimary--hover:hover{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}html body .ms-bgColor-themeSecondary,html body .ms-bgColor-themeSecondary--hover:hover{background-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}html body .ms-bgColor-themeTertiary,html body .ms-bgColor-themeTertiary--hover:hover{background-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}html body .ms-bgColor-themeLight,html body .ms-bgColor-themeLight--hover:hover{background-color:"},{"theme":"themeLight","defaultValue":"#c7e0f4"},{"rawString":"}html body .ms-bgColor-themeLighter,html body .ms-bgColor-themeLighter--hover:hover{background-color:"},{"theme":"themeLighter","defaultValue":"#deecf9"},{"rawString":"}html body .ms-bgColor-themeLighterAlt,html body .ms-bgColor-themeLighterAlt--hover:hover{background-color:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":"}html body .ms-borderColor-themeDark,html body .ms-borderColor-themeDark--hover:hover{border-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}html body .ms-borderColor-themeDarkAlt,html body .ms-borderColor-themeDarkAlt--hover:hover{border-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}html body .ms-borderColor-themeDarker,html body .ms-borderColor-themeDarker--hover:hover{border-color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}html body .ms-borderColor-themePrimary,html body .ms-borderColor-themePrimary--hover:hover{border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}html body .ms-borderColor-themeSecondary,html body .ms-borderColor-themeSecondary--hover:hover{border-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}html body .ms-borderColor-themeTertiary,html body .ms-borderColor-themeTertiary--hover:hover{border-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}html body .ms-borderColor-themeLight,html body .ms-borderColor-themeLight--hover:hover{border-color:"},{"theme":"themeLight","defaultValue":"#c7e0f4"},{"rawString":"}html body .ms-borderColor-themeLighter,html body .ms-borderColor-themeLighter--hover:hover{border-color:"},{"theme":"themeLighter","defaultValue":"#deecf9"},{"rawString":"}html body .ms-borderColor-themeLighterAlt,html body .ms-borderColor-themeLighterAlt--hover:hover{border-color:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":"}html body .ms-fontColor-themeDarker,html body .ms-fontColor-themeDarker--hover:hover{color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}html body .ms-fontColor-themeDark,html body .ms-fontColor-themeDark--hover:hover{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}html body .ms-fontColor-themeDarkAlt,html body .ms-fontColor-themeDarkAlt--hover:hover{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}html body .ms-fontColor-themePrimary,html body .ms-fontColor-themePrimary--hover:hover{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}html body .ms-fontColor-themeSecondary,html body .ms-fontColor-themeSecondary--hover:hover{color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}html body .ms-fontColor-themeTertiary,html body .ms-fontColor-themeTertiary--hover:hover{color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}html body .ms-fontColor-themeLight,html body .ms-fontColor-themeLight--hover:hover{color:"},{"theme":"themeLight","defaultValue":"#c7e0f4"},{"rawString":"}html body .ms-fontColor-themeLighter,html body .ms-fontColor-themeLighter--hover:hover{color:"},{"theme":"themeLighter","defaultValue":"#deecf9"},{"rawString":"}html body .ms-fontColor-themeLighterAlt,html body .ms-fontColor-themeLighterAlt--hover:hover{color:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":"}html body .ms-bgColor-black,html body .ms-bgColor-black--hover:hover{background-color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}html body .ms-bgColor-neutralDark,html body .ms-bgColor-neutralDark--hover:hover{background-color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}html body .ms-bgColor-neutralPrimary,html body .ms-bgColor-neutralPrimary--hover:hover{background-color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}html body .ms-bgColor-neutralPrimaryAlt,html body .ms-bgColor-neutralPrimaryAlt--hover:hover{background-color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":"}html body .ms-bgColor-neutralSecondary,html body .ms-bgColor-neutralSecondary--hover:hover{background-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}html body .ms-bgColor-neutralSecondaryAlt,html body .ms-bgColor-neutralSecondaryAlt--hover:hover{background-color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}html body .ms-bgColor-neutralTertiary,html body .ms-bgColor-neutralTertiary--hover:hover{background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}html body .ms-bgColor-neutralTertiaryAlt,html body .ms-bgColor-neutralTertiaryAlt--hover:hover{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}html body .ms-bgColor-neutralQuaternary,html body .ms-bgColor-neutralQuaternary--hover:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}html body .ms-bgColor-neutralQuaternaryAlt,html body .ms-bgColor-neutralQuaternaryAlt--hover:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}html body .ms-bgColor-neutralLight,html body .ms-bgColor-neutralLight--hover:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html body .ms-bgColor-neutralLighter,html body .ms-bgColor-neutralLighter--hover:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}html body .ms-bgColor-neutralLighterAlt,html body .ms-bgColor-neutralLighterAlt--hover:hover{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}html body .ms-bgColor-white,html body .ms-bgColor-white--hover:hover{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html body .ms-borderColor-black,html body .ms-borderColor-black--hover:hover{border-color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}html body .ms-borderColor-neutralDark,html body .ms-borderColor-neutralDark--hover:hover{border-color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}html body .ms-borderColor-neutralPrimary,html body .ms-borderColor-neutralPrimary--hover:hover{border-color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}html body .ms-borderColor-neutralPrimaryAlt,html body .ms-borderColor-neutralPrimaryAlt--hover:hover{border-color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":"}html body .ms-borderColor-neutralSecondary,html body .ms-borderColor-neutralSecondary--hover:hover{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}html body .ms-borderColor-neutralSecondaryAlt,html body .ms-borderColor-neutralSecondaryAlt--hover:hover{border-color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}html body .ms-borderColor-neutralTertiary,html body .ms-borderColor-neutralTertiary--hover:hover{border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}html body .ms-borderColor-neutralTertiaryAlt,html body .ms-borderColor-neutralTertiaryAlt--hover:hover{border-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}html body .ms-borderColor-neutralQuaternary,html body .ms-borderColor-neutralQuaternary--hover:hover{border-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}html body .ms-borderColor-neutralQuaternaryAlt,html body .ms-borderColor-neutralQuaternaryAlt--hover:hover{border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}html body .ms-borderColor-neutralLight,html body .ms-borderColor-neutralLight--hover:hover{border-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html body .ms-borderColor-neutralLighter,html body .ms-borderColor-neutralLighter--hover:hover{border-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}html body .ms-borderColor-neutralLighterAlt,html body .ms-borderColor-neutralLighterAlt--hover:hover{border-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}html body .ms-borderColor-white,html body .ms-borderColor-white--hover:hover{border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html body .ms-fontColor-black,html body .ms-fontColor-black--hover:hover{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}html body .ms-fontColor-neutralDark,html body .ms-fontColor-neutralDark--hover:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}html body .ms-fontColor-neutralPrimary,html body .ms-fontColor-neutralPrimary--hover:hover{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}html body .ms-fontColor-neutralPrimaryAlt,html body .ms-fontColor-neutralPrimaryAlt--hover:hover{color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":"}html body .ms-fontColor-neutralSecondary,html body .ms-fontColor-neutralSecondary--hover:hover{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}html body .ms-fontColor-neutralSecondaryAlt,html body .ms-fontColor-neutralSecondaryAlt--hover:hover{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}html body .ms-fontColor-neutralTertiary,html body .ms-fontColor-neutralTertiary--hover:hover{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}html body .ms-fontColor-neutralTertiaryAlt,html body .ms-fontColor-neutralTertiaryAlt--hover:hover{color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}html body .ms-fontColor-neutralQuaternary,html body .ms-fontColor-neutralQuaternary--hover:hover{color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}html body .ms-fontColor-neutralQuaternaryAlt,html body .ms-fontColor-neutralQuaternaryAlt--hover:hover{color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}html body .ms-fontColor-neutralLight,html body .ms-fontColor-neutralLight--hover:hover{color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html body .ms-fontColor-neutralLighter,html body .ms-fontColor-neutralLighter--hover:hover{color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}html body .ms-fontColor-neutralLighterAlt,html body .ms-fontColor-neutralLighterAlt--hover:hover{color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}html body .ms-fontColor-white,html body .ms-fontColor-white--hover:hover{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html body .ms-bgColor-yellow,html body .ms-bgColor-yellow--hover:hover{background-color:"},{"theme":"yellow","defaultValue":"#ffb900"},{"rawString":"}html body .ms-bgColor-yellowLight,html body .ms-bgColor-yellowLight--hover:hover{background-color:"},{"theme":"yellowLight","defaultValue":"#fff100"},{"rawString":"}html body .ms-bgColor-orange,html body .ms-bgColor-orange--hover:hover{background-color:"},{"theme":"orange","defaultValue":"#d83b01"},{"rawString":"}html body .ms-bgColor-orangeLight,html body .ms-bgColor-orangeLight--hover:hover{background-color:"},{"theme":"orangeLight","defaultValue":"#ea4300"},{"rawString":"}html body .ms-bgColor-orangeLighter,html body .ms-bgColor-orangeLighter--hover:hover{background-color:"},{"theme":"orangeLighter","defaultValue":"#ff8c00"},{"rawString":"}html body .ms-bgColor-redDark,html body .ms-bgColor-redDark--hover:hover{background-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}html body .ms-bgColor-red,html body .ms-bgColor-red--hover:hover{background-color:"},{"theme":"red","defaultValue":"#e81123"},{"rawString":"}html body .ms-bgColor-magentaDark,html body .ms-bgColor-magentaDark--hover:hover{background-color:"},{"theme":"magentaDark","defaultValue":"#5c005c"},{"rawString":"}html body .ms-bgColor-magenta,html body .ms-bgColor-magenta--hover:hover{background-color:"},{"theme":"magenta","defaultValue":"#b4009e"},{"rawString":"}html body .ms-bgColor-magentaLight,html body .ms-bgColor-magentaLight--hover:hover{background-color:"},{"theme":"magentaLight","defaultValue":"#e3008c"},{"rawString":"}html body .ms-bgColor-purpleDark,html body .ms-bgColor-purpleDark--hover:hover{background-color:"},{"theme":"purpleDark","defaultValue":"#32145a"},{"rawString":"}html body .ms-bgColor-purple,html body .ms-bgColor-purple--hover:hover{background-color:"},{"theme":"purple","defaultValue":"#5c2d91"},{"rawString":"}html body .ms-bgColor-purpleLight,html body .ms-bgColor-purpleLight--hover:hover{background-color:"},{"theme":"purpleLight","defaultValue":"#b4a0ff"},{"rawString":"}html body .ms-bgColor-blueDark,html body .ms-bgColor-blueDark--hover:hover{background-color:"},{"theme":"blueDark","defaultValue":"#002050"},{"rawString":"}html body .ms-bgColor-blueMid,html body .ms-bgColor-blueMid--hover:hover{background-color:"},{"theme":"blueMid","defaultValue":"#00188f"},{"rawString":"}html body .ms-bgColor-blue,html body .ms-bgColor-blue--hover:hover{background-color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":"}html body .ms-bgColor-blueLight,html body .ms-bgColor-blueLight--hover:hover{background-color:"},{"theme":"blueLight","defaultValue":"#00bcf2"},{"rawString":"}html body .ms-bgColor-tealDark,html body .ms-bgColor-tealDark--hover:hover{background-color:"},{"theme":"tealDark","defaultValue":"#004b50"},{"rawString":"}html body .ms-bgColor-teal,html body .ms-bgColor-teal--hover:hover{background-color:"},{"theme":"teal","defaultValue":"#008272"},{"rawString":"}html body .ms-bgColor-tealLight,html body .ms-bgColor-tealLight--hover:hover{background-color:"},{"theme":"tealLight","defaultValue":"#00b294"},{"rawString":"}html body .ms-bgColor-greenDark,html body .ms-bgColor-greenDark--hover:hover{background-color:"},{"theme":"greenDark","defaultValue":"#004b1c"},{"rawString":"}html body .ms-bgColor-green,html body .ms-bgColor-green--hover:hover{background-color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}html body .ms-bgColor-greenLight,html body .ms-bgColor-greenLight--hover:hover{background-color:"},{"theme":"greenLight","defaultValue":"#bad80a"},{"rawString":"}html body .ms-borderColor-yellow,html body .ms-borderColor-yellow--hover:hover{border-color:"},{"theme":"yellow","defaultValue":"#ffb900"},{"rawString":"}html body .ms-borderColor-yellowLight,html body .ms-borderColor-yellowLight--hover:hover{border-color:"},{"theme":"yellowLight","defaultValue":"#fff100"},{"rawString":"}html body .ms-borderColor-orange,html body .ms-borderColor-orange--hover:hover{border-color:"},{"theme":"orange","defaultValue":"#d83b01"},{"rawString":"}html body .ms-borderColor-orangeLight,html body .ms-borderColor-orangeLight--hover:hover{border-color:"},{"theme":"orangeLight","defaultValue":"#ea4300"},{"rawString":"}html body .ms-borderColor-orangeLighter,html body .ms-borderColor-orangeLighter--hover:hover{border-color:"},{"theme":"orangeLighter","defaultValue":"#ff8c00"},{"rawString":"}html body .ms-borderColor-redDark,html body .ms-borderColor-redDark--hover:hover{border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}html body .ms-borderColor-red,html body .ms-borderColor-red--hover:hover{border-color:"},{"theme":"red","defaultValue":"#e81123"},{"rawString":"}html body .ms-borderColor-magentaDark,html body .ms-borderColor-magentaDark--hover:hover{border-color:"},{"theme":"magentaDark","defaultValue":"#5c005c"},{"rawString":"}html body .ms-borderColor-magenta,html body .ms-borderColor-magenta--hover:hover{border-color:"},{"theme":"magenta","defaultValue":"#b4009e"},{"rawString":"}html body .ms-borderColor-magentaLight,html body .ms-borderColor-magentaLight--hover:hover{border-color:"},{"theme":"magentaLight","defaultValue":"#e3008c"},{"rawString":"}html body .ms-borderColor-purpleDark,html body .ms-borderColor-purpleDark--hover:hover{border-color:"},{"theme":"purpleDark","defaultValue":"#32145a"},{"rawString":"}html body .ms-borderColor-purple,html body .ms-borderColor-purple--hover:hover{border-color:"},{"theme":"purple","defaultValue":"#5c2d91"},{"rawString":"}html body .ms-borderColor-purpleLight,html body .ms-borderColor-purpleLight--hover:hover{border-color:"},{"theme":"purpleLight","defaultValue":"#b4a0ff"},{"rawString":"}html body .ms-borderColor-blueDark,html body .ms-borderColor-blueDark--hover:hover{border-color:"},{"theme":"blueDark","defaultValue":"#002050"},{"rawString":"}html body .ms-borderColor-blueMid,html body .ms-borderColor-blueMid--hover:hover{border-color:"},{"theme":"blueMid","defaultValue":"#00188f"},{"rawString":"}html body .ms-borderColor-blue,html body .ms-borderColor-blue--hover:hover{border-color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":"}html body .ms-borderColor-blueLight,html body .ms-borderColor-blueLight--hover:hover{border-color:"},{"theme":"blueLight","defaultValue":"#00bcf2"},{"rawString":"}html body .ms-borderColor-tealDark,html body .ms-borderColor-tealDark--hover:hover{border-color:"},{"theme":"tealDark","defaultValue":"#004b50"},{"rawString":"}html body .ms-borderColor-teal,html body .ms-borderColor-teal--hover:hover{border-color:"},{"theme":"teal","defaultValue":"#008272"},{"rawString":"}html body .ms-borderColor-tealLight,html body .ms-borderColor-tealLight--hover:hover{border-color:"},{"theme":"tealLight","defaultValue":"#00b294"},{"rawString":"}html body .ms-borderColor-greenDark,html body .ms-borderColor-greenDark--hover:hover{border-color:"},{"theme":"greenDark","defaultValue":"#004b1c"},{"rawString":"}html body .ms-borderColor-green,html body .ms-borderColor-green--hover:hover{border-color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}html body .ms-borderColor-greenLight,html body .ms-borderColor-greenLight--hover:hover{border-color:"},{"theme":"greenLight","defaultValue":"#bad80a"},{"rawString":"}html body .ms-fontColor-yellow,html body .ms-fontColor-yellow--hover:hover{color:"},{"theme":"yellow","defaultValue":"#ffb900"},{"rawString":"}html body .ms-fontColor-yellowLight,html body .ms-fontColor-yellowLight--hover:hover{color:"},{"theme":"yellowLight","defaultValue":"#fff100"},{"rawString":"}html body .ms-fontColor-orange,html body .ms-fontColor-orange--hover:hover{color:"},{"theme":"orange","defaultValue":"#d83b01"},{"rawString":"}html body .ms-fontColor-orangeLight,html body .ms-fontColor-orangeLight--hover:hover{color:"},{"theme":"orangeLight","defaultValue":"#ea4300"},{"rawString":"}html body .ms-fontColor-orangeLighter,html body .ms-fontColor-orangeLighter--hover:hover{color:"},{"theme":"orangeLighter","defaultValue":"#ff8c00"},{"rawString":"}html body .ms-fontColor-redDark,html body .ms-fontColor-redDark--hover:hover{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}html body .ms-fontColor-red,html body .ms-fontColor-red--hover:hover{color:"},{"theme":"red","defaultValue":"#e81123"},{"rawString":"}html body .ms-fontColor-magentaDark,html body .ms-fontColor-magentaDark--hover:hover{color:"},{"theme":"magentaDark","defaultValue":"#5c005c"},{"rawString":"}html body .ms-fontColor-magenta,html body .ms-fontColor-magenta--hover:hover{color:"},{"theme":"magenta","defaultValue":"#b4009e"},{"rawString":"}html body .ms-fontColor-magentaLight,html body .ms-fontColor-magentaLight--hover:hover{color:"},{"theme":"magentaLight","defaultValue":"#e3008c"},{"rawString":"}html body .ms-fontColor-purpleDark,html body .ms-fontColor-purpleDark--hover:hover{color:"},{"theme":"purpleDark","defaultValue":"#32145a"},{"rawString":"}html body .ms-fontColor-purple,html body .ms-fontColor-purple--hover:hover{color:"},{"theme":"purple","defaultValue":"#5c2d91"},{"rawString":"}html body .ms-fontColor-purpleLight,html body .ms-fontColor-purpleLight--hover:hover{color:"},{"theme":"purpleLight","defaultValue":"#b4a0ff"},{"rawString":"}html body .ms-fontColor-blueDark,html body .ms-fontColor-blueDark--hover:hover{color:"},{"theme":"blueDark","defaultValue":"#002050"},{"rawString":"}html body .ms-fontColor-blueMid,html body .ms-fontColor-blueMid--hover:hover{color:"},{"theme":"blueMid","defaultValue":"#00188f"},{"rawString":"}html body .ms-fontColor-blue,html body .ms-fontColor-blue--hover:hover{color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":"}html body .ms-fontColor-blueLight,html body .ms-fontColor-blueLight--hover:hover{color:"},{"theme":"blueLight","defaultValue":"#00bcf2"},{"rawString":"}html body .ms-fontColor-tealDark,html body .ms-fontColor-tealDark--hover:hover{color:"},{"theme":"tealDark","defaultValue":"#004b50"},{"rawString":"}html body .ms-fontColor-teal,html body .ms-fontColor-teal--hover:hover{color:"},{"theme":"teal","defaultValue":"#008272"},{"rawString":"}html body .ms-fontColor-tealLight,html body .ms-fontColor-tealLight--hover:hover{color:"},{"theme":"tealLight","defaultValue":"#00b294"},{"rawString":"}html body .ms-fontColor-greenDark,html body .ms-fontColor-greenDark--hover:hover{color:"},{"theme":"greenDark","defaultValue":"#004b1c"},{"rawString":"}html body .ms-fontColor-green,html body .ms-fontColor-green--hover:hover{color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}html body .ms-fontColor-greenLight,html body .ms-fontColor-greenLight--hover:hover{color:"},{"theme":"greenLight","defaultValue":"#bad80a"},{"rawString":"}html body .ms-bgColor-info,html body .ms-bgColor-info--hover:hover{background-color:#f3f2f1}html body .ms-bgColor-success,html body .ms-bgColor-success--hover:hover{background-color:#dff6dd}html body .ms-bgColor-severeWarning,html body .ms-bgColor-severeWarning--hover:hover{background-color:#fed9cc}html body .ms-bgColor-warning,html body .ms-bgColor-warning--hover:hover{background-color:#fff4ce}html body .ms-bgColor-error,html body .ms-bgColor-error--hover:hover{background-color:#fde7e9}html body .ms-fontColor-info,html body .ms-fontColor-info--hover:hover{color:#797775}html body .ms-fontColor-success,html body .ms-fontColor-success--hover:hover{color:#107c10}html body .ms-fontColor-alert,html body .ms-fontColor-alert--hover:hover{color:#d83b01}html body .ms-fontColor-warning,html body .ms-fontColor-warning--hover:hover{color:#797775}html body .ms-fontColor-severeWarning,html body .ms-fontColor-severeWarning--hover:hover{color:#d83b01}html body .ms-fontColor-error,html body .ms-fontColor-error--hover:hover{color:#a80000}html body .ms-bgColor-contrastBlackDisabled,html body .ms-bgColor-contrastBlackDisabled--hover:hover{background-color:lime}html body .ms-bgColor-contrastWhiteDisabled,html body .ms-bgColor-contrastWhiteDisabled--hover:hover{background-color:#600000}html body .ms-bgColor-contrastBlackSelected,html body .ms-bgColor-contrastBlackSelected--hover:hover{background-color:#1aebff}html body .ms-bgColor-contrastWhiteSelected,html body .ms-bgColor-contrastWhiteSelected--hover:hover{background-color:#37006e}html body .ms-fontColor-contrastBlackDisabled,html body .ms-fontColor-contrastBlackDisabled--hover:hover{color:lime}html body .ms-fontColor-contrastWhiteDisabled,html body .ms-fontColor-contrastWhiteDisabled--hover:hover{color:#600000}html body .ms-fontColor-contrastBlackSelected,html body .ms-fontColor-contrastBlackSelected--hover:hover{color:#1aebff}html body .ms-fontColor-contrastWhiteSelected,html body .ms-fontColor-contrastWhiteSelected--hover:hover{color:#37006e}html body .ms-borderColor-contrastBlackDisabled,html body .ms-borderColor-contrastBlackDisabled--hover:hover{border-color:lime}html body .ms-borderColor-contrastWhiteDisabled,html body .ms-borderColor-contrastWhiteDisabled--hover:hover{border-color:#600000}html body .ms-borderColor-contrastBlackSelected,html body .ms-borderColor-contrastBlackSelected--hover:hover{border-color:#1aebff}html body .ms-borderColor-contrastWhiteSelected,html body .ms-borderColor-contrastWhiteSelected--hover:hover{border-color:#37006e}\n"},{"rawString":".customField_d1e240fb,.customFieldCompact_d1e240fb{min-height:inherit;margin:-11px 0;white-space:normal;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.customFieldCompact_d1e240fb{margin:-6px 0}.customFieldTiles_d1e240fb{height:100%;width:100%}.ms-Tile-background .customCards_d1e240fb,.ms-Tile-background .defaultHoverCard_d1e240fb,.ms-Tile-background .fieldDefaultHoverCard_d1e240fb{pointer-events:auto}.customCards_d1e240fb .customField_d1e240fb,.customCards_d1e240fb .customFieldCompact_d1e240fb{margin:0px}.customCards_d1e240fb .customFieldCompact_d1e240fb{margin:0px}.defaultHoverCard_d1e240fb{position:absolute;opacity:0}.fieldDefaultHoverCard_d1e240fb{padding-left:12px;position:absolute;opacity:0}\n"},{"rawString":".peopleEditor_4414b0e3.increaseZIndex_4414b0e3{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.peopleEditor_4414b0e3.styleUpdates_4414b0e3 .ms-BasePicker-text{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;border:none;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.peopleEditor_4414b0e3.styleUpdates_4414b0e3 .ms-BasePicker-text:after{content:none}.peopleEditor_4414b0e3.styleUpdates_4414b0e3 .ms-BasePicker-text .ms-BasePicker-input{height:36px;width:100%;padding:4px;max-height:36px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex-item-align:start;align-self:flex-start}.peopleEditor_4414b0e3.styleUpdates_4414b0e3 .ms-BasePicker-text .ms-BasePicker-itemsWrapper{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;overflow-y:hidden;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.peopleEditor_4414b0e3 .ms-Button{min-width:0px;margin-left:0px}.peopleEditor_4414b0e3:not(.styleUpdates_4414b0e3) .ms-BasePicker-input{border:none;padding:0 6px 0px}.peopleEditor_4414b0e3:not(.inStickyMode_4414b0e3) .ms-BasePicker-text:after{content:none}\n"},{"rawString":".personDisplayPill_72ef897c{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:24px;border-radius:12px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}[dir='ltr'] .personDisplayPill_72ef897c{padding-right:8px}[dir='rtl'] .personDisplayPill_72ef897c{padding-left:8px}.personDisplayCoin_72ef897c{border-radius:12px;display:inline-block;width:24px;height:24px;text-align:center;font-size:10px;font-weight:600;line-height:24px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.personDisplayPhoto_72ef897c{display:block;width:24px;height:24px;-o-object-fit:cover;object-fit:cover;position:absolute;border-radius:12px}.personDisplayName_72ef897c{white-space:nowrap}[dir='ltr'] .personDisplayName_72ef897c{padding-left:5px}[dir='rtl'] .personDisplayName_72ef897c{padding-right:5px}\n"},{"rawString":".spCustomFormatField_fd5acce7{min-height:inherit;margin:-8px 0;white-space:normal;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}\n"},{"rawString":".pillDeleteButton_2197ca36{position:absolute;font-size:12px}[dir='ltr'] .pillDeleteButton_2197ca36{right:6px}[dir='rtl'] .pillDeleteButton_2197ca36{left:6px}\n"},{"rawString":".pill_071bcf73,.pillNoHoverStyle_071bcf73,.pillWithHoverByDefault_071bcf73{-webkit-box-sizing:border-box;box-sizing:border-box;min-height:inherit;padding:5px 0px 2px 8px;font-size:12px}[dir='rtl'] .pill_071bcf73,[dir='rtl'] .pillNoHoverStyle_071bcf73,[dir='rtl'] .pillWithHoverByDefault_071bcf73{padding:5px 8px 2px 0px}.pill_071bcf73 div:not(.innerPillPlainText_071bcf73):first-child,.pillNoHoverStyle_071bcf73 div:not(.innerPillPlainText_071bcf73):first-child,.pillWithHoverByDefault_071bcf73 div:not(.innerPillPlainText_071bcf73):first-child{margin:0px}.pillNoHoverStyle_071bcf73{display:inline-block;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.pillNoHoverStyle_071bcf73 .innerPillPlainText_071bcf73{padding:0 8px;margin:0 -8px}.pillNoHoverStyle_071bcf73:focus{outline:none}.pillNoHoverStyle_071bcf73:focus div[class^='sp-css-backgroundColor'],.pillNoHoverStyle_071bcf73:focus div[class^='sp-field-borderAllRegular'],.pillNoHoverStyle_071bcf73:focus .innerPillPlainText_071bcf73{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";outline-offset:2px}.pillNoHoverStyle_071bcf73:focus .innerPillPlainText_071bcf73{outline-offset:-3px}.innerPillPlainText_071bcf73{height:29px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.pill_071bcf73{margin:0 -8px}.pill_071bcf73:hover{background-color:"},{"theme":"buttonBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"buttonTextHovered","defaultValue":"#201f1e"},{"rawString":"}@media screen and (-ms-high-contrast: active){.pill_071bcf73:hover{background-color:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}.pill_071bcf73:hover div[class^='sp-css-backgroundColor']{background-color:transparent}}.pillWithHoverByDefault_071bcf73{margin:0 -8px;background-color:"},{"theme":"buttonBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"buttonTextHovered","defaultValue":"#201f1e"},{"rawString":"}@media screen and (-ms-high-contrast: active){.pillWithHoverByDefault_071bcf73{background-color:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}.pillWithHoverByDefault_071bcf73 div[class^='sp-css-backgroundColor']{background-color:transparent}}.wellInput_071bcf73{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.editorButtonsContainer_071bcf73{margin-top:12px;padding-top:8px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.flyOutButtonsContainer_071bcf73{margin-top:0px}.fillInWrapperDiv_071bcf73,.fillInWrapperDivWithBackground_071bcf73{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:36px;margin:0 -8px}.fillInWrapperDivWithBackground_071bcf73{background-color:"},{"theme":"buttonBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"buttonTextHovered","defaultValue":"#201f1e"},{"rawString":"}.fillInWrapperDiv_071bcf73:hover{background-color:"},{"theme":"buttonBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"buttonTextHovered","defaultValue":"#201f1e"},{"rawString":"}.fillInPillDiv_071bcf73{border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-radius:10px;padding:0 5px}[dir='ltr'] .fillInPillDiv_071bcf73{margin-left:10px}[dir='rtl'] .fillInPillDiv_071bcf73{margin-right:10px}.fillInLabel_071bcf73{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:14px}[dir='ltr'] .fillInLabel_071bcf73{margin-left:8px}[dir='rtl'] .fillInLabel_071bcf73{margin-right:8px}.buttonBorderFocused_071bcf73{border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.iconClass_071bcf73{font-size:12px;line-height:16px}[dir='ltr'] .iconClass_071bcf73{margin-left:8px}[dir='rtl'] .iconClass_071bcf73{margin-right:8px}\n"},{"rawString":".numberEditorUnit_d536e75f{text-overflow:ellipsis;padding:10px 7px;margin-bottom:1px;overflow-x:hidden}\n"},{"rawString":".quickEditDateTimeEditor_5676550c .ms-DatePicker-wrap{padding:0px}.quickEditDateTimeEditorInput_5676550c{position:relative;font-size:12px;padding:0px 6px;margin:2px;border:0px;z-index:30;font-family:inherit;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.quickEditDateTimeEditorInput_5676550c:focus{outline:none}.quickEditDateTimeEditorTimeInput_5676550c{height:32px;width:112px;font-size:14px;background-color:inherit}\n"},{"rawString":".Location-addressContainer{display:-webkit-box;display:-ms-flexbox;display:flex}.Location-addressContainer .Location-addressText{min-width:50px;margin:0 8px}.Location-addressContainer-noIcon .Location-addressText{min-width:50px;margin:0}\n"},{"rawString":".Location-personaIcon{font-size:20px}.ms-LocationPicker-item .ms-Persona{outline:0;border:none}.ms-LocationPicker-item .ms-Persona-details{padding:0 8px 4px 8px}\n"},{"rawString":".ms-LocationPicker-item{border-radius:20px;min-width:16px;height:100%}.ms-LocationPicker-item .ms-PickerItem-removeButton{height:100%}.ms-LocationPicker-item:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-LocationPicker-item.is-selected{background-color:"},{"theme":"listItemBackgroundChecked","defaultValue":"#edebe9"},{"rawString":"}.ms-LocationPicker-item.is-selected:hover{background-color:"},{"theme":"listItemBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":"}.ms-Location-suggestionTokenContainer{padding-top:7px;padding-bottom:7px;height:auto;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box}html[dir='ltr'] .ms-Location-suggestionTokenContainer{padding-left:12px}html[dir='rtl'] .ms-Location-suggestionTokenContainer{padding-right:12px}.Location-Picker-Suggestions.ms-Suggestions{width:300px}\n"},{"rawString":".locationEditor_a4963643{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.locationEditor_a4963643.stickyEditor_a4963643{z-index:1020}\n"},{"rawString":".ms-TreePicker-dialog.ms-Dialog-main{max-width:640px;width:100%;max-height:none}.ms-TreePicker-iFrame{border:none;width:100%}.ms-TreePicker-dialogSpinner{width:100%;padding:15px 0px}\n"},{"rawString":".taxonomyEditorSpan_acc4ff20{display:-webkit-box;display:-ms-flexbox;display:flex}.taxonomyEditorSpan_acc4ff20.increaseZIndex_acc4ff20{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.taxonomyEditorSpan_acc4ff20 .ms-BasePicker-text:after{content:none}[dir='ltr'] .taxonomyEditorSpan_acc4ff20 .taxonomyEditor-Picker{padding-left:4px}[dir='rtl'] .taxonomyEditorSpan_acc4ff20 .taxonomyEditor-Picker{padding-right:4px}\n"},{"rawString":".ReactFieldEditor-core--edit .ReactFieldEditor-Taxonomy{display:-webkit-box;display:-ms-flexbox;display:flex;border:none;border-bottom:0}.ReactFieldEditor-core--edit .ReactFieldEditor-Taxonomy:hover{border-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ReactFieldEditor-core--edit .ReactFieldEditor-Taxonomy:focus{border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ReactFieldEditor-TaxonomyPicker{min-width:1px}.ms-Taxonomy-termPicker.ReactFieldEditor-Picker{border:none}\n"},{"rawString":".spGridTableHead_50e10db5{display:none}.spGridPagingFooter_50e10db5{margin-top:16px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.spGridPagingFooterContent_50e10db5{padding:0 8px 2px}.spGridCustomFormatField_50e10db5{min-height:inherit;margin:-11px 0;white-space:normal}.wrapperTable_50e10db5{border-spacing:0px}.wrapperTd_50e10db5{padding:0}.gridFocusEntryPoint_50e10db5{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.gridFocusEntryPoint_50e10db5:focus{outline:none}.gridFocusEntryPoint_50e10db5:focus+.gridParentFocusable_50e10db5::after{content:'';position:absolute;top:0;bottom:0;left:0;right:0;border:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:6px;pointer-events:none;z-index:99999}.spGridRoot_50e10db5 iframe{border:none}.spGridRoot_50e10db5 input[type='radio']{vertical-align:middle;margin:3px 3px 0px 5px}[dir='rtl'] .spGridRoot_50e10db5 input[type='radio']{margin:3px 5px 0px 3px}.spGridRoot_50e10db5 label{vertical-align:middle}.spGridRoot_50e10db5 .ms-accessible,.spGridRoot_50e10db5 .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.spGridRoot_50e10db5 .ms-accessible-quickedit,.spGridRoot_50e10db5 .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.spGridRoot_50e10db5 .skipGridContentButton_50e10db5{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.spGridRoot_50e10db5 .skipGridContentButton_50e10db5:focus{top:2px;background-color:#fff;color:#000;padding:2px 4px;z-index:12;height:auto;width:auto}.spGridRoot_50e10db5 .ms-spGrid-HeaderContentStyle-Rename{padding:3px 5px 0px 5px}.spGridRoot_50e10db5 .ms-spGrid-HeaderContentStyle-Rename input{padding:2px 5px}.spGridErrorIcon_50e10db5{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":";background-color:"},{"theme":"errorBackground","defaultValue":"#FDE7E9"},{"rawString":";border-radius:8px}.srOnly_50e10db5{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0}.boolIconDiv_50e10db5{text-align:center}.boolIcon_50e10db5{font-size:16px}.dropHintStyle_50e10db5{display:inline-block;position:absolute}.dropHintStyle_50e10db5.containerRefreshed_50e10db5{height:42px}.dropHintCaretStyle_50e10db5{display:none;position:absolute;top:22px;left:-7.5px;color:#004e8c;overflow:visible;z-index:10}.dropHintCaretStyle_50e10db5.caretRefreshed_50e10db5{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";left:-6.5px;top:unset;bottom:0}.dropHintLineStyle_50e10db5{display:none;position:absolute;bottom:0px;top:-3px;overflow:hidden;height:37px;width:1px;background-color:#004e8c}.dropHintLineStyle_50e10db5.lineRefreshed_50e10db5{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";height:28px;top:7px}@media screen and (-ms-high-contrast: active){.dropHintLineStyle_50e10db5.lineRefreshed_50e10db5{background-color:WindowText}}.jsgrid-control-multiline-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-control-rte-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-widget-hyperlink-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";border:1px solid "},{"theme":"inputBorder","defaultValue":"#605e5c"},{"rawString":"}.jsgrid-widget-hyperlink-buttonarea-quickedit{background-color:"},{"theme":"buttonBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-changehighlight{background-color:"},{"theme":"bodyStandoutBackground","defaultValue":"#faf9f8"},{"rawString":"}.ms-vb a:link,.ms-vb2 a:link,.ms-vb-user a:link{text-decoration:none}.ms-vb a.ms-listlink,.ms-vb2 a.ms-listlink,.ms-vb-user a.ms-listlink,.ms-vb a.ms-listlink:visited,.ms-vb a.ms-listlink:visited:hover{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";text-decoration:none}.listLink_50e10db5{font-weight:600}.ms-vb-title .isTitleOrNameFieldVisualRefresh_50e10db5{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-weight:600}.ms-vb-title .isTitleOrNameField_50e10db5{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-weight:400}.cellHiddenOverflow_50e10db5,.cellBreakWordOverflow_50e10db5{display:inline-block;width:100%;position:relative;z-index:15}.cellHiddenOverflow_50e10db5{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:middle}.cellHiddenOverflow_50e10db5.personaPillOverflowContainer_50e10db5{text-overflow:clip}.cellHiddenOverflow_50e10db5.personaPillOverflowContainer_50e10db5>div{margin:0}[dir='ltr'] .cellHiddenOverflow_50e10db5.personaPillOverflowContainer_50e10db5>div:not(:last-child){margin-right:7px}[dir='rtl'] .cellHiddenOverflow_50e10db5.personaPillOverflowContainer_50e10db5>div:not(:last-child){margin-left:7px}.cellBreakWordOverflow_50e10db5{overflow:hidden;overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.cellBreakWordOverflow_50e10db5.personaPillOverflowContainer_50e10db5{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.cellBreakWordOverflow_50e10db5.personaPillOverflowContainer_50e10db5>div{margin:0}.cellBreakWordOverflow_50e10db5.personaPillOverflowContainer_50e10db5>div:not(:last-child){margin-bottom:12px}.customFormatField_50e10db5{margin:0}.msGridWidgetDock_50e10db5{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:#fdfdfd;height:20px;position:absolute;cursor:pointer;z-index:20}.stickyEditor_50e10db5{z-index:1020}.msGridWidgetDockHover_50e10db5{border-color:#92c0e0;background-color:#e6f2fa}.msGridWidgetDockPressed_50e10db5{border-color:#2a8dd4;background-color:#92b7d1}.msGridWidgetCell_50e10db5{overflow:hidden;padding:2px;height:16px;width:16px;top:0px;position:absolute}[dir='ltr'] .msGridWidgetCell_50e10db5{float:left}[dir='rtl'] .msGridWidgetCell_50e10db5{float:right}.msGridCellSelectedEditable_50e10db5{cursor:text}.msGridCellSelectedEditable_50e10db5 a:hover{cursor:text}.msGridCellSelectedEditable_50e10db5 [ms-jsgrid-click-passthrough='true']{cursor:auto}.spGridErrorNotification_50e10db5{color:#bf0000;text-align:left}.msGrid_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-right-style:solid;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-bottom-style:solid;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridLink_50e10db5{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";background-color:#663399}.msGridSelection_50e10db5{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:#9ccef0}[dir='ltr'] .msGridSelection_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridSelection_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridSelection_50e10db5{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSelection_50e10db5{border-left-color:rgba(0,0,0,0)}.msGridSelectionReadonly_50e10db5{border-bottom-color:#e1e1e1}.msGridEdit_50e10db5{background-color:#cde6f7;border-top-color:#bf0000}[dir='ltr'] .msGridEdit_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridEdit_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridTimescale_50e10db5{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-bottom-style:solid;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridTimescale_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridTimescale_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridTimescale_50e10db5{border-right-style:solid}[dir='rtl'] .msGridTimescale_50e10db5{border-left-style:solid}[dir='ltr'] .msGridTimescale_50e10db5{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridTimescale_50e10db5{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.msGridColHeaderNormal_50e10db5{font-size:1em;font-weight:normal;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-top-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridColHeaderNormal_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderNormal_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderNormal_50e10db5{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderNormal_50e10db5{border-right-color:rgba(0,0,0,0)}.msGridColHeaderElemBgColorsNormal_50e10db5{background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsNormal_50e10db5{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsNormal_50e10db5{border-right-color:rgba(0,0,0,0)}[dir='ltr'] .msGridColHeaderElemBgColorsNormal_50e10db5{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormal_50e10db5{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.msGridColHeaderElemHoverBgColorsNormal_50e10db5{color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsNormal_50e10db5{border-right-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsNormal_50e10db5{border-left-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}.ms-core-needIEFilter .msGridColHeaderElemHoverBgColorsNormal_50e10db5{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridColElemColorsClickNormal_50e10db5{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickNormal_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickNormal_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderNormalHover_50e10db5{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsNormalHover_50e10db5{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsNormalHover_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormalHover_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsNormalHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormalHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsNormalHover_50e10db5{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsNormalHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsNormalHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickNormalHover_50e10db5{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickNormalHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickNormalHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderPartSelected_50e10db5{font-size:1em;font-weight:normal;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderPartSelected_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderPartSelected_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderPartSelected_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderPartSelected_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsPartSelected_50e10db5{background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelected_50e10db5{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelected_50e10db5{border-right-color:rgba(0,0,0,0)}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelected_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelected_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsPartSelected_50e10db5{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsPartSelected_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsPartSelected_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickPartSelected_50e10db5{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickPartSelected_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickPartSelected_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderPartSelectedHover_50e10db5{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsPartSelectedHover_50e10db5{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelectedHover_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelectedHover_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelectedHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelectedHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsPartSelectedHover_50e10db5{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsPartSelectedHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsPartSelectedHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickPartSelectedHover_50e10db5{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickPartSelectedHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickPartSelectedHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderAllSelected_50e10db5{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderAllSelected_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderAllSelected_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderAllSelected_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderAllSelected_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridColHeaderElemBgColorsAllSelected_50e10db5{background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelected_50e10db5{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelected_50e10db5{border-right-color:rgba(0,0,0,0)}.msGridColHeaderElemHoverBgColorsAllSelected_50e10db5{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsAllSelected_50e10db5{border-right-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsAllSelected_50e10db5{border-left-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}.msGridColElemColorsClickAllSelected_50e10db5{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickAllSelected_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickAllSelected_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderAllSelectedHover_50e10db5{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsAllSelectedHover_50e10db5{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelectedHover_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelectedHover_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelectedHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelectedHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsAllSelectedHover_50e10db5{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsAllSelectedHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsAllSelectedHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickAllSelectedHover_50e10db5{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickAllSelectedHover_50e10db5{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickAllSelectedHover_50e10db5{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridRowHeaderNormal_50e10db5{border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridRowHeaderNormalHover_50e10db5,.msGridRowHeaderPartSelected_50e10db5,.msGridRowHeaderPartSelectedHover_50e10db5,.msGridRowHeaderAllSelected_50e10db5,.msGridRowHeaderAllSelectedHover_50e10db5{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridSplitter_50e10db5{border-top-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitter_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitter_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ms-core-needIEFilter .msGridSplitter_50e10db5{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandle_50e10db5{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandle_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitterHandle_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridSplitterHandle_50e10db5{border-right-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='rtl'] .msGridSplitterHandle_50e10db5{border-left-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterHandle_50e10db5{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHover_50e10db5{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitterHover_50e10db5{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitterHover_50e10db5{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterHover_50e10db5{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandleHover_50e10db5{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleHover_50e10db5{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterHandleHover_50e10db5{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleHover_50e10db5{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSplitterHandleHover_50e10db5{border-left-color:rgba(0,0,0,0)}.ms-core-needIEFilter .msGridSplitterHandleHover_50e10db5{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterDrag_50e10db5{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitterDrag_50e10db5{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterDrag_50e10db5{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterDrag_50e10db5{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandleDrag_50e10db5{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleDrag_50e10db5{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterHandleDrag_50e10db5{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleDrag_50e10db5{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSplitterHandleDrag_50e10db5{border-left-color:rgba(0,0,0,0)}.ms-core-needIEFilter .msGridSplitterHandleDrag_50e10db5{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.spGridControlFocusElement_50e10db5:focus{outline:none}input[type='text'].spGridControlEditbox_50e10db5,.spGridControlEditbox_50e10db5,.spGridControlFocusElement_50e10db5{font-family:inherit;font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;border:0px;padding:2px 6px 0;z-index:30;overflow:hidden;outline:none}[dir='ltr'] input[type='text'].spGridControlEditbox_50e10db5.inputIsNumber_50e10db5,[dir='ltr'] .spGridControlEditbox_50e10db5.inputIsNumber_50e10db5,[dir='ltr'] .spGridControlFocusElement_50e10db5.inputIsNumber_50e10db5{text-align:right}[dir='rtl'] input[type='text'].spGridControlEditbox_50e10db5.inputIsNumber_50e10db5,[dir='rtl'] .spGridControlEditbox_50e10db5.inputIsNumber_50e10db5,[dir='rtl'] .spGridControlFocusElement_50e10db5.inputIsNumber_50e10db5{text-align:left}input[type='text'].spGridControlEditbox_50e10db5.inputIsTitle_50e10db5,.spGridControlEditbox_50e10db5.inputIsTitle_50e10db5,.spGridControlFocusElement_50e10db5.inputIsTitle_50e10db5{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:600}input[type='text'].spGridControlEditbox_50e10db5.spGridControlEditboxDynamicHeight_50e10db5,.spGridControlEditbox_50e10db5.spGridControlEditboxDynamicHeight_50e10db5,.spGridControlFocusElement_50e10db5.spGridControlEditboxDynamicHeight_50e10db5{padding-top:0}input[type='text'].spGridControlEditbox_50e10db5.stickyEditor_50e10db5,.spGridControlEditbox_50e10db5.stickyEditor_50e10db5,.spGridControlFocusElement_50e10db5.stickyEditor_50e10db5{z-index:1020}input[type='text'].spGridControlEditbox_50e10db5::-ms-clear{display:none}.jsgridControlMultilineTextarea_50e10db5{font-family:inherit;font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;border:0px;padding:2px 6px 0;z-index:30;outline:none;padding-bottom:2px}.jsgridControlRteContainer_50e10db5{z-index:30;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgridControlRteContainer_50e10db5 .ms-shadow{-webkit-box-shadow:0px 0px 7px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 7px 0px rgba(0,0,0,0.47)}.msRteStateField_50e10db5{padding:1px 0}.msRteStateField_50e10db5 div:first-child{padding:1px 0}.ms-grid-group1{background-color:#0072c6}.ms-grid-group2{background-color:#00485b}.ms-grid-group3{background-color:#288054}.ms-grid-group4{background-color:#767956}.ms-grid-group5{background-color:#ed0033}.ms-grid-group6{background-color:#682a7a}.ms-grid-group7{background-color:#0072c6}.ms-grid-group8{background-color:#00485b}.ms-grid-group9{background-color:#288054}.outer-scroll-bar{position:relative;background-color:#e6e8eb;top:0px}[dir='ltr'] .outer-scroll-bar{left:0px}[dir='rtl'] .outer-scroll-bar{right:0px}.inner-scroll-bar{border-top:1px solid #f5f6f7;border-bottom:1px solid #f5f6f7;background-color:#f0f0f0;position:relative;top:1px}[dir='ltr'] .inner-scroll-bar{border-right:1px solid #f8f9f9}[dir='rtl'] .inner-scroll-bar{border-left:1px solid #f8f9f9}[dir='ltr'] .inner-scroll-bar{border-left:1px solid #f5f6f7}[dir='rtl'] .inner-scroll-bar{border-right:1px solid #f5f6f7}[dir='ltr'] .inner-scroll-bar{left:1px}[dir='rtl'] .inner-scroll-bar{right:1px}.scroll-bar-cell{border:1px solid #f6f6f6;background-color:#d5dded}.scroll-bar-inner-arrow-cell{border:1px solid transparent}.scroll-bar-arrow-cell{border:1px solid transparent;position:absolute;top:0px}[dir='ltr'] .scroll-bar-arrow-cell{left:0px}[dir='rtl'] .scroll-bar-arrow-cell{right:0px}.scroll-bar-outer-box{border:1px solid #a3a6ab;background-color:#eeeff2;position:absolute;top:0px}[dir='ltr'] .scroll-bar-outer-box{left:0px}[dir='rtl'] .scroll-bar-outer-box{right:0px}.scroll-bar-background-main{background-color:#f2f3f5}.scroll-bar-background-shade{background-color:#edeef0}.scroll-bar-inner-box-main{background-color:#dbdfe5}.scroll-bar-inner-box-shade{background-color:#e5e8ec}.scroll-bar-arrow{border:0px;padding:0px;text-align:center;vertical-align:top}.scroll-bar-grip{position:absolute;top:0px;border-color:#a7aaaf;background-color:#fefefe}[dir='ltr'] .scroll-bar-grip{left:0px}[dir='rtl'] .scroll-bar-grip{right:0px}.horiz-scroll-bar-bg-block{height:100%}[dir='ltr'] .horiz-scroll-bar-bg-block{float:left}[dir='rtl'] .horiz-scroll-bar-bg-block{float:right}.horiz-scroll-bar-arrow-cell{top:-2px}.horiz-scroll-bar-outer-box{top:-1px}.horiz-scroll-bar-grip{height:5px;width:1px}[dir='ltr'] .horiz-scroll-bar-grip{border-left-style:solid}[dir='rtl'] .horiz-scroll-bar-grip{border-right-style:solid}[dir='ltr'] .horiz-scroll-bar-grip{border-left-width:1px}[dir='rtl'] .horiz-scroll-bar-grip{border-right-width:1px}[dir='ltr'] .vert-scroll-bar-inner-box-main{float:right}[dir='rtl'] .vert-scroll-bar-inner-box-main{float:left}[dir='ltr'] .vert-scroll-bar-inner-box-shade{float:left}[dir='rtl'] .vert-scroll-bar-inner-box-shade{float:right}[dir='ltr'] .vert-scroll-bar-background-main{float:right}[dir='rtl'] .vert-scroll-bar-background-main{float:left}[dir='ltr'] .vert-scroll-bar-background-shade{float:left}[dir='rtl'] .vert-scroll-bar-background-shade{float:right}[dir='ltr'] .vert-scroll-bar-arrow-cell{left:-2px}[dir='rtl'] .vert-scroll-bar-arrow-cell{right:-2px}[dir='ltr'] .vert-scroll-bar-outer-box{left:-1px}[dir='rtl'] .vert-scroll-bar-outer-box{right:-1px}.vert-scroll-bar-grip{border-top:1px solid;height:1px;width:5px}.clip6x9,.clip9x6,.clip11x11,.clip13x13,.clip16x16{position:relative;overflow:hidden}.clip6x9{width:6px;height:9px}.clip9x6{width:9px;height:6px}.clip11x11{width:11px;height:11px}.clip13x13{width:13px;height:13px}.clip16x16{width:16px;height:16px}.clip6x9 img,.clip6x9 input,.clip9x6 img,.clip9x6 input,.clip11x11 img,.clip11x11 input,.clip13x13 img,.clip13x13 input,.clip16x16 img,.clip16x16 input{position:absolute;margin:0;padding:0;width:auto;height:auto}.jsgridcluster_editheader{top:0}[dir='ltr'] .jsgridcluster_editheader{left:0}[dir='rtl'] .jsgridcluster_editheader{right:0}.jsgridcluster_newrowheader{top:0}[dir='ltr'] .jsgridcluster_newrowheader{left:-16px}[dir='rtl'] .jsgridcluster_newrowheader{right:-16px}.jsgridcluster_conflictheader{top:-16px}[dir='ltr'] .jsgridcluster_conflictheader{left:0}[dir='rtl'] .jsgridcluster_conflictheader{right:0}.jsgridcluster_transferheader{top:-16px}[dir='ltr'] .jsgridcluster_transferheader{left:-16px}[dir='rtl'] .jsgridcluster_transferheader{right:-16px}.jsgridcluster_cell-error{top:0}[dir='ltr'] .jsgridcluster_cell-error{left:-32px}[dir='rtl'] .jsgridcluster_cell-error{right:-32px}.jsgridcluster_jsgrid-header-filter-icon{top:-16px}[dir='ltr'] .jsgridcluster_jsgrid-header-filter-icon{left:-32px}[dir='rtl'] .jsgridcluster_jsgrid-header-filter-icon{right:-32px}.jsgridcluster_scrollbar-mousein-rightarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-rightarrow{left:0}[dir='rtl'] .jsgridcluster_scrollbar-mousein-rightarrow{right:0}.jsgridcluster_scrollbar-mousein-downarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-downarrow{left:-6px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-downarrow{right:-6px}.jsgridcluster_scrollbar-mousein-uparrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-uparrow{left:-15px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-uparrow{right:-15px}.jsgridcluster_scrollbar-mousein-leftarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-leftarrow{left:-24px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-leftarrow{right:-24px}.jsgridcluster_scrollbar-mouseout-rightarrow{top:-27px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-rightarrow{left:-32px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-rightarrow{right:-32px}.jsgridcluster_scrollbar-mouseout-uparrow{top:-27px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-uparrow{left:-38px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-uparrow{right:-38px}.jsgridcluster_scrollbar-mouseout-downarrow{top:-33px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-downarrow{left:-38px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-downarrow{right:-38px}.jsgridcluster_scrollbar-mouseout-leftarrow{top:-41px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-leftarrow{left:0}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-leftarrow{right:0}.jsgridcluster_jsgrid-up-arrow{top:-38px}[dir='ltr'] .jsgridcluster_jsgrid-up-arrow{left:-6px}[dir='rtl'] .jsgridcluster_jsgrid-up-arrow{right:-6px}.jsgridcluster_jsgrid-down-arrow{top:-44px}[dir='ltr'] .jsgridcluster_jsgrid-down-arrow{left:-6px}[dir='rtl'] .jsgridcluster_jsgrid-down-arrow{right:-6px}\n"},{"rawString":".spGridSelectAllIconContainer_fb5959d0{text-align:center;vertical-align:middle;min-height:25px;width:25px}.spGridSelectAllIcon_fb5959d0{font-size:16px}.spGridCell_fb5959d0{padding-top:11px;padding-bottom:11px;-webkit-box-sizing:border-box;box-sizing:border-box;min-height:42px}[dir='ltr'] .spGridCell_fb5959d0{padding-left:12px}[dir='rtl'] .spGridCell_fb5959d0{padding-right:12px}[dir='ltr'] .spGridCell_fb5959d0{padding-right:8px}[dir='rtl'] .spGridCell_fb5959d0{padding-left:8px}.tableColumnHeadersRow_fb5959d0 th{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.errorAsterisk_fb5959d0{color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":"}[dir='ltr'] .errorAsterisk_fb5959d0{padding-left:4px}[dir='rtl'] .errorAsterisk_fb5959d0{padding-right:4px}.gridSelectAllIconContainer_fb5959d0{padding:0;text-align:center;vertical-align:middle;min-height:25px;width:58px;border-bottom:2px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridSelectAllIconContainer_fb5959d0.selectAllCheckMarkCell_fb5959d0{-webkit-box-sizing:border-box;box-sizing:border-box}[dir='ltr'] .gridSelectAllIconContainer_fb5959d0.selectAllCheckMarkCell_fb5959d0{padding-left:30px}[dir='rtl'] .gridSelectAllIconContainer_fb5959d0.selectAllCheckMarkCell_fb5959d0{padding-right:30px}.gridSelectAllIconContainer_fb5959d0.selectAllCheckMarkCell_fb5959d0 .selectionCheckIconsWrapper_fb5959d0{visibility:visible}.gridSelectAllIconContainer_fb5959d0.selectAllCheckMarkCell_fb5959d0:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";outline-offset:-1px}.gridSelectAllIconContainer_fb5959d0.selectAllCheckMarkCell_fb5959d0:focus .selectionCheckIcon_fb5959d0{visibility:visible}.gridSelectAllIconContainer_fb5959d0.allRowsSelected_fb5959d0 .selectionCheckIconsWrapper_fb5959d0:before{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.gridSelectAllIconContainer_fb5959d0.allRowsSelected_fb5959d0 .selectionCheckIcon_fb5959d0,.gridSelectAllIconContainer_fb5959d0.allRowsSelected_fb5959d0 .selectionCircleIcon_fb5959d0{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridSelectAllIconContainer_fb5959d0.allRowsSelected_fb5959d0 .selectionCheckIcon_fb5959d0{visibility:visible;font-weight:900}.headerStateContainer_fb5959d0{-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;width:20px;height:100%}.headerStateContainer_fb5959d0.hasStateElements_fb5959d0{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.headerStateContainer_fb5959d0.hasStateElements_fb5959d0 .headerStateBar_fb5959d0{display:none}.headerStateBar_fb5959d0{width:4px;border-radius:2px;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.selectionCheckMark_fb5959d0,.inlineNewItemAddIconContainer_fb5959d0{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;vertical-align:bottom;width:36px;height:100%}.selectionCheckIconsWrapper_fb5959d0{width:18px;height:18px;line-height:1;position:relative;visibility:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.selectionCheckIconsWrapper_fb5959d0:before{content:'';position:absolute;top:1px;right:1px;bottom:1px;left:1px;border-radius:50%;opacity:1;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.selectionCheckIconsWrapper_fb5959d0:hover .selectionCheckIcon_fb5959d0{visibility:visible}.selectionCircleIcon_fb5959d0,.selectionCheckIcon_fb5959d0{display:inline-block;position:absolute;left:0;top:0;width:18px;height:18px;text-align:center;vertical-align:middle;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.selectionCircleIcon_fb5959d0{font-size:18px}.selectionCheckIcon_fb5959d0{font-size:16px;visibility:hidden;left:0.5px}.stickyEditor_fb5959d0.selectedEditor_fb5959d0:before{z-index:1010}.selectedEditor_fb5959d0:after{pointer-events:none;content:'';position:absolute;left:0px;top:0px;bottom:0px;right:0px;border-radius:2px;border-width:2px;border-style:solid;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";-o-border-image:initial;border-image:initial;z-index:10}.inlineNewItemAddIcon_fb5959d0{font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.inlineNewItemAddIcon_fb5959d0:hover{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.inlineNewItemAddIconContainer_fb5959d0{display:none}.inlineNewItemPlaceHolder_fb5959d0{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:600;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";display:none}:not(.rowIsActive_fb5959d0).inLineNewItemRow_fb5959d0 .gridCell_fb5959d0{border-bottom:0px}:not(.rowIsActive_fb5959d0).inLineNewItemRow_fb5959d0 .gridCell_fb5959d0:after{content:none}:not(.rowIsActive_fb5959d0).inLineNewItemRow_fb5959d0 .inlineNewItemAddIconContainer_fb5959d0{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}:not(.rowIsActive_fb5959d0).inLineNewItemRow_fb5959d0 :not(.cellIsFocusedAndSelected_fb5959d0) .inlineNewItemPlaceHolder_fb5959d0{display:inline-block}:not(.rowIsActive_fb5959d0).inLineNewItemRow_fb5959d0 .selectionCheckMark_fb5959d0,:not(.rowIsActive_fb5959d0).inLineNewItemRow_fb5959d0 .headerStateBar_fb5959d0{display:none}:not(.rowIsActive_fb5959d0).inLineNewItemRow_fb5959d0:hover .inlineNewItemPlaceHolder_fb5959d0{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.gridCell_fb5959d0{padding:8px;min-height:28px;height:28px;vertical-align:middle;color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-size:12px;border-bottom:2px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";position:relative}[dir='ltr'] .gridCell_fb5959d0{text-align:left}[dir='rtl'] .gridCell_fb5959d0{text-align:right}.gridCell_fb5959d0:after{content:'';position:absolute;width:1px;right:0px;top:0;bottom:0;margin:8px 0;border-radius:1px;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridCell_fb5959d0.gridStickySecondDataColumn_fb5959d0:after{right:2px}[dir='rtl'] .gridCell_fb5959d0:after{right:unset;left:0}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellIsSticky_fb5959d0:before{z-index:1010}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:before{content:'';position:absolute;z-index:10;top:0;left:0;right:0;bottom:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellLeftBorder_fb5959d0:before{border-left-width:2px;border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:dashed}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellRightBorder_fb5959d0:before{border-right-width:2px;border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:dashed;width:100% !important}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-width:2px;border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:dashed}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-width:2px;border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:dashed;height:100% !important}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellLeftBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-left-radius:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellLeftBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-left-radius:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellRightBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-right-radius:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0.cellRightBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-right-radius:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellLeftBorder_fb5959d0):before{border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:solid;border-left-width:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellTopBorder_fb5959d0):before{border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:solid;border-top-width:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellTopBorder_fb5959d0):not(.cellLeftBorder_fb5959d0):before{border-top-left-radius:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellTopBorder_fb5959d0):not(.cellRightBorder_fb5959d0):before{border-top-right-radius:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellBottomBorder_fb5959d0):before{border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:solid;border-bottom-width:2px;height:100%}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellBottomBorder_fb5959d0):not(.cellLeftBorder_fb5959d0):before{border-bottom-left-radius:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellBottomBorder_fb5959d0):not(.cellRightBorder_fb5959d0):before{border-bottom-right-radius:2px}.gridCell_fb5959d0.cellHasCopyBorder_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellRightBorder_fb5959d0):before{border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:solid;border-right-width:2px}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellIsSticky_fb5959d0:before{z-index:1010}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.readOnlySelectionFrame_fb5959d0:before{border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":" !important}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0:before{content:'';position:absolute;z-index:10;top:0px;left:0;right:0;bottom:0;width:100%;height:calc(100% + 2px);-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0px}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellLeftBorder_fb5959d0:before{border-left-width:2px;border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-left-style:solid}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellLeftBorder_fb5959d0:before{border-left-color:Highlight}}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellRightBorder_fb5959d0:before{border-right-width:2px;border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-style:solid;width:100% !important}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellRightBorder_fb5959d0:before{border-right-color:Highlight}}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-width:2px;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-style:solid}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-color:Highlight}}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-width:2px;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-style:solid;height:100% !important}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-color:Highlight}}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellLeftBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-left-radius:2px}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellLeftBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-left-radius:2px}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellRightBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-right-radius:2px}.gridCell_fb5959d0.cellHasFillDownBorder_fb5959d0.cellRightBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-right-radius:2px}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellIsSticky_fb5959d0:before{z-index:1010}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.readOnlySelectionFrame_fb5959d0:before{border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":" !important}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0:before{content:'';position:absolute;z-index:10;top:0px;left:0;right:0;bottom:0;width:100%;height:calc(100% + 2px);-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0px}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellLeftBorder_fb5959d0:before{border-left-width:2px;border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-left-style:solid}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellLeftBorder_fb5959d0:before{border-left-color:Highlight}}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellRightBorder_fb5959d0:before{border-right-width:2px;border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-style:solid;width:100% !important}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellRightBorder_fb5959d0:before{border-right-color:Highlight}}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-width:2px;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-style:solid}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-color:Highlight}}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-width:2px;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-style:solid;height:100% !important}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-color:Highlight}}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellLeftBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-left-radius:2px}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellLeftBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-left-radius:2px}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellRightBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-right-radius:2px}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellRightBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-right-radius:2px}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellHasCopyBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-style:dashed}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellHasCopyBorder_fb5959d0.cellBottomBorder_fb5959d0:before{border-bottom-color:Highlight}}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellHasCopyBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-style:dashed}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellHasCopyBorder_fb5959d0.cellTopBorder_fb5959d0:before{border-top-color:Highlight}}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellHasCopyBorder_fb5959d0.cellLeftBorder_fb5959d0:before{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-left-style:dashed}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellHasCopyBorder_fb5959d0.cellLeftBorder_fb5959d0:before{border-left-color:Highlight}}.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellHasCopyBorder_fb5959d0.cellRightBorder_fb5959d0:before{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-style:dashed}@media screen and (-ms-high-contrast: active){.gridCell_fb5959d0.cellHasSelectionBorder_fb5959d0.cellHasCopyBorder_fb5959d0.cellRightBorder_fb5959d0:before{border-right-color:Highlight}}.gridCell_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):not(.firstCell_fb5959d0):hover:before{content:'';position:absolute;z-index:10;top:0;left:0;right:0;bottom:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;border-width:2px;border-style:solid;border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-radius:2px}.gridCell_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):not(.firstCell_fb5959d0):hover.cellHasError_fb5959d0:before{border-color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":"}.gridCell_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):not(.firstCell_fb5959d0):hover:after{content:none}:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellIsSelected_fb5959d0){background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridCell_fb5959d0:not(.firstCell_fb5959d0):hover.cellHasError_fb5959d0:before{border-color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":" !important}.gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{content:attr(data-error-message);color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":";font-style:italic;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:calc(100% - 8px);background-color:transparent}[dir='ltr'] .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{border-right:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='rtl'] .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{border-left:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridCell_fb5959d0.cellIsFocusedAndSelected_fb5959d0:not(.firstCell_fb5959d0){background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.gridCell_fb5959d0.cellIsFocusedAndSelected_fb5959d0:not(.firstCell_fb5959d0):after{content:none}.gridCell_fb5959d0.lastCell_fb5959d0{visibility:hidden}.gridCell_fb5959d0.firstCell_fb5959d0{padding:8px 0;font-size:0px}.gridCell_fb5959d0.firstCell_fb5959d0.cellHasSelectionBorder_fb5959d0 .selectionCheckIcon_fb5959d0,.gridCell_fb5959d0.firstCell_fb5959d0.cellHasSelectionBorder_fb5959d0 .selectionCircleIcon_fb5959d0{visibility:visible}.gridCell_fb5959d0.firstCell_fb5959d0:after{content:none}.gridCell_fb5959d0.cellHasError_fb5959d0{color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":"}.gridCell_fb5959d0.imageTypeCell_fb5959d0{padding:4px;font-size:0 !important}.gridCell_fb5959d0.customFormatterCell_fb5959d0{padding:4px;min-height:36px}.tableParentDiv_fb5959d0:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellLeftBorder_fb5959d0):before{border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:solid;border-left-width:2px}.tableParentDiv_fb5959d0:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellTopBorder_fb5959d0):before{border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:solid;border-top-width:2px}.tableParentDiv_fb5959d0:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellTopBorder_fb5959d0):not(.cellLeftBorder_fb5959d0):before{border-top-left-radius:2px}.tableParentDiv_fb5959d0:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellTopBorder_fb5959d0):not(.cellRightBorder_fb5959d0):before{border-top-right-radius:2px}.tableParentDiv_fb5959d0:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellBottomBorder_fb5959d0):before{border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:solid;border-bottom-width:2px;height:100%}.tableParentDiv_fb5959d0:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellBottomBorder_fb5959d0):not(.cellLeftBorder_fb5959d0):before{border-bottom-left-radius:2px}.tableParentDiv_fb5959d0:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellBottomBorder_fb5959d0):not(.cellRightBorder_fb5959d0):before{border-bottom-right-radius:2px}.tableParentDiv_fb5959d0:not(.tableHasMouseDown_fb5959d0) .gridCell_fb5959d0:not(.firstCell_fb5959d0):hover:not(.cellRightBorder_fb5959d0):before{border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:solid;border-right-width:2px}.gridRow_fb5959d0.rowIsSelected_fb5959d0{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridRow_fb5959d0.rowIsSelected_fb5959d0 .gridCell_fb5959d0:after{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.gridRow_fb5959d0.rowIsSelected_fb5959d0 .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{background-color:transparent}[dir='ltr'] .gridRow_fb5959d0.rowIsSelected_fb5959d0 .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{border-right-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}[dir='rtl'] .gridRow_fb5959d0.rowIsSelected_fb5959d0 .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{border-left-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.gridRow_fb5959d0.rowIsSelected_fb5959d0 .selectionCheckIconsWrapper_fb5959d0{visibility:visible}.gridRow_fb5959d0.rowIsSelected_fb5959d0 .selectionCheckIconsWrapper_fb5959d0:before{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.gridRow_fb5959d0.rowIsSelected_fb5959d0 .selectionCheckIcon_fb5959d0,.gridRow_fb5959d0.rowIsSelected_fb5959d0 .selectionCircleIcon_fb5959d0{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_fb5959d0.rowIsSelected_fb5959d0 .selectionCheckIcon_fb5959d0{visibility:visible;font-weight:900}.gridRow_fb5959d0.rowIsSelected_fb5959d0 .gridCell_fb5959d0.firstCell_fb5959d0.cellIsFocusedAndSelected_fb5959d0{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_fb5959d0.rowIsSelected_fb5959d0 .gridCell_fb5959d0.gridStickyDataColumn_fb5959d0:not(.cellIsFocusedAndSelected_fb5959d0),.gridRow_fb5959d0.rowIsSelected_fb5959d0 .gridCell_fb5959d0.gridStickyCheckColumn_fb5959d0:not(.cellIsFocusedAndSelected_fb5959d0){background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridRow_fb5959d0:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridRow_fb5959d0:hover .gridCell_fb5959d0:after{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_fb5959d0:hover .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{background-color:transparent}[dir='ltr'] .gridRow_fb5959d0:hover .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{border-right-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}[dir='rtl'] .gridRow_fb5959d0:hover .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{border-left-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_fb5959d0:hover .gridStickyDataColumn_fb5959d0:not(.cellIsFocusedAndSelected_fb5959d0),.gridRow_fb5959d0:hover .gridStickyCheckColumn_fb5959d0{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridRow_fb5959d0:hover .gridCell_fb5959d0{border-bottom-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.gridRow_fb5959d0:hover .selectionCheckIconsWrapper_fb5959d0{visibility:visible}.gridRow_fb5959d0:hover.rowIsSelected_fb5959d0{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_fb5959d0:hover.rowIsSelected_fb5959d0 .gridCell_fb5959d0:after{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.gridRow_fb5959d0:hover.rowIsSelected_fb5959d0 .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{background-color:transparent}[dir='ltr'] .gridRow_fb5959d0:hover.rowIsSelected_fb5959d0 .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .gridRow_fb5959d0:hover.rowIsSelected_fb5959d0 .gridCell_fb5959d0.cellHasError_fb5959d0.hasErrorData_fb5959d0[data-error-message]::after{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.gridRow_fb5959d0:hover.rowIsSelected_fb5959d0 .gridStickyDataColumn_fb5959d0:not(.cellIsFocusedAndSelected_fb5959d0),.gridRow_fb5959d0:hover.rowIsSelected_fb5959d0 .gridStickyCheckColumn_fb5959d0{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_fb5959d0:not(.rowIsSelected_fb5959d0) .cellIsSelected_fb5959d0{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridRow_fb5959d0:not(.rowIsSelected_fb5959d0) .cellIsSelected_fb5959d0:after{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.gridRow_fb5959d0.rowHasOnlyOneCellSelected_fb5959d0 .selectionCircleIcon_fb5959d0{visibility:visible}.gridRow_fb5959d0.rowHasOnlyOneCellSelected_fb5959d0 .cellHasSelectionBorder_fb5959d0.cellHasError_fb5959d0:before{border-color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":" !important}.gridRow_fb5959d0+.gridRow_fb5959d0:hover .gridCell_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):before{content:'';position:absolute;top:-2px;left:0;right:0;height:2px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_fb5959d0+.gridRow_fb5959d0:hover .gridCell_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):not(.firstCell_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):hover:before{top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:transparent;-webkit-box-shadow:0px -2px 0px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";box-shadow:0px -2px 0px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.tableHasMouseDown_fb5959d0 .gridRow_fb5959d0:hover .gridCell_fb5959d0.gridCell_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):hover:before{content:none}[dir='ltr'] .gridStickyChromeLeft_fb5959d0{left:32px}[dir='rtl'] .gridStickyChromeLeft_fb5959d0{right:32px}[dir='ltr'] .gridStickyChromelessLeft_fb5959d0{left:0px}[dir='rtl'] .gridStickyChromelessLeft_fb5959d0{right:0px}.gridStickyCheckColumn_fb5959d0,.gridStickyCheckColumnHeader_fb5959d0{position:-webkit-sticky;position:sticky;will-change:transform;z-index:1015}.gridStickyCheckColumn_fb5959d0.gridStickyCheckColumnHeader_fb5959d0{z-index:1035 !important}[dir='ltr'] .gridStickyDataLeft_fb5959d0{left:90px}[dir='rtl'] .gridStickyDataLeft_fb5959d0{right:90px}[dir='ltr'] .gridStickyDataLeftChromeless_fb5959d0{left:58px}[dir='rtl'] .gridStickyDataLeftChromeless_fb5959d0{right:58px}.gridStickyDataColumn_fb5959d0,.gridStickyDataColumnHeader_fb5959d0{position:-webkit-sticky;position:sticky;will-change:transform;z-index:1015}.gridStickyDataColumn_fb5959d0,.gridStickyCheckColumn_fb5959d0{border-left:none;border-right:none;border-top:none}.gridStickyDataColumn_fb5959d0.gridStickyDataColumnHeader_fb5959d0{z-index:1035 !important}[dir='ltr'] .stickyLeftEdgeKeeperContainerWithChrome_fb5959d0{left:32px}[dir='rtl'] .stickyLeftEdgeKeeperContainerWithChrome_fb5959d0{right:32px}[dir='ltr'] .stickyLeftEdgeKeeperContainerChromeless_fb5959d0{left:0px}[dir='rtl'] .stickyLeftEdgeKeeperContainerChromeless_fb5959d0{right:0px}.stickyLeftEdgeKeeperContainer_fb5959d0{position:-webkit-sticky;position:sticky;will-change:transform;height:0px;overflow-y:visible;z-index:999}[dir='ltr'] .stickyLeftEdgeKeeperWithChrome_fb5959d0{left:-33px}[dir='rtl'] .stickyLeftEdgeKeeperWithChrome_fb5959d0{right:-33px}[dir='ltr'] .stickyLeftEdgeKeeperChromeless_fb5959d0{left:-1px}[dir='rtl'] .stickyLeftEdgeKeeperChromeless_fb5959d0{right:-1px}.stickyLeftEdgeKeeper_fb5959d0{background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";width:calc(100% + 28px);position:absolute}.stickyTableHeaderLeftEdgeKeeper_fb5959d0{height:46px}.stickyColumnShadow_fb5959d0{width:14px;position:absolute;background:-webkit-gradient(linear, left top, right top, from(rgba(0,0,0,0.08)), color-stop(54.85%, rgba(0,0,0,0)));background:linear-gradient(90deg, rgba(0,0,0,0.08) 0%, rgba(0,0,0,0) 54.85%);content:'';-webkit-transition:opacity 0.15s ease-in-out;transition:opacity 0.15s ease-in-out}.stickyColumnShadowRtl_fb5959d0{width:14px;position:absolute;background:-webkit-gradient(linear, right top, left top, from(rgba(0,0,0,0.08)), color-stop(54.85%, rgba(0,0,0,0)));background:linear-gradient(270deg, rgba(0,0,0,0.08) 0%, rgba(0,0,0,0) 54.85%);content:'';-webkit-transition:opacity 0.15s ease-in-out;transition:opacity 0.15s ease-in-out}@media screen and (-ms-high-contrast: active){.stickyColumnShadow_fb5959d0{border-left:1px solid "},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":"}.gridCell_fb5959d0::after{-ms-high-contrast-adjust:none}.selectionCheckIcon_fb5959d0{-ms-high-contrast-adjust:none}.gridRow_fb5959d0+.gridRow_fb5959d0:hover .gridCell_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:transparent;-webkit-box-shadow:0px 2px 0px WindowText;box-shadow:0px 2px 0px WindowText}.gridRow_fb5959d0+.gridRow_fb5959d0:hover .gridCell_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0):not(.firstCell_fb5959d0):hover:before{content:'';-webkit-box-shadow:0px -2px 0px WindowText;box-shadow:0px -2px 0px WindowText;border-color:WindowText}}@supports (-ms-ime-align: auto){.gridSelectAllIconContainer_fb5959d0::after{content:'';position:absolute;bottom:-29px;height:2px;left:0;right:0;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridCell_fb5959d0:not(.firstCell_fb5959d0){height:100%}.gridCell_fb5959d0.gridStickyCheckColumn_fb5959d0::before,.gridCell_fb5959d0.gridStickyDataColumn_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0)::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:transparent;-webkit-box-shadow:0px 2px 0px "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";box-shadow:0px 2px 0px "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}}@media screen and (-ms-high-contrast: active){.gridSelectAllIconContainer_fb5959d0::after{background-color:WindowText}.gridCell_fb5959d0.gridStickyCheckColumn_fb5959d0::before,.gridCell_fb5959d0.gridStickyDataColumn_fb5959d0:not(.cellHasSelectionBorder_fb5959d0):not(.cellHasCopyBorder_fb5959d0):not(.cellHasFillDownBorder_fb5959d0)::before{-ms-high-contrast-adjust:none}}\n"},{"rawString":".msGridEditControlContainer_9d3f1c8c{position:absolute;visibility:hidden;border:0px;top:0px;overflow-x:visible;margin-left:-1px}.msGridEditControlEditBox_9d3f1c8c{visibility:hidden;position:absolute;top:0px;left:0px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.ms-BasePicker-text .ms-BasePicker-input{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.errorWidgetContainer_9d3f1c8c{z-index:20;visibility:hidden;font-size:12px;position:absolute;background-color:"},{"theme":"blockingBackground","defaultValue":"#FDE7E9"},{"rawString":";border:1px solid "},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":";border-radius:"},{"theme":"roundedCorner2","defaultValue":"2px"},{"rawString":";padding:5px 8px;color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":"}.errorWidgetContainer_9d3f1c8c.stickyZIndex_9d3f1c8c{z-index:1000}.errorWidgetContainer_9d3f1c8c.widgetExpanded_9d3f1c8c{visibility:visible}\n"},{"rawString":".checkBox_e3c97535{z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%)}[dir='ltr'] .checkBox_e3c97535{left:50%}[dir='rtl'] .checkBox_e3c97535{right:50%}[dir='ltr'] .checkBox_e3c97535{margin-left:1px}[dir='rtl'] .checkBox_e3c97535{margin-right:1px}\n"},{"rawString":".msGridBaseStyle_8dedee68{font-size:12px;font-family:\"Segoe UI\",\"Segoe UI Web (West European)\",\"Segoe UI\",-apple-system,BlinkMacSystemFont,\"Roboto\",\"Helvetica Neue\",sans-serif}.msGridCell_8dedee68{font-style:normal;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.msGridCellReadonly_8dedee68{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.msGridCellReadonlyFocused_8dedee68{color:"},{"theme":"disabledText","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"buttonBackgroundDisabled","defaultValue":"#f3f2f1"},{"rawString":"}.ms-spgrid-col-header-normal{border-bottom-color:"},{"theme":"menuDivider","defaultValue":"#c8c6c4"},{"rawString":"}.ms-spgrid-col-header-part-selected{border-bottom-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.ms-spgrid-col-header-all-selected{border-bottom-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.ms-newdocument-iconouter{display:inline-block;height:16px;width:16px;position:relative;overflow:hidden;text-align:center;top:4px}.ms-newdocument-icon{left:-91px;top:-196px;position:absolute}.ms-inputBox{border:1px solid "},{"theme":"inputBorder","defaultValue":"#605e5c"},{"rawString":";background-color:"},{"theme":"inputBackground","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"inputText","defaultValue":"#323130"},{"rawString":"}.ms-inputBoxActive,.ms-inputBox.ms-inputBoxActive:hover{border-color:"},{"theme":"focusBorder","defaultValue":"#605e5c"},{"rawString":"}.ms-dlgOverlay{position:absolute;top:0px;width:100%;height:100%;opacity:0.4;background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";display:none}[dir='ltr'] .ms-dlgOverlay{left:0px}[dir='rtl'] .ms-dlgOverlay{right:0px}.ms-dlgFrameContainer{padding:0px 19px 10px;overflow:auto}.ms-dlgTitle{padding:13px 19px 15px;white-space:nowrap;cursor:move;overflow:hidden}.ms-dlgFrameContainerNoPadding{padding:0px;overflow:auto}.ms-dlgTitleNoPadding{padding:0px;white-space:nowrap;cursor:move;overflow:hidden}.ms-dlgFrame{width:100%;height:100%;border:none}.ms-dlgContent{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";position:absolute;background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47)}.ms-dlgContent h1{margin:auto;color:"},{"theme":"bodySubtext","defaultValue":"#605e5c"},{"rawString":";font-weight:200}.ms-dlgContent .ms-accessible,.ms-dlgContent .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.ms-dlgContent .ms-accessible-quickedit,.ms-dlgContent .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.ms-dlgContentNoBorder{border:0px;position:absolute;background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47)}.ms-dlg-heading{font-family:'Segoe UI Semilight', 'Segoe UI', 'Segoe', Tahoma, Helvetica, Arial, sans-serif;font-size:1.46em;color:#444}.ms-dlgTitleText{float:left;overflow:hidden;text-overflow:ellipsis}.ms-dlgContent>.ms-dlgBorder>.ms-dlgTitle>.ms-dlgCloseBtn>.s4-clust{height:16px !important;width:16px !important}.ms-dlgTitleBtns{margin-top:-10px;height:30px;float:right}[dir='ltr'] .ms-dlgTitleBtns{margin-right:-18px}[dir='rtl'] .ms-dlgTitleBtns{margin-left:-18px}.ms-dlgCloseBtn>span{cursor:pointer;border:1px solid transparent}.ms-dlgErrItem{display:inline}[dir='ltr'] .ms-dlgErrItem{padding-right:10px}[dir='rtl'] .ms-dlgErrItem{padding-left:10px}.ms-dlgLoadingTextDiv{padding:0px 0px 16px;white-space:nowrap}.ms-dlgLoadingText{text-align:left;width:100%}[dir='ltr'] .ms-dlgLoadingText{padding-left:3px}[dir='rtl'] .ms-dlgLoadingText{padding-right:3px}.ms-accentText{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-core-pageTitle{font-family:'Segoe UI Light', 'Segoe UI', 'Segoe', Tahoma, Helvetica, Arial, sans-serif;font-size:2.77em;white-space:nowrap}.ms-alignCenter{text-align:center}.ms-vb-icon{white-space:nowrap}img.ms-vb-icon-overlay{height:9px;width:9px}.ms-vb-icon-overlay{border:0px;position:relative;bottom:-2px;height:9px;width:9px}[dir='ltr'] .ms-vb-icon-overlay{left:-7px}[dir='rtl'] .ms-vb-icon-overlay{right:-7px}.ms-jsgrid-rowheader-partselected{border-bottom-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":";border-right-color:#c6c6c6}.jsgrid-control-focuselement:focus{outline:none}\n"},{"rawString":".errorIcon_688672d6{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":";font-size:14px}\n"},{"rawString":".topFrameElement_255975f0{border-top:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px 2px 0 0;z-index:25}.topFrameElement_255975f0.dashedBorder_255975f0{border-top-style:dashed;border-radius:0}.topFrameElement_255975f0.dashedBorderUnfocused_255975f0{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.bottomFrameElement_255975f0{border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:0 0 2px 2px;z-index:25}.bottomFrameElement_255975f0.dashedBorder_255975f0{border-bottom-style:dashed;border-radius:0}.bottomFrameElement_255975f0.dashedBorderUnfocused_255975f0{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.leftFrameElement_255975f0{border-left:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px 0 0 2px;z-index:25}.leftFrameElement_255975f0.dashedBorder_255975f0{border-left-style:dashed;border-radius:0}.leftFrameElement_255975f0.dashedBorderUnfocused_255975f0{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.rightFrameElement_255975f0{border-right:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:0 2px 2px 0;z-index:25}.rightFrameElement_255975f0.dashedBorder_255975f0{border-right-style:dashed;border-radius:0}.rightFrameElement_255975f0.dashedBorderUnfocused_255975f0{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.topFrameElement_255975f0.stickyFrame_255975f0,.bottomFrameElement_255975f0.stickyFrame_255975f0,.leftFrameElement_255975f0.stickyFrame_255975f0,.rightFrameElement_255975f0.stickyFrame_255975f0{z-index:1025}.solidBorder_255975f0{border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.copyFrame_255975f0{z-index:9}.selectionDragHandle_255975f0{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-radius:2px;border-width:1px;border-style:solid;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;z-index:26;cursor:crosshair}.selectionDragHandle_255975f0:after{content:'';position:absolute;width:8px;height:8px;bottom:0}[dir='ltr'] .selectionDragHandle_255975f0:after{right:0}[dir='rtl'] .selectionDragHandle_255975f0:after{left:0}[dir='ltr'] .selectionDragHandle_255975f0.rowSelectionHandle_255975f0:after{left:0}[dir='rtl'] .selectionDragHandle_255975f0.rowSelectionHandle_255975f0:after{right:0}.selectionDragHandle_255975f0.editorIsActive_255975f0{display:none}.selectionDragHandle_255975f0.stickyHandle_255975f0{z-index:1026}[dir='ltr'] .rowSelectionHandle_255975f0 .selectionDragHandleContents_255975f0:after{left:0}[dir='rtl'] .rowSelectionHandle_255975f0 .selectionDragHandleContents_255975f0:after{right:0}.selectionDragHandleContainer_255975f0{margin-left:-2px;height:0px;overflow-y:visible}.selectionDragHandleContainer_255975f0.stickyHandle_255975f0{z-index:1026}.selectionDragHandleContainer_255975f0.editorIsActive_255975f0{display:none}.selectionDragHandleContents_255975f0{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-radius:2px;border-width:1px;border-style:solid;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;z-index:26;cursor:crosshair;height:6px;width:6px;position:absolute}.selectionDragHandleContents_255975f0:after{content:'';position:absolute;width:8px;height:8px;bottom:0}[dir='ltr'] .selectionDragHandleContents_255975f0:after{right:0}[dir='rtl'] .selectionDragHandleContents_255975f0:after{left:0}[dir='ltr'] .selectionDragHandleContents_255975f0.rowSelectionHandle_255975f0:after{left:0}[dir='rtl'] .selectionDragHandleContents_255975f0.rowSelectionHandle_255975f0:after{right:0}.readonlySelectionRect_255975f0{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.dragToFillFrame_255975f0{border:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px}@media screen and (-ms-high-contrast: active) and (-ms-high-contrast: active){.selectionDragHandle_255975f0{border-color:Highlight}}@media screen and (-ms-high-contrast: active) and (-ms-high-contrast: active){.selectionDragHandleContents_255975f0{border-color:Highlight}}\n"},{"rawString":".spGridHeaderIconSpan_9b7890bf{font-size:16px}.spGridHeaderCoreContent_9b7890bf{overflow:hidden;text-overflow:none;white-space:nowrap;color:#2e4f69}.gridHeaderCell_9b7890bf{border-bottom:2px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":"}[dir='ltr'] .gridHeaderCell_9b7890bf{border-right-width:0px}[dir='rtl'] .gridHeaderCell_9b7890bf{border-left-width:0px}.gridHeaderCell_9b7890bf:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";outline-offset:-1px}.gridHeaderCell_9b7890bf:active{outline:none}.gridHeaderCell_9b7890bf.columnIsActive_9b7890bf{border-bottom-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":"}.resizeContainer_9b7890bf{-webkit-transition:opacity 0.3s linear 0s;transition:opacity 0.3s linear 0s}.resizeContainer_9b7890bf:after{content:'';position:absolute;left:8px;top:7px;display:block;width:1px;height:28px;background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.resizeContainer_9b7890bf:active:after{-webkit-box-shadow:rgba(0,0,0,0.4) 0px 0px 5px 0px;box-shadow:rgba(0,0,0,0.4) 0px 0px 5px 0px}.renameInputContainer_9b7890bf{height:42px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.renameInputContainer_9b7890bf input{color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";border:1px solid transparent;border-radius:2px;height:32px;font-size:14px;outline:none}[dir='ltr'] .renameInputContainer_9b7890bf input{padding-left:12px}[dir='rtl'] .renameInputContainer_9b7890bf input{padding-right:12px}[dir='ltr'] .renameInputContainer_9b7890bf input{padding-right:8px}[dir='rtl'] .renameInputContainer_9b7890bf input{padding-left:8px}.renameInputContainer_9b7890bf input:focus{border-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":"}@supports (-ms-ime-align: auto){.gridHeaderCell_9b7890bf::after{content:'';position:absolute;bottom:-2px;height:2px;width:100%;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridHeaderCell_9b7890bf.columnIsActive_9b7890bf::after{background-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":"}}@media screen and (-ms-high-contrast: active){.gridHeaderCell_9b7890bf::after{background-color:WindowText}.gridHeaderCell_9b7890bf.columnIsActive_9b7890bf::after{background-color:Highlight}.resizeContainer_9b7890bf::after{background-color:Highlight}.gridHeaderCell_9b7890bf .QuickEditHeaderColumn:hover{color:Highlight}.gridHeaderCell_9b7890bf .QuickEditHeaderColumn:hover .ms-Icon{color:Highlight}}\n"},{"rawString":".folderCover_9a180d18{margin:3px}.blankFolderCover_9a180d18{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";display:inline-block}\n"},{"rawString":".topCollaPlaceHolder_acb4229a{display:-webkit-box;display:-ms-flexbox;display:flex;min-width:13px;height:21px}[dir='ltr'] .topCollaPlaceHolder_acb4229a{padding-right:10px}[dir='rtl'] .topCollaPlaceHolder_acb4229a{padding-left:10px}.topCollaboratorIcon_acb4229a{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_acb4229a{font-weight:700}.topCollaboratorTooltip_acb4229a{padding:0 2px}.userWithTopCollaborator_acb4229a{display:-webkit-box;display:-ms-flexbox;display:flex}.userWithTopCollaborator_acb4229a .topCollaPlaceHolder_acb4229a{min-width:13px}[dir='ltr'] .userWithTopCollaborator_acb4229a .topCollaPlaceHolder_acb4229a{padding-right:7px}[dir='rtl'] .userWithTopCollaborator_acb4229a .topCollaPlaceHolder_acb4229a{padding-left:7px}[dir='ltr'] .columnHeader_acb4229a{margin-left:20px}[dir='rtl'] .columnHeader_acb4229a{margin-right:20px}\n"},{"rawString":".iconContainer_1d84ea90{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.menuItemIconContainer_1d84ea90{position:relative;margin:0 4px;height:32px;width:14px}.logoFillIcon_1d84ea90,.logoIcon_1d84ea90{position:absolute;left:0;right:0}.logoFillIcon_1d84ea90[data-icon-name='ExcelLogo16'],.logoIcon_1d84ea90[data-icon-name='ExcelLogo16']{color:#217346}.logoFillIcon_1d84ea90[data-icon-name='OneNoteLogo16'],.logoIcon_1d84ea90[data-icon-name='OneNoteLogo16']{color:#5c2d91}.logoFillIcon_1d84ea90[data-icon-name='PowerPointLogo16'],.logoIcon_1d84ea90[data-icon-name='PowerPointLogo16']{color:#d24726}.logoFillIcon_1d84ea90[data-icon-name='WordLogo16'],.logoIcon_1d84ea90[data-icon-name='WordLogo16']{color:#2b579a}.logoFillIcon_1d84ea90[data-icon-name='VisioLogo16'],.logoIcon_1d84ea90[data-icon-name='VisioLogo16']{color:#3854a2}.logoFillIcon_1d84ea90{color:#ffffff}.contextualMenuItemLinkContent_1d84ea90{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.contextualMenuItemTextLabel_1d84ea90{margin:0 4px;vertical-align:middle;display:inline-block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}\n"},{"rawString":".root_09895c92{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_09895c92{margin-left:96px}[dir='rtl'] .root_09895c92{margin-right:96px}\n"},{"rawString":".od-addCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addCommentTextField .ms-TextField-suffix{margin:8px 0;padding:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-addCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addCommentTextField-input .ms-TextField-fieldGroup{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-addCommentTextField-sendButton{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";background-color:unset}.od-addCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".od-addNewCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addNewCommentTextField .ms-TextField-suffix{padding:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.od-addNewCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addNewCommentTextField-input .ms-TextField-fieldGroup{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;max-height:174px;min-height:0px;border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-radius:2px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field{height:100%;min-height:0px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field:empty{max-height:29px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup:hover{border-color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-radius:2px;background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup:hover{border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-addNewCommentTextField-disabled .ms-TextField-suffix{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-addNewCommentTextField-sendButton{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";background-color:unset;margin:4px}.od-addNewCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addNewCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".od-ItemActivity-item{max-width:100%}.od-ItemActivity-item-nameText{font-weight:600;color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":"}.od-ItemActivity-item-linkText{font-weight:600;text-decoration:none}.od-ItemActivity-item-clickableLinkText{max-width:100%;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";cursor:pointer;font-family:inherit}.isFluent .od-ItemActivity-item-clickableLinkText{font-size:12px}.od-ItemActivity-otherActors{list-style-type:none;margin:0;padding:0}.od-ItemActivity-n-Others{font-weight:600}.od-ItemActivity-item-textContent{overflow:hidden;text-overflow:ellipsis;display:inline-block;max-width:100%;vertical-align:middle}.od-ItemActivity-item .ms-ActivityItem-activityContent{width:190px}.od-ItemActivity-timeStamp{display:inline-block;vertical-align:middle}html[dir='ltr'] .od-ItemActivity-timeStamp{padding-left:0}html[dir='rtl'] .od-ItemActivity-timeStamp{padding-right:0}.od-ItemActivity-timeStamp:before{content:'\\00a0\\2219\\00a0'}.od-ItemActivity-persona{position:relative;width:100%;height:100%;font-weight:400;margin-top:-5px}.od-ItemActivity-personaIcon{position:absolute;top:0px;left:0px;width:100%;height:100%;border-radius:50%}\n"},{"rawString":".od-activityItem-replies-list .ms-List-cell{min-height:0}\n"},{"rawString":".od-itemActivityMenu-dialogButton-default{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border:1px solid "},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-itemActivityMenu-dialogButton-default:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-itemActivityMenu-dialogButton-default:active{background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-itemActivityMenu-dialogButton-primary{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-itemActivityMenu-dialogButton-primary:hover{background-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.od-itemActivityMenu-dialogButton-primary:active{background-color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}.spo-ItemActivity-menuItems{min-width:120px;padding:0}\n"},{"rawString":".root_1aa25b42{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_1aa25b42{margin-left:96px}[dir='rtl'] .root_1aa25b42{margin-right:96px}\n"},{"rawString":".fileHoverCardCompactCard_7d060422{padding:14px 12px 0}.isFluent .fileHoverCardCompactCardTitleRegion_7d060422{margin-bottom:2px;display:-webkit-box;display:-ms-flexbox;display:flex;min-height:40px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-left:2px}[dir='ltr'] .isFluent .fileHoverCardCompactCardFileIcon_7d060422{margin-right:14px}[dir='rtl'] .isFluent .fileHoverCardCompactCardFileIcon_7d060422{margin-left:14px}.fileHoverCardCompactCardTitle_7d060422{font-size:17px;font-weight:300;font-weight:400;line-height:20px;overflow:hidden;text-overflow:ellipsis;word-break:break-word;max-width:200px}.fileHoverCardCompactCardTitle_7d060422.titleNotExpanded_7d060422{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.isFluent .fileHoverCardCompactCardTitle_7d060422{font-size:14px;font-weight:600;padding:0;white-space:normal}.fileHoverCardCompactCardActivity_7d060422{padding:8px 0}.fileHoverCardExpandedCard_7d060422{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;text-overflow:ellipsis;word-break:break-word;max-height:526px;min-height:1px}[dir='ltr'] .fileHoverCardExpandedCard_7d060422{padding-left:12px}[dir='rtl'] .fileHoverCardExpandedCard_7d060422{padding-right:12px}@media screen and (max-height: 660px){.fileHoverCardExpandedCard_7d060422{max-height:50vh}}.fileHoverCardExpandedCardScrollableSection_7d060422{overflow-y:auto;overflow-x:hidden;padding-left:12px;margin-left:-12px}.fileHoverCardExpandedCardLoadError_7d060422{padding:120px 45px;font-size:14px;font-weight:400;text-align:center;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.fileHoverCardExpandedCardLoadError_7d060422 .fileHoverCardExpandedCardSuggestion_7d060422{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.fileHoverCardExpandedCardHostScroll_7d060422{overflow-y:hidden;height:calc(100% - 1px)}.fileHoverCardActivitiesSection_7d060422{padding:16px 0px 10px 4px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .fileHoverCardActivitiesSection_7d060422{margin-right:12px}[dir='rtl'] .fileHoverCardActivitiesSection_7d060422{margin-left:12px}.fileCardExpandSectionContainer_7d060422{border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";margin-right:12px}.fileCardExpandSectionButton_7d060422{width:100%;border:0;border-radius:0;text-align:left;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";margin-left:-12px;width:320px;padding-left:12px;padding-right:25px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.collapsedFileCardTooltip_7d060422{text-align:right;height:18px;margin-right:12px;padding-top:2px;padding-right:15px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}\n"},{"rawString":".analyticsStatsContainer_123f61c9{display:-webkit-box;display:-ms-flexbox;display:flex;max-width:250px}.analyticsStats_123f61c9,.analyticsStatsNoLink_123f61c9,.analyticsStatsLink_123f61c9{padding:8px 8px 4px 0}.isFluent .analyticsStats_123f61c9,.isFluent .analyticsStatsNoLink_123f61c9,.isFluent .analyticsStatsLink_123f61c9{padding:0 8px 0 0}.analyticsStats_123f61c9 .ms-Link,.analyticsStatsNoLink_123f61c9 .ms-Link,.analyticsStatsLink_123f61c9 .ms-Link{font-size:12px;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}html[dir='ltr'] .analyticsStats_123f61c9 .ms-ActivityItem-activityTypeIcon,html[dir='ltr'] .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityTypeIcon,html[dir='ltr'] .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir='rtl'] .analyticsStats_123f61c9 .ms-ActivityItem-activityTypeIcon,html[dir='rtl'] .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityTypeIcon,html[dir='rtl'] .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityTypeIcon{padding-left:5px}.isFluent .analyticsStats_123f61c9 .ms-ActivityItem-activityTypeIcon,.isFluent .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityTypeIcon,.isFluent .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityTypeIcon{margin-top:0}.analyticsStats_123f61c9 .ms-ActivityItem-activityContent,.analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityContent,.analyticsStatsLink_123f61c9 .ms-ActivityItem-activityContent{-ms-flex-preferred-size:auto;flex-basis:auto;font-weight:600}html[dir='ltr'] .analyticsStats_123f61c9 .ms-ActivityItem-activityContent,html[dir='ltr'] .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityContent,html[dir='ltr'] .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityContent{padding-left:0}html[dir='rtl'] .analyticsStats_123f61c9 .ms-ActivityItem-activityContent,html[dir='rtl'] .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityContent,html[dir='rtl'] .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityContent{padding-right:0}.isFluent .analyticsStats_123f61c9 .ms-ActivityItem-activityContent,.isFluent .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityContent,.isFluent .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityContent{font-weight:400}.analyticsStatsLink_123f61c9 :hover{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.analyticsStatsNoLink_123f61c9{-ms-flex-item-align:center;align-self:center}.analyticsStatsViewsNoLink_123f61c9{padding:8px 0 4px;font-weight:400;font-size:12px}.isFluent .analyticsStatsViewsNoLink_123f61c9{padding:0}.analyticsStatsViews_123f61c9{padding-bottom:8px}.isFluent .analyticsStatsViews_123f61c9{font-size:14px;font-weight:600}.analyticsStatsViewsDivider_123f61c9:before{content:' \\B7  '}.analyticsStatsViewsDividerNoDot_123f61c9:before{content:'   ';padding:0px 4px}.analyticsStatsErrorMessage_123f61c9{font-size:12px;font-weight:400;line-height:28px}.fileHoverCardErrorIcon_123f61c9{vertical-align:bottom}.analyticsStatsTeachingMessage_123f61c9,.analyticsStatsInfo_123f61c9{vertical-align:sub;padding:0px 8px}.isFluent .analyticsStatsInfo_123f61c9{font-size:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.analyticsStatsLabel_123f61c9{display:-webkit-box;display:-ms-flexbox;display:flex}html[dir='ltr'] .analyticsStatsCount_123f61c9:not(:last-child){padding-right:8px}html[dir='rtl'] .analyticsStatsCount_123f61c9:not(:last-child){padding-left:8px}\n"},{"rawString":".analyticsActivity_fbe4fcc5{width:240px;height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.analyticsActivity_fbe4fcc5 .analyticsActivityUserAction_fbe4fcc5,.analyticsActivity_fbe4fcc5 .analyticsActivityUserName_fbe4fcc5{display:inline-block;content:attr(data-analytics-activity-start)}.analyticsActivity_fbe4fcc5 .analyticsActivityUserName_fbe4fcc5{content:attr(data-analytics-activity-start);color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:600}.analyticsActivity_fbe4fcc5 .analyticsActivityUserAction_fbe4fcc5{content:attr(data-analytics-activity-end);color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.ms-ActivityItem-timeStamp{height:16px}\n"},{"rawString":".analyticsActivityListActivity_1fa22094{padding:8px 0}\n"},{"rawString":".fileHoverCardInsideLook_450f4e32{padding:16px 0 14px 4px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .fileHoverCardInsideLook_450f4e32{margin-right:12px}[dir='rtl'] .fileHoverCardInsideLook_450f4e32{margin-left:12px}.fileHoverCardInsideLook_450f4e32 .fileHoverCardInsideLookTitle_450f4e32{font-size:14px;font-weight:600;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.fileHoverCardInsideLook_450f4e32 .ms-TooltipHost{padding:0 8px;font-size:12px;vertical-align:middle;color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.fileHoverCardInsideLook_450f4e32 .ms-Button--icon{height:14px}.fileHoverCardReadTimeContainer_450f4e32{padding-top:6px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:-webkit-box;display:-ms-flexbox;display:flex}.fileHoverCardReadTimeContainer_450f4e32 .fileHoverCardReadTime_450f4e32{display:inline-block;vertical-align:middle;font-size:12px}.fileHoverCardReadTimeContainer_450f4e32 .fileHoverCardReadTimeIcon_450f4e32{font-size:14px;vertical-align:text-top;margin-right:8px;margin-top:1px}.fileHoverCardKeyPointsButton_450f4e32{padding-top:5px;padding-bottom:5px;margin:7px -24px 0px -16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px;border:none;border-radius:0;height:100%;text-align:left;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.fileHoverCardKeyPointsNonButton_450f4e32{padding-top:5px;padding-bottom:5px;margin-top:7px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px}.fileHoverCardKeyPointsContent_450f4e32{padding-top:8px}.fileHoverCardKeyPointsAction_450f4e32{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px;width:100%}.fileHoverCardKeyPointsCell_450f4e32{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:100%;padding-bottom:2px}.fileHoverCardKeyPointsText_450f4e32{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fileHoverCardKeyPointsBullet_450f4e32:before{content:' \\B7  '}.fileHoverCardKeyPointsBullet_450f4e32{display:inline-block}[dir='ltr'] .fileHoverCardKeyPointsBullet_450f4e32{padding-right:8px}[dir='rtl'] .fileHoverCardKeyPointsBullet_450f4e32{padding-left:8px}\n"},{"rawString":".fileHoverCardLifeCycle_a88ba103{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";padding:8px 0px 10px 5px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}[dir='ltr'] .fileHoverCardLifeCycle_a88ba103{margin-right:12px}[dir='rtl'] .fileHoverCardLifeCycle_a88ba103{margin-left:12px}.fileHoverCardLifeCycleMessage_a88ba103{font-size:12px}.fileHoverCardLifeCycleMessage_a88ba103 .fileHoverCardLifeCycleTitle_a88ba103{white-space:pre-line;font-weight:400}.fileHoverCardLifeCycleAction_a88ba103{padding-top:4px;font-weight:600}.fileHoverCardLifeCycleNewSignal_a88ba103{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .fileHoverCardLifeCycleNewSignal_a88ba103{padding-left:15px}[dir='rtl'] .fileHoverCardLifeCycleNewSignal_a88ba103{padding-right:15px}\n"},{"rawString":".fileHoverCardRecommendedSection_ef3fc21d{padding:16px 0px 2px 4px;font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .fileHoverCardRecommendedSection_ef3fc21d{margin-right:12px}[dir='rtl'] .fileHoverCardRecommendedSection_ef3fc21d{margin-left:12px}.fileHoverCardRecommendedTitle_ef3fc21d{font-weight:600;padding-bottom:16px;display:inline-block}.fileHoverCardRecommendedMessage_ef3fc21d{margin-bottom:2px}.fileHoverCardShareWith_ef3fc21d{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:inline-block;content:attr(data-analytics-activity-end);font-size:12px}.fileHoverCardShareWithLink_ef3fc21d{padding:2px 0 16px 0;font-size:12px}.fileHoverCardChevronIcon_ef3fc21d{font-size:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";vertical-align:middle;padding-left:5px}[dir='ltr'] .fileHoverCardChevronIcon_ef3fc21d{padding-left:5px}[dir='rtl'] .fileHoverCardChevronIcon_ef3fc21d{padding-right:5px}.fileHoverCardRecommendedAction_ef3fc21d{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:-3px}.fileHoverCardRecommendedAction_ef3fc21d:hover .fileHoverCardCancelIcon_ef3fc21d{opacity:1}.fileHoverCardRecommendedIcon_ef3fc21d{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";margin-right:4px}.fileHoverCardCancelIcon_ef3fc21d{opacity:0}.fileHoverCardCancelIcon_ef3fc21d .ms-Button-icon{font-size:8px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.fileHoverCardCancelIcon_ef3fc21d .ms-Button-flexContainer{-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline}.fileHoverCardRecommendedLink_ef3fc21d{display:block;padding-bottom:14px;font-size:12px;font-weight:600}[dir='ltr'] .fileHoverCardRecommendedLink_ef3fc21d{padding-left:28px}[dir='rtl'] .fileHoverCardRecommendedLink_ef3fc21d{padding-right:28px}.fileHoverCardActivity_ef3fc21d{height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";content:attr(data-analytics-activity-end);display:inline-block}.fileHoverCardUserName_ef3fc21d{content:attr(data-analytics-activity-start);font-weight:600;display:inline-block;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}\n"},{"rawString":".fileHoverCardConversationsSection_8c83cf33{display:block;position:relative;padding-bottom:8px;margin-right:12px;font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.fileHoverCardConversationsTitle_8c83cf33{font-weight:600;padding:16px 0px 9px 4px;display:inline-block}.fileHoverCardConversation_8c83cf33{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:7px 0px 8px 14px;margin:0 -24px 4px -12px;cursor:pointer}.fileHoverCardConversation_8c83cf33:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.fileHoverCardConversationIcon_8c83cf33{margin-right:4px;width:17px;height:17px}.fileHoverCardConversationParticipants_8c83cf33{width:254px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:1px}.fileHoverCardConversationContext_8c83cf33{width:254px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:2px}.fileHoverCardMeetingConversationContext_8c83cf33{width:234px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.fileHoverCardConversationReferencePreview_8c83cf33{width:254px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";margin-bottom:4px}.fileHoverCardConversationSharedByUser_8c83cf33{font-weight:600}.fileHoverCardConversationsMeetingIcon_8c83cf33{display:inline-block;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";vertical-align:top;padding-top:2.5px;margin-right:8px}\n"},{"rawString":".fileHoverCardRelatedFilesSection_f4449314{display:block;position:relative;padding-bottom:8px;margin-right:12px;font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.fileHoverCardRelatedFilesTitle_f4449314{font-weight:600;padding:16px 0px 9px 4px;display:inline-block}.fileHoverCardRelatedFile_f4449314{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:7px 0px 8px 14px;margin:0 -24px 0px -12px;cursor:pointer}.fileHoverCardRelatedFile_f4449314:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.fileHoverCardRelatedFilesName_f4449314{width:254px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fileHoverCardRelatedFileIcon_f4449314{margin-right:8px;width:17px;height:17px}\n"},{"rawString":".analyticsActionBarStats_bfed0b89{min-height:28px}.isFluent .analyticsActionBarStats_bfed0b89{height:40px;padding:12px 4px;-webkit-box-sizing:border-box;box-sizing:border-box}.analyticsActionBar_bfed0b89{background-color:transparent;padding-left:0;padding-right:0}.isFluent .analyticsActionBar_bfed0b89{-webkit-box-sizing:border-box;box-sizing:border-box;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:35px}.isFluent .analyticsActionBar_bfed0b89 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir='ltr'] .isFluent .analyticsActionBar_bfed0b89 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-right:0}[dir='rtl'] .isFluent .analyticsActionBar_bfed0b89 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-left:0}.isFluent .analyticsActionBar_bfed0b89 .ms-FocusZone.ms-CommandBar{height:34px}.analyticsActionBar_bfed0b89 .ms-FocusZone.ms-CommandBar{background-color:transparent;padding:0;height:36px}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{background-color:transparent;min-width:0}[dir='ltr'] .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-left:0}[dir='rtl'] .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-right:0}.isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{min-width:0;height:32px;margin-top:1px;border-radius:2px;padding:0}.isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir='ltr'] .isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:4px}[dir='rtl'] .isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:4px}[dir='ltr'] .isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:20px}[dir='rtl'] .isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:20px}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{font-size:12px;font-weight:400}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon,.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover .ms-Button-textContainer{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}[dir='ltr'] .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:0}[dir='rtl'] .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:0}\n"},{"rawString":".ms-ContentTypeManagementPanel-Spinner{height:100vh}.ms-ContentTypeManagementPanel{display:-webkit-box;display:-ms-flexbox;display:flex;height:100vh}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel{-webkit-box-flex:1;-ms-flex:1;flex:1;background:#ffffff;padding:0px 10px 10px 30px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel{padding:0px 30px 10px 10px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Title{font-size:20px;font-family:'Segoe UI';margin:40px 0px 0px 0px;text-align:left}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Title{margin:40px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown{width:100%;margin:24px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown{margin:24px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:70vh;overflow-y:auto;margin:12px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container{margin:12px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label{margin:31px 0px 6px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label{margin:31px 0px 6px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton{border:none;font-family:'Segoe UI';font-style:normal;font-weight:600;font-size:14px;padding:0px 0px 0px 0px;width:100%;height:100%;text-align:left;background-color:inherit}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton{padding:0px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox{padding:11px 8px 11px 12px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox{padding:11px 12px 11px 8px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container{display:-webkit-box;display:-ms-flexbox;display:flex;padding:10px;border:none;width:100%;height:36px;text-align:left}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCT-button-cell{-webkit-box-flex:1;-ms-flex:1;flex:1}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container:hover,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container:hover{cursor:pointer}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container-selected,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container-selected{background:#f3f2f1;border:none;width:100%;height:36px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-checkbox{-webkit-box-flex:1;-ms-flex:1;flex:1}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-text{-webkit-box-flex:100;-ms-flex:100;flex:100;border:none}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{-webkit-box-flex:2;-ms-flex:2;flex:2}html[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{margin-left:20px}html[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{margin-right:20px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Content{margin:97px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Content{margin:97px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle{margin:20px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle{margin:20px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-column{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-row{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex:1;flex:1;margin:10px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-row{margin:10px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-row{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:8px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-row{margin:8px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView{margin:25px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView{margin:25px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Columns{margin:25px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Columns{margin:25px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{width:100%;margin-top:8px}[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{text-align:left}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{text-align:right}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content thead{display:table;width:100%;table-layout:fixed}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content tbody{height:calc(100vh - 420px);overflow-y:auto;display:block;overflow-wrap:break-word}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content tbody tr{table-layout:fixed;display:table;width:100%}.ms-ContentTypeManagementPanel-Button{margin:10px 10px 10px 10px}[dir='rtl'] .ms-ContentTypeManagementPanel-Button{margin:10px 10px 10px 10px}.ms-ContentTypeManagementPanel-CancelButton{background-color:#f3f2f1}.ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{position:absolute;bottom:0}[dir='ltr'] .ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{margin-left:20px}[dir='rtl'] .ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{margin-right:20px}.ms-ContentTypeManagementPanel-SecondaryPanel-Buttons{position:absolute;bottom:0}\n"},{"rawString":".od-ColumnsEditor-contentContainer{position:absolute;overflow-y:scroll;top:40px;bottom:0;padding:30px 40px}[dir=ltr] .od-ColumnsEditor-contentContainer{left:0}[dir=rtl] .od-ColumnsEditor-contentContainer{right:0}[dir=ltr] .od-ColumnsEditor-contentContainer{right:0}[dir=rtl] .od-ColumnsEditor-contentContainer{left:0}.od-ColumnsEditor-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:1px;padding:0;background-color:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":"}.od-ColumnsEditor-commandBar .CommandBar,.od-ColumnsEditor-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ColumnsEditor-commandBar .CommandBar,.od-ColumnsEditor-commandBar .ms-CommandBar{animation:none}}.od-ColumnsEditor-helpText{font-size:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-ColumnsEditor-dragProxy,.od-ColumnsEditor-list{font-size:12px;list-style-type:none;padding-left:0;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";outline:0}.od-ColumnsEditor-listItem{display:block;height:20px;margin:4px 0;outline:0;padding:6px;white-space:nowrap}.od-ColumnsEditor-listItem:not(.is-editable){color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemButtons,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemButtons,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemButtons,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemButtons{display:block}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemLabel,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemLabel,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemLabel,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemLabel{width:150px}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-CheckBox-field:before,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-CheckBox-field:before,.od-ColumnsEditor-listItem.is-editable:hover .od-CheckBox-field:before,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-CheckBox-field:before{border-color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-CheckBox-field.is-checked:before,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-CheckBox-field.is-checked:before,.od-ColumnsEditor-listItem.is-editable:hover .od-CheckBox-field.is-checked:before,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-CheckBox-field.is-checked:before{border-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemText,.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemText,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemText,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemText{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-ColumnsEditor-listItem.is-editable.is-dragging,.od-ColumnsEditor-listItem.is-editable:hover{background-color:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":"}.od-ColumnsEditor-listItem.is-editable .od-ColumnsEditor-itemLabel{cursor:pointer}.ms-Fabric--isFocusVisible .od-ColumnsEditor-listItem:focus,.od-focus--enabled .od-ColumnsEditor-listItem:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{overflow:hidden;text-overflow:ellipsis}html[dir=ltr] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{float:left}html[dir=rtl] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{float:right}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel.is-checked{font-weight:600}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{display:none;left:3px;position:relative;top:-6px;width:64px}html[dir=ltr] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{float:right}html[dir=rtl] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{float:left}.od-ColumnsEditor-listItem .od-ColumnsEditor-button{background:0 0;border:0;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";cursor:pointer;font-size:17px;height:32px;line-height:32px;margin:0;outline:0;padding:0;width:32px}.od-ColumnsEditor-listItem .od-ColumnsEditor-button:hover{background-color:"},{"theme":"themeLighter","defaultValue":"#deecf9"},{"rawString":"}.od-ColumnsEditor-listItem .od-ColumnsEditor-button:active{background-color:"},{"theme":"themeLight","defaultValue":"#c7e0f4"},{"rawString":"}.od-ColumnsEditor-listItem .od-ColumnsEditor-button:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemText{vertical-align:top}.od-ColumnsEditor-listItem .od-CheckBox{min-height:24px;margin-left:1px;display:inline-block;pointer-events:none}.od-ColumnsEditor-listItem .od-CheckBox-field{margin-top:1px}.od-ColumnsEditor-title{margin:0}"},{"rawString":".od-Sortable--proxy{position:absolute;z-index:3000}"},{"rawString":".ContentCenterCreateModelPanel-bottomMargin{margin-bottom:10px}.ContentCenterCreateModelPanel-dropdown{margin-top:15px}.spinner-topMargin{margin-top:5px}.advancedSettingsContainer{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.advancedSettingsHeader{display:flex;justify-content:space-between;cursor:pointer}.advancedSettingsHeaderText{display:flex;justify-content:center;align-items:center}.advancedSettingsExpandedMargin{margin-top:10px}.warningMassage{position:absolute;top:0;left:0;z-index:1}.infoIcon{top:4px;left:5px;position:relative;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}"},{"rawString":".SchedulingComponentToggle-topPadding{padding-top:20px;padding-bottom:10px}"},{"rawString":".sp-CreateAIBModelPanel-Spinner{margin-top:5px}.sp-CreateAIBModelPanel-Dropdown{margin-top:15px}.sp-CreateAIBModelPanel-AdvancedSettingsContainer{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.sp-CreateAIBModelPanel-AdvancedSettingsHeader{display:flex;justify-content:space-between;cursor:pointer}.sp-CreateAIBModelPanel-AdvancedSettingsHeaderText{display:flex;justify-content:center;align-items:center}.sp-CreateAIBModelPanel-ChevronColor{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.sp-CreateAIBModelPanel-AdvancedSettingsExpandedMargin{margin-top:10px}.sp-CreateAIBModelPanel-ViewContainer{margin-top:20px}.sp-CreateAIBModelPanel-TooltipIcon{top:4px;left:5px;position:relative;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}"},{"rawString":".option-container{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.item-timeStamp{color:#605e5c;font-size:12px}"},{"rawString":".CreateAIBModelPanel-separator{margin-top:5px}.ErrorTextStyle{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.footerDescription{border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}"},{"rawString":".fileHoverCardFeedbackTitle_039f8b23{font-size:14px;font-weight:600;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.fileHoverCardFeedbackTitle_039f8b23 .fileHoverCardFeedbackTooltip_039f8b23{vertical-align:middle}[dir='ltr'] .fileHoverCardFeedbackTitle_039f8b23 .fileHoverCardFeedbackTooltip_039f8b23{padding-left:8px}[dir='rtl'] .fileHoverCardFeedbackTitle_039f8b23 .fileHoverCardFeedbackTooltip_039f8b23{padding-right:8px}.fileHoverCardFeedbackOption_039f8b23{font-size:14px;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";padding:12px 0 28px}[dir='ltr'] .fileHoverCardFeedbackOption_039f8b23 .fileHoverCardFeedbackChoiceLink_039f8b23{padding-left:20px}[dir='rtl'] .fileHoverCardFeedbackOption_039f8b23 .fileHoverCardFeedbackChoiceLink_039f8b23{padding-right:20px}.fileHoverCardFeedbackMessage_039f8b23{color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":";font-size:14px;font-weight:400;padding:12px 0 20px}.fileHoverCardFeedbackCheckbox_039f8b23 .ms-Checkbox{padding:8px 0}.fileHoverCardFeedbackSubmit_039f8b23{margin:16px 0 28px}.fileHoverCardFeedbackSubCheckbox_039f8b23{font-size:12px}[dir='ltr'] .fileHoverCardFeedbackSubCheckbox_039f8b23{padding-left:25px}[dir='rtl'] .fileHoverCardFeedbackSubCheckbox_039f8b23{padding-right:25px}.fileHoverCardFeedbackSubCheckbox_039f8b23 .ms-Checkbox-text{font-size:12px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.fileHoverCardFeedbackSubCheckbox_039f8b23 .ms-Checkbox-checkbox{width:16px;height:16px}\n"},{"rawString":".fileHoverCardKeyPointsEditor_337ee822{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.fileHoverCardKeyPointsEditorInputSection_337ee822{margin:12px 0}.fileHoverCardKeyPointsEditorSpinner_337ee822{padding-top:12px}.fileHoverCardKeyPointsEditorSpinner_337ee822 .ms-Spinner-circle{margin:0}.fileHoverCardKeyPointsEditorButtons_337ee822{padding-top:12px}.fileHoverCardKeyPointsEditorButtonCancel_337ee822{margin:0 12px}.fileHoverCardKeyPointsEditorAddKeyPointLink_337ee822{font-size:12px;font-weight:600;font-family:inherit}.fileHoverCardKeyPointsEditorCell_337ee822{-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);display:-webkit-box;display:-ms-flexbox;display:flex;margin:20px 0}.fileHoverCardKeyPointsEditorCell_337ee822 .ms-ActivityItem{width:100%;margin:12px}.fileHoverCardKeyPointsEditorCell_337ee822 .ms-ActivityItem-activityText{font-size:14px}.fileHoverCardKeyPointsEditorCell_337ee822:hover .fileHoverCardKeyPointsEditorDeleteIcon_337ee822,.fileHoverCardKeyPointsEditorCell_337ee822:focus .fileHoverCardKeyPointsEditorDeleteIcon_337ee822{opacity:1}.fileHoverCardKeyPointsEditorDeleteIcon_337ee822{opacity:0}.fileHoverCardKeyPointsEditorDeleteIcon_337ee822 .ms-Button-icon{font-size:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}\n"},{"rawString":".od-DetailsList .ms-DetailsRow.is-dropping{background:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":";outline:1px solid transparent}.od-DetailsList .ms-DetailsRow.is-dropping .ms-DetailsRow-cell .FileTypeIcon-icon{transform:scale(1.5,1.5)}.od-DetailsList-groupHeader{margin-top:15px;margin-bottom:15px;font-size:17px}html[dir=ltr] .od-DetailsList-groupHeader{margin-left:96px}html[dir=rtl] .od-DetailsList-groupHeader{margin-right:96px}.od-DetailsListHeader-AddNewField{font-size:9px;color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}html[dir=ltr] .od-DetailsListHeader-AddNewField{margin-right:6px}html[dir=rtl] .od-DetailsListHeader-AddNewField{margin-left:6px}html[dir=ltr] .od-DetailsListHeader-AddNewField{padding-left:0}html[dir=rtl] .od-DetailsListHeader-AddNewField{padding-right:0}.ms-DetailsRow-cell.od-DetailsRow-cell--FileIcon{line-height:0;overflow:visible}.ms-DetailsRow-cell.od-DetailsRow-cell--Title{cursor:pointer}.ms-DetailsRow-cell [data-is-focusable=true]{outline:transparent;vertical-align:top}.ms-DetailsRow-cell .od-FieldRender-nofill{position:relative;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.isFluent .ms-DetailsRow-cell .od-FieldRender-userFluent{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-FieldRenderer-text{white-space:normal;overflow:hidden;max-height:7em}.od-FieldRenderer--disabled{opacity:.4}.od-DetailsHeader-cell--FileIcon span{display:inline-flex;justify-content:center;align-items:center}.od-userWithTopCollaborator{display:flex}.od-userWithTopCollaborator .ms-topCollaPlaceHolder{min-width:13px}html[dir=ltr] .od-userWithTopCollaborator .ms-topCollaPlaceHolder{padding-right:7px}html[dir=rtl] .od-userWithTopCollaborator .ms-topCollaPlaceHolder{padding-left:7px}.ms-DetailsRow-cell .od-FieldRender-lookup{display:block;max-width:100%}.od-DetailsRow-cell--VerticallyCenter{display:flex;flex-direction:column;justify-content:center}.ms-Fabric.is-focusVisible .ms-DetailsRow-cell [data-is-focusable=true]:focus:after{position:absolute;content:'';left:0;top:0;right:0;bottom:0;border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-addColumn{width:40px;padding:0;text-align:center}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-addColumn .ms-Icon{line-height:36px}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:active{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:focus{border:1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .ms-DetailsHeader-cell .ms-DetailsHeader-filterChevron.ms-Icon{padding-left:8px}[dir=rtl] .ms-DetailsHeader-cell .ms-DetailsHeader-filterChevron.ms-Icon{padding-right:8px}.ms-DetailsHeader-cell .ms-Icon.ms-Icon--GroupedList{position:relative;top:1px}.ms-DetailsHeader-cell .od-DetailsListHeader-FileTypeIcon.ms-Icon{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-DetailsList-screenReaderOnly{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}.od-DetailsListHeader-FileTypeIcon{font-size:16px;padding:0}.od-DetailsHeader-cell--FileIcon .ms-Icon{width:18px;text-align:center}.od-DetailsRow-needsAttention{position:relative}.od-DetailsRow-needsAttention:after{content:'';position:absolute;top:0;bottom:0}html[dir=ltr] .od-DetailsRow-needsAttention:after{left:-3px}html[dir=rtl] .od-DetailsRow-needsAttention:after{right:-3px}html[dir=ltr] .od-DetailsRow-needsAttention:after{border-left:3px solid "},{"theme":"warningHighlight","defaultValue":"#ffb900"},{"rawString":"}html[dir=rtl] .od-DetailsRow-needsAttention:after{border-right:3px solid "},{"theme":"warningHighlight","defaultValue":"#ffb900"},{"rawString":"}.ms-DetailsRow-cell .ms-Icon--People{position:relative;top:2px}.od-DetailsList .FileTypeIcon{margin:0 -2px}.od-DetailsList .ms-DetailsRow-cell .od-FieldRender-truncate{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-DetailsList .ms-DetailsList--Compact .od-DetailsRow-cell--FileIcon .FileTypeIcon{margin:0;padding:2px 0 0 0}.od-DetailsList .ms-DetailsList--Compact .ms-DetailsRow-check{width:32px;height:32px}.od-DetailsList .ms-DetailsList--Compact .od-FieldRenderer-shareHeroCommand i,.od-DetailsList .ms-DetailsList--Compact BUTTON.od-FieldRenderer-dot i{top:10px}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField,.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField{vertical-align:top;top:-1px;min-width:0}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldValue],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldValue]{flex:1 1 auto!important}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=newSignal],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=newSignal]{position:absolute}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldBefore],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldBefore]{position:absolute;margin:0}.od-FieldRenderer-Renderer-withCommandAndMetata{display:flex;height:100%;width:100%}.od-FieldRenderer-Renderer-withCommandAndMetata button.od-FieldRender-display--link{width:100%}.od-FieldRenderer-dotDotDotContainer,.od-FieldRenderer-heroCommandContainer{display:inline-flex;flex-shrink:0;margin-top:-11px;margin-bottom:-11px}.od-FieldRenderer-dotDotDotContainer .od-FieldRenderer-pin,.od-FieldRenderer-heroCommandContainer .od-FieldRenderer-pin{position:relative}.od-FieldRenderer-dotDotDotContainer{position:absolute;height:100%}.ms-DetailsList--Compact .od-FieldRenderer-heroCommandContainer{margin:-8px 0 -8px auto}html[dir=rtl] .ms-DetailsList--Compact .od-FieldRenderer-heroCommandContainer{margin:-8px auto -8px 0}.od-FieldRenderer-Renderer-withMetadata{display:flex;flex-direction:column;justify-content:center;min-width:0;flex-grow:1;overflow:hidden}.od-VaultSection{display:inline-block}.od-FieldRenderer-Renderer-withCommands{display:flex;flex-direction:column}.od-DetailsList .ms-GroupHeader-expand{font-size:12px;margin-top:-8px}button.ms-DetailsRow-check{padding:0}@keyframes ItemScope-NewRow{0%{max-height:0;opacity:0}20%{opacity:1}100%{max-height:210px;opacity:1}}@keyframes ItemScope-NewRow-compact{0%{max-height:0;opacity:0}20%{opacity:1}100%{max-height:160px;opacity:1}}@keyframes ItemScope-FreshRow{0%{left:-10px;opacity:0}50%{opacity:1}100%{left:0;opacity:1}}@keyframes ItemScope-OldRow{0%{left:0;opacity:1}100%{left:10px;opacity:0}}@keyframes ItemScope-FreshRow-rtl{0%{left:10px;opacity:0}50%{opacity:1}100%{left:0;opacity:1}}@keyframes ItemScope-OldRow-rtl{0%{left:0;opacity:1}100%{left:-10px;opacity:0}}.ms-DetailsRow{animation-name:none;animation-duration:1.335s;animation-timing-function:ease-out;animation-iteration-count:1}.ms-DetailsRow.od-DetailsRow--fresh{animation-name:ItemScope-NewRow}.ms-DetailsList--Compact .ms-DetailsRow.od-DetailsRow--fresh{animation-name:ItemScope-NewRow-compact}.od-DetailsRow-accessible{display:block;overflow:hidden;position:absolute;top:-9000px;left:-9000px;height:1px;width:1px}.ms-DetailsList .ms-List-page .ms-List-cell{min-height:0}.ms-DetailsList--Compact .ms-List-cell .od-DetailsRow--fresh,.ms-List-cell .od-DetailsRow--fresh{min-height:0;overflow-y:hidden}.od-DetailsColumn-Refreshed{position:relative}.od-DetailsColumn-Refreshed .od-DetailsColumn-Current,.od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{position:absolute;width:100%;animation-fill-mode:both;animation-duration:267ms;animation-iteration-count:1}.od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-timing-function:cubic-out;animation-delay:267ms}html[dir=ltr] .od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-name:ItemScope-FreshRow}html[dir=rtl] .od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-name:ItemScope-FreshRow-rtl}.od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-timing-function:cubic-in}html[dir=ltr] .od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-name:ItemScope-OldRow}html[dir=rtl] .od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-name:ItemScope-OldRow-rtl}"},{"rawString":".isFluent .ms-DetailsList .ms-DetailsRow.is-selected .od-FieldRenderer-shareHeroCommand:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.od-FieldRenderer-shareHeroCommand{display:block;width:36px;position:relative;height:100%;text-align:center;outline:none;border:none;background-color:transparent;margin:0;padding:0;color:inherit;font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";opacity:0;border-radius:0;cursor:pointer}.od-FieldRenderer-shareHeroCommand:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-FieldRenderer-shareHeroCommand i{position:absolute;top:14px;margin:auto;opacity:0}html[dir='ltr'] .od-FieldRenderer-shareHeroCommand i{right:10px}html[dir='rtl'] .od-FieldRenderer-shareHeroCommand i{left:10px}.od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{position:relative;top:1px}html[dir='ltr'] .od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{right:0}html[dir='rtl'] .od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{left:0}.od--isMobile .od-FieldRenderer-shareHeroCommand{opacity:1}.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-shareHeroCommand,.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-shareHeroCommand,.od--isNonMobile .od-FieldRenderer-shareHeroCommand:focus{opacity:1}.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-shareHeroCommand i,.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-shareHeroCommand i,.od--isNonMobile .od-FieldRenderer-shareHeroCommand:focus i{opacity:1}.ms-DetailsRow-cell.od-DetailsRow-cell--ShareCommand{padding:0;overflow:visible}\n"},{"rawString":".ms-ActivityItem-personaContainer{display:inline}.ms-CommandBar.ms-AnalyticsActionBar--bar{background-color:transparent;padding-left:0;padding-right:0}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-textContainer{font-size:12px;font-weight:400}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-icon,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-textContainer{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar:hover{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar:hover .ms-Button-textContainer{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}"},{"rawString":".container_1addcdca{border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:200px;margin:0 30px 0 30px;margin-top:30px;min-width:1100px}.closeButtonDiv_1addcdca{display:flex;justify-content:flex-end;padding-top:5px;padding-right:10px}.closeButton_1addcdca{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.closeButton_1addcdca:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.bannerContent_1addcdca{width:100%}.bannerHeaderContent_1addcdca{height:90px}.bannerPrimaryContent_1addcdca{padding-left:16%;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.bannerPrimaryText_1addcdca{font-size:large;font-weight:600}.bannerSecondaryText_1addcdca{font-size:medium;font-weight:600}.buttonStack_1addcdca{margin-top:10px}.bannerHeaderTagStyle_1addcdca{display:flex;justify-content:center;align-items:center}.descriptionContainer_1addcdca{padding-left:16%;width:84%;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";height:75px;padding-top:15px}.descriptionText_1addcdca{width:80%}.imageContainer_1addcdca{display:flex;justify-content:center;align-items:center;width:14%;height:200px;position:absolute}@media only screen and (max-width:900px){.imageContainer_1addcdca{padding-left:30px}}"},{"rawString":".icon_f405f152{display:block;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}[dir='ltr'] .icon_f405f152{margin-right:8px}[dir='rtl'] .icon_f405f152{margin-left:8px}.siteName_f405f152{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-flex:10;-ms-flex-positive:10;flex-grow:10;text-overflow:ellipsis;white-space:nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}[dir='ltr'] .siteName_f405f152{text-align:left}[dir='rtl'] .siteName_f405f152{text-align:right}.siteNameContainer_f405f152{width:100%;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex}.linkName_f405f152{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}[dir='ltr'] .linkName_f405f152{padding-left:32px}[dir='rtl'] .linkName_f405f152{padding-right:32px}.linkName_f405f152:hover,.linkName_f405f152:active{color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}.parentContainer_f405f152{width:inherit}.dragContainer_f405f152{height:36px;display:-webkit-box;display:-ms-flexbox;display:flex}.siteContainer_f405f152{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.dropZoneParent_f405f152{position:absolute;width:100%;height:inherit}.parentContainer_f405f152:hover .dropZoneParent_f405f152{z-index:-1}.topDropZoneHover_f405f152{height:17px;border-top:1px solid #0078b4}.bottomDropZoneHover_f405f152{height:17px;border-bottom:1px solid #0078b4}.dropZone_f405f152{height:17px}.dragHandler_f405f152{position:absolute;height:inherit;top:-2px;opacity:0;cursor:move;z-index:1;font-size:16px}[dir='ltr'] .dragHandler_f405f152{margin-left:-16px}[dir='rtl'] .dragHandler_f405f152{margin-right:-16px}.dragContainer_f405f152:hover .dragHandler_f405f152{opacity:0.5}\n"},{"rawString":".odSitePinIcon_0904a4d9{padding:6px 8px}.odSitePinButtonDefault_0904a4d9{background-color:Transparent;border:none;color:grey;float:right;display:inline}.odSitePinButtonDefault_0904a4d9 :hover{color:#4a8aef}.odSitePinButtonHover_0904a4d9{background-color:Transparent;border:none;color:grey;float:right;display:none}.odSitePinButtonHover_0904a4d9 :hover{color:#4a8aef}.odSitePinPinHover_0904a4d9{background-color:Transparent;border:none;color:grey;float:right;display:none}.odSitePinPinHover_0904a4d9 :hover{color:#4a8aef}.sitePinLeftNavParent_0904a4d9{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;height:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.sitePinLeftNavParent_0904a4d9:hover .odSitePinButtonDefault_0904a4d9{display:none}.sitePinLeftNavParent_0904a4d9:hover .odSitePinButtonHover_0904a4d9{display:inline}.sitePinLeftNavParent_0904a4d9:hover .odSitePinPinHover_0904a4d9{display:none}.sitePinAllSitesParent_0904a4d9:hover .odSitePinButtonDefault_0904a4d9{display:none}.sitePinAllSitesParent_0904a4d9:hover .odSitePinButtonHover_0904a4d9{display:inline}.sitePinAllSitesParent_0904a4d9:hover .odSitePinPinHover_0904a4d9{display:none}.odSitePinContainer_0904a4d9{z-index:1;opacity:0.99}.odSitePinContainer_0904a4d9:hover .odSitePinButtonDefault_0904a4d9{display:none}.odSitePinContainer_0904a4d9:hover .odSitePinButtonHover_0904a4d9{display:none}.odSitePinContainer_0904a4d9:hover .odSitePinPinHover_0904a4d9{display:inline}\n"},{"rawString":".root_05ba7b03{display:-webkit-box;display:-ms-flexbox;display:flex;position:absolute;top:0;left:0;bottom:0;right:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.root_05ba7b03:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.icon_05ba7b03{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}[dir='ltr'] .icon_05ba7b03{margin-right:8px}[dir='rtl'] .icon_05ba7b03{margin-left:8px}.nameplate_05ba7b03{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex}.name_05ba7b03{font-size:17px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:inline-block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.activity_05ba7b03{padding:0 16px}\n"},{"rawString":".root_a057c8e0{display:-webkit-box;display:-ms-flexbox;display:flex;width:99%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:6px;background:"},{"theme":"menuBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,0.132),0 0.3px 0.9px 0 rgba(0,0,0,0.108);box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,0.132),0 0.3px 0.9px 0 rgba(0,0,0,0.108)}.root_a057c8e0:hover{-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108)}.nameplate_a057c8e0{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex}.name_a057c8e0{font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:400;display:inline-block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.activity_a057c8e0{padding:0 16px}div.icon_a057c8e0{border-radius:4px}.icon_a057c8e0 p{font-weight:600}\n"},{"rawString":".acronym_67e6b7aa{position:relative;width:24px;height:24px;border-radius:2px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}.acronymText_67e6b7aa{display:block;text-align:center;color:white;font-size:9px;font-weight:100;line-height:12px;margin:0px}.siteLogo_67e6b7aa{position:absolute;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:2px}.siteLogoHidden_67e6b7aa{display:none}\n"},{"rawString":".name_cdefa8c9{font-size:16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:600}\n"},{"rawString":".ms-siteScriptProgress-accessible{position:absolute;top:-9001px;left:-9001px;height:1px;width:1px}.ms-siteScriptProgress-panel .ms-Panel-navigation{display:none}.ms-siteScriptProgress-panel .ms-Panel-scrollableContent{height:100%}html[dir='ltr'] .ms-siteScriptProgress-schemaArea{padding-right:20px}html[dir='rtl'] .ms-siteScriptProgress-schemaArea{padding-left:20px}.ms-siteScriptProgress-siteDesignLogoImage img{max-width:370px}.ms-siteScriptProgress-workingImage{margin-top:64px;max-height:227px;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1}.ms-siteScriptProgress-darker{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ms-siteScriptProgress-xButton{width:40px;height:40px}html[dir='ltr'] .ms-siteScriptProgress-xButton{float:right}html[dir='rtl'] .ms-siteScriptProgress-xButton{float:left}.ms-siteScriptProgress-navigation{-webkit-box-flex:0;-ms-flex:0 0 40px;flex:0 0 40px;height:40px;padding-bottom:32px}.ms-siteScriptProgress-siteDesignDescription{padding:10px 0 20px}.ms-siteScriptProgress-explainerTitle{font-weight:600;padding:0 0 10px}.ms-siteScriptProgress-explainerLink{padding:10px 0 0}.ms-siteScriptProgress-runChoiceChecked{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.ms-siteScriptProgress-runChoiceChecked .ms-siteScriptProgress-runChoiceArrow{visibility:visible}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot.ms-siteScriptProgress-runChoiceChecked{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot .ms-siteScriptProgress-runChoiceArrow{visibility:visible}.ms-siteScriptProgress-runChoiceRoot{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;border-bottom:1px solid "},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";padding:16px 0;cursor:pointer}.ms-siteScriptProgress-runChoiceRadio{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;visibility:hidden}html[dir='ltr'] .ms-siteScriptProgress-runChoiceRadio{padding-right:5px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceRadio{padding-left:5px}html[dir='ltr'] .ms-siteScriptProgress-runChoiceRadio{padding-left:25px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceRadio{padding-right:25px}.ms-siteScriptProgress-runChoiceText{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}.ms-siteScriptProgress-runChoicePrimaryText{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;font-weight:600;padding:0 0 2px 0}.ms-siteScriptProgress-runChoiceSecondaryText{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.ms-siteScriptProgress-runChoiceArrow{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;visibility:hidden}html[dir='ltr'] .ms-siteScriptProgress-runChoiceArrow{padding-right:20px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceArrow{padding-left:20px}.ms-siteScriptProgress-columnHeader{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.ms-siteScriptProgress-columnBody{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0;margin:0 0 32px}.ms-siteScriptProgress-scrollable{overflow-y:auto}.ms-siteScriptProgress-columnFooter{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.ms-siteScriptProgress-leftColumn .ms-siteScriptProgress-columnFooter{padding:0 0 60px}.ms-siteScriptProgress-leftColumn .ms-ChoiceField-wrapper{width:100%}.ms-siteScriptProgress-leftColumn .ms-ChoiceField{margin:0}.ms-siteScriptProgress-columnInternal{width:370px;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}[dir='ltr'] .ms-siteScriptProgress-columnInternal{padding-right:40px}[dir='rtl'] .ms-siteScriptProgress-columnInternal{padding-left:40px}.ms-siteScriptProgress-rightColumn .ms-siteScriptProgress-columnFooter{padding:20px 0;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-siteScriptProgress-tenantSiteDesignsLink{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400}.ms-siteScriptProgress-panelBottomTextBold{font-weight:800}.ms-siteScriptProgress-panelRoot{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%}.ms-siteScriptProgress-column{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:72px 40px 0;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1}.ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-top:0px}[dir='ltr'] .ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-right:0px}[dir='rtl'] .ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-left:0px}.ms-siteScriptProgress-noProgressIndicator{margin:0 0 21px;font-weight:600}.ms-siteScriptProgress-tenantSiteDesignTitle{margin:0 0 10px;font-weight:600}.ms-siteScriptProgress-panel .ms-Panel-contentInner{height:100%}.ms-siteScriptProgress-panel.ms-siteScriptProgress-panel{margin-top:50px}[dir='ltr'] .ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-main{left:auto}[dir='rtl'] .ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-main{right:auto}.ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-content{height:100%;padding:0}.ms-siteScriptProgress-emptyStageContainer{margin:auto}.ms-siteScriptProgress-errorIcon,.ms-siteScriptProgress-errorText{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":"}.ms-siteScriptProgress-inProgressSpinner{vertical-align:middle;display:inline-block}[dir='ltr'] .ms-siteScriptProgress-inProgressSpinner{margin-right:8px}[dir='rtl'] .ms-siteScriptProgress-inProgressSpinner{margin-left:8px}.ms-siteScriptProgress-actionIcon{-ms-flex-negative:0;flex-shrink:0}[dir='ltr'] .ms-siteScriptProgress-actionIcon{margin-right:8px}[dir='rtl'] .ms-siteScriptProgress-actionIcon{margin-left:8px}.ms-siteScriptProgress-successIcon{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-siteScriptProgress-gear{position:relative;top:3px}.ms-siteScriptProgress-activeActionTitle{color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":"}.ms-siteScriptProgress-actionIcon,.ms-siteScriptProgress-errorIcon{font-size:16px;line-height:16px}.ms-siteScriptProgress-errorText{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;margin-top:4px}[dir='ltr'] .ms-siteScriptProgress-errorText{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-errorText{margin-right:24px}.ms-siteScriptProgress-actionTitle{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;-ms-flex-negative:1;flex-shrink:1;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;min-width:0px;overflow-wrap:break-word;word-wrap:break-word;line-height:16px}[dir='ltr'] .ms-siteScriptProgress-actionTitleNoIcon{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-actionTitleNoIcon{margin-right:24px}.ms-siteScriptProgress-incompleteIcon{color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.ms-siteScriptProgress-inactiveActionTitle{color:"},{"theme":"disabledText","defaultValue":"#a19f9d"},{"rawString":"}.ms-siteScriptProgress-stageTitle{font-size:"},{"theme":"xSmallFontSize","defaultValue":"10px"},{"rawString":";font-weight:400}[dir='ltr'] .ms-siteScriptProgress-stageTitle{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-stageTitle{margin-right:24px}.ms-siteScriptProgress-stageTitle{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-siteScriptProgress-siteScriptProgressSubtext,.ms-siteScriptProgress-siteScriptLongRunningText{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-siteScriptProgress-siteScriptLongRunningText{margin:12px 0 0}.ms-siteScriptProgress-progressIndicatorContainer{margin:12px 0 20px}.ms-siteScriptProgress-progressIndicatorContainer .ms-ProgressIndicator-itemName{font-weight:600;padding:0}.ms-siteScriptProgress-siteDesignChooserTitle{font-weight:600;margin:0 0 8px}.ms-siteScriptProgress-panelTitle{font-size:"},{"theme":"xLargeFontSize","defaultValue":"20px"},{"rawString":";font-weight:100;font-weight:400;margin-bottom:20px}.ms-siteScriptProgress-panelBigTitle.ms-siteScriptProgress-panelTitle{font-size:"},{"theme":"xxLargeFontSize","defaultValue":"28px"},{"rawString":";font-weight:100}.ms-siteScriptProgress-panelSubtitle{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;margin-bottom:20px}.ms-siteScriptProgress-titleContainer{margin:32px 0 28px}.ms-siteScriptProgress-actionContainer{margin-bottom:20px}.ms-siteScriptProgress-emptyStageProgressIndicator{margin-bottom:22px}.ms-siteScriptProgress-stageContainer{margin-top:8px}.ms-siteScriptProgress-actionHeader{display:-webkit-box;display:-ms-flexbox;display:flex}\n"}]);return {Commands_0:{newDocumentCommandIcon:'newDocumentCommandIcon_810ca8e5'},OpenCommandButton_4:{iconContainer:'iconContainer_8f3e4037',brandIcon:'brandIcon_8f3e4037',menuItemBrandIcon:'menuItemBrandIcon_8f3e4037',menuItemIconContainer:'menuItemIconContainer_8f3e4037',logoFillIcon:'logoFillIcon_8f3e4037',logoIcon:'logoIcon_8f3e4037',contextualMenuItemLinkContent:'contextualMenuItemLinkContent_8f3e4037',contextualMenuItemTextLabel:'contextualMenuItemTextLabel_8f3e4037'},ViewCommands_5:{needsAttentionIconOverlay:'needsAttentionIconOverlay_a23ec69d',needsAttentionIcon:'needsAttentionIcon_a23ec69d'},CustomActionCommands_5:{customActionCommandIcon:'customActionCommandIcon_9e2eb146'},ShowKeyboardMap_4:{keyboardMapGroup:'keyboardMapGroup_83c329c3',keyboardMapTable:'keyboardMapTable_83c329c3',keyboardMapRow:'keyboardMapRow_83c329c3',keyboardMapKey:'keyboardMapKey_83c329c3',keyboardMapVal:'keyboardMapVal_83c329c3'},FileHandlerCommands_8:{fileHandlerCommandIcon:'fileHandlerCommandIcon_1aaa825b'},CustomFormatterItemTile_6:{customTile:'customTile_bb9070dd',customTileFocusZone:'customTileFocusZone_bb9070dd'},ProgressList_3:{root:'root_53a50724',group:'group_53a50724',item:'item_53a50724'},TilesList_5:{listCell:'listCell_09efe3dd',listPage:'listPage_09efe3dd',cell:'cell_09efe3dd',cellContent:'cellContent_09efe3dd',cellFirstInRow:'cellFirstInRow_09efe3dd',sizer:'sizer_09efe3dd',header:'header_09efe3dd',grid:'grid_09efe3dd',row:'row_09efe3dd',headerRow:'headerRow_09efe3dd',shimmeredList:'shimmeredList_09efe3dd',none:'none_09efe3dd'},ProgressItemTile_3:{tile:'tile_43a46e1f',hasIcon:'hasIcon_43a46e1f',title:'title_43a46e1f',icon:'icon_43a46e1f',hasProgress:'hasProgress_43a46e1f',progress:'progress_43a46e1f',error:'error_43a46e1f',description:'description_43a46e1f',actions:'actions_43a46e1f',cancel:'cancel_43a46e1f'},CommandButton_8:{commandButton:'commandButton_acea5dc0'},ProgressCallout_7:{callout:'callout_96e61042',progressList:'progressList_96e61042',viewAllButton:'viewAllButton_96e61042',accessibleStatus:'accessibleStatus_96e61042'},NameDialog_8:{nameDialogContent:'nameDialogContent_31ed50fc',nameDialogContentFileExtension:'nameDialogContentFileExtension_31ed50fc',nameDialogSpinner:'nameDialogSpinner_31ed50fc'},ConfirmationDialog_2:{confirmTextLabel:'confirmTextLabel_e964ecde'},ProgressCommandButton_7:{created:'created_08a27ca2',spin:'spin_08a27ca2',closeButton:'closeButton_08a27ca2',accessibleStatus:'accessibleStatus_08a27ca2'},Tile_1:{tile:'tile_ba4e71c8',selectable:'selectable_ba4e71c8',selected:'selected_ba4e71c8',isFluentStyling:'isFluentStyling_ba4e71c8',name:'name_ba4e71c8',hasBackgroundFrame:'hasBackgroundFrame_ba4e71c8',invokable:'invokable_ba4e71c8',label:'label_ba4e71c8',description:'description_ba4e71c8',link:'link_ba4e71c8',foreground:'foreground_ba4e71c8',foregroundHide:'foregroundHide_ba4e71c8',hasForegroundFrame:'hasForegroundFrame_ba4e71c8',check:'check_ba4e71c8',uninvokable:'uninvokable_ba4e71c8',showCheck:'showCheck_ba4e71c8',background:'background_ba4e71c8',backgroundHide:'backgroundHide_ba4e71c8',aboveNameplate:'aboveNameplate_ba4e71c8',content:'content_ba4e71c8',nameplate:'nameplate_ba4e71c8',activity:'activity_ba4e71c8',signal:'signal_ba4e71c8',storageSignal:'storageSignal_ba4e71c8',socialSignal:'socialSignal_ba4e71c8',lifecycleSignal:'lifecycleSignal_ba4e71c8',isLarge:'isLarge_ba4e71c8',isSmall:'isSmall_ba4e71c8',hasBackground:'hasBackground_ba4e71c8',onlyOnHover:'onlyOnHover_ba4e71c8',showBackground:'showBackground_ba4e71c8'},Signal_4:{signal:'signal_3bddfae0',dark:'dark_3bddfae0',selected:'selected_3bddfae0'},Check_8:{root:'root_637efddd',rootIsChecked:'rootIsChecked_637efddd',check:'check_637efddd',checkHost:'checkHost_637efddd',circle:'circle_637efddd'},ItemTile_8:{tile:'tile_d5d0cfea',hideFileTypeIcon:'hideFileTypeIcon_d5d0cfea',fileTypeIcon:'fileTypeIcon_d5d0cfea',tileAppIcon:'tileAppIcon_d5d0cfea',hideThumbnail:'hideThumbnail_d5d0cfea',thumbnail:'thumbnail_d5d0cfea',defaultTile:'defaultTile_d5d0cfea',folderCover:'folderCover_d5d0cfea',thumbnailNotResolved:'thumbnailNotResolved_d5d0cfea',name:'name_d5d0cfea',blankFolderCover:'blankFolderCover_d5d0cfea'},FolderCover_5:{root:'root_0ac1db22',isSmall:'isSmall_0ac1db22',isLinked:'isLinked_0ac1db22',front:'front_0ac1db22',isLarge:'isLarge_0ac1db22',back:'back_0ac1db22',content:'content_0ac1db22',hideContent:'hideContent_0ac1db22',isFluent:'isFluent_0ac1db22',frame:'frame_0ac1db22',metadata:'metadata_0ac1db22',signal:'signal_0ac1db22'},ItemThumbnail_6:{image:'image_0424b027'},ItemSetTilesList_2:{root:'root_342da9bd',showAllCell:'showAllCell_342da9bd'},DragLayerPreview_5:{dragPreviewRoot:'dragPreviewRoot_c437410f',dragPreviewIcon:'dragPreviewIcon_c437410f',dragPreviewText:'dragPreviewText_c437410f'},SocialBar_2:{commandLink:'commandLink_3eae80fd',link:'link_3eae80fd',pageUsageChartContainer:'pageUsageChartContainer_3eae80fd',root:'root_3eae80fd',socialBarList:'socialBarList_3eae80fd',socialBarPanel:'socialBarPanel_3eae80fd',socialBarPanelContent:'socialBarPanelContent_3eae80fd',spSocialPanelPivotContent:'spSocialPanelPivotContent_3eae80fd',socialBarPanelHeader:'socialBarPanelHeader_3eae80fd',socialBarPanelHeaderText:'socialBarPanelHeaderText_3eae80fd',socialBarPanelPersona:'socialBarPanelPersona_3eae80fd',socialBarPanelPersonaDescription:'socialBarPanelPersonaDescription_3eae80fd',viewsIcon:'viewsIcon_3eae80fd',analyticsStatsLink:'analyticsStatsLink_3eae80fd'},ItemCard_8:{itemCard:'itemCard_869933b0',check:'check_869933b0',commandButtonContainer:'commandButtonContainer_869933b0',commandButton:'commandButton_869933b0',fileNameContainer:'fileNameContainer_869933b0',previewContainer:'previewContainer_869933b0',previewVertical:'previewVertical_869933b0',previewHorizontal:'previewHorizontal_869933b0',thumbnailOverlay:'thumbnailOverlay_869933b0',previewHidden:'previewHidden_869933b0',fileTypeIcon:'fileTypeIcon_869933b0',uninvokable:'uninvokable_869933b0',selectable:'selectable_869933b0',unselected:'unselected_869933b0',selected:'selected_869933b0',showCheck:'showCheck_869933b0',appIcon:'appIcon_869933b0',bottomSection:'bottomSection_869933b0',bottomSectionWithIcon:'bottomSectionWithIcon_869933b0',shimmerBottomText:'shimmerBottomText_869933b0',fileNameWithIconContainer:'fileNameWithIconContainer_869933b0',fileIcon:'fileIcon_869933b0',fileName:'fileName_869933b0',menuTarget:'menuTarget_869933b0',bottomSectionWithActivity:'bottomSectionWithActivity_869933b0',bottomSectionNamePlate:'bottomSectionNamePlate_869933b0',fileNameContainerWithActivity:'fileNameContainerWithActivity_869933b0',activityContainer:'activityContainer_869933b0'},IFrameDialog_9:{IFrameDialog:'IFrameDialog_2772e31d'},SyncDialog_6:{syncDialog:'syncDialog_ddec7b9b',syncDialogContent:'syncDialogContent_ddec7b9b',syncImg:'syncImg_ddec7b9b',copyLibraryId:'copyLibraryId_ddec7b9b',pointerText:'pointerText_ddec7b9b',footNote:'footNote_ddec7b9b',syncTitle:'syncTitle_ddec7b9b',contentContainer:'contentContainer_ddec7b9b',adminContentContainer:'adminContentContainer_ddec7b9b',separator:'separator_ddec7b9b',errorContainer:'errorContainer_ddec7b9b',errorTitle:'errorTitle_ddec7b9b'},SaveViewDialog_0:{saveViewDialogTextField:'saveViewDialogTextField_88ee8f33',saveViewDialogCheckbox:'saveViewDialogCheckbox_88ee8f33',saveViewDialogSpinner:'saveViewDialogSpinner_88ee8f33'},ApproveRejectDialog_9:{commentRoot:'commentRoot_468682d8',approveRejectDialogSpinner:'approveRejectDialogSpinner_468682d8',approveRejectDialogMessageBar:'approveRejectDialogMessageBar_468682d8',approveRejectDialogStatusLabel:'approveRejectDialogStatusLabel_468682d8'},FilterPanel_7:{alert:'alert_c6721d8a',filterPanelClearAllButton:'filterPanelClearAllButton_c6721d8a',filterPanelRoot:'filterPanelRoot_c6721d8a',filterPanelFooter:'filterPanelFooter_c6721d8a',filterPanelSuggestionsNone:'filterPanelSuggestionsNone_c6721d8a',filterPanelSuggestionItem:'filterPanelSuggestionItem_c6721d8a',peoplePickerRoot:'peoplePickerRoot_c6721d8a',filterPickerRoot:'filterPickerRoot_c6721d8a'},CustomFormatterRenderer_2:{customField:'customField_d1e240fb',customFieldCompact:'customFieldCompact_d1e240fb',customFieldTiles:'customFieldTiles_d1e240fb',customCards:'customCards_d1e240fb',defaultHoverCard:'defaultHoverCard_d1e240fb',fieldDefaultHoverCard:'fieldDefaultHoverCard_d1e240fb'},SPGrid_6:{spGridTableHead:'spGridTableHead_50e10db5',spGridPagingFooter:'spGridPagingFooter_50e10db5',spGridPagingFooterContent:'spGridPagingFooterContent_50e10db5',spGridCustomFormatField:'spGridCustomFormatField_50e10db5',wrapperTable:'wrapperTable_50e10db5',wrapperTd:'wrapperTd_50e10db5',gridFocusEntryPoint:'gridFocusEntryPoint_50e10db5',gridParentFocusable:'gridParentFocusable_50e10db5',spGridRoot:'spGridRoot_50e10db5',skipGridContentButton:'skipGridContentButton_50e10db5',spGridErrorIcon:'spGridErrorIcon_50e10db5',srOnly:'srOnly_50e10db5',boolIconDiv:'boolIconDiv_50e10db5',boolIcon:'boolIcon_50e10db5',dropHintStyle:'dropHintStyle_50e10db5',containerRefreshed:'containerRefreshed_50e10db5',dropHintCaretStyle:'dropHintCaretStyle_50e10db5',caretRefreshed:'caretRefreshed_50e10db5',dropHintLineStyle:'dropHintLineStyle_50e10db5',lineRefreshed:'lineRefreshed_50e10db5',listLink:'listLink_50e10db5',isTitleOrNameFieldVisualRefresh:'isTitleOrNameFieldVisualRefresh_50e10db5',isTitleOrNameField:'isTitleOrNameField_50e10db5',cellHiddenOverflow:'cellHiddenOverflow_50e10db5',cellBreakWordOverflow:'cellBreakWordOverflow_50e10db5',personaPillOverflowContainer:'personaPillOverflowContainer_50e10db5',customFormatField:'customFormatField_50e10db5',msGridWidgetDock:'msGridWidgetDock_50e10db5',stickyEditor:'stickyEditor_50e10db5',msGridWidgetDockHover:'msGridWidgetDockHover_50e10db5',msGridWidgetDockPressed:'msGridWidgetDockPressed_50e10db5',msGridWidgetCell:'msGridWidgetCell_50e10db5',msGridCellSelectedEditable:'msGridCellSelectedEditable_50e10db5',spGridErrorNotification:'spGridErrorNotification_50e10db5',msGrid:'msGrid_50e10db5',msGridLink:'msGridLink_50e10db5',msGridSelection:'msGridSelection_50e10db5',msGridSelectionReadonly:'msGridSelectionReadonly_50e10db5',msGridEdit:'msGridEdit_50e10db5',msGridTimescale:'msGridTimescale_50e10db5',msGridColHeaderNormal:'msGridColHeaderNormal_50e10db5',msGridColHeaderElemBgColorsNormal:'msGridColHeaderElemBgColorsNormal_50e10db5',msGridColHeaderElemHoverBgColorsNormal:'msGridColHeaderElemHoverBgColorsNormal_50e10db5',msGridColElemColorsClickNormal:'msGridColElemColorsClickNormal_50e10db5',msGridColHeaderNormalHover:'msGridColHeaderNormalHover_50e10db5',msGridColHeaderElemBgColorsNormalHover:'msGridColHeaderElemBgColorsNormalHover_50e10db5',msGridColHeaderElemHoverBgColorsNormalHover:'msGridColHeaderElemHoverBgColorsNormalHover_50e10db5',msGridColElemColorsClickNormalHover:'msGridColElemColorsClickNormalHover_50e10db5',msGridColHeaderPartSelected:'msGridColHeaderPartSelected_50e10db5',msGridColHeaderElemBgColorsPartSelected:'msGridColHeaderElemBgColorsPartSelected_50e10db5',msGridColHeaderElemHoverBgColorsPartSelected:'msGridColHeaderElemHoverBgColorsPartSelected_50e10db5',msGridColElemColorsClickPartSelected:'msGridColElemColorsClickPartSelected_50e10db5',msGridColHeaderPartSelectedHover:'msGridColHeaderPartSelectedHover_50e10db5',msGridColHeaderElemBgColorsPartSelectedHover:'msGridColHeaderElemBgColorsPartSelectedHover_50e10db5',msGridColHeaderElemHoverBgColorsPartSelectedHover:'msGridColHeaderElemHoverBgColorsPartSelectedHover_50e10db5',msGridColElemColorsClickPartSelectedHover:'msGridColElemColorsClickPartSelectedHover_50e10db5',msGridColHeaderAllSelected:'msGridColHeaderAllSelected_50e10db5',msGridColHeaderElemBgColorsAllSelected:'msGridColHeaderElemBgColorsAllSelected_50e10db5',msGridColHeaderElemHoverBgColorsAllSelected:'msGridColHeaderElemHoverBgColorsAllSelected_50e10db5',msGridColElemColorsClickAllSelected:'msGridColElemColorsClickAllSelected_50e10db5',msGridColHeaderAllSelectedHover:'msGridColHeaderAllSelectedHover_50e10db5',msGridColHeaderElemBgColorsAllSelectedHover:'msGridColHeaderElemBgColorsAllSelectedHover_50e10db5',msGridColHeaderElemHoverBgColorsAllSelectedHover:'msGridColHeaderElemHoverBgColorsAllSelectedHover_50e10db5',msGridColElemColorsClickAllSelectedHover:'msGridColElemColorsClickAllSelectedHover_50e10db5',msGridRowHeaderNormal:'msGridRowHeaderNormal_50e10db5',msGridRowHeaderNormalHover:'msGridRowHeaderNormalHover_50e10db5',msGridRowHeaderPartSelected:'msGridRowHeaderPartSelected_50e10db5',msGridRowHeaderPartSelectedHover:'msGridRowHeaderPartSelectedHover_50e10db5',msGridRowHeaderAllSelected:'msGridRowHeaderAllSelected_50e10db5',msGridRowHeaderAllSelectedHover:'msGridRowHeaderAllSelectedHover_50e10db5',msGridSplitter:'msGridSplitter_50e10db5',msGridSplitterHandle:'msGridSplitterHandle_50e10db5',msGridSplitterHover:'msGridSplitterHover_50e10db5',msGridSplitterHandleHover:'msGridSplitterHandleHover_50e10db5',msGridSplitterDrag:'msGridSplitterDrag_50e10db5',msGridSplitterHandleDrag:'msGridSplitterHandleDrag_50e10db5',spGridControlFocusElement:'spGridControlFocusElement_50e10db5',spGridControlEditbox:'spGridControlEditbox_50e10db5',inputIsNumber:'inputIsNumber_50e10db5',inputIsTitle:'inputIsTitle_50e10db5',spGridControlEditboxDynamicHeight:'spGridControlEditboxDynamicHeight_50e10db5',jsgridControlMultilineTextarea:'jsgridControlMultilineTextarea_50e10db5',jsgridControlRteContainer:'jsgridControlRteContainer_50e10db5',msRteStateField:'msRteStateField_50e10db5'},tablemgr_9:{spGridSelectAllIconContainer:'spGridSelectAllIconContainer_fb5959d0',spGridSelectAllIcon:'spGridSelectAllIcon_fb5959d0',spGridCell:'spGridCell_fb5959d0',tableColumnHeadersRow:'tableColumnHeadersRow_fb5959d0',errorAsterisk:'errorAsterisk_fb5959d0',gridSelectAllIconContainer:'gridSelectAllIconContainer_fb5959d0',selectAllCheckMarkCell:'selectAllCheckMarkCell_fb5959d0',selectionCheckIconsWrapper:'selectionCheckIconsWrapper_fb5959d0',selectionCheckIcon:'selectionCheckIcon_fb5959d0',allRowsSelected:'allRowsSelected_fb5959d0',selectionCircleIcon:'selectionCircleIcon_fb5959d0',headerStateContainer:'headerStateContainer_fb5959d0',hasStateElements:'hasStateElements_fb5959d0',headerStateBar:'headerStateBar_fb5959d0',selectionCheckMark:'selectionCheckMark_fb5959d0',inlineNewItemAddIconContainer:'inlineNewItemAddIconContainer_fb5959d0',stickyEditor:'stickyEditor_fb5959d0',selectedEditor:'selectedEditor_fb5959d0',inlineNewItemAddIcon:'inlineNewItemAddIcon_fb5959d0',inlineNewItemPlaceHolder:'inlineNewItemPlaceHolder_fb5959d0',rowIsActive:'rowIsActive_fb5959d0',inLineNewItemRow:'inLineNewItemRow_fb5959d0',gridCell:'gridCell_fb5959d0',cellIsFocusedAndSelected:'cellIsFocusedAndSelected_fb5959d0',gridStickySecondDataColumn:'gridStickySecondDataColumn_fb5959d0',cellHasCopyBorder:'cellHasCopyBorder_fb5959d0',cellIsSticky:'cellIsSticky_fb5959d0',cellLeftBorder:'cellLeftBorder_fb5959d0',cellRightBorder:'cellRightBorder_fb5959d0',cellTopBorder:'cellTopBorder_fb5959d0',cellBottomBorder:'cellBottomBorder_fb5959d0',firstCell:'firstCell_fb5959d0',cellHasFillDownBorder:'cellHasFillDownBorder_fb5959d0',readOnlySelectionFrame:'readOnlySelectionFrame_fb5959d0',cellHasSelectionBorder:'cellHasSelectionBorder_fb5959d0',cellHasError:'cellHasError_fb5959d0',tableHasMouseDown:'tableHasMouseDown_fb5959d0',cellIsSelected:'cellIsSelected_fb5959d0',hasErrorData:'hasErrorData_fb5959d0',lastCell:'lastCell_fb5959d0',imageTypeCell:'imageTypeCell_fb5959d0',customFormatterCell:'customFormatterCell_fb5959d0',tableParentDiv:'tableParentDiv_fb5959d0',gridRow:'gridRow_fb5959d0',rowIsSelected:'rowIsSelected_fb5959d0',gridStickyDataColumn:'gridStickyDataColumn_fb5959d0',gridStickyCheckColumn:'gridStickyCheckColumn_fb5959d0',rowHasOnlyOneCellSelected:'rowHasOnlyOneCellSelected_fb5959d0',gridStickyChromeLeft:'gridStickyChromeLeft_fb5959d0',gridStickyChromelessLeft:'gridStickyChromelessLeft_fb5959d0',gridStickyCheckColumnHeader:'gridStickyCheckColumnHeader_fb5959d0',gridStickyDataLeft:'gridStickyDataLeft_fb5959d0',gridStickyDataLeftChromeless:'gridStickyDataLeftChromeless_fb5959d0',gridStickyDataColumnHeader:'gridStickyDataColumnHeader_fb5959d0',stickyLeftEdgeKeeperContainerWithChrome:'stickyLeftEdgeKeeperContainerWithChrome_fb5959d0',stickyLeftEdgeKeeperContainerChromeless:'stickyLeftEdgeKeeperContainerChromeless_fb5959d0',stickyLeftEdgeKeeperContainer:'stickyLeftEdgeKeeperContainer_fb5959d0',stickyLeftEdgeKeeperWithChrome:'stickyLeftEdgeKeeperWithChrome_fb5959d0',stickyLeftEdgeKeeperChromeless:'stickyLeftEdgeKeeperChromeless_fb5959d0',stickyLeftEdgeKeeper:'stickyLeftEdgeKeeper_fb5959d0',stickyTableHeaderLeftEdgeKeeper:'stickyTableHeaderLeftEdgeKeeper_fb5959d0',stickyColumnShadow:'stickyColumnShadow_fb5959d0',stickyColumnShadowRtl:'stickyColumnShadowRtl_fb5959d0'},control_2:{msGridEditControlContainer:'msGridEditControlContainer_9d3f1c8c',msGridEditControlEditBox:'msGridEditControlEditBox_9d3f1c8c',errorWidgetContainer:'errorWidgetContainer_9d3f1c8c',stickyZIndex:'stickyZIndex_9d3f1c8c',widgetExpanded:'widgetExpanded_9d3f1c8c'},PeopleEditor_7:{peopleEditor:'peopleEditor_4414b0e3',increaseZIndex:'increaseZIndex_4414b0e3',styleUpdates:'styleUpdates_4414b0e3',inStickyMode:'inStickyMode_4414b0e3'},PersonDisplay_7:{personDisplayPill:'personDisplayPill_72ef897c',personDisplayCoin:'personDisplayCoin_72ef897c',personDisplayPhoto:'personDisplayPhoto_72ef897c',personDisplayName:'personDisplayName_72ef897c'},ChoicePill_6:{pill:'pill_071bcf73',pillNoHoverStyle:'pillNoHoverStyle_071bcf73',pillWithHoverByDefault:'pillWithHoverByDefault_071bcf73',innerPillPlainText:'innerPillPlainText_071bcf73',wellInput:'wellInput_071bcf73',editorButtonsContainer:'editorButtonsContainer_071bcf73',flyOutButtonsContainer:'flyOutButtonsContainer_071bcf73',fillInWrapperDiv:'fillInWrapperDiv_071bcf73',fillInWrapperDivWithBackground:'fillInWrapperDivWithBackground_071bcf73',fillInPillDiv:'fillInPillDiv_071bcf73',fillInLabel:'fillInLabel_071bcf73',buttonBorderFocused:'buttonBorderFocused_071bcf73',iconClass:'iconClass_071bcf73'},CustomFieldRenderer_2:{spCustomFormatField:'spCustomFormatField_fd5acce7'},OverridePillFormatter_4:{pillDeleteButton:'pillDeleteButton_2197ca36'},NumberEditor_5:{numberEditorUnit:'numberEditorUnit_d536e75f'},DateEditor_5:{quickEditDateTimeEditor:'quickEditDateTimeEditor_5676550c',quickEditDateTimeEditorInput:'quickEditDateTimeEditorInput_5676550c',quickEditDateTimeEditorTimeInput:'quickEditDateTimeEditorTimeInput_5676550c'},Field_7:{field:'field_5754adbb',display:'display_5754adbb',nofill:'nofill_5754adbb',disabledField:'disabledField_5754adbb',fieldText:'fieldText_5754adbb'},LocationEditor_1:{locationEditor:'locationEditor_a4963643',stickyEditor:'stickyEditor_a4963643'},TaxonomyEditor_2:{taxonomyEditorSpan:'taxonomyEditorSpan_acc4ff20',increaseZIndex:'increaseZIndex_acc4ff20'},CheckboxEditor_0:{checkBox:'checkBox_e3c97535'},styles_9:{msGridBaseStyle:'msGridBaseStyle_8dedee68',msGridCell:'msGridCell_8dedee68',msGridCellReadonly:'msGridCellReadonly_8dedee68',msGridCellReadonlyFocused:'msGridCellReadonlyFocused_8dedee68'},RowHeaderState_3:{errorIcon:'errorIcon_688672d6'},panemgr_9:{topFrameElement:'topFrameElement_255975f0',dashedBorder:'dashedBorder_255975f0',dashedBorderUnfocused:'dashedBorderUnfocused_255975f0',bottomFrameElement:'bottomFrameElement_255975f0',leftFrameElement:'leftFrameElement_255975f0',rightFrameElement:'rightFrameElement_255975f0',stickyFrame:'stickyFrame_255975f0',solidBorder:'solidBorder_255975f0',copyFrame:'copyFrame_255975f0',selectionDragHandle:'selectionDragHandle_255975f0',rowSelectionHandle:'rowSelectionHandle_255975f0',editorIsActive:'editorIsActive_255975f0',stickyHandle:'stickyHandle_255975f0',selectionDragHandleContents:'selectionDragHandleContents_255975f0',selectionDragHandleContainer:'selectionDragHandleContainer_255975f0',readonlySelectionRect:'readonlySelectionRect_255975f0',dragToFillFrame:'dragToFillFrame_255975f0'},headermgr_6:{spGridHeaderIconSpan:'spGridHeaderIconSpan_9b7890bf',spGridHeaderCoreContent:'spGridHeaderCoreContent_9b7890bf',gridHeaderCell:'gridHeaderCell_9b7890bf',columnIsActive:'columnIsActive_9b7890bf',resizeContainer:'resizeContainer_9b7890bf',renameInputContainer:'renameInputContainer_9b7890bf'},PinnedItemsCardRenderer_0:{folderCover:'folderCover_9a180d18',blankFolderCover:'blankFolderCover_9a180d18'},TopCollaborator_8:{topCollaPlaceHolder:'topCollaPlaceHolder_acb4229a',topCollaboratorIcon:'topCollaboratorIcon_acb4229a',topCollaboratorUserName:'topCollaboratorUserName_acb4229a',topCollaboratorTooltip:'topCollaboratorTooltip_acb4229a',userWithTopCollaborator:'userWithTopCollaborator_acb4229a',columnHeader:'columnHeader_acb4229a'},OpenCommandButton_8:{iconContainer:'iconContainer_1d84ea90',menuItemIconContainer:'menuItemIconContainer_1d84ea90',logoFillIcon:'logoFillIcon_1d84ea90',logoIcon:'logoIcon_1d84ea90',contextualMenuItemLinkContent:'contextualMenuItemLinkContent_1d84ea90',contextualMenuItemTextLabel:'contextualMenuItemTextLabel_1d84ea90'},GroupItemDetailsHeader_0:{root:'root_09895c92'},RecentGroupItemDetailsHeader_9:{root:'root_1aa25b42'},FileHoverCard_module_7:{fileHoverCardCompactCard:'fileHoverCardCompactCard_7d060422',fileHoverCardCompactCardTitleRegion:'fileHoverCardCompactCardTitleRegion_7d060422',fileHoverCardCompactCardFileIcon:'fileHoverCardCompactCardFileIcon_7d060422',fileHoverCardCompactCardTitle:'fileHoverCardCompactCardTitle_7d060422',titleNotExpanded:'titleNotExpanded_7d060422',fileHoverCardCompactCardActivity:'fileHoverCardCompactCardActivity_7d060422',fileHoverCardExpandedCard:'fileHoverCardExpandedCard_7d060422',fileHoverCardExpandedCardScrollableSection:'fileHoverCardExpandedCardScrollableSection_7d060422',fileHoverCardExpandedCardLoadError:'fileHoverCardExpandedCardLoadError_7d060422',fileHoverCardExpandedCardSuggestion:'fileHoverCardExpandedCardSuggestion_7d060422',fileHoverCardExpandedCardHostScroll:'fileHoverCardExpandedCardHostScroll_7d060422',fileHoverCardActivitiesSection:'fileHoverCardActivitiesSection_7d060422',fileCardExpandSectionContainer:'fileCardExpandSectionContainer_7d060422',fileCardExpandSectionButton:'fileCardExpandSectionButton_7d060422',collapsedFileCardTooltip:'collapsedFileCardTooltip_7d060422'},AnalyticsActivityList_module_2:{analyticsActivityListActivity:'analyticsActivityListActivity_1fa22094'},AnalyticsActivity_module_8:{analyticsActivity:'analyticsActivity_fbe4fcc5',analyticsActivityUserAction:'analyticsActivityUserAction_fbe4fcc5',analyticsActivityUserName:'analyticsActivityUserName_fbe4fcc5'},AnalyticsStats_module_2:{analyticsStatsContainer:'analyticsStatsContainer_123f61c9',analyticsStats:'analyticsStats_123f61c9',analyticsStatsNoLink:'analyticsStatsNoLink_123f61c9',analyticsStatsLink:'analyticsStatsLink_123f61c9',analyticsStatsViewsNoLink:'analyticsStatsViewsNoLink_123f61c9',analyticsStatsViews:'analyticsStatsViews_123f61c9',analyticsStatsViewsDivider:'analyticsStatsViewsDivider_123f61c9',analyticsStatsViewsDividerNoDot:'analyticsStatsViewsDividerNoDot_123f61c9',analyticsStatsErrorMessage:'analyticsStatsErrorMessage_123f61c9',fileHoverCardErrorIcon:'fileHoverCardErrorIcon_123f61c9',analyticsStatsTeachingMessage:'analyticsStatsTeachingMessage_123f61c9',analyticsStatsInfo:'analyticsStatsInfo_123f61c9',analyticsStatsLabel:'analyticsStatsLabel_123f61c9',analyticsStatsCount:'analyticsStatsCount_123f61c9'},AnalyticsKeyPoints_module_6:{fileHoverCardInsideLook:'fileHoverCardInsideLook_450f4e32',fileHoverCardInsideLookTitle:'fileHoverCardInsideLookTitle_450f4e32',fileHoverCardReadTimeContainer:'fileHoverCardReadTimeContainer_450f4e32',fileHoverCardReadTime:'fileHoverCardReadTime_450f4e32',fileHoverCardReadTimeIcon:'fileHoverCardReadTimeIcon_450f4e32',fileHoverCardKeyPointsButton:'fileHoverCardKeyPointsButton_450f4e32',fileHoverCardKeyPointsNonButton:'fileHoverCardKeyPointsNonButton_450f4e32',fileHoverCardKeyPointsContent:'fileHoverCardKeyPointsContent_450f4e32',fileHoverCardKeyPointsAction:'fileHoverCardKeyPointsAction_450f4e32',fileHoverCardKeyPointsCell:'fileHoverCardKeyPointsCell_450f4e32',fileHoverCardKeyPointsText:'fileHoverCardKeyPointsText_450f4e32',fileHoverCardKeyPointsBullet:'fileHoverCardKeyPointsBullet_450f4e32'},AnalyticsLifeCycle_module_8:{fileHoverCardLifeCycle:'fileHoverCardLifeCycle_a88ba103',fileHoverCardLifeCycleMessage:'fileHoverCardLifeCycleMessage_a88ba103',fileHoverCardLifeCycleTitle:'fileHoverCardLifeCycleTitle_a88ba103',fileHoverCardLifeCycleAction:'fileHoverCardLifeCycleAction_a88ba103',fileHoverCardLifeCycleNewSignal:'fileHoverCardLifeCycleNewSignal_a88ba103'},RecommendedActions_module_4:{fileHoverCardRecommendedSection:'fileHoverCardRecommendedSection_ef3fc21d',fileHoverCardRecommendedTitle:'fileHoverCardRecommendedTitle_ef3fc21d',fileHoverCardRecommendedMessage:'fileHoverCardRecommendedMessage_ef3fc21d',fileHoverCardShareWith:'fileHoverCardShareWith_ef3fc21d',fileHoverCardShareWithLink:'fileHoverCardShareWithLink_ef3fc21d',fileHoverCardChevronIcon:'fileHoverCardChevronIcon_ef3fc21d',fileHoverCardRecommendedAction:'fileHoverCardRecommendedAction_ef3fc21d',fileHoverCardCancelIcon:'fileHoverCardCancelIcon_ef3fc21d',fileHoverCardRecommendedIcon:'fileHoverCardRecommendedIcon_ef3fc21d',fileHoverCardRecommendedLink:'fileHoverCardRecommendedLink_ef3fc21d',fileHoverCardActivity:'fileHoverCardActivity_ef3fc21d',fileHoverCardUserName:'fileHoverCardUserName_ef3fc21d'},Conversations_module_6:{fileHoverCardConversationsSection:'fileHoverCardConversationsSection_8c83cf33',fileHoverCardConversationsTitle:'fileHoverCardConversationsTitle_8c83cf33',fileHoverCardConversation:'fileHoverCardConversation_8c83cf33',fileHoverCardConversationIcon:'fileHoverCardConversationIcon_8c83cf33',fileHoverCardConversationParticipants:'fileHoverCardConversationParticipants_8c83cf33',fileHoverCardConversationContext:'fileHoverCardConversationContext_8c83cf33',fileHoverCardMeetingConversationContext:'fileHoverCardMeetingConversationContext_8c83cf33',fileHoverCardConversationReferencePreview:'fileHoverCardConversationReferencePreview_8c83cf33',fileHoverCardConversationSharedByUser:'fileHoverCardConversationSharedByUser_8c83cf33',fileHoverCardConversationsMeetingIcon:'fileHoverCardConversationsMeetingIcon_8c83cf33'},RelatedFiles_module_4:{fileHoverCardRelatedFilesSection:'fileHoverCardRelatedFilesSection_f4449314',fileHoverCardRelatedFilesTitle:'fileHoverCardRelatedFilesTitle_f4449314',fileHoverCardRelatedFile:'fileHoverCardRelatedFile_f4449314',fileHoverCardRelatedFilesName:'fileHoverCardRelatedFilesName_f4449314',fileHoverCardRelatedFileIcon:'fileHoverCardRelatedFileIcon_f4449314'},AnalyticsActionBar_module_4:{analyticsActionBarStats:'analyticsActionBarStats_bfed0b89',analyticsActionBar:'analyticsActionBar_bfed0b89'},AnalyticsKeyPointsEditor_module_1:{fileHoverCardKeyPointsEditor:'fileHoverCardKeyPointsEditor_337ee822',fileHoverCardKeyPointsEditorInputSection:'fileHoverCardKeyPointsEditorInputSection_337ee822',fileHoverCardKeyPointsEditorSpinner:'fileHoverCardKeyPointsEditorSpinner_337ee822',fileHoverCardKeyPointsEditorButtons:'fileHoverCardKeyPointsEditorButtons_337ee822',fileHoverCardKeyPointsEditorButtonCancel:'fileHoverCardKeyPointsEditorButtonCancel_337ee822',fileHoverCardKeyPointsEditorAddKeyPointLink:'fileHoverCardKeyPointsEditorAddKeyPointLink_337ee822',fileHoverCardKeyPointsEditorCell:'fileHoverCardKeyPointsEditorCell_337ee822',fileHoverCardKeyPointsEditorDeleteIcon:'fileHoverCardKeyPointsEditorDeleteIcon_337ee822'},AnalyticsKeyPointsFeedback_module_9:{fileHoverCardFeedbackTitle:'fileHoverCardFeedbackTitle_039f8b23',fileHoverCardFeedbackTooltip:'fileHoverCardFeedbackTooltip_039f8b23',fileHoverCardFeedbackOption:'fileHoverCardFeedbackOption_039f8b23',fileHoverCardFeedbackChoiceLink:'fileHoverCardFeedbackChoiceLink_039f8b23',fileHoverCardFeedbackMessage:'fileHoverCardFeedbackMessage_039f8b23',fileHoverCardFeedbackCheckbox:'fileHoverCardFeedbackCheckbox_039f8b23',fileHoverCardFeedbackSubmit:'fileHoverCardFeedbackSubmit_039f8b23',fileHoverCardFeedbackSubCheckbox:'fileHoverCardFeedbackSubCheckbox_039f8b23'},ContentCenterModelImportBanner_module_1:{container:'container_1addcdca',closeButtonDiv:'closeButtonDiv_1addcdca',closeButton:'closeButton_1addcdca',bannerContent:'bannerContent_1addcdca',bannerHeaderContent:'bannerHeaderContent_1addcdca',bannerPrimaryContent:'bannerPrimaryContent_1addcdca',bannerPrimaryText:'bannerPrimaryText_1addcdca',bannerSecondaryText:'bannerSecondaryText_1addcdca',buttonStack:'buttonStack_1addcdca',bannerHeaderTagStyle:'bannerHeaderTagStyle_1addcdca',descriptionContainer:'descriptionContainer_1addcdca',descriptionText:'descriptionText_1addcdca',imageContainer:'imageContainer_1addcdca'},teamSiteNavLink_1:{icon:'icon_f405f152',siteName:'siteName_f405f152',siteNameContainer:'siteNameContainer_f405f152',linkName:'linkName_f405f152',parentContainer:'parentContainer_f405f152',dragContainer:'dragContainer_f405f152',siteContainer:'siteContainer_f405f152',dropZoneParent:'dropZoneParent_f405f152',topDropZoneHover:'topDropZoneHover_f405f152',bottomDropZoneHover:'bottomDropZoneHover_f405f152',dropZone:'dropZone_f405f152',dragHandler:'dragHandler_f405f152'},PinSite_9:{odSitePinIcon:'odSitePinIcon_0904a4d9',odSitePinButtonDefault:'odSitePinButtonDefault_0904a4d9',odSitePinButtonHover:'odSitePinButtonHover_0904a4d9',odSitePinPinHover:'odSitePinPinHover_0904a4d9',sitePinLeftNavParent:'sitePinLeftNavParent_0904a4d9',sitePinAllSitesParent:'sitePinAllSitesParent_0904a4d9',odSitePinContainer:'odSitePinContainer_0904a4d9'},SiteItemTile_3:{root:'root_05ba7b03',icon:'icon_05ba7b03',nameplate:'nameplate_05ba7b03',name:'name_05ba7b03',activity:'activity_05ba7b03'},SiteItemTile_v2_7:{root:'root_a057c8e0',nameplate:'nameplate_a057c8e0',name:'name_a057c8e0',activity:'activity_a057c8e0',icon:'icon_a057c8e0'},SiteIcon_5:{acronym:'acronym_67e6b7aa',acronymText:'acronymText_67e6b7aa',siteLogo:'siteLogo_67e6b7aa',siteLogoHidden:'siteLogoHidden_67e6b7aa'},SiteHeaderTileCell_3:{name:'name_cdefa8c9'}}});